import{i as wA,B as JI,F as eC,A as WB,a as CS,C as YB,P as ot,R as En,S as zB,T as Qs,b as KB,c as si,d as Ka,s as ZI,e as Gu,G as qB,f as Fy,M as qr,g as ss,h as NS,j as ky,k as XB,l as $B,E as QB,m as JB,I as ZB,n as eV,o as tV,p as sV,q as iV,r as rV,t as AS,u as nV,v as aV,w as hh,x as h,y as s,z as oV,D as pr,H as tC,J as Ul,K as Gc,L as lV,N as Gy,O as Ht,Q as By,U as eT,V as Vy,W as Hy,X as cm,Y as cV,Z as uV,_ as hV,$ as ds,a0 as _s,a1 as tT,a2 as Wy,a3 as xg,a4 as zd,a5 as of,a6 as Yy,a7 as dV,a8 as FA,a9 as kA,aa as GA,ab as BA,ac as VA,ad as zy,ae as Ky,af as _V,ag as gV,ah as qy,ai as Kd,aj as Oc,ak as mV,al as fV,am as pV,an as EV,ao as cc,ap as IV,aq as HA,ar as TV,as as SV,at as RV,au as xV,av as OV,aw as Nd,ax as Ad,ay as Wc,az as CV,aA as NV,aB as AV,aC as bV,aD as WA,aE as vV,aF as yV,aG as DV,aH as kT,aI as GT,aJ as BT,aK as bS,aL as MV,aM as jV,aN as LV,aO as PV,aP as UV,aQ as wV,aR as FV,aS as kV,aT as GV,aU as BV,aV as VV,aW as HV,aX as WV,aY as YV,aZ as zV}from"./vendor-BMDTbamC.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();const eu=class eu{static log(...e){this.LOG_DEBUG&&console.log(this.logPrefix(),...e)}static warn(...e){this.LOG_WARN&&console.warn(this.logPrefix(),...e)}static error(...e){this.LOG_ERROR&&console.error(this.logPrefix(),...e)}static events(...e){this.LOG_EVENTS&&console.log(this.logPrefix(),...e)}static packets(...e){this.LOG_PACKETS&&console.log(this.logPrefix(),...e)}static logPrefix(){return"[Nitro]"}};eu.LOG_DEBUG=!1,eu.LOG_WARN=!1,eu.LOG_ERROR=!1,eu.LOG_EVENTS=!1,eu.LOG_PACKETS=!1;let ze=eu;class Ms{constructor(e=null){if(this._length=0,this._dictionary=new Map,this._array=[],this._keys=[],e)for(const[t,i]of e.entries())this.add(t,i)}get length(){return this._length}get disposed(){return!this._dictionary}dispose(){if(!this._dictionary){for(const e of this._dictionary.keys())this._dictionary.delete(e);this._dictionary=null}this._length=0,this._array=null,this._keys=null}reset(){for(const e of this._dictionary.keys())this._dictionary.delete(e);this._length=0,this._array=[],this._keys=[]}unshift(e,t){return this._dictionary.get(e)!==null?!1:(this._dictionary.set(e,t),this._array.unshift(t),this._keys.unshift(e),this._length++,!0)}add(e,t){return this._dictionary.get(e)!==void 0?!1:(this._dictionary.set(e,t),this._array[this._length]=t,this._keys[this._length]=e,this._length++,!0)}remove(e){const t=this._dictionary.get(e);if(!t)return null;const i=this._array.indexOf(t);return i>=0&&(this._array.splice(i,1),this._keys.splice(i,1),this._length--),this._dictionary.delete(e),t}getWithIndex(e){return e<0||e>=this._length?null:this._array[e]}getKey(e){return e<0||e>=this._length?null:this._keys[e]}getKeys(){return this._keys.slice()}hasKey(e){return this._keys.indexOf(e)>-1}getValue(e){return this._dictionary.get(e)}getValues(){return this._array.slice()}hasValue(e){return this._array.indexOf(e)>-1}indexOf(e){return this._array.indexOf(e)}concatenate(e){for(const t of e._keys)this.add(t,e.getValue(t))}clone(){const e=new Ms;return e.concatenate(this),e}}const Xy=a=>{let e="";const t=new Uint8Array(a),i=t.byteLength;for(let r=0;r<i;r++)e+=String.fromCharCode(t[r]);return window.btoa(e)};class sT{constructor(e){this._position=0,this._dataView=new DataView(e)}readUnsignedInt(){const e=this._dataView.getUint32(this._position);return this._position+=4,e}readBytes(e){const t=new sT(this._dataView.buffer.slice(this._position,this._position+e));return this._position+=e,t}readByte(){const e=this._dataView.getInt8(this._position);return this._position++,e}readShort(){const e=this._dataView.getInt16(this._position);return this._position+=2,e}readInt(){const e=this._dataView.getInt32(this._position);return this._position+=4,e}readFloat(){const e=this._dataView.getFloat32(this._position);return this._position+=4,e}readDouble(){const e=this._dataView.getFloat64(this._position);return this._position+=8,e}remaining(){return this._dataView.byteLength-this._position}toString(e){return new TextDecoder().decode(this._dataView.buffer)}toArrayBuffer(){return this._dataView.buffer}}class YA{constructor(){this._buffer=new Uint8Array,this._position=0}writeByte(e){const t=new Uint8Array(1);return t[0]=e,this.appendArray(t),this}writeBytes(e){const t=new Uint8Array(e);return this.appendArray(t),this}writeShort(e){const t=new Uint8Array(2);return t[0]=e>>8,t[1]=e&255,this.appendArray(t),this}writeInt(e){const t=new Uint8Array(4);return t[0]=e>>24,t[1]=e>>16,t[2]=e>>8,t[3]=e&255,this.appendArray(t),this}writeString(e,t=!0){const i=new TextEncoder().encode(e);return t?(this.writeShort(i.length),this.appendArray(i)):this.appendArray(i),this}writeLargeString(e,t=!0){const i=new TextEncoder().encode(e);return t?(this.writeInt(i.length),this.appendArray(i)):this.appendArray(i),this}appendArray(e){if(!e)return;const t=new Uint8Array(this.position+e.length>this._buffer.length?this.position+e.length:this._buffer.length);t.set(this._buffer),t.set(e,this.position),this._buffer=t,this.position+=e.length}getBuffer(){return this._buffer.buffer}get position(){return this._position}set position(e){this._position=e}toString(e){return new TextDecoder(e).decode(this._buffer)}}const Hp=class Hp{constructor(e){this._jsonFile=null,this._image=null,this._imageData=null,this._baseTexture=null,this.parse(e)}parse(e){const t=new sT(e);let i=t.readShort();for(;i>0;){const r=t.readShort(),n=t.readBytes(r).toString(),o=t.readInt(),l=t.readBytes(o);if(n.endsWith(".json")){const c=wA(l.toArrayBuffer());this._jsonFile=JSON.parse(Hp.TEXT_DECODER.decode(c))}else{const c=wA(l.toArrayBuffer()),u=Xy(c);this._baseTexture=new JI("data:image/png;base64,"+u)}i--}}get jsonFile(){return this._jsonFile}get baseTexture(){return this._baseTexture}};Hp.TEXT_DECODER=new TextDecoder("utf-8");let lf=Hp;class $y extends eC{constructor(e){super(`attribute vec2 aVertexPosition;
            attribute vec2 aTextureCoord;

            uniform mat3 projectionMatrix;

            varying vec2 vTextureCoord;

            void main(void)
            {
                gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
                vTextureCoord = aTextureCoord;
            }`,`varying vec2 vTextureCoord;
            uniform sampler2D uSampler;

            uniform float gamma;
            uniform float contrast;
            uniform float saturation;
            uniform float brightness;
            uniform float red;
            uniform float green;
            uniform float blue;
            uniform float alpha;

            void main(void)
            {
                vec4 c = texture2D(uSampler, vTextureCoord);

                if (c.a > 0.0) {
                    c.rgb /= c.a;

                    vec3 rgb = pow(c.rgb, vec3(1. / gamma));
                    rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);
                    rgb.r *= red;
                    rgb.g *= green;
                    rgb.b *= blue;
                    c.rgb = rgb * brightness;

                    c.rgb *= c.a;
                }

                gl_FragColor = c * alpha;
            }`),this.gamma=1,this.saturation=1,this.contrast=1,this.brightness=1,this.red=1,this.green=1,this.blue=1,this.alpha=1,Object.assign(this,e)}apply(e,t,i,r){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,e.applyFilter(this,t,i,r)}}const KV=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,qV=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D mask;
uniform int fromChannel;
uniform int toChannel;

void main(void) {
    vec4 maskColor = texture2D(mask, vTextureCoord);
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(maskColor.r == 0.0 && maskColor.g == 0.0 && maskColor.b == 0.0)
    {
        adjusted.a = 0.0;
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, adjusted.a);
}`,bh=class bh extends eC{constructor(e,t,i){super(KV,qV,{mask:e.castToBaseTexture(),fromChannel:t,toChannel:i})}};bh.CHANNEL_RED=0,bh.CHANNEL_GREEN=1,bh.CHANNEL_BLUE=2,bh.CHANNEL_ALPHA=3;let zA=bh;const I_=class I_ extends WB{constructor(e){super(e),I_.INSTANCE||(I_.INSTANCE=this)}static get instance(){return this.INSTANCE||null}};I_.INSTANCE=null;let di=I_;const Gi=()=>{var a;return((a=di.instance)==null?void 0:a.ticker)||null},vS=()=>{var a;return((a=Gi())==null?void 0:a.FPS)||0},nt=()=>{var a;return((a=Gi())==null?void 0:a.lastTime)||0};class Qy extends CS{}class XV extends JI{}class kn extends YB{}class Jy extends eC{}class ei extends ot{}class Zy extends En{}class Is extends zB{}class sC extends Qs{}class eD extends KB{}const $V=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,QV=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D lut;
uniform int channel;

void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(currentColor.a > 0.0)
    {
        if(channel == 0)
        {
            adjusted = texture2D(lut, vec2((currentColor.r * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 1) {
            adjusted = texture2D(lut, vec2((currentColor.g * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 2) {
            adjusted = texture2D(lut, vec2((currentColor.b * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 3) {
            adjusted = texture2D(lut, vec2((currentColor.a * 255.0 + 0.5) / 256.0, 0.5));
        }
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, currentColor.a);
}`,Sa=class Sa extends Jy{constructor(e,t=Sa.CHANNEL_RED){super($V,QV),this._channel=t;let i=[];i=this.getLutForPalette(e),this._lut=XV.fromBuffer(Uint8Array.from(i),i.length/4,1,{mipmap:0,scaleMode:0}),this.uniforms.lut=this._lut,this.uniforms.channel=this._channel}getLutForPalette(e){const t=[];for(let i=0;i<e.length;i++)t[i*4+Sa.CHANNEL_RED]=e[i]>>16&255,t[i*4+Sa.CHANNEL_GREEN]=e[i]>>8&255,t[i*4+Sa.CHANNEL_BLUE]=e[i]&255,t[i*4+Sa.CHANNEL_ALPHA]=e[i]>>24&255;return t}get lut(){return this._lut}get channel(){return this._channel}};Sa.CHANNEL_RED=0,Sa.CHANNEL_GREEN=1,Sa.CHANNEL_BLUE=2,Sa.CHANNEL_ALPHA=3;let cf=Sa;const Wp=class Wp{constructor(){this.RENDER_TEXTURE_POOL=new Map,this.RENDER_TEXTURE_CACHE=[]}clearCache(){this.RENDER_TEXTURE_POOL.forEach(e=>e==null?void 0:e.destroy(!0)),this.RENDER_TEXTURE_POOL.clear(),this.RENDER_TEXTURE_CACHE=[]}clearRenderTexture(e){return e?this.writeToRenderTexture(new si(Qs.EMPTY),e):null}getTextureIdentifier(e,t,i){return`${i??Wp.DEFAULT_PLANE_ID}:${e}:${t}`}createRenderTexture(e,t,i=null){if(e<0||t<0)return null;if(!i){const n=Ka.create({width:e,height:t});return this.RENDER_TEXTURE_CACHE.push(n),n}i=this.getTextureIdentifier(e,t,i);let r=this.RENDER_TEXTURE_POOL.get(i);return r||(r=Ka.create({width:e,height:t}),this.RENDER_TEXTURE_CACHE.push(r),this.RENDER_TEXTURE_POOL.set(i,r)),r}createAndFillRenderTexture(e,t,i=null,r=16777215){if(e<0||t<0)return null;const n=this.createRenderTexture(e,t,i);return n?this.clearAndFillRenderTexture(n,r):null}createAndWriteRenderTexture(e,t,i,r=null,n=null){if(e<0||t<0)return null;const o=this.createRenderTexture(e,t,r);return this.writeToRenderTexture(i,o,!0,n)}clearAndFillRenderTexture(e,t=16777215){if(!e||!e.baseTexture||!e.orig)return null;const i=new si(Qs.WHITE);return i?(i.tint=t,i.width=e.width,i.height=e.height,this.writeToRenderTexture(i,e)):null}writeToRenderTexture(e,t,i=!0,r=null){return!e||!t?null:(this.getRenderer().render(e,{renderTexture:t,clear:i,transform:r}),t)}getPixels(e,t=null){return this.getExtractor().pixels(e)}getRenderer(){return di.instance.renderer}getExtractor(){return this.getRenderer().plugins.extract}};Wp.DEFAULT_PLANE_ID="DEFAULT";let yS=Wp;class Vt{static generateTexture(e,t=null,i=null,r=1){return e?(i===null&&(i=ZI.SCALE_MODE),this.getRenderer().generateTexture(e,{scaleMode:i,resolution:r,region:t})):null}static generateTextureFromImage(e){return e?Qs.from(e):null}static generateImage(e){return e?this.getExtractor().image(e):null}static generateImageUrl(e){return e?this.getExtractor().base64(e):null}static generateCanvas(e){return e?this.getExtractor().canvas(e):null}static clearRenderTexture(e){return e?this.writeToRenderTexture(new si(Qs.EMPTY),e):null}static createRenderTexture(e,t){return e<0||t<0?null:Ka.create({width:e,height:t})}static createAndFillRenderTexture(e,t,i=16777215){if(e<0||t<0)return null;const r=this.createRenderTexture(e,t);return this.clearAndFillRenderTexture(r,i)}static createAndWriteRenderTexture(e,t,i,r=null){if(e<0||t<0)return null;const n=this.createRenderTexture(e,t);return this.writeToRenderTexture(i,n,!0,r)}static clearAndFillRenderTexture(e,t=16777215){if(!e)return null;const i=new si(Qs.WHITE);return i.tint=t,i.width=e.width,i.height=e.height,this.writeToRenderTexture(i,e)}static writeToRenderTexture(e,t,i=!0,r=null){return!e||!t?null:(this.getRenderer().render(e,{renderTexture:t,clear:i,transform:r}),t)}static getPixels(e,t=null){return this.getExtractor().pixels(e)}static getRenderer(){return di.instance.renderer}static getExtractor(){return this.getRenderer().plugins.extract}}class Yc extends Gu{}class iC extends qB{}const tu=class tu{static createAsset(e,t,i,r,n,o=!1,l=!1,c=!1){const u=tu.GRAPHIC_POOL.length?tu.GRAPHIC_POOL.pop():new tu;return u._name=e,u._source=t||null,i?(u._texture=i,u._initialized=!1):(u._texture=null,u._initialized=!0),u._usesPalette=c,u._x=r,u._y=n,u._flipH=o,u._flipV=l,u._rectangle=null,u}recycle(){this._texture=null,tu.GRAPHIC_POOL.push(this)}initialize(){this._initialized||!this._texture||(this._width=this._texture.width,this._height=this._texture.height,this._initialized=!0)}getImageUrl(){return Vt.generateImageUrl(new si(this._texture))}get name(){return this._name}get source(){return this._source}get texture(){return this._texture}get usesPalette(){return this._usesPalette}get x(){return this._x}get y(){return this._y}get width(){return this.initialize(),this._width}get height(){return this.initialize(),this._height}get offsetX(){return this._flipH?-this._x:this._x}get offsetY(){return this._flipV?-this._y:this._y}get flipH(){return this._flipH}get flipV(){return this._flipV}get rectangle(){return this._rectangle||(this._rectangle=new En(0,0,this.width,this.height)),this._rectangle}};tu.GRAPHIC_POOL=[];let DS=tu;class JV{constructor(e,t,i){for(this._palette=e;this._palette.length<256;)this._palette.push([0,0,0]);this._primaryColor=t,this._secondaryColor=i}dispose(){}applyPalette(e){var o,l;const t=Vt.createAndWriteRenderTexture(e.width,e.height,new si(e)),i=Vt.getPixels(t);for(let c=0;c<i.length;c+=4){let u=this._palette[i[c+1]];u===void 0&&(u=[0,0,0]),i[c]=u[0],i[c+1]=u[1],i[c+2]=u[2]}const r=(o=t.baseTexture._glTextures[1])==null?void 0:o.texture,n=(l=di.instance.renderer)==null?void 0:l.gl;return n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,i),n.bindTexture(n.TEXTURE_2D,null),t}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}}const T_=class T_{constructor(e,t){if(!e)throw new Error("invalid_collection");this._name=e.name,this._baseTexture=t&&t.baseTexture||null,this._data=e,this._textures=new Map,this._assets=new Map,this._palettes=new Map,this._paletteAssetNames=[],t&&this.addLibraryAsset(t.textures),this.define(e)}static removeFileExtension(e){return e.substring(0,e.lastIndexOf("."))||e}dispose(){if(this._palettes){for(const e of this._palettes.values())e.dispose();this._palettes.clear()}if(this._paletteAssetNames&&(this.disposePaletteAssets(),this._paletteAssetNames=null),this._assets){for(const e of this._assets.values())e.recycle();this._assets.clear()}}addReference(){this._referenceCount++,this._referenceTimestamp=nt()}removeReference(){this._referenceCount--,this._referenceCount<=0&&(this._referenceCount=0,this._referenceTimestamp=nt(),this.disposePaletteAssets(!1))}define(e){const t=e.assets,i=e.palettes;t&&this.defineAssets(t),i&&this.definePalettes(i)}defineAssets(e){if(e)for(const t in e){const i=e[t];if(!i)continue;const r=-i.x||0,n=-i.y||0;let o=!1;const l=!1,c=i.usesPalette||!1;let u=i.source||"";i.flipH&&u.length&&(o=!0),u.length||(u=t);const d=this.getLibraryAsset(u);if(!d)continue;let _=this.createAsset(t,u,d,o,l,r,n,c);if(!_){const m=this.getAsset(t);m&&m.name!==m.source&&(_=this.replaceAsset(t,u,d,o,l,r,n,c))}}}definePalettes(e){if(e)for(const t in e){const i=e[t];if(!i)continue;const r=i.id.toString();if(this._palettes.get(r))continue;let n=16777215,o=16777215,l=i.color1;l&&l.length>0&&(n=parseInt(l,16)),l=i.color2,l&&l.length>0&&(o=parseInt(l,16)),this._palettes.set(r,new JV(i.rgb,n,o))}}createAsset(e,t,i,r,n,o,l,c){if(this._assets.get(e))return!1;const u=DS.createAsset(e,t,i,o,l,r,n,c);return this._assets.set(e,u),!0}replaceAsset(e,t,i,r,n,o,l,c){const u=this._assets.get(e);return u&&(this._assets.delete(e),u.recycle()),this.createAsset(e,t,i,r,n,o,l,c)}getAsset(e){if(!e)return null;const t=this._assets.get(e);return t||null}getAssetWithPalette(e,t){const i=e+"@"+t;let r=this.getAsset(i);if(!r){if(r=this.getAsset(e),!r||!r.usesPalette)return r;const n=this.getPalette(t);if(n){const o=n.applyPalette(r.texture);o&&(this._paletteAssetNames.push(i),this.createAsset(i,r.source+"@"+t,o,r.flipH,r.flipV,r.x,r.y,!1),r=this.getAsset(i))}}return r}getTexture(e){return this._textures.get(e)}getPaletteNames(){return Array.from(this._palettes.keys())}getPaletteColors(e){const t=this.getPalette(e);return t?[t.primaryColor,t.secondaryColor]:null}getPalette(e){if(!e)return null;const t=this._palettes.get(e);return t||null}addAsset(e,t,i,r=0,n=0,o=!1,l=!1){if(!e||!t)return!1;const c=this.getLibraryAsset(e);return c?i?(c.baseTexture=t.baseTexture,c.frame=t.frame,c.trim=t.trim,c.updateUvs(),!0):!1:(this._textures.set(e,t),this.createAsset(e,e,t,o,l,r,n,!1))}disposeAsset(e){const t=this._assets.get(e);if(!t)return;this._assets.delete(e);const i=this.getLibraryAsset(t.source);i&&(this._textures.delete(t.source),i.destroy(!0)),t.recycle()}getLibraryAsset(e){if(!e)return null;e=this._name+"_"+e;const t=this._textures.get(e);return t||null}addLibraryAsset(e){if(e)for(const t in e){const i=e[t];i&&this._textures.set(T_.removeFileExtension(t),i)}}disposePaletteAssets(e=!0){if(this._paletteAssetNames&&(e||this._paletteAssetNames.length>T_.PALETTE_ASSET_DISPOSE_THRESHOLD)){for(const t of this._paletteAssetNames)this.disposeAsset(t);this._paletteAssetNames=[]}}get referenceCount(){return this._referenceCount}get referenceTimestamp(){return this._referenceTimestamp}get name(){return this._name}get baseTexture(){return this._baseTexture}get data(){return this._data}get textures(){return this._textures}get assets(){return this._assets}};T_.PALETTE_ASSET_DISPOSE_THRESHOLD=10;let uf=T_;const Yp=class Yp{constructor(){this._textures=new Map,this._collections=new Map}getTexture(e){if(!e)return null;const t=this._textures.get(e);return t||null}setTexture(e,t){!e||!t||this._textures.set(e,t)}getAsset(e){if(!e)return null;for(const t of this._collections.values()){if(!t)continue;const i=t.getAsset(e);if(i)return i}return null}getCollection(e){if(!e)return null;const t=this._collections.get(e);return t||null}createCollection(e,t){if(!e)return null;const i=new uf(e,t);if(i){for(const[r,n]of i.textures.entries())this.setTexture(r,n);this._collections.set(i.name,i)}return i}async downloadAsset(e){return await this.downloadAssets([e])}async downloadAssets(e){if(!e||!e.length)return Promise.resolve(!0);try{for(const t of e){const i=await fetch(t);if(i.status!==200)continue;let r="application/octet-stream";switch(i.headers.has("Content-Type")&&(r=i.headers.get("Content-Type")),r){case"application/octet-stream":{const n=await i.arrayBuffer(),o=new lf(n);await this.processAsset(o.baseTexture,o.jsonFile);break}case"image/png":case"image/jpeg":case"image/gif":{const n=await i.arrayBuffer(),o=Xy(n),l=JI.from(`data:${r};base64,${o}`),c=async()=>{const u=new Qs(l);this.setTexture(t,u)};l.valid?await c():await new Promise((u,d)=>{l.once("update",async()=>(await c(),u()))});break}}}return Promise.resolve(!0)}catch(t){return ze.error(t),Promise.resolve(!1)}}async processAsset(e,t){const i=t.spritesheet;if(!e||!i||!Object.keys(i).length){this.createCollection(t,null);return}const r=async()=>{const n=new Fy(e,i);await n.parse(),this.createCollection(t,n)};e.valid?await r():await new Promise((n,o)=>{e.once("update",async()=>(await r(),n()))})}get collections(){return this._collections}};Yp._INSTANCE=new Yp;let MS=Yp;const vr=()=>MS._INSTANCE;class ZV{constructor(e,t,i){this.name=e,this.textures=t,this.durations=i}}const zp=class zp{};zp.UNKNOWN=0,zp.BROWSER=1;let jS=zp;const S_=class S_{};S_.UNKNOWN=0,S_.FLASH=1,S_.HTML5=2;let LS=S_;const vh=class vh{};vh.CONNECTION_OPENED="open",vh.CONNECTION_CLOSED="close",vh.CONNECTION_ERROR="error",vh.CONNECTION_MESSAGE="message";let to=vh;const R_=class R_{static parseConfiguration(e,t=!1){if(!e)return!1;try{const i=new RegExp(/\${(.*?)}/g);for(const r in e){let n=e[r];typeof n=="string"&&(n=this.interpolate(n,i)),this._definitions.has(r)?t&&this.setValue(r,n):this.setValue(r,n)}return!0}catch(i){return ze.error(i.stack),!1}}static interpolate(e,t=null){t||(t=new RegExp(/\${(.*?)}/g));const i=e.match(t);if(i&&i.length)for(const r of i){const n=this._definitions.get(this.removeInterpolateKey(r));n&&(e=e.replace(r,n))}return e}static removeInterpolateKey(e){return e.replace("${","").replace("}","")}static getValue(e,t=null){let i=this._definitions.get(e);if(i===void 0){if(this._missingKeys.indexOf(e)>=0)return t;this._missingKeys.push(e),ze.warn(`Missing configuration key: ${e}`),i=t}return i}static setValue(e,t){const i=e.split(".");let r=this._config;for(let n=0;n<i.length;n++){const o=i[n].toString();if(n!==i.length-1){r[o]||(r[o]={}),r=r[o];continue}r[o]=t}this._definitions.set(e,t)}static get definitions(){return this._definitions}};R_._definitions=new Map,R_._config={},R_._missingKeys=[];let st=R_;const Be=class Be{static getExpressionTimeout(e){switch(e=parseInt(e),e){case 1:return 5e3;case 2:return 1400;case 3:return 2e3;case 4:return 2e3;case 5:return 0;case 6:return 700;case 7:return 2e3;case 8:return 1500;case 9:return 1500;case 10:return 1500;default:return 0}}static getExpressionId(e){return Be.EXPRESSION_MAP.indexOf(e)}static getExpression(e){return e>Be.EXPRESSION_MAP.length?null:Be.EXPRESSION_MAP[e]}static getGestureId(e){return Be.GESTURE_MAP.indexOf(e)}static getGesture(e){return e>Be.GESTURE_MAP.length?null:Be.GESTURE_MAP[e]}static idToAvatarActionState(e){return e==="Lay"?"lay":e==="Float"?"float":e==="Swim"?"swim":e==="Sit"?"sit":e==="Respect"?"respect":e==="Wave"?"wave":e==="Idle"?"idle":e==="Dance"?"dance":e==="UseItem"?"usei":e==="CarryItem"?"cri":e==="Talk"?"talk":e==="Sleep"?"Sleep":e==="Move"?"mv":"std"}};Be.CARRY_OBJECT="cri",Be.DANCE="dance",Be.EFFECT="fx",Be.EXPRESSION="expression",Be.EXPRESSION_BLOW_A_KISS="blow",Be.EXPRESSION_CRY="cry",Be.EXPRESSION_IDLE="idle",Be.EXPRESSION_LAUGH="laugh",Be.EXPRESSION_RESPECT="respect",Be.EXPRESSION_RIDE_JUMP="ridejump",Be.EXPRESSION_SNOWBOARD_OLLIE="sbollie",Be.EXPRESSION_SNOWBORD_360="sb360",Be.EXPRESSION_WAVE="wave",Be.GESTURE="gest",Be.GESTURE_AGGRAVATED="agr",Be.GESTURE_SAD="sad",Be.GESTURE_SMILE="sml",Be.GESTURE_SURPRISED="srp",Be.GUIDE_STATUS="guide",Be.MUTED="muted",Be.PET_GESTURE_BLINK="eyb",Be.PET_GESTURE_CRAZY="crz",Be.PET_GESTURE_JOY="joy",Be.PET_GESTURE_MISERABLE="mis",Be.PET_GESTURE_PUZZLED="puz",Be.PET_GESTURE_TONGUE="tng",Be.PLAYING_GAME="playing_game",Be.POSTURE="posture",Be.POSTURE_FLOAT="float",Be.POSTURE_LAY="lay",Be.POSTURE_SIT="sit",Be.POSTURE_STAND="std",Be.POSTURE_SWIM="swim",Be.POSTURE_WALK="mv",Be.SIGN="sign",Be.SLEEP="sleep",Be.SNOWWAR_DIE_BACK="swdieback",Be.SNOWWAR_DIE_FRONT="swdiefront",Be.SNOWWAR_PICK="swpick",Be.SNOWWAR_RUN="swrun",Be.SNOWWAR_THROW="swthrow",Be.TALK="talk",Be.BLINK="blink",Be.TYPING="typing",Be.USE_OBJECT="usei",Be.VOTE="vote",Be.GESTURE_MAP=["",Be.GESTURE_SMILE,Be.GESTURE_AGGRAVATED,Be.GESTURE_SURPRISED,Be.GESTURE_SAD,Be.PET_GESTURE_JOY,Be.PET_GESTURE_CRAZY,Be.PET_GESTURE_TONGUE,Be.PET_GESTURE_BLINK,Be.PET_GESTURE_MISERABLE,Be.PET_GESTURE_PUZZLED],Be.EXPRESSION_MAP=["",Be.EXPRESSION_WAVE,Be.EXPRESSION_BLOW_A_KISS,Be.EXPRESSION_LAUGH,Be.EXPRESSION_CRY,Be.EXPRESSION_IDLE,Be.DANCE,Be.EXPRESSION_RESPECT,Be.EXPRESSION_SNOWBOARD_OLLIE,Be.EXPRESSION_SNOWBORD_360,Be.EXPRESSION_RIDE_JUMP];let We=Be;const yh=class yh{};yh.DIRECTION_TO_ANGLE=[45,90,135,180,225,270,315,0],yh.DIRECTION_IS_FLIPPED=[!1,!1,!1,!1,!0,!0,!0,!1],yh.MIN_DIRECTION=0,yh.MAX_DIRECTION=7;let yr=yh;const Jo=class Jo{};Jo.GENERIC="hd",Jo.HEAD="head",Jo.TORSO="torso",Jo.LEGS="legs",Jo.HOTLOOKS="hotlooks",Jo.WARDROBE="wardrobe",Jo.EFFECTS="effects";let ji=Jo;const Dh=class Dh{};Dh.OWN_AVATAR_EDITOR=0,Dh.FURNITURE_AVATAR_EDITOR=1,Dh.BOT_EDITOR=2,Dh.DEV_TOOL_EDITOR=3;let KA=Dh;const Kp=class Kp{};Kp.NOTHING="nothing",Kp.WARDROBE="wardrobe";let qA=Kp;const St=class St{};St.MALE="M",St.FEMALE="F",St.UNISEX="U",St.SCALE="h",St.STD="std",St.DEFAULT_FRAME=0,St.BODY="bd",St.SHOES="sh",St.LEGS="lg",St.CHEST="ch",St.WAIST_ACCESSORY="wa",St.CHEST_ACCESSORY="ca",St.HEAD="hd",St.HAIR="hr",St.FACE_ACCESSORY="fa",St.EYE_ACCESSORY="ea",St.HEAD_ACCESSORY="ha",St.HEAD_ACCESSORY_EXTRA="he",St.COAT_CHEST="cc",St.CHEST_PRINT="cp",St.LEFT_HAND_ITEM="li",St.LEFT_HAND="lh",St.LEFT_SLEEVE="ls",St.RIGHT_HAND="rh",St.RIGHT_SLEEVE="rs",St.FACE="fc",St.EYES="ey",St.HAIR_BIG="hrb",St.RIGHT_HAND_ITEM="ri",St.LEFT_COAT_SLEEVE="lc",St.RIGHT_COAT_SLEEVE="rc",St.FIGURE_SETS=[St.SHOES,St.LEGS,St.CHEST,St.WAIST_ACCESSORY,St.CHEST_ACCESSORY,St.HEAD,St.HAIR,St.FACE_ACCESSORY,St.EYE_ACCESSORY,St.HEAD_ACCESSORY,St.HEAD_ACCESSORY_EXTRA,St.COAT_CHEST,St.CHEST_PRINT];let Ee=St;const x_=class x_{};x_.NONE=0,x_.GUIDE=1,x_.REQUESTER=2;let Oo=x_;const qp=class qp{};qp.LARGE="h",qp.SMALL="sh";let Hn=qp;const O_=class O_{};O_.FULL="full",O_.HEAD="head",O_.BODY="body";let ki=O_;const su=class su{};su.VERTICAL="vertical",su.SITTING="sitting",su.HORIZONTAL="horizontal",su.SWIM="swim",su.SNOWWARS_HORIZONTAL="swhorizontal";let wl=su;const Mh=class Mh{};Mh.TOOL="tool",Mh.COMPONENT="component",Mh.ONLINE_TOOL="online_tool",Mh.LOCAL_ONLY="local_only";let XA=Mh;const Kt=class Kt{};Kt.DOG=0,Kt.CAT=1,Kt.CROCODILE=2,Kt.TERRIER=3,Kt.BEAR=4,Kt.PIG=5,Kt.LION=6,Kt.RHINO=7,Kt.SPIDER=8,Kt.TURTLE=9,Kt.CHICKEN=10,Kt.FROG=11,Kt.DRAGON=12,Kt.MONSTER=13,Kt.MONKEY=14,Kt.HORSE=15,Kt.MONSTERPLANT=16,Kt.BUNNY=17,Kt.BUNNYEVIL=18,Kt.BUNNYDEPRESSED=19,Kt.BUNNYLOVE=20,Kt.PIGEONGOOD=21,Kt.PIGEONEVIL=22,Kt.DEMONMONKEY=23,Kt.BABYBEAR=24,Kt.BABYTERRIER=25,Kt.GNOME=26,Kt.LEPRECHAUN=27,Kt.KITTENBABY=28,Kt.PUPPYBABY=29,Kt.PIGLETNBABY=30,Kt.HALOOMPA=31,Kt.FOOLS=32,Kt.PTEROSAUR=33,Kt.VELOCIRAPTOR=34;let ui=Kt;const Zo=class Zo{};Zo.NONE=0,Zo.HEART=1,Zo.SMILE=2,Zo.BOBBA=3,Zo.POOP=4,Zo.RELATIONSHIP_TYPES=[0,1,2,3,4],Zo.RELATIONSHIP_NAMES=["None","Heart","Smile","Bobba","Poop"];let _r=Zo;const el=class el{};el.HOTEL_VIEW="hotel_view",el.HOME_ROOM="home_room",el.NAVIGATOR="navigator",el.CATALOG="catalog",el.INVENTORY="inventory",el.ME_MENU="me_menu",el.FRIEND_LIST="friendlist";let hf=el;const tl=class tl{};tl.LOVE_LOCK=0,tl.CARVE_A_TREE=1,tl.FRIENDS_PORTRAIT=2,tl.HABBOWEEN=3,tl.WILD_WEST_WANTED=4,tl.INFINITY_LOVE=5,tl.HABBO_FRIEND=6;let Og=tl;const C_=class C_{};C_.CATALOG="catalog",C_.INVENTORY="inventory",C_.INFO_STAND="info_stand";let zn=C_;const ue=class ue{};ue.OBJECT_ROOM_ID="object_room_id",ue.OBJECT_ACCURATE_Z_VALUE="object_accurate_z_value",ue.TILE_CURSOR_HEIGHT="tile_cursor_height",ue.FIGURE="figure",ue.GENDER="gender",ue.OWN_USER="own_user",ue.FIGURE_CAN_STAND_UP="figure_can_stand_up",ue.FIGURE_VERTICAL_OFFSET="figure_vertical_offset",ue.FIGURE_TALK="figure_talk",ue.FIGURE_DANCE="figure_dance",ue.FIGURE_SLEEP="figure_sleep",ue.FIGURE_BLINK="figure_blink",ue.FIGURE_EFFECT="figure_effect",ue.FIGURE_CARRY_OBJECT="figure_carry_object",ue.FIGURE_USE_OBJECT="figure_use_object",ue.FIGURE_GESTURE="figure_gesture",ue.FIGURE_POSTURE="figure_posture",ue.FIGURE_POSTURE_PARAMETER="figure_posture_parameter",ue.FIGURE_HIGHLIGHT_ENABLE="figure_highlight_enable",ue.FIGURE_HIGHLIGHT="figure_highlight",ue.FURNITURE_PURCHASER_NAME="furniture_purchaser_name",ue.FURNITURE_PURCHASER_FIGURE="furniture_purchaser_figure",ue.STD="std",ue.FIGURE_SIGN="figure_sign",ue.FIGURE_FLAT_CONTROL="figure_flat_control",ue.FIGURE_IS_TYPING="figure_is_typing",ue.FIGURE_IS_MUTED="figure_is_muted",ue.FIGURE_GAINED_EXPERIENCE="figure_gained_experience",ue.FIGURE_EXPERIENCE_TIMESTAMP="figure_experience_timestamp",ue.FIGURE_NUMBER_VALUE="figure_number_value",ue.FIGURE_IS_PLAYING_GAME="figure_is_playing_game",ue.FIGURE_GUIDE_STATUS="figure_guide_status",ue.FIGURE_EXPRESSION="figure_expression",ue.AVATAR_MOUSE_HIGHLIGHT="figure_highlight",ue.AVATAR_WIRED_VARIABLE_HOLDER_HIGHLIGHT="figure_highlight_variable_holder",ue.HEAD_DIRECTION="head_direction",ue.FURNITURE_CUSTOM_VARIABLES="furniture_custom_variables",ue.FURNITURE_AUTOMATIC_STATE_INDEX="furniture_automatic_state_index",ue.FURNITURE_ALWAYS_STACKABLE="furniture_always_stackable",ue.FURNITURE_DISABLE_PICKING_ANIMATION="furniture_disable_picking_animation",ue.FURNITURE_DATA_FORMAT="furniture_data_format",ue.FURNITURE_UNIQUE_SERIAL_NUMBER="furniture_unique_serial_number",ue.FURNITURE_UNIQUE_EDITION_SIZE="furniture_unique_edition_size",ue.FURNITURE_CRACKABLE_STATE="furniture_crackable_state",ue.FURNITURE_CRACKABLE_HITS="furniture_crackable_hits",ue.FURNITURE_CRACKABLE_TARGET="furniture_crackable_target",ue.FURNITURE_CREDIT_VALUE="furniture_credit_value",ue.FURNITURE_DATA="furniture_data",ue.FURNITURE_ITEMDATA="furniture_itemdata",ue.FURNITURE_COLOR="furniture_color",ue.FURNITURE_LIFT_AMOUNT="furniure_lift_amount",ue.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID="furniture_guild_customized_guild_id",ue.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME="furniture_guild_customized_asset_name",ue.FURNITURE_GUILD_CUSTOMIZED_COLOR_1="furniture_guild_customized_color_1",ue.FURNITURE_GUILD_CUSTOMIZED_COLOR_2="furniture_guild_customized_color_2",ue.FURNITURE_STATE_UPDATE_TIME="furniture_state_update_time",ue.FURNITURE_SELECTION_DISABLED="furniture_selection_disabled",ue.FURNITURE_SIZE_X="furniture_size_x",ue.FURNITURE_SIZE_Y="furniture_size_y",ue.FURNITURE_SIZE_Z="furniture_size_z",ue.FURNITURE_CENTER_X="furniture_center_x",ue.FURNITURE_CENTER_Y="furniture_center_y",ue.FURNITURE_CENTER_Z="furniture_center_z",ue.FURNITURE_ALLOWED_DIRECTIONS="furniture_allowed_directions",ue.FURNITURE_AD_URL="furniture_ad_url",ue.FURNITURE_TYPE_ID="furniture_type_id",ue.FURNITURE_EXTRAS="furniture_extras",ue.FURNITURE_EXPIRY_TIME="furniture_expiry_time",ue.FURNITURE_EXPIRTY_TIMESTAMP="furniture_expiry_timestamp",ue.FURNITURE_REAL_ROOM_OBJECT="furniture_real_room_object",ue.FURNITURE_IS_STICKIE="furniture_is_stickie",ue.FURNITURE_BRANDING_IMAGE_STATUS="furniture_branding_image_status",ue.FURNITURE_BRANDING_IMAGE_URL="furniture_branding_image_url",ue.FURNITURE_BRANDING_URL="furniture_branding_url",ue.FURNITURE_BRANDING_OFFSET_X="furniture_branding_offset_x",ue.FURNITURE_BRANDING_OFFSET_Y="furniture_branding_offset_y",ue.FURNITURE_BRANDING_OFFSET_Z="furniture_branding_offset_z",ue.FURNITURE_BRANDING_BLEND_MODE="furniture_branding_blend_mode",ue.FURNITURE_BRANDING_ALPHA="furniture_branding_alpha",ue.FURNITURE_BRANDING_IS_ANIMATED="furniture_branding_is_animated",ue.FURNITURE_BADGE_IMAGE_STATUS="furniture_badge_image_status",ue.FURNITURE_BADGE_ASSET_NAME="furniture_badge_asset_name",ue.FURNITURE_BADGE_VISIBLE_IN_STATE="furniture_badge_visible_in_state",ue.FURNITURE_ALPHA_MULTIPLIER="furniture_alpha_multiplier",ue.FURNITURE_USAGE_POLICY="furniture_usage_policy",ue.FURNITURE_OWNER_ID="furniture_owner_id",ue.FURNITURE_OWNER_NAME="furniture_owner_name",ue.FURNITURE_ROOM_BACKGROUND_COLOR_HUE="furniture_room_background_color_hue",ue.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION="furniture_room_background_color_saturation",ue.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS="furniture_room_background_color_lightness",ue.FURNITURE_USES_PLANE_MASK="furniture_uses_plane_mask",ue.FURNITURE_PLANE_MASK_TYPE="furniture_plane_mask_type",ue.FURNITURE_IS_VARIABLE_HEIGHT="furniture_is_variable_height",ue.FURNITURE_VOTE_MAJORITY_RESULT="furniture_vote_majority_result",ue.FURNITURE_VOTE_COUNTER_COUNT="furniture_vote_counter_count",ue.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED="furniture_soundblock_relative_animation_speed",ue.FURNITURE_MANNEQUIN_NAME="furniture_mannequin_name",ue.FURNITURE_MANNEQUIN_GENDER="furniture_mannequin_gender",ue.FURNITURE_MANNEQUIN_FIGURE="furniture_mannequin_figure",ue.FURNITURE_HIGHSCORE_SCORE_TYPE="furniture_highscore_score_type",ue.FURNITURE_HIGHSCORE_CLEAR_TYPE="furniture_highscore_clear_type",ue.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT="furniture_highscore_data_entry_count",ue.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_="furniture_highscore_data_entry_base_users_",ue.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_="furniture_highscore_data_entry_base_score_",ue.FURNITURE_INTERNAL_LINK="furniture_internal_link",ue.FURNITURE_CLOTHING_BOY="furniture_clothing_boy",ue.FURNITURE_CLOTHING_GIRL="furniture_clothing_girl",ue.FURNITURE_PLANETSYSTEM_DATA="furniture_planetsystem_data",ue.FURNITURE_FIREWORKS_DATA="furniture_fireworks_data",ue.PET_PALETTE_INDEX="pet_palette_index",ue.PET_COLOR="pet_color",ue.PET_HEAD_ONLY="pet_head_only",ue.PET_CUSTOM_LAYER_IDS="pet_custom_layer_ids",ue.PET_CUSTOM_PARTS_IDS="pet_custom_part_ids",ue.PET_CUSTOM_PALETTE_IDS="pet_custom_palette_ids",ue.PET_IS_RIDING="pet_is_riding",ue.PET_TYPE="pet_type",ue.PET_ALLOWED_DIRECTIONS="pet_allowed_directions",ue.RACE="race",ue.ROOM_MAP_DATA="room_map_data",ue.ROOM_PLANE_MASK_XML="room_plane_mask_xml",ue.ROOM_FLOOR_TYPE="room_floor_type",ue.ROOM_WALL_TYPE="room_wall_type",ue.ROOM_LANDSCAPE_TYPE="room_landscape_type",ue.ROOM_WALL_THICKNESS="room_wall_thickness",ue.ROOM_FLOOR_THICKNESS="room_floor_thickness",ue.ROOM_FILTER="room_filter",ue.ROOM_FLOOR_HOLE_UPDATE_TIME="room_floor_hole_update_time",ue.ROOM_FLOOR_VISIBILITY="room_floor_visibility",ue.ROOM_WALL_VISIBILITY="room_wall_visibility",ue.ROOM_LANDSCAPE_VISIBILITY="room_landscape_visibility",ue.ROOM_DOOR_X="room_door_x",ue.ROOM_DOOR_Y="room_door_y",ue.ROOM_DOOR_Z="room_door_z",ue.ROOM_DOOR_DIR="room_door_dir",ue.ROOM_BACKGROUND_COLOR="room_background_color",ue.ROOM_COLORIZE_BG_ONLY="room_colorize_bg_only",ue.ROOM_RANDOM_SEED="room_random_seed",ue.ROOM_WORLD_TYPE="room_world_type",ue.ROOM_SELECTED_X="room_selected_x",ue.ROOM_SELECTED_Y="room_selected_y",ue.ROOM_SELECTED_Z="room_selected_z",ue.ROOM_SELECTED_PLANE="room_selected_plane",ue.IMAGE_QUERY_SCALE="image_query_scale",ue.FURNITURE_FRIENDFURNI_ENGRAVING="furniture_friendfurni_engraving_type",ue.SESSION_URL_PREFIX="session_url_prefix",ue.SESSION_CURRENT_USER_ID="session_current_user_id",ue.FURNITURE_AREA_HIDE_ROOT_X="furniture_area_hide_root_x",ue.FURNITURE_AREA_HIDE_ROOT_Y="furniture_area_hide_root_y",ue.FURNITURE_AREA_HIDE_WIDTH="furniture_area_hide_width",ue.FURNITURE_AREA_HIDE_LENGTH="furniture_area_hide_length",ue.FURNITURE_AREA_HIDE_INVISIBILITY="furniture_area_hide_invisibility",ue.FURNITURE_AREA_HIDE_WALLITEMS="furniture_area_hide_wallitems",ue.FURNITURE_AREA_HIDE_INVERT="furniture_area_hide_invert",ue.FURNITURE_AREA_HIDE_ENTITIES="furniture_area_hide_entities",ue.FURNITURE_AREA_HIDE_WALKABLE="furniture_area_hide_walkable",ue.FURNITURE_CLICK_THROUGH_ENABLED="furniture_click_through_enabled",ue.FURNITURE_HIGHSCORE_VARIABLE_NAME="furniture_highscore_variable_name",ue.FURNITURE_HIGHSCORE_VARIABLE_EXHIBITION_TYPE="furniture_highscore_variable_exhibition_type",ue.FURNITURE_HIGHSCORE_VARIABLE_COLUMN_NAME="furniture_highscore_variable_column_name",ue.FURNITURE_HIGHSCORE_VARIABLE_COLUMN_POINTS_NAME="furniture_highscore_variable_column_points_name";let D=ue;const JN=class JN{};JN.UNIQUE_SET=256;let PS=JN;class Ml{constructor(){this._flags=0,this._uniqueNumber=0,this._uniqueSeries=0}parseWrapper(e){(this._flags&PS.UNIQUE_SET)>0&&(this._uniqueNumber=e.readInt(),this._uniqueSeries=e.readInt())}initializeFromRoomObjectModel(e){this._uniqueNumber=e.getValue(D.FURNITURE_UNIQUE_SERIAL_NUMBER),this._uniqueSeries=e.getValue(D.FURNITURE_UNIQUE_EDITION_SIZE)}writeRoomObjectModel(e){e&&(e.setValue(D.FURNITURE_UNIQUE_SERIAL_NUMBER,this._uniqueNumber),e.setValue(D.FURNITURE_UNIQUE_EDITION_SIZE,this._uniqueSeries))}getLegacyString(){return""}compare(e){return!1}get state(){const e=parseInt(this.getLegacyString());return isNaN(e)?0:e}get isUnique(){return this._uniqueSeries>0}get uniqueNumber(){return this._uniqueNumber}set uniqueNumber(e){this._uniqueNumber=e}get uniqueSeries(){return this._uniqueSeries}set uniqueSeries(e){this._uniqueSeries=e}get rarityLevel(){return-1}get flags(){return this._flags}set flags(e){this._flags=e}}const Ra=class Ra{};Ra.LEGACY_KEY=0,Ra.MAP_KEY=1,Ra.STRING_KEY=2,Ra.VOTE_KEY=3,Ra.EMPTY_KEY=4,Ra.NUMBER_KEY=5,Ra.HIGHSCORE_KEY=6,Ra.CRACKABLE_KEY=7,Ra.HIGHSCORE_VARIABLE_KEY=8;let Kn=Ra;const Xp=class Xp extends Ml{constructor(){super(),this._state="",this._hits=0,this._target=0}parseWrapper(e){e&&(this._state=e.readString(),this._hits=e.readInt(),this._target=e.readInt(),super.parseWrapper(e))}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._state=e.getValue(D.FURNITURE_CRACKABLE_STATE),this._hits=e.getValue(D.FURNITURE_CRACKABLE_HITS),this._target=e.getValue(D.FURNITURE_CRACKABLE_TARGET)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(D.FURNITURE_DATA_FORMAT,Xp.FORMAT_KEY),e.setValue(D.FURNITURE_CRACKABLE_STATE,this._state),e.setValue(D.FURNITURE_CRACKABLE_HITS,this._hits),e.setValue(D.FURNITURE_CRACKABLE_TARGET,this._target)}getLegacyString(){return this._state}compare(e){return!0}get hits(){return this._hits}get target(){return this._target}};Xp.FORMAT_KEY=Kn.CRACKABLE_KEY;let df=Xp;const $p=class $p extends Ml{parseWrapper(e){e&&(this._state="",super.parseWrapper(e))}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(D.FURNITURE_DATA_FORMAT,$p.FORMAT_KEY)}getLegacyString(){return this._state}compare(e){return super.compare(e)}};$p.FORMAT_KEY=Kn.EMPTY_KEY;let _f=$p;class $A{constructor(){this._score=-1,this._users=[]}get score(){return this._score}set score(e){this._score=e}get users(){return this._users}set users(e){this._users=e}addUsername(e){this._users.push(e)}}const Qp=class Qp extends Ml{constructor(){super(),this._state="",this._scoreType=-1,this._clearType=-1,this._entries=[]}parseWrapper(e){if(!e)return;this._state=e.readString(),this._scoreType=e.readInt(),this._clearType=e.readInt();let t=e.readInt();for(;t>0;){const i=new $A;i.score=e.readInt();let r=e.readInt();for(;r>0;)i.addUsername(e.readString()),r--;this._entries.push(i),t--}super.parseWrapper(e)}initializeFromRoomObjectModel(e){this._scoreType=e.getValue(D.FURNITURE_HIGHSCORE_SCORE_TYPE),this._clearType=e.getValue(D.FURNITURE_HIGHSCORE_CLEAR_TYPE),this._entries=[];const t=e.getValue(D.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT);let i=0;for(;i<t;){const r=new $A;r.score=e.getValue(D.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+i),r.users=e.getValue(D.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+i),this._entries.push(r),i++}super.initializeFromRoomObjectModel(e)}writeRoomObjectModel(e){if(super.writeRoomObjectModel(e),e.setValue(D.FURNITURE_DATA_FORMAT,Qp.FORMAT_KEY),e.setValue(D.FURNITURE_HIGHSCORE_SCORE_TYPE,this._scoreType),e.setValue(D.FURNITURE_HIGHSCORE_CLEAR_TYPE,this._clearType),this._entries){e.setValue(D.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT,this._entries.length);let t=0;for(;t<this._entries.length;){const i=this._entries[t];e.setValue(D.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+t,i.score),e.setValue(D.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+t,i.users),t++}}}getLegacyString(){return this._state}get entries(){return this._entries}get clearType(){return this._clearType}get scoreType(){return this._scoreType}};Qp.FORMAT_KEY=Kn.HIGHSCORE_KEY;let gf=Qp;const Jp=class Jp extends Ml{constructor(){super(),this._data=""}parseWrapper(e){e&&(this._data=e.readString(),super.parseWrapper(e))}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._data=e.getValue(D.FURNITURE_DATA)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(D.FURNITURE_DATA_FORMAT,Jp.FORMAT_KEY),e.setValue(D.FURNITURE_DATA,this._data)}getLegacyString(){return this._data}compare(e){return this._data===e.getLegacyString()}setString(e){this._data=e}};Jp.FORMAT_KEY=Kn.LEGACY_KEY;let Xr=Jp;const Bl=class Bl extends Ml{constructor(){super(),this._data={}}parseWrapper(e){if(!e)return;this._data={};const t=e.readInt();if(t)for(let i=0;i<t;i++)this._data[e.readString()]=e.readString();super.parseWrapper(e)}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._data=e.getValue(D.FURNITURE_DATA)||{}}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(D.FURNITURE_DATA_FORMAT,Bl.FORMAT_KEY),e.setValue(D.FURNITURE_DATA,this._data)}getLegacyString(){if(!this._data)return"";const e=this._data[Bl.STATE];return e??""}compare(e){return!1}getValue(e){return this._data[e]}get rarityLevel(){if(!this._data)return-1;const e=this._data[Bl.RARITY];return e==null?-1:parseInt(e)}get data(){return this._data}};Bl.FORMAT_KEY=Kn.MAP_KEY,Bl.STATE="state",Bl.RARITY="rarity";let Yu=Bl;const iu=class iu extends Ml{constructor(){super(),this._data=[]}parseWrapper(e){if(!e)return;this._data=[];const t=e.readInt();if(t)for(let i=0;i<t;i++)this._data.push(e.readInt());super.parseWrapper(e)}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._data=e.getValue(D.FURNITURE_DATA)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(D.FURNITURE_DATA_FORMAT,iu.FORMAT_KEY),e.setValue(D.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[iu.STATE].toString()}compare(e){if(!(e instanceof iu))return!1;let t=0;for(;t<this._data.length;){if(t!==0){if(this._data[t]!==e.getValue(t))return!1}t++}return!0}getValue(e){if(!this._data||!this._data.length)return-1;const t=this._data[e];return t??-1}};iu.FORMAT_KEY=Kn.NUMBER_KEY,iu.STATE=0;let bd=iu;const ru=class ru extends Ml{constructor(){super(),this._data=[]}parseWrapper(e){if(!e)return;this._data=[];const t=e.readInt();if(t)for(let i=0;i<t;i++)this._data.push(e.readString());super.parseWrapper(e)}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._data=e.getValue(D.FURNITURE_DATA)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(D.FURNITURE_DATA_FORMAT,ru.FORMAT_KEY),e.setValue(D.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[ru.STATE]}compare(e){if(!(e instanceof ru))return!1;let t=0;for(;t<this._data.length;){if(t!==0){if(this._data[t]!==e.getValue(t))return!1}t++}return!0}getValue(e){return this._data[e]||""}setValue(e){this._data=e}};ru.FORMAT_KEY=Kn.STRING_KEY,ru.STATE=0;let qa=ru;const Zp=class Zp extends Ml{constructor(){super(),this._state="",this._result=0}parseWrapper(e){e&&(this._state=e.readString(),this._result=e.readInt(),super.parseWrapper(e))}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(D.FURNITURE_DATA_FORMAT,Zp.FORMAT_KEY);const t={};t.S=this._state,t.R=this._result.toString(),e.setValue(D.FURNITURE_DATA,t)}getLegacyString(){return this._state}compare(e){return!0}setString(e){this._state=e}get result(){return this._result}};Zp.FORMAT_KEY=Kn.VOTE_KEY;let Cg=Zp;class QA{constructor(){this._score="-1",this._user=""}get score(){return this._score}set score(e){this._score=e}get user(){return this._user}set user(e){this._user=e}}const eE=class eE extends Ml{constructor(){super(),this._state="",this._scoreName="",this._exhibitionType=-1,this._columnName="",this._columnPointsName="",this._entries=[]}parseWrapper(e){if(!e)return;this._state=e.readString(),this._scoreName=e.readString(),this._exhibitionType=e.readInt(),this._columnName=e.readString(),this._columnPointsName=e.readString();let t=e.readInt();for(;t>0;){const i=new QA;i.score=e.readString(),i.user=e.readString(),this._entries.push(i),t--}this.flags=0,super.parseWrapper(e)}initializeFromRoomObjectModel(e){this._entries=[];const t=e.getValue(D.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT);let i=0;for(;i<t;){const r=new QA;r.score=e.getValue(D.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+i),r.user=e.getValue(D.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+i),this._entries.push(r),i++}this._scoreName=e.getValue(D.FURNITURE_HIGHSCORE_VARIABLE_NAME),this._exhibitionType=e.getValue(D.FURNITURE_HIGHSCORE_VARIABLE_EXHIBITION_TYPE),this._columnName=e.getValue(D.FURNITURE_HIGHSCORE_VARIABLE_COLUMN_NAME),this._columnPointsName=e.getValue(D.FURNITURE_HIGHSCORE_VARIABLE_COLUMN_POINTS_NAME),super.initializeFromRoomObjectModel(e)}writeRoomObjectModel(e){if(super.writeRoomObjectModel(e),e.setValue(D.FURNITURE_DATA_FORMAT,eE.FORMAT_KEY),e.setValue(D.FURNITURE_HIGHSCORE_VARIABLE_NAME,this._scoreName),e.setValue(D.FURNITURE_HIGHSCORE_VARIABLE_EXHIBITION_TYPE,this._exhibitionType),e.setValue(D.FURNITURE_HIGHSCORE_VARIABLE_COLUMN_NAME,this._columnName),e.setValue(D.FURNITURE_HIGHSCORE_VARIABLE_COLUMN_POINTS_NAME,this._columnPointsName),this._entries){e.setValue(D.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT,this._entries.length);let t=0;for(;t<this._entries.length;){const i=this._entries[t];e.setValue(D.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+t,i.score),e.setValue(D.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+t,i.user),t++}}}getLegacyString(){return this._state}get entries(){return this._entries}get scoreName(){return this._scoreName}get exhibitionType(){return this._exhibitionType}get columnName(){return this._columnName}get columnPointsName(){return this._columnPointsName}};eE.FORMAT_KEY=Kn.HIGHSCORE_VARIABLE_KEY;let mf=eE;class ka{static getData(e){let t=null;switch(e&255){case df.FORMAT_KEY:t=new df;break;case _f.FORMAT_KEY:t=new _f;break;case gf.FORMAT_KEY:t=new gf;break;case Xr.FORMAT_KEY:t=new Xr;break;case Yu.FORMAT_KEY:t=new Yu;break;case bd.FORMAT_KEY:t=new bd;break;case qa.FORMAT_KEY:t=new qa;break;case Cg.FORMAT_KEY:t=new Cg;break;case mf.FORMAT_KEY:t=new mf;break}return t?(t.flags=e&65280,t):null}}const Vl=class Vl{};Vl.MINIMUM=-2,Vl.ROOM=0,Vl.FLOOR=10,Vl.WALL=20,Vl.UNIT=100,Vl.CURSOR=200;let Q=Vl;const He=class He{};He.FURNITURE_BASIC="furniture_basic",He.FURNITURE_MULTISTATE="furniture_multistate",He.FURNITURE_MULTIHEIGHT="furniture_multiheight",He.FURNITURE_RANDOMSTATE="furniture_randomstate",He.FURNITURE_PLACEHOLDER="furniture_placeholder",He.FURNITURE_CREDIT="furniture_credit",He.FURNITURE_STICKIE="furniture_stickie",He.FURNITURE_PRESENT="furniture_present",He.FURNITURE_TROPHY="furniture_trophy",He.FURNITURE_ECOTRON_BOX="furniture_ecotron_box",He.FURNITURE_DICE="furniture_dice",He.FURNITURE_HOCKEY_SCORE="furniture_hockey_score",He.FURNITURE_HABBOWHEEL="furniture_habbowheel",He.FURNITURE_ONE_WAY_DOOR="furniture_one_way_door",He.FURNITURE_PLANET_SYSTEM="furniture_planet_system",He.FURNITURE_WINDOW="furniture_window",He.FURNITURE_EXTERNAL_IMAGE_WALLITEM="furniture_external_image_wallitem",He.FURNITURE_ROOMDIMMER="furniture_roomdimmer",He.FURNITURE_SOUND_MACHINE="furniture_sound_machine",He.FURNITURE_JUKEBOX="furniture_jukebox",He.FURNITURE_CRACKABLE="furniture_crackable",He.FURNITURE_PUSHABLE="furniture_pushable",He.FURNITURE_CLOTHING_CHANGE="furniture_clothing_change",He.FURNITURE_COUNTER_CLOCK="furniture_counter_clock",He.FURNITURE_SCORE="furniture_score",He.FURNITURE_ES="furniture_es",He.FURNITURE_FIREWORKS="furniture_fireworks",He.FURNITURE_SONG_DISK="furniture_song_disk",He.FURNITURE_BB="furniture_bb",He.FURNITURE_BG="furniture_bg",He.FURNITURE_WELCOME_GIFT="furniture_welcome_gift",He.FURNITURE_FLOOR_HOLE="furniture_floor_hole",He.FURNITURE_MANNEQUIN="furniture_mannequin",He.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized",He.FURNITURE_GROUP_FORUM_TERMINAL="furniture_group_forum_terminal",He.FURNITURE_PET_CUSTOMIZATION="furniture_pet_customization",He.FURNITURE_CUCKOO_CLOCK="furniture_cuckoo_clock",He.FURNITURE_VOTE_COUNTER="furniture_vote_counter",He.FURNITURE_VOTE_MAJORITY="furniture_vote_majority",He.FURNITURE_SOUNDBLOCK="furniture_soundblock",He.FURNITURE_RANDOM_TELEPORT="furniture_random_teleport",He.FURNITURE_MONSTERPLANT_SEED="furniture_monsterplant_seed",He.FURNITURE_PURCHASABLE_CLOTHING="furniture_purchasable_clothing",He.FURNITURE_BACKGROUND_COLOR="furniture_background_color",He.FURNITURE_MYSTERYBOX="furniture_mysterybox",He.FURNITURE_EFFECTBOX="furniture_effectbox",He.FURNITURE_MYSTERYTROPHY="furniture_mysterytrophy",He.FURNITURE_ACHIEVEMENT_RESOLUTION="furniture_achievement_resolution",He.FURNITURE_LOVELOCK="furniture_lovelock",He.FURNITURE_WILDWEST_WANTED="furniture_wildwest_wanted",He.FURNITURE_INFINITY_LOVE="hubbe_lovelock_infinitylove",He.FURNITURE_HWEEN_LOVELOCK="furniture_hween_lovelock",He.FURNITURE_BADGE_DISPLAY="furniture_badge_display",He.FURNITURE_HIGH_SCORE="furniture_high_score",He.FURNITURE_INTERNAL_LINK="furniture_internal_link",He.FURNITURE_CUSTOM_STACK_HEIGHT="furniture_custom_stack_height",He.FURNITURE_YOUTUBE="furniture_youtube",He.FURNITURE_AREA_HIDE="furniture_area_hide",He.FURNITURE_RENTABLE_SPACE="furniture_rentable_space",He.FURNITURE_CHANGE_STATE_WHEN_STEP_ON="furniture_change_state_when_step_on",He.FURNITURE_VIMEO="furniture_vimeo",He.FURNITURE_EDITABLE_INTERNAL_LINK="furniture_editable_internal_link",He.FURNITURE_EDITABLE_ROOM_LINK="furniture_editable_room_link",He.FURNITURE_CRAFTING_GIZMO="furniture_crafting_gizmo",He.ROOM="room",He.USER="user",He.BOT="bot",He.RENTABLE_BOT="rentable_bot",He.PET="pet",He.TILE_CURSOR="tile_cursor",He.SELECTION_ARROW="selection_arrow",He.GAME_SNOWBALL="game_snowball",He.GAME_SNOWSPLASH="game_snowsplash";let Ke=He;const rn=class rn{};rn.OBJECT_UNDEFINED="OBJECT_UNDEFINED",rn.OBJECT_MOVE="OBJECT_MOVE",rn.OBJECT_PLACE="OBJECT_PLACE",rn.OBJECT_ROTATE_POSITIVE="OBJECT_ROTATE_POSITIVE",rn.OBJECT_ROTATE_NEGATIVE="OBJECT_ROTATE_NEGATIVE",rn.OBJECT_MOVE_TO="OBJECT_MOVE_TO",rn.OBJECT_PLACE_TO="OBJECT_PLACE_TO",rn.OBJECT_PICKUP="OBJECT_PICKUP",rn.OBJECT_PICKUP_BOT="OBJECT_PICKUP_BOT",rn.OBJECT_PICKUP_PET="OBJECT_PICKUP_PET",rn.OBJECT_EJECT="OBJECT_EJECT",rn.OBJECT_SAVE_STUFF_DATA="OBJECT_SAVE_STUFF_DATA";let at=rn;const nu=class nu{};nu.USER=1,nu.PET=2,nu.BOT=3,nu.RENTABLE_BOT=4,nu.FURNI=5;let Xt=nu;const nn=class nn{static getTypeNumber(e){return nn.AVATAR_TYPES[e]}static getTypeString(e){for(const t in nn.AVATAR_TYPES)if(t&&nn.AVATAR_TYPES[t]===e)return t;return null}static getRealType(e){switch(e){case nn.BOT:case nn.RENTABLE_BOT:return nn.USER;default:return e}}};nn.USER="user",nn.PET="pet",nn.BOT="bot",nn.RENTABLE_BOT="rentable_bot",nn.MONSTER_PLANT="monsterplant",nn.AVATAR_TYPES={user:1,pet:2,bot:3,rentable_bot:4};let Ft=nn;const Gt=class Gt{};Gt.FURNITURE_STATIC="furniture_static",Gt.FURNITURE_ANIMATED="furniture_animated",Gt.FURNITURE_RESETTING_ANIMATED="furniture_resetting_animated",Gt.FURNITURE_POSTER="furniture_poster",Gt.FURNITURE_EXTERNAL_IMAGE="furniture_external_image",Gt.FURNITURE_HABBOWHEEL="furniture_habbowheel",Gt.FURNITURE_VAL_RANDOMIZER="furniture_val_randomizer",Gt.FURNITURE_BOTTLE="furniture_bottle",Gt.FURNITURE_PLANET_SYSTEM="furniture_planet_system",Gt.FURNITURE_QUEUE_TILE="furniture_queue_tile",Gt.FURNITURE_PARTY_BEAMER="furniture_party_beamer",Gt.FURNITURE_CUBOID="furniture_cuboid",Gt.FURNITURE_GIFT_WRAPPED="furniture_gift_wrapped",Gt.FURNITURE_GIFT_WRAPPED_FIREWORKS="furniture_gift_wrapped_fireworks",Gt.FURNITURE_COUNTER_CLOCK="furniture_counter_clock",Gt.FURNITURE_WATER_AREA="furniture_water_area",Gt.FURNITURE_SCORE_BOARD="furniture_score_board",Gt.FURNITURE_FIREWORKS="furniture_fireworks",Gt.FURNITURE_BB="furniture_bb",Gt.FURNITURE_ISOMETRIC_BB="furniture_isometric_bb",Gt.FURNITURE_BG="furniture_bg",Gt.FURNITURE_STICKIE="furniture_stickie",Gt.FURNITURE_MANNEQUIN="furniture_mannequin",Gt.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized",Gt.FURNITURE_GUILD_ISOMETRIC_BADGE="furniture_guild_isometric_badge",Gt.FURNITURE_VOTE_COUNTER="furniture_vote_counter",Gt.FURNITURE_VOTE_MAJORITY="furniture_vote_majority",Gt.FURNITURE_SOUNDBLOCK="furniture_soundblock",Gt.FURNITURE_BADGE_DISPLAY="furniture_badge_display",Gt.FURNITURE_YOUTUBE="furniture_youtube",Gt.FURNITURE_BUILDER_PLACEHOLDER="furniture_builder_placeholder",Gt.ROOM="room",Gt.USER="user",Gt.PET_ANIMATED="pet_animated",Gt.BOT="bot",Gt.RENTABLE_BOT="rentable_bot",Gt.TILE_CURSOR="tile_cursor";let Ue=Gt;const tE=class tE{constructor(e,t,i,r=null){this._id=e,this._location=t,this._targetLocation=i,this._movementType=r}get id(){return this._id}get location(){return this._location}get targetLocation(){return this._targetLocation}get movementType(){return this._movementType}};tE.MOVE="mv",tE.SLIDE="sld";let wa=tE;const sE=class sE{};sE.KICKED_OUT_OF_ROOM=4008,sE.STRIP_LOCKED_FOR_TRADING=-13001;let US=sE;const N_=class N_{};N_.OLD_IDENTITY=0,N_.NEW_IDENTITY=1,N_.REAL_NOOB=2;let u_=N_;const Hl=class Hl{};Hl.NONE=0,Hl.USER_WITH_RIGHTS=1,Hl.GUILD_MEMBER=2,Hl.GUILD_ADMIN=3,Hl.ROOM_OWNER=4,Hl.MODERATOR=5;let pt=Hl;const Wl=class Wl{static getLocalizationKey(e){switch(e){case Wl.FREE_TRADING:return"${trading.mode.free}";case Wl.ROOM_CONTROLLER_REQUIRED:return"${trading.mode.controller}";case Wl.NO_TRADING:return"${trading.mode.not.allowed}"}return""}};Wl.NO_TRADING=0,Wl.ROOM_CONTROLLER_REQUIRED=1,Wl.FREE_TRADING=2;let pd=Wl;const ea=class ea{};ea.SUPER_USER=98,ea.ADMINISTRATOR=69,ea.COMMUNITY=47,ea.PLAYER_SUPPORT=46,ea.MODERATOR=50,ea.EMPLOYEE=46,ea.BUS_PARTNER=4,ea.PARTNER=3,ea.CELEBRITY=2,ea.NONE=1;let zu=ea;var Du=(a=>(a.FLOOR="S",a.WALL="I",a.EFFECT="E",a.BADGE="B",a.ROBOT="R",a.HABBO_CLUB="H",a.PET="P",a))(Du||{});const A_=class A_{};A_.MATCH_ALL_PIXELS=-1,A_.MATCH_OPAQUE_PIXELS=128,A_.MATCH_NOTHING=256;let Ha=A_;const jh=class jh{};jh.DEFAULT=1,jh.ROOM_PLANE=2,jh.AVATAR=3,jh.AVATAR_OWN=4;let Gn=jh;class tD{}class Y{constructor(e=0,t=0,i=0){this._x=e,this._y=t,this._z=i,this._length=NaN}static sum(e,t){return!e||!t?null:new Y(e.x+t.x,e.y+t.y,e.z+t.z)}static dif(e,t){return!e||!t?null:new Y(e.x-t.x,e.y-t.y,e.z-t.z)}static product(e,t){return e?new Y(e.x*t,e.y*t,e.z*t):null}static dotProduct(e,t){return!e||!t?0:e.x*t.x+e.y*t.y+e.z*t.z}static crossProduct(e,t){return!e||!t?null:new Y(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z,e.x*t.y-e.y*t.x)}static scalarProjection(e,t){if(!e||!t)return-1;const i=t.length;return i>0?(e.x*t.x+e.y*t.y+e.z*t.z)/i:-1}static cosAngle(e,t){if(!e||!t)return 0;const i=e.length*t.length;return i?Y.dotProduct(e,t)/i:0}static isEqual(e,t){return!(!e||!t||e.x!==t.x||e.y!==t.y||e.z!==t.z)}negate(){this._x=-this._x,this._y=-this._y,this._z=-this._z}add(e){e&&(this._x+=e.x,this._y+=e.y,this._z+=e.z,this._length=NaN)}subtract(e){e&&(this._x-=e.x,this._y-=e.y,this._z-=e.z,this._length=NaN)}multiply(e){this._x*=e,this._y*=e,this._z*=e,this._length=NaN}divide(e){e&&(this._x/=e,this._y/=e,this._z/=e,this._length=NaN)}assign(e){e&&(this._x=e.x,this._y=e.y,this._z=e.z,this._length=NaN)}get x(){return this._x}set x(e){this._x=e,this._length=NaN}get y(){return this._y}set y(e){this._y=e,this._length=NaN}get z(){return this._z}set z(e){this._z=e,this._length=NaN}get length(){return isNaN(this._length)&&(this._length=Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)),this._length}toString(){return`[Vector3d: ${this._x}, ${this._y}, ${this._z}]`}}const xa=class xa{};xa.MOUSE_CLICK="click",xa.DOUBLE_CLICK="double_click",xa.MOUSE_MOVE="mousemove",xa.MOUSE_DOWN="mousedown",xa.MOUSE_DOWN_LONG="mousedown_long",xa.MOUSE_UP="mouseup",xa.ROLL_OVER="mouseover",xa.ROLL_OUT="mouseout",xa.RIGHT_CLICK="contextmenu";let Re=xa;const au=class au{};au.TOUCH_START="touchstart",au.TOUCH_MOVE="touchmove",au.TOUCH_CANCEL="touchcancel",au.TOUCH_END="touchend",au.TOUCH_LONG="touchlong";let Kr=au;const Yi=class Yi{constructor(e){this._ordinal=e}get ordinal(){return this._ordinal}equals(e){return e&&e._ordinal==this._ordinal}};Yi.NONE=new Yi(0),Yi.WAVE=new Yi(1),Yi.BLOW=new Yi(2),Yi.LAUGH=new Yi(3),Yi.CRY=new Yi(4),Yi.IDLE=new Yi(5),Yi.JUMP=new Yi(6),Yi.RESPECT=new Yi(7);let ca=Yi;const Oa=class Oa{};Oa.DUMMY="DUMMY",Oa.FRIEND_FURNITURE="FRIEND_FURNITURE",Oa.MONSTERPLANT_SEED="MONSTERPLANT_SEED",Oa.MYSTERY_BOX="MYSTERY_BOX",Oa.EFFECT_BOX="EFFECT_BOX",Oa.MYSTERY_TROPHY="MYSTERY_TROPHY",Oa.RANDOM_TELEPORT="RANDOM_TELEPORT",Oa.PURCHASABLE_CLOTHING="PURCHASABLE_CLOTHING",Oa.GENERIC_USABLE="GENERIC_USABLE";let ys=Oa;const ou=class ou{};ou.LOVE_LOCK=0,ou.CARVE_A_TREE=1,ou.FRIENDS_PORTRAIT=2,ou.WILD_WEST_WANTED=3,ou.HABBOWEEN=4;let JA=ou;const it=class it{};it.CHAT_WIDGET="RWE_CHAT_WIDGET",it.INFOSTAND="RWE_INFOSTAND",it.ME_MENU="RWE_ME_MENU",it.CHAT_INPUT_WIDGET="RWE_CHAT_INPUT_WIDGET",it.FURNI_PLACEHOLDER="RWE_FURNI_PLACEHOLDER",it.FURNI_CREDIT_WIDGET="RWE_FURNI_CREDIT_WIDGET",it.FURNI_STICKIE_WIDGET="RWE_FURNI_STICKIE_WIDGET",it.FURNI_TROPHY_WIDGET="RWE_FURNI_TROPHY_WIDGET",it.FURNI_LOVELOCK_WIDGET="RWE_FURNI_LOVELOCK_WIDGET",it.FURNI_PRESENT_WIDGET="RWE_FURNI_PRESENT_WIDGET",it.FURNI_ECOTRONBOX_WIDGET="RWE_FURNI_ECOTRONBOX_WIDGET",it.FURNI_PET_PACKAGE_WIDGET="RWE_FURNI_PET_PACKAGE_WIDGET",it.PLAYLIST_EDITOR_WIDGET="RWE_PLAYLIST_EDITOR_WIDGET",it.DOORBELL="RWE_DOORBELL",it.LOADINGBAR="RWE_LOADINGBAR",it.ROOM_QUEUE="RWE_ROOM_QUEUE",it.ROOM_POLL="RWE_ROOM_POLL",it.ROOM_VOTE="RWE_ROOM_VOTE",it.USER_CHOOSER="RWE_USER_CHOOSER",it.FURNI_CHOOSER="RWE_FURNI_CHOOSER",it.ROOM_DIMMER="RWE_ROOM_DIMMER",it.FRIEND_REQUEST="RWE_FRIEND_REQUEST",it.CLOTHING_CHANGE="RWE_CLOTHING_CHANGE",it.CONVERSION_TRACKING="RWE_CONVERSION_TRACKING",it.USER_NOTIFICATION="RWE_USER_NOTIFICATION",it.FRIENDS_BAR="RWE_FRIENDS_BAR",it.PURSE_WIDGET="RWE_PURSE_WIDGET",it.AVATAR_INFO="RWE_AVATAR_INFO",it.WELCOME_GIFT="RWE_WELCOME_GIFT",it.SPAMWALL_POSTIT_WIDGET="RWE_SPAMWALL_POSTIT_WIDGET",it.EFFECTS="RWE_EFFECTS",it.MANNEQUIN="RWE_MANNEQUIN",it.FURNITURE_CONTEXT_MENU="RWE_FURNITURE_CONTEXT_MENU",it.LOCATION_WIDGET="RWE_LOCATION_WIDGET",it.CAMERA="RWE_CAMERA",it.ROOM_THUMBNAIL_CAMERA="RWE_ROOM_THUMBNAIL_CAMERA",it.ROOM_BACKGROUND_COLOR="RWE_ROOM_BACKGROUND_COLOR",it.CUSTOM_USER_NOTIFICATION="RWE_CUSTOM_USER_NOTIFICATION",it.FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING="RWE_FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING",it.FRIEND_FURNI_CONFIRM="RWE_FRIEND_FURNI_CONFIRM",it.FRIEND_FURNI_ENGRAVING="RWE_FRIEND_FURNI_ENGRAVING",it.HIGH_SCORE_DISPLAY="RWE_HIGH_SCORE_DISPLAY",it.INTERNAL_LINK="RWE_INTERNAL_LINK",it.CUSTOM_STACK_HEIGHT="RWE_CUSTOM_STACK_HEIGHT",it.YOUTUBE="RWE_YOUTUBE",it.RENTABLESPACE="RWE_RENTABLESPACE",it.VIMEO="RWE_VIMEO",it.ROOM_TOOLS="RWE_ROOM_TOOLS",it.EXTERNAL_IMAGE="RWE_EXTERNAL_IMAGE",it.WORD_QUIZZ="RWE_WORD_QUIZZ",it.UI_HELP_BUBBLE="RWE_UI_HELP_BUBBLE",it.ROOM_LINK="RWE_ROOM_LINK",it.CRAFTING="RWE_CRAFTING",it.ROOMGAME_CHECKERS="RWE_GAME_CHECKERS",it.HIGHSCORE_VARIABLE="RWE_HIGHSCORE_VARIABLE";let Ng=it;const sl=class sl{};sl.INFOSTAND_EXTRA_PARAM="RWEIEP_INFOSTAND_EXTRA_PARAM",sl.JUKEBOX="RWEIEP_JUKEBOX",sl.USABLE_PRODUCT="RWEIEP_USABLE_PRODUCT",sl.SONGDISK="RWEIEP_SONGDISK",sl.CRACKABLE_FURNI="RWEIEP_CRACKABLE_FURNI",sl.BRANDING_OPTIONS="RWEIEP_BRANDING_OPTIONS",sl.USABLE="RWEIEP_USABLE";let hi=sl;const b_=class b_{};b_.NOBODY=0,b_.CONTROLLER=1,b_.EVERYBODY=2;let ff=b_;const Lh=class Lh{};Lh.NORMAL=0,Lh.GENERIC=1,Lh.BOT=2,Lh.RESPECT=71;let uc=Lh;class Qr{constructor(){this._isDisposed=!1,this._isDisposing=!1}dispose(){this._isDisposed||this._isDisposing||(this._isDisposing=!0,this.onDispose(),this._isDisposed=!0,this._isDisposing=!1)}onDispose(){}get disposed(){return this._isDisposed}get isDisposing(){return this._isDisposing}}class Sn extends Qr{constructor(){super(),this._listeners=new Map}onDispose(){this.removeAllListeners(),super.onDispose()}addEventListener(e,t){if(!e||!t)return;const i=this._listeners.get(e);if(!i){this._listeners.set(e,[t]);return}i.push(t)}removeEventListener(e,t){if(!e||!t)return;const i=this._listeners.get(e);if(!(!i||!i.length)){for(const[r,n]of i.entries())if(!(!n||n!==t)){i.splice(r,1),i.length||this._listeners.delete(e);return}}}dispatchEvent(e){return e?(ze.events("Dispatched Event",e.type),this.processEvent(e),!0):!1}processEvent(e){const t=this._listeners.get(e.type);if(!t||!t.length)return;const i=[];for(const r of t)r&&i.push(r);for(;i.length;){const r=i.shift();try{r(e)}catch(n){ze.error(n.stack);return}}}removeAllListeners(){this._listeners.clear()}}class Wo extends Qr{constructor(){super(),this._events=new Sn,this._isLoaded=!1,this._isLoading=!1}init(){this._isLoaded||this._isLoading||this.isDisposing||(this._isLoading=!0,this.onInit(),this._isLoaded=!0,this._isLoading=!1)}onInit(){}onDispose(){this._events&&this._events.dispose(),super.onDispose()}reload(){this.dispose(),this.init()}get events(){return this._events}get isLoaded(){return this._isLoaded}get isLoading(){return this._isLoading}}class e2{constructor(e){this._id=parseInt(e.id),this._value=parseInt(e.id),this._prevents=e.prevents||[],this._preventHeadTurn=e.preventHeadTurn||!1,this._isAnimated=!0,e.animated!==void 0&&e.animated===!1&&(this._isAnimated=!1)}get id(){return this._id}get value(){return this._value}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get isAnimated(){return this._isAnimated}}class t2{constructor(e){if(this._id=e.id,this._state=e.state,this._precedence=e.precedence,this._activePartSet=e.activePartSet,this._assetPartDefinition=e.assetPartDefinition,this._lay=e.lay,this._geometryType=e.geometryType,this._isMain=e.main||!1,this._isDefault=e.isDefault||!1,this._isAnimation=e.animation||!1,this._startFromFrameZero=e.startFromFrameZero||!1,this._prevents=e.prevents||[],this._preventHeadTurn=e.preventHeadTurn||!1,this._types=new Map,this._params=new Map,this._defaultParameterValue="",this._canvasOffsets=null,e.params&&e.params.length>0)for(const t of e.params)t&&(t.id==="default"?this._defaultParameterValue=t.value:this._params.set(t.id,t.value));if(e.types&&e.types.length>0)for(const t of e.types){if(!t)continue;const i=new e2(t);this._types.set(i.id,i)}}setOffsets(e,t,i){this._canvasOffsets||(this._canvasOffsets=new Map);let r=this._canvasOffsets.get(e);r||(r=new Map,this._canvasOffsets.set(e,r)),r.set(t,i)}getOffsets(e,t){if(!this._canvasOffsets)return null;const i=this._canvasOffsets.get(e);return i?i.get(t):null}getType(e){if(!e)return null;const t=this._types.get(parseInt(e));return t||null}getParameterValue(e){if(!e)return"";const t=this._params.get(e);return t||this._defaultParameterValue}getPrevents(e){return this._prevents.concat(this.getTypePrevents(e))}getTypePrevents(e){if(!e)return[];const t=this._types.get(parseInt(e));return t?t.prevents:[]}getPreventHeadTurn(e){if(!e)return this._preventHeadTurn;const t=this.getType(e);return t?t.preventHeadTurn:this._preventHeadTurn}isAnimated(e){if(!e)return!0;const t=this.getType(e);return t?t.isAnimated:!0}get id(){return this._id}get state(){return this._state}get precedence(){return this._precedence}get activePartSet(){return this._activePartSet}get assetPartDefinition(){return this._assetPartDefinition}get lay(){return this._lay}get geometryType(){return this._geometryType}get isMain(){return this._isMain}get isDefault(){return this._isDefault}get isAnimation(){return this._isAnimation}get startFromFrameZero(){return this._startFromFrameZero}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get params(){return this._params}}class wS{constructor(e,t="",i=0){this._actionType=e||"",this._actionParameter=t||"",this._definition=null,this._startFrame=i||0,this._overridingAction=null}dispose(){this._actionType=null,this._actionParameter=null,this._definition=null}get id(){return this._definition?this._definition.id+"_"+this._actionParameter:""}get actionType(){return this._actionType}get actionParameter(){return this._actionParameter}set actionParameter(e){this._actionParameter=e}get definition(){return this._definition}set definition(e){this._definition=e}get startFrame(){return this._startFrame}get overridingAction(){return this._overridingAction}set overridingAction(e){this._overridingAction=e}}class s2{constructor(e,t){this._assets=e,this._actions=new Map,this._defaultAction=null,this.updateActions(t)}updateActions(e){if(e){for(const t of e.actions){if(!t||!t.state)continue;const i=new t2(t);this._actions.set(i.state,i)}e.actionOffsets&&this.parseActionOffsets(e.actionOffsets)}}parseActionOffsets(e){if(!(!e||!e.length))for(const t of e){const i=this._actions.get(t.action);if(i)for(const r of t.offsets){const n=r.size||"",o=r.direction;if(n===""||o===void 0)continue;const l=r.x||0,c=r.y||0,u=r.z||0;i.setOffsets(n,o,[l,c,u])}}}getActionDefinition(e){if(!e)return null;for(const t of this._actions.values())if(!(!t||t.id!==e))return t;return null}getActionDefinitionWithState(e){const t=this._actions.get(e);return t||null}getDefaultAction(){if(this._defaultAction)return this._defaultAction;for(const e of this._actions.values())if(!(!e||!e.isDefault))return this._defaultAction=e,e;return null}getCanvasOffsets(e,t,i){let r=[];for(const n of e){if(!n)continue;const o=this._actions.get(n.actionType),l=o&&o.getOffsets(t,i);l&&(r=l)}return r}sortActions(e){if(!e)return null;e=this.filterActions(e);const t=[];for(const i of e){if(!i)continue;const r=this._actions.get(i.actionType);r&&(i.definition=r,t.push(i))}return t.sort(this.sortByPrecedence),t}filterActions(e){let t=[];const i=[];for(const r of e){if(!r)continue;const n=this._actions.get(r.actionType);n&&(t=t.concat(n.getPrevents(r.actionParameter)))}for(const r of e){if(!r)continue;let n=r.actionType;r.actionType==="fx"&&(n=n+("."+r.actionParameter)),!(t.indexOf(n)>=0)&&i.push(r)}return i}sortByPrecedence(e,t){if(!e||!t)return 0;const i=e.definition.precedence,r=t.definition.precedence;return i<r?1:i>r?-1:0}}class i2{constructor(e,t){this._name=e,this._link=t.link,this._flipH=t.flipH,this._flipV=t.flipV}get name(){return this._name}get link(){return this._link}get flipH(){return this._flipH}get flipV(){return this._flipV}}class r2{constructor(e,t){this._avatarRenderManager=e,this._aliases=new Map,this._assets=t,this._missingAssetNames=[]}dispose(){this._assets=null,this._aliases=null}reset(){this.init()}init(){for(const e of this._assets.collections.values()){if(!e)continue;const t=e.data&&e.data.aliases;if(t)for(const i in t){const r=t[i];r&&this._aliases.set(i,new i2(i,r))}}}hasAlias(e){return!!this._aliases.get(e)}getAssetName(e){let t=e,i=5;for(;this.hasAlias(t)&&i>=0;)t=this._aliases.get(t).link,i--;return t}getAsset(e){if(!this._assets)return null;e=this.getAssetName(e);const t=this._assets.getAsset(e);return t||null}}class n2{constructor(e){this._id=e.id||"",this._align=e.align||"",this._base=e.base||"",this._ink=e.ink||0,this._blend=0;const t=e.blend;t&&t.length>0&&(this._blend=parseInt(t),this._blend>1&&(this._blend=this._blend/100))}get id(){return this._id}get align(){return this._align}get base(){return this._base}get ink(){return this._ink}get blend(){return this._blend}get isBlended(){return this._blend!==1}}const iE=class iE{constructor(e,t,i){if(this._id=e.id,this._animationFrame=e.frame||0,this._dx=e.dx||0,this._dy=e.dy||0,this._dz=e.dz||0,this._directionOffset=e.dd||0,this._type=t,this._base=e.base||"",this._items=new Map,e.items)for(const r of e.items)this._items.set(r.id,r.base);this._base!==""&&this.baseAsInt().toString(),i&&(this._action=new wS(i.state,this.base),this._action.definition=i)}get items(){return this._items}baseAsInt(){let e=0,t=0;for(;t<this._base.length;)e=e+this._base.charCodeAt(t),t++;return e}get id(){return this._id}get animationFrame(){return this._animationFrame}get dx(){return this._dx}get dy(){return this._dy}get dz(){return this._dz}get dd(){return this._directionOffset}get type(){return this._type}get base(){return this._base}get action(){return this._action}};iE.BODYPART="bodypart",iE.FX="fx";let ja=iE;class a2{constructor(e){this._ink=e.ink;let t=e.foreground,i=e.background;t=t.replace("#",""),i=i.replace("#",""),this._foreGround=parseInt(t,16),this._backGround=parseInt(i,16),this._colorTransform=null,this._rgb=parseInt(t,16),this._r=this._rgb>>16&255,this._g=this._rgb>>8&255,this._b=this._rgb>>0&255,this._redMultiplier=this._r/255*1,this._greenMultiplier=this._g/255*1,this._blueMultiplier=this._b/255*1,this._alphaMultiplier=1,this._paletteIsGrayscale=!0,this._ink===37&&(this._alphaMultiplier=.5,this._paletteIsGrayscale=!1),this._colorTransform=new $y({red:this._r/255,green:this._g/255,blue:this._b/255,alpha:this._alphaMultiplier}),this._colorMap=this.generatePaletteMapForGrayscale(this._backGround,this._foreGround)}get ink(){return this._ink}get colorTransform(){return this._colorTransform}get reds(){return this._colorMap.get("reds")}get greens(){return this._colorMap.get("greens")}get blues(){return this._colorMap.get("blues")}get alphas(){return this._colorMap.get("alphas")}get paletteIsGrayscale(){return this._paletteIsGrayscale}generatePaletteMapForGrayscale(e,t){const i=e>>24&255,r=e>>16&255,n=e>>8&255,o=e>>0&255,l=t>>24&255,c=t>>16&255,u=t>>8&255,d=t>>0&255,_=(l-i)/255,m=(c-r)/255,f=(u-n)/255,E=(d-o)/255,I=new Map,p=[],S=[],R=[];let O=i,C=r,A=n,b=o;for(let y=0;y<256;y++)C==r&&A==n&&b==o&&(O=0),O=O+_,C=C+m,A=A+f,b=b+E,p.push(O<<24|C<<16|A<<8|b),S.push(O<<24|C<<16|A<<8|b),R.push(O<<24|C<<16|A<<8|b);return I.set("alphas",p),I.set("reds",p),I.set("greens",S),I.set("blues",R),I}}class o2{constructor(e){this._offset=e.offset}get offset(){return this._offset}}class l2{constructor(e,t){this._animation=e,this._id=t.id,this._ink=t.ink,this._member=t.member,this._hasStaticY=!!t.staticY,this._hasDirections=!!t.directions,this._dx=[],this._dy=[],this._dz=[];const i=t.directionList;if(i&&i.length)for(const r of i){const n=r.id;n!==void 0&&(this._dx[n]=r.dx||0,this._dy[n]=r.dy||0,this._dz[n]=r.dz||0)}}getDirectionOffsetX(e){return e<this._dx.length?this._dx[e]:0}getDirectionOffsetY(e){return e<this._dy.length?this._dy[e]:0}getDirectionOffsetZ(e){return e<this._dz.length?this._dz[e]:0}get animation(){return this._animation}get id(){return this._id}get ink(){return this._ink}get member(){return this._member}get hasDirections(){return this._hasDirections}get hasStaticY(){return this._hasStaticY}}const Ph=class Ph{constructor(e,t){if(this._id=t.name,this._description=this._id,this._frames=[],this._spriteData=null,this._avatarData=null,this._directionData=null,this._removeData=null,this._addData=null,this._overriddenActions=null,this._overrideFrames=null,this._resetOnToggle=t.resetOnToggle||!1,t.sprites&&t.sprites.length){this._spriteData=[];for(const i of t.sprites)this._spriteData.push(new l2(this,i))}if(t.avatars&&t.avatars.length&&(this._avatarData=new a2(t.avatars[0])),t.directions&&t.directions.length&&(this._directionData=new o2(t.directions[0])),t.removes&&t.removes.length){this._removeData=[];for(const i of t.removes)this._removeData.push(i.id)}if(t.adds&&t.adds.length){this._addData=[];for(const i of t.adds)this._addData.push(new n2(i))}if(t.overrides&&t.overrides.length){this._overrideFrames=new Map,this._overriddenActions=new Map;for(const i of t.overrides){const r=i.name,n=i.override;this._overriddenActions.set(n,r);const o=[];this.parseFrames(o,i.frames,e),this._overrideFrames.set(r,o)}}this.parseFrames(this._frames,t.frames,e)}parseFrames(e,t,i){if(!(!t||!t.length))for(const r of t){let n=1;r.repeats&&r.repeats>1&&(n=r.repeats);let o=0;for(;o<n;){const l=[];if(r.bodyparts&&r.bodyparts.length)for(const c of r.bodyparts){const u=i.getActionDefinition(c.action),d=new ja(c,ja.BODYPART,u);l.push(d)}if(r.fxs&&r.fxs.length)for(const c of r.fxs){const u=i.getActionDefinition(c.action),d=new ja(c,ja.FX,u);l.push(d)}e.push(l),o++}}}frameCount(e=null){if(!e)return this._frames.length;if(this._overrideFrames){const t=this._overrideFrames.get(e);if(t)return t.length}return 0}hasOverriddenActions(){return this._overriddenActions?this._overriddenActions.size>0:!1}overriddenActionNames(){if(!this._overriddenActions)return null;const e=[];for(const t of this._overriddenActions.keys())e.push(t);return e}overridingAction(e){return this._overriddenActions?this._overriddenActions.get(e):null}getFrame(e,t=null){e<0&&(e=0);let i=[];if(!t)this._frames.length>0&&(i=this._frames[e%this._frames.length]);else{const r=this._overrideFrames.get(t);r&&r.length>0&&(i=r[e%r.length])}return i}getAnimatedBodyPartIds(e,t=null){const i=[];for(const r of this.getFrame(e,t))if(r.type===ja.BODYPART)i.push(r.id);else if(r.type===ja.FX&&this._addData&&this._addData.length)for(const n of this._addData)n.id===r.id&&i.push(n.align);return i}getLayerData(e,t,i=null){for(const r of this.getFrame(e,i)){if(r.id===t)return r;if(r.type===ja.FX&&this._addData&&this._addData.length){for(const n of this._addData)if(n.align===t&&n.id===r.id)return r}}return null}hasAvatarData(){return this._avatarData!==null}hasDirectionData(){return this._directionData!==null}hasAddData(){return this._addData!==null}getAddData(e){if(this._addData){for(const t of this._addData)if(t.id===e)return t}return null}get id(){return this._id}get spriteData(){return this._spriteData||Ph.EMPTY_ARRAY}get avatarData(){return this._avatarData}get directionData(){return this._directionData}get removeData(){return this._removeData||Ph.EMPTY_ARRAY}get addData(){return this._addData||Ph.EMPTY_ARRAY}toString(){return this._description}get resetOnToggle(){return this._resetOnToggle}};Ph.EMPTY_ARRAY=[];let FS=Ph;class c2{constructor(){this._animations=new Map}registerAnimation(e,t){if(!t)return!1;const i=t[Object.keys(t)[0]],r=new FS(e,i);return this._animations.set(i.name,r),!0}getAnimation(e){const t=this._animations.get(e);return t||null}getLayerData(e,t,i){const r=this.getAnimation(e);return r?r.getLayerData(t,i):null}get animations(){return this._animations}}class w{constructor(e,t){this._callBack=e,this._parserClass=t,this._parser=null,this._connection=null}dispose(){this._callBack=null,this._parserClass=null,this._parser=null,this._connection=null}get callBack(){return this._callBack}get parserClass(){return this._parserClass}get parser(){return this._parser}set parser(e){this._parser=e}get connection(){return this._connection}set connection(e){this._connection=e}}class _t{constructor(e){this._type=e}get type(){return this._type}}const Uh=class Uh extends _t{constructor(e,t,i){super(e),this._connection=t,this._originalEvent=event}get connection(){return this._connection}get originalEvent(){return this._originalEvent}};Uh.CONNECTION_OPENED="SCE_OPEN",Uh.CONNECTION_CLOSED="SCE_CLOSED",Uh.CONNECTION_ERROR="SCE_ERROR",Uh.CONNECTION_MESSAGE="SCE_MESSAGE";let er=Uh;const ZN=class ZN extends _t{constructor(e,t){super(e),this._library=t}get library(){return this._library}};ZN.DOWNLOAD_COMPLETE="ARELE_DOWNLOAD_COMPLETE";let Mu=ZN;const eA=class eA{};eA.AVATAR_RENDER_READY="AVATAR_RENDER_READY";let Ag=eA;const tA=class tA extends _t{constructor(e,t){super(e),this._library=t}get library(){return this._library}};tA.DOWNLOAD_COMPLETE="ARLE_DOWNLOAD_COMPLETE";let ju=tA;const sA=class sA extends _t{constructor(e){super(e)}};sA.INITIALIZED="RCWM_INITIALIZED";let bg=sA;const il=class il extends _t{constructor(e,t){super(e),this._connection=t}get connection(){return this._connection}};il.CONNECTION_ESTABLISHED="NCE_ESTABLISHED",il.CONNECTION_CLOSED="NCE_CLOSED",il.CONNECTION_ERROR="NCE_ERROR",il.CONNECTION_HANDSHAKING="NCE_HANDSHAKING",il.CONNECTION_HANDSHAKED="NCE_HANDSHAKED",il.CONNECTION_HANDSHAKE_FAILED="NCE_HANDSHAKE_FAILED",il.CONNECTION_AUTHENTICATED="NCE_AUTHENTICATED";let Si=il;const rE=class rE extends _t{constructor(e){super(e)}};rE.LOADED="NLE_LOADED",rE.FAILED="NLE_FAILED";let hc=rE;const v_=class v_ extends _t{constructor(){super(v_.SETTINGS_UPDATED)}clone(){const e=new v_;return e._volumeSystem=this._volumeSystem,e._volumeFurni=this._volumeFurni,e._volumeTrax=this._volumeTrax,e._oldChat=this._oldChat,e._roomInvites=this._roomInvites,e._cameraFollow=this._cameraFollow,e._flags=this._flags,e._chatType=this._chatType,e._whisperingToWired=this._whisperingToWired,e._volumeSoundEffects=this._volumeSoundEffects,e._optionalPathFinderMode=this._optionalPathFinderMode,e._hideOnline=this._hideOnline,e._hideInRoom=this._hideInRoom,e._hideTyping=this._hideTyping,e._hideLastSeen=this._hideLastSeen,e._allowFriendRequests=this._allowFriendRequests,e._allowTargetCommands=this._allowTargetCommands,e._allowWhispering=this._allowWhispering,e._allowFollow=this._allowFollow,e._allowTrade=this._allowTrade,e._allowGifts=this._allowGifts,e._allowCopy=this._allowCopy,e}get volumeSystem(){return this._volumeSystem}set volumeSystem(e){this._volumeSystem=e}get volumeFurni(){return this._volumeFurni}set volumeFurni(e){this._volumeFurni=e}get volumeTrax(){return this._volumeTrax}set volumeTrax(e){this._volumeTrax=e}get volumeSoundEffects(){return this._volumeSoundEffects}set volumeSoundEffects(e){this._volumeSoundEffects=e}get oldChat(){return this._oldChat}set oldChat(e){this._oldChat=e}get roomInvites(){return this._roomInvites}set roomInvites(e){this._roomInvites=e}get cameraFollow(){return this._cameraFollow}set cameraFollow(e){this._cameraFollow=e}get flags(){return this._flags}set flags(e){this._flags=e}get chatType(){return this._chatType}set chatType(e){this._chatType=e}get whisperingToWired(){return this._whisperingToWired}set whisperingToWired(e){this._whisperingToWired=e}get optionalPathFinderMode(){return this._optionalPathFinderMode}set optionalPathFinderMode(e){this._optionalPathFinderMode=e}get hideOnline(){return this._hideOnline}set hideOnline(e){this._hideOnline=e}get hideInRoom(){return this._hideInRoom}set hideInRoom(e){this._hideInRoom=e}get hideTyping(){return this._hideTyping}set hideTyping(e){this._hideTyping=e}get hideLastSeen(){return this._hideLastSeen}set hideLastSeen(e){this._hideLastSeen=e}get allowFriendRequests(){return this._allowFriendRequests}set allowFriendRequests(e){this._allowFriendRequests=e}get allowTargetCommands(){return this._allowTargetCommands}set allowTargetCommands(e){this._allowTargetCommands=e}get allowWhispering(){return this._allowWhispering}set allowWhispering(e){this._allowWhispering=e}get allowFollow(){return this._allowFollow}set allowFollow(e){this._allowFollow=e}get allowTrade(){return this._allowTrade}set allowTrade(e){this._allowTrade=e}get allowGifts(){return this._allowGifts}set allowGifts(e){this._allowGifts=e}get allowCopy(){return this._allowCopy}set allowCopy(e){this._allowCopy=e}};v_.SETTINGS_UPDATED="NSE_SETTINGS_UPDATED";let Ic=v_;const wh=class wh extends _t{constructor(e,t,i=.5,r=!1){super(e),this._sampleCode=t,this._volume=i,this._loop=r}get sampleCode(){return this._sampleCode}get volume(){return this._volume}get loop(){return this._loop}};wh.PLAY_SOUND="NSOE_PLAY_SOUND",wh.PLAY_SOUND_EFFECT="NSOE_PLAY_SOUND_EFFECT",wh.PLAY_MUSIC="NSOE_PLAY_MUSIC",wh.STOP_ALL_WIRED_SOUNDS="NSOE_STOP_ALL_WIRED_SOUNDS";let Ws=wh;const nE=class nE extends _t{constructor(e){super(e)}get iconId(){return this._iconId}set iconId(e){this._iconId=e}get iconName(){return this._iconName}set iconName(e){this._iconName=e}};nE.TOOLBAR_CLICK="NTE_TOOLBAR_CLICK",nE.SELECT_OWN_AVATAR="NTE_SELECT_OWN_AVATAR";let kS=nE;const aE=class aE extends kS{constructor(e,t,i){super(aE.ANIMATE_ICON),this._image=e,this._x=t,this._y=i}get image(){return this._image}get x(){return this._x}get y(){return this._y}};aE.ANIMATE_ICON="NTAIE_ANIMATE_ICON";let vg=aE;const rl=class rl extends _t{constructor(e,t){super(e),this._roomId=t}get roomId(){return this._roomId}};rl.INITIALIZED="REE_INITIALIZED",rl.ENGINE_INITIALIZED="REE_ENGINE_INITIALIZED",rl.OBJECTS_INITIALIZED="REE_OBJECTS_INITIALIZED",rl.NORMAL_MODE="REE_NORMAL_MODE",rl.GAME_MODE="REE_GAME_MODE",rl.ROOM_ZOOMED="REE_ROOM_ZOOMED",rl.DISPOSED="REE_DISPOSED";let Ot=rl;const oE=class oE extends Ot{constructor(e,t,i,r){super(oE.ROOM_COLOR,e),this._color=t,this._brightness=i,this._bgOnly=r}get color(){return this._color}get brightness(){return this._brightness}get bgOnly(){return this._bgOnly}};oE.ROOM_COLOR="REE_ROOM_COLOR";let pf=oE;const y_=class y_ extends _t{constructor(e,t){super(e),this._contentType=t}get contentType(){return this._contentType}};y_.RCLE_SUCCESS="RCLE_SUCCESS",y_.RCLE_FAILURE="RCLE_FAILURE",y_.RCLE_CANCEL="RCLE_CANCEL";let Il=y_;const lE=class lE extends Ot{constructor(e,t,i){super(lE.ROOM_DRAG,e),this._offsetX=t,this._offsetY=i}get offsetX(){return this._offsetX}get offsetY(){return this._offsetY}};lE.ROOM_DRAG="RDE_ROOM_DRAG";let Ef=lE;const cE=class cE extends Ot{constructor(e,t,i,r,n,o){super(cE.ROOM_COLOR,e),this._state=t,this._presetId=i,this._effectId=r,this._color=n,this._brightness=o}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};cE.ROOM_COLOR="REDSE_ROOM_COLOR";let If=cE;const Ur=class Ur extends Ot{constructor(e,t,i,r,n=!0){super(e,t),this._objectId=i,this._category=r,this._sendClickPacket=n}get sendClickPacket(){return this._sendClickPacket}get objectId(){return this._objectId}get category(){return this._category}};Ur.SELECTED="REOE_SELECTED",Ur.DESELECTED="REOE_DESELECTED",Ur.ADDED="REOE_ADDED",Ur.REMOVED="REOE_REMOVED",Ur.PLACED="REOE_PLACED",Ur.PLACED_ON_USER="REOE_PLACED_ON_USER",Ur.CONTENT_UPDATED="REOE_CONTENT_UPDATED",Ur.REQUEST_MOVE="REOE_REQUEST_MOVE",Ur.REQUEST_ROTATE="REOE_REQUEST_ROTATE",Ur.REQUEST_MANIPULATION="REOE_REQUEST_MANIPULATION",Ur.MOUSE_ENTER="REOE_MOUSE_ENTER",Ur.MOUSE_LEAVE="REOE_MOUSE_LEAVE",Ur.DOUBLE_CLICK="REOE_DOUBLE_CLICK";let ke=Ur;class Tf extends ke{constructor(e,t,i,r,n,o,l,c,u,d,_,m,f,E){super(e,t,i,r),this._wallLocation="",this._x=0,this._y=0,this._z=0,this._direction=0,this._placedInRoom=!1,this._placedOnFloor=!1,this._placedOnWall=!1,this._instanceData=null,this._objectPlacementSource=null,this._wallLocation=n,this._x=o,this._y=l,this._z=c,this._direction=u,this._placedInRoom=d,this._placedOnFloor=_,this._placedOnWall=m,this._instanceData=f,this._objectPlacementSource=E}get wallLocation(){return this._wallLocation}get x(){return this._x}get y(){return this._y}get z(){return this._z}get direction(){return this._direction}get placedInRoom(){return this._placedInRoom}get placedOnFloor(){return this._placedOnFloor}get placedOnWall(){return this._placedOnWall}get instanceData(){return this._instanceData}get objectPlacementSource(){return this._objectPlacementSource}}class u2 extends ke{constructor(e,t,i,r,n,o){super(e,t,i,r),this._droppedObjectId=n,this._droppedObjectCategory=o}get droppedObjectId(){return this._droppedObjectId}get droppedObjectCategory(){return this._droppedObjectCategory}}const uE=class uE extends ke{constructor(e,t,i,r,n,o=1){super(e,t,i,r),this._soundId=n,this._pitch=o}get soundId(){return this._soundId}get pitch(){return this._pitch}};uE.PLAY_SOUND="REOPSE_PLAY_SOUND",uE.PLAY_SOUND_AT_PITCH="REOPSE_PLAY_SOUND_AT_PITCH";let Ih=uE;const Fh=class Fh extends ke{};Fh.FURNI_CLICK="RERAE_FURNI_CLICK",Fh.FURNI_DOUBLE_CLICK="RERAE_FURNI_DOUBLE_CLICK",Fh.TOOLTIP_SHOW="RERAE_TOOLTIP_SHOW",Fh.TOOLTIP_HIDE="RERAE_TOOLTIP_HIDE";let Mo=Fh;const kh=class kh extends ke{constructor(e,t,i,r,n,o=1){super(e,t,i,r),this._sampleId=n,this._pitch=o}get sampleId(){return this._sampleId}get pitch(){return this._pitch}};kh.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED",kh.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED",kh.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE",kh.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";let Un=kh;const Ut=class Ut extends ke{constructor(e,t,i,r,n=null){super(e,t,i,r),this._widget=n}get widget(){return this._widget}get contextMenu(){return this._widget}};Ut.OPEN_WIDGET="RETWE_OPEN_WIDGET",Ut.CLOSE_WIDGET="RETWE_CLOSE_WIDGET",Ut.OPEN_FURNI_CONTEXT_MENU="RETWE_OPEN_FURNI_CONTEXT_MENU",Ut.CLOSE_FURNI_CONTEXT_MENU="RETWE_CLOSE_FURNI_CONTEXT_MENU",Ut.REQUEST_PLACEHOLDER="RETWE_REQUEST_PLACEHOLDER",Ut.REQUEST_CREDITFURNI="RETWE_REQUEST_CREDITFURNI",Ut.REQUEST_STACK_HEIGHT="RETWE_REQUEST_STACK_HEIGHT",Ut.REQUEST_EXTERNAL_IMAGE="RETWE_REQUEST_EXTERNAL_IMAGE",Ut.REQUEST_STICKIE="RETWE_REQUEST_STICKIE",Ut.REQUEST_PRESENT="RETWE_REQUEST_PRESENT",Ut.REQUEST_TROPHY="RETWE_REQUEST_TROPHY",Ut.REQUEST_TEASER="RETWE_REQUEST_TEASER",Ut.REQUEST_ECOTRONBOX="RETWE_REQUEST_ECOTRONBOX",Ut.REQUEST_DIMMER="RETWE_REQUEST_DIMMER",Ut.REMOVE_DIMMER="RETWE_REMOVE_DIMMER",Ut.REQUEST_CLOTHING_CHANGE="RETWE_REQUEST_CLOTHING_CHANGE",Ut.REQUEST_PLAYLIST_EDITOR="RETWE_REQUEST_PLAYLIST_EDITOR",Ut.REQUEST_MANNEQUIN="RETWE_REQUEST_MANNEQUIN",Ut.REQUEST_MONSTERPLANT_SELECT_REPRODUCE="ROWRE_REQUEST_MONSTERPLANT_SELECT_REPRODUCE",Ut.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG",Ut.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG",Ut.REQUEST_BACKGROUND_COLOR="RETWE_REQUEST_BACKGROUND_COLOR",Ut.REQUEST_MYSTERYBOX_OPEN_DIALOG="RETWE_REQUEST_MYSTERYBOX_OPEN_DIALOG",Ut.REQUEST_EFFECTBOX_OPEN_DIALOG="RETWE_REQUEST_EFFECTBOX_OPEN_DIALOG",Ut.REQUEST_MYSTERYTROPHY_OPEN_DIALOG="RETWE_REQUEST_MYSTERYTROPHY_OPEN_DIALOG",Ut.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING",Ut.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_FAILED",Ut.REQUEST_FRIEND_FURNITURE_CONFIRM="RETWE_REQUEST_FRIEND_FURNITURE_CONFIRM",Ut.REQUEST_FRIEND_FURNITURE_ENGRAVING="RETWE_REQUEST_FRIEND_FURNITURE_ENGRAVING",Ut.REQUEST_BADGE_DISPLAY_ENGRAVING="RETWE_REQUEST_BADGE_DISPLAY_ENGRAVING",Ut.REQUEST_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIGH_SCORE_DISPLAY",Ut.REQUEST_HIDE_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIDE_HIGH_SCORE_DISPLAY",Ut.REQUEST_INTERNAL_LINK="RETWE_REQUEST_INTERNAL_LINK",Ut.REQUEST_ROOM_LINK="RETWE_REQUEST_ROOM_LINK",Ut.REQUEST_YOUTUBE="RETWE_REQUEST_YOUTUBE",Ut.REQUEST_HIDE_AREA="RETWE_REQUEST_AREA_HIDE",Ut.REQUEST_RENTABLE_SPACE="RETWE_REQUEST_RENTABLE_SPACE",Ut.REQUEST_CLOTHING_CHANGE_SAVE="RETWE_REQUEST_CLOTHING_CHANGE_SAVE";let Ie=Ut;const hE=class hE extends ke{constructor(e,t,i,r,n=-1,o=-1){super(e,t,i,r),this._inventoryStripId=n,this._furnitureTypeId=o}get inventoryStripId(){return this._inventoryStripId}get furnitureTypeId(){return this._furnitureTypeId}};hE.USE_PRODUCT_FROM_ROOM="REUPE_USE_PRODUCT_FROM_ROOM",hE.USE_PRODUCT_FROM_INVENTORY="REUPE_USE_PRODUCT_FROM_INVENTORY";let vd=hE;class fa extends _t{constructor(e,t){super(e),this._object=t}get object(){return this._object}get objectId(){return this._object?this._object.id:-1}get objectType(){return this._object?this._object.type:null}}const iA=class iA extends fa{constructor(e,t,i,r=!0){super(e,t),this._badgeId=i,this._groupBadge=r}get badgeId(){return this._badgeId}get groupBadge(){return this._groupBadge}};iA.LOAD_BADGE="ROBAE_LOAD_BADGE";let Wa=iA;const dE=class dE extends fa{constructor(e,t){super(e,t)}};dE.RODRE_CURRENT_USER_ID="RODRE_CURRENT_USER_ID",dE.RODRE_URL_PREFIX="RODRE_URL_PREFIX";let da=dE;const _E=class _E extends fa{constructor(e,t,i,r,n,o){super(_E.DIMMER_STATE,e),this._state=t,this._presetId=i,this._effectId=r,this._color=n,this._brightness=o}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};_E.DIMMER_STATE="RODSUE_DIMMER_STATE";let Bu=_E;const gE=class gE extends fa{constructor(e,t){super(e,t)}};gE.ADD_HOLE="ROFHO_ADD_HOLE",gE.REMOVE_HOLE="ROFHO_REMOVE_HOLE";let Rr=gE;const or=class or extends fa{};or.DICE_OFF="ROFCAE_DICE_OFF",or.DICE_ACTIVATE="ROFCAE_DICE_ACTIVATE",or.USE_HABBOWHEEL="ROFCAE_USE_HABBOWHEEL",or.STICKIE="ROFCAE_STICKIE",or.ENTER_ONEWAYDOOR="ROFCAE_ENTER_ONEWAYDOOR",or.SOUND_MACHINE_INIT="ROFCAE_SOUND_MACHINE_INIT",or.SOUND_MACHINE_START="ROFCAE_SOUND_MACHINE_START",or.SOUND_MACHINE_STOP="ROFCAE_SOUND_MACHINE_STOP",or.SOUND_MACHINE_DISPOSE="ROFCAE_SOUND_MACHINE_DISPOSE",or.JUKEBOX_INIT="ROFCAE_JUKEBOX_INIT",or.JUKEBOX_START="ROFCAE_JUKEBOX_START",or.JUKEBOX_MACHINE_STOP="ROFCAE_JUKEBOX_MACHINE_STOP",or.JUKEBOX_DISPOSE="ROFCAE_JUKEBOX_DISPOSE",or.MOUSE_BUTTON="ROFCAE_MOUSE_BUTTON",or.MOUSE_ARROW="ROFCAE_MOUSE_ARROW";let Ae=or;const rA=class rA extends Ot{constructor(e,t,i,r,n,o){super(e,t),this._enable=i,this._hue=r,this._saturation=n,this._lightness=o}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}};rA.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";let yg=rA;const nA=class nA extends fa{constructor(e,t,i,r,n,o){super(e,t),this._enable=i,this._hue=r,this._saturation=n,this._lightness=o}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}};nA.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";let El=nA;const ro=class ro extends fa{constructor(e,t,i,r=!1,n=!1,o=!1,l=!1){super(e,t),this._eventId="",this._eventId=i,this._altKey=r,this._ctrlKey=n,this._shiftKey=o,this._buttonDown=l}get eventId(){return this._eventId}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get localX(){return this._localX}set localX(e){this._localX=e}get localY(){return this._localY}set localY(e){this._localY=e}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(e){this._spriteOffsetX=e}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(e){this._spriteOffsetY=e}};ro.CLICK="ROE_MOUSE_CLICK",ro.DOUBLE_CLICK="ROE_MOUSE_DOUBLE_CLICK",ro.MOUSE_MOVE="ROE_MOUSE_MOVE",ro.MOUSE_DOWN="ROE_MOUSE_DOWN",ro.MOUSE_DOWN_LONG="ROE_MOUSE_DOWN_LONG",ro.MOUSE_UP="ROE_MOUSE_UP",ro.MOUSE_ENTER="ROE_MOUSE_ENTER",ro.MOUSE_LEAVE="ROE_MOUSE_LEAVE";let rt=ro;const D_=class D_ extends fa{constructor(e,t){super(e,t)}};D_.POSITION_CHANGED="ROME_POSITION_CHANGED",D_.OBJECT_REMOVED="ROME_OBJECT_REMOVED",D_.SLIDE_ANIMATION="ROME_SLIDE_ANIMATION";let Bi=D_;const mE=class mE extends Ae{constructor(e,t,i,r=1){super(e,t),this._soundId=i,this._pitch=r}get soundId(){return this._soundId}get pitch(){return this._pitch}};mE.PLAY_SOUND="ROPSIE_PLAY_SOUND",mE.PLAY_SOUND_AT_PITCH="ROPSIE_PLAY_SOUND_AT_PITCH";let Tl=mE;const lu=class lu extends fa{constructor(e,t,i="",r=""){super(e,t),this._imageUrl="",this._clickUrl="",this._imageUrl=i,this._clickUrl=r}get imageUrl(){return this._imageUrl}get clickUrl(){return this._clickUrl}};lu.ROOM_AD_LOAD_IMAGE="RORAE_ROOM_AD_LOAD_IMAGE",lu.ROOM_AD_FURNI_CLICK="RORAE_ROOM_AD_FURNI_CLICK",lu.ROOM_AD_FURNI_DOUBLE_CLICK="RORAE_ROOM_AD_FURNI_DOUBLE_CLICK",lu.ROOM_AD_TOOLTIP_SHOW="RORAE_ROOM_AD_TOOLTIP_SHOW",lu.ROOM_AD_TOOLTIP_HIDE="RORAE_ROOM_AD_TOOLTIP_HIDE";let vs=lu;const Gh=class Gh extends fa{constructor(e,t,i,r=1){super(e,t),this._sampleId=i,this._pitch=r}get sampleId(){return this._sampleId}get pitch(){return this._pitch}};Gh.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED",Gh.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED",Gh.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE",Gh.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";let Ii=Gh;const no=class no extends ke{};no.SOUND_MACHINE_INIT="ROSM_SOUND_MACHINE_INIT",no.SOUND_MACHINE_SWITCHED_ON="ROSM_SOUND_MACHINE_SWITCHED_ON",no.SOUND_MACHINE_SWITCHED_OFF="ROSM_SOUND_MACHINE_SWITCHED_OFF",no.SOUND_MACHINE_DISPOSE="ROSM_SOUND_MACHINE_DISPOSE",no.JUKEBOX_INIT="ROSM_JUKEBOX_INIT",no.JUKEBOX_SWITCHED_ON="ROSM_JUKEBOX_SWITCHED_ON",no.JUKEBOX_SWITCHED_OFF="ROSM_JUKEBOX_SWITCHED_OFF",no.JUKEBOX_DISPOSE="ROSM_JUKEBOX_DISPOSE";let Hs=no;const fE=class fE extends fa{constructor(e,t,i=0){super(e,t),this._state=i}get state(){return this._state}};fE.STATE_CHANGE="ROSCE_STATE_CHANGE",fE.STATE_RANDOM="ROSCE_STATE_RANDOM";let At=fE;class Ta extends rt{constructor(e,t,i,r,n,o,l=!1,c=!1,u=!1,d=!1){super(e,t,i,l,c,u,d),this._tileX=r,this._tileY=n,this._tileZ=o}get tileX(){return this._tileX}get tileY(){return this._tileY}get tileZ(){return this._tileZ}get tileXAsInt(){return Math.trunc(this._tileX+.499)}get tileYAsInt(){return Math.trunc(this._tileY+.499)}get tileZAsInt(){return Math.trunc(this._tileZ+.499)}}class ph extends rt{constructor(e,t,i,r,n,o,l,c,u,d=!1,_=!1,m=!1,f=!1){super(e,t,i,d,_,m,f),this._wallLocation=new Y,this._wallWd=new Y,this._wallHt=new Y,this._wallLocation.assign(r),this._wallWd.assign(n),this._wallHt.assign(o),this._x=l,this._y=c,this._direction=u}get wallLocation(){return this._wallLocation}get wallWidth(){return this._wallWd}get wallHeight(){return this._wallHt}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}const jt=class jt extends fa{constructor(e,t){super(e,t)}};jt.OPEN_WIDGET="ROWRE_OPEN_WIDGET",jt.CLOSE_WIDGET="ROWRE_CLOSE_WIDGET",jt.OPEN_FURNI_CONTEXT_MENU="ROWRE_OPEN_FURNI_CONTEXT_MENU",jt.CLOSE_FURNI_CONTEXT_MENU="ROWRE_CLOSE_FURNI_CONTEXT_MENU",jt.PLACEHOLDER="ROWRE_PLACEHOLDER",jt.CREDITFURNI="ROWRE_CREDITFURNI",jt.STACK_HEIGHT="ROWRE_STACK_HEIGHT",jt.EXTERNAL_IMAGE="ROWRE_EXTERNAL_IMAGE",jt.STICKIE="ROWRE_STICKIE",jt.PRESENT="ROWRE_PRESENT",jt.TROPHY="ROWRE_TROPHY",jt.TEASER="ROWRE_TEASER",jt.ECOTRONBOX="ROWRE_ECOTRONBOX",jt.DIMMER="ROWRE_DIMMER",jt.WIDGET_REMOVE_DIMMER="ROWRE_WIDGET_REMOVE_DIMMER",jt.CLOTHING_CHANGE="ROWRE_CLOTHING_CHANGE",jt.JUKEBOX_PLAYLIST_EDITOR="ROWRE_JUKEBOX_PLAYLIST_EDITOR",jt.MANNEQUIN="ROWRE_MANNEQUIN",jt.PET_PRODUCT_MENU="ROWRE_PET_PRODUCT_MENU",jt.GUILD_FURNI_CONTEXT_MENU="ROWRE_GUILD_FURNI_CONTEXT_MENU",jt.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG",jt.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG",jt.BACKGROUND_COLOR="ROWRE_BACKGROUND_COLOR",jt.MYSTERYBOX_OPEN_DIALOG="ROWRE_MYSTERYBOX_OPEN_DIALOG",jt.EFFECTBOX_OPEN_DIALOG="ROWRE_EFFECTBOX_OPEN_DIALOG",jt.MYSTERYTROPHY_OPEN_DIALOG="ROWRE_MYSTERYTROPHY_OPEN_DIALOG",jt.ACHIEVEMENT_RESOLUTION_OPEN="ROWRE_ACHIEVEMENT_RESOLUTION_OPEN",jt.ACHIEVEMENT_RESOLUTION_ENGRAVING="ROWRE_ACHIEVEMENT_RESOLUTION_ENGRAVING",jt.ACHIEVEMENT_RESOLUTION_FAILED="ROWRE_ACHIEVEMENT_RESOLUTION_FAILED",jt.FRIEND_FURNITURE_CONFIRM="ROWRE_FRIEND_FURNITURE_CONFIRM",jt.FRIEND_FURNITURE_ENGRAVING="ROWRE_FRIEND_FURNITURE_ENGRAVING",jt.BADGE_DISPLAY_ENGRAVING="ROWRE_BADGE_DISPLAY_ENGRAVING",jt.HIGH_SCORE_DISPLAY="ROWRE_HIGH_SCORE_DISPLAY",jt.HIDE_HIGH_SCORE_DISPLAY="ROWRE_HIDE_HIGH_SCORE_DISPLAY",jt.INERNAL_LINK="ROWRE_INTERNAL_LINK",jt.ROOM_LINK="ROWRE_ROOM_LINK",jt.YOUTUBE="ROWRE_YOUTUBE",jt.HIDE_AREA="ROWRE_HIDE_AREA",jt.RENTABLE_SPACE="ROWRE_RENTABLE_SPACE";let re=jt;class h2{constructor(e,t,i,r,n,o,l=0,c=0,u=!1,d=!1,_=!1,m=!1){this._type=e,this._eventId=t,this._canvasId=i,this._spriteTag=r,this._screenX=n,this._screenY=o,this._localX=l,this._localY=c,this._ctrlKey=u,this._altKey=d,this._shiftKey=_,this._buttonDown=m,this._spriteOffsetX=0,this._spriteOffsetY=0}get type(){return this._type}get eventId(){return this._eventId}get canvasId(){return this._canvasId}get spriteTag(){return this._spriteTag}get screenX(){return this._screenX}get screenY(){return this._screenY}get localX(){return this._localX}get localY(){return this._localY}get ctrlKey(){return this._ctrlKey}get altKey(){return this._altKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(e){this._spriteOffsetX=e}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(e){this._spriteOffsetY=e}}class d2 extends _t{constructor(e){super(e)}}const aA=class aA extends d2{constructor(e,t){super(e),this._targetLocation=t}get targetLocation(){return this._targetLocation}};aA.ROAME_MOVE_TO="ROAME_MOVE_TO";let yd=aA;const pE=class pE extends Ot{constructor(e,t,i=!1,r=!1){super(pE.ROOM_ZOOM,e),this._level=t,this._forceFlip=i,this._asDelta=r}get level(){return this._level}get forceFlip(){return this._forceFlip}get asDelta(){return this._asDelta}};pE.ROOM_ZOOM="REE_ROOM_ZOOM";let Sf=pE;const EE=class EE extends _t{constructor(e,t){super(EE.IMAGE_READY),this._badgeId=e,this._image=t}get badgeId(){return this._badgeId}get image(){return this._image}};EE.IMAGE_READY="BIME_BADGE_IMAGE_READY";let Nl=EE;const IE=class IE extends _t{constructor(e,t){super(IE.MYSTERY_BOX_KEYS_UPDATE),this._boxColor=e,this._keyColor=t}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}};IE.MYSTERY_BOX_KEYS_UPDATE="mbke_update";let Rf=IE;const TE=class TE extends _t{constructor(){super(TE.PERKS_UPDATED)}};TE.PERKS_UPDATED="PUE_perks_updated";let ZA=TE;const cu=class cu extends _t{constructor(e,t,i=!0){super(e),this._session=t,this._openLandingView=i}get session(){return this._session}get openLandingView(){return this._openLandingView}};cu.CREATED="RSE_CREATED",cu.STARTED="RSE_STARTED",cu.RESTARTED="RSE_RESTARTED",cu.ENDED="RSE_ENDED",cu.ROOM_DATA="RSE_ROOM_DATA";let Ve=cu;const wr=class wr extends Ve{constructor(e,t,i,r,n,o=0,l=null,c=-1,u=!1,d=""){super(e,t),this._objectId=i,this._message=r,this._chatType=n,this._links=l,this._extraParam=c,this._style=o,this._isMention=u,this._messageContent=d}get objectId(){return this._objectId}get message(){return this._message}get chatType(){return this._chatType}get links(){return this._links}get extraParam(){return this._extraParam}get style(){return this._style}get isMention(){return this._isMention}get messageContent(){return this._isMention?this._messageContent:null}};wr.CHAT_EVENT="RSCE_CHAT_EVENT",wr.FLOOD_EVENT="RSCE_FLOOD_EVENT",wr.CHAT_TYPE_SPEAK=0,wr.CHAT_TYPE_WHISPER=1,wr.CHAT_TYPE_SHOUT=2,wr.CHAT_TYPE_RESPECT=3,wr.CHAT_TYPE_PETRESPECT=4,wr.CHAT_TYPE_HAND_ITEM_RECEIVED=5,wr.CHAT_TYPE_PETTREAT=6,wr.CHAT_TYPE_PETREVIVE=7,wr.CHAT_TYPE_PET_REBREED_FERTILIZE=8,wr.CHAT_TYPE_PET_SPEED_FERTILIZE=9,wr.CHAT_TYPE_MUTE_REMAINING=10;let wt=wr;const SE=class SE extends Ve{constructor(e,t,i,r,n,o){super(SE.CONFIRM_PET_BREEDING,e),this._nestId=t,this._pet1=i,this._pet2=r,this._rarityCategories=n,this._resultPetTypeId=o}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetTypeId(){return this._resultPetTypeId}};SE.CONFIRM_PET_BREEDING="RSPFUE_CONFIRM_PET_BREEDING";let GS=SE;const RE=class RE extends Ve{constructor(e,t,i){super(RE.RSPFUE_CONFIRM_PET_BREEDING_RESULT,e),this._breedingNestStuffId=t,this._result=i}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}};RE.RSPFUE_CONFIRM_PET_BREEDING_RESULT="RSPFUE_CONFIRM_PET_BREEDING_RESULT";let BS=RE;const xE=class xE extends Ve{constructor(e,t,i){super(xE.RSDE_DANCE,e),this._roomIndex=t,this._danceId=i}get roomIndex(){return this._roomIndex}get danceId(){return this._danceId}};xE.RSDE_DANCE="RSDE_DANCE";let xf=xE;class _2{constructor(e,t,i,r){this._id=e,this._type=t,this._color=i,this._brightness=r}get id(){return this._id}get type(){return this._type}get color(){return this._color}get brightness(){return this._brightness}}const oA=class oA extends Ve{constructor(e,t){super(e,t),this._selectedPresetId=0,this._presets=[]}storePreset(e,t,i,r){this._presets[e-1]=new _2(e,t,i,r)}getPreset(e){return e<0||e>=this._presets.length?null:this._presets[e]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}set selectedPresetId(e){this._selectedPresetId=e}};oA.ROOM_DIMMER_PRESETS="RSDPE_PRESETS";let Dg=oA;const M_=class M_ extends Ve{constructor(e,t,i){super(e,t),this._userName="",this._userName=i}get userName(){return this._userName}};M_.DOORBELL="RSDE_DOORBELL",M_.RSDE_REJECTED="RSDE_REJECTED",M_.RSDE_ACCEPTED="RSDE_ACCEPTED";let Ga=M_;const an=class an extends Ve{constructor(e,t,i=null){super(e,t),this._message=i}get message(){return this._message}};an.RSEME_KICKED="RSEME_KICKED",an.RSEME_PETS_FORBIDDEN_IN_HOTEL="RSEME_PETS_FORBIDDEN_IN_HOTEL",an.RSEME_PETS_FORBIDDEN_IN_FLAT="RSEME_PETS_FORBIDDEN_IN_FLAT",an.RSEME_MAX_PETS="RSEME_MAX_PETS",an.RSEME_MAX_NUMBER_OF_OWN_PETS="RSEME_MAX_NUMBER_OF_OWN_PETS",an.RSEME_NO_FREE_TILES_FOR_PET="RSEME_NO_FREE_TILES_FOR_PET",an.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET="RSEME_SELECTED_TILE_NOT_FREE_FOR_PET",an.RSEME_BOTS_FORBIDDEN_IN_HOTEL="RSEME_BOTS_FORBIDDEN_IN_HOTEL",an.RSEME_BOTS_FORBIDDEN_IN_FLAT="RSEME_BOTS_FORBIDDEN_IN_FLAT",an.RSEME_BOT_LIMIT_REACHED="RSEME_BOT_LIMIT_REACHED",an.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT="RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT",an.RSEME_BOT_NAME_NOT_ACCEPTED="RSEME_BOT_NAME_NOT_ACCEPTED";let Pt=an;const OE=class OE extends Ve{constructor(e,t,i,r,n){super(OE.FAVOURITE_GROUP_UPDATE,e),this._roomIndex=t,this._habboGroupId=i,this._habboGroupName=n,this._status=r}get roomIndex(){return this._roomIndex}get habboGroupId(){return this._habboGroupId}get habboGroupName(){return this._habboGroupName}get status(){return this._status}};OE.FAVOURITE_GROUP_UPDATE="RSFGUE_FAVOURITE_GROUP_UPDATE";let Of=OE;const CE=class CE extends Ve{constructor(e,t,i,r){super(CE.RSFRE_FRIEND_REQUEST,e),this._requestId=0,this._userId=0,this._requestId=t,this._userId=i,this._userName=r}get requestId(){return this._requestId}get userId(){return this._userId}get userName(){return this._userName}};CE.RSFRE_FRIEND_REQUEST="RSFRE_FRIEND_REQUEST";let VS=CE;const NE=class NE extends Ve{constructor(e,t,i){super(NE.NEST_BREEDING_SUCCESS,e),this._petId=t,this._rarityCategory=i}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}};NE.NEST_BREEDING_SUCCESS="RSPFUE_NEST_BREEDING_SUCCESS";let HS=NE;const AE=class AE extends Ve{constructor(e,t,i,r){super(AE.PET_BREEDING,e),this._state=t,this._ownPetId=i,this._otherPetId=r}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}};AE.PET_BREEDING="RSPFUE_PET_BREEDING";let WS=AE;const bE=class bE extends Ve{constructor(e,t,i){super(bE.PET_BREEDING_RESULT,e),this._resultData=t,this._otherResultData=i}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}};bE.PET_BREEDING_RESULT="RSPFUE_PET_BREEDING_RESULT";let YS=bE;const vE=class vE extends Ve{constructor(e,t,i,r){super(vE.PET_COMMANDS,e),this._petId=t,this._allCommandIds=i,this._enabledCommandIds=r}get id(){return this._petId}get commands(){return this._allCommandIds}get enabledCommands(){return this._enabledCommandIds}};vE.PET_COMMANDS="RSPIUE_ENABLED_PET_COMMANDS";let eb=vE;const yE=class yE extends Ve{constructor(e,t,i){super(yE.PET_FIGURE_UPDATE,e),this._petId=t,this._figure=i}get id(){return this._petId}get figure(){return this._figure}};yE.PET_FIGURE_UPDATE="RSPFUE_PET_FIGURE_UPDATE";let zS=yE;const DE=class DE extends Ve{constructor(e,t){super(DE.PET_INFO,e),this._petInfo=t}get petInfo(){return this._petInfo}};DE.PET_INFO="RSPIUE_PET_INFO";let Cf=DE;const ME=class ME extends Ve{constructor(e,t,i){super(ME.PET_LEVEL_UPDATE,e),this._petId=t,this._level=i}get petId(){return this._petId}get level(){return this._level}};ME.PET_LEVEL_UPDATE="RSPLUE_PET_LEVEL_UPDATE";let KS=ME;const jE=class jE extends Ve{constructor(e,t,i,r,n,o){super(e,t),this._objectId=-1,this._nameValidationStatus=0,this._nameValidationInfo=null,this._objectId=i,this._figureData=r,this._nameValidationStatus=n,this._nameValidationInfo=o}get objectId(){return this._objectId}get figureData(){return this._figureData}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}};jE.RSOPPE_OPEN_PET_PACKAGE_REQUESTED="RSOPPE_OPEN_PET_PACKAGE_REQUESTED",jE.RSOPPE_OPEN_PET_PACKAGE_RESULT="RSOPPE_OPEN_PET_PACKAGE_RESULT";let dc=jE;const LE=class LE extends Ve{constructor(e,t,i,r,n,o){super(LE.PET_STATUS_UPDATE,e),this._petId=t,this._canBreed=i,this._canHarvest=r,this._canRevive=n,this._hasBreedingPermission=o}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}};LE.PET_STATUS_UPDATE="RSPFUE_PET_STATUS_UPDATE";let Nf=LE;const j_=class j_ extends Ve{constructor(e,t,i){super(e,t),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._npsPoll=!1,this._id=i}get id(){return this._id}get headline(){return this._headline}set headline(e){this._headline=e}get summary(){return this._summary}set summary(e){this._summary=e}get numQuestions(){return this._numQuestions}set numQuestions(e){this._numQuestions=e}get startMessage(){return this._startMessage}set startMessage(e){this._startMessage=e}get endMessage(){return this._endMessage}set endMessage(e){this._endMessage=e}get questionArray(){return this._questionArray}set questionArray(e){this._questionArray=e}get npsPoll(){return this._npsPoll}set npsPoll(e){this._npsPoll=e}};j_.OFFER="RSPE_POLL_OFFER",j_.ERROR="RSPE_POLL_ERROR",j_.CONTENT="RSPE_POLL_CONTENT";let La=j_;const lA=class lA extends Ve{constructor(e,t,i,r,n,o,l,c,u){super(e,t),this._classId=0,this._itemType="",this._placedItemId=0,this._placedItemType="",this._classId=i,this._itemType=r,this._productCode=n,this._placedItemId=o,this._placedItemType=l,this._placedInRoom=c,this._petFigureString=u}get classId(){return this._classId}get itemType(){return this._itemType}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedInRoom(){return this._placedInRoom}get placedItemType(){return this._placedItemType}get petFigureString(){return this._petFigureString}};lA.RSPE_PRESENT_OPENED="RSPE_PRESENT_OPENED";let Mg=lA;const cA=class cA extends Ve{constructor(e,t){super(e,t)}};cA.RSDUE_ALLOW_PETS="RSDUE_ALLOW_PETS";let Af=cA;const Yl=class Yl extends Ve{constructor(e,t,i,r=!1){super(Yl.QUEUE_STATUS,e),this._name=t,this._target=i,this._queues=new Map,this._isActive=r}get isActive(){return this._isActive}get queueSetName(){return this._name}get queueSetTarget(){return this._target}get queueTypes(){return Array.from(this._queues.keys())}getQueueSize(e){return this._queues.get(e)}addQueue(e,t){this._queues.set(e,t)}};Yl.QUEUE_STATUS="RSQE_QUEUE_STATUS",Yl.QUEUE_TYPE_CLUB="c",Yl.QUEUE_TYPE_NORMAL="d",Yl.QUEUE_TARGET_VISITOR=2,Yl.QUEUE_TARGET_SPECTATOR=1;let tb=Yl;const uA=class uA extends Ve{constructor(e,t){super(e,t)}};uA.SPECTATOR_MODE="RSSME_SPECTATOR_MODE";let bf=uA;const PE=class PE extends Ve{constructor(e,t,i){super(PE.RSUBE_BADGES,e),this._userId=0,this._badges=[],this._userId=t,this._badges=i}get userId(){return this._userId}get badges(){return this._badges}};PE.RSUBE_BADGES="RSUBE_BADGES";let vf=PE;const UE=class UE extends Ve{constructor(e,t){super(UE.USER_DATA_UPDATED,e),this._addedUsers=t}get addedUsers(){return this._addedUsers}};UE.USER_DATA_UPDATED="RMUDUE_USER_DATA_UPDATED";let yf=UE;const wE=class wE extends Ve{constructor(e,t,i,r,n,o){super(wE.USER_FIGURE,e),this._roomIndex=0,this._figure="",this._gender="",this._customInfo="",this._roomIndex=t,this._figure=i,this._gender=r,this._customInfo=n,this._achievementScore=o}get roomIndex(){return this._roomIndex}get figure(){return this._figure}get gender(){return this._gender}get customInfo(){return this._customInfo}get activityPoints(){return this._achievementScore}};wE.USER_FIGURE="RSUBE_FIGURE";let Df=wE;const FE=class FE extends _t{constructor(e,t){super(FE.UTRE_USER_TAGS_RECEIVED),this._userId=e,this._tags=t}get userId(){return this._userId}get tags(){return this._tags}};FE.UTRE_USER_TAGS_RECEIVED="UTRE_USER_TAGS_RECEIVED";let sb=FE;const kE=class kE extends Ve{constructor(e,t,i,r,n=null,o=0){super(e,t),this._question="",this._SafeStr_7654=0,this._choices=[],this._SafeStr_7651=[],this._question=i,this._choices=r,this._SafeStr_7651=n,this._SafeStr_7651==null&&(this._SafeStr_7651=[]),this._SafeStr_7654=o}get question(){return this._question}get choices(){return this._choices.slice()}get _SafeStr_4173(){return this._SafeStr_7651.slice()}get _SafeStr_4174(){return this._SafeStr_7654}};kE.VOTE_QUESTION="RSPE_VOTE_QUESTION",kE.VOTE_RESULT="RSPE_VOTE_RESULT";let Th=kE;const L_=class L_ extends Ve{constructor(e,t,i=-1){super(e,t),this._id=-1,this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,this._userId=-1,this._id=i}get id(){return this._id}get pollType(){return this._pollType}set pollType(e){this._pollType=e}get pollId(){return this._pollId}set pollId(e){this._pollId=e}get questionId(){return this._questionId}set questionId(e){this._questionId=e}get duration(){return this._duration}set duration(e){this._duration=e}get question(){return this._question}set question(e){this._question=e}get userId(){return this._userId}set userId(e){this._userId=e}get value(){return this._value}set value(e){this._value=e}get answerCounts(){return this._answerCounts}set answerCounts(e){this._answerCounts=e}};L_.QUESTION="RWPUW_NEW_QUESTION",L_.FINISHED="RWPUW_QUESION_FINSIHED",L_.ANSWERED="RWPUW_QUESTION_ANSWERED";let Pa=L_;const GE=class GE extends _t{constructor(e){super(GE.UPDATED),this._uiFlags=e}get uiFlags(){return this._uiFlags}};GE.UPDATED="APUE_UPDATED";let qS=GE;const BE=class BE extends _t{constructor(e){super(BE.UNUE_NAME_UPDATED),this._name=e}get name(){return this._name}};BE.UNUE_NAME_UPDATED="unue_name_updated";let Mf=BE;const hA=class hA extends _t{constructor(e,t,i){super(e),this._index=t,this._openMenu=i}get index(){return this._index}get openMenu(){return this._openMenu}};hA.WIRED_USER_CLICK_HANDLED="WIRED_USER_CLICK_HANDLED";let jg=hA;const on=class on extends Sn{constructor(e,t,i,r){super(),this._state=on.NOT_LOADED,this._libraryName=e,this._revision=t,this._downloadUrl=r,this._assets=i,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=on.LOADED)}async downloadAsset(){if(!this._assets||this._state===on.LOADING||this._state===on.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=on.LOADED,this.dispatchEvent(new ju(ju.DOWNLOAD_COMPLETE,this));return}this._state=on.LOADING,await this._assets.downloadAsset(this._downloadUrl)&&(this._state=on.LOADED,this.dispatchEvent(new ju(ju.DOWNLOAD_COMPLETE,this)))}get libraryName(){return this._libraryName}get isLoaded(){return this._state===on.LOADED}};on.DOWNLOAD_COMPLETE="AADL_DOWNLOAD_COMPLETE",on.NOT_LOADED=0,on.LOADING=1,on.LOADED=2;let XS=on;const uu=class uu extends Sn{constructor(e,t){super(),this._assets=e,this._structure=t,this._missingMandatoryLibs=st.getValue("avatar.mandatory.libraries"),this._figureMap=new Map,this._pendingContainers=[],this._figureListeners=new Map,this._incompleteFigures=new Map,this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadFigureMap(),this._structure.renderManager.events.addEventListener(Ag.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadFigureMap(){const e=new XMLHttpRequest;try{e.open("GET",st.getValue("avatar.figuremap.url")),e.send(),e.onloadend=t=>{if(e.responseText){const i=JSON.parse(e.responseText);this.processFigureMap(i.libraries),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new _t(uu.DOWNLOADER_READY))}},e.onerror=t=>{throw new Error("invalid_avatar_figure_map")}}catch(t){ze.error(t)}}processFigureMap(e){if(e)for(const t of e){if(!t)continue;const i=t.id,r=t.revision||"";if(this._libraryNames.indexOf(i)>=0)continue;this._libraryNames.push(i);const n=new XS(i,r,this._assets,st.getValue("avatar.asset.url"));n.addEventListener(ju.DOWNLOAD_COMPLETE,this.onLibraryLoaded);for(const o of t.parts){const l=o.id,u=o.type+":"+l;let d=this._figureMap.get(u);d||(d=[]),d.push(n),this._figureMap.set(u,d)}}}onAvatarRenderReady(e){if(e){for(const[t,i]of this._pendingContainers)this.downloadAvatarFigure(t,i);this._pendingContainers=[]}}onLibraryLoaded(e){if(!e||!e.library)return;const t=[];for(const[r,n]of this._incompleteFigures.entries()){let o=!0;for(const l of n)if(!(!l||l.isLoaded)){o=!1;break}if(o){t.push(r);const l=this._figureListeners.get(r);if(l)for(const c of l)!c||c.disposed||c.resetFigure(r);this._figureListeners.delete(r),this.dispatchEvent(new _t(uu.LIBRARY_LOADED))}}for(const r of t)r&&this._incompleteFigures.delete(r);let i=0;for(;i<this._currentDownloads.length;){const r=this._currentDownloads[i];r&&r.libraryName===e.library.libraryName&&this._currentDownloads.splice(i,1),i++}}processMissingLibraries(){const e=this._missingMandatoryLibs.slice();for(const t of e){if(!t)continue;const i=this._figureMap.get(t);if(i)for(const r of i)r&&this.downloadLibrary(r)}}isAvatarFigureContainerReady(e){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarFigurePendingLibraries(e).length}getAvatarFigurePendingLibraries(e){const t=[];if(!e||!this._structure)return t;const i=this._structure.figureData;if(!i)return t;const r=e.getPartTypeIds();for(const n of r){const o=i.getSetType(n);if(!o)continue;const l=o.getPartSet(e.getPartSetId(n));if(l)for(const c of l.parts){if(!c)continue;const u=c.type+":"+c.id,d=this._figureMap.get(u);if(d!==void 0)for(const _ of d)!_||_.isLoaded||t.indexOf(_)>=0||t.push(_)}}return t}downloadAvatarFigure(e,t){if(!this._isReady||!this._structure.renderManager.isReady){this._pendingContainers.push([e,t]);return}const i=e.getFigureString(),r=this.getAvatarFigurePendingLibraries(e);if(r&&r.length){if(t&&!t.disposed){let n=this._figureListeners.get(i);n||(n=[],this._figureListeners.set(i,n)),n.push(t)}this._incompleteFigures.set(i,r);for(const n of r)n&&this.downloadLibrary(n)}else t&&!t.disposed&&t.resetFigure(i)}downloadLibrary(e){!e||e.isLoaded||this._pendingDownloadQueue.indexOf(e)>=0||this._currentDownloads.indexOf(e)>=0||(this._pendingDownloadQueue.push(e),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}};uu.DOWNLOADER_READY="AADM_DOWNLOADER_READY",uu.LIBRARY_LOADED="AADM_LIBRARY_LOADED",uu.MAX_DOWNLOADS=2;let zc=uu;class Ed{constructor(e){this._parts=new Map,this.parseFigure(e)}getPartTypeIds(){return this.partSets().keys()}hasPartType(e){return!!this.partSets().get(e)}getPartSetId(e){const t=this.partSets().get(e);return t?t.get("setid"):0}getPartColorIds(e){const t=this.partSets().get(e);return t?t.get("colorids"):null}updatePart(e,t,i){const r=new Map;r.set("type",e),r.set("setid",t),r.set("colorids",i);const n=this.partSets();n.delete(e),n.set(e,r)}removePart(e){this.partSets().delete(e)}getFigureString(){const e=[];for(const t of this.partSets().keys()){if(!t)continue;let i=[];i.push(t),i.push(this.getPartSetId(t)),i=i.concat(this.getPartColorIds(t)),e.push(i.join("-"))}return e.join(".")}partSets(){return this._parts||(this._parts=new Map),this._parts}parseFigure(e){e||(e="");for(const t of e.split(".")){const i=t.split("-");if(i.length>=2){const r=i[0],n=parseInt(i[1]),o=[];let l=2;for(;l<i.length;)o.push(parseInt(i[l])),l++;this.updatePart(r,n,o)}}}}class g2{constructor(){this._cache=new Map,this.setLastAccessTime(nt())}dispose(){if(this.debugInfo("[dispose]"),!!this._cache){for(const e of this._cache.values())e&&e.dispose();this._cache.clear()}}getDirectionCache(e){const t=this._cache.get(e.toString());return t||null}updateDirectionCache(e,t){this._cache.set(e.toString(),t)}setLastAccessTime(e){this._lastAccessTime=e}getLastAccessTime(){return this._lastAccessTime}debugInfo(e){}}class ib{constructor(){this._cache=new Map}setAction(e,t){this._currentAction||(this._currentAction=e);const i=this.getActionCache(this._currentAction);i&&i.setLastAccessTime(t),this._currentAction=e}dispose(){if(!this._disposed){if(!this._cache)return;this.disposeActions(0,2147483647),this._cache.clear(),this._cache=null,this._disposed=!0}}disposeActions(e,t){if(!(!this._cache||this._disposed))for(const[i,r]of this._cache.entries()){if(!r)continue;const n=r.getLastAccessTime();t-n>=e&&(r.dispose(),this._cache.delete(i))}}getAction(){return this._currentAction}setDirection(e){this._currentDirection=e}getDirection(){return this._currentDirection}getActionCache(e=null){return this._currentAction?(e||(e=this._currentAction),e.overridingAction?this._cache.get(e.overridingAction):this._cache.get(e.id)):null}updateActionCache(e,t){e.overridingAction?this._cache.set(e.overridingAction,t):this._cache.set(e.id,t)}debugInfo(e){}}class m2{constructor(e,t,i){this._image=e,this._regPoint=t,this._offset=new ot(0,0),this._regPoint=t,this._isCacheable=i,this.cleanPoints()}dispose(){this._image&&this._image.destroy({children:!0}),this._image=null,this._regPoint=null,this._offset=null}cleanPoints(){}setRegPoint(e){this._regPoint=e,this.cleanPoints()}get image(){return this._image}set image(e){this._image&&this._image!==e&&this._image.destroy({children:!0}),this._image=e}get regPoint(){const e=this._regPoint.clone();return e.x+=this._offset.x,e.y+=this._offset.y,e}set offset(e){this._offset=e,this.cleanPoints()}get isCacheable(){return this._isCacheable}}class f2{constructor(e){this._partList=e,this._images=new Map}dispose(){for(const e of this._images.values())e&&e.dispose();this._images=null}getPartList(){return this._partList}getImageContainer(e){const t=this._images.get(this.getCacheKey(e));return t||null}updateImageContainer(e,t){const i=this.getCacheKey(t),r=this._images.get(i);r&&r.dispose(),this._images.set(i,e)}getCacheKey(e){let t="";for(const i of this._partList)t+=i.getCacheableKey(e)+"/";return t}debugInfo(e){}}class rb{constructor(e,t,i,r,n,o=null){this._texture=e,this._container=o,this._rect=t,this._regPoint=i,this._flipH=r,this._colorTransform=n,r&&(this._regPoint.x=-this._regPoint.x+t.width)}dispose(){this._texture=null,this._regPoint=null,this._colorTransform=null}get texture(){return this._texture}get container(){return this._container}get rect(){return this._rect}get regPoint(){return this._regPoint}get flipH(){return this._flipH}get colorTransform(){return this._colorTransform}get offsetRect(){return new En(-this._regPoint.x,-this._regPoint.y,this._rect.width,this._rect.height)}}const dA=class dA{constructor(e,t,i,r){this._structure=e,this._avatar=t,this._assets=i,this._scale=r,this._cache=new Map,this._canvas=null,this._disposed=!1,this._unionImages=[],this._matrix=new qr,this._serverRenderData=[]}dispose(){if(!this._disposed){if(this._structure=null,this._avatar=null,this._assets=null,this._canvas=null,this._disposed=!0,this._cache){for(const e of this._cache.values())e&&e.dispose();this._cache=null}if(this._unionImages){for(const e of this._unionImages)e&&e.dispose();this._unionImages=[]}}}disposeInactiveActions(e=6e4){const t=nt();if(this._cache)for(const i of this._cache.values())i&&i.disposeActions(e,t)}resetBodyPartCache(e){if(this._cache)for(const t of this._cache.values())t&&t.setAction(e,0)}setDirection(e,t){const i=this._structure.getBodyPartsUnordered(e);if(i)for(const r of i){const n=this.getBodyPartCache(r);n&&n.setDirection(t)}}setAction(e,t){const i=this._structure.getActiveBodyPartIds(e,this._avatar);for(const r of i){const n=this.getBodyPartCache(r);n&&n.setAction(e,t)}}setGeometryType(e){if(this._geometryType!==e){if(this._geometryType===wl.SITTING&&e===wl.VERTICAL||this._geometryType===wl.VERTICAL&&e===wl.SITTING||this._geometryType===wl.SNOWWARS_HORIZONTAL&&(e=wl.SNOWWARS_HORIZONTAL)){this._geometryType=e,this._canvas=null;return}this.disposeInactiveActions(0),this._geometryType=e,this._canvas=null}}getImageContainer(e,t,i=!1){let r=this.getBodyPartCache(e);r||(r=new ib,this._cache.set(e,r));let n=r.getDirection(),o=r.getAction(),l=t;o.definition.startFromFrameZero&&(l-=o.startFrame);let c=o,u=[],d=new Map;const _=new ot;if(!(!o||!o.definition)&&o.definition.isAnimation){let p=n;const S=this._structure.getAnimation(o.definition.state+"."+o.actionParameter),R=t-o.startFrame;if(S){const O=S.getLayerData(R,e,o.overridingAction);O&&(p=n+O.dd,O.dd<0?p<0?p=8+p:p>7&&(p=8-p):p<0?p=p+8:p>7&&(p=p-8),this._scale===Hn.LARGE?(_.x=O.dx,_.y=O.dy):(_.x=O.dx/2,_.y=O.dy/2),l=O.animationFrame,O.action&&(o=O.action),O.type===ja.BODYPART?(O.action!=null&&(c=O.action),n=p):O.type===ja.FX&&(n=p),d=O.items),u=S.removeData}}let m=r.getActionCache(c);(!m||i)&&(m=new g2,r.updateActionCache(c,m));let f=m.getDirectionCache(n);if(!f||i){const p=this._structure.getParts(e,this._avatar.getFigure(),c,this._geometryType,n,u,this._avatar,d);f=new f2(p),m.updateDirectionCache(n,f)}let E=f.getImageContainer(l);if(!E||i){const p=f.getPartList();if(E=this.renderBodyPart(n,p,l,o,i),E&&!i)E.isCacheable&&f.updateImageContainer(E,l);else return null}const I=this._structure.getFrameBodyPartOffset(c,n,l,e);return _.x+=I.x,_.y+=I.y,E.offset=_,E}getServerRenderData(){return this._serverRenderData=[],this._serverRenderData}getBodyPartCache(e){let t=this._cache.get(e);return t||(t=new ib,this._cache.set(e,t)),t}renderBodyPart(e,t,i,r,n=!1){if(!t||!t.length||!this._canvas&&(this._canvas=this._structure.getCanvas(this._scale,this._geometryType),!this._canvas))return null;const o=yr.DIRECTION_IS_FLIPPED[e]||!1;let l=r.definition.assetPartDefinition,c=!0,u=t.length-1;for(;u>=0;){const E=t[u];let I=16777215;if(!(e==7&&(E.partType==="fc"||E.partType==="ey"))&&!(E.partType==="ri"&&!E.partId)){const p=E.partId,S=E.getFrameDefinition(i);let R=E.partType,O=0;S?(O=S.number,S.assetPartDefinition&&S.assetPartDefinition!==""&&(l=S.assetPartDefinition)):O=E.getFrameIndex(i);let C=e,A=!1;o&&(l==="wav"&&(R===Ee.LEFT_HAND||R===Ee.LEFT_SLEEVE||R===Ee.LEFT_COAT_SLEEVE)||l==="drk"&&(R===Ee.RIGHT_HAND||R===Ee.RIGHT_SLEEVE||R===Ee.RIGHT_COAT_SLEEVE)||l==="blw"&&R===Ee.RIGHT_HAND||l==="sig"&&R===Ee.LEFT_HAND||l==="respect"&&R===Ee.LEFT_HAND||R===Ee.RIGHT_HAND_ITEM||R===Ee.LEFT_HAND_ITEM||R===Ee.CHEST_PRINT?A=!0:(e===4?C=2:e===5?C=1:e===6&&(C=0),E.flippedPartType!==R&&(R=E.flippedPartType)));let b=this._scale+"_"+l+"_"+R+"_"+p+"_"+C+"_"+O,y=this._assets.getAsset(b);if(y||(b=this._scale+"_std_"+R+"_"+p+"_"+C+"_0",y=this._assets.getAsset(b)),y){const M=y.texture;if(!M||!M.valid||!M.baseTexture)c=!1;else{E.isColorable&&E.color&&(I=E.color.rgb);const U=new ot(-y.x,-y.y);if(A&&(U.x=U.x+(this._scale===Hn.LARGE?65:31)),n){const G=new tD;G.name=this._assets.getAssetName(b),G.x=-U.x-33,G.y=-U.y,G.z=this._serverRenderData.length*-1e-4,G.width=y.rectangle.width,G.height=y.rectangle.height,G.flipH=A,l==="lay"&&(G.x=G.x+53),o&&(G.flipH=!G.flipH,G.flipH?G.x=-G.x-M.width:G.x=G.x+65),E.isColorable&&(G.color=`${I}`),this._serverRenderData.push(G)}this._unionImages.push(new rb(M,y.rectangle,U,A,I))}}}u--}if(!this._unionImages.length)return null;const d=this.createUnionImage(this._unionImages,o),_=this._scale===Hn.LARGE?this._canvas.height-16:this._canvas.height-8,m=new ot(-d.regPoint.x,_-d.regPoint.y);o&&l!=="lay"&&(m.x=m.x+(this._scale===Hn.LARGE?67:31));let f=this._unionImages.length-1;for(;f>=0;){const E=this._unionImages.pop();E&&E.dispose(),f--}return new m2(d.container,m,c)}convertColorToHex(e){let t=(e*255).toString(16);return t.length<2&&(t="0"+t),t}createUnionImage(e,t){const i=new En;for(const l of e)l&&i.enlarge(l.offsetRect);const r=new ot(-i.x,-i.y),n=new kn,o=new Is(Qs.EMPTY);o.width=i.width,o.height=i.height,n.addChild(o);for(const l of e){if(!l)continue;const c=l.texture,u=l.colorTransform,d=!(t&&l.flipH)&&(t||l.flipH),_=r.clone();_.x-=l.regPoint.x,_.y-=l.regPoint.y,t&&(_.x=n.width-(_.x+l.rect.width)),d?(this._matrix.a=-1,this._matrix.tx=l.rect.x+l.rect.width+_.x,this._matrix.ty=_.y-l.rect.y):(this._matrix.a=1,this._matrix.tx=_.x-l.rect.x,this._matrix.ty=_.y-l.rect.y);const m=new Is(c);m.tint=u,m.transform.setFromMatrix(this._matrix),n.addChild(m)}return new rb(null,n.getLocalBounds(),r,t,null,n)}};dA.DEFAULT_MAX_CACHE_STORAGE_TIME_MS=6e4;let $S=dA;const Ui=class Ui{constructor(e,t,i,r,n,o=null){this._isCachedImage=!1,this._frameCounter=0,this._directionOffset=0,this._isAnimating=!1,this._actionsSorted=!1,this._fullImageCacheSize=5,this._useFullImageCache=!1,this._effectIdInUse=-1,this._cachedBodyPartsDirection=-1,this._cachedBodyPartsGeometryType=null,this._cachedBodyPartsAvatarSet=null,this._animationHasResetOnToggle=!1,this._canvasOffsets=[],this._actions=[],this._cachedBodyParts=[],this._changes=!0,this._disposed=!1,this._effectManager=n,this._structure=e,this._assets=t,this._scale=r,this._effectListener=o,this._scale==null&&(this._scale=Hn.LARGE),i==null&&(i=new Ed("hr-893-45.hd-180-2.ch-210-66.lg-270-82.sh-300-91.wa-2007-.ri-1-")),this._figure=i,this._cache=new $S(this._structure,this,this._assets,this._scale),this.setDirection(Ui.DEFAULT_AVATAR_SET,Ui.DEFAULT_DIRECTION),this._actions=[],this._defaultAction=new wS(We.POSTURE_STAND),this._defaultAction.definition=this._structure.getActionDefinition(Ui.DEFAULT_ACTION),this.resetActions(),this._fullImageCache=new Ms,this._animationFrameCount=0}get mainAction(){return this._mainAction.actionType}get disposed(){return this._disposed}get avatarSpriteData(){return this._avatarSpriteData}get animationHasResetOnToggle(){return this._animationHasResetOnToggle}getServerRenderData(){return this.getAvatarPartsForCamera(ki.FULL),this._cache.getServerRenderData()}dispose(){if(!this._disposed){if(this._structure=null,this._assets=null,this._mainAction=null,this._figure=null,this._avatarSpriteData=null,this._actions=null,this._image&&(this._image.destroy(),this._image=null),this._cache&&(this._cache.dispose(),this._cache=null),this._fullImageCache){for(const e of this._fullImageCache.getValues())e&&e.destroy();this._fullImageCache=null}this._image=null,this._canvasOffsets=null,this._disposed=!0}}getFigure(){return this._figure}getScale(){return this._scale}getPartColor(e){return this._structure.getPartColor(this._figure,e)}setDirection(e,t){t=t+this._directionOffset,t<yr.MIN_DIRECTION&&(t=yr.MAX_DIRECTION+(t+1)),t>yr.MAX_DIRECTION&&(t=t-(yr.MAX_DIRECTION+1)),this._structure.isMainAvatarSet(e)&&(this._mainDirection=t),(e===ki.HEAD||e===ki.FULL)&&(e===ki.HEAD&&this.isHeadTurnPreventedByAction()&&(t=this._mainDirection),this._headDirection=t),this._cache.setDirection(e,t),this._changes=!0}setDirectionAngle(e,t){this.setDirection(e,Math.floor(t/45))}getSprites(){return this._sprites}getCanvasOffsets(){return this._canvasOffsets}getLayerData(e){return this._structure.getBodyPartData(e.animation.id,this._frameCounter,e.id)}updateAnimationByFrames(e=1){this._frameCounter+=e,this._changes=!0}resetAnimationFrameCounter(){this._frameCounter=0,this._changes=!0}getAvatarPartsForCamera(e){let t;if(this._mainAction==null||this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType)==null)return;const r=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection);let n=r.length-1;for(;n>=0;)t=r[n],this._cache.getImageContainer(t,this._frameCounter,!0),n--}getImage(e,t,i=1,r=!0){if(!this._changes)return this._image;if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const n=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!n)return null;this._image&&(this._image.width!==n.width||this._image.height!==n.height)&&(this._reusableTexture&&(this._reusableTexture.destroy(!0),this._reusableTexture=null),this._image=null,this._isCachedImage=!1);const o=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection);this._image=null;const l=new kn;let c=!0,u=o.length-1;for(;u>=0;){const d=o[u],_=this._cache.getImageContainer(d,this._frameCounter);if(_){const m=_.image;if(!m)return l.destroy({children:!0}),null;c=c&&_.isCacheable;const f=_.regPoint.clone();if(f){f.x+=n.offset.x,f.y+=n.offset.y,f.x+=n.regPoint.x,f.y+=n.regPoint.y;const E=new kn;E.addChild(m),E&&(E.position.set(f.x,f.y),l.addChild(E))}}u--}return this._avatarSpriteData&&(l.filters||(l.filters=[]),this._avatarSpriteData.colorTransform&&l.filters.push(this._avatarSpriteData.colorTransform),this._avatarSpriteData.paletteIsGrayscale&&(this.convertToGrayscale(l),l.filters.push(new cf(this._avatarSpriteData.reds,cf.CHANNEL_RED)))),r?(this._reusableTexture?(di.instance.renderer.render(l,{renderTexture:this._reusableTexture,clear:!0}),this._reusableTexture.baseTexture.hitMap=null):this._reusableTexture=Vt.generateTexture(l,new En(0,0,n.width,n.height)),this._reusableTexture?(this._image=this._reusableTexture,this._changes=!1,this._image):null):Vt.generateTexture(l,new En(0,0,n.width,n.height))}applyPalette(e,t=[],i=[],r=[]){const n=Vt.generateCanvas(e),o=n.getContext("2d"),l=o.getImageData(0,0,n.width,n.height),c=l.data;for(let d=0;d<c.length;d+=4){if(t.length==256){let _=t[c[d]];_===void 0&&(_=0),c[d]=_>>16&255,c[d+1]=_>>8&255,c[d+2]=_&255}if(i.length==256){let _=i[c[d+1]];_===void 0&&(_=0),c[d]=_>>16&255,c[d+1]=_>>8&255,c[d+2]=_&255}if(r.length==256){let _=i[c[d+2]];_===void 0&&(_=0),c[d]=_>>16&255,c[d+1]=_>>8&255,c[d+2]=_&255}}o.putImageData(l,0,0);const u=new si(Qs.from(n));return di.instance.renderer.render(u,{renderTexture:e,clear:!0}),e}getImageAsSprite(e,t=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const i=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!i)return null;const r=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection),n=new Is,o=new Is(Qs.EMPTY);o.width=i.width,o.height=i.height,n.addChild(o);let l=r.length-1;for(;l>=0;){const c=r[l],u=this._cache.getImageContainer(c,this._frameCounter);if(u){const d=u.image;if(!d)return n.destroy({children:!0}),null;const _=u.regPoint.clone();if(_){_.x+=i.offset.x,_.y+=i.offset.y,_.x+=i.regPoint.x,_.y+=i.regPoint.y;const m=new kn;m.addChild(d),m.position.set(_.x,_.y),n.addChild(m)}}l--}return n}getCroppedImage(e,t=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const i=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!i)return null;const r=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection),n=new kn;let o=r.length-1;for(;o>=0;){const u=r[o],d=this._cache.getImageContainer(u,this._frameCounter);if(d){const _=d.image;if(!_)return n.destroy({children:!0}),null;const m=d.regPoint.clone();if(m){m.x+=i.offset.x,m.y+=i.offset.y,m.x+=i.regPoint.x,m.y+=i.regPoint.y;const f=new kn;f.addChild(_),f&&(f.position.set(m.x,m.y),n.addChild(f))}}o--}const l=Vt.generateTexture(n,new En(0,0,i.width,i.height)),c=Vt.generateImage(l);return c||null}getAsset(e){return this._assets.getAsset(e)}getDirection(){return this._mainDirection}initActionAppends(){this._actions=[],this._actionsSorted=!1,this._currentActionsString="",this._useFullImageCache=!1}endActionAppends(){if(this.sortActions()){for(const e of this._sortedActions)e.actionType===We.EFFECT&&(this._effectManager.isAvatarEffectReady(parseInt(e.actionParameter))||this._effectManager.downloadAvatarEffect(parseInt(e.actionParameter),this));this.resetActions(),this.setActionsToParts()}}appendAction(e,...t){let i="";switch(this._actionsSorted=!1,t&&t.length>0&&(i=t[0]),i!=null&&(i=i.toString()),e){case We.POSTURE:switch(i){case We.POSTURE_LAY:case We.POSTURE_WALK:case We.POSTURE_STAND:case We.POSTURE_SWIM:case We.POSTURE_FLOAT:case We.POSTURE_SIT:case We.SNOWWAR_RUN:case We.SNOWWAR_DIE_FRONT:case We.SNOWWAR_DIE_BACK:case We.SNOWWAR_PICK:case We.SNOWWAR_THROW:(i===We.POSTURE_LAY||i===We.POSTURE_LAY||i===We.POSTURE_LAY)&&(i===We.POSTURE_LAY&&(this._mainDirection==0?this.setDirection(ki.FULL,4):this.setDirection(ki.FULL,2)),this._useFullImageCache=!0,this._useFullImageCache=!0),this.addActionData(i);break}break;case We.GESTURE:switch(i){case We.GESTURE_AGGRAVATED:case We.GESTURE_SAD:case We.GESTURE_SMILE:case We.GESTURE_SURPRISED:this.addActionData(i);break}break;case We.EFFECT:case We.DANCE:case We.TALK:case We.EXPRESSION_WAVE:case We.SLEEP:case We.SIGN:case We.EXPRESSION_RESPECT:case We.EXPRESSION_BLOW_A_KISS:case We.EXPRESSION_LAUGH:case We.EXPRESSION_CRY:case We.EXPRESSION_IDLE:case We.EXPRESSION_SNOWBOARD_OLLIE:case We.EXPRESSION_SNOWBORD_360:case We.EXPRESSION_RIDE_JUMP:i===We.EFFECT&&(i==="33"||i==="34"||i==="35"||i==="36"||i==="38"||i==="39")&&(this._useFullImageCache=!0),this.addActionData(e,i);break;case We.CARRY_OBJECT:case We.USE_OBJECT:{const r=this._structure.getActionDefinitionWithState(e);r&&(i=r.getParameterValue(i)),this.addActionData(e,i);break}}return!0}isAnimating(){return this._isAnimating||this._animationFrameCount>1}isPlaceholder(){return!1}forceActionUpdate(){this._lastActionsString=""}resetEffect(e){e===this._effectIdInUse&&(this.resetActions(),this.setActionsToParts(),this._animationHasResetOnToggle=!0,this._changes=!0,this._effectListener&&this._effectListener.resetEffect(e))}getFullImage(e){const t=this._fullImageCache.getValue(e);return t?(t.valid||(this._fullImageCache.remove(e),t.destroy(!0)),t):null}cacheFullImage(e,t){const i=this._fullImageCache.getValue(e);if(i&&(this._fullImageCache.remove(e),i.destroy(!0)),this._fullImageCache.length===this._fullImageCacheSize){const r=this._fullImageCache.getKey(0);r&&this._fullImageCache.remove(r).destroy(!0)}this._fullImageCache.add(e,t)}addActionData(e,t=""){let i;this._actions||(this._actions=[]);let r=0;for(;r<this._actions.length;){if(i=this._actions[r],i.actionType==e&&i.actionParameter==t)return;r++}this._actions.push(new wS(e,t,this._frameCounter))}getFullImageCacheKey(){if(!this._useFullImageCache)return null;if(this._sortedActions.length==1&&this._mainDirection==this._headDirection)return this._mainDirection+this._currentActionsString+this._frameCounter%4;if(this._sortedActions.length==2)for(const e of this._sortedActions){if(e.actionType=="fx"&&(e.actionParameter=="33"||e.actionParameter=="34"||e.actionParameter=="35"||e.actionParameter=="36"))return this._mainDirection+this._currentActionsString+0;if(e.actionType=="fx"&&(e.actionParameter=="38"||e.actionParameter=="39"))return this._mainDirection+"_"+this._headDirection+this._currentActionsString+this._frameCounter%11;if(e.actionType==="dance"&&(e.actionParameter==="1"||e.actionParameter==="2"||e.actionParameter==="3"||e.actionParameter==="4")){let t=this._frameCounter%8;return e.actionParameter==="3"&&(t=this._frameCounter%10),e.actionParameter==="4"&&(t=this._frameCounter%16),this._mainDirection+e.actionType+e.actionParameter+t}}return null}getBodyParts(e,t,i){return(i!=this._cachedBodyPartsDirection||t!=this._cachedBodyPartsGeometryType||e!=this._cachedBodyPartsAvatarSet)&&(this._cachedBodyPartsDirection=i,this._cachedBodyPartsGeometryType=t,this._cachedBodyPartsAvatarSet=e,this._cachedBodyParts=this._structure.getBodyParts(e,t,i)),this._cachedBodyParts}resetActions(){return this._animationHasResetOnToggle=!1,this._isAnimating=!1,this._sprites=[],this._avatarSpriteData=null,this._directionOffset=0,this._structure.removeDynamicItems(this),this._mainAction=this._defaultAction,this._mainAction.definition=this._defaultAction.definition,this.resetBodyPartCache(this._defaultAction),!0}isHeadTurnPreventedByAction(){let e,t;if(this._sortedActions==null)return!1;for(const i of this._sortedActions)e=this._structure.getActionDefinitionWithState(i.actionType),e!=null&&e.getPreventHeadTurn(i.actionParameter)&&(t=!0);return t}sortActions(){let e,t,i;if(this._currentActionsString="",this._sortedActions=this._structure.sortActions(this._actions),this._animationFrameCount=this._structure.maxFrames(this._sortedActions),!this._sortedActions)this._canvasOffsets=[0,0,0],this._lastActionsString!==""&&(i=!0,this._lastActionsString="");else{this._canvasOffsets=this._structure.getCanvasOffsets(this._sortedActions,this._scale,this._mainDirection);for(const r of this._sortedActions)if(this._currentActionsString=this._currentActionsString+(r.actionType+r.actionParameter),r.actionType===We.EFFECT){const n=parseInt(r.actionParameter);this._effectIdInUse!==n&&(e=!0),this._effectIdInUse=n,t=!0}t||(this._effectIdInUse>-1&&(e=!0),this._effectIdInUse=-1),e&&this._cache.disposeInactiveActions(0),this._lastActionsString!=this._currentActionsString&&(i=!0,this._lastActionsString=this._currentActionsString)}return this._actionsSorted=!0,i}setActionsToParts(){if(!this._sortedActions==null)return;const e=nt(),t=[];for(const i of this._sortedActions)t.push(i.actionType);for(const i of this._sortedActions)if(i&&i.definition&&i.definition.isAnimation){const r=this._structure.getAnimation(i.definition.state+"."+i.actionParameter);if(r&&r.hasOverriddenActions()){const n=r.overriddenActionNames();if(n)for(const o of n)t.indexOf(o)>=0&&(i.overridingAction=r.overridingAction(o))}r&&r.resetOnToggle&&(this._animationHasResetOnToggle=!0)}for(const i of this._sortedActions)if(!(!i||!i.definition)&&(i.definition.isAnimation&&i.actionParameter===""&&(i.actionParameter="1"),this.setActionToParts(i,e),i.definition.isAnimation)){this._isAnimating=i.definition.isAnimated(i.actionParameter);const r=this._structure.getAnimation(i.definition.state+"."+i.actionParameter);r&&(this._sprites=this._sprites.concat(r.spriteData),r.hasDirectionData()&&(this._directionOffset=r.directionData.offset),r.hasAvatarData()&&(this._avatarSpriteData=r.avatarData))}}setActionToParts(e,t){e==null||e.definition==null||e.definition.assetPartDefinition!=""&&(e.definition.isMain&&(this._mainAction=e,this._cache.setGeometryType(e.definition.geometryType)),this._cache.setAction(e,t),this._changes=!0)}resetBodyPartCache(e){e&&e.definition.assetPartDefinition!==""&&(e.definition.isMain&&(this._mainAction=e,this._cache.setGeometryType(e.definition.geometryType)),this._cache.resetBodyPartCache(e),this._changes=!0)}convertToGrayscale(e,t="CHANNELS_EQUAL"){let i=.33,r=.33,n=.33;switch(t){case Ui.CHANNELS_UNIQUE:i=.3,r=.59,n=.11;break;case Ui.CHANNELS_RED:i=1,r=0,n=0;break;case Ui.CHANNELS_GREEN:i=0,r=1,n=0;break;case Ui.CHANNELS_BLUE:i=0,r=0,n=1;break;case Ui.CHANNELS_DESATURATED:i=.3086,r=.6094,n=.082;break}const o=new Gu;return o.matrix=[i,r,n,0,0,i,r,n,0,0,i,r,n,0,0,0,0,0,1,0],e.filters.push(o),e}errorThis(e){}logThis(e){}};Ui.CHANNELS_EQUAL="CHANNELS_EQUAL",Ui.CHANNELS_UNIQUE="CHANNELS_UNIQUE",Ui.CHANNELS_RED="CHANNELS_RED",Ui.CHANNELS_GREEN="CHANNELS_GREEN",Ui.CHANNELS_BLUE="CHANNELS_BLUE",Ui.CHANNELS_DESATURATED="CHANNELS_DESATURATED",Ui.DEFAULT_ACTION="Default",Ui.DEFAULT_DIRECTION=2,Ui.DEFAULT_AVATAR_SET=ki.FULL;let jf=Ui;class tf{constructor(e){this._number=e.number,this._assetPartDefinition=e.assetPartDefinition||null}get number(){return this._number}get assetPartDefinition(){return this._assetPartDefinition}}class p2{constructor(e){if(this._frames=[],e.frames&&e.frames.length>0)for(const t of e.frames){if(!t)continue;this._frames.push(new tf(t));let i=t.repeats||0;if(i>1)for(;--i>0;)this._frames.push(this._frames[this._frames.length-1])}}get frames(){return this._frames}}const Bh=class Bh{constructor(e){if(this._id=e.id,this._actionParts=new Map,this._bodyPartOffsets=new Map,this._frameCount=0,this._frameIndexes=[],e.parts&&e.parts.length>0)for(const t of e.parts){if(!t)continue;const i=new p2(t);this._actionParts.set(t.setType,i),this._frameCount=Math.max(this._frameCount,i.frames.length)}if(e.offsets&&e.offsets.frames&&e.offsets.frames.length>0)for(const t of e.offsets.frames){if(!t)continue;const i=t.id;this._frameCount=Math.max(this._frameCount,i);const r=new Map;if(this._bodyPartOffsets.set(i,r),t.directions&&t.directions.length>0)for(const n of t.directions){if(!n)continue;const o=n.id,l=new Map;if(r.set(o,l),n.bodyParts&&n.bodyParts.length>0)for(const c of n.bodyParts){if(!c)continue;const u=c.id;let d=0,_=0;c.dx!==void 0&&(d=c.dx),c.dy!==void 0&&(_=c.dy),l.set(u,new ot(d,_))}}if(this._frameIndexes.push(i),t.repeats!==void 0){let n=t.repeats||0;if(n>1)for(;--n>0;)this._frameIndexes.push(i)}}}getPart(e){if(!e)return null;const t=this._actionParts.get(e);return t||null}getFrameBodyPartOffset(e,t,i){const r=t%this._frameIndexes.length,n=this._frameIndexes[r],o=this._bodyPartOffsets.get(n);if(!o)return Bh.DEFAULT_OFFSET;const l=o.get(e);if(!l)return Bh.DEFAULT_OFFSET;const c=l.get(i);return c||Bh.DEFAULT_OFFSET}get id(){return this._id}get parts(){return this._actionParts}get frameCount(){return this._frameCount}};Bh.DEFAULT_OFFSET=new ot(0,0);let Lg=Bh;class E2{constructor(){this._actions=new Map}parse(e){if(e&&e.length>0)for(const t of e){if(!t)continue;const i=new Lg(t);this._actions.set(i.id,i)}return!0}appendJSON(e){for(const t of e.action)this._actions.set(t.id,new Lg(t));return!0}getAction(e){const t=this._actions.get(e.id);return t||null}getFrameCount(e){const t=this.getAction(e);return t?t.frameCount:0}}class I2{constructor(e,t){this._id=e.id,this._width=e.width,this._height=e.height,this._offset=new ot(e.dx,e.dy),t==Hn.LARGE?this._regPoint=new ot((this._width-64)/2,0):this._regPoint=new ot((this._width-32)/2,0)}get width(){return this._width}get height(){return this._height}get offset(){return this._offset}get id(){return this._id}get regPoint(){return this._regPoint}}const VE=class VE extends Sn{constructor(e,t){super(),this._dataReceiver=t,this.download(e)}download(e){const t=new XMLHttpRequest;try{t.open("GET",e),t.send(),t.onloadend=i=>{const r=t.responseText;if(!r||!r.length)throw new Error("invalid_figure_data");this._dataReceiver&&this._dataReceiver.appendJSON(JSON.parse(r)),this.dispatchEvent(new _t(VE.AVATAR_STRUCTURE_DONE))},t.onerror=i=>{throw new Error("invalid_avatar_figure_data")}}catch(i){ze.error(i)}}};VE.AVATAR_STRUCTURE_DONE="AVATAR_STRUCTURE_DONE";let Lf=VE;class T2{constructor(e){if(!e)throw new Error("invalid_data");this._id=e.id,this._type=e.type,this._index=e.index,this._colorLayerIndex=e.colorindex,this._paletteMapId=-1,this._breed=-1}dispose(){}get id(){return this._id}get type(){return this._type}get breed(){return this._breed}get index(){return this._index}get colorLayerIndex(){return this._colorLayerIndex}get paletteMap(){return this._paletteMapId}}class S2{constructor(e,t){if(!e||!t)throw new Error("invalid_data");this._id=t.id,this._type=e,this._gender=t.gender,this._clubLevel=t.club,this._isColorable=t.colorable,this._isSelectable=t.selectable,this._parts=[],this._hiddenLayers=[],this._isPreSelectable=t.preselectable,this._isSellable=t.sellable;for(const i of t.parts){const r=new T2(i),n=this.getPartIndex(r);n!==-1?this._parts.splice(n,0,r):this._parts.push(r)}if(t.hiddenLayers)for(const i of t.hiddenLayers)this._hiddenLayers.push(i.partType)}dispose(){for(const e of this._parts)e.dispose();this._parts=null,this._hiddenLayers=null}getPartIndex(e){const t=this._parts.length;if(!t)return-1;for(let i=0;i<t;i++){const r=this._parts[i];if(r&&!(r.type!==e.type||r.index>e.index))return i}return-1}getPart(e,t){for(const i of this._parts)if(!(i.type!==e||i.id!==t))return i;return null}get id(){return this._id}get type(){return this._type}get gender(){return this._gender}get clubLevel(){return this._clubLevel}get isColorable(){return this._isColorable}get isSelectable(){return this._isSelectable}get parts(){return this._parts}get hiddenLayers(){return this._hiddenLayers}get isPreSelectable(){return this._isPreSelectable}get isSellable(){return this._isSellable}}class R2{constructor(e){if(!e)throw new Error("invalid_data");this._id=e.id,this._index=e.index,this._clubLevel=e.club||0,this._isSelectable=e.selectable,this._rgb=parseInt("0x"+e.hexCode,16)}get id(){return this._id}get index(){return this._index}get clubLevel(){return this._clubLevel}get isSelectable(){return this._isSelectable}get rgb(){return this._rgb}}class nb{constructor(e){if(!e)throw new Error("invalid_data");this._id=e.id,this._colors=new Ms,this.append(e)}append(e){for(const t of e.colors){const i=new R2(t);this._colors.add(t.id.toString(),i)}}getColor(e){return e===void 0||e<0?null:this._colors.getValue(e.toString())||null}get id(){return this._id}get colors(){return this._colors}}class VT{constructor(e){if(!e)throw new Error("invalid_data");this._type=e.type,this._paletteId=e.paletteId,this._isMandatory={},this._isMandatory.F=[e.mandatory_f_0,e.mandatory_f_1],this._isMandatory.M=[e.mandatory_m_0,e.mandatory_m_1],this._partSets=new Ms,this.append(e)}dispose(){for(const e of this._partSets.getValues())e.dispose();this._partSets=null}cleanUp(e){for(const t of e.sets){const i=t.id.toString(),r=this._partSets.getValue(i);r&&(r.dispose(),this._partSets.remove(i))}}append(e){if(!(!e||!e.sets))for(const t of e.sets)this._partSets.add(t.id.toString(),new S2(this._type,t))}getDefaultPartSet(e){for(const t of this._partSets.getValues())if(t&&t.clubLevel===0&&(t.gender===e||t.gender==="U"))return t;return null}getPartSet(e){return this._partSets.getValue(e.toString())}get type(){return this._type}get paletteID(){return this._paletteId}isMandatory(e,t){return this._isMandatory[e.toUpperCase()][Math.min(t,1)]}optionalFromClubLevel(e){return this._isMandatory[e.toUpperCase()].indexOf(!1)}get partSets(){return this._partSets}}class x2{constructor(){this._palettes=new Map,this._setTypes=new Map}dispose(){}parse(e){if(!e)return!1;for(const t of e.palettes){const i=new nb(t);i&&this._palettes.set(i.id.toString(),i)}for(const t of e.setTypes){const i=new VT(t);i&&this._setTypes.set(i.type,i)}return!0}injectJSON(e){for(const t of e.setTypes){const i=this._setTypes.get(t.type);i?i.cleanUp(t):this._setTypes.set(t.type,new VT(t))}this.appendJSON(e)}appendJSON(e){if(!e)return!1;for(const t of e.palettes){const i=t.id.toString(),r=this._palettes.get(i);r?r.append(t):this._palettes.set(i,new nb(t))}for(const t of e.setTypes){const i=t.type,r=this._setTypes.get(i);r?r.append(t):this._setTypes.set(i,new VT(t))}return!1}getMandatorySetTypeIds(e,t){const i=[];for(const r of this._setTypes.values())!r||!r.isMandatory(e,t)||i.push(r.type);return i}getDefaultPartSet(e,t){const i=this._setTypes.get(e);return i?i.getDefaultPartSet(t):null}getSetType(e){return this._setTypes.get(e)||null}getPalette(e){return this._palettes.get(e.toString())||null}getFigurePartSet(e){for(const t of this._setTypes.values()){const i=t.getPartSet(e);if(i)return i}return null}}class ab{constructor(e){if(this._id=e.id,this._parts=[],e.activeParts&&e.activeParts.length>0)for(const t of e.activeParts)t&&this._parts.push(t.setType)}get parts(){return this._parts}}class HT{constructor(e){if(!e)throw new Error("invalid_data");this._setType=e.setType,this._flippedSetType=e.flippedSetType||null,this._removeSetType=e.removeSetType||null,this._appendToFigure=!1,this._staticId=-1}hasStaticId(){return this._staticId>=0}get staticId(){return this._staticId}set staticId(e){this._staticId=e}get setType(){return this._setType}get flippedSetType(){return this._flippedSetType}set flippedSetType(e){this._flippedSetType=e}get removeSetType(){return this._removeSetType}get appendToFigure(){return this._appendToFigure}set appendToFigure(e){this._appendToFigure=e}}class O2{constructor(){this._parts=new Map,this._activePartSets=new Map}parse(e){if(e.partSet&&e.partSet.length>0)for(const t of e.partSet)t&&this._parts.set(t.setType,new HT(t));if(e.activePartSets&&e.activePartSets.length>0)for(const t of e.activePartSets)t&&this._activePartSets.set(t.id,new ab(t));return!0}appendJSON(e){if(e.partSet&&e.partSet.length>0)for(const t of e.partSet)t&&this._parts.set(t.setType,new HT(t));if(e.activePartSets&&e.activePartSets.length>0)for(const t of e.activePartSets)t&&this._activePartSets.set(t.id,new ab(t));return!1}getActiveParts(e){const t=this._activePartSets.get(e.activePartSet);return t?t.parts:[]}getPartDefinition(e){const t=this._parts.get(e);return t||null}addPartDefinition(e){const t=e.setType;let i=this._parts.get(t);return i||(i=new HT(e),this._parts.set(t,i)),i}getActivePartSet(e){const t=this._activePartSets.get(e.activePartSet);return t||null}get parts(){return this._parts}get activePartSets(){return this._activePartSets}}class WT{constructor(e,t,i,r,n,o,l,c,u="",d=!1,_=1){this._bodyPartId=e,this._partType=t,this._partId=i,this._color=r,this._frames=n,this._action=o,this._isColorable=l,this._paletteMapId=c,this._flippedPartType=u,this._isBlendable=d,this._blendTransform=null,this._partType==="ey"&&(this._isColorable=!1)}getFrameIndex(e){if(!this._frames||!this._frames.length)return 0;const t=e%this._frames.length;return this._frames[t]instanceof tf?this._frames[t].number:t}getFrameDefinition(e){const t=e%this._frames.length;return this._frames&&this._frames.length>t&&this._frames[t]instanceof tf?this._frames[t]:null}getCacheableKey(e){const t=e%this._frames.length;if(this._frames&&this._frames.length>t&&this._frames[t]instanceof tf){const i=this._frames[t];return this.partId+":"+i.assetPartDefinition+":"+i.number}return this.partId+":"+t}get bodyPartId(){return this._bodyPartId}get partType(){return this._partType}get partId(){return this._partId}get color(){return this._color}get action(){return this._action}get isColorable(){return this._isColorable}set isColorable(e){this._isColorable=e}get paletteMapId(){return this._paletteMapId}get flippedPartType(){return this._flippedPartType}get isBlendable(){return this._isBlendable}toString(){return[this._bodyPartId,this._partType,this._partId].join(":")}}const mt=class mt{constructor(){this._avatarEffectType=-1,this._gender="M"}get gender(){return this._gender}get disposed(){return this._isDisposed}loadAvatarData(e,t){this._data=new Map,this._colors=new Map,this._gender=t,this.parseFigureString(e)}dispose(){this._data=null,this._colors=null,this._isDisposed=!0}hasSetType(e){return!!this._data.get(e)}getPartSetId(e){return this.hasSetType(e)?this._data.get(e):-1}getColourIds(e){return this._colors.get(e)?this._colors.get(e):[]}getFigureString(){let e="";const t=[];for(const[r,n]of this._data.entries()){let o=r+"-"+n;const l=this._colors.get(r);if(l)for(const c of l)o=o+("-"+c);t.push(o)}let i=0;for(;i<t.length;)e=e+t[i],i<t.length-1&&(e=e+"."),i++;return e}savePartData(e,t,i,r=!1){this.savePartSetId(e,t,r),this.savePartSetColourId(e,i,r)}savePartSetColourId(e,t,i=!0){switch(e){case mt.HD:case mt.HAIR:case mt.HAT:case mt.HEAD_ACCESSORIES:case mt.EYE_ACCESSORIES:case mt.FACE_ACCESSORIES:case mt.SHIRT:case mt.JACKET:case mt.CHEST_ACCESSORIES:case mt.CHEST_PRINTS:case mt.TROUSERS:case mt.SHOES:case mt.TROUSER_ACCESSORIES:this._colors.set(e,t);return}}getFigureStringWithFace(e){const t=[mt.HD];let i="";const r=[];for(const o of t){const l=this._colors.get(o);if(l){let c=this._data.get(o);o===mt.HD&&(c=e);let u=o+"-"+c;if(c>=0){let d=0;for(;d<l.length;)u=u+("-"+l[d]),d++}r.push(u)}}let n=0;for(;n<r.length;)i=i+r[n],n<r.length-1&&(i=i+"."),n++;return i}parseFigureString(e){if(e)for(const t of e.split(".")){const i=t.split("-");if(i.length>0){const r=i[0],n=parseInt(i[1]),o=[];let l=2;for(;l<i.length;)o.push(parseInt(i[l])),l++;o.length||o.push(0),this.savePartSetId(r,n,!1),this.savePartSetColourId(r,o,!1)}}}savePartSetId(e,t,i=!0){switch(e){case mt.HD:case mt.HAIR:case mt.HAT:case mt.HEAD_ACCESSORIES:case mt.EYE_ACCESSORIES:case mt.FACE_ACCESSORIES:case mt.SHIRT:case mt.JACKET:case mt.CHEST_ACCESSORIES:case mt.CHEST_PRINTS:case mt.TROUSERS:case mt.SHOES:case mt.TROUSER_ACCESSORIES:t>=0?this._data.set(e,t):this._data.delete(e)}}};mt.MALE="M",mt.FEMALE="F",mt.UNISEX="U",mt.SCALE="h",mt.STD="std",mt.DEFAULT_FRAME="0",mt.HD="hd",mt.HAIR="hr",mt.HAT="ha",mt.HEAD_ACCESSORIES="he",mt.EYE_ACCESSORIES="ea",mt.FACE_ACCESSORIES="fa",mt.JACKET="cc",mt.SHIRT="ch",mt.CHEST_ACCESSORIES="ca",mt.CHEST_PRINTS="cp",mt.TROUSERS="lg",mt.SHOES="sh",mt.TROUSER_ACCESSORIES="wa",mt.BLOCKED_FX_TYPES=[28,29,30,33,34,35,36,37,38,39,40,41,42,43,68];let Sl=mt;class C2{constructor(e){this._data=[],this._maxSize=e,this._index=0}reset(){this._data=[],this._index=0}addValue(e){this._data.length<this._maxSize?this._data.push(e):this._data[this._index]=e,this._index=(this._index+1)%this._maxSize}getMax(){let e=Number.MIN_VALUE,t=0;for(;t<this._maxSize;)this._data[t]>e&&(e=this._data[t]),t++;return e}getMin(){let e=Number.MAX_VALUE,t=0;for(;t<this._maxSize;)this._data[t]<e&&(e=this._data[t]),t++;return e}}class xi{constructor(e,t){this._location=e,this._direction=t}get location(){return this._location}get direction(){return this._direction}}class iT extends Qr{constructor(){super(),this._object=null,this._events=null,this._time=0}initialize(e){}onDispose(){this._object=null}update(e){this._time=e}processUpdateMessage(e){!e||!this._object||(this._object.setLocation(e.location),this._object.setDirection(e.direction))}getEventTypes(){return[]}mergeTypes(e,t){const i=e.concat();for(const r of t)!r||i.indexOf(r)>=0||i.push(r);return i}mouseEvent(e,t){}useObject(){}setObject(e){if(this._object!==e){if(this._object&&this._object.setLogic(null),!e){this.dispose(),this._object=null;return}this._object=e,this._object.setLogic(this)}}tearDown(){}get object(){return this._object}get eventDispatcher(){return this._events}set eventDispatcher(e){this._events=e}get widget(){return null}get contextMenu(){return null}get time(){return this._time}}class sD{constructor(){this._map=new Map,this._updateCounter=0}dispose(){this._map.clear(),this._updateCounter=0}getValue(e){return this._map.get(e)}setValue(e,t){this._map.has(e)&&this._map.get(e)===t||(this._map.set(e,t),this._updateCounter++)}removeKey(e){e&&(this._map.delete(e),this._updateCounter++)}get updateCounter(){return this._updateCounter}}const HE=class HE extends Qr{constructor(e,t,i){super(),this._id=e,this._instanceId=HE.OBJECT_COUNTER++,this._type=i,this._model=new sD,this._location=new Y,this._direction=new Y,this._states=[],this._visualization=null,this._logic=null,this._pendingLogicMessages=[],this._updateCounter=0,this._isReady=!1;let r=t-1;for(;r>=0;)this._states[r]=0,r--}onDispose(){this._pendingLogicMessages=[],this.setVisualization(null),this.setLogic(null),this._model&&this._model.dispose(),super.onDispose()}getLocation(){return this._location}setLocation(e){e&&(e.x===this._location.x&&e.y===this._location.y&&e.z===this._location.z||(this._location.x=e.x,this._location.y=e.y,this._location.z=e.z,this._updateCounter++))}getDirection(){return this._direction}setDirection(e){e&&(e.x===this._direction.x&&e.y===this._direction.y&&e.z===this._direction.z||(this._direction.x=(e.x%360+360)%360,this._direction.y=(e.y%360+360)%360,this._direction.z=(e.z%360+360)%360,this._updateCounter++))}getState(e=0){return e>=0&&e<this._states.length?this._states[e]:-1}setState(e,t=0){return t>=0&&t<this._states.length?(this._states[t]!==e&&(this._states[t]=e,this._updateCounter++),!0):!1}setVisualization(e){this._visualization!==e&&(this._visualization&&this._visualization.dispose(),this._visualization=e,this._visualization&&(this._visualization.object=this))}setLogic(e){if(this._logic===e)return;const t=this._logic;if(t&&(this._logic=null,t.setObject(null)),this._logic=e,this._logic)for(this._logic.setObject(this);this._pendingLogicMessages.length;){const i=this._pendingLogicMessages.shift();this._logic.processUpdateMessage(i)}}processUpdateMessage(e){if(this._logic)return this._logic.processUpdateMessage(e);this._pendingLogicMessages.push(e)}tearDown(){this._logic&&this._logic.tearDown()}get id(){return this._id}get instanceId(){return this._instanceId}get type(){return this._type}get model(){return this._model}get visualization(){return this._visualization}get mouseHandler(){return this._logic}get logic(){return this._logic}get location(){return this._location}get direction(){return this._direction}get updateCounter(){return this._updateCounter}set updateCounter(e){this._updateCounter=e}get isReady(){return this._isReady}set isReady(e){this._isReady=e}};HE.OBJECT_COUNTER=0;let QS=HE;const WE=class WE{constructor(){this._id=WE.SPRITE_COUNTER++,this._name="",this._type="",this._spriteType=Gn.DEFAULT,this._texture=null,this._container=null,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._flipH=!1,this._flipV=!1,this._direction=0,this._alpha=255,this._blendMode=ss.NORMAL,this._color=16777215,this._relativeDepth=0,this._varyingDepth=!1,this._libraryAssetName="",this._clickHandling=!1,this._visible=!0,this._tag="",this._posture=null,this._alphaTolerance=Ha.MATCH_OPAQUE_PIXELS,this._filters=[],this._updateCounter=0,this._updateContainer=!1,this._skipMouseHandling=!1}dispose(){this._texture=null,this._width=0,this._height=0}get id(){return this._id}set id(e){this._id=e}get name(){return this._name}set name(e){this._name!==e&&(this._name=e,this._updateCounter++)}get type(){return this._type}set type(e){this._type=e}get spriteType(){return this._spriteType}set spriteType(e){this._spriteType=e}get texture(){return this._texture}set texture(e){this._texture!==e&&(e&&(this._width=e.width,this._height=e.height),this._texture=e,this._updateCounter++)}get container(){return this._container}set container(e){this._container!==e&&(this.texture=Qs.EMPTY,e&&(this._width=e.width,this._height=e.height),this._container=e,this._updateCounter++,this._updateContainer=!0)}get width(){return this._width}get height(){return this._height}get offsetX(){return this._offsetX}set offsetX(e){this._offsetX!==e&&(this._offsetX=e,this._updateCounter++)}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY!==e&&(this._offsetY=e,this._updateCounter++)}get flipH(){return this._flipH}set flipH(e){this._flipH!==e&&(this._flipH=e,this._updateCounter++)}get flipV(){return this._flipV}set flipV(e){this._flipV!==e&&(this._flipV=e,this._updateCounter++)}get direction(){return this._direction}set direction(e){this._direction=e}get alpha(){return this._alpha}set alpha(e){e=e&255,this._alpha!==e&&(this._alpha=e,this._updateCounter++)}get blendMode(){return this._blendMode}set blendMode(e){this._blendMode!==e&&(this._blendMode=e,this._updateCounter++)}get color(){return this._color}set color(e){e=e&16777215,this._color!==e&&(this._color=e,this._updateCounter++)}get relativeDepth(){return this._relativeDepth}set relativeDepth(e){this._relativeDepth!==e&&(this._relativeDepth=e,this._updateCounter++)}get varyingDepth(){return this._varyingDepth}set varyingDepth(e){e!==this._varyingDepth&&(this._varyingDepth=e,this._updateCounter++)}get libraryAssetName(){return this._libraryAssetName}set libraryAssetName(e){this._libraryAssetName=e}get clickHandling(){return this._clickHandling}set clickHandling(e){this._clickHandling=e}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this._updateCounter++)}get tag(){return this._tag}set tag(e){this._tag!==e&&(this._tag=e,this._updateCounter++)}get posture(){return this._posture}set posture(e){this._posture!==e&&(this._posture=e,this._updateCounter++)}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(e){this._alphaTolerance!==e&&(this._alphaTolerance=e,this._updateCounter++)}get filters(){return this._filters}set filters(e){this._filters=e,this._updateCounter++}get updateCounter(){return this._updateCounter}get updateContainer(){return this._updateContainer}set updateContainer(e){this._updateContainer=e}get skipMouseHandling(){return this._skipMouseHandling}set skipMouseHandling(e){this._skipMouseHandling=e}};WE.SPRITE_COUNTER=0;let Pf=WE;const YE=class YE{constructor(){this._id=YE.VISUALIZATION_COUNTER++,this._object=null,this._asset=null,this._sprites=[],this._scale=-1,this._updateObjectCounter=-1,this._updateModelCounter=-1,this._updateSpriteCounter=-1}initialize(e){return!1}update(e,t,i,r){}reset(){this._scale=-1}dispose(){if(this._sprites){for(;this._sprites.length;){const e=this._sprites[0];e&&e.dispose(),this._sprites.pop()}this._sprites=null}this._object=null,this._asset=null}getSprite(e){return e>=0&&e<this._sprites.length?this._sprites[e]:null}getSpriteList(){return null}createSprite(){return this.createSpriteAtIndex(this._sprites.length)}createSpriteAtIndex(e){const t=new Pf;return e>=this._sprites.length?this._sprites.push(t):this._sprites.splice(e,0,t),t}createSprites(e){for(;this._sprites.length>e;){const t=this._sprites[this._sprites.length-1];t&&t.dispose(),this._sprites.pop()}for(;this._sprites.length<e;)this._sprites.push(new Pf)}get image(){return this.getImage(0,-1)}getImage(e,t){const i=this.getBoundingRectangle();if(i.width*i.height===0)return null;const r=this.totalSprites,n=[];let o=0;for(;o<r;){const u=this.getSprite(o);u&&u.visible&&u.texture&&n.push(u),o++}n.sort((u,d)=>d.relativeDepth-u.relativeDepth);const l=new kn;for(o=0;o<n.length;){const u=n[o],d=u.texture;if(d){const _=new Is(d);_.alpha=u.alpha/255,_.tint=u.color,_.x=u.offsetX,_.y=u.offsetY,_.blendMode=u.blendMode,_.filters=u.filters,u.flipH&&(_.scale.x=-1),u.flipV&&(_.scale.y=-1),l.addChild(_)}o++}const c=Vt.generateTexture(l);return c||null}getBoundingRectangle(){const e=this.totalSprites,t=new En;let i=0;for(;i<e;){const r=this.getSprite(i);if(r&&r.texture&&r.visible){const n=r.flipH?-r.width+r.offsetX:r.offsetX,o=r.flipV?-r.height+r.offsetY:r.offsetY,l=new ot(n,o);i===0?(t.x=l.x,t.y=l.y,t.width=r.width,t.height=r.height):(l.x<t.x&&(t.x=l.x),l.y<t.y&&(t.y=l.y),l.x+r.width>t.right&&(t.width=l.x+r.width-t.x),l.y+r.height>t.bottom&&(t.height=l.y+r.height-t.y))}i++}return t}get instanceId(){return this._id}get object(){return this._object}set object(e){this._object=e}get asset(){return this._asset}set asset(e){this._asset&&this._asset.removeReference(),this._asset=e,this._asset&&this._asset.addReference()}get sprites(){return this._sprites}get totalSprites(){return this._sprites.length}get updateObjectCounter(){return this._updateObjectCounter}set updateObjectCounter(e){this._updateObjectCounter=e}get updateModelCounter(){return this._updateModelCounter}set updateModelCounter(e){this._updateModelCounter=e}get updateSpriteCounter(){return this._updateSpriteCounter}set updateSpriteCounter(e){this._updateSpriteCounter=e}get spriteCount(){return this._sprites.length}};YE.VISUALIZATION_COUNTER=0;let Dd=YE;class N2{constructor(e){this._roomObjectVariableAccurateZ=e||"",this._location=new Y,this._screenLocation=new Y,this._locationChanged=!1,this._geometryUpdateId=-1,this._objectUpdateId=-1}dispose(){this._screenLocation=null}updateLocation(e,t){if(!e||!t)return null;let i=!1;const r=e.getLocation();if((t.updateId!==this._geometryUpdateId||e.updateCounter!==this._objectUpdateId)&&(this._objectUpdateId=e.updateCounter,(t.updateId!==this._geometryUpdateId||r.x!==this._location.x||r.y!==this._location.y||r.z!==this._location.z)&&(this._geometryUpdateId=t.updateId,this._location.assign(r),i=!0)),this._locationChanged=i,this._locationChanged){const n=t.getScreenPosition(r);if(!n)return null;const o=e.model.getValue(this._roomObjectVariableAccurateZ);if(isNaN(o)||o===0){const l=new Y(Math.round(r.x),Math.round(r.y),r.z);if(l.x!==r.x||l.y!==r.y){const c=t.getScreenPosition(l);this._screenLocation.assign(n),c&&(this._screenLocation.z=c.z)}else this._screenLocation.assign(n)}else this._screenLocation.assign(n);this._screenLocation.x=Math.round(this._screenLocation.x),this._screenLocation.y=Math.round(this._screenLocation.y)}return this._screenLocation}get locationChanged(){return this._locationChanged}}class A2{constructor(){this._sprites=[],this._updateId1=-1,this._updateId2=-1,this._isEmpty=!1}get spriteCount(){return this._sprites.length}get isEmpty(){return this._isEmpty}dispose(){this.setSpriteCount(0)}addSprite(e){this._sprites.push(e)}getSprite(e){return this._sprites[e]}get sprites(){return this._sprites}needsUpdate(e,t){return e===this._updateId1&&t===this._updateId2?!1:(this._updateId1=e,this._updateId2=t,!0)}setSpriteCount(e){if(e<this._sprites.length){let t=e;for(;t<this._sprites.length;){const i=this._sprites[t];i&&i.dispose(),t++}this._sprites.splice(e,this._sprites.length-e)}this._isEmpty=!this._sprites.length}}class b2{constructor(e){this._location=new N2(e),this._sprites=new A2}get location(){return this._location}get sprites(){return this._sprites}dispose(){this._location&&(this._location.dispose(),this._location=null),this._sprites&&(this._sprites.dispose(),this._sprites=null)}get objectId(){return this._objectId}set objectId(e){this._objectId=e}}const P_=class P_{constructor(e){this._data=new Map,this._roomObjectVariableAccurateZ=e}dispose(){if(this._data){for(const[e,t]of this._data.entries())t&&(this._data.delete(e),t.dispose());this._data=null}}getObjectCache(e){let t=this._data.get(e);return t||(t=new b2(this._roomObjectVariableAccurateZ),this._data.set(e,t)),t}removeObjectCache(e){const t=this._data.get(e);t&&(this._data.delete(e),t.dispose())}getSortableSpriteList(){const e=[];for(const t of this._data.values()){if(!t)continue;const i=t.sprites&&t.sprites.sprites;if(!(!i||!i.length)){for(const r of i)if(r&&r.sprite.spriteType!==Gn.ROOM_PLANE&&r.sprite.name!==""){const n=new tD;n.objectId=t.objectId,n.x=r.x,n.y=r.y,n.z=r.z,n.name=r.sprite.name||"",n.flipH=r.sprite.flipH,n.alpha=r.sprite.alpha,n.color=r.sprite.color.toString(),n.blendMode=r.sprite.blendMode.toString(),n.width=r.sprite.width,n.height=r.sprite.height,n.type=r.sprite.type,n.posture=r.sprite.posture;const o=this.isSkewedSprite(r.sprite);o&&(n.skew=r.sprite.direction%4===0?-.5:.5),(o||r.name.indexOf("%image.library.url%")>=0||r.name.indexOf("%group.badge.url%")>=0)&&n.width<=P_.MAX_SIZE_FOR_AVG_COLOR&&n.height<=P_.MAX_SIZE_FOR_AVG_COLOR&&r.sprite.name.indexOf("external_image_wallitem")===0&&(n.frame=!0),e.push(n)}}}return!e||!e.length?null:e}isSkewedSprite(e){return e.type?e.type.indexOf("external_image_wallitem")===0&&e.tag==="THUMBNAIL"||e.type.indexOf("guild_forum")===0&&e.tag==="THUMBNAIL":!1}getPlaneSortableSprites(){const e=[];for(const t of this._data.values())for(const i of t.sprites.sprites)i.sprite.spriteType===Gn.ROOM_PLANE&&e.push(i);return e}};P_.MAX_SIZE_FOR_AVG_COLOR=200;let JS=P_;const ao=class ao{static hex2rgb(e,t=[]){return t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(e&255)/255,t}static hex2rgba(e,t=[]){return t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(e&255)/255,t[3]=e&255,t}static rgb2hex(e){return(e[0]*255<<16)+(e[1]*255<<8)+(e[2]*255|0)}static rgba2hex(e){return(e[0]*255<<16)+(e[1]*255<<8)+(e[2]*255|0)+(e[3]|0)}static rgbStringToHex(e){const t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+ao.getHex(t[1])+ao.getHex(t[2])+ao.getHex(t[3])}static getHex(e){return isNaN(e)?"00":ao.HEX_DIGITS[(e-e%16)/16]+ao.HEX_DIGITS[e%16]}static int2rgb(e){e>>>=0;const t=e&255,i=(e&65280)>>>8;return"rgba("+[(e&16711680)>>>16,i,t,1].join(",")+")"}static rgbToHSL(e){const t=(e>>16&255)/255,i=(e>>8&255)/255,r=(e&255)/255,n=Math.max(t,i,r),o=Math.min(t,i,r),l=n-o;let c=0,u=0,d=0;l==0?c=0:n==t?i>r?c=60*(i-r)/l:c=60*(i-r)/l+360:n==i?c=60*(r-t)/l+120:n==r&&(c=60*(t-i)/l+240),u=.5*(n+o),l==0?d=0:u<=.5?d=l/u*.5:d=l/(1-u)*.5;const _=Math.round(c/360*255),m=Math.round(d*255),f=Math.round(u*255);return(_<<16)+(m<<8)+f}static hslToRGB(e){let t,i,r,n,o;const l=(e>>16&255)/255,c=(e>>8&255)/255,u=(e&255)/255;let d=0,_=0,m=0;c>0?(t=0,i=0,u<.5?t=u*(1+c):t=u+c-u*c,i=2*u-t,r=l+1/3,n=l,o=l-1/3,r<0?r=r+1:r>1&&r--,n<0?n=n+1:n>1&&n--,o<0?o=o+1:o>1&&o--,r*6<1?d=i+(t-i)*6*r:r*2<1?d=t:r*3<2?d=i+(t-i)*6*(2/3-r):d=i,n*6<1?_=i+(t-i)*6*n:n*2<1?_=t:n*3<2?_=i+(t-i)*6*(2/3-n):_=i,o*6<1?m=i+(t-i)*6*o:o*2<1?m=t:o*3<2?m=i+(t-i)*6*(2/3-o):m=i):(d=u,_=u,m=u);const f=Math.round(d*255),E=Math.round(_*255),I=Math.round(m*255);return(f<<16)+(E<<8)+I}static rgb2xyz(e){let t=(e>>16&255)/255,i=(e>>8&255)/255,r=(e>>0&255)/255;return t>.04045?t=Math.pow((t+.055)/1.055,2.4):t=t/12.92,i>.04045?i=Math.pow((i+.055)/1.055,2.4):i=i/12.92,r>.04045?r=Math.pow((r+.055)/1.055,2.4):r=r/12.92,t=t*100,i=i*100,r=r*100,new Y(t*.4124+i*.3576+r*.1805,t*.2126+i*.7152+r*.0722,t*.0193+i*.1192+r*.9505)}static xyz2CieLab(e){let t=e.x/95.047,i=e.y/100,r=e.z/108.883;return t>.008856?t=Math.pow(t,1/3):t=7.787*t+16/116,i>.008856?i=Math.pow(i,1/3):i=7.787*i+16/116,r>.008856?r=Math.pow(r,1/3):r=7.787*r+16/116,new Y(116*i-16,500*(t-i),200*(i-r))}static rgb2CieLab(e){return ao.xyz2CieLab(ao.rgb2xyz(e))}static colorize(e,t){if(t===4294967295)return e;let i=t>>16&255,r=t>>8&255,n=t&255;return i=(e>>16&255)*i/255,r=(e>>8&255)*r/255,n=(e&255)*n/255,(e&&4278190080)|i<<16|r<<8|n}static hslToHex(e,t,i){if(e<0||e>360||t<0||t>100||i<0||i>100)return 0;const r=t/100,n=i/100,o=(1-Math.abs(2*n-1))*r,l=o*(1-Math.abs(e/60%2-1)),c=n-o/2;let u,d,_;e>=0&&e<60?[u,d,_]=[o,l,0]:e>=60&&e<120?[u,d,_]=[l,o,0]:e>=120&&e<180?[u,d,_]=[0,o,l]:e>=180&&e<240?[u,d,_]=[0,l,o]:e>=240&&e<300?[u,d,_]=[l,0,o]:e>=300&&e<360&&([u,d,_]=[o,0,l]),u=Math.round((u+c)*255),d=Math.round((d+c)*255),_=Math.round((_+c)*255);const m=f=>f.toString(16).padStart(2,"0").toUpperCase();return parseInt(`0x${m(u)}${m(d)}${m(_)}`,16)}static rgb2int(e,t,i,r=1){return(Math.round(r*255)&255)<<24>>>0|e<<16|t<<8|i}static hexToInt(e){e.startsWith("#")&&(e=e.slice(1));const t=parseInt(e.slice(0,2),16),i=parseInt(e.slice(2,4),16),r=parseInt(e.slice(4,6),16);return this.rgb2int(t,i,r)}static hexToColorId(e){e.startsWith("#")&&(e=e.slice(1));const t=parseInt(e.slice(0,2),16),i=parseInt(e.slice(2,4),16),r=parseInt(e.slice(4,6),16);return(t<<16|i<<8|r)>>>0}};ao.HEX_DIGITS=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];let Ri=ao;class ob{constructor(e){e<0&&(e=0),this._reservedNumbers=[],this._freeNumbers=[];let t=0;for(;t<e;)this._freeNumbers.push(t),t++}dispose(){this._reservedNumbers=null,this._freeNumbers=null}reserveNumber(){if(this._freeNumbers.length>0){const e=this._freeNumbers.pop();return this._reservedNumbers.push(e),e}return-1}freeNumber(e){const t=this._reservedNumbers.indexOf(e);t>=0&&(this._reservedNumbers.splice(t,1),this._freeNumbers.push(e))}}class v2{static getFlipHBitmapData(e){if(!e)return null;const t=Vt.createRenderTexture(e.width,e.height),i=new qr;return i.scale(-1,1),i.translate(e.width,0),di.instance.renderer.render(new si(e),{renderTexture:t,clear:!0,transform:i}),t}static getFlipVBitmapData(e){if(!e)return null;const t=new qr;t.scale(1,-1),t.translate(0,e.height);const i=new NS;return i.beginTextureFill({texture:e,matrix:t}).drawRect(0,0,e.width,e.height).endFill(),Vt.generateTexture(i)}static getFlipHVBitmapData(e){if(!e)return null;const t=new qr;t.scale(-1,-1),t.translate(e.width,e.height);const i=new NS;return i.beginTextureFill({texture:e,matrix:t}).drawRect(0,0,e.width,e.height).endFill(),Vt.generateTexture(i)}}const Rt=class Rt{static init(e,t){Rt._currentDelta=0,Rt._startDelayMs=e,Rt._effectDurationMs=t,Rt._initializationTimeMs=nt(),Rt._state=Rt.STATE_START_DELAY}static turnVisualizationOn(){if(Rt._state===Rt.STATE_NOT_INITIALIZED||Rt._state===Rt.STATE_OVER)return;const e=nt()-Rt._initializationTimeMs;if(e>Rt._startDelayMs+Rt._effectDurationMs){Rt._state=Rt.STATE_OVER;return}if(Rt._visualizationOn=!0,e<Rt._startDelayMs){Rt._state=Rt.STATE_START_DELAY;return}Rt._state=Rt.STATE_RUNNING,Rt._currentDelta=(e-Rt._startDelayMs)/Rt._effectDurationMs}static turnVisualizationOff(){Rt._visualizationOn=!1}static isVisualizationOn(){return Rt._visualizationOn&&Rt.isRunning()}static isRunning(){return Rt._state===Rt.STATE_START_DELAY||Rt._state===Rt.STATE_RUNNING}static getDelta(e=0,t=1){return Math.min(Math.max(Rt._currentDelta,e),t)}static get totalRunningTime(){return Rt._startDelayMs+Rt._effectDurationMs}};Rt.STATE_NOT_INITIALIZED=0,Rt.STATE_START_DELAY=1,Rt.STATE_RUNNING=2,Rt.STATE_OVER=3,Rt._state=Rt.STATE_NOT_INITIALIZED,Rt._visualizationOn=!1,Rt._currentDelta=0,Rt._initializationTimeMs=0,Rt._startDelayMs=20*1e3,Rt._effectDurationMs=2e3;let Bn=Rt;const oo=class oo{constructor(e,t,i,r=null){this._updateId=0,this._scale=1,this._x_scale=1,this._y_scale=1,this._z_scale=1,this._x_scale_internal=1,this._y_scale_internal=1,this._z_scale_internal=1,this._clipNear=-500,this._clipFar=500,this._displacements=null,this.scale=e,this._x=new Y,this._y=new Y,this._z=new Y,this._directionAxis=new Y,this._location=new Y,this._direction=new Y,this._depth=new Y,this._x_scale_internal=1,this._y_scale_internal=1,this.x_scale=1,this.y_scale=1,this._z_scale_internal=Math.sqrt(1/2)/Math.sqrt(3/4),this.z_scale=1,this.location=new Y(i.x,i.y,i.z),this.direction=new Y(t.x,t.y,t.z),r!=null?this.setDepthVector(r):this.setDepthVector(t),this._displacements=new Map}static getIntersectionVector(e,t,i,r){const n=Y.dotProduct(t,r);if(Math.abs(n)<1e-5)return null;const o=Y.dif(e,i),l=-Y.dotProduct(r,o)/n;return Y.sum(e,Y.product(t,l))}get updateId(){return this._updateId}get scale(){return this._scale/Math.sqrt(.5)}set scale(e){e<=1&&(e=1),e=e*Math.sqrt(.5),e!=this._scale&&(this._scale=e,this._updateId++)}get directionAxis(){return this._directionAxis}get location(){return this._location.assign(this._loc),this._location.x=this._location.x*this._x_scale,this._location.y=this._location.y*this._y_scale,this._location.z=this._location.z*this._z_scale,this._location}set location(e){if(e==null)return;this._loc==null&&(this._loc=new Y);const t=this._loc.x,i=this._loc.y,r=this._loc.z;this._loc.assign(e),this._loc.x=this._loc.x/this._x_scale,this._loc.y=this._loc.y/this._y_scale,this._loc.z=this._loc.z/this._z_scale,(this._loc.x!=t||this._loc.y!=i||this._loc.z!=r)&&this._updateId++}get direction(){return this._direction}set direction(e){let t,i,r,n,o;if(e==null)return;this._dir==null&&(this._dir=new Y);const l=this._dir.x,c=this._dir.y,u=this._dir.z;this._dir.assign(e),this._direction.assign(e),(this._dir.x!=l||this._dir.y!=c||this._dir.z!=u)&&this._updateId++;const d=new Y(0,1,0),_=new Y(0,0,1),m=new Y(1,0,0),f=e.x/180*Math.PI,E=e.y/180*Math.PI,I=e.z/180*Math.PI,p=Math.cos(f),S=Math.sin(f),R=Y.sum(Y.product(d,p),Y.product(m,-S)),O=new Y(_.x,_.y,_.z),C=Y.sum(Y.product(d,S),Y.product(m,p)),A=Math.cos(E),b=Math.sin(E),y=new Y(R.x,R.y,R.z),M=Y.sum(Y.product(O,A),Y.product(C,b)),U=Y.sum(Y.product(O,-b),Y.product(C,A));I!=0?(t=Math.cos(I),i=Math.sin(I),r=Y.sum(Y.product(y,t),Y.product(M,i)),n=Y.sum(Y.product(y,-i),Y.product(M,t)),o=new Y(U.x,U.y,U.z),this._x.assign(r),this._y.assign(n),this._z.assign(o),this._directionAxis.assign(this._z)):(this._x.assign(y),this._y.assign(M),this._z.assign(U),this._directionAxis.assign(this._z))}set x_scale(e){this._x_scale!=e*this._x_scale_internal&&(this._x_scale=e*this._x_scale_internal,this._updateId++)}set y_scale(e){this._y_scale!=e*this._y_scale_internal&&(this._y_scale=e*this._y_scale_internal,this._updateId++)}set z_scale(e){this._z_scale!=e*this._z_scale_internal&&(this._z_scale=e*this._z_scale_internal,this._updateId++)}dispose(){this._x=null,this._y=null,this._z=null,this._loc=null,this._dir=null,this._directionAxis=null,this._location=null,this._displacements!=null&&(this._displacements.clear(),this._displacements=null)}setDisplacement(e,t){let i,r;e==null||t==null||this._displacements!=null&&(i=Math.trunc(Math.round(e.x))+"_"+Math.trunc(Math.round(e.y))+"_"+Math.trunc(Math.round(e.z)),this._displacements.delete(i),r=new Y,r.assign(t),this._displacements.set(i,r),this._updateId++)}getDisplacenent(e){let t;return this._displacements!=null?(t=Math.trunc(Math.round(e.x))+"_"+Math.trunc(Math.round(e.y))+"_"+Math.trunc(Math.round(e.z)),this._displacements.get(t)):null}setDepthVector(e){let t,i,r;const n=new Y(0,1,0),o=new Y(0,0,1),l=new Y(1,0,0),c=e.x/180*Math.PI,u=e.y/180*Math.PI,d=e.z/180*Math.PI,_=Math.cos(c),m=Math.sin(c),f=Y.sum(Y.product(n,_),Y.product(l,-m)),E=new Y(o.x,o.y,o.z),I=Y.sum(Y.product(n,m),Y.product(l,_)),p=Math.cos(u),S=Math.sin(u),R=new Y(f.x,f.y,f.z),O=Y.sum(Y.product(E,p),Y.product(I,S)),C=Y.sum(Y.product(E,-S),Y.product(I,p));d!=0?(t=Math.cos(d),i=Math.sin(d),Y.sum(Y.product(R,t),Y.product(O,i)),Y.sum(Y.product(R,-i),Y.product(O,t)),r=new Y(C.x,C.y,C.z),this._depth.assign(r)):this._depth.assign(C),this._updateId++}adjustLocation(e,t){if(e==null||this._z==null)return;const i=Y.product(this._z,-t),r=new Y(e.x+i.x,e.y+i.y,e.z+i.z);this.location=r}getCoordinatePosition(e){if(e==null)return null;const t=Y.scalarProjection(e,this._x),i=Y.scalarProjection(e,this._y),r=Y.scalarProjection(e,this._z);return new Y(t,i,r)}getScreenPosition(e){let t=Y.dif(e,this._loc);t.x=t.x*this._x_scale,t.y=t.y*this._y_scale,t.z=t.z*this._z_scale;let i=Y.scalarProjection(t,this._depth);if(i<this._clipNear||i>this._clipFar)return null;let r=Y.scalarProjection(t,this._x),n=-Y.scalarProjection(t,this._y);r=r*this._scale,n=n*this._scale;const o=this.getDisplacenent(e);return o!=null&&(t=Y.dif(e,this._loc),t.add(o),t.x=t.x*this._x_scale,t.y=t.y*this._y_scale,t.z=t.z*this._z_scale,i=Y.scalarProjection(t,this._depth)),t.x=r,t.y=n,t.z=i,t}getScreenPoint(e){const t=this.getScreenPosition(e);return t==null?null:new ot(t.x,t.y)}getPlanePosition(e,t,i,r){let n,o;const l=e.x/this._scale,c=-e.y/this._scale,u=Y.product(this._x,l);u.add(Y.product(this._y,c));const d=new Y(this._loc.x*this._x_scale,this._loc.y*this._y_scale,this._loc.z*this._z_scale);d.add(u);const _=this._z,m=new Y(t.x*this._x_scale,t.y*this._y_scale,t.z*this._z_scale),f=new Y(i.x*this._x_scale,i.y*this._y_scale,i.z*this._z_scale),E=new Y(r.x*this._x_scale,r.y*this._y_scale,r.z*this._z_scale),I=Y.crossProduct(f,E),p=new Y;return p.assign(oo.getIntersectionVector(d,_,m,I)),p!=null?(p.subtract(m),n=Y.scalarProjection(p,i)/f.length*i.length,o=Y.scalarProjection(p,r)/E.length*r.length,new ot(n,o)):null}performZoom(){this.isZoomedIn()?this.scale=oo.SCALE_ZOOMED_OUT:this.scale=oo.SCALE_ZOOMED_IN}isZoomedIn(){return this.scale==oo.SCALE_ZOOMED_IN}performZoomOut(){this.scale=oo.SCALE_ZOOMED_OUT}performZoomIn(){this.scale=oo.SCALE_ZOOMED_IN}};oo.SCALE_ZOOMED_IN=64,oo.SCALE_ZOOMED_OUT=32;let Cc=oo;const U_=class U_{static makeRoomPreviewerId(e){return(e&65535)+U_.PREVIEW_ROOM_ID_BASE}static isRoomPreviewerId(e){return e>=U_.PREVIEW_ROOM_ID_BASE}};U_.PREVIEW_ROOM_ID_BASE=2147418112;let Ba=U_;const ta=class ta{static init(e,t){this._SafeStr_4513=0,this._SafeStr_4515=e,this._SafeStr_4516=t,this._SafeStr_4514=nt(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const e=nt()-this._SafeStr_4514;if(e>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,e<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(e-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}};ta.STATE_NOT_INITIALIZED=0,ta.STATE_START_DELAY=1,ta.STATE_RUNNING=2,ta.STATE_OVER=3,ta._SafeStr_448=0,ta._SafeStr_4512=!1,ta._SafeStr_4513=0,ta._SafeStr_4514=0,ta._SafeStr_4515=2e4,ta._SafeStr_4516=5e3;let ZS=ta;const Ca=class Ca{static init(e,t){this._SafeStr_4513=0,this._SafeStr_4515=e,this._SafeStr_4516=t,this._SafeStr_4514=nt(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const e=nt()-this._SafeStr_4514;if(e>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,e<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(e-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}};Ca.STATE_NOT_INITIALIZED=0,Ca.STATE_START_DELAY=1,Ca.STATE_RUNNING=2,Ca.STATE_OVER=3,Ca._SafeStr_448=0,Ca._SafeStr_4512=!1,Ca._SafeStr_4514=0,Ca._SafeStr_4515=2e4,Ca._SafeStr_4516=5e3;let Md=Ca;class y2{static hex2int(e){return parseInt(e,16)}static inkToBlendMode(e){return e=="ADD"||e==33?ss.ADD:e=="SUBTRACT"?ss.SUBTRACT:e=="DARKEN"?ss.DARKEN:e=="SCREEN"?ss.SCREEN:e=="LIGHTEN"?ss.LIGHTEN:e=="COLOR_DODGE"?ss.COLOR_DODGE:e=="COLOR_BURN"?ss.COLOR_BURN:e=="HARD_LIGHT"?ss.HARD_LIGHT:e=="SOFT_LIGHT"?ss.SOFT_LIGHT:e=="DIFFERENCE"?ss.DIFFERENCE:e=="EXCLUSION"?ss.EXCLUSION:e=="OVERLAY"?ss.OVERLAY:e=="SATURATION"?ss.SATURATION:e=="COLOR"?ss.COLOR:e=="LUMINOSITY"?ss.LUMINOSITY:e=="ADD_NPM"?ss.ADD_NPM:e=="OVERLAY"?ss.OVERLAY:e=="MULTIPLY"?ss.MULTIPLY:e=="XOR"?ss.XOR:e=="DST_OUT"?ss.DST_OUT:e=="DST_IN"?ss.DST_IN:e=="DST_OVER"?ss.DST_OVER:e=="DST_ATOP"?ss.DST_ATOP:e=="SRC_OUT"?ss.SRC_OUT:e=="SRC_ATOP"?ss.SRC_ATOP:e=="SRC_OVER"?ss.SRC_OVER:e=="SRC_IN"?ss.SRC_IN:e=="XOR"?ss.XOR:ss.NORMAL}}class Uf extends si{constructor(e=null){super(e),this._offsetX=0,this._offsetY=0,this._tag="",this._alphaTolerance=128,this._varyingDepth=!1,this._clickHandling=!1,this._skipMouseHandling=!1,this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1}needsUpdate(e,t){return this._pairedSpriteId===e&&this._pairedSpriteUpdateCounter===t?!1:(this._pairedSpriteId=e,this._pairedSpriteUpdateCounter=t,!0)}calculateVertices(){this.texture.orig&&super.calculateVertices()}setTexture(e){e||(e=Qs.EMPTY),e!==this.texture&&(e===Qs.EMPTY&&(this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1),this.texture=e)}containsPoint(e){return Uf.containsPoint(this,e)}static containsPoint(e,t){if(!e||!t||e.alphaTolerance>255||!(e instanceof si))return!1;if(e.texture===Qs.EMPTY||e.blendMode!==ss.NORMAL)return;const i=e.texture,r=i.baseTexture;if(!i||!r||!r.valid)return!1;const n=t.x*e.scale.x,o=t.y*e.scale.y;if(!e.getLocalBounds().contains(n,o)||!r.hitMap&&!Uf.generateHitMap(r))return!1;const l=r.hitMap;let c=n+i.frame.x,u=o+i.frame.y;i.trim&&(c-=i.trim.x,u-=i.trim.y),c=Math.round(c)*r.resolution,u=Math.round(u)*r.resolution;const d=c+u*r.realWidth,_=d%32,m=d/32|0;return(l[m]&1<<_)!==0}static generateHitMap(e){if(!e)return!1;const t=new Qs(e),i=new si(t),r=Vt.getPixels(i),n=e.width,o=e.height,l=new Uint32Array(Math.ceil(n*o/32)),c=Ha.MATCH_OPAQUE_PIXELS;for(let u=0;u<n*o;u++){const d=u%32,_=u/32|0;r[u*4+3]>=c&&(l[_]=l[_]|1<<d)}return e.hitMap=l,i.destroy(),t.destroy(),!0}get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e}get tag(){return this._tag}set tag(e){this._tag=e}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(e){this._alphaTolerance=e}get varyingDepth(){return this._varyingDepth}set varyingDepth(e){this._varyingDepth=e}get clickHandling(){return this._clickHandling}set clickHandling(e){this._clickHandling=e}get skipMouseHandling(){return this._skipMouseHandling}set skipMouseHandling(e){this._skipMouseHandling=e}}class D2{constructor(){this._objectId="",this._spriteTag=""}get objectId(){return this._objectId}set objectId(e){this._objectId=e}get spriteTag(){return this._spriteTag}set spriteTag(e){this._spriteTag=e}}const zE=class zE{constructor(){this._name="",this._sprite=null,this._x=0,this._y=0,this._z=0}dispose(){this._z=-zE.Z_INFINITY,this._sprite=null}get name(){return this._name}set name(e){this._name=e}get sprite(){return this._sprite}set sprite(e){this._sprite=e}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get z(){return this._z}set z(e){this._z=e}};zE.Z_INFINITY=1e8;let eR=zE;class M2{constructor(e,t,i,r,n){this._SafeStr_4507=!1,this._rotation=0,this._rotationOrigin=null,this._rotationRodLength=0,this._SafeStr_795=0,this._id=t,this._container=e,this._geometry=new Cc(n,new Y(-135,30,0),new Y(11,11,5),new Y(-135,.5,0)),this._animationFPS=De.instance.getConfiguration("system.fps.animation",24),this._renderTimestamp=0,this._totalTimeRunning=0,this._lastFrame=0,this._master=null,this._display=null,this._mask=null,this._sortableSprites=[],this._spriteCount=0,this._activeSpriteCount=0,this._spritePool=[],this._skipObjectUpdate=!1,this._runningSlow=!1,this._width=0,this._height=0,this._renderedWidth=0,this._renderedHeight=0,this._screenOffsetX=0,this._screenOffsetY=0,this._mouseLocation=new ot,this._mouseOldX=0,this._mouseOldY=0,this._mouseCheckCount=0,this._mouseSpriteWasHit=!1,this._mouseActiveObjects=new Map,this._eventCache=new Map,this._eventId=0,this._scale=1,this._restrictsScaling=!1,this._noSpriteVisibilityChecking=!1,this._usesExclusionRectangles=!1,this._usesMask=!0,this._canvasUpdated=!1,this._objectCache=new JS(this._container.roomObjectVariableAccurateZ),this._mouseListener=null,this.setupCanvas(),this.initialize(i,r)}setupCanvas(){if(this._master||(this._master=new Is,this._master.interactiveChildren=!1),!this._display){const e=new kn;this._master.addChild(e),this._display=e}}dispose(){if(this.cleanSprites(0,!0),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._mask&&(this._mask=null),this._objectCache&&(this._objectCache.dispose(),this._objectCache=null),this._master){for(;this._master.children.length;)this._master.removeChildAt(0).destroy();this._master.parent&&this._master.parent.removeChild(this._master),this._master.destroy(),this._master=null}if(this._display=null,this._sortableSprites=[],this._mouseActiveObjects&&(this._mouseActiveObjects.clear(),this._mouseActiveObjects=null),this._spritePool){for(const e of this._spritePool)this.cleanSprite(e,!0);this._spritePool=[]}this._eventCache&&(this._eventCache.clear(),this._eventCache=null),this._mouseListener=null}initialize(e,t){if(e=e<1?1:e,t=t<1?1:t,this._usesMask&&(this._mask?this._mask.clear().beginFill(16711680).drawRect(0,0,e,t).endFill():(this._mask=new NS().beginFill(16711680).drawRect(0,0,e,t).endFill(),this._master&&(this._master.addChild(this._mask),this._display&&(this._display.mask=this._mask)))),this._master){if(this._master.hitArea){const i=this._master.hitArea;i.width=e,i.height=t}else this._master.hitArea=new En(0,0,e,t);if(this._master.filterArea){const i=this._master.filterArea;i.width=e,i.height=t}else this._master.filterArea=new En(0,0,e,t)}this._width=e,this._height=t}setMask(e){e&&!this._usesMask?(this._usesMask=!0,this._mask&&this._mask.parent!==this._master&&(this._master.addChild(this._mask),this._display.mask=this._mask)):!e&&this._usesMask&&(this._usesMask=!1,this._mask&&this._mask.parent===this._master&&(this._master.removeChild(this._mask),this._display.mask=null))}setScale(e,t=null,i=null,r=!1,n=!1){!this._master||!this._display||this._restrictsScaling&&!r||(t||(t=new ot(this._width/2,this._height/2)),i||(i=t),t=this._display.toLocal(t),n?this._scale*=e:this._scale=e,this.screenOffsetX=i.x-t.x*this._scale,this.screenOffsetY=i.y-t.y*this._scale)}render(e,t=!1){if(this._canvasUpdated=!1,this._totalTimeRunning+=Gi().deltaTime,this._totalTimeRunning===this._renderTimestamp||(e===-1&&(e=this._renderTimestamp+1),!this._container||!this._geometry))return;(this._width!==this._renderedWidth||this._height!==this._renderedHeight)&&(t=!0),(this._display.x!==this._screenOffsetX||this._display.y!==this._screenOffsetY)&&(this._display.position.set(this._screenOffsetX,this._screenOffsetY),t=!0),this._display.scale.x!==this._scale&&(this._display.scale.set(this._scale),t=!0),this.doMagic();const i=Math.round(this._totalTimeRunning/(60/this._animationFPS));let r=!1;i!==this._lastFrame&&(this._lastFrame=i,r=!0);let n=0;const o=this._container.objects;if(o.size)for(const c of o.values())c&&(n=n+this.renderObject(c,c.instanceId.toString(),e,t,r,n));this._sortableSprites.sort((c,u)=>u.z-c.z),n<this._sortableSprites.length&&this._sortableSprites.splice(n);let l=0;for(;l<n;){const c=this._sortableSprites[l];c&&c.sprite&&this.renderSprite(l,c),l++}this.cleanSprites(n),(t||r)&&(this._canvasUpdated=!0),this._renderTimestamp=this._totalTimeRunning,this._renderedWidth=this._width,this._renderedHeight=this._height}skipSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!0,this.render(-1,!0)}resumeSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!1}getSortableSpriteList(){return this._objectCache.getSortableSpriteList()}getPlaneSortableSprites(){return this._objectCache.getPlaneSortableSprites()}removeFromCache(e){this._objectCache.removeObjectCache(e)}renderObject(e,t,i,r,n,o){if(!e)return 0;const l=e.visualization;if(!l)return this.removeFromCache(t),0;const c=this.getCacheItem(t);c.objectId=e.instanceId;const u=c.location,d=c.sprites,_=u.updateLocation(e,this._geometry);if(!_)return this.removeFromCache(t),0;if(n&&l.update(this._geometry,i,!d.isEmpty||r,this._skipObjectUpdate&&this._runningSlow),u.locationChanged&&(r=!0),!d.needsUpdate(l.instanceId,l.updateSpriteCounter)&&!r)return d.spriteCount;let m=_.x,f=_.y,E=_.z;m>0?E=E+m*12e-8:E=E+-m*12e-8,m=m+Math.trunc(this._width/2),f=f+Math.trunc(this._height/2);let I=0;for(const p of l.sprites.values()){if(!p||!p.visible)continue;const S=p.texture,R=S&&S.baseTexture;if(!S||!R)continue;const O=m+p.offsetX+this._screenOffsetX,C=f+p.offsetY+this._screenOffsetY;if(p.flipH){const b=m+-(S.width+-p.offsetX)+this._screenOffsetX;if(!this.isSpriteVisible(b,C,S.width,S.height))continue}else if(p.flipV){const b=f+-(S.height+-p.offsetY)+this._screenOffsetY;if(!this.isSpriteVisible(O,b,S.width,S.height))continue}else if(!this.isSpriteVisible(O,C,S.width,S.height))continue;let A=d.getSprite(I);A||(A=new eR,d.addSprite(A),this._sortableSprites.push(A),A.name=t),A.sprite=p,(p.spriteType===Gn.AVATAR||p.spriteType===Gn.AVATAR_OWN)&&(A.sprite.libraryAssetName="avatar_"+e.id),A.x=O-this._screenOffsetX,A.y=C-this._screenOffsetY,A.z=E+p.relativeDepth+37e-12*o,I++,o++}return d.setSpriteCount(I),this._canvasUpdated=!0,I}getExtendedSprite(e){if(e<0||e>=this._spriteCount)return null;const t=this._display.getChildAt(e);return t||null}getExtendedSpriteIdentifier(e){return e?e.name:""}renderSprite(e,t){if(e>=this._spriteCount)return this.createAndAddSprite(t),!0;if(!t)return!1;const i=t.sprite,r=this.getExtendedSprite(e);if(!i||!r)return!1;if(r.varyingDepth!==i.varyingDepth)return r.varyingDepth&&!i.varyingDepth?(this._display.removeChildAt(e),this._spritePool.push(r),this.renderSprite(e,t)):(this.createAndAddSprite(t,e),!0);if(r.needsUpdate(i.id,i.updateCounter)||Bn.isVisualizationOn()){r.tag=i.tag,r.alphaTolerance=i.alphaTolerance,r.name=t.name,r.varyingDepth=i.varyingDepth,r.clickHandling=i.clickHandling,r.skipMouseHandling=i.skipMouseHandling,r.filters=i.filters;const n=i.alpha/255;r.alpha!==n&&(r.alpha=n),r.tint!==i.color&&(r.tint=i.color),r.blendMode!==i.blendMode&&(r.blendMode=i.blendMode),r.texture!==i.texture&&r.setTexture(i.texture),i.updateContainer&&(r.children.length===1&&r.removeChildAt(0),r.addChild(i.container),i.updateContainer=!1),i.flipH?r.scale.x!==-1&&(r.scale.x=-1):r.scale.x!==1&&(r.scale.x=1),i.flipV?r.scale.y!==-1&&(r.scale.y=-1):r.scale.y!==1&&(r.scale.y=1),this.updateEnterRoomEffect(r,i)}return r.x!==t.x&&(r.x=t.x),r.y!==t.y&&(r.y=t.y),r.offsetX=i.offsetX,r.offsetY=i.offsetY,!0}createAndAddSprite(e,t=-1){const i=e.sprite;if(!i)return;let r=null;this._spritePool.length>0&&(r=this._spritePool.pop()),r||(r=new Uf),r.children.length&&r.removeChildren(),r.tag=i.tag,r.alphaTolerance=i.alphaTolerance,r.alpha=i.alpha/255,r.tint=i.color,r.x=e.x,r.y=e.y,r.offsetX=i.offsetX,r.offsetY=i.offsetY,r.name=i.name,r.varyingDepth=i.varyingDepth,r.clickHandling=i.clickHandling,r.skipMouseHandling=i.skipMouseHandling,r.blendMode=i.blendMode,r.filters=i.filters,r.setTexture(i.texture),i.updateContainer&&(r.addChild(i.container),i.updateContainer=!1),i.flipH&&(r.scale.x=-1),i.flipV&&(r.scale.y=-1),this.updateEnterRoomEffect(r,i),t<0||t>=this._spriteCount?(this._display.addChild(r),this._spriteCount++):this._display.addChildAt(r,t),this._activeSpriteCount++}cleanSprites(e,t=!1){if(this._display){if(e<0&&(e=0),e<this._activeSpriteCount||!this._activeSpriteCount){let i=this._spriteCount-1;for(;i>=e;)this.cleanSprite(this.getExtendedSprite(i),t),i--}this._activeSpriteCount=e}}updateEnterRoomEffect(e,t){if(!(!Bn.isVisualizationOn()||!t))switch(t.spriteType){case Gn.AVATAR_OWN:return;case Gn.ROOM_PLANE:e.alpha=Bn.getDelta(.9);return;case Gn.AVATAR:e.alpha=Bn.getDelta(.5);return;default:e.alpha=Bn.getDelta(.1)}}cleanSprite(e,t){e&&(t?(e.parent&&e.parent.removeChild(e),e.destroy({children:!0})):e.setTexture(null))}update(){this._mouseCheckCount,this._mouseCheckCount=0,this._eventId++}setMouseListener(e){this._mouseListener=e}getCacheItem(e){return this._objectCache.getObjectCache(e)}isSpriteVisible(e,t,i,r){return!!(this._noSpriteVisibilityChecking||(e=(e-this._screenOffsetX)*this._scale+this._screenOffsetX,t=(t-this._screenOffsetY)*this._scale+this._screenOffsetY,i=i*this._scale,r=r*this._scale,e<this._width&&e+i>=0&&t<this._height&&t+r>=0&&!this._usesExclusionRectangles))}handleMouseEvent(e,t,i,r,n,o,l){return e=e-this._screenOffsetX,t=t-this._screenOffsetY,this._mouseLocation.x=e/this._scale,this._mouseLocation.y=t/this._scale,this._mouseCheckCount>0&&i==Re.MOUSE_MOVE?this._mouseSpriteWasHit:(this._mouseSpriteWasHit=this.checkMouseHits(Math.trunc(e/this._scale),Math.trunc(t/this._scale),i,r,n,o,l),this._mouseCheckCount++,this._mouseSpriteWasHit)}checkMouseHits(e,t,i,r=!1,n=!1,o=!1,l=!1){const c=[];let u=!1,d=null,_=this._activeSpriteCount-1;for(;_>=0;){const E=this.getExtendedSprite(_);if(E&&E.containsPoint(new ot(e-E.x,t-E.y))&&!E.skipMouseHandling&&!(E.clickHandling&&(i===Re.MOUSE_CLICK||i===Re.DOUBLE_CLICK))){const I=this.getExtendedSpriteIdentifier(E);if(c.indexOf(I)===-1){const p=E.tag;let S=this._mouseActiveObjects.get(I);S&&S.spriteTag!==p&&(d=this.createMouseEvent(0,0,0,0,Re.ROLL_OUT,S.spriteTag,r,n,o,l),this.bufferMouseEvent(d,I)),i===Re.MOUSE_MOVE&&(!S||S.spriteTag!==p)?d=this.createMouseEvent(e,t,e-E.x,t-E.y,Re.ROLL_OVER,p,r,n,o,l):(d=this.createMouseEvent(e,t,e-E.x,t-E.y,i,p,r,n,o,l),d.spriteOffsetX=E.offsetX,d.spriteOffsetY=E.offsetY),S||(S=new D2,S.objectId=I,this._mouseActiveObjects.set(I,S)),S.spriteTag=p,(i!==Re.MOUSE_MOVE||e!==this._mouseOldX||t!==this._mouseOldY)&&this.bufferMouseEvent(d,I),c.push(I)}u=!0}_--}const m=[];for(const E of this._mouseActiveObjects.keys())E&&m.push(E);let f=0;for(;f<m.length;){const E=m[f];c.indexOf(E)>=0&&(m[f]=null),f++}for(f=0;f<m.length;){const E=m[f];if(E!==null){const I=this._mouseActiveObjects.get(E);I&&this._mouseActiveObjects.delete(E);const p=this.createMouseEvent(0,0,0,0,Re.ROLL_OUT,I.spriteTag,r,n,o,l);this.bufferMouseEvent(p,E)}f++}return this.processMouseEvents(),this._mouseOldX=e,this._mouseOldY=t,u}createMouseEvent(e,t,i,r,n,o,l,c,u,d){const _=e-this._width/2,m=t-this._height/2,f=`canvas_${this._id}`;return new h2(n,f+"_"+this._eventId,f,o,_,m,i,r,c,l,u,d)}bufferMouseEvent(e,t){!e||!this._eventCache||(this._eventCache.delete(t),this._eventCache.set(t,e))}processMouseEvents(){if(!(!this._container||!this._eventCache)){for(const[e,t]of this._eventCache.entries()){if(!this._eventCache)return;if(!t)continue;const i=this._container.getRoomObject(parseInt(e));if(i)if(this._mouseListener)this._mouseListener.processRoomCanvasMouseEvent(t,i,this._geometry);else{const r=i.mouseHandler;r&&r.mouseEvent(t,this._geometry)}}this._eventCache&&this._eventCache.clear()}}getDisplayAsTexture(){this._noSpriteVisibilityChecking=!0;const e=this._scale,t=this._screenOffsetX,i=this._screenOffsetY;this.setScale(1,null,null,!0),this._screenOffsetX=0,this._screenOffsetY=0,this.render(-1,!0),this._display.mask=null;const r=this._display.getBounds(),n=Ka.create({width:this._display.width,height:this._display.height});return di.instance.renderer.render(this._display,{renderTexture:n,clear:!0,transform:new qr(1,0,0,1,-r.x,-r.y)}),this._display.mask=this._mask,this._noSpriteVisibilityChecking=!1,this.setScale(e,null,null,!0),this._screenOffsetX=t,this._screenOffsetY=i,n}doMagic(){const e=this.geometry;if(this._rotation!==0){let t=this._effectDirection;e.direction=new Y(t.x+this._rotation,t.y,t.z),t=e.direction,e.setDepthVector(new Y(t.x,t.y,5));const i=new Y;i.assign(this._rotationOrigin),i.x=i.x+this._rotationRodLength*Math.cos((t.x+180)/180*3.14159265358979)*Math.cos(t.y/180*3.14159265358979),i.y=i.y+this._rotationRodLength*Math.sin((t.x+180)/180*3.14159265358979)*Math.cos(t.y/180*3.14159265358979),i.z=i.z+this._rotationRodLength*Math.sin(t.y/180*3.14159265358979),e.location=i,this._effectLocation=new Y,this._effectLocation.assign(i),this._effectDirection=new Y,this._effectDirection.assign(e.direction)}if(Md.isVisualizationOn()&&!this._SafeStr_4507?this.changeShaking():!Md.isVisualizationOn()&&this._SafeStr_4507&&this.changeShaking(),ZS.isVisualizationOn()&&this.changeRotation(),this._SafeStr_4507){this._SafeStr_795++;const t=this._effectDirection,i=Y.sum(t,new Y(Math.sin(this._SafeStr_795*5/180*3.14159265358979)*2,Math.sin(this._SafeStr_795/180*3.14159265358979)*5,Math.sin(this._SafeStr_795*10/180*3.14159265358979)*2));e.direction=i}else this._SafeStr_795=0,e.direction=this._effectDirection}changeShaking(){if(this._SafeStr_4507=!this._SafeStr_4507,this._SafeStr_4507){const e=this.geometry.direction;this._effectDirection=new Y(e.x,e.y,e.z)}}changeRotation(){if(this._SafeStr_4507)return;const e=this.geometry;if(e){if(this._rotation===0){const t=e.location,i=e.directionAxis;this._effectLocation=new Y,this._effectLocation.assign(t),this._effectDirection=new Y,this._effectDirection.assign(e.direction);const r=Cc.getIntersectionVector(t,i,new Y(0,0,0),new Y(0,0,1));r!==null&&(this._rotationOrigin=new Y(r.x,r.y,r.z),this._rotationRodLength=Y.dif(r,t).length,this._rotation=1);return}this._rotation=0,e.location=this._effectLocation,e.direction=this._effectDirection,e.setDepthVector(new Y(this._effectDirection.x,this._effectDirection.y,5))}}moveLeft(){if(this._rotation!==0){this._rotation===1?this._rotation=-1:this._rotation=this._rotation-1;return}const e=this.geometry,t=(e.direction.x-90)/180*3.14159265358979;e.location=Y.sum(e.location,new Y(Math.cos(t)*Math.sqrt(2),Math.sin(t)*Math.sqrt(2)))}moveRight(){if(this._rotation!==0){this._rotation===-1?this._rotation=1:this._rotation=this._rotation+1;return}const e=this.geometry,t=(e.direction.x+90)/180*3.14159265358979;e.location=Y.sum(e.location,new Y(Math.cos(t)*Math.sqrt(2),Math.sin(t)*Math.sqrt(2)))}moveUp(){if(this._rotation!==0)return;const e=this.geometry,t=e.direction.x/180*3.14159265358979;e.location=Y.sum(e.location,new Y(Math.cos(t)*Math.sqrt(2),Math.sin(t)*Math.sqrt(2)))}moveDown(){if(this._rotation!==0)return;const e=this.geometry,t=(e.direction.x+180)/180*3.14159265358979;e.location=Y.sum(e.location,new Y(Math.cos(t)*Math.sqrt(2),Math.sin(t)*Math.sqrt(2)))}get id(){return this._id}get geometry(){return this._geometry}get master(){return this._master}get display(){return this._display}get screenOffsetX(){return this._screenOffsetX}set screenOffsetX(e){e=Math.trunc(e),this._mouseLocation.x=this._mouseLocation.x-(e-this._screenOffsetX),this._screenOffsetX=e}get screenOffsetY(){return this._screenOffsetY}set screenOffsetY(e){e=Math.trunc(e),this._mouseLocation.y=this._mouseLocation.y-(e-this._screenOffsetY),this._screenOffsetY=e}get scale(){return this._scale}get width(){return this._width*this._scale}get height(){return this._height*this._scale}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(e){this._restrictsScaling=e}get canvasUpdated(){return this._canvasUpdated}set canvasUpdated(e){this._canvasUpdated=e}}class j2{constructor(){this._objects=new Map,this._canvases=new Map,this._disposed=!1,this._roomObjectVariableAccurateZ=null}dispose(){if(!this._disposed){if(this._canvases){for(const[e,t]of this._canvases.entries())this._canvases.delete(e),t&&t.dispose();this._canvases=null}this._objects&&(this._objects=null),this._disposed=!0}}reset(){this._objects.clear()}getInstanceId(e){return e?e.instanceId:-1}getRoomObject(e){return this._objects.get(e)}addObject(e){e&&this._objects.set(this.getInstanceId(e),e)}removeObject(e){const t=this.getInstanceId(e);this._objects.delete(t);for(const i of this._canvases.values()){if(!i)continue;i.removeFromCache(t.toString())}}render(e,t=!1){if(!(!this._canvases||!this._canvases.size))for(const i of this._canvases.values())i&&i.render(e,t)}update(e,t=!1){if(!(!this._canvases||!this._canvases.size)){this.render(e,t);for(const i of this._canvases.values())i&&i.update()}}getCanvas(e){const t=this._canvases.get(e);return t||null}createCanvas(e,t,i,r){const n=this._canvases.get(e);if(n)return n.initialize(t,i),n.geometry&&(n.geometry.scale=r),n;const o=this.createSpriteCanvas(e,t,i,r);if(o)return this._canvases.set(e,o),o}createSpriteCanvas(e,t,i,r){return new M2(this,e,t,i,r)}removeCanvas(e){const t=this._canvases.get(e);t&&(this._canvases.delete(e),t.dispose())}get objects(){return this._objects}get disposed(){return this._disposed}get roomObjectVariableAccurateZ(){return this._roomObjectVariableAccurateZ}set roomObjectVariableAccurateZ(e){this._roomObjectVariableAccurateZ=e}}class L2{createRenderer(){return new j2}}class P2 extends Qr{constructor(e,t){super(),this._id=e,this._container=t,this._renderer=null,this._managers=new Map,this._updateCategories=[],this._model=new sD}onDispose(){this.removeAllManagers(),this.destroyRenderer(),this._container=null,this._model.dispose()}setRenderer(e){if(e!==this._renderer&&(this._renderer&&this.destroyRenderer(),this._renderer=e,!!this._renderer&&(this._renderer.reset(),this._managers.size)))for(const t of this._managers.values()){if(!t)continue;const i=t.objects;if(i.length)for(const r of i.getValues())r&&this._renderer.addObject(r)}}destroyRenderer(){this._renderer&&(this._renderer.dispose(),this._renderer=null)}getManager(e){const t=this._managers.get(e);return t||null}getManagerOrCreate(e){let t=this.getManager(e);return t||(t=this._container.createRoomObjectManager(e),t?(this._managers.set(e,t),t):null)}getTotalObjectsForManager(e){const t=this.getManager(e);return t?t.totalObjects:0}getRoomObject(e,t){const i=this.getManager(t);if(!i)return null;const r=i.getObject(e);return r||null}getRoomObjectsForCategory(e){const t=this.getManager(e);return t?t.objects.getValues():[]}getRoomObjectByIndex(e,t){const i=this.getManager(t);if(!i)return null;const r=i.getObjectByIndex(e);return r||null}createRoomObject(e,t,i,r){const n=this.getManagerOrCreate(r);if(!n)return null;const o=n.createObject(e,t,i);return o?(this._renderer&&this._renderer.addObject(o),o):null}createRoomObjectAndInitalize(e,t,i){return this._container?this._container.createRoomObjectAndInitalize(this._id,e,t,i):null}removeRoomObject(e,t){const i=this.getManager(t);if(!i)return;const r=i.getObject(e);r&&(r.tearDown(),this._renderer&&this._renderer.removeObject(r),i.removeObject(e))}removeAllManagers(){for(const e of this._managers.values())if(e){if(this._renderer){const t=e.objects;if(t.length)for(const i of t.getValues())i&&this._renderer.removeObject(i)}e.dispose()}this._managers.clear()}addUpdateCategory(e){this._updateCategories.indexOf(e)>=0||this._updateCategories.push(e)}removeUpdateCategory(e){const t=this._updateCategories.indexOf(e);t!==-1&&this._updateCategories.splice(t,1)}update(e,t=!1){for(const i of this._updateCategories){const r=this.getManager(i);if(!r)continue;const n=r.objects;if(n.length)for(const o of n.getValues()){if(!o)continue;const l=o.logic;l&&l.update(e)}}this._renderer&&this._renderer.update(e,t)}hasUninitializedObjects(){for(const e of this._managers.values())if(e){for(const t of e.objects.getValues())if(t&&!t.isReady)return!0}return!1}get id(){return this._id}get container(){return this._container}get renderer(){return this._renderer}get managers(){return this._managers}get model(){return this._model}}const w_=class w_{constructor(e,t,i,r,n,o,l){this._layerTags=[],this._primaryColor=e&16777215,this._secondaryColor=t&16777215,this._breed=i,this._tag=r>-1&&r<w_.COLOR_TAGS.length?w_.COLOR_TAGS[r]:"",this._id=n,this._isMaster=o,this._layerTags=l}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}get breed(){return this._breed}get tag(){return this._tag}get id(){return this._id}get isMaster(){return this._isMaster}get layerTags(){return this._layerTags}};w_.COLOR_TAGS=["Null","Black","White","Grey","Red","Orange","Pink","Green","Lime","Blue","Light-Blue","Dark-Blue","Yellow","Brown","Dark-Brown","Beige","Cyan","Purple","Gold"];let tR=w_;const Jt=class Jt{constructor(){this._stateEvents=null,this._sessionDataManager=null,this._waitingForSessionDataManager=!1,this._iconListener=null,this._collections=new Map,this._gifCollections=new Map,this._images=new Map,this._events=new Map,this._activeObjects={},this._activeObjectTypes=new Map,this._activeObjectTypeIds=new Map,this._objectTypeAdUrls=new Map,this._wallItems={},this._wallItemTypes=new Map,this._wallItemTypeIds=new Map,this._furniRevisions=new Map,this._pets={},this._petColors=new Map,this._objectAliases=new Map,this._objectOriginalNames=new Map,this._pendingContentTypes=[],this._dataInitialized=!1}initialize(e){this._stateEvents=e,this.setFurnitureData();for(const[t,i]of st.getValue("pet.types").entries())this._pets[i]=t}dispose(){}setSessionDataManager(e){this._sessionDataManager=e,this._waitingForSessionDataManager&&(this._waitingForSessionDataManager=!1,this.setFurnitureData())}loadFurnitureData(){this.setFurnitureData()}setFurnitureData(){if(!this._sessionDataManager){this._waitingForSessionDataManager=!0;return}const e=this._sessionDataManager.getAllFurnitureData(this);e&&(this._sessionDataManager.removePendingFurniDataListener(this),this.processFurnitureData(e),this._stateEvents.dispatchEvent(new _t(Jt.LOADER_READY)))}processFurnitureData(e){if(e)for(const t of e){if(!t)continue;const i=t.id;let r=t.className;t.hasIndexedColor&&(r=r+"*"+t.colorIndex);const n=t.revision,o=t.adUrl;o&&o.length>0&&this._objectTypeAdUrls.set(r,o);let l=t.className;t.type===Du.FLOOR?(this._activeObjectTypes.set(i,r),this._activeObjectTypeIds.set(r,i),this._activeObjects[l]||(this._activeObjects[l]=1)):t.type===Du.WALL&&(l==="post.it"&&(r="post_it",l="post_it"),l==="post.it.vd"&&(r="post_it_vd",l="post_id_vd"),this._wallItemTypes.set(i,r),this._wallItemTypeIds.set(r,i),this._wallItems[l]||(this._wallItems[l]=1));const c=this._furniRevisions.get(l);n>c&&(this._furniRevisions.delete(l),this._furniRevisions.set(l,n))}}getFurnitureFloorNameForTypeId(e){const t=this._activeObjectTypes.get(e);return this.removeColorIndex(t)}getFurnitureWallNameForTypeId(e,t=null){let i=this._wallItemTypes.get(e);return i==="poster"&&t!==null&&(i=i+t),this.removeColorIndex(i)}getFurnitureFloorColorIndex(e){const t=this._activeObjectTypes.get(e);return t?this.getColorIndexFromName(t):-1}getFurnitureWallColorIndex(e){const t=this._wallItemTypes.get(e);return t?this.getColorIndexFromName(t):-1}getColorIndexFromName(e){if(!e)return-1;const t=e.indexOf("*");return t===-1?0:parseInt(e.substr(t+1))}removeColorIndex(e){if(!e)return null;const t=e.indexOf("*");return t===-1?e:e.substr(0,t)}getRoomObjectAdUrl(e){const t=this._objectTypeAdUrls.get(e);return t||""}getPetColorResult(e,t){const i=this._petColors.get(e);return i?i.get(t):null}getPetColorResultsForTag(e,t){const i=this._petColors.get(e),r=[];if(i)for(const n of i.values())n.tag===t&&r.push(n);return r}getCollection(e){if(!e)return null;const t=this._collections.get(e);if(!t){const i=vr().getCollection(e);return i?(this._collections.set(e,i),i):null}return t}getGifCollection(e){return e&&this._gifCollections.get(e)||null}getImage(e){if(!e)return null;const t=this._images.get(e);if(!t)return null;const i=new Image;return i.src=t.src,i}addAssetToCollection(e,t,i,r=!0){const n=this.getCollection(e);return n?n.addAsset(t,i,r,0,0,!1,!1):!1}createGifCollection(e,t,i){if(!e||!t||!i)return null;const r=new ZV(e,t,i);return this._gifCollections.set(e,r),r}createCollection(e,t){if(!e||!t)return null;const i=new uf(e,t);this._collections.set(i.name,i);const r=this._pets[i.name];if(r!==void 0){const n=i.getPaletteNames(),o=new Map;for(const l of n){const c=i.getPalette(l),u=e.palettes[l],d=c.primaryColor,_=c.secondaryColor,m=u.breed!==void 0?u.breed:0,f=u.colorTag!==void 0?u.colorTag:-1,E=u.master!==void 0?u.master:!1,I=u.tags!==void 0?u.tags:[];o.set(parseInt(l),new tR(d,_,m,f,l,E,I))}this._petColors.set(r,o)}}getPlaceholderName(e){switch(this.getCategoryForType(e)){case Q.FLOOR:return Jt.PLACE_HOLDER;case Q.WALL:return Jt.PLACE_HOLDER_WALL;default:return this._pets[e]!==void 0?Jt.PLACE_HOLDER_PET:Jt.PLACE_HOLDER_DEFAULT}}getCategoryForType(e){return e?this._activeObjects[e]!==void 0?Q.FLOOR:this._wallItems[e]!==void 0?Q.WALL:this._pets[e]!==void 0?Q.UNIT:e.indexOf("poster")===0?Q.WALL:e==="room"?Q.ROOM:e===Ft.USER||e===Ft.PET||e===Ft.BOT||e===Ft.RENTABLE_BOT?Q.UNIT:e===Jt.TILE_CURSOR||e===Jt.SELECTION_ARROW?Q.CURSOR:Q.MINIMUM:Q.MINIMUM}getPetNameForType(e){return st.getValue("pet.types")[e]||null}isLoaderType(e){return e=Ft.getRealType(e),e!==Ue.USER}downloadImage(e,t,i,r=null){let n=null,o=[];if(t&&t.indexOf(",")>=0&&(n=t,t=n.split(",")[0]),n?o=this.getAssetUrls(n,i,!0):o=this.getAssetUrls(t,i,!0),o&&o.length){const l=o[0],c=new Image;return c.src=l,c.onload=()=>{c.onerror=null,this._images.set([t,i].join("_"),c),this._iconListener.onRoomContentLoaded(e,[t,i].join("_"),!0)},c.onerror=()=>{c.onload=null,ze.error("Failed to download asset",l),this._iconListener.onRoomContentLoaded(e,[t,i].join("_"),!1)},!0}return!1}async downloadAsset(e,t){var r;const i=(r=this.getAssetUrls(e))==null?void 0:r[0];if(!(!i||!i.length)&&!(this._pendingContentTypes.indexOf(e)>=0||this.getOrRemoveEventDispatcher(e))){this._pendingContentTypes.push(e),this._events.set(e,t);try{const n=await fetch(i);let o="application/octet-stream";switch(n.headers.has("Content-Type")&&(o=n.headers.get("Content-Type")),o){case"application/octet-stream":{const l=new lf(await n.arrayBuffer());await this.processAsset(l.baseTexture,l.jsonFile);const c=this._events.get(e);if(!c)return;c.dispatchEvent(new Il(Il.RCLE_SUCCESS,e));break}default:throw new Error}}catch{t.dispatchEvent(new Il(Il.RCLE_FAILURE,e))}}}async processAsset(e,t){const i=t.spritesheet;if(!e||!i||!Object.keys(i).length){this.createCollection(t,null);return}const r=async()=>{const n=new Fy(e,i);await n.parse(),this.createCollection(t,n)};e.valid?await r():await new Promise((n,o)=>{e.once("update",async()=>(await r(),n()))})}setAssetAliasName(e,t){this._objectAliases.set(e,t),this._objectOriginalNames.set(t,e)}getAssetAliasName(e){const t=this._objectAliases.get(e);return t||e}getAssetOriginalName(e){const t=this._objectOriginalNames.get(e);return t||e}getAssetUrls(e,t=null,i=!1){switch(e){case Jt.PLACE_HOLDER:return[this.getAssetUrlWithGenericBase(Jt.PLACE_HOLDER)];case Jt.PLACE_HOLDER_WALL:return[this.getAssetUrlWithGenericBase(Jt.PLACE_HOLDER_WALL)];case Jt.PLACE_HOLDER_PET:return[this.getAssetUrlWithGenericBase(Jt.PLACE_HOLDER_PET)];case Jt.ROOM:return[this.getAssetUrlWithGenericBase("room")];case Jt.TILE_CURSOR:return[this.getAssetUrlWithGenericBase(Jt.TILE_CURSOR)];case Jt.SELECTION_ARROW:return[this.getAssetUrlWithGenericBase(Jt.SELECTION_ARROW)];default:{const r=this.getCategoryForType(e);if(r===Q.FLOOR||r===Q.WALL){const n=this.getAssetAliasName(e);let o=i?this.getAssetUrlWithFurniIconBase(n):this.getAssetUrlWithFurniBase(e);if(i){const l=t&&t!==""&&this._activeObjectTypeIds.has(n+"*"+t);o=o.replace(/%param%/gi,l?"_"+t:"")}return[o]}return r===Q.UNIT?[this.getAssetUrlWithPetBase(e)]:null}}}getAssetIconUrl(e,t){let i=null,r=[];return e&&e.indexOf(",")>=0&&(i=e,e=i.split(",")[0]),i?r=this.getAssetUrls(i,t,!0):r=this.getAssetUrls(e,t,!0),r&&r.length?r[0]:null}getAssetUrlWithGenericBase(e){return st.getValue("generic.asset.url").replace(/%libname%/gi,e)}getAssetUrlWithFurniBase(e){return st.getValue("furni.asset.url").replace(/%libname%/gi,e)}getAssetUrlWithFurniIconBase(e){return st.getValue("furni.asset.icon.url").replace(/%libname%/gi,e)}getAssetUrlWithPetBase(e){return st.getValue("pet.asset.url").replace(/%libname%/gi,e)}setRoomObjectRoomId(e,t){const i=e&&e.model;i&&i.setValue(D.OBJECT_ROOM_ID,t)}getOrRemoveEventDispatcher(e,t=!1){const i=this._events.get(e);return t&&this._events.delete(e),i}setIconListener(e){this._iconListener=e}};Jt.PLACE_HOLDER="place_holder",Jt.PLACE_HOLDER_WALL="place_holder_wall",Jt.PLACE_HOLDER_PET="place_holder_pet",Jt.PLACE_HOLDER_DEFAULT=Jt.PLACE_HOLDER,Jt.ROOM="room",Jt.TILE_CURSOR="tile_cursor",Jt.SELECTION_ARROW="selection_arrow",Jt.LOADER_READY="RCL_LOADER_READY",Jt.MANDATORY_LIBRARIES=[Jt.PLACE_HOLDER,Jt.PLACE_HOLDER_WALL,Jt.PLACE_HOLDER_PET,Jt.ROOM,Jt.TILE_CURSOR,Jt.SELECTION_ARROW];let Id=Jt;class U2{constructor(){this._objects=new Ms,this._objectsPerType=new Ms}dispose(){this.removeAllObjects()}getObject(e){const t=this._objects.getValue(e);return t||null}getObjectByIndex(e){const t=this._objects.getWithIndex(e);return t||null}createObject(e,t,i){const r=new QS(e,t,i);return this.addObject(e,i,r)}addObject(e,t,i){if(this._objects.getValue(e))return i.dispose(),null;this._objects.add(e,i);const r=this.getTypeMap(t);return r&&r.add(e,i),i}removeObject(e){const t=this._objects.remove(e);if(t){const i=this.getTypeMap(t.type);i&&i.remove(t.id),t.dispose()}}removeAllObjects(){let e=0;for(;e<this._objects.length;){const t=this._objects.getWithIndex(e);t&&t.dispose(),e++}for(this._objects.reset(),e=0;e<this._objectsPerType.length;){const t=this._objectsPerType.getWithIndex(e);t&&t.dispose(),e++}this._objectsPerType.reset()}getTypeMap(e,t=!0){let i=this._objectsPerType.getValue(e);return!i&&t&&(i=new Ms,this._objectsPerType.add(e,i)),i}get objects(){return this._objects}get totalObjects(){return this._objects.length}}const Fr=class Fr extends Wo{constructor(e,t,i){super(),this._state=Fr.ROOM_MANAGER_LOADED,this._rooms=new Map,this._contentLoader=null,this._updateCategories=[],this._listener=e,this._visualizationFactory=t,this._logicFactory=i,this._initialLoadList=[],this._pendingContentTypes=[],this._skipContentProcessing=!1,this._disposed=!1,this.onRoomContentLoadedEvent=this.onRoomContentLoadedEvent.bind(this),this.events.addEventListener(Il.RCLE_SUCCESS,this.onRoomContentLoadedEvent),this.events.addEventListener(Il.RCLE_FAILURE,this.onRoomContentLoadedEvent),this.events.addEventListener(Il.RCLE_CANCEL,this.onRoomContentLoadedEvent)}onInit(){if(this._state>=Fr.ROOM_MANAGER_INITIALIZING||!this._contentLoader)return;const e=Id.MANDATORY_LIBRARIES;for(const t of e)t&&this._initialLoadList.indexOf(t)===-1&&(this._contentLoader.downloadAsset(t,this.events),this._initialLoadList.push(t));this._state=Fr.ROOM_MANAGER_INITIALIZING}getRoomInstance(e){const t=this._rooms.get(e);return t||null}createRoomInstance(e){if(this._rooms.get(e))return null;const t=new P2(e,this);if(this._rooms.set(t.id,t),this._updateCategories.length)for(const i of this._updateCategories)t.addUpdateCategory(i);return t}removeRoomInstance(e){const t=this._rooms.get(e);return t?(this._rooms.delete(e),t.dispose(),!0):!1}createRoomObjectAndInitalize(e,t,i,r){try{const n=this.getRoomInstance(e);if(!n)return null;let o=i,l=i,c=i,u=null,d=!1;if(this._contentLoader.isLoaderType(i)){if(u=this._contentLoader.getCollection(i),!u&&(d=!0,this._contentLoader.downloadAsset(i,this.events),c=this._contentLoader.getPlaceholderName(i),u=this._contentLoader.getCollection(c),!u))return null;o=u.data.visualizationType,l=u.data.logicType}const _=n.createRoomObject(t,1,i,r);if(!_)return null;if(this._visualizationFactory){const m=this._visualizationFactory.getVisualization(o);if(!m)return n.removeRoomObject(t,r),null;m.asset=u;const f=this._visualizationFactory.getVisualizationData(c,o,u&&u.data||null);if(!f||!m.initialize(f))return n.removeRoomObject(t,r),null;_.setVisualization(m)}if(this._logicFactory){const m=this._logicFactory.getLogic(l);_.setLogic(m),m&&m.initialize(u&&u.data||null)}return d||(_.isReady=!0),this._contentLoader.setRoomObjectRoomId(_,e),_}catch{return null}}reinitializeRoomObjectsByType(e){if(!e||!this._contentLoader||!this._visualizationFactory||!this._logicFactory)return;const t=this._contentLoader.getCollection(e);if(!t)return;const i=t.data.visualizationType,r=t.data.logicType,n=this._visualizationFactory.getVisualizationData(e,i,t.data);for(const o of this._rooms.values())if(o){for(const[l,c]of o.managers.entries())if(c)for(const u of c.objects.getValues()){if(!u||u.type!==e)continue;const d=this._visualizationFactory.getVisualization(i);if(d)if(d.asset=t,!n||!d.initialize(n))c.removeObject(u.id);else{u.setVisualization(d);const _=this._logicFactory.getLogic(r);u.setLogic(_),_&&_.initialize(t.data),u.isReady=!0,this._listener&&this._listener.objectInitialized(o.id,u.id,l)}else c.removeObject(u.id)}}}addUpdateCategory(e){if(!(this._updateCategories.indexOf(e)>=0)&&(this._updateCategories.push(e),!!this._rooms.size))for(const i of this._rooms.values())i&&i.addUpdateCategory(e)}removeUpdateCategory(e){const t=this._updateCategories.indexOf(e);if(t!==-1&&(this._updateCategories.splice(t,1),!!this._rooms.size))for(const i of this._rooms.values())i&&i.removeUpdateCategory(e)}setContentLoader(e){this._contentLoader&&this._contentLoader.dispose(),this._contentLoader=e}processPendingContentTypes(e){if(this._skipContentProcessing){this._skipContentProcessing=!1;return}for(;this._pendingContentTypes.length;){const t=this._pendingContentTypes.shift();if(!this._contentLoader.getCollection(t)){this._listener&&this._listener.initalizeTemporaryObjectsByType(t,!1),ze.log("Invalid Collection",t);continue}this.reinitializeRoomObjectsByType(t),this._listener&&this._listener.initalizeTemporaryObjectsByType(t,!0),this._initialLoadList.length>0&&this.removeFromInitialLoad(t)}}removeFromInitialLoad(e){if(!(!e||this._state===Fr.ROOM_MANAGER_ERROR))if(this._contentLoader||(this._state=Fr.ROOM_MANAGER_ERROR),this._contentLoader.getCollection(e)){const t=this._initialLoadList.indexOf(e);t>=0&&this._initialLoadList.splice(t,1),this._initialLoadList.length||(this._state=Fr.ROOM_MANAGER_INITIALIZED,this._listener&&this._listener.onRoomEngineInitalized(!0))}else this._state=Fr.ROOM_MANAGER_ERROR,this._listener&&this._listener.onRoomEngineInitalized(!1)}onRoomContentLoadedEvent(e){if(!this._contentLoader)return;const t=e.contentType;this._pendingContentTypes.indexOf(t)>=0||this._pendingContentTypes.push(t)}update(e,t=!1){if(this.processPendingContentTypes(e),!!this._rooms.size)for(const i of this._rooms.values())i&&i.update(e,t)}createRoomObjectManager(e){return new U2}get rooms(){return this._rooms}get disposed(){return this._disposed}};Fr.ROOM_MANAGER_ERROR=-1,Fr.ROOM_MANAGER_LOADING=0,Fr.ROOM_MANAGER_LOADED=1,Fr.ROOM_MANAGER_INITIALIZING=2,Fr.ROOM_MANAGER_INITIALIZED=3,Fr.CONTENT_PROCESSING_TIME_LIMIT_MILLISECONDS=40;let sR=Fr;class w2{constructor(e,t=-1,i=null,r=null,n=null){this._minLevel=-1,this._texture=null,this._colorMatrix=null,this._blendMode=null,this._name=e,this._minLevel=t,this._texture=i,this._colorMatrix=r,this._blendMode=n}get name(){return this._name}get texture(){return this._texture}set texture(e){this._texture=e}get colorMatrix(){return this._colorMatrix}set colorMatrix(e){this._colorMatrix=e}get blendMode(){return this._blendMode}set blendMode(e){this._blendMode=e}get minLevel(){return this._minLevel}}class F2{constructor(){this._effects=new Map,this._events=new Sn,this._isLoaded=!1}get effects(){return this._effects}get events(){return this._events}get isLoaded(){return this._isLoaded}init(){if(this._isLoaded)return;this._isLoaded=!0;const e=st.getValue("image.library.url")+"Habbo-Stories/",t=st.getValue("camera.available.effects");for(const i of t){if(!i.enabled)continue;const r=new w2(i.name,i.minLevel);i.colorMatrix.length?r.colorMatrix=i.colorMatrix:(r.texture=Qs.from(e+i.name+".png"),r.blendMode=i.blendMode),this._effects.set(r.name,r)}this.events.dispatchEvent(new bg(bg.INITIALIZED))}applyEffects(e,t,i){const r=new kn,n=new Is(e);r.addChild(n),i&&n.scale.set(2);for(const o of t){const l=o.effect;if(l)if(l.colorMatrix){const c=new Gu;c.matrix=l.colorMatrix,c.alpha=o.alpha,n.filters||(n.filters=[]),n.filters.push(c)}else{const c=new Is(l.texture);c.alpha=o.alpha,c.blendMode=l.blendMode,r.addChild(c)}}return Vt.generateImage(r)}}class YT{constructor(e,t){this._effect=e,this._alpha=t}get effect(){return this._effect}get alpha(){return this._alpha}}class k2{flush(){return this._canShowInterstitial=!1,!0}parse(e){return e?(this._canShowInterstitial=e.readBoolean(),!0):!1}get canShowInterstitial(){return this._canShowInterstitial}}class G2{flush(){return this._errorCode=0,this._filteredText=null,!0}parse(e){return e?(this._errorCode=e.readInt(),this._filteredText=e.readString(),!0):!1}get errorCode(){return this._errorCode}get filteredText(){return this._filteredText}}class B2{flush(){return this._isOpen=!1,this._onShutdown=!1,this._isAuthenticUser=!1,!0}parse(e){return e?(this._isOpen=e.readBoolean(),this._onShutdown=e.readBoolean(),e.bytesAvailable&&(this._isAuthenticUser=e.readBoolean()),!0):!1}get isOpen(){return this._isOpen}get onShutdown(){return this._onShutdown}get isAuthenticUser(){return this._isAuthenticUser}}class V2{flush(){return this._isOpen=!1,this._minutesUntilChange=0,!0}parse(e){return e?(this._isOpen=e.readInt()>0,this._minutesUntilChange=e.readInt(),!0):!1}get isOpen(){return this._isOpen}get minutesUntilChange(){return this._minutesUntilChange}}class H2{flush(){return this._openHour=0,this._openMinute=0,!0}parse(e){return e?(this._openHour=e.readInt(),this._openMinute=e.readInt(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}}class W2{flush(){return this._openHour=0,this._openMinute=0,this._userThrownOutAtClose=!1,!0}parse(e){return e?(this._openHour=e.readInt(),this._openMinute=e.readInt(),this._userThrownOutAtClose=e.readBoolean(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}get userThrowOutAtClose(){return this._userThrownOutAtClose}}class Y2{flush(){return this._minutes=0,!0}parse(e){return e?(this._minutes=e.readInt(),!0):!1}get openMinute(){return this._minutes}}class z2{flush(){return this._isInMaintenance=!1,this._minutesUntilMaintenance=0,this._duration=15,!0}parse(e){return e?(this._isInMaintenance=e.readBoolean(),this._minutesUntilMaintenance=e.readInt(),e.bytesAvailable&&(this._duration=e.readInt()),!0):!1}get isInMaintenance(){return this._isInMaintenance}get minutesUntilMaintenance(){return this._minutesUntilMaintenance}get duration(){return this._duration}}class K2{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(e){if(!e)return!1;this._resultCode=e.readInt(),this._name=e.readString();let t=e.readInt();for(;t>0;)this._nameSuggestions.push(e.readString()),t--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class q2{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(e){if(!e)return!1;this._resultCode=e.readInt(),this._name=e.readString();let t=e.readInt();for(;t>0;)this._nameSuggestions.push(e.readString()),t--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class X2{flush(){return this._figure="",this._gender="",!0}parse(e){return e?(this._figure=e.readString(),this._gender=e.readString(),this._gender&&(this._gender=this._gender.toUpperCase()),!0):!1}get figure(){return this._figure}get gender(){return this._gender}}class $2{constructor(e){this._slotId=e.readInt(),this._figureString=e.readString(),this._gender=e.readString()}get slotId(){return this._slotId}get figureString(){return this._figureString}get gender(){return this._gender}}class Q2{flush(){return this._state=0,this._outfits=[],!0}parse(e){if(!e)return!1;this._state=e.readInt();let t=e.readInt();for(;t>0;)this._outfits.push(new $2(e)),t--;return!0}get state(){return this._state}get outfits(){return this._outfits}}class rC{constructor(e){if(!e)throw new Error("invalid_parser");this._id=e.readInt(),this._name=e.readString(),this._motto=e.readString(),this._gender=e.readString(),this._figure=e.readString()}get id(){return this._id}get name(){return this._name}get motto(){return this._motto}get figure(){return this._figure}get gender(){return this._gender}}class J2{flush(){return this._item=null,this._openInventory=!1,!0}parse(e){return e?(this._item=new rC(e),this._openInventory=e.readBoolean(),!0):!1}get item(){return this._item}openInventory(){return this._openInventory}}class Z2{flush(){return this._items=null,!0}parse(e){this._items=new Map;let t=e.readInt();for(;t>0;){const i=new rC(e);this._items.set(i.id,i),t--}return!0}get items(){return this._items}}class eH{flush(){return this._boughtAsGift=!1,this._item=null,!0}parse(e){return e?(this._boughtAsGift=e.readBoolean(),this._item=new rC(e),!0):!1}get boughtAsGift(){return this._boughtAsGift}get item(){return this._item}}class tH{flush(){return this._itemId=0,!0}parse(e){return e?(this._itemId=e.readInt(),!0):!1}get itemId(){return this._itemId}}class sH{constructor(e){this._name=e.readString(),this._id=e.readInt(),this._consequence=e.readString()}get name(){return this._name}get id(){return this._id}get consequence(){return this._consequence}}class iH{constructor(e){this._topics=[],this._name=e.readString();let t=e.readInt();for(;t>0;)this._topics.push(new sH(e)),t--}dispose(){this._disposed||(this._disposed=!0,this._topics=null)}get disposed(){return this._disposed}get name(){return this._name}get topics(){return this._topics}}class rH{constructor(e){this._tradeLockInfo="",this._machineBanInfo="",this._name=e.readString(),this._sanctionLengthInHours=e.readInt(),this._probationDays=e.readInt(),this._avatarOnly=e.readBoolean(),e.bytesAvailable&&(this._tradeLockInfo=e.readString()),e.bytesAvailable&&(this._machineBanInfo=e.readString())}get name(){return this._name}get sanctionLengthInHours(){return this._sanctionLengthInHours}get avatarOnly(){return this._avatarOnly}get tradeLockInfo(){return this._tradeLockInfo}get machineBanInfo(){return this._machineBanInfo}}class nH{flush(){return this._issueId=-1,this._accountId=1,this._sanctionType=null,!0}parse(e){return e?(this._issueId=e.readInt(),this._accountId=e.readInt(),this._sanctionType=new rH(e),!0):!1}get issueId(){return this._issueId}get accountId(){return this._accountId}get sanctionType(){return this._sanctionType}}class aH{flush(){return this._callForHelpCategories=null,!0}parse(e){if(!e)return!1;this._callForHelpCategories=[];let t=e.readInt();for(;t>0;)this._callForHelpCategories.push(new iH(e)),t--;return!0}get callForHelpCategories(){return this._callForHelpCategories}}class oH{flush(){return this._isSanctionNew=!1,this._isSanctionActive=!1,this._sanctionName=null,this._sanctionLengthHours=0,this._sanctionReason=null,this._sanctionCreationTime=null,this._probationHoursLeft=0,this._nextSanctionName=null,this._nextSanctionLengthHours=0,this._hasCustomMute=!1,this._tradeLockExpiryTime=null,!0}parse(e){return e?(this._isSanctionNew=e.readBoolean(),this._isSanctionActive=e.readBoolean(),this._sanctionName=e.readString(),this._sanctionLengthHours=e.readInt(),e.readInt(),this._sanctionReason=e.readString(),this._sanctionCreationTime=e.readString(),this._probationHoursLeft=e.readInt(),this._nextSanctionName=e.readString(),this._nextSanctionLengthHours=e.readInt(),e.readInt(),this._hasCustomMute=e.readBoolean(),e.bytesAvailable&&(this._tradeLockExpiryTime=e.readString()),!0):!1}get isSanctionNew(){return this._isSanctionNew}get isSanctionActive(){return this._isSanctionActive}get sanctionName(){return this._sanctionName}get sanctionLengthHours(){return this._sanctionLengthHours}get sanctionReason(){return this._sanctionReason}get sanctionCreationTime(){return this._sanctionCreationTime}get probationHoursLeft(){return this._probationHoursLeft}get nextSanctionName(){return this._nextSanctionName}get nextSanctionLengthHours(){return this._nextSanctionLengthHours}get hasCustomMute(){return this._hasCustomMute}get tradeLockExpiryTime(){return this._tradeLockExpiryTime}}class lH{constructor(){this._ok=!1,this._secondsToWait=0}flush(){return this._ok=!1,this._secondsToWait=0,this._extraDataId=null,!0}parse(e){return e?(this._ok=e.readBoolean(),this._secondsToWait=e.readInt(),this._ok&&e.bytesAvailable&&(this._extraDataId=e.readString()),!0):!1}get ok(){return this._ok}get secondsToWait(){return this._secondsToWait}get extraDataId(){return this._extraDataId}}class cH{flush(){return!0}parse(e){return!!e}}class uH{flush(){return this._roomType=null,this._roomId=-1,!0}parse(e){return e?(this._roomType=e.readString(),this._roomId=e.readInt(),!0):!1}get roomType(){return this._roomType}get roomId(){return this._roomId}}class hH{flush(){return this._url="",!0}parse(e){return e?(this._url=e.readString(),!0):!1}get url(){return this._url}}class dH{constructor(){this._ok=!1,this._errorReason=null}flush(){return this._ok=!1,this._errorReason=null,!0}parse(e){return e?(this._ok=e.readBoolean(),this._errorReason=e.readString(),!0):!1}get ok(){return this._ok}get errorReason(){return this._errorReason}}class _H{constructor(){this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0}flush(){return this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0,!0}parse(e){return e?(this._creditPrice=e.readInt(),this._ducketPrice=e.readInt(),e.bytesAvailable&&(this._publishDucketPrice=e.readInt()),!0):!1}get creditPrice(){return this._creditPrice}get ducketPrice(){return this._ducketPrice}get publishDucketPrice(){return this._publishDucketPrice}}class gH{constructor(){this._ok=!0,this._renderLimitHit=!1}flush(){return this._ok=!0,this._renderLimitHit=!1,!0}parse(e){return e?(e.bytesAvailable&&(this._ok=e.readBoolean(),this._renderLimitHit=e.readBoolean()),!0):!1}get ok(){return this._ok}get isRenderLimitHit(){return this._renderLimitHit}}class wf{parse(e){if(!e)return!1;this._campaignName=e.readString(),this._campaignImage=e.readString(),this._currentDay=e.readInt(),this._campaignDays=e.readInt(),this._openedDays=[];let t=e.readInt();for(let i=0;i<t;i++)this._openedDays.push(e.readInt());this._missedDays=[],t=e.readInt();for(let i=0;i<t;i++)this._missedDays.push(e.readInt());return!0}clone(){const e=new wf;return e.campaignDays=this._campaignDays,e.campaignImage=this._campaignImage,e.campaignName=this._campaignName,e.currentDay=this._currentDay,e.missedDays=this._missedDays,e.openedDays=this._openedDays,e}get campaignName(){return this._campaignName}set campaignName(e){this._campaignName=e}get campaignImage(){return this._campaignImage}set campaignImage(e){this._campaignImage=e}get currentDay(){return this._currentDay}set currentDay(e){this._currentDay=e}get campaignDays(){return this._campaignDays}set campaignDays(e){this._campaignDays=e}get openedDays(){return this._openedDays}set openedDays(e){this._openedDays=e}get missedDays(){return this._missedDays}set missedDays(e){this._missedDays=e}}class mH{flush(){return this._calendarData=null,this._vipCalendarData=null,!0}parse(e){return e?(this._calendarData=new wf,this._calendarData.parse(e),this._vipCalendarData=new wf,this._vipCalendarData.parse(e),!0):!1}get calendarData(){return this._calendarData}get vipCalendarData(){return this._vipCalendarData}}class fH{flush(){return this._doorOpened=!1,this._productName=null,this._customImage=null,this._furnitureClassName=null,this._day=null,this._vip=!1,!0}parse(e){return e?(this._doorOpened=e.readBoolean(),this._productName=e.readString(),this._customImage=e.readString(),this._furnitureClassName=e.readString(),this._day=e.readInt(),this._vip=e.readBoolean(),!0):!1}get doorOpened(){return this._doorOpened}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}get day(){return this._day}get vip(){return this._vip}}class pH{flush(){return this._day=-1,!0}parse(e){return e?(this._day=e.readInt(),!0):!1}get day(){return this._day}}class EH{flush(){return this._totalCoinsForBonus=-1,this._coinsStillRequiredToBuy=-1,this._productType="",this._productClassId=-1,!0}parse(e){return e?(this._productType=e.readString(),this._productClassId=e.readInt(),this._totalCoinsForBonus=e.readInt(),this._coinsStillRequiredToBuy=e.readInt(),!0):!1}get totalCoinsForBonus(){return this._totalCoinsForBonus}get coinsStillRequiredToBuy(){return this._coinsStillRequiredToBuy}get productType(){return this._productType}get productClassId(){return this._productClassId}}class IH{flush(){return this._furniCount=0,!0}parse(e){return e?(this._furniCount=e.readInt(),!0):!1}get furniCount(){return this._furniCount}}class TH{flush(){return this._secondsLeft=0,this._furniLimit=0,this._maxFurniLimit=0,this._secondsLeftWithGrace=0,!0}parse(e){return e?(this._secondsLeft=e.readInt(),this._furniLimit=e.readInt(),this._maxFurniLimit=e.readInt(),e.bytesAvailable?this._secondsLeftWithGrace=e.readInt():this._secondsLeftWithGrace=this._secondsLeft,!0):!1}get secondsLeft(){return this._secondsLeft}get furniLimit(){return this._furniLimit}get maxFurniLimit(){return this._maxFurniLimit}get secondsLeftWithGrace(){return this._secondsLeftWithGrace}}class SH{constructor(e){this._maxPurchaseSize=e.readInt(),this._bundleSize=e.readInt(),this._bundleDiscountSize=e.readInt(),this._bonusThreshold=e.readInt(),this._additionalBonusDiscountThresholdQuantities=[];let t=e.readInt();for(;t>0;)this._additionalBonusDiscountThresholdQuantities.push(e.readInt()),t--}get maxPurchaseSize(){return this._maxPurchaseSize}get bundleSize(){return this._bundleSize}get bundleDiscountSize(){return this._bundleDiscountSize}get bonusThreshold(){return this._bonusThreshold}get additionalBonusDiscountThresholdQuantities(){return this._additionalBonusDiscountThresholdQuantities}}class RH{flush(){return this._bundleDiscountRuleset=null,!0}parse(e){return e?(this._bundleDiscountRuleset=new SH(e),!0):!1}get bundleDiscountRuleset(){return this._bundleDiscountRuleset}}class nC{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._visible=!1,this._icon=0,this._pageId=-1,this._pageName=null,this._localization=null,this._children=[],this._offerIds=[],!0}parse(e){if(!e)return!1;this._visible=e.readBoolean(),this._icon=e.readInt(),this._pageId=e.readInt(),this._pageName=e.readString(),this._localization=e.readString();let t=e.readInt();for(;t>0;)this._offerIds.push(e.readInt()),t--;let i=e.readInt();for(;i>0;)this._children.push(new nC(e)),i--;return!0}get visible(){return this._visible}get icon(){return this._icon}get pageId(){return this._pageId}get pageName(){return this._pageName}get localization(){return this._localization}get children(){return this._children}get offerIds(){return this._offerIds}}class xH{flush(){return this._root=null,!0}parse(e){return e?(this._root=new nC(e),this._newAdditionsAvailable=e.readBoolean(),this._catalogType=e.readString(),!0):!1}get root(){return this._root}get newAdditionsAvailable(){return this._newAdditionsAvailable}get catalogType(){return this._catalogType}}class OH{constructor(e){this._images=[],this._texts=[];let t=e.readInt();for(;t>0;)this._images.push(e.readString()),t--;let i=e.readInt();for(;i>0;)this._texts.push(e.readString()),i--}get images(){return this._images}get texts(){return this._texts}}class CH{flush(){return this._pageName=null,this._pageId=0,this._secondsToExpiry=0,this._image=null,!0}parse(e){return e?(this._pageId=e.readInt(),this._pageName=e.readString(),this._secondsToExpiry=e.readInt(),this._image=e.readString(),!0):!1}get pageName(){return this._pageName}get pageId(){return this._pageId}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}const hu=class hu{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._productType=null,this._furniClassId=-1,this._extraParam=null,this._productCount=0,this._uniqueLimitedItem=!1,this._uniqueLimitedItemSeriesSize=0,this._uniqueLimitedItemsLeft=0,!0}parse(e){switch(this._productType=e.readString(),this._productType){case hu.B:return this._extraParam=e.readString(),this._productCount=1,!0;default:return this._furniClassId=e.readInt(),this._extraParam=e.readString(),this._productCount=e.readInt(),this._uniqueLimitedItem=e.readBoolean(),this._uniqueLimitedItem&&(this._uniqueLimitedItemSeriesSize=e.readInt(),this._uniqueLimitedItemsLeft=e.readInt()),!0}}get productType(){return this._productType}get furniClassId(){return this._furniClassId}get extraParam(){return this._extraParam}get productCount(){return this._productCount}get uniqueLimitedItem(){return this._uniqueLimitedItem}get uniqueLimitedSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}};hu.I="i",hu.S="s",hu.E="e",hu.B="b";let Fa=hu;class rT{constructor(e){this._offerId=e.readInt(),this._localizationId=e.readString(),this._rent=e.readBoolean(),this._priceCredits=e.readInt(),this._priceActivityPoints=e.readInt(),this._priceActivityPointsType=e.readInt(),this._giftable=e.readBoolean(),this._products=[];let t=e.readInt();for(;t>0;)this._products.push(new Fa(e)),t--;this._clubLevel=e.readInt(),this._bundlePurchaseAllowed=e.readBoolean(),this._isPet=e.readBoolean(),this._previewImage=e.readString()}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isPet(){return this._isPet}get previewImage(){return this._previewImage}get products(){return this._products}}const zl=class zl{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._type=-1,this._position=null,this._itemName=null,this._itemPromoImage=null,this._catalogPageLocation=null,this._productCode=null,this._productOfferId=0,this._expirationTime=0,!0}parse(e){if(!e)return!1;switch(this._position=e.readInt(),this._itemName=e.readString(),this._itemPromoImage=e.readString(),this._type=e.readInt(),this._type){case zl.ITEM_CATALOGUE_PAGE:this._catalogPageLocation=e.readString();break;case zl.ITEM_PRODUCT_OFFER:this._productOfferId=e.readInt();break;case zl.ITEM_IAP:this._productCode=e.readString();break}const t=e.readInt();return this._expirationTime=t>0?t*1e3+nt():0,!0}get type(){return this._type}get position(){return this._position}get itemName(){return this._itemName}get itemPromoImage(){return this._itemPromoImage}get catalogPageLocation(){return this._catalogPageLocation}get productCode(){return this._productCode}get productOfferId(){return this._productOfferId}get expirationTime(){return this._expirationTime}};zl.ITEM_CATALOGUE_PAGE=0,zl.ITEM_PRODUCT_OFFER=1,zl.ITEM_IAP=2;let Pg=zl;class NH{flush(){return this._pageId=-1,this._catalogType=null,this._layoutCode=null,this._localization=null,this._offers=[],this._offerId=-1,this._acceptSeasonCurrencyAsCredits=!1,this._frontPageItems=[],!0}parse(e){if(!e)return!1;this._pageId=e.readInt(),this._catalogType=e.readString(),this._layoutCode=e.readString(),this._localization=new OH(e);let t=e.readInt();for(;t>0;)this._offers.push(new rT(e)),t--;if(this._offerId=e.readInt(),this._acceptSeasonCurrencyAsCredits=e.readBoolean(),e.bytesAvailable){let i=e.readInt();for(;i>0;)this._frontPageItems.push(new Pg(e)),i--}return!0}get pageId(){return this._pageId}get catalogType(){return this._catalogType}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get offerId(){return this._offerId}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get frontPageItems(){return this._frontPageItems}}class AH{flush(){return this._pageName=null,this._secondsToExpiry=0,this._image=null,!0}parse(e){return e?(this._pageName=e.readString(),this._secondsToExpiry=e.readInt(),this._image=e.readString(),!0):!1}get pageName(){return this._pageName}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}class bH{flush(){return this._instantlyRefreshCatalogue=!1,this._newFurniDataHash=null,!0}parse(e){return e?(this._instantlyRefreshCatalogue=e.readBoolean(),e.bytesAvailable&&(this._newFurniDataHash=e.readString()),!0):!1}get instantlyRefreshCatalogue(){return this._instantlyRefreshCatalogue}get newFurniDataHash(){return this._newFurniDataHash}}class vH{constructor(e){this._offerId=e.readInt(),this._isVip=e.readBoolean(),this._daysRequired=e.readInt(),this._isSelectable=e.readBoolean()}get offerId(){return this._offerId}get isVip(){return this._isVip}get isSelectable(){return this._isSelectable}get daysRequired(){return this._daysRequired}}class yH{flush(){return!0}parse(e){if(!e)return!1;this._offers=[],this._giftData=new Map,this._daysUntilNextGift=e.readInt(),this._giftsAvailable=e.readInt();const t=e.readInt();for(let r=0;r<t;r++)this._offers.push(new rT(e));const i=e.readInt();for(let r=0;r<i;r++){const n=new vH(e);this._giftData.set(n.offerId,n)}return!0}get offers(){return this._offers}get daysUntilNextGift(){return this._daysUntilNextGift}get giftsAvailable(){return this._giftsAvailable}set giftsAvailable(e){this._giftsAvailable=e}getOfferExtraData(e){return e?this._giftData.get(e):null}get giftData(){return this._giftData}}class DH{flush(){return this._productCode=null,this._products=[],!0}parse(e){if(!e)return!1;this._productCode=e.readString();let t=e.readInt();for(;t>0;)this._products.push(new Fa(e)),t--;return!0}get productCode(){return this._productCode}get products(){return this._products}}class iD{constructor(e){if(!e)throw new Error("invalid_wrapper");this._offerId=e.readInt(),this._productCode=e.readString(),e.readBoolean(),this._priceCredits=e.readInt(),this._priceActivityPoints=e.readInt(),this._priceActivityPointsType=e.readInt(),this._vip=e.readBoolean(),this._months=e.readInt(),this._extraDays=e.readInt(),this._giftable=e.readBoolean(),this._daysLeftAfterPurchase=e.readInt(),this._year=e.readInt(),this._month=e.readInt(),this._day=e.readInt()}get offerId(){return this._offerId}get productCode(){return this._productCode}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get vip(){return this._vip}get months(){return this._months}get extraDays(){return this._extraDays}get daysLeftAfterPurchase(){return this._daysLeftAfterPurchase}get year(){return this._year}get month(){return this._month}get day(){return this._day}get giftable(){return this._giftable}}class MH extends iD{constructor(e){super(e),this._originalPrice=e.readInt(),this._originalActivityPointPrice=e.readInt(),this._originalActivityPointType=e.readInt(),this._subscriptionDaysLeft=e.readInt()}get originalPrice(){return this._originalPrice*this.months}get originalActivityPointPrice(){return this._originalActivityPointPrice*this.months}get originalActivityPointType(){return this._originalActivityPointType}get discountCreditAmount(){return this._originalPrice*this.months-this.priceCredits}get discountActivityPointAmount(){return this.originalActivityPointPrice*this.months-this.priceActivityPoints}get subscriptionDaysLeft(){return this._subscriptionDaysLeft}}class jH{flush(){return this._available=!1,this._pricePointUrl=null,this._market=null,this._lengthInDays=0,!0}parse(e){return e?(this._pricePointUrl=e.readString(),this._pricePointUrl!==""&&(this._available=!0),this._market=e.readString(),this._lengthInDays=e.readInt(),!0):!1}get available(){return this._available}get pricePointUrl(){return this._pricePointUrl}get market(){return this._market}get lengthInDays(){return this._lengthInDays}}class LH{constructor(e){this._stuffId=e.readInt(),this._charges=e.readInt(),this._SafeStr_6935=e.readInt(),this._SafeStr_6936=e.readInt(),this._SafeStr_6518=e.readInt(),this._SafeStr_7875=e.readInt()}get stuffId(){return this._stuffId}get charges(){return this._charges}get _SafeStr_5946(){return this._SafeStr_6935}get _SafeStr_5944(){return this._SafeStr_6936}get _SafeStr_7876(){return this._SafeStr_7875}get _SafeStr_5945(){return this._SafeStr_6518}}class PH{flush(){return this._fireworkChargeData=null,!0}parse(e){return e?(this._fireworkChargeData=new LH(e),!0):!1}get fireworkChargeData(){return this._fireworkChargeData}}class UH{flush(){return!0}parse(e){return!!e}}class wH{constructor(){this._isEnabled=!1,this._price=null,this._giftWrappers=null,this._boxTypes=null,this._ribbonTypes=null,this._giftFurnis=null}flush(){return this._boxTypes=null,this._giftFurnis=null,this._giftWrappers=null,this._ribbonTypes=null,this._isEnabled=null,this._price=null,!0}parse(e){if(!e)return!1;const t=[],i=[],r=[],n=[];this._isEnabled=e.readBoolean(),this._price=e.readInt();let o=e.readInt(),l=0;for(;l<o;)t.push(e.readInt()),l++;for(o=e.readInt(),l=0;l<o;)i.push(e.readInt()),l++;for(o=e.readInt(),l=0;l<o;)r.push(e.readInt()),l++;for(o=e.readInt(),l=0;l<o;)n.push(e.readInt()),l++;return this._giftWrappers=t,this._ribbonTypes=r,this._giftFurnis=n,this._boxTypes=i,!0}get giftWrappers(){return this._giftWrappers}get ribbonTypes(){return this._ribbonTypes}get giftFurnis(){return this._giftFurnis}get boxTypes(){return this._boxTypes}get isEnabled(){return this._isEnabled}get price(){return this._price}}class FH{flush(){return this._offer=null,!0}parse(e){return e?(this._offer=new MH(e),!0):!1}get offer(){return this._offer}}class kH{flush(){return this._offers=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._offers.push(new iD(e)),t--;return!0}get offers(){return this._offers}}class GH{flush(){return this._offerId=0,this._isGiftable=!1,!0}parse(e){return e?(this._offerId=e.readInt(),this._isGiftable=e.readBoolean(),!0):!1}get offerId(){return this._offerId}get isGiftable(){return this._isGiftable}}class BH{flush(){return!0}parse(e){return!!e}}class VH{flush(){return this._appearsInSeconds=-1,this._pageId=-1,this._offerId=-1,this._productType="",!0}parse(e){return e?(this._appearsInSeconds=e.readInt(),this._pageId=e.readInt(),this._offerId=e.readInt(),this._productType=e.readString(),!0):!1}get appearsInSeconds(){return this._appearsInSeconds}get pageId(){return this._pageId}get offerId(){return this._offerId}get productType(){return this._productType}}class HH{constructor(){this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0}flush(){return this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0,!0}parse(e){return e?(this._notEnoughCredits=e.readBoolean(),this._notEnoughActivityPoints=e.readBoolean(),e.bytesAvailable&&(this._activityPointType=e.readInt()),!0):!1}get notEnoughCredits(){return this._notEnoughCredits}get notEnoughActivityPoints(){return this._notEnoughActivityPoints}get activityPointType(){return this._activityPointType}}class WH{flush(){return this._offer=null,!0}parse(e){return e?(this._offer=new rT(e),!0):!1}get offer(){return this._offer}}class YH{flush(){return this._code=0,!0}parse(e){return e?(this._code=e.readInt(),!0):!1}get code(){return this._code}}class zH{flush(){return this._code=0,!0}parse(e){return e?(this._code=e.readInt(),!0):!1}get code(){return this._code}}class KH{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._offerId=-1,this._localizationId=null,this._rent=!1,this._priceCredits=0,this._priceActivityPoints=0,this._priceActivityPointsType=0,this._clubLevel=0,this._giftable=!1,this._bundlePurchaseAllowed=!1,this._products=[],!0}parse(e){if(!e)return!1;this._offerId=e.readInt(),this._localizationId=e.readString(),this._rent=e.readBoolean(),this._priceCredits=e.readInt(),this._priceActivityPoints=e.readInt(),this._priceActivityPointsType=e.readInt(),this._giftable=e.readBoolean();let t=e.readInt();for(;t>0;)this._products.push(new Fa(e)),t--;return this._clubLevel=e.readInt(),this._bundlePurchaseAllowed=e.readBoolean(),!0}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get products(){return this._products}}class qH{flush(){return this._offer=null,!0}parse(e){return e?(this._offer=new KH(e),!0):!1}get offer(){return this._offer}}class XH{get canModTools(){return this._canModTools}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}flush(){return this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,this._canModTools=!1,!0}parse(e){return e?(this._clubLevel=e.readInt(),this._securityLevel=e.readInt(),this._isAmbassador=e.readBoolean(),this._canModTools=e.readBoolean(),!0):!1}}const KE=class KE{flush(){return!0}parse(e){return e?(this._status=e.readInt(),!0):!1}get status(){return this._status}};KE.SAFETY_LOCK_STATUS_LOCKED=0,KE.SAFETY_LOCK_STATUS_UNLOCKED=1;let Ff=KE;class $H{flush(){return this._result=-1,this._validationInfo="",!0}parse(e){return e?(this._result=e.readInt(),this._validationInfo=e.readString(),!0):!1}get result(){return this._result}get validationInfo(){return this._validationInfo}}const _A=class _A{flush(){return this._result=-1,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}};_A.EMAIL_STATUS_OK=0;let iR=_A;class QH{flush(){return this._result=-1,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}}class JH{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._relationshipStatusType=_r.NONE,this._friendCount=0,this._randomFriendId=0,this._randomFriendFigure=null,this._randomFriendName=null,!0}parse(e){return e?(this._relationshipStatusType=e.readInt(),this._friendCount=e.readInt(),this._randomFriendId=e.readInt(),this._randomFriendName=e.readString(),this._randomFriendFigure=e.readString(),!0):!1}get relationshipStatusType(){return this._relationshipStatusType}get friendCount(){return this._friendCount}get randomFriendId(){return this._randomFriendId}get randomFriendName(){return this._randomFriendName}get randomFriendFigure(){return this._randomFriendFigure}}class ZH{flush(){return this._userId=0,this._relationshipStatusMap=null,!0}parse(e){if(!e)return!1;this._userId=e.readInt(),this._relationshipStatusMap=new Ms;const t=e.readInt();for(let i=0;i<t;i++){const r=new JH(e);this._relationshipStatusMap.add(r.relationshipStatusType,r)}return!0}get userId(){return this._userId}get relationshipStatusMap(){return this._relationshipStatusMap}}class eW{flush(){return this._userId=null,this._badges=[],!0}parse(e){if(!e)return!1;this._userId=e.readInt();let t=e.readInt();for(;t>0;){e.readInt();const i=e.readString();this._badges.push(i),t--}return!0}get userId(){return this._userId}get badges(){return this._badges}}class tW{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._userId=0,this._username=null,this._figure=null,this._gender=null,this._motto=null,this._realName=null,this._directMail=!1,this._respectsReceived=0,this._respectsRemaining=0,this._kissesReceived=0,this._kissesRemaining=0,this._respectsPetRemaining=0,this._streamPublishingAllowed=!1,this._lastAccessDate=null,this._canChangeName=!1,this._safetyLocked=!1,!0}parse(e){return e?(this._userId=e.readInt(),this._username=e.readString(),this._figure=e.readString(),this._gender=e.readString(),this._motto=e.readString(),this._realName=e.readString(),this._directMail=e.readBoolean(),this._respectsReceived=e.readInt(),this._respectsRemaining=e.readInt(),this._respectsPetRemaining=e.readInt(),this._streamPublishingAllowed=e.readBoolean(),this._lastAccessDate=e.readString(),this._canChangeName=e.readBoolean(),this._safetyLocked=e.readBoolean(),this._kissesReceived=e.readInt(),this._kissesRemaining=e.readInt(),!0):!1}get userId(){return this._userId}get username(){return this._username}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get realName(){return this._realName}get directMail(){return this._directMail}get respectsReceived(){return this._respectsReceived}get respectsRemaining(){return this._respectsRemaining}get kissesReceived(){return this._kissesReceived}get kissesRemaining(){return this._kissesRemaining}get respectsPetRemaining(){return this._respectsPetRemaining}get streamPublishingAllowed(){return this._streamPublishingAllowed}get lastAccessedDate(){return this._lastAccessDate}get canChangeName(){return this._canChangeName}get safetyLocked(){return this._safetyLocked}}class sW{flush(){return this._userInfo=null,!0}parse(e){return!(!e||(this._userInfo=new tW(e),!this._userInfo))}get userInfo(){return this._userInfo}}class iW{flush(){return this._webId=-1,this._id=-1,this._newName="",this._coloredName="",!0}parse(e){return e?(this._webId=e.readInt(),this._id=e.readInt(),this._newName=e.readString(),this._nickname=e.readString(),this._coloredName=e.readString(),!0):!1}get webId(){return this._webId}get id(){return this._id}get newName(){return this._newName}get nickname(){return this._nickname}get coloredName(){return this._coloredName}}class rD{constructor(e){this._groupId=e.readInt(),this._groupName=e.readString(),this._badgeCode=e.readString(),this._colorA=e.readString(),this._colorB=e.readString(),this._favourite=e.readBoolean(),this._ownerId=e.readInt(),this._hasForum=e.readBoolean()}get groupId(){return this._groupId}get groupName(){return this._groupName}get badgeCode(){return this._badgeCode}get colorA(){return this._colorA}get colorB(){return this._colorB}get favourite(){return this._favourite}get ownerId(){return this._ownerId}get hasForum(){return this._hasForum}}class rW{flush(){return this._id=0,this._username=null,this._nickname=null,this._coloredName=null,this._profileIconId=0,this._figure=null,this._motto=null,this._registration=null,this._achievementPoints=0,this._friendsCount=0,this._isMyFriend=!1,this._requestSent=!1,this._isOnline=!1,this._groups=[],this._secondsSinceLastVisit=0,this._openProfileWindow=!1,this._starGem=0,this._isHC=!1,this._profileImage=null,this._respect=0,this._profileColors=[],this._profileImagePosition=[],!0}parse(e){if(!e)return!1;this._id=e.readInt(),this._username=e.readString(),this._nickname=e.readString(),this._coloredName=e.readString(),this._profileIconId=e.readInt(),this._figure=e.readString(),this._motto=e.readString(),this._registration=e.readString(),this._achievementPoints=e.readInt(),this._friendsCount=e.readInt(),this._isMyFriend=e.readBoolean(),this._requestSent=e.readBoolean(),this._isOnline=e.readBoolean();const t=e.readInt();for(let i=0;i<t;i++)this._groups.push(new rD(e));return this._secondsSinceLastVisit=e.readInt(),this._openProfileWindow=e.readBoolean(),this._starGem=e.readInt(),this._isHC=e.readBoolean(),this._profileImage=e.readString(),this._respect=e.readInt(),this._profileColors=e.readString().split(";"),this._profileImagePosition=e.readString().split(";"),!0}get id(){return this._id}get username(){return this._username}get nickname(){return this._nickname}get coloredName(){return this._coloredName}get profileIconId(){return this._profileIconId}get figure(){return this._figure}get motto(){return this._motto}get registration(){return this._registration}get achievementPoints(){return this._achievementPoints}get friendsCount(){return this._friendsCount}get isMyFriend(){return this._isMyFriend}get requestSent(){return this._requestSent}get isOnline(){return this._isOnline}get groups(){return this._groups}get secondsSinceLastVisit(){return this._secondsSinceLastVisit}get openProfileWindow(){return this._openProfileWindow}get starGem(){return this._starGem}get respect(){return this._respect}get isHC(){return this._isHC}get profileImage(){return this._profileImage}get profileColors(){return this._profileColors}get primaryColor(){return this._profileColors[0]||"#dfdfdf"}get accentColor(){return this._profileColors[1]||"#dfdfdf"}get positionImageX(){return this._profileImagePosition[0]||"0"}get positionImageY(){return this._profileImagePosition[1]||"0"}set profileColors(e){this._profileColors=e}set primaryColor(e){this._profileColors[0]=e}set accentColor(e){this._profileColors[1]=e}}class nW{get hideOnline(){return this._hideOnline}get hideInRoom(){return this._hideInRoom}get hideTyping(){return this._hideTyping}get hideLastSeen(){return this._hideLastSeen}get allowFriendRequests(){return this._allowFriendRequests}get allowTargetCommands(){return this._allowTargetCommands}get allowWhispering(){return this._allowWhispering}get allowFollow(){return this._allowFollow}get allowTrade(){return this._allowTrade}get allowGifts(){return this._allowGifts}get allowCopy(){return this._allowCopy}get volumeSystem(){return this._volumeSystem}get volumeFurni(){return this._volumeFurni}get volumeTrax(){return this._volumeTrax}get oldChat(){return this._oldChat}get roomInvites(){return this._roomInvites}get cameraFollow(){return this._cameraFollow}get flags(){return this._flags}get chatType(){return this._chatType}get currency(){return this._currency}get whisperingToWired(){return this._whisperingToWired}get optionalPathFinderMode(){return this._optionalPathFinderMode}get wiredMenuButton(){return this._wiredMenuButton}get wiredInspectButton(){return this._wiredInspectButton}get playTestMode(){return this._playTestMode}get variableSyntaxMode(){return this._variableSyntaxMode}flush(){return this._volumeSystem=0,this._volumeFurni=0,this._volumeTrax=0,this._oldChat=!1,this._roomInvites=!1,this._cameraFollow=!1,this._flags=0,this._chatType=0,this._currency="real",this._whisperingToWired=!0,this._optionalPathFinderMode=-1,this._hideOnline=!1,this._hideInRoom=!1,this._hideTyping=!1,this._hideLastSeen=!1,this._allowFriendRequests=!0,this._allowTargetCommands=0,this._allowWhispering=0,this._allowFollow=0,this._allowTrade=0,this._allowGifts=0,this._allowCopy=0,this._wiredMenuButton=!1,this._wiredInspectButton=!1,this._playTestMode=!1,this._variableSyntaxMode=0,!0}parse(e){return e?(this._volumeSystem=e.readInt(),this._volumeFurni=e.readInt(),this._volumeTrax=e.readInt(),this._oldChat=e.readBoolean(),this._roomInvites=e.readBoolean(),this._cameraFollow=e.readBoolean(),this._flags=e.readInt(),this._chatType=e.readInt(),this._currency=e.readString(),this._whisperingToWired=e.readBoolean(),this._optionalPathFinderMode=e.readInt(),this._hideOnline=e.readBoolean(),this._hideInRoom=e.readBoolean(),this._hideTyping=e.readBoolean(),this._hideLastSeen=e.readBoolean(),this._allowFriendRequests=e.readBoolean(),this._allowTargetCommands=e.readInt(),this._allowWhispering=e.readInt(),this._allowFollow=e.readInt(),this._allowTrade=e.readInt(),this._allowGifts=e.readInt(),this._allowCopy=e.readInt(),this._wiredMenuButton=e.readBoolean(),this._wiredInspectButton=e.readBoolean(),this._playTestMode=e.readBoolean(),this._variableSyntaxMode=e.readInt(),!0):!1}}class aW{flush(){return this._roomUnitId=-1,this._tags=[],!0}parse(e){if(!e)return!1;this._roomUnitId=e.readInt();let t=e.readInt();for(;t>0;)this._tags.push(e.readString()),t--;return!0}get roomUnitId(){return this._roomUnitId}get tags(){return this._tags}}class oW{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,!0}parse(e){return e?(this._email=e.readString(),this._isVerified=e.readBoolean(),this._allowChange=e.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}}class lW{flush(){return this._userId=-1,!0}parse(e){return e?(this._userId=e.readInt(),!0):!1}get userId(){return this._userId}}class cW{flush(){return this._groupId=-1,!0}parse(e){return e?(this._groupId=e.readInt(),!0):!1}get groupId(){return this._groupId}}class uW{flush(){return this._groupId=-1,this._requester=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._requester=new ox(e),!0):!1}get groupId(){return this._groupId}get requester(){return this._requester}}const gA=class gA{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}};gA.INSUFFICIENT_SUBSCRIPTION_LEVEL=2;let rR=gA;class hW{flush(){return this._guildId=-1,this._reason=-1,!0}parse(e){return e?(this._guildId=e.readInt(),this._reason=e.readInt(),!0):!1}get guildId(){return this._guildId}get reason(){return this._reason}}class dW{flush(){return this._groups=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._groups.push(new rD(e)),t--;return!0}get groups(){return this._groups}}class _W{flush(){return this._badges=new Map,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const i=e.readInt(),r=e.readString();this._badges.set(i,r),t--}return!0}get badges(){return this._badges}}const mA=class mA{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}};mA.INSUFFICIENT_SUBSCRIPTION_LEVEL=4;let nR=mA;class gW{flush(){return this._ignoredUsers=[],!0}parse(e){if(!e)return!1;this._ignoredUsers=[];let t=e.readInt();for(;t>0;)this._ignoredUsers.push(e.readString()),t--;return!0}get ignoredUsers(){return this._ignoredUsers}}class mW{flush(){return this._result=-1,this._ids=[],!0}parse(e){if(!e)return!1;this._result=e.readInt();const t=e.readInt();for(let i=0;i<t;i++)this._ids.push(e.readInt());return!0}get result(){return this._result}get ids(){return this._ids}}class aC{constructor(e){this._value=e}get value(){return this._value}}class fW{flush(){return this._link=null,!0}parse(e){return e?(this._link=new aC(e.readLargeString()),!0):!1}get link(){return this._link?this._link.value:""}}class pW{flush(){return this._credits=null,!0}parse(e){return e?(this._credits=e.readString(),!0):!1}get credits(){return this._credits}}class EW{flush(){return this._currencies=new Map,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._currencies.set(e.readInt(),e.readInt()),t--;return!0}get currencies(){return this._currencies}}const Vh=class Vh{flush(){return this._productName=null,this._daysToPeriodEnd=0,this._memberPeriods=0,this._periodsSubscribedAhead=0,this._responseType=0,this._hasEverBeenMember=!1,this._isVip=!1,this._pastClubDays=0,this._pastVipDays=0,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,!0}parse(e){return e?(this._productName=e.readString(),this._daysToPeriodEnd=e.readInt(),this._memberPeriods=e.readInt(),this._periodsSubscribedAhead=e.readInt(),this._responseType=e.readInt(),this._hasEverBeenMember=e.readBoolean(),this._isVip=e.readBoolean(),this._pastClubDays=e.readInt(),this._pastVipDays=e.readInt(),this._minutesUntilExpiration=e.readInt(),e.bytesAvailable&&(this._minutesSinceLastModified=e.readInt()),!0):!1}get productName(){return this._productName}get daysToPeriodEnd(){return this._daysToPeriodEnd}get memberPeriods(){return this._memberPeriods}get periodsSubscribedAhead(){return this._periodsSubscribedAhead}get responseType(){return this._responseType}get hasEverBeenMember(){return this._hasEverBeenMember}get isVip(){return this._isVip}get pastClubDays(){return this._pastClubDays}get pastVipDays(){return this._pastVipDays}get minutesUntilExpiration(){return this._minutesUntilExpiration}get minutesSinceLastModified(){return this._minutesSinceLastModified}};Vh.RESPONSE_TYPE_LOGIN=1,Vh.RESPONSE_TYPE_PURCHASE=2,Vh.RESPONSE_TYPE_DISCOUNT_AVAILABLE=3,Vh.RESPONSE_TYPE_CITIZENSHIP_DISCOUNT=4;let kf=Vh;class IW{flush(){return this._userId=0,this._kissesReceived=0,!0}parse(e){return e?(this._userId=e.readInt(),this._kissesReceived=e.readInt(),!0):!1}get userId(){return this._userId}get kissesReceived(){return this._kissesReceived}}const Hh=class Hh{constructor(e){if(this._unseen=0,!e)throw new Error("invalid_parser");this._achievementId=e.readInt(),this._level=e.readInt(),this._badgeId=e.readString(),this._scoreAtStartOfLevel=e.readInt(),this._scoreLimit=Math.max(1,e.readInt()),this._levelRewardPoints=e.readInt(),this._levelRewardPointType=e.readInt(),this._currentPoints=e.readInt(),this._finalLevel=e.readBoolean(),this._category=e.readString(),this._subCategory=e.readString(),this._levelCount=e.readInt(),this._displayMethod=e.readInt(),this._rewardVipPoints=e.readInt(),this._rewardAchievement=e.readInt()}get achievementId(){return this._achievementId}get badgeId(){return this._badgeId}get level(){return this._level}get scoreAtStartOfLevel(){return this._scoreAtStartOfLevel}get scoreLimit(){return this._scoreLimit-this._scoreAtStartOfLevel}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get currentPoints(){return this._currentPoints-this._scoreAtStartOfLevel}get finalLevel(){return this._finalLevel}get category(){return this._category}get subCategory(){return this._subCategory}get levelCount(){return this._levelCount}get firstLevelAchieved(){return this._level>1||this._finalLevel}setMaxProgress(){this._currentPoints=this._scoreLimit}get displayMethod(){return this._displayMethod}get progress(){return this._currentPoints}get toNextProgress(){return this._scoreLimit}set unseen(e){this._unseen=e}get unseen(){return this._unseen}get rewardVipPoints(){return this._rewardVipPoints}get rewardAchievement(){return this._rewardAchievement}reset(e){this._achievementId=e._achievementId,this._level=e._level,this._badgeId=e._badgeId,this._scoreAtStartOfLevel=e._scoreAtStartOfLevel,this._scoreLimit=e._scoreLimit,this._levelRewardPoints=e._levelRewardPoints,this._levelRewardPointType=e._levelRewardPointType,this._currentPoints=e._currentPoints,this._finalLevel=e._finalLevel,this._category=e.category,this._subCategory=e._subCategory,this._levelCount=e._levelCount,this._displayMethod=e._displayMethod,this._rewardVipPoints=e._rewardVipPoints,this._rewardAchievement=e._rewardAchievement}};Hh.DISPLAY_METHOD_OBSOLETE=-1,Hh.DISPLAY_METHOD_SHOW_LEVEL_PROGRESS=0,Hh.DISPLAY_METHOD_NEVER_SHOW_PROGRESS=1,Hh.DISPLAY_METHOD_SHOW_TOTAL_PROGRESS=2;let Gf=Hh;class TW{flush(){return this._achievement=null,!0}parse(e){return e?(this._achievement=new Gf(e),!0):!1}get achievement(){return this._achievement}}const qE=class qE{constructor(e){this._achievementId=e.readInt(),this._level=e.readInt(),this._badgeId=e.readString(),this._requiredLevel=e.readInt(),this._state=e.readInt()}dispose(){this._achievementId=0,this._level=0,this._badgeId="",this._requiredLevel=0}get achievementId(){return this._achievementId}get level(){return this._level}get badgeId(){return this._badgeId}get requiredLevel(){return this._requiredLevel}get enabled(){return this._state===qE.STATE_SELECTABLE}get state(){return this._state}};qE.STATE_SELECTABLE=0;let aR=qE;class SW{flush(){return this._achievements=[],this._defaultCategory=null,!0}parse(e){if(!e)return!1;this._achievements=[];let t=e.readInt();for(;t>0;)this._achievements.push(new Gf(e)),t--;return this._defaultCategory=e.readString(),!0}get achievements(){return this._achievements}get defaultCategory(){return this._defaultCategory}}class RW{flush(){return this._score=0,!0}parse(e){return e?(this._score=e.readInt(),!0):!1}get score(){return this._score}}class xW{get type(){return this._type}set type(e){this._type=e}get subType(){return this._subType}set subType(e){this._subType=e}get duration(){return this._duration}set duration(e){this._duration=e}get inactiveEffectsInInventory(){return this._inactiveEffectsInInventory}set inactiveEffectsInInventory(e){this._inactiveEffectsInInventory=e}get secondsLeftIfActive(){return this._secondsLeftIfActive}set secondsLeftIfActive(e){this._secondsLeftIfActive=e}get isPermanent(){return this._permanent}set isPermanent(e){this._permanent=e}}class OW{flush(){return this._type=0,this._duration=0,this._isPermanent=!1,!0}parse(e){return e?(this._type=e.readInt(),this._duration=e.readInt(),this._isPermanent=e.readBoolean(),!0):!1}get type(){return this._type}get duration(){return this._duration}get isPermanent(){return this._isPermanent}}class CW{flush(){return this._type=0,this._subType=0,this._duration=0,this._permanent=!1,!0}parse(e){return e?(this._type=e.readInt(),this._subType=e.readInt(),this._duration=e.readInt(),this._permanent=e.readBoolean(),!0):!1}get type(){return this._type}get subType(){return this._subType}get duration(){return this._duration}get isPermanent(){return this._permanent}}class NW{flush(){return this._type=0,!0}parse(e){return e?(this._type=e.readInt(),!0):!1}get type(){return this._type}}class AW{flush(){return this._type=0,!0}parse(e){return e?(this._type=e.readInt(),!0):!1}get type(){return this._type}}class bW{flush(){return this._effects=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const i=new xW;i.type=e.readInt(),i.subType=e.readInt(),i.duration=e.readInt(),i.inactiveEffectsInInventory=e.readInt(),i.secondsLeftIfActive=e.readInt(),i.isPermanent=e.readBoolean(),this._effects.push(i),t--}return!0}get effects(){return this._effects}}class vW{constructor(e,t){if(!t)throw new Error("invalid_parser");this._badgeId="ACH_"+e+t.readInt(),this._limit=t.readInt()}get badgeId(){return this._badgeId}get limit(){return this._limit}}class yW{flush(){return this._data=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const i=e.readString(),r=e.readInt();let n=0;for(;n<r;)this._data.push(new vW(i,e)),n++;t--}return!0}get data(){return this._data}}class DW{flush(){return this._badgeId=0,this._badgeCode=null,!0}parse(e){return e?(this._badgeId=e.readInt(),this._badgeCode=e.readString(),!0):!1}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}}class MW{flush(){return this._allBadgeCodes=[],this._activeBadgeCodes=null,this._hiddenBadges=null,this._badgeIds=null,!0}parse(e){if(!e)return!1;this._allBadgeCodes=[],this._activeBadgeCodes=[],this._hiddenBadges=[],this._badgeIds=new Ms;let t=e.readInt();for(;t>0;){const i=e.readInt(),r=e.readString();this._badgeIds.add(r,i),this._allBadgeCodes.push(r),t--}for(t=e.readInt();t>0;){e.readInt();const i=e.readString();this._activeBadgeCodes.push(i),t--}for(t=e.readInt();t>0;){const i=e.readString();this._hiddenBadges.push(i),t--}return!0}getBadgeId(e){return this._badgeIds.getValue(e)}getAllBadgeCodes(){return this._allBadgeCodes}getActiveBadgeCodes(){return this._activeBadgeCodes}getHiddenBadgeCodes(){return this._hiddenBadges}}class jW{flush(){return!0}parse(e){return e?(this._requestCode=e.readString(),this._fulfilled=e.readBoolean(),!0):!1}get requestCode(){return this._requestCode}get fulfilled(){return this._fulfilled}}class LW{flush(){return this._figureSetIds=[],this._boundFurnitureNames=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._figureSetIds.push(Number.parseInt(e.readString())),t--;let i=e.readInt();for(;i>0;)this._boundFurnitureNames.push(e.readString()),i--;return!0}get figureSetIds(){return this._figureSetIds}get boundsFurnitureNames(){return this._boundFurnitureNames}}const Wh=class Wh{flush(){return this._reason=0,this._parameter="",!0}parse(e){return e?(this._reason=e.readInt(),this._parameter=e.readString(),!0):!1}get reason(){return this._reason}get parameter(){return this._parameter}};Wh.REASON_FULL=1,Wh.REASON_CLOSED=2,Wh.REASON_QUEUE_ERROR=3,Wh.REASON_BANNED=4;let Td=Wh;class PW{flush(){return this._userName=null,!0}parse(e){return e?(this._userName=e.readString(),!0):!1}get userName(){return this._userName}}class UW{flush(){return!0}parse(e){return!!e}}class wW{flush(){return!0}parse(e){return!!e}}class FW{flush(){return this._controllerLevel=pt.NONE,!0}parse(e){return e?(this._controllerLevel=e.readInt(),this._canEditAds=e.readBoolean(),!0):!1}get controllerLevel(){return this._controllerLevel}get canEditAds(){return this._canEditAds}}class kW{flush(){return!0}parse(e){return!!e}}class GW{flush(){return this._roomId=0,!0}parse(e){return e?(this._roomId=e.readInt(),!0):!1}get roomId(){return this._roomId}}class BW{flush(){return this._botId=-1,this._commandId=-1,this._data="",!0}parse(e){return e?(this._botId=e.readInt(),this._commandId=e.readInt(),this._data=e.readString(),!0):!1}get botId(){return this._botId}get commandId(){return this._commandId}get data(){return this._data}}class VW{flush(){return this._botId=-1,!0}parse(e){return e?(this._botId=e.readInt(),!0):!1}get botId(){return this._botId}}class HW{constructor(e){this._id=e.readInt(),this._data=e.readString()}get id(){return this._id}get data(){return this._data}}class WW{flush(){return this._botId=-1,this._skillList=[],!0}parse(e){if(!e)return!1;this._botId=e.readInt();let t=e.readInt();for(;t>0;)this._skillList.push(new HW(e)),t--;return!0}get botId(){return this._botId}get skillList(){return this._skillList}}class YW{constructor(e){this._userId=e.readInt(),this._userName=e.readString()}get userId(){return this._userId}get userName(){return this._userName}}class zW{flush(){return this._roomId=0,this._bannedUsers=[],!0}parse(e){if(!e)return!1;this._roomId=e.readInt();let t=e.readInt();for(;t>0;)this._bannedUsers.push(new YW(e)),t--;return!0}get roomId(){return this._roomId}get bannedUsers(){return this._bannedUsers}}class KW{constructor(e){this._userId=e.readInt(),this._userName=e.readString()}get userId(){return this._userId}get userName(){return this._userName}get selected(){return this._selected}set selected(e){this._selected=e}}class qW{flush(){return this._roomId=0,this._data=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._data=new KW(e),!0):!1}get roomId(){return this._roomId}get data(){return this._data}}class XW{flush(){return this._roomId=0,this._userId=0,this._userName="Desconhecido",!0}parse(e){return e?(this._roomId=e.readInt(),this._userId=e.readInt(),this._userName=e.readString(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}get userName(){return this._userName}}class nD{flush(){return this._roomId=0,this._users=new Map,this._totalUsers=0,!0}parse(e){if(!e)return!1;this._roomId=e.readInt();let t=e.readInt();for(this._totalUsers=t;t>0;){const i=e.readInt(),r=e.readString();this._users.set(i,r),t--}return!0}get roomId(){return this._roomId}get users(){return this._users}get totalUsers(){return this._totalUsers}}class $W{flush(){return!0}parse(e){return e?(this._isMuted=e.readBoolean(),!0):!1}get isMuted(){return this._isMuted}}class QW{flush(){return this._roomId=0,!0}parse(e){return e?(this._roomId=e.readInt(),!0):!1}get roomId(){return this._roomId}}const xn=class xn{constructor(e){if(!e)throw new Error("invalid_wrapper");this._mode=e.readInt(),this._weight=e.readInt(),this._speed=e.readInt(),this._distance=e.readInt(),this._protection=e.readInt()}get mode(){return this._mode}get weight(){return this._weight}get speed(){return this._speed}get distance(){return this._distance}get protection(){return this._protection}};xn.CHAT_MODE_FREE_FLOW=0,xn.CHAT_MODE_LINE_BY_LINE=1,xn.CHAT_BUBBLE_WIDTH_WIDE=0,xn.CHAT_BUBBLE_WIDTH_NORMAL=1,xn.CHAT_BUBBLE_WIDTH_THIN=2,xn.CHAT_SCROLL_SPEED_FAST=0,xn.CHAT_SCROLL_SPEED_NORMAL=1,xn.CHAT_SCROLL_SPEED_SLOW=2,xn.FLOOD_FILTER_STRICT=0,xn.FLOOD_FILTER_NORMAL=1,xn.FLOOD_FILTER_LOOSE=2;let Ds=xn;const F_=class F_{constructor(e){this._allowMute=e.readInt(),this._allowKick=e.readInt(),this._allowBan=e.readInt(),this._allowAddBot=e.readInt(),this._allowDeleteRoom=e.readInt(),this._allowGiveRights=e.readInt(),this._allowMuteRoom=e.readInt(),this._allowSaveFloorPlan=e.readInt(),this._allowChangeLook=e.readInt()}get allowMute(){return this._allowMute}get allowKick(){return this._allowKick}get allowBan(){return this._allowBan}get allowDeleteRoom(){return this._allowDeleteRoom}get allowAddBot(){return this._allowAddBot}get allowSaveFloorPlan(){return this._allowSaveFloorPlan}get allowMuteRoom(){return this._allowMuteRoom}get allowGiveRights(){return this._allowGiveRights}get allowChangeLook(){return this._allowChangeLook}get allowCommands(){return this._allowCommands}set allowCommands(e){this._allowCommands=e}};F_.MODERATION_LEVEL_NONE=0,F_.MODERATION_LEVEL_USER_WITH_RIGHTS=1,F_.MODERATION_LEVEL_ALL=2;let Zt=F_;const zi=class zi{constructor(){this._allowAudio=!0,this._allowGif=!0,this._everyoneOpenWireds=!1,this._roomId=-1,this._name=null,this._description=null,this._doorMode=zi.DOORMODE_OPEN,this._categoryId=-1,this._maximumVisitors=0,this._maximumVisitorsLimit=0,this._tags=[],this._tradeMode=zi.TRADEMODE_NOT_ALLOWED,this._allowPets=!1,this._allowFoodConsume=!1,this._allowWalkThrough=!1,this._hideWalls=!1,this._wallThickness=0,this._floorThickness=0,this._controllersById=new Map,this._controllerList=null,this._highlightedUserId=-1,this._bannedUsersById=new Map,this._bannedUsersList=null,this._roomModerationSettings=null,this._chatSettings=null,this._allowNavigatorDynamicCats=!1,this._filter=0,this._pathfinder=0}get allowAudio(){return this._allowAudio}set allowAudio(e){this._allowAudio=e}get allowGif(){return this._allowGif}set allowGif(e){this._allowGif=e}get everyoneOpenWireds(){return this._everyoneOpenWireds}set everyoneOpenWireds(e){this._everyoneOpenWireds=e}get roomId(){return this._roomId}set roomId(e){this._roomId=e}get name(){return this._name}set name(e){this._name=e}get description(){return this._description}set description(e){this._description=e}get doorMode(){return this._doorMode}set doorMode(e){this._doorMode=e}get categoryId(){return this._categoryId}set categoryId(e){this._categoryId=e}get maximumVisitors(){return this._maximumVisitors}set maximumVisitors(e){this._maximumVisitors=e}get maximumVisitorsLimit(){return this._maximumVisitorsLimit}set maximumVisitorsLimit(e){this._maximumVisitorsLimit=e}get tags(){return this._tags}set tags(e){this._tags=e}get tradeMode(){return this._tradeMode}set tradeMode(e){this._tradeMode=e}get allowPets(){return this._allowPets}set allowPets(e){this._allowPets=e}get allowFoodConsume(){return this._allowFoodConsume}set allowFoodConsume(e){this._allowFoodConsume=e}get allowWalkThrough(){return this._allowWalkThrough}set allowWalkThrough(e){this._allowWalkThrough=e}get hideWalls(){return this._hideWalls}set hideWalls(e){this._hideWalls=e}get wallThickness(){return this._wallThickness}set wallThickness(e){this._wallThickness=e}get floorThickness(){return this._floorThickness}set floorThickness(e){this._floorThickness=e}get controllersById(){return this._controllersById}set controllersById(e){this._controllersById=e}get controllerList(){if(!this._controllerList){this._controllerList=[];for(const e of this._controllersById.values())this._controllerList.push(e);this._controllerList.sort((e,t)=>e.userName.localeCompare(t.userName))}return this._controllerList}get highlightedUserId(){return this._highlightedUserId}get bannedUsersById(){return this._bannedUsersById}get bannedUsersList(){if(!this._bannedUsersList){this._bannedUsersList=[];for(const e of this._bannedUsersById.values())this._bannedUsersList.push(e);this._bannedUsersList.sort((e,t)=>e.userName.localeCompare(t.userName))}return this._bannedUsersList}get roomModerationSettings(){return this._roomModerationSettings}set roomModerationSettings(e){this._roomModerationSettings=e}get chatSettings(){return this._chatSettings}set chatSettings(e){this._chatSettings=e}get allowNavigatorDynamicCats(){return this._allowNavigatorDynamicCats}set allowNavigatorDynamicCats(e){this._allowNavigatorDynamicCats=e}get filter(){return this._filter}set filter(e){this._filter=e}get pathfinder(){return this._pathfinder}set pathfinder(e){this._pathfinder=e}static from(e){const t=new zi;return t._roomId=e._roomId,t._name=e._name,t._description=e._description,t._doorMode=e._doorMode,t._categoryId=e._categoryId,t._maximumVisitors=e._maximumVisitors,t._maximumVisitorsLimit=e._maximumVisitorsLimit,t._tags=e._tags,t._tradeMode=e._tradeMode,t._allowPets=e._allowPets,t._allowFoodConsume=e._allowFoodConsume,t._allowWalkThrough=e._allowWalkThrough,t._allowAudio=e._allowAudio,t._allowGif=e._allowGif,t._hideWalls=e._hideWalls,t._wallThickness=e._wallThickness,t._floorThickness=e._floorThickness,t._controllersById=e._controllersById,t._controllerList=e._controllerList,t._highlightedUserId=e._highlightedUserId,t._bannedUsersById=e._bannedUsersById,t._bannedUsersList=e._bannedUsersList,t._roomModerationSettings=e._roomModerationSettings,t._chatSettings=e._chatSettings,t._allowNavigatorDynamicCats=e._allowNavigatorDynamicCats,t._filter=e._filter,t._pathfinder=e._pathfinder,t}static getDoorModeLocalizationKey(e){switch(e){case zi.DOORMODE_OPEN:return"${navigator.door.mode.open}";case zi.DOORMODE_CLOSED:return"${navigator.door.mode.closed}";case zi.DOORMODE_PASSWORD:return"${navigator.door.mode.password}";case zi.DOORMODE_INVISIBLE:return"${navigator.door.mode.invisible}";case zi.DOORMODE_NOOBS_ONLY:return"${navigator.door.mode.noobs_only}"}return""}setFlatController(e,t){this._controllersById.set(e,t),this._controllerList=null,this._highlightedUserId=e}setBannedUser(e,t){this._bannedUsersById.set(e,t),this._bannedUsersList=null}};zi.DOORMODE_OPEN=0,zi.DOORMODE_CLOSED=1,zi.DOORMODE_PASSWORD=2,zi.DOORMODE_INVISIBLE=3,zi.DOORMODE_NOOBS_ONLY=4,zi.TRADEMODE_NOT_ALLOWED=0,zi.TRADEMODE_WITH_CONTROLLER=1,zi.TRADEMODE_ALLOWED=2;let oR=zi;class JW{get data(){return this._roomSettingsData}flush(){return this._roomSettingsData=null,!0}parse(e){if(!e)return!1;this._roomSettingsData=new oR,this._roomSettingsData.roomId=e.readInt(),this._roomSettingsData.name=e.readString(),this._roomSettingsData.description=e.readString(),this._roomSettingsData.doorMode=e.readInt(),this._roomSettingsData.categoryId=e.readInt(),this._roomSettingsData.maximumVisitors=e.readInt(),this._roomSettingsData.maximumVisitorsLimit=e.readInt(),this._roomSettingsData.tags=[];let t=e.readInt();for(;t>0;)this._roomSettingsData.tags.push(e.readString()),t--;return this._roomSettingsData.tradeMode=e.readInt(),this._roomSettingsData.allowPets=e.readInt()===1,this._roomSettingsData.allowFoodConsume=e.readInt()===1,this._roomSettingsData.allowWalkThrough=e.readInt()===1,this._roomSettingsData.hideWalls=e.readInt()===1,this._roomSettingsData.wallThickness=e.readInt(),this._roomSettingsData.floorThickness=e.readInt(),this._roomSettingsData.chatSettings=new Ds(e),this._roomSettingsData.allowNavigatorDynamicCats=e.readBoolean(),this._roomSettingsData.roomModerationSettings=new Zt(e),this._roomSettingsData.allowAudio=e.readInt()===1,this._roomSettingsData.allowGif=e.readInt()===1,this._roomSettingsData.everyoneOpenWireds=e.readInt()===1,this._roomSettingsData.filter=e.readInt(),this._roomSettingsData.pathfinder=e.readInt(),this._roomSettingsData.roomModerationSettings.allowCommands=e.readInt()===1,!0}}class ZW{flush(){return this._roomId=0,this._code=0,!0}parse(e){return e?(this._roomId=e.readInt(),this._code=e.readInt(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}}class e3{flush(){return this._roomId=0,!0}parse(e){return e?(this._roomId=e.readInt(),!0):!1}get roomId(){return this._roomId}}const kr=class kr{flush(){return this._roomId=0,this._code=0,this._message=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._code=e.readInt(),this._message=e.readString(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}get message(){return this._message}};kr.ERROR_ROOM_NOT_FOUND=1,kr.ERROR_NOT_OWNER=2,kr.ERROR_INVALID_DOOR_MODE=3,kr.ERROR_INVALID_USER_LIMIT=4,kr.ERROR_INVALID_PASSWORD=5,kr.ERROR_INVALID_CATEGORY=6,kr.ERROR_INVALID_NAME=7,kr.ERROR_UNACCEPTABLE_NAME=8,kr.ERROR_INVALID_DESCRIPTION=9,kr.ERROR_UNACCEPTABLE_DESCRIPTION=10,kr.ERROR_INVALID_TAG=11,kr.ERROR_NON_USER_CHOOSABLE_TAG=12,kr.ERROR_TOO_MANY_CHARACTERS_IN_TAG=13;let Ug=kr;class t3{flush(){return this._selectionType=0,!0}parse(e){return e?(this._selectionType=e.readInt(),!0):!1}get selectionType(){return this._selectionType}}class s3{flush(){return this._roomId=0,this._userId=0,!0}parse(e){return e?(this._roomId=e.readInt(),this._userId=e.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class i3{flush(){return this._chat=null,!0}parse(e){return e?(this._chat=new Ds(e),!0):!1}get chat(){return this._chat}}const wi=class wi{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._roomId=0,this._roomName=null,this._ownerId=0,this._ownerName=null,this._doorMode=0,this._userCount=0,this._maxUserCount=0,this._description=null,this._tradeMode=2,this._score=0,this._ranking=0,this._categoryId=0,this._totalStars=0,this._groupId=0,this._groupName=null,this._groupBadge=null,this._tags=[],this._bitMask=0,this._thumbnail=null,this._allowPets=!1,this._showOwner=!0,this._displayAd=!1,this._adName=null,this._adDescription=null,this._adExpiresIn=0,this._allInRoomMuted=!1,this._canMute=!1,this._officialRoomPicRef=null,this._hubDJ=!1,this._position=0,!0}parse(e){return e?(this._roomId=e.readInt(),this._roomName=e.readString(),this._ownerId=e.readInt(),this._ownerName=e.readString(),this._doorMode=e.readInt(),this._userCount=e.readInt(),this._maxUserCount=e.readInt(),this._description=e.readString(),this._tradeMode=e.readInt(),this._score=e.readInt(),this._ranking=e.readInt(),this._categoryId=e.readInt(),this._hubDJ=e.readBoolean(),this._position=e.readInt(),this.parseTags(e),this.parseBitMask(e),!0):!1}parseTags(e){if(!e)return!1;this._tags=[];let t=e.readInt();for(;t>0;)this._tags.push(e.readString()),t--;return!0}parseBitMask(e){return e?(this._bitMask=e.readInt(),this._bitMask&wi.THUMBNAIL_BITMASK&&(this._officialRoomPicRef=e.readString()),this._bitMask&wi.GROUPDATA_BITMASK&&(this._groupId=e.readInt(),this._groupName=e.readString(),this._groupBadge=e.readString()),this._bitMask&wi.ROOMAD_BITMASK&&(this._adName=e.readString(),this._adDescription=e.readString(),this._adExpiresIn=e.readInt()),this._showOwner=(this._bitMask&wi.SHOWOWNER_BITMASK)>0,this._allowPets=(this._bitMask&wi.ALLOW_PETS_BITMASK)>0,this._displayAd=(this._bitMask&wi.DISPLAY_ROOMAD_BITMASK)>0,this._thumbnail=null,!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}set roomName(e){this._roomName=e}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get doorMode(){return this._doorMode}get hubDj(){return this._hubDJ}get userCount(){return this._userCount}get maxUserCount(){return this._maxUserCount}get description(){return this._description}get tradeMode(){return this._tradeMode}get score(){return this._score}get ranking(){return this._ranking}get categoryId(){return this._categoryId}get tags(){return this._tags}get officialRoomPicRef(){return this._officialRoomPicRef}get habboGroupId(){return this._groupId}get groupName(){return this._groupName}get groupBadgeCode(){return this._groupBadge}get roomAdName(){return this._adName}get roomAdDescription(){return this._adDescription}get roomAdExpiresInMin(){return this._adExpiresIn}get showOwner(){return this._showOwner}get allowPets(){return this._allowPets}get displayRoomEntryAd(){return this._displayAd}get canMute(){return this._canMute}set canMute(e){this._canMute=e}get allInRoomMuted(){return this._allInRoomMuted}set allInRoomMuted(e){this._allInRoomMuted=e}get position(){return this._position}set position(e){this._position=e}};wi.THUMBNAIL_BITMASK=1,wi.GROUPDATA_BITMASK=2,wi.ROOMAD_BITMASK=4,wi.SHOWOWNER_BITMASK=8,wi.ALLOW_PETS_BITMASK=16,wi.DISPLAY_ROOMAD_BITMASK=32,wi.OPEN_STATE=0,wi.DOORBELL_STATE=1,wi.PASSWORD_STATE=2,wi.INVISIBLE_STATE=3,wi.NOOB_STATE=4;let is=wi;class r3{flush(){return this._roomId=0,this._isOwner=!1,!0}parse(e){return e?(this._roomId=e.readInt(),this._isOwner=e.readBoolean(),!0):!1}get roomId(){return this._roomId}get isOwner(){return this._isOwner}}class n3{flush(){return this._totalLikes=0,this._canLike=!1,!0}parse(e){return e?(this._totalLikes=e.readInt(),this._canLike=e.readBoolean(),!0):!1}get totalLikes(){return this._totalLikes}get canLike(){return this._canLike}}class a3{flush(){return this._roomIndex=-1,this._groupId=-1,this._status=0,this._groupName=null,!0}parse(e){return e?(this._roomIndex=e.readInt(),this._groupId=e.readInt(),this._status=e.readInt(),this._groupName=e.readString(),!0):!1}get roomIndex(){return this._roomIndex}get groupId(){return this._groupId}get status(){return this._status}get groupName(){return this._groupName}}class o3{constructor(e,t,i){this._id=0,this._state=0,this._id=e,this._state=t,this._data=i}get id(){return this._id}get state(){return this._state}get data(){return this._data}}class l3{flush(){return this._code=0,!0}parse(e){return e?(this._code=e.readInt(),!0):!1}get count(){return this._code}}class c3{flush(){return this._itemId=0,this._value=0,!0}parse(e){return e?(this._itemId=e.readInt(),this._value=e.readInt(),!0):!1}get itemId(){return this._itemId}get value(){return this._value}}class Mc{flush(){return this._itemId=0,this._data=null,!0}parse(e){return e?(this._itemId=parseInt(e.readString()),this._data=Mc.parseObjectData(e),!0):!1}static parseObjectData(e){if(!e)return null;const t=ka.getData(e.readInt());return t?(t.parseWrapper(e),t):null}get furnitureId(){return this._itemId}get objectData(){return this._data}}class Bf{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._itemId=0,this._spriteId=0,this._spriteName=null,this._x=0,this._y=0,this._direction=0,this._z=0,this._stackHeight=0,this._extra=0,this._data=null,this._state=0,this._expires=0,this._usagePolicy=0,this._userId=0,this._username=null,this._opacity=10,this._clickable=!0,!0}parse(e){return e?(this._itemId=e.readInt(),this._spriteId=e.readInt(),this._x=e.readInt(),this._y=e.readInt(),this._direction=e.readInt()%8*45,this._z=parseFloat(e.readString()),this._stackHeight=parseFloat(e.readString()),this._extra=e.readInt(),this._data=Mc.parseObjectData(e),this._state=parseFloat(this._data&&this._data.getLegacyString())||0,this._expires=e.readInt(),this._usagePolicy=e.readInt(),this._userId=e.readInt(),this._username=null,this._username=e.readString(),this._opacity=e.readInt(),this._clickable=e.readBoolean(),!0):!1}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}get z(){return isNaN(this._z)?0:this._z}get stackHeight(){return isNaN(this._stackHeight)?0:this._stackHeight}get extra(){return this._extra}get data(){return this._data}get state(){return this._state}get expires(){return this._expires}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(e){this._username=e}get spriteName(){return this._spriteName}set spriteName(e){this._spriteName=e}get opacity(){return this._opacity}get clickable(){return this._clickable}}class u3{flush(){return this._item=null,this._items=[],!0}parse(e){if(!e)return!1;this._items=[];const t=e.readInt();if(t<0)return!1;if(t===1)return this._item=new Bf(e),!0;for(let i=0;i<t;i++)e.bytesAvailable&&this._items.push(new Bf(e));return!0}get item(){return this._item}get items(){return this._items}}class h3{flush(){return this._itemsId=[],this._multiplier=0,this._delay=0,this._clickable=!1,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._itemsId.push(e.readInt()),t--;return this._multiplier=e.readInt(),this._delay=e.readInt(),this._clickable=e.readBoolean(),!0}get itemsId(){return this._itemsId}get delay(){return this._delay}get multiplier(){return this._multiplier}get clickable(){return this._clickable}}class d3{flush(){return this._owners=new Map,this._items=[],!0}parse(e){if(!e||!this.parseOwners(e))return!1;let t=e.readInt();for(;t>0;){const i=new Bf(e);if(!i)continue;const r=this._owners.get(i.userId);r&&(i.username=r),this._items.push(i),t--}return!0}parseOwners(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._owners.set(e.readInt(),e.readString()),t--;return!0}get owners(){return this._owners}get items(){return this._items}}class _3{flush(){return this._itemId=0,this._isExpired=!0,this._userId=0,this._delay=0,this._itemsIds=[],!0}parse(e){if(!e)return!1;this._itemsIds=[];const t=e.readInt();if(t<0)return!1;if(t===1)return this._itemId=parseInt(e.readString()),this._isExpired=e.readBoolean(),this._userId=e.readInt(),this._delay=e.readInt(),!0;for(let i=0;i<t;i++)e.bytesAvailable&&this._itemsIds.push({itemId:parseInt(e.readString()),isExpired:e.readBoolean(),userId:e.readInt(),delay:e.readInt()});return!0}get itemId(){return this._itemId}get isExpired(){return this._isExpired}get userId(){return this._userId}get delay(){return this._delay}get itemsIds(){return this._itemsIds}}class g3{flush(){return this._items=[],!0}parse(e){if(!e)return!1;const t=e.readInt();this._items=[];for(let i=0;i<t;i++)this._items.push(new Bf(e));return!0}get items(){return this._items}}class m3{flush(){return this._isWallItem=!1,this._furniTypeName=null,this._buyout=!1,this._priceInCredits=-1,this._priceInActivityPoints=-1,this._activityPointType=-1,!0}parse(e){return e?(this._isWallItem=e.readBoolean(),this._furniTypeName=e.readString(),this._buyout=e.readBoolean(),this._priceInCredits=e.readInt(),this._priceInActivityPoints=e.readInt(),this._activityPointType=e.readInt(),!0):!1}get isWallItem(){return this._isWallItem}get furniTypeName(){return this._furniTypeName}get buyout(){return this._buyout}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}}class f3{flush(){return this._aliases=new Map,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._aliases.set(e.readString(),e.readString()),t--;return!0}get aliases(){return this._aliases}}class p3{flush(){return this._furniId=-1,this._height=0,!0}parse(e){return e?(this._furniId=e.readInt(),this._height=e.readInt()/100,!0):!1}get furniId(){return this._furniId}get height(){return this._height}}class E3{flush(){return this._objectId=0,this._guildId=0,this._guildName=null,this._guildHomeRoomId=0,this._userIsMember=!1,this._guildHasReadableForum=!1,!0}parse(e){return e?(this._objectId=e.readInt(),this._guildId=e.readInt(),this._guildName=e.readString(),this._guildHomeRoomId=e.readInt(),this._userIsMember=e.readBoolean(),this._guildHasReadableForum=e.readBoolean(),!0):!1}get objectId(){return this._objectId}get guildId(){return this._guildId}get guildName(){return this._guildName}get guildHomeRoomId(){return this._guildHomeRoomId}get userIsMember(){return this._userIsMember}get guildHasReadableForum(){return this._guildHasReadableForum}}class I3{flush(){return this._itemId=0,this._data="",!0}parse(e){return e?(this._itemId=parseInt(e.readString()),this._data=e.readString(),!0):!1}get furnitureId(){return this._itemId}get data(){return this._data}}class T3{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(e){return this._furniId=e.readInt(),!0}}class S3{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(e){return this._furniId=e.readInt(),!0}}class R3{get furniId(){return this._furniId}get start(){return this._start}flush(){return this._furniId=-1,this._start=!1,!0}parse(e){return this._furniId=e.readInt(),this._start=e.readBoolean(),!0}}class x3{flush(){return this._itemId=0,this._state=0,!0}parse(e){return e?(this._itemId=e.readInt(),this._state=e.readInt(),!0):!1}get itemId(){return this._itemId}get state(){return this._state}}class O3{flush(){return!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}class C3{flush(){return!0}parse(e){return e?(this._expiryTime=e.readInt(),!0):!1}get expiryTime(){return this._expiryTime}}const sa=class sa{flush(){return this._renterSpaceId=-1,this._rented=!1,this._renterId=-1,this._renterName=null,this._canRent=!1,this._canRentErrorCode=-1,this._timeRemaining=-1,this._price=-1,!0}parse(e){return e?(this._renterSpaceId=e.readInt(),this._rented=e.readBoolean(),this._canRentErrorCode=e.readInt(),this._canRent=this._canRentErrorCode===0,this._renterId=e.readInt(),this._renterName=e.readString(),this._timeRemaining=e.readInt(),this._price=e.readInt(),this._rented||(this._renterId=-1,this._renterName=""),!0):!1}get rented(){return this._rented}get renterId(){return this._renterId}get renterName(){return this._renterName}get canRent(){return this._canRent}get price(){return this._price}get timeRemaining(){return this._timeRemaining}get canRentErrorCode(){return this._canRentErrorCode}get renterSpaceId(){return this._renterSpaceId}};sa.SPACE_ALREADY_RENTED=100,sa.SPACE_EXTEND_NOT_RENTED=101,sa.SPACE_EXTEND_NOT_RENTED_BY_YOU=102,sa.CAN_RENT_ONLY_ONE_SPACE=103,sa.NOT_ENOUGH_CREDITS=200,sa.NOT_ENOUGH_PIXELS=201,sa.CANT_RENT_NO_PERMISSION=202,sa.CANT_RENT_NO_HABBO_CLUB=203,sa.CANT_RENT=300,sa.CANT_RENT_GENERIC=400;let Ln=sa;class N3{flush(){return this._itemId=-1,this._location="",!0}parse(e){return e?(this._itemId=e.readInt(),this._location=e.readString(),!0):!1}get itemId(){return this._itemId}get location(){return this._location}}class A3{constructor(e,t,i,r){this.id=e,this.type=t,this.color=i,this.brightness=r}}class b3{constructor(){this._selectedPresetId=0,this._presets=[]}flush(){return this._presets=[],!0}parse(e){const t=e.readInt();this._selectedPresetId=e.readInt();for(let i=0;i<t;i++){const r=e.readInt(),n=e.readInt(),o=parseInt(e.readString().substr(1),16),l=e.readInt();this._presets.push(new A3(r,n,o,l))}return!0}getPreset(e){return e<0||e>=this.presetCount?null:this._presets[e]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}}class v3{flush(){return this._roomId=-1,this._roomName=null,this._messageCount=-1,!0}parse(e){return e?(this._roomId=e.readInt(),this._roomName=e.readString(),this._messageCount=e.readInt(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}get messageCount(){return this._messageCount}}class oC{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._itemId=0,this._spriteId=0,this._location=null,this._stuffData=null,this._state=0,this._secondsToExpiration=0,this._usagePolicy=-1,this._userId=0,this._username=null,this._width=0,this._height=0,this._localX=0,this._localY=0,this._y=0,this._z=0,this._direction=null,this._isOldFormat=!1,!0}parse(e){if(!e)return!1;this._itemId=parseInt(e.readString()),this._spriteId=e.readInt(),this._location=e.readString(),this._stuffData=e.readString(),this._secondsToExpiration=e.readInt(),this._usagePolicy=e.readInt(),this._userId=e.readInt(),this._username=null;const t=parseFloat(this._stuffData);if(isNaN(t)||(this._state=Math.trunc(t)),this._location.indexOf(":")===0){this._isOldFormat=!1;let i=this._location.split(" ");if(i.length>=3){let r=i[0],n=i[1];const o=i[2];if(r.length>3&&n.length>2&&(r=r.substr(3),n=n.substr(2),i=r.split(","),i.length>=2)){const l=parseInt(i[0]),c=parseInt(i[1]);if(i=n.split(","),i.length>=2){const u=parseInt(i[0]),d=parseInt(i[1]);this._width=l,this._height=c,this._localX=u,this._localY=d,this._direction=o}}}}else this._isOldFormat=!0;return!0}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get wallPosition(){return this._location}get stuffData(){return this._stuffData}get state(){return this._state}get secondsToExpiration(){return this._secondsToExpiration}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(e){this._username=e}get width(){return this._width}get height(){return this._height}get localX(){return this._localX}get localY(){return this._localY}get direction(){return this._direction}get isOldFormat(){return this._isOldFormat}}class y3{flush(){return this._item=null,!0}parse(e){return e?(this._item=new oC(e),this._item.username=e.readString(),!0):!1}get item(){return this._item}}class D3{flush(){return this._owners=new Map,this._items=[],!0}parse(e){if(!e||!this.parseOwners(e))return!1;let t=e.readInt();for(;t>0;){const i=new oC(e);if(!i)continue;const r=this._owners.get(i.userId);r&&(i.username=r),this._items.push(i),t--}return!0}parseOwners(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._owners.set(e.readInt(),e.readString()),t--;return!0}get owners(){return this._owners}get items(){return this._items}}class M3{constructor(){this.wallItems=[]}flush(){return this._itemId=0,this._userId=0,this.wallItems=[],!0}parse(e){if(!e)return!1;const t=e.readInt();if(t<0)return!1;if(t===1)return this._itemId=parseInt(e.readString()),this._userId=e.readInt(),!0;for(let i=0;i<t;i++)this.wallItems.push({itemId:parseInt(e.readString()),userId:e.readInt()});return!0}get itemId(){return this._itemId}get userId(){return this._userId}getWallItems(){return this.wallItems}}class j3{flush(){return this._item=null,!0}parse(e){return e?(this._item=new oC(e),!0):!1}get item(){return this._item}}class L3{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,this._furniId=-1,this._requestedByUser=!1,!0}parse(e){return e?(this._email=e.readString(),this._isVerified=e.readBoolean(),this._allowChange=e.readBoolean(),this._furniId=e.readInt(),this._requestedByUser=e.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}get furniId(){return this._furniId}get requestedByUser(){return this._requestedByUser}}class P3{parse(e){return this._furniId=e.readInt(),this._commandId=e.readInt(),!0}flush(){return this._furniId=-1,this._commandId=-1,!0}get furniId(){return this._furniId}get commandId(){return this._commandId}}class U3{constructor(e,t,i){this._video=e,this._title=t,this._description=i}get video(){return this._video}get title(){return this._title}get description(){return this._description}}class w3{flush(){return this._furniId=-1,this._playlists=null,this._selectedPlaylistId=null,!0}parse(e){this._furniId=e.readInt();const t=e.readInt();this._playlists=[];for(let i=0;i<t;i++)this._playlists.push(new U3(e.readString(),e.readString(),e.readString()));return this._selectedPlaylistId=e.readString(),!0}get furniId(){return this._furniId}get playlists(){return this._playlists}get selectedPlaylistId(){return this._selectedPlaylistId}}class F3{flush(){return!0}parse(e){return this._furniId=e.readInt(),this._videoId=e.readString(),this._startAtSeconds=e.readInt(),this._endAtSeconds=e.readInt(),this._state=e.readInt(),!0}get furniId(){return this._furniId}get videoId(){return this._videoId}get state(){return this._state}get startAtSeconds(){return this._startAtSeconds}get endAtSeconds(){return this._endAtSeconds}}class k3{flush(){return this._scoreName="",this._virtualId=0,this._variableId=0,this._exhibitionType=0,this._comparatorType=0,this._exhibitionLimit=0,this._columnName="",this._columnPointsName="",this._onlyUsersInRoom=!1,this._filterByValue=!1,this._filterValue=0,this._variables=new Map,!0}parse(e){if(!e)return!1;this._scoreName=e.readString(),this._virtualId=e.readInt(),this._variableId=e.readInt(),this._exhibitionType=e.readInt(),this._comparatorType=e.readInt(),this._exhibitionLimit=e.readInt(),this._columnName=e.readString(),this._columnPointsName=e.readString(),this._onlyUsersInRoom=e.readBoolean(),this._filterByValue=e.readBoolean(),this._filterValue=e.readInt(),this._variables=new Map;const t=e.readInt();for(let i=0;i<t;i++){const r=e.readInt(),n=e.readString();this._variables.set(r,n)}return!0}get scoreName(){return this._scoreName}get virtualId(){return this._virtualId}get variableId(){return this._variableId}get exhibitionType(){return this._exhibitionType}get comparatorType(){return this._comparatorType}get exhibitionLimit(){return this._exhibitionLimit}get columnName(){return this._columnName}get columnPointsName(){return this._columnPointsName}get onlyUsersInRoom(){return this._onlyUsersInRoom}get filterByValue(){return this._filterByValue}get filterValue(){return this._filterValue}get variables(){return this._variables}}class G3{flush(){return this._objects=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const i=e.readInt(),r=Mc.parseObjectData(e),n=parseFloat(r.getLegacyString());this._objects.push(new o3(i,n,r)),t--}return!0}get objects(){return this._objects}}class B3{flush(){return this._rollerId=0,this._itemsRolling=[],this._unitRolling=null,!0}parse(e){if(!e)return!1;const t=e.readInt(),i=e.readInt(),r=e.readInt(),n=e.readInt();let o=e.readInt();for(;o>0;){const _=e.readInt(),m=parseFloat(e.readString()),f=parseFloat(e.readString()),E=new wa(_,new Y(t,i,m),new Y(r,n,f));this._itemsRolling.push(E),o--}if(this._rollerId=e.readInt(),!e.bytesAvailable)return!0;const l=e.readInt(),c=e.readInt(),u=parseFloat(e.readString()),d=parseFloat(e.readString());switch(l){case 0:break;case 1:this._unitRolling=new wa(c,new Y(t,i,u),new Y(r,n,d),wa.MOVE);break;case 2:this._unitRolling=new wa(c,new Y(t,i,u),new Y(r,n,d),wa.SLIDE);break}return!0}get rollerId(){return this._rollerId}get itemsRolling(){return this._itemsRolling}get unitRolling(){return this._unitRolling}}class aD{constructor(e){this._furniId=e.readInt(),this._on=e.readBoolean(),this._rootX=e.readInt(),this._rootY=e.readInt(),this._width=e.readInt(),this._length=e.readInt(),this._invert=e.readBoolean()}get furniId(){return this._furniId}get on(){return this._on}get rootX(){return this._rootX}get rootY(){return this._rootY}get width(){return this._width}get length(){return this._length}get invert(){return this._invert}}const k_=class k_{get model(){return this._model}get width(){return this._width}get height(){return this._height}get heightMap(){return this._heightMap}get wallHeight(){return this._wallHeight}get scale(){return this._scale}get areaHideData(){return this._areaHideData}flush(){return this._model=null,this._width=0,this._height=0,this._wallHeight=-1,this._heightMap=[],this._scale=64,this._model=null,!0}parse(e){if(!e)return!1;const t=e.readBoolean(),i=e.readInt(),r=e.readString(),n=e.readInt(),o=this.parseExplicitly(r,i,t),l=[];for(let c=0;c<n;c++)l.push(new aD(e));return this._areaHideData=l,o}parseModel(e,t,i=!0){return this.parseExplicitly(e,t,i)}getHeight(e,t){if(e<0||e>=this._width||t<0||t>=this._height)return-110;const i=this._heightMap[t];if(i===void 0)return-110;const r=i[e];return r===void 0?-110:r}parseExplicitly(e,t,i=!0){this._scale=i?32:64,this._wallHeight=t,this._model=e;const r=this._model.split("\r"),n=r.length;let o=0,l=0;for(;l<n;){const c=r[l];c.length>o&&(o=c.length),l++}for(this._heightMap=[],l=0;l<n;){const c=[];let u=0;for(;u<o;)c.push(k_.TILE_BLOCKED),u++;this._heightMap.push(c),l++}for(this._width=o,this._height=n,l=0;l<n;){const c=this._heightMap[l],u=r[l];if(u.length>0){let d=0;for(;d<u.length;){const _=u.charAt(d);let m=k_.TILE_BLOCKED;_!=="x"&&_!=="X"&&(m=parseInt(_,36)),c[d]=m,d++}}l++}return!0}};k_.TILE_BLOCKED=-110;let Vf=k_;class V3{flush(){return this._x=0,this._y=0,this._direction=0,!0}parse(e){return e?(this._x=e.readInt(),this._y=e.readInt(),this._direction=e.readInt(),!0):!1}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class Tc{static decodeTileHeight(e){return e&32768?(e|4294901760)/256:e/256}static decodeIsStackingBlocked(e){return!!(e&16384)}static decodeIsRoomTile(e){return e>=0}getTileHeight(e,t){return e<0||e>=this._width||t<0||t>=this._height?-1:Tc.decodeTileHeight(this._heights[t*this._width+e])}getStackingBlocked(e,t){return e<0||e>=this._width||t<0||t>=this._height?!0:Tc.decodeIsStackingBlocked(this._heights[t*this._width+e])}isRoomTile(e,t){return e<0||e>=this._width||t<0||t>=this._height?!1:Tc.decodeIsRoomTile(this._heights[t*this._width+e])}flush(){return this._width=0,this._height=0,this._heights=[],!0}parse(e){if(!e)return!1;this._width=e.readInt();const t=e.readInt();this._height=t/this._width;let i=0;for(;i<t;)this._heights[i]=e.readShort(),i++;return!0}get width(){return this._width}get height(){return this._height}get heights(){return this._heights}}class H3{flush(){return this._wrapper=null,this._count=0,this._x=0,this._y=0,this._value=0,!0}tileHeight(){return Tc.decodeTileHeight(this._value)}isStackingBlocked(){return Tc.decodeIsStackingBlocked(this._value)}isRoomTile(){return Tc.decodeIsRoomTile(this._value)}next(){return this._count?(this._count--,this._x=this._wrapper.readByte(),this._y=this._wrapper.readByte(),this._value=this._wrapper.readShort(),!0):!1}parse(e){return e?(this._wrapper=e,this._count=e.readByte(),!0):!1}get x(){return this._x}get y(){return this._y}get height(){return this._value}}class W3{flush(){return this._blockedTilesMap=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const i=e.readInt(),r=e.readInt();this._blockedTilesMap[r]||(this._blockedTilesMap[r]=[]),this._blockedTilesMap[r][i]=!0,t--}return!0}get blockedTilesMap(){return this._blockedTilesMap}}class Y3{flush(){return this._floorType=null,this._wallType=null,this._landscapeType=null,this._landscapeAnimation=null,!0}parse(e){if(!e)return!1;const t=e.readString(),i=e.readString();switch(t){case"floor":this._floorType=i;break;case"wallpaper":this._wallType=i;break;case"landscape":this._landscapeType=i;break;case"landscapeanim":this._landscapeAnimation=i;break}return!0}get floorType(){return this._floorType}get wallType(){return this._wallType}get landscapeType(){return this._landscapeType}get landscapeAnimation(){return this._landscapeAnimation}}class z3{flush(){return this._name=null,this._roomId=0,!0}parse(e){return e?(this._name=e.readString(),this._roomId=e.readInt(),!0):!1}get name(){return this._name}get roomId(){return this._roomId}}class K3{flush(){return this._hideWalls=!1,this._thicknessWall=0,this._thicknessFloor=0,this._filter=0,!0}parse(e){if(!e)return!1;this._hideWalls=e.readBoolean();let t=e.readInt(),i=e.readInt(),r=e.readInt();return t=t<-2?-2:t>1?1:t,i=i<-2?-2:i>1?1:i,this._thicknessWall=Math.pow(2,t),this._thicknessFloor=Math.pow(2,i),this._filter=r,!0}get hideWalls(){return this._hideWalls}get thicknessWall(){return this._thicknessWall}get thicknessFloor(){return this._thicknessFloor}get filter(){return this._filter}}class lb{constructor(e){if(!e)throw new Error("invalid_wrapper");this._webId=e.readInt(),this._name=e.readString(),this._level=e.readInt(),this._figure=e.readString(),this._owner=e.readString()}dispose(){this._webId=0,this._name="",this._level=0,this._figure="",this._owner=""}get webId(){return this._webId}get name(){return this._name}get level(){return this._level}get figure(){return this._figure}get owner(){return this._owner}}class cb{constructor(e){this._stuffId=e.readInt(),this._classId=e.readInt(),this._productCode=e.readString(),this._userId=e.readInt(),this._userName=e.readString(),this._rarityLevel=e.readInt(),this._hasMutation=e.readBoolean()}get stuffId(){return this._stuffId}get classId(){return this._classId}get productCode(){return this._productCode}get userId(){return this._userId}get userName(){return this._userName}get rarityLevel(){return this._rarityLevel}get hasMutation(){return this._hasMutation}}class q3{flush(){return this._resultData=null,this._otherResultData=null,!0}parse(e){return e?(this._resultData=new cb(e),this._otherResultData=new cb(e),!0):!1}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}}class X3{flush(){return this._petId=-1,this._roomIndex=-1,this._gainedExperience=0,!0}parse(e){return e?(this._petId=e.readInt(),this._roomIndex=e.readInt(),this._gainedExperience=e.readInt(),!0):!1}get petId(){return this._petId}get roomIndex(){return this._roomIndex}get gainedExperience(){return this._gainedExperience}}class $3{flush(){return!0}parse(e){return e?(this._roomIndex=e.readInt(),this._petId=e.readInt(),this._figureData=new cC(e),this._hasSaddle=e.readBoolean(),this._isRiding=e.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get figureData(){return this._figureData}get hasSaddle(){return this._hasSaddle}get isRiding(){return this._isRiding}}class Q3{flush(){return this._id=-1,this._skillThresholds=[],!0}parse(e){if(!e)return!1;this._id=e.readInt(),this._name=e.readString(),this._level=e.readInt(),this._maximumLevel=e.readInt(),this._experience=e.readInt(),this._levelExperienceGoal=e.readInt(),this._energy=e.readInt(),this._maximumEnergy=e.readInt(),this._happyness=e.readInt(),this._maximumHappyness=e.readInt(),this._respect=e.readInt(),this._ownerId=e.readInt(),this._age=e.readInt(),this._ownerName=e.readString(),this._rarityLevel=e.readInt(),this._saddle=e.readBoolean(),this._rider=e.readBoolean();let t=e.readInt();for(;t>0;)this._skillThresholds.push(e.readInt()),t--;return this._skillThresholds.sort(),this._publiclyRideable=e.readInt(),this._breedable=e.readBoolean(),this._fullyGrown=e.readBoolean(),this._dead=e.readBoolean(),this._unknownRarity=e.readInt(),this._maximumTimeToLive=e.readInt(),this._remainingTimeToLive=e.readInt(),this._remainingGrowTime=e.readInt(),this._publiclyBreedable=e.readBoolean(),!0}get id(){return this._id}get name(){return this._name}get level(){return this._level}get maximumLevel(){return this._maximumLevel}get experience(){return this._experience}get energy(){return this._energy}get happyness(){return this._happyness}get levelExperienceGoal(){return this._levelExperienceGoal}get maximumEnergy(){return this._maximumEnergy}get maximumHappyness(){return this._maximumHappyness}get respect(){return this._respect}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get age(){return this._age}get rarityLevel(){return this._rarityLevel}get saddle(){return this._saddle}get rider(){return this._rider}get breedable(){return this._breedable}get fullyGrown(){return this._fullyGrown}get dead(){return this._dead}get maximumTimeToLive(){return this._maximumTimeToLive}get remainingTimeToLive(){return this._remainingTimeToLive}get remainingGrowTime(){return this._remainingGrowTime}get skillTresholds(){return this._skillThresholds}get publiclyRideable(){return this._publiclyRideable}get unknownRarity(){return this._unknownRarity}get publiclyBreedable(){return this._publiclyBreedable}}class J3{flush(){return this._roomIndex=-1,this._petId=-1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,!0}parse(e){return e?(this._roomIndex=e.readInt(),this._petId=e.readInt(),this._canBreed=e.readBoolean(),this._canHarvest=e.readBoolean(),this._canRevive=e.readBoolean(),this._hasBreedingPermission=e.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}}class Z3{constructor(e){if(!e)throw new Error("invalid_wrapper");this._chance=e.readInt(),this._breeds=[];let t=e.readInt();for(;t>0;)this._breeds.push(e.readInt()),t--}dispose(){this._chance=-1,this._breeds=[]}get chance(){return this._chance}get breeds(){return this._breeds}}class e5{flush(){return this._isPlaying=!1,!0}parse(e){return e?(this._isPlaying=e.readBoolean(),!0):!1}get isPlaying(){return this._isPlaying}}class t5{flush(){return!0}parse(e){return!0}}class s5{flush(){return this._seconds=0,!0}parse(e){return e?(this._seconds=e.readInt(),!0):!1}get seconds(){return this._seconds}}class i5{flush(){return this._seconds=0,!0}parse(e){return e?(this._seconds=e.readInt(),!0):!1}get seconds(){return this._seconds}}class lC{flush(){return this._roomIndex=null,this._message=null,this._gesture=0,this._bubble=0,this._urls=[],this._messageLength=0,this._isMention=!1,!0}parse(e){if(!e)return!1;if(this._roomIndex=e.readInt(),this._message=e.readString(),this._gesture=e.readInt(),this._bubble=e.readInt(),this.parseUrls(e),this._messageLength=e.readInt(),e.bytesAvailable&&(this._isMention=e.readBoolean()),this.isMention){const t=this.message.replace("@","").split(" ");t.shift(),this._messageContent=t.join(" "),this._messageContent.startsWith("https://")||(this._messageContent=null)}return!0}parseUrls(e){if(!e)return!1;this._urls=[];let t=e.readInt();for(;t>0;)this._urls.push(e.readString()),t--;return!0}get roomIndex(){return this._roomIndex}get message(){return this._message}get gesture(){return this._gesture}get bubble(){return this._bubble}get urls(){return this._urls}get messageLength(){return this._messageLength}get isMention(){return this._isMention}get messageContent(){return this._messageContent}}class r5{flush(){return this._unitId=null,this._isTyping=!1,!0}parse(e){return e?(this._unitId=e.readInt(),this._isTyping=e.readInt()===1,!0):!1}get unitId(){return this._unitId}get isTyping(){return this._isTyping}}class n5{flush(){return this._unitId=null,this._danceId=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._danceId=e.readInt(),!0):!1}get unitId(){return this._unitId}get danceId(){return this._danceId}}class a5{flush(){return this._unitId=null,this._effectId=0,this._delay=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._effectId=e.readInt(),this._delay=e.readInt(),!0):!1}get unitId(){return this._unitId}get effectId(){return this._effectId}get delay(){return this._delay}}class o5{flush(){return this._unitId=null,this._expression=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._expression=e.readInt(),!0):!1}get unitId(){return this._unitId}get expression(){return this._expression}}class l5{flush(){return this._unitId=null,this._handId=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._handId=e.readInt(),!0):!1}get unitId(){return this._unitId}get handId(){return this._handId}}class c5{flush(){return this._giverUserId=-1,this._handItemType=-1,!0}parse(e){return e?(this._giverUserId=e.readInt(),this._handItemType=e.readInt(),!0):!1}get giverUserId(){return this._giverUserId}get handItemType(){return this._handItemType}}class u5{flush(){return this._unitId=null,this._isIdle=!1,!0}parse(e){return e?(this._unitId=e.readInt(),this._isIdle=e.readBoolean(),!0):!1}get unitId(){return this._unitId}get isIdle(){return this._isIdle}}class h5{flush(){return this._unitId=null,this._figure=null,this._gender="M",this._motto=null,this._achievementScore=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._figure=e.readString(),this._gender=e.readString().toLocaleUpperCase(),this._motto=e.readString(),this._achievementScore=e.readInt(),!0):!1}get unitId(){return this._unitId}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get achievementScore(){return this._achievementScore}}class d5{flush(){return this._unitId=null,this._value=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._value=e.readInt(),!0):!1}get unitId(){return this._unitId}get value(){return this._value}}const XE=class XE{constructor(e){this._roomIndex=0,this._x=0,this._y=0,this._z=0,this._dir=0,this._name="",this._nick="",this._coloredName="",this._userType=0,this._sex="",this._figure="",this._custom="",this._activityPoints=0,this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._subType="",this._ownerId=0,this._ownerName="",this._rarityLevel=0,this._hasSaddle=!1,this._isRiding=!1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,this._petLevel=0,this._petPosture="",this._botSkills=[],this._isModerator=!1,this._isReadOnly=!1,this._roomIndex=e}setReadOnly(){this._isReadOnly=!0}get roomIndex(){return this._roomIndex}get x(){return this._x}set x(e){this._isReadOnly||(this._x=e)}get y(){return this._y}set y(e){this._isReadOnly||(this._y=e)}get z(){return this._z}set z(e){this._isReadOnly||(this._z=e)}get dir(){return this._dir}set dir(e){this._isReadOnly||(this._dir=e)}get name(){return this._name}set name(e){this._isReadOnly||(this._name=e)}get nick(){return this._nick}set nick(e){this._isReadOnly||(this._nick=e)}get coloredName(){return this._coloredName}set coloredName(e){this._isReadOnly||(this._coloredName=e)}get userType(){return this._userType}set userType(e){this._isReadOnly||(this._userType=e)}get sex(){return this._sex}set sex(e){this._isReadOnly||(this._sex=e)}get figure(){return this._figure}set figure(e){this._isReadOnly||(this._figure=e)}get custom(){return this._custom}set custom(e){this._isReadOnly||(this._custom=e)}get activityPoints(){return this._activityPoints}set activityPoints(e){this._isReadOnly||(this._activityPoints=e)}get webID(){return this._webID}set webID(e){this._isReadOnly||(this._webID=e)}get groupID(){return this._groupID}set groupID(e){this._isReadOnly||(this._groupID=e)}get groupName(){return this._groupName}set groupName(e){this._isReadOnly||(this._groupName=e)}get groupStatus(){return this._groupStatus}set groupStatus(e){this._isReadOnly||(this._groupStatus=e)}get subType(){return this._subType}set subType(e){this._isReadOnly||(this._subType=e)}get ownerId(){return this._ownerId}set ownerId(e){this._isReadOnly||(this._ownerId=e)}get ownerName(){return this._ownerName}set ownerName(e){this._isReadOnly||(this._ownerName=e)}get rarityLevel(){return this._rarityLevel}set rarityLevel(e){this._isReadOnly||(this._rarityLevel=e)}get hasSaddle(){return this._hasSaddle}set hasSaddle(e){this._isReadOnly||(this._hasSaddle=e)}get isRiding(){return this._isRiding}set isRiding(e){this._isReadOnly||(this._isRiding=e)}get canBreed(){return this._canBreed}set canBreed(e){this._isReadOnly||(this._canBreed=e)}get canHarvest(){return this._canHarvest}set canHarvest(e){this._isReadOnly||(this._canHarvest=e)}get canRevive(){return this._canRevive}set canRevive(e){this._isReadOnly||(this._canRevive=e)}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(e){this._isReadOnly||(this._hasBreedingPermission=e)}get petLevel(){return this._petLevel}set petLevel(e){this._isReadOnly||(this._petLevel=e)}get petPosture(){return this._petPosture}set petPosture(e){this._isReadOnly||(this._petPosture=e)}get botSkills(){return this._botSkills}set botSkills(e){this._botSkills=e}get isModerator(){return this._isModerator}set isModerator(e){this._isReadOnly||(this._isModerator=e)}};XE.M="M",XE.F="F";let Sh=XE;class _5{flush(){return this._users=[],!0}parse(e){if(!e)return!1;this._users=[];const t=e.readInt();let i=0;for(;i<t;){const r=e.readInt(),n=e.readString(),o=e.readString(),l=e.readString(),c=e.readString();let u=e.readString();const d=e.readInt(),_=e.readInt(),m=e.readInt(),f=parseFloat(e.readString()),E=e.readInt(),I=e.readInt(),p=new Sh(d);if(p.dir=E,p.name=n,p.nick=o,p.coloredName=l,p.custom=c,p.x=_,p.y=m,p.z=f,this._users.push(p),I===1){p.webID=r,p.userType=Xt.USER,p.sex=this.resolveSex(e.readString()),p.groupID=e.readInt(),p.groupStatus=e.readInt(),p.groupName=e.readString();const S=e.readString();S!==""&&(u=this.convertSwimFigure(S,u,p.sex)),p.figure=u,p.activityPoints=e.readInt(),p.isModerator=e.readBoolean()}else if(I===2)p.userType=Xt.PET,p.figure=u,p.webID=r,p.subType=e.readInt().toString(),p.ownerId=e.readInt(),p.ownerName=e.readString(),p.rarityLevel=e.readInt(),p.hasSaddle=e.readBoolean(),p.isRiding=e.readBoolean(),p.canBreed=e.readBoolean(),p.canHarvest=e.readBoolean(),p.canRevive=e.readBoolean(),p.hasBreedingPermission=e.readBoolean(),p.petLevel=e.readInt(),e.bytesAvailable&&(p.petPosture=e.readString());else if(I===3)p.userType=Xt.BOT,p.webID=d*-1,u.indexOf("/")===-1?p.figure=u:p.figure="hr-100-.hd-180-1.ch-876-66.lg-270-94.sh-300-64",p.sex=Sh.M;else if(I===4){p.userType=Xt.RENTABLE_BOT,p.webID=r,p.sex=this.resolveSex(e.readString()),p.figure=u,p.ownerId=e.readInt(),p.ownerName=e.readString();const S=e.readInt();if(S){const R=[];let O=0;for(;O<S;)R.push(e.readShort()),O++;p.botSkills=R}}i++}return!0}resolveSex(e){return e.substr(0,1).toLowerCase()==="f"?Sh.F:Sh.M}convertSwimFigure(e,t,i){const r=t.split(".");let n=1,o=1,l=1;const c=1e4;let u=0;for(;u<r.length;){const f=r[u].split("-");f.length>2&&f[0]==="hd"&&(n=parseInt(f[2])),u++}const d=["238,238,238","250,56,49","253,146,160","42,199,210","53,51,44","239,255,146","198,255,152","255,146,90","157,89,126","182,243,255","109,255,51","51,120,201","255,182,49","223,161,233","249,251,50","202,175,143","197,198,197","71,98,61","138,131,97","255,140,51","84,198,39","30,108,153","152,79,136","119,200,255","255,192,142","60,75,135","124,44,71","215,255,227","143,63,28","255,99,147","31,155,121","253,255,51"],_=e.split("=");if(_.length>1){const m=_[1].split("/");m[0];const f=m[1];i==="F"?l=10010:l=10011;const E=d.indexOf(f);o=c+E+1}return t+(".bds-10001-"+n+".ss-"+l+"-"+o)}get users(){return this._users}}class g5{flush(){return this._unitId=null,this._unitsIds=[],!0}parse(e){if(!e)return!1;this._unitsIds=[];const t=e.readInt();if(t<0)return!1;if(t===1)return this._unitId=parseInt(e.readString()),!0;for(let i=0;i<t;i++)e.bytesAvailable&&this._unitsIds.push(parseInt(e.readString()));return!0}get unitId(){return this._unitId}get unitsIds(){return this._unitsIds}}class m5{constructor(e,t){this._action=e,this._value=t}get action(){return this._action}get value(){return this._value}}class f5{constructor(e,t,i,r,n,o,l,c=0,u=0,d=0,_,m,f,E){this._id=e,this._x=t,this._y=i,this._z=r,this._height=n,this._headDirection=o,this._direction=l,this._targetX=c,this._targetY=u,this._targetZ=d,this._didMove=_,this._canStandUp=m,this._actions=f||[],this._skipPositionUpdate=E}get id(){return this._id}get x(){return this._x}get y(){return this._y}get z(){return this._z}get height(){return this._height}get headDirection(){return this._headDirection}get direction(){return this._direction}get targetX(){return this._targetX}get targetY(){return this._targetY}get targetZ(){return this._targetZ}get didMove(){return this._didMove}get canStandUp(){return this._canStandUp}get actions(){return this._actions}get skipPositionUpdate(){return this._skipPositionUpdate}}class p5{flush(){return this._statuses=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const i=this.parseStatus(e);if(!i){t--;continue}this._statuses.push(i),t--}return!0}parseStatus(e){if(!e)return null;const t=e.readInt(),i=e.readInt(),r=e.readInt(),n=parseFloat(e.readString()),o=e.readInt()%8*45,l=e.readInt()%8*45,c=e.readString();let u=0,d=0,_=0,m=0,f=!1,E=!1,I=!1;if(c){const p=c.split("/"),S=[];for(const R of p){const O=R.split(" ");if(O[0]!==""&&(O[0]==="wf"&&(I=!0),O.length>=2)){switch(O[0]){case"mv":{const C=O[1].split(",");C.length>=3&&(u=parseInt(C[0]),d=parseInt(C[1]),_=parseFloat(C[2]),E=!0);break}case"sit":{const C=parseFloat(O[1]);O.length>=3&&(f=O[2]==="1"),m=C;break}case"lay":{const C=parseFloat(O[1]);m=Math.abs(C);break}}S.push(new m5(O[0],O[1]))}}this._statuses.push(new f5(t,i,r,n,m,o,l,u,d,_,E,f,S,I))}}get statuses(){return this._statuses}}const Yh=class Yh{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._rentable=!1,this._itemId=0,this._furniType=null,this._ref=0,this._spriteId=0,this._category=0,this._stuffData=null,this._isGroupable=!1,this._isRecyclable=!1,this._tradable=!1,this._sellable=!1,this._deletable=!1,this._secondsToExpiration=0,this._extra=0,this._flatId=0,this._isWallItem=!1,this._hasRentPeriodStarted=!1,this._expirationTimeStamp=0,this._slotId="",this._songId=-1,!0}parse(e){return e?(this._itemId=e.readInt(),this._furniType=e.readString(),this._ref=e.readInt(),this._spriteId=e.readInt(),this._category=e.readInt(),this._stuffData=Mc.parseObjectData(e),this._isRecyclable=e.readBoolean(),this._tradable=e.readBoolean(),this._isGroupable=e.readBoolean(),this._sellable=e.readBoolean(),this._deletable=e.readBoolean(),this._secondsToExpiration=e.readInt(),this._expirationTimeStamp=nt(),this.secondsToExpiration>-1?this._rentable=!0:(this._rentable=!1,this._secondsToExpiration=-1),this._hasRentPeriodStarted=e.readBoolean(),this._flatId=e.readInt(),this._isWallItem=this._furniType===Yh.WALL_ITEM,this._furniType===Yh.FLOOR_ITEM&&(this._slotId=e.readString(),this._extra=e.readInt()),!0):!1}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get isGroupable(){return this._isGroupable}get isRecycleable(){return this._isRecyclable}get tradable(){return this._tradable}get sellable(){return this._sellable}get deletable(){return this._deletable}get secondsToExpiration(){return this._secondsToExpiration}get flatId(){return this._flatId}get slotId(){return this._slotId}get songId(){return this._songId}get extra(){return this._extra}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get creationDay(){return 0}get creationMonth(){return 0}get creationYear(){return 0}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}};Yh.WALL_ITEM="I",Yh.FLOOR_ITEM="S";let Hf=Yh;class E5{flush(){return this._items=[],!0}parse(e){return e?(this._items.push(new Hf(e)),!0):!1}get items(){return this._items}}class I5{flush(){return!0}parse(e){return!!e}}class T5{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=new Map,!0}parse(e){if(!e)return!1;this._totalFragments=e.readInt(),this._fragmentNumber=e.readInt();let t=e.readInt();for(;t>0;){const i=new Hf(e);i&&this._fragment.set(i.itemId,i),t--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class S5{flush(){return this._itemId=0,!0}parse(e){return e?(this._itemId=e.readInt(),!0):!1}get itemId(){return this._itemId}}class R5{flush(){return this._itemId=0,this._itemsLeft=0,!0}parse(e){return e?(this._itemId=e.readInt(),this._itemsLeft=e.readInt(),!0):!1}get itemId(){return this._itemId}get itemsLeft(){return this._itemsLeft}}class x5{flush(){return this._itemType="",this._classId=0,this._productCode="",!0}parse(e){return e?(this._itemType=e.readString(),this._classId=e.readInt(),this._productCode=e.readString(),this._placedItemId=e.readInt(),this._placedItemType=e.readString(),this._placedInRoom=e.readBoolean(),this._petFigureString=e.readString(),!0):!1}get itemType(){return this._itemType}get classId(){return this._classId}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedItemType(){return this._placedItemType}get placedInRoom(){return this._placedInRoom}get petFigureString(){return this._petFigureString}}class O5{flush(){this._nestId=0,this._pet1&&(this._pet1.dispose(),this._pet1=null),this._pet2&&(this._pet2.dispose(),this._pet2=null);for(const e of this._rarityCategories)e&&e.dispose();return this._rarityCategories=[],!0}parse(e){if(!e)return!1;this._nestId=e.readInt(),this._pet1=new lb(e),this._pet2=new lb(e);let t=e.readInt();for(;t>0;)this._rarityCategories.push(new Z3(e)),t--;return this._resultPetType=e.readInt(),!0}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetType(){return this._resultPetType}}class C5{flush(){return this._breedingNestStuffId=0,this._result=0,!0}parse(e){return e?(this._breedingNestStuffId=e.readInt(),this._result=e.readInt(),!0):!1}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}}const fA=class fA{flush(){return!0}parse(e){return this._reason=e.readInt(),!0}get reason(){return this._reason}};fA.PET_TOO_TIRED_TO_BREED=6;let ub=fA;class N5{flush(){return this._petId=-1,this._rarityCategory=-1,!0}parse(e){return this._petId=e.readInt(),this._rarityCategory=e.readInt(),!0}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}}class cC{constructor(e){this._typeId=e.readInt(),this._paletteId=e.readInt(),this._color=e.readString(),this._breedId=e.readInt(),this._customParts=[],this._customPartCount=e.readInt();let t=0;for(;t<this._customPartCount;)this._customParts.push(e.readInt()),this._customParts.push(e.readInt()),this._customParts.push(e.readInt()),t++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get breedId(){return this._breedId}get figuredata(){let e=this.typeId+" "+this.paletteId+" "+this.color;e=e+(" "+this.custompartCount);for(const t of this.customParts)e=e+(" "+t);return e}get customParts(){return this._customParts}get custompartCount(){return this._customPartCount}}class nT{constructor(e){if(!e)throw new Error("invalid_wrapper");this._id=e.readInt(),this._name=e.readString(),this._figureData=new cC(e),this._level=e.readInt()}get id(){return this._id}get name(){return this._name}get typeId(){return this._figureData.typeId}get paletteId(){return this._figureData.paletteId}get color(){return this._figureData.color}get breedId(){return this._figureData.breedId}get customPartCount(){return this._figureData.custompartCount}get figureString(){return this._figureData.figuredata}get figureData(){return this._figureData}get level(){return this._level}}class A5{flush(){return this._pet=null,this._boughtAsGift=!1,!0}parse(e){return this._pet=new nT(e),this._boughtAsGift=e.readBoolean(),!0}get pet(){return this._pet}get boughtAsGift(){return this._boughtAsGift}}const G_=class G_{flush(){return this._state=0,this._ownPetId=0,this._otherPetId=0,!0}parse(e){return e?(this._state=e.readInt(),this._ownPetId=e.readInt(),this._otherPetId=e.readInt(),!0):!1}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}};G_.STATE_CANCEL=1,G_.STATE_ACCEPT=2,G_.STATE_REQUEST=3;let lR=G_;class b5{flush(){return this._fragment=null,!0}parse(e){this._totalFragments=e.readInt(),this._fragmentNumber=e.readInt();let t=e.readInt();for(this._fragment=new Map;t>0;){const i=new nT(e);this._fragment.set(i.id,i),t--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class v5{flush(){return this._boughtAsGift=!1,this._pet=null,!0}parse(e){return this._boughtAsGift=e.readBoolean(),this._pet=new nT(e),!0}get boughtAsGift(){return this._boughtAsGift}get pet(){return this._pet}}class y5{flush(){return!0}parse(e){return e?(this._petId=e.readInt(),!0):!1}get petId(){return this._petId}}class D5{constructor(e){this._itemId=e.readInt(),this._furniType=e.readString().toUpperCase(),this._ref=e.readInt(),this._spriteId=e.readInt(),this._category=e.readInt(),this._isGroupable=e.readBoolean(),this._stuffData=Mc.parseObjectData(e),this._secondsToExpiration=-1,this._expirationTimeStamp=nt(),this._hasRentPeriodStarted=!1,this._creationDay=e.readInt(),this._creationMonth=e.readInt(),this._creationYear=e.readInt(),this._extra=this.furniType==="S"?e.readInt():-1,this._flatId=-1,this._rentable=!1,this._isWallItem=this._furniType==="I"}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get secondsToExpiration(){return this._secondsToExpiration}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get isGroupable(){return this._isGroupable}get songId(){return this._extra}get flatId(){return this._flatId}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get isRecycleable(){return!0}get tradable(){return!0}get sellable(){return!0}get deletable(){return!0}get slotId(){return null}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}}class M5{flush(){return this._userID=-1,this._userAccepts=!1,!0}parse(e){return e?(this._userID=e.readInt(),this._userAccepts=e.readInt()>0,!0):!1}get userID(){return this._userID}get userAccepts(){return this._userAccepts}}const pA=class pA{flush(){return!0}parse(e){return e?(this._userId=e.readInt(),this._reason=e.readInt(),!0):!1}get userID(){return this._userId}get reason(){return this._reason}};pA.ERROR_WHILE_COMMIT=1;let Wf=pA;class j5{flush(){return!0}parse(e){return!!e}}class L5{flush(){return!0}parse(e){return!!e}}class P5{flush(){return this._firstUserID=-1,this._firstUserItemArray=null,this._firstUserNumItems=0,this._firstUserNumCredits=0,this._secondUserID=-1,this._secondUserItemArray=null,this._secondUserNumItems=0,this._secondUserNumCredits=0,!0}parse(e){return!e||(this._firstUserID=e.readInt(),this._firstUserItemArray=[],!this.parseItems(e,this._firstUserItemArray))||(this._firstUserNumItems=e.readInt(),this._firstUserNumCredits=e.readInt(),this._secondUserID=e.readInt(),this._secondUserItemArray=[],!this.parseItems(e,this._secondUserItemArray))?!1:(this._secondUserNumItems=e.readInt(),this._secondUserNumCredits=e.readInt(),!0)}parseItems(e,t){let i=e.readInt();for(;i>0;)t.push(new D5(e)),i--;return!0}get firstUserID(){return this._firstUserID}get firstUserItemArray(){return this._firstUserItemArray}get firstUserNumItems(){return this._firstUserNumItems}get firstUserNumCredits(){return this._firstUserNumCredits}get secondUserID(){return this._secondUserID}get secondUserItemArray(){return this._secondUserItemArray}get secondUserNumItems(){return this._secondUserNumItems}get secondUserNumCredits(){return this._secondUserNumCredits}}class U5{flush(){return!0}parse(e){return!!e}}class w5{flush(){return!0}parse(e){return!!e}}const $E=class $E{flush(){return!0}parse(e){return e?(this._reason=e.readInt(),this._otherUserName=e.readString(),!0):!1}get reason(){return this._reason}get otherUserName(){return this._otherUserName}};$E.REASON_YOU_ARE_ALREADY_TRADING=7,$E.REASON_OTHER_USER_ALREADY_TRADING=8;let cR=$E;class F5{flush(){return this._userId=-1,this._userCanTrade=!1,this._otherUserId=-1,this._otherUserCanTrade=!1,!0}parse(e){return e?(this._userId=e.readInt(),this._userCanTrade=e.readInt()===1,this._otherUserId=e.readInt(),this._otherUserCanTrade=e.readInt()===1,!0):!1}get userID(){return this._userId}get userCanTrade(){return this._userCanTrade}get otherUserID(){return this._otherUserId}get otherUserCanTrade(){return this._otherUserCanTrade}}class k5{flush(){return!0}parse(e){return!!e}}class G5{flush(){return!0}parse(e){return!!e}}class B5{flush(){return this._respect=0,this._petOwnerId=0,this._petData=null,!0}parse(e){return e?(this._respect=e.readInt(),this._petOwnerId=e.readInt(),this._petData=new nT(e),!0):!1}get respect(){return this._respect}get petOwnerId(){return this._petOwnerId}get petData(){return this._petData}get isTreat(){return this._petData.typeId===ui.MONSTERPLANT}}class V5{flush(){return this._petId=0,this._userId=0,this._supplementType=0,!0}parse(e){return e?(this._petId=e.readInt(),this._userId=e.readInt(),this._supplementType=e.readInt(),!0):!1}get petId(){return this._petId}get userId(){return this._userId}get supplementType(){return this._supplementType}}const du=class du{};du.WATER=0,du.LIGHT=1,du.REVIVE=2,du.REBREED_FERTILIZER=3,du.SPEED_FERTILIZER=4;let h_=du;class H5{flush(){return this._userId=0,this._respectsReceived=0,!0}parse(e){return e?(this._userId=e.readInt(),this._respectsReceived=e.readInt(),!0):!1}get userId(){return this._userId}get respectsReceived(){return this._respectsReceived}}class W5{constructor(e,t,i){this._hasControllers=!1,this._roomId=e,this._roomName=t,this._hasControllers=i}get roomId(){return this._roomId}get roomName(){return this._roomName}get hasControllers(){return this._hasControllers}}class Y5{constructor(e){this._currentHcStreak=e.readInt(),this._firstSubscriptionDate=e.readString(),this._kickbackPercentage=e.readDouble(),this._totalCreditsMissed=e.readInt(),this._totalCreditsRewarded=e.readInt(),this._totalCreditsSpent=e.readInt(),this._creditRewardForStreakBonus=e.readInt(),this._creditRewardForMonthlySpent=e.readInt(),this._timeUntilPayday=e.readInt()}get currentHcStreak(){return this._currentHcStreak}get firstSubscriptionDate(){return this._firstSubscriptionDate}get kickbackPercentage(){return this._kickbackPercentage}get totalCreditsMissed(){return this._totalCreditsMissed}get totalCreditsRewarded(){return this._totalCreditsRewarded}get totalCreditsSpent(){return this._totalCreditsSpent}get creditRewardForStreakBonus(){return this._creditRewardForStreakBonus}get creditRewardForMonthlySpent(){return this._creditRewardForMonthlySpent}get timeUntilPayday(){return this._timeUntilPayday}}class z5{flush(){return this._data=null,!0}parse(e){return this._data=new Y5(e),!0}get data(){return this._data}}class K5{flush(){return this._kissesLeft=0,!0}parse(e){return e?(this._kissesLeft=e.readInt(),!0):!1}get kissesLeft(){return this._kissesLeft}}class q5{constructor(e,t,i){this.id=e,this.name=t,this.classname=i}}class X5{flush(){return this._roomId=0,this._itemId=0,this._totalItems=0,this._teleporters=[],!0}parse(e){if(!e)return!1;this._roomId=e.readInt(),this._itemId=e.readInt(),this._totalItems=e.readInt();for(let t=0;t<this._totalItems;t++){const i=new q5(e.readInt(),e.readString(),e.readString());this._teleporters.push(i)}return!0}get roomId(){return this._roomId}get itemId(){return this._itemId}get totalItems(){return this._totalItems}get teleporters(){return this._teleporters}}class $5{flush(){return this._forcedHeight=0,!0}parse(e){return e?(this._forcedHeight=Number(e.readString()),!0):!1}get forcedHeight(){return this._forcedHeight}}class Q5{get vipTimestamp(){return this._vipTimestamp}flush(){return this._vipTimestamp=0,!0}parse(e){return e?(this._vipTimestamp=e.readInt(),!0):!1}}class J5{flush(){return this._looks=new Map,!0}parse(e){if(!e)return!1;e.readInt();let t=e.readInt();for(;t>0;){const i=e.readInt(),r=e.readString(),n=e.readString();this._looks.set(i,[r,n]),t--}return!0}get looks(){return this._looks}}class Z5{flush(){return this._looks=new Map,!0}parse(e){if(!e)return!1;const t=e.readInt();for(let i=0;i<t;i++){let r=(e.readInt()-1)*10,n=e.readInt();for(;n>0;){const o=r+e.readInt(),l=e.readString(),c=e.readString();this._looks.set(o,[l,c]),n--}}return!0}get looks(){return this._looks}}class eY{flush(){return this._result=-1,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}}class tY{flush(){return this._username="",!0}parse(e){return e?(this._username=e.readString(),!0):!1}get username(){return this._username}}class sY{constructor(e){this._amount=e.readInt(),this._type=this._amount>=0?"EARN":"SPEND",this._balance_after=e.readInt(),this._source=e.readString(),this._created_at=Number(e.readString())}get amount(){return this._amount}get type(){return this._type}get balance_after(){return this._balance_after}get source(){return this._source}get created_at(){return this._created_at}}class iY{flush(){return this._userTransactionsData=[],!0}parse(e){if(!e)return!1;const t=e.readInt();this._userTransactionsData=new Array(t);for(let i=0;i<t;i++)this._userTransactionsData[i]=new sY(e);return!0}get userTransactionsData(){return this._userTransactionsData}}class rY{flush(){return this._isVip=!1,this._rooms=[],!0}parse(e){if(!e)return!1;this._isVip=e.readBoolean();let t=e.readInt();for(;t>0;)this._rooms.push(new W5(e.readInt(),e.readString(),e.readBoolean())),t--;return!0}get isVip(){return this._isVip}get rooms(){return this._rooms}}class nY{flush(){return this._pageId=-1,this._data=null,!0}parse(e){return e?(this._pageId=e.readInt(),this._data=new rT(e),!0):!1}get pageId(){return this._pageId}get data(){return this._data}}class aY{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._type=-1,this._breedId=-1,this._paletteId=-1,this._sellable=!1,this._rare=!1,!0}parse(e){return e?(this._type=e.readInt(),this._breedId=e.readInt(),this._paletteId=e.readInt(),this._sellable=e.readBoolean(),this._rare=e.readBoolean(),!0):!1}get type(){return this._type}get breedId(){return this._breedId}get paletteId(){return this._paletteId}get sellable(){return this._sellable}get rare(){return this._rare}}class oY{flush(){return this._productCode="",this._palettes=[],!0}parse(e){if(!e)return!1;this._productCode=e.readString();let t=e.readInt();for(;t>0;)this._palettes.push(new aY(e)),t--;return!0}get productCode(){return this._productCode}get palettes(){return this._palettes}}class lY{constructor(e){this._trackingState=e.readInt(),this._id=e.readInt(),this._identifier=e.readString(),this._productCode=e.readString(),this._priceInCredits=e.readInt(),this._priceInActivityPoints=e.readInt(),this._activityPointType=e.readInt(),this._purchaseLimit=e.readInt();const t=e.readInt();this._expirationTime=t>0?t*1e3+Date.now():0,this._title=e.readString(),this._description=e.readString(),this._imageUrl=e.readString(),this._iconImageUrl=e.readString(),this._type=e.readInt(),this._subProductCodes=[];let i=e.readInt();for(;i>0;)this._subProductCodes.push(e.readString()),i--;return this}populate(e){e&&(this._id=e.id,this._identifier=e.identifier,this._type=e.type,this._title=e.title,this._description=e.description,this._imageUrl=e.imageUrl,this._iconImageUrl=e.iconImageUrl,this._productCode=e.productCode,this._purchaseLimit=e.purchaseLimit,this._expirationTime=e.expirationTime,this._priceInCredits=e.priceInCredits,this._priceInActivityPoints=e.priceInActivityPoints,this._activityPointType=e.activityPointType,this._subProductCodes=e.subProductCodes,this._trackingState=e.trackingState)}purchase(e){this._purchaseLimit=this._purchaseLimit-e}get id(){return this._id}get identifier(){return this._identifier}get type(){return this._type}get title(){return this._title}get description(){return this._description}get imageUrl(){return this._imageUrl}get iconImageUrl(){return this._iconImageUrl}get productCode(){return this._productCode}get purchaseLimit(){return this._purchaseLimit}get expirationTime(){return this._expirationTime}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get subProductCodes(){return this._subProductCodes}get trackingState(){return this._trackingState}}class cY{flush(){return!0}parse(e){return!!e}}class uY{flush(){return this._data=null,!0}parse(e){return e?(this._data=new lY(e),!0):!1}get data(){return this._data}}class hY{constructor(){this._errorCode=""}flush(){return this._errorCode="",!0}parse(e){return e?(this._errorCode=e.readString(),!0):!1}get errorCode(){return this._errorCode}}class dY{constructor(){this._productName="",this._productDescription=""}flush(){return this._productDescription="",this._productName="",!0}parse(e){return e?(this._productDescription=e.readString(),this._productName=e.readString(),!0):!1}get productName(){return this._productName}get productDescription(){return this._productDescription}}class _Y{flush(){return!0}parse(e){return!!e}}class gY{flush(){return this._requestId=0,!0}parse(e){return e?(this._requestId=e.readInt(),!0):!1}get requestId(){return this._requestId}}const nl=class nl{flush(){return this._goalId=0,this._goalCode=null,this._result=0,this._requiredFurnis=null,this._missingFurnis=null,!0}parse(e){this._goalId=e.readInt(),this._goalCode=e.readString(),this._result=e.readInt(),this._requiredFurnis=[];let t=e.readInt();for(;t>0;)this._requiredFurnis.push(e.readString()),t--;for(t=e.readInt();t>0;)this._missingFurnis[e.readString()]="",t--;return!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get result(){return this._result}get requiredFurnis(){return this._requiredFurnis}isMissing(e){return!!this._missingFurnis[e]}};nl.SUBMITTED=0,nl.ASK_FOR_SUBMIT=1,nl.ASK_FOR_CONFIRM=2,nl.PREREQUISITES_NOT_MET=3,nl.ROOM_DOOR_NOT_OPEN=4,nl.ROOM_TOO_OLD=5,nl.ASK_FOR_ACCEPT_RULES=6;let uR=nl;const B_=class B_{};B_.ALLOWED=0,B_.REQUIRED_PERK_MISSING=1,B_.REQUIRED_BADGE_MISSING=2;let hR=B_;class mY{flush(){return this._goalId=0,this._goalCode=null,this._resultCode=0,this._votesRemaining=0,!0}parse(e){return this._goalId=e.readInt(),this._goalCode=e.readString(),this._resultCode=e.readInt(),this._votesRemaining=e.readInt(),!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get isVotingAllowedForUser(){return this._resultCode===hR.ALLOWED}get votesRemaining(){return this._votesRemaining}get resultCode(){return this._resultCode}}class fY{flush(){return this._schedulingStr=null,this._code=null,!0}parse(e){return this._schedulingStr=e.readString(),this._code=e.readString(),!0}get schedulingStr(){return this._schedulingStr}get code(){return this._code}}class pY{flush(){return this._isPartOf=!1,this._targetId=0,!0}parse(e){return this._isPartOf=e.readBoolean(),this._targetId=e.readInt(),!0}get isPartOf(){return this._isPartOf}get targetId(){return this._targetId}}class EY{flush(){return!0}parse(e){return!0}}class IY{flush(){return this._timeStr=null,this._secondsUntil=0,!0}parse(e){return this._timeStr=e.readString(),this._secondsUntil=e.readInt(),!0}get timeStr(){return this._timeStr}get secondsUntil(){return this._secondsUntil}}class oD{constructor(e){this._recipeName=e.readString(),this._itemName=e.readString()}get recipeName(){return this._recipeName}get itemName(){return this._itemName}}class TY{constructor(){this._recipes=[],this._ingredients=[]}flush(){return this._recipes=[],this._ingredients=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let r=0;r<t;r++)this._recipes.push(new oD(e));const i=e.readInt();for(let r=0;r<i;r++)this._ingredients.push(e.readString());return!0}get recipes(){return this._recipes}get ingredients(){return this._ingredients}isActive(){return this._recipes.length>0||this._ingredients.length>0}}class SY{constructor(e){this._count=e.readInt(),this._itemName=e.readString()}get count(){return this._count}get itemName(){return this._itemName}}class RY{constructor(){this._ingredients=[]}parse(e){if(!e)return!1;const t=e.readInt();for(let i=0;i<t;i++)this._ingredients.push(new SY(e));return!0}flush(){return this._ingredients=[],!0}get ingredients(){return this._ingredients}}class xY{parse(e){return e?(this._count=e.readInt(),this._hasRecipes=e.readBoolean(),!0):!1}flush(){return this._count=0,this._hasRecipes=!1,!0}get count(){return this._count}get hasRecipes(){return this._hasRecipes}}class OY{parse(e){return e?(this._success=e.readBoolean(),this._success&&(this._result=new oD(e)),!0):!1}flush(){return this._success=!1,!0}get success(){return this._success}get result(){return this._result}}class CY{flush(){return!0}parse(e){return!!e}}class NY{constructor(e){if(!e)throw new Error("invalid_wrapper");this._senderId=e.readInt(),this._errorCode=e.readInt()}get senderId(){return this._senderId}get errorCode(){return this._errorCode}}class AY{flush(){return this._failuers=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._failuers.push(new NY(e)),t--;return!0}get failures(){return this._failuers}}class bY{flush(){return this._success=!1,!0}parse(e){return e?(this._success=e.readBoolean(),!0):!1}get success(){return this._success}}class vY{flush(){return this._errorCode=0,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}class lD{constructor(e){if(!e)throw new Error("invalid_wrapper");this._id=e.readInt(),this._name=e.readString()}get id(){return this._id}get name(){return this._name}}class dR{constructor(e){if(!e)throw new Error("invalid_wrapper");this._id=e.readInt(),this._name=e.readString(),this._gender=e.readInt(),this._online=e.readBoolean(),this._followingAllowed=e.readBoolean(),this._figure=e.readString(),this._categoryId=e.readInt(),this._motto=e.readString(),this._realName=e.readString(),this._lastAccess=e.readString(),this._persistedMessageUser=e.readBoolean(),this._vipMember=e.readBoolean(),this._pocketHabboUser=e.readBoolean(),this._relationshipStatus=e.readShort()}get id(){return this._id}get name(){return this._name}get gender(){return this._gender}get online(){return this._online}get followingAllowed(){return this._followingAllowed}get figure(){return this._figure}get categoryId(){return this._categoryId}get motto(){return this._motto}get lastAccess(){return this._lastAccess}get realName(){return this._realName}get persistedMessageUser(){return this._persistedMessageUser}get vipMember(){return this._vipMember}get pocketHabboUser(){return this._pocketHabboUser}get relationshipStatus(){return this._relationshipStatus}}class yY{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=[],!0}parse(e){if(!e)return!1;this._totalFragments=e.readInt(),this._fragmentNumber=e.readInt();let t=e.readInt();for(;t>0;)this._fragment.push(new dR(e)),t--;return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class DY{flush(){return this._categories=[],this._removedFriendIds=[],this._addedFriends=[],this._updatedFriends=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._categories.push(new lD(e)),t--;let i=e.readInt();for(;i>0;){const r=e.readInt();r===-1?this._removedFriendIds.push(e.readInt()):r===0?this._updatedFriends.push(new dR(e)):r===1&&this._addedFriends.push(new dR(e)),i--}return!0}get categories(){return this._categories}get removedFriendIds(){return this._removedFriendIds}get addedFriends(){return this._addedFriends}get updatedFriends(){return this._updatedFriends}}class MY{flush(){return this._typeCode=-1,this._avatarId=0,this._message=null,!0}parse(e){return e?(this._typeCode=e.readInt(),this._avatarId=e.readInt(),this._message=e.readString(),!0):!1}get typeCode(){return this._typeCode}get avatarId(){return this._avatarId}get message(){return this._message}}class cD{constructor(e){if(!e)throw new Error("invalid_wrapper");this._requestId=e.readInt(),this._requesterName=e.readString(),this._figureString=e.readString(),this._requesterUserId=this._requestId}get requestId(){return this._requestId}get requesterName(){return this._requesterName}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class jY{flush(){return this._totalRequests=0,this._requests=[],!0}parse(e){if(!e)return!1;this._totalRequests=e.readInt();let t=e.readInt();for(;t>0;)this._requests.push(new cD(e)),t--;return!0}get totalRequests(){return this._totalRequests}get requests(){return this._requests}}class hb{constructor(e){if(!e)throw new Error("invalid_wrapper");this._avatarId=e.readInt(),this._avatarName=e.readString(),this._avatarMotto=e.readString(),this._isAvatarOnline=e.readBoolean(),this._canFollow=e.readBoolean(),this._lastOnlineData=e.readString(),this._avatarGender=e.readInt(),this._avatarFigure=e.readString(),this._realName=e.readString()}get avatarId(){return this._avatarId}get avatarName(){return this._avatarName}get avatarMotto(){return this._avatarMotto}get isAvatarOnline(){return this._isAvatarOnline}get canFollow(){return this._canFollow}get avatarGender(){return this._avatarGender}get avatarFigure(){return this._avatarFigure}get lastOnlineData(){return this._lastOnlineData}get realName(){return this._realName}}class LY{flush(){return this._friends=[],this._others=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._friends.push(new hb(e)),t--;let i=e.readInt();for(;i>0;)this._others.push(new hb(e)),i--;return!0}get friends(){return this._friends}get others(){return this._others}}class PY{flush(){return this._errorCode=0,this._userId=0,this._message=null,!0}parse(e){return e?(this._errorCode=e.readInt(),this._userId=e.readInt(),this._message=e.readString(),!0):!1}get errorCode(){return this._errorCode}get userId(){return this._userId}get message(){return this._message}}class UY{flush(){return this._clientMessageId=0,this._errorCode=0,!0}parse(e){return e?(this._clientMessageId=e.readInt(),this._errorCode=e.readInt(),!0):!1}get clientMessageId(){return this._clientMessageId}get errorCode(){return this._errorCode}}class wY{flush(){return this._userFriendLimit=0,this._normalFriendLimit=0,this._extendedFriendLimit=0,this._categories=[],!0}parse(e){if(!e)return!1;this._userFriendLimit=e.readInt(),this._normalFriendLimit=e.readInt(),this._extendedFriendLimit=e.readInt();let t=e.readInt();for(;t>0;)this._categories.push(new lD(e)),t--;return!0}get userFriendLimit(){return this._userFriendLimit}get normalFriendLimit(){return this._normalFriendLimit}get extendedFriendLimit(){return this._extendedFriendLimit}get categories(){return this._categories}}class FY{flush(){return!0}parse(e){return!!e}}class kY{flush(){return this._count=0,!0}parse(e){return e?(this._count=e.readInt(),!0):!1}get count(){return this._count}}class GY{flush(){return this._senderId=0,this._messageText=null,this._secondsSinceSent=0,this._extraData=null,!0}parse(e){return e?(this._senderId=e.readInt(),this._messageText=e.readString(),this._secondsSinceSent=e.readInt(),e.bytesAvailable&&(this._extraData=e.readString()),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}}class BY{flush(){return this._request=null,!0}parse(e){return e?(this._request=new cD(e),!0):!1}get request(){return this._request}}class VY{flush(){return this._errorCode=0,this._failedRecipients=[],!0}parse(e){if(!e)return!1;this._errorCode=e.readInt();let t=e.readInt();for(;t>0;)this._failedRecipients.push(e.readInt()),t--;return!0}get errorCode(){return this._errorCode}get failedRecipients(){return this._failedRecipients}}class HY{flush(){return this._senderId=0,this._messageText=null,!0}parse(e){return e?(this._senderId=e.readInt(),this._messageText=e.readString(),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}}class WY{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._freeGamesLeft=e.readInt(),this._gamesPlayedTotal=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get freeGamesLeft(){return this._freeGamesLeft}get gamesPlayedTotal(){return this._gamesPlayedTotal}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}const zh=class zh{flush(){return this._status=-1,this._blockLength=-1,this._gamesPlayed=-1,this._freeGamesLeft=-1,!0}parse(e){return e?(this._status=e.readInt(),this._blockLength=e.readInt(),this._gamesPlayed=e.readInt(),this._freeGamesLeft=e.readInt(),!0):!1}get status(){return this._status}get blockLength(){return this._blockLength}get gamesPlayed(){return this._gamesPlayed}get freeGamesLeft(){return this._freeGamesLeft}get hasUnlimitedGames(){return this._freeGamesLeft==-1}};zh.STATUS_OK=0,zh.STATUS_FAILED_REASON_UNKNOWN=1,zh.STATUS_FAILED_REASON_GAME_DIRECTORY_IS_NOT_AVAILABLE=2,zh.STATUS_FAILED_REASON_HOTEL_IS_CLOSED=3;let _R=zh;class YY{flush(){return this._position=-1,!0}parse(e){return e?(this._position=e.readInt(),!0):!1}get position(){return this._position}}const lo=class lo{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}};lo.KICKED=1,lo.DUPLICATE_MACHINEID=2,lo.INVITATION_REQUIRED=3,lo.NO_SPACE_IN_TEAM=4,lo.TEAM_NOT_FOUND=5,lo.USER_HAS_ACTIVE_INSTANCE=6,lo.USER_HAS_PENDING_INSTANCE_REQUEST=7,lo.USER_HAS_NO_FREE_GAMES_LEFT=8;let gR=lo;const QE=class QE{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}};QE.NOT_ENOUGH_PLAYERS=1,QE.GAME_HAS_NO_OWNER=2;let mR=QE;class zY{flush(){return!0}parse(e){return!!e}}class KY{flush(){return this._userId=-1,!0}parse(e){return e?(this._userId=e.readInt(),!0):!1}get userId(){return this._userId}}class qY{flush(){return!0}parse(e){return e?(this._stuffCode=e.readString(),this._badgeCode=e.readString(),!0):!1}get stuffCode(){return this._stuffCode}get badgeCode(){return this._badgeCode}}class XY{flush(){return this._stuffId=-1,this._achievementId=0,this._requiredLevelBadgeCode="",this._userProgress=0,this._totalProgress=0,this._endTime=0,!0}parse(e){return e?(this._stuffId=e.readInt(),this._achievementId=e.readInt(),this._requiredLevelBadgeCode=e.readString(),this._userProgress=e.readInt(),this._totalProgress=e.readInt(),this._endTime=e.readInt(),!0):!1}get stuffId(){return this._stuffId}get achievementId(){return this._achievementId}get requiredLevelBadgeCode(){return this._requiredLevelBadgeCode}get userProgress(){return this._userProgress}get totalProgress(){return this._totalProgress}get endTime(){return this._endTime}}class $Y{flush(){return!0}parse(e){if(!e)return!1;this._stuffId=e.readInt();const t=e.readInt();let i=0;for(;i<t;)this._achievements.push(new aR(e)),i++;return this._endTime=e.readInt(),!0}get stuffId(){return this._stuffId}get achievements(){return this._achievements}get endTime(){return this._endTime}}class QY{constructor(e,t,i,r){this._gameTypeId=e,this._achievementId=t,this._achievementName=i,this._levels=r}get gameTypeId(){return this._gameTypeId}get achievementId(){return this._achievementId}get achievementName(){return this._achievementName}get levels(){return this._levels}}class JY{flush(){return!0}parse(e){if(!e)return!1;this._achievements=[];const t=e.readInt();let i=0;for(;i<t;){const r=e.readInt(),n=e.readInt();let o=0;for(;o<n;){const l=e.readInt(),c=e.readString(),u=e.readInt();this._achievements.push(new QY(r,l,c,u)),o++}i++}return!0}get achievements(){return this._achievements}}class ZY{constructor(e,t,i,r,n,o){this._gameId=e,this._gameNameId=t,this._bgColor=i,this._textColor=r,this._assetUrl=n,this._supportUrl=o}get gameId(){return this._gameId}get gameNameId(){return this._gameNameId}get bgColor(){return this._bgColor}get textColor(){return this._textColor}get assetUrl(){return this._assetUrl}get supportUrl(){return this._supportUrl}}class ez{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._inviterId=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get inviterId(){return this._inviterId}}class tz{flush(){return!0}parse(e){if(!e)return!1;this._games=[];const t=e.readInt();for(let i=0;i<t;i++){const r=e.readInt(),n=e.readString(),o=e.readString();let l=parseInt(o,16);l=l|4278190080;const c=e.readString();let u=parseInt(c,16);u=u|4278190080;const d=e.readString(),_=e.readString();this._games.push(new ZY(r,n,l,u,d,_))}return!0}get games(){return this._games}}const Kh=class Kh{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._status=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get isOk(){return this._status==Kh.OK}get isInMaintenance(){return this._status==Kh.MAINTENANCE}};Kh.OK=0,Kh.MAINTENANCE=1;let fR=Kh;class sz{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}const EA=class EA{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._reason=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get reason(){return this._reason}};EA.DUPLICATE_MACHINEID=1;let pR=EA;class iz{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class rz{flush(){return!0}parse(e){if(!e)return!1;this._gameTypeId=e.readInt(),this._gameClientId=e.readString(),this._url=e.readString(),this._quality=e.readString(),this._scaleMode=e.readString(),this._frameRate=e.readInt(),this._minMajorVersion=e.readInt(),this._minMinorVersion=e.readInt(),this._params=new Map;const t=e.readInt();let i=0;for(;i<t;)this._params.set(e.readString(),e.readString()),i++;return!0}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get quality(){return this._quality}get scaleMode(){return this._scaleMode}get frameRate(){return this._frameRate}get minMajorVersion(){return this._minMajorVersion}get minMinorVersion(){return this._minMinorVersion}get params(){return this._params}get gameClientId(){return this._gameClientId}}class nz{flush(){return this._gameTypeId=0,this._url=null,this._gameClientId=null,!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._gameClientId=e.readString(),this._url=e.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get gameClientId(){return this._gameClientId}}class az{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._gameClientId=e.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get gameClientId(){return this._gameClientId}}class oz{flush(){return!0}parse(e){return!!e}}class aT{flush(){return this._year=-1,this._week=-1,this._maxOffset=-1,this._currentOffset=-1,this._minutesUntilReset=-1,!0}parse(e){return e?(this._year=e.readInt(),this._week=e.readInt(),this._maxOffset=e.readInt(),this._currentOffset=e.readInt(),this._minutesUntilReset=e.readInt(),!0):!1}get year(){return this._year}get week(){return this._week}get maxOffset(){return this._maxOffset}get currentOffset(){return this._currentOffset}get minutesUntilReset(){return this._minutesUntilReset}}class lz{constructor(e){this._name=e.readString(),this._figure=e.readString(),this._gender=e.readString(),this._rank=e.readInt(),this._score=e.readInt()}get name(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get rank(){return this._rank}get score(){return this._score}}class cz{flush(){return this._gameTypeId=-1,this._products=[],this._minutesUntilNextWeek=0,this._rewardingOn=!0,!0}parse(e){if(!e)return!1;this._gameTypeId=e.readInt();let t=e.readInt();for(;t>0;)this._products.push(new Fa(e)),t--;return this._minutesUntilNextWeek=e.readInt(),this._rewardingOn=e.readBoolean(),!0}get gameTypeId(){return this._gameTypeId}get products(){return this._products}get minutesUntilNextWeek(){return this._minutesUntilNextWeek}get rewardingOn(){return this._rewardingOn}}class uz{flush(){return this._gameTypeId=-1,this._winners=[],!0}parse(e){if(!e)return!1;this._gameTypeId=e.readInt();let t=e.readInt();for(;t>0;)this._winners.push(new lz(e)),t--;return!0}get gameTypeId(){return this._gameTypeId}get winners(){return this._winners}}class hz{flush(){return this._errorCode=0,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}class dz{flush(){return this._phoneStatusCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(e){return e?(this._phoneStatusCode=e.readInt(),this._collectionStatusCode=e.readInt(),this._millisecondsToAllowProcessReset=e.readInt(),!0):!1}get phoneStatusCode(){return this._phoneStatusCode}get collectionStatusCode(){return this._collectionStatusCode}get millisecondsToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class _z{flush(){return this._resultCode=-1,!0}parse(e){return e?(this._resultCode=e.readInt(),this._millisToAllowProcessReset=e.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisToAllowProcessReset}}class gz{flush(){return this._resultCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(e){return e?(this._resultCode=e.readInt(),this._millisecondsToAllowProcessReset=e.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class mz{flush(){return this._bases=new Map,this._symbols=new Map,this._partColors=new Map,this._colorsA=new Map,this._colorsB=new Map,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const l=e.readInt(),c=e.readString(),u=e.readString();this._bases.set(l,[c,u]),t--}let i=e.readInt();for(;i>0;){const l=e.readInt(),c=e.readString(),u=e.readString();this._symbols.set(l,[c,u]),i--}let r=e.readInt();for(;r>0;){const l=e.readInt(),c=e.readString();this._partColors.set(l,c),r--}let n=e.readInt();for(;n>0;){const l=e.readInt(),c=e.readString();this._colorsA.set(l,c),n--}let o=e.readInt();for(;o>0;){const l=e.readInt(),c=e.readString();this._colorsB.set(l,c),o--}return!0}get bases(){return this._bases}get symbols(){return this._symbols}get partColors(){return this._partColors}get colorsA(){return this._colorsA}get colorsB(){return this._colorsB}}class fz{flush(){return this._groupCost=0,this._availableRooms=new Map,!0}parse(e){if(!e)return!1;this._groupCost=e.readInt();let t=e.readInt();for(;t>0;){const i=e.readInt(),r=e.readString();e.readBoolean(),this._availableRooms.set(i,r),t--}return!0}get groupCost(){return this._groupCost}get availableRooms(){return this._availableRooms}}class pz{flush(){return this._userId=0,this._furnitureCount=0,!0}parse(e){return e?(this._userId=e.readInt(),this._furnitureCount=e.readInt(),!0):!1}get userId(){return this._userId}get furnitureCount(){return this._furnitureCount}}class Ez{flush(){return this._id=0,this._type=0,this._title=null,this._description=null,this._badge=null,this._roomId=0,this._roomName=null,this._membershipType=0,this._membersCount=0,this._isFavorite=!1,this._createdAt=null,this._isOwner=!1,this._isAdmin=!1,this._ownerName=null,this._flag=!1,this._canMembersDecorate=!1,this._pendingRequestsCount=0,this._hasForum=!1,!0}parse(e){return e?(this._id=e.readInt(),e.readBoolean(),this._type=e.readInt(),this._title=e.readString(),this._description=e.readString(),this._badge=e.readString(),this._roomId=e.readInt(),this._roomName=e.readString(),this._membershipType=e.readInt(),this._membersCount=e.readInt(),this._isFavorite=e.readBoolean(),this._createdAt=e.readString(),this._isOwner=e.readBoolean(),this._isAdmin=e.readBoolean(),this._ownerName=e.readString(),this._flag=e.readBoolean(),this._canMembersDecorate=e.readBoolean(),this._pendingRequestsCount=e.readInt(),this._hasForum=e.readBoolean(),!0):!1}get id(){return this._id}get type(){return this._type}get title(){return this._title}get description(){return this._description}get badge(){return this._badge}get roomId(){return this._roomId}get roomName(){return this._roomName}get membershipType(){return this._membershipType}get membersCount(){return this._membersCount}get isFavorite(){return this._isFavorite}get createdAt(){return this._createdAt}get isOwner(){return this._isOwner}get isAdmin(){return this._isAdmin}get ownerName(){return this._ownerName}get flag(){return this._flag}get canMembersDecorate(){return this._canMembersDecorate}get pendingRequestsCount(){return this._pendingRequestsCount}get hasForum(){return this._hasForum}}class Iz{constructor(e){this.isBase=e,this.key=0,this.color=0,this.position=4}get code(){return this.key===0?null:(this.isBase?"b":"s")+(this.key<100?"0":"")+(this.key<10?"0":"")+this.key+(this.color<10?"0":"")+this.color+this.position}}const _u=class _u{};_u.OWNER=0,_u.ADMIN=1,_u.MEMBER=2,_u.REQUESTED=3,_u.DELETED=4;let nr=_u;class Tz{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._rank=-1,this._id=0,this._name=null,this._figure=null,this._joinedAt=null,!0}parse(e){return e?(this._rank=e.readInt(),this._id=e.readInt(),this._name=e.readString(),this._figure=e.readString(),this._joinedAt=e.readString(),!0):!1}get id(){return this._id}get name(){return this._name}get figure(){return this._figure}get rank(){return this._rank}get joinedAt(){return this._joinedAt}}class Sz{flush(){return this._groupId=0,this._groupTitle=null,this._roomId=0,this._badge=null,this._totalMembersCount=0,this._result=[],this._admin=!1,this._pageSize=0,this._pageIndex=0,this._level=0,this._query=null,!0}parse(e){if(!e)return!1;this._groupId=e.readInt(),this._groupTitle=e.readString(),this._roomId=e.readInt(),this._badge=e.readString(),this._totalMembersCount=e.readInt();let t=e.readInt();for(;t>0;)this._result.push(new Tz(e)),t--;return this._admin=e.readBoolean(),this._pageSize=e.readInt(),this._pageIndex=e.readInt(),this._level=e.readInt(),this._query=e.readString(),!0}get groupId(){return this._groupId}get groupTitle(){return this._groupTitle}get roomId(){return this._roomId}get badge(){return this._badge}get totalMembersCount(){return this._totalMembersCount}get result(){return this._result}get admin(){return this._admin}get pageSize(){return this._pageSize}get pageIndex(){return this._pageIndex}get level(){return this._level}get query(){return this._query}}class Rz{flush(){return this._roomId=0,this._groupId=0,!0}parse(e){return e?(this._roomId=e.readInt(),this._groupId=e.readInt(),!0):!1}get roomId(){return this._roomId}get guildId(){return this._groupId}}class xz{flush(){return this._roomId=0,this._roomName=null,this._id=0,this._title=null,this._description=null,this._colorA=0,this._colorB=0,this._state=0,this._canMembersDecorate=!1,this._badgeParts=new Map,this._badgeCode=null,this._membersCount=0,!0}parse(e){if(!e)return!1;e.readInt()===1&&(this._roomId=e.readInt(),this._roomName=e.readString(),e.readBoolean()),e.readBoolean(),this._id=e.readInt(),this._title=e.readString(),this._description=e.readString(),e.readInt(),this._colorA=e.readInt(),this._colorB=e.readInt(),this._state=e.readInt(),this._canMembersDecorate=e.readInt()===0,e.readBoolean(),e.readString();const i=e.readInt();for(let r=0;r<i;r++){const n=new Iz(r===0);n.key=e.readInt(),n.color=e.readInt(),n.position=e.readInt(),n.key===0&&(n.position=4),this._badgeParts.set(r,n)}return this._badgeCode=e.readString(),this._membersCount=e.readInt(),!0}get roomId(){return this._roomId}get roomName(){return this._roomName}get id(){return this._id}get title(){return this._title}get description(){return this._description}get colorA(){return this._colorA}get colorB(){return this._colorB}get state(){return this._state}get canMembersDecorate(){return this._canMembersDecorate}get badgeParts(){return this._badgeParts}get badgeCode(){return this._badgeCode}get membersCount(){return this._membersCount}}class Oz{flush(){return!0}parse(e){return this._groupId=e.readInt(),!0}get groupId(){return this._groupId}}class wg{static parse(e){return this.fillFromMessage(new wg,e)}static fillFromMessage(e,t){return e._groupId=t.readInt(),e._name=t.readString(),e._description=t.readString(),e._icon=t.readString(),e._totalThreads=t.readInt(),e._leaderboardScore=t.readInt(),e._totalMessages=t.readInt(),e._unreadMessages=t.readInt(),e._lastMessageId=t.readInt(),e._lastMessageAuthorId=t.readInt(),e._lastMessageAuthorName=t.readString(),e._lastMessageTimeAsSecondsAgo=t.readInt(),e}get groupId(){return this._groupId}get name(){return this._name}get description(){return this._description}get icon(){return this._icon}get totalThreads(){return this._totalThreads}get leaderboardScore(){return this._leaderboardScore}get totalMessages(){return this._totalMessages}get unreadMessages(){return this._unreadMessages}get lastMessageId(){return this._lastMessageId}get lastMessageAuthorId(){return this._lastMessageAuthorId}get lastMessageAuthorName(){return this._lastMessageAuthorName}get lastMessageTimeAsSecondsAgo(){return this._lastMessageTimeAsSecondsAgo}updateFrom(e){this._totalThreads=e._totalThreads,this._totalMessages=e._totalMessages,this._unreadMessages=e._unreadMessages,this._lastMessageAuthorId=e._lastMessageAuthorId,this._lastMessageAuthorName=e._lastMessageAuthorName,this._lastMessageId=e._lastMessageId,this._lastMessageTimeAsSecondsAgo=e._lastMessageTimeAsSecondsAgo}get lastReadMessageId(){return this._totalMessages-this._unreadMessages}set lastReadMessageId(e){this._unreadMessages=this._totalMessages-e,this._unreadMessages<0&&(this._unreadMessages=0)}addNewThread(e){this._lastMessageAuthorId=e.lastUserId,this._lastMessageAuthorName=e.lastUserName,this._lastMessageId=e.lastMessageId,this._lastMessageTimeAsSecondsAgo=e.lastCommentTime,this._totalThreads++,this._totalMessages++,this._unreadMessages=0}}class uC extends wg{static parse(e){const t=new uC;return wg.fillFromMessage(t,e),t._readPermissions=e.readInt(),t._postMessagePermissions=e.readInt(),t._postThreadPermissions=e.readInt(),t._moderatePermissions=e.readInt(),t._readPermissionError=e.readString(),t._postMessagePermissionError=e.readString(),t._postThreadPermissionError=e.readString(),t._moderatePermissionError=e.readString(),t._reportPermissionError=e.readString(),t._canChangeSettings=e.readBoolean(),t._isStaff=e.readBoolean(),t}get readPermissions(){return this._readPermissions}get postMessagePermissions(){return this._postMessagePermissions}get postThreadPermissions(){return this._postThreadPermissions}get moderatePermissions(){return this._moderatePermissions}get hasReadPermissionError(){return this._readPermissionError.length===0}get canReport(){return!0}get hasPostMessagePermissionError(){return this._postMessagePermissionError.length===0}get hasPostThreadPermissionError(){return this._postThreadPermissionError.length===0}get hasModeratePermissionError(){return this._moderatePermissionError.length===0}get canChangeSettings(){return this._canChangeSettings}get isStaf(){return this._isStaff}get readPermissionError(){return this._readPermissionError}get postMessagePermissionError(){return this._postMessagePermissionError}get postThreadPermissionError(){return this._postThreadPermissionError}get moderatePermissionError(){return this._moderatePermissionError}get reportPermissionError(){return this._reportPermissionError}}class Cz{flush(){return this._extendedForumData=null,!0}parse(e){return e?(this._extendedForumData=uC.parse(e),!0):!1}get extendedForumData(){return this._extendedForumData}}class Nz{flush(){return this._listCode=-1,this._totalAmount=0,this._startIndex=-1,this._amount=0,this._forums=[],!0}parse(e){if(!e)return!1;this._listCode=e.readInt(),this._totalAmount=e.readInt(),this._startIndex=e.readInt(),this._amount=e.readInt(),this._forums=[];let t=0;for(;t<this._amount;)this._forums.push(wg.parse(e)),t++;return!0}get listCode(){return this._listCode}get totalAmount(){return this._totalAmount}get startIndex(){return this._startIndex}get amount(){return this._amount}get forums(){return this._forums}}class um{static parse(e){const t=new um;return t._threadId=e.readInt(),t._authorId=e.readInt(),t._authorName=e.readString(),t._header=e.readString(),t._isPinned=e.readBoolean(),t._isLocked=e.readBoolean(),t._creationTimeAsSecondsAgo=e.readInt(),t._totalMessages=e.readInt(),t._unreadMessagesCount=e.readInt(),t._lastMessageId=e.readInt(),t._lastUserId=e.readInt(),t._lastUserName=e.readString(),t._lastCommentTime=e.readInt(),t._state=e.readByte(),t._adminId=e.readInt(),t._adminName=e.readString(),t._adminOperationTimeAsSecondsAgo=e.readInt(),t}get adminOperationTimeAsSecondsAgo(){return this._adminOperationTimeAsSecondsAgo}set adminOperationTimeAsSecondsAgo(e){this._adminOperationTimeAsSecondsAgo=e}get lastCommentTime(){return this._lastCommentTime}set lastCommentTime(e){this._lastCommentTime=e}get threadId(){return this._threadId}set threadId(e){this._threadId=e}get authorId(){return this._authorId}set authorId(e){this._authorId=e}get authorName(){return this._authorName}set authorName(e){this._authorName=e}get creationTimeAsSecondsAgo(){return this._creationTimeAsSecondsAgo}set creationTimeAsSecondsAgo(e){this._creationTimeAsSecondsAgo=e}get header(){return this._header}set header(e){this._header=e}get lastMessageId(){return this._lastMessageId}set lastMessageId(e){this._lastMessageId=e}get lastUserId(){return this._lastUserId}set lastUserId(e){this._lastUserId=e}get lastUserName(){return this._lastUserName}set lastUserName(e){this._lastUserName=e}get totalMessages(){return this._totalMessages}set totalMessages(e){this._totalMessages=e}get unreadMessagesCount(){return this._unreadMessagesCount}set unreadMessagesCount(e){this._unreadMessagesCount=e}get state(){return this._state}set state(e){this._state=e}get adminId(){return this._adminId}set adminId(e){this._adminId=e}get adminName(){return this._adminName}set adminName(e){this._adminName=e}get isPinned(){return this._isPinned}set isPinned(e){this._isPinned=e}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked=e}}class Az{flush(){return this._groupId=-1,this._startIndex=-1,this._amount=0,this._threads=[],!0}parse(e){if(!e)return!1;this._groupId=e.readInt(),this._startIndex=e.readInt(),this._amount=e.readInt(),this._threads=[];let t=0;for(;t<this._amount;)this._threads.push(um.parse(e)),t++;return!0}get groupId(){return this._groupId}get startIndex(){return this._startIndex}get amount(){return this._amount}get threads(){return this._threads}}class hm{static parse(e){const t=new hm;return t._messageId=e.readInt(),t._messageIndex=e.readInt(),t._authorId=e.readInt(),t._authorName=e.readString(),t._authorFigure=e.readString(),t._creationTime=e.readInt(),t._messageText=e.readString(),t._state=e.readByte(),t._adminId=e.readInt(),t._adminName=e.readString(),t._adminOperationTimeAsSeccondsAgo=e.readInt(),t._authorPostCount=e.readInt(),t}get state(){return this._state}set state(e){this._state=e}get adminId(){return this._adminId}set adminId(e){this._adminId=e}get adminName(){return this._adminName}set adminName(e){this._adminName=e}get adminOperationTimeAsSeccondsAgo(){return this._adminOperationTimeAsSeccondsAgo}set adminOperationTimeAsSeccondsAgo(e){this._adminOperationTimeAsSeccondsAgo=e}get messageId(){return this._messageId}set messageId(e){this._messageId=e}get creationTime(){return this._creationTime}set creationTime(e){this._creationTime=e}get authorName(){return this._authorName}set authorName(e){this._authorName=e}get authorFigure(){return this._authorFigure}set authorFigure(e){this._authorFigure=e}get threadId(){return this._threadId}set threadId(e){this._threadId=e}get messageIndex(){return this._messageIndex}set messageIndex(e){this._messageIndex=e}set groupID(e){this._groupId=e}get groupId(){return this._groupId}get authorId(){return this._authorId}set authorId(e){this._authorId=e}get messageText(){return this._messageText}set messageText(e){this._messageText=e}get authorPostCount(){return this._authorPostCount}set authorPostCount(e){this._authorPostCount=e}}class bz{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._threadId=e.readInt(),this._message=hm.parse(e),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class vz{flush(){return this._groupId=-1,this._thread=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._thread=um.parse(e),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class yz{flush(){return this._groupId=-1,this._threadId=-1,this._startIndex=-1,this._amount=0,this._messages=[],!0}parse(e){if(!e)return!1;this._groupId=e.readInt(),this._threadId=e.readInt(),this._startIndex=e.readInt(),this._amount=e.readInt(),this._messages=[];let t=0;for(;t<this._amount;){const i=hm.parse(e);i.groupID=this._groupId,i.threadId=this._threadId,this._messages.push(i),t++}return!0}get groupId(){return this._groupId}get threadId(){return this._threadId}get startIndex(){return this._startIndex}get amount(){return this._amount}get messages(){return this._messages}}class Dz{flush(){return this._count=0,!0}parse(e){return e?(this._count=e.readInt(),!0):!1}get count(){return this._count}}class Mz{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._threadId=e.readInt(),this._message=hm.parse(e),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class jz{flush(){return this._groupId=-1,this._thread=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._thread=um.parse(e),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class Lz{constructor(){this._encryptedPublicKey=null,this._serverClientEncryption=!1}flush(){return!0}parse(e){return e?(this._encryptedPublicKey=e.readString(),e.bytesAvailable&&(this._serverClientEncryption=e.readBoolean()),!0):!1}get encryptedPublicKey(){return this._encryptedPublicKey}get serverClientEncryption(){return this._serverClientEncryption}}class Pz{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=0,e.bytesAvailable&&(this._reason=e.readInt()),!0):!1}get reason(){return this._reason}}class Uz{flush(){return this._accounts&&(this._accounts=new Map),!0}parse(e){if(!e)return!1;this._accounts=new Map;let t=e.readInt();for(;t>0;)this._accounts.set(e.readInt(),e.readString()),t--;return!0}get accounts(){return this._accounts}}class wz{flush(){return!0}parse(e){return e?(this._encryptedPrime=e.readString(),this._encryptedGenerator=e.readString(),!0):!1}get encryptedPrime(){return this._encryptedPrime}get encryptedGenerator(){return this._encryptedGenerator}}class Fz{flush(){return this._noobnessLevel=0,!0}parse(e){return e?(this._noobnessLevel=e.readInt(),!0):!1}get noobnessLevel(){return this._noobnessLevel}}class kz{flush(){return!0}parse(e){return e?(this._infoUrl=e.readString(),!0):!1}get infoUrl(){return this._infoUrl}}class Gz{flush(){return!0}parse(e){return!0}}class Bz{flush(){return this._calls=[],!0}parse(e){this._calls=[];const t=e.readInt();for(let i=0;i<t;i++){const r=e.readString(),n=e.readString(),o=e.readString();this._calls.push({callId:r,timeStamp:n,message:o})}return!0}get pendingCalls(){return this._calls}get count(){return this._calls.length}}class Vz{flush(){return this._message=null,!0}parse(e){return this._message=e.readString(),!0}get message(){return this._message}}class Hz{flush(){return this._resultType=0,this._messageText=null,!0}parse(e){return e?(this._resultType=e.readInt(),this._messageText=e.readString(),!0):!1}get resultType(){return this._resultType}get messageText(){return this._messageText}}class Wz{flush(){return!0}parse(e){return!0}}class Yz{flush(){return this._acceptanceTimeout=-1,!0}parse(e){return this._acceptanceTimeout=e.readInt(),!0}get acceptanceTimeout(){return this._acceptanceTimeout}}class zz{flush(){return this._winningVoteCode=-1,this._ownVoteCode=-1,this._finalStatus=null,!0}parse(e){this._finalStatus=[],this._winningVoteCode=e.readInt(),this._ownVoteCode=e.readInt();const t=e.readInt();for(let i=0;i<t;i++)this._finalStatus.push(e.readInt());return!0}get winningVoteCode(){return this._winningVoteCode}get ownVoteCode(){return this._ownVoteCode}get finalStatus(){return this._finalStatus}}class Kz{flush(){return!0}parse(e){return this._votingTimeout=e.readInt(),this._chatRecord=e.readString(),!0}get votingTimeout(){return this._votingTimeout}get chatRecord(){return this._chatRecord}}const Kl=class Kl{flush(){return this._status=null,!0}parse(e){this._status=[];const t=e.readInt();for(let i=0;i<t;i++)this._status.push(e.readInt());return!0}get status(){return this._status}};Kl.AWAITING_VOTE=0,Kl.VOTED_OK=1,Kl.VOTED_BAD=2,Kl.VOTED_VERY_BAD=3,Kl.NO_VOTE=4,Kl.FINDING_NEW_VOTER=5;let ER=Kl;class qz{flush(){return this._onDuty=!1,this._guidesOnDuty=0,this._helpersOnDuty=0,this._guardiansOnDuty=0,!0}parse(e){return e?(this._onDuty=e.readBoolean(),this._guidesOnDuty=e.readInt(),this._helpersOnDuty=e.readInt(),this._guardiansOnDuty=e.readInt(),!0):!1}get onDuty(){return this._onDuty}get guidesOnDuty(){return this._guidesOnDuty}get helpersOnDuty(){return this._helpersOnDuty}get guardiansOnDuty(){return this._guardiansOnDuty}}class Xz{constructor(e,t,i,r,n,o,l){this._type=e,this._secondsAgo=t,this._isGuide=i,this._otherPartyName=r,this._otherPartyFigure=n,this._description=o,this._roomName=l}get type(){return this._type}set type(e){this._type=e}get secondsAgo(){return this._secondsAgo}set secondsAgo(e){this._secondsAgo=e}get isGuide(){return this._isGuide}set isGuide(e){this._isGuide=e}get otherPartyName(){return this._otherPartyName}set otherPartyName(e){this._otherPartyName=e}get otherPartyFigure(){return this._otherPartyFigure}set otherPartyFigure(e){this._otherPartyFigure=e}get description(){return this._description}set description(e){this._description=e}get roomName(){return this._roomName}set roomName(e){this._roomName=e}}const qh=class qh{flush(){return this._statusCode=0,this._pendingTicket=null,!0}parse(e){return e?(this._statusCode=e.readInt(),this._pendingTicket=new Xz(e.readInt(),e.readInt(),e.readBoolean(),e.readString(),e.readString(),e.readString(),e.readString()),!0):!1}get statusCode(){return this._statusCode}get pendingTicket(){return this._pendingTicket}};qh.GUIDE_REPORTING_STATUS_OK=0,qh.GUIDE_REPORTING_STATUS_PENDING_TICKET=1,qh.GUIDE_REPORTING_STATUS_ABUSIVE=2,qh.GUIDE_REPORTING_STATUS_REPORTING_TOO_QUICKLY=3;let IR=qh;class $z{flush(){return this._asGuide=!1,this._helpRequestType=0,this._helpRequestDescription=null,this._roleSpecificWaitTime=0,!0}parse(e){return e?(this._asGuide=e.readBoolean(),this._helpRequestType=e.readInt(),this._helpRequestDescription=e.readString(),this._roleSpecificWaitTime=e.readInt(),!0):!1}get asGuide(){return this._asGuide}get helpRequestType(){return this._helpRequestType}get helpRequestDescription(){return this._helpRequestDescription}get roleSpecificWaitTime(){return this._roleSpecificWaitTime}}class Qz{flush(){return!0}parse(e){return!!e}}class Jz{flush(){return this._endReason=0,!0}parse(e){return e?(this._endReason=e.readInt(),!0):!1}get endReason(){return this._endReason}}const gu=class gu{flush(){return this._errorCode=0,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}};gu.ERROR_GENERIC=0,gu.ERROR_GUIDES_REJECT=1,gu.ERROR_NOT_ENOUGH_GUIDES=2,gu.ERROR_NOT_ENOUGH_VOTES=3,gu.ERROR_NO_CHATLOG_FOUND=4;let TR=gu;class Zz{flush(){return this._roomId=0,this._roomName=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._roomName=e.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class e4{flush(){return this._chatMessage=null,this._senderId=0,!0}parse(e){return e?(this._chatMessage=e.readString(),this._senderId=e.readInt(),!0):!1}get chatMessage(){return this._chatMessage}get senderId(){return this._senderId}}class t4{flush(){return this._isTyping=!1,!0}parse(e){return e?(this._isTyping=e.readBoolean(),!0):!1}get isTyping(){return this._isTyping}}class s4{flush(){return this._requesterRoomId=0,!0}parse(e){return e?(this._requesterRoomId=e.readInt(),!0):!1}get requesterRoomId(){return this._requesterRoomId}}class i4{flush(){return this._requesterUserId=0,this._requesterName=null,this._requesterFigure=null,this._guideUserId=0,this._guideName=null,this._guideFigure=null,!0}parse(e){return e?(this._requesterUserId=e.readInt(),this._requesterName=e.readString(),this._requesterFigure=e.readString(),this._guideUserId=e.readInt(),this._guideName=e.readString(),this._guideFigure=e.readString(),!0):!1}get requesterUserId(){return this._requesterUserId}get requesterName(){return this._requesterName}get requesterFigure(){return this._requesterFigure}get guideUserId(){return this._guideUserId}get guideName(){return this._guideName}get guideFigure(){return this._guideFigure}}const Xh=class Xh{flush(){return this._result=0,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}};Xh.CREATION_RESULT_OK=0,Xh.CREATION_RESULT_UNABLE_TO_REPORT=1,Xh.CREATION_RESULT_NO_CHATLOG_FOUND=2,Xh.CREATION_RESULT_BULLY_ALREADY_REPORTED=3;let SR=Xh;const V_=class V_{flush(){return this._resolution=0,!0}parse(e){return e?(this._resolution=e.readInt(),!0):!1}get resolution(){return this._resolution}};V_.RESOLUTION_GUARDIANS_TOOK_ACTION=0,V_.RESOLUTION_FORWARDED_TO_MODERATORS=1,V_.RESOLUTION_REPORTER_IS_ABUSIVE=2;let RR=V_;class r4{flush(){return!0}parse(e){return!!e}}class n4{flush(){return this._closeReason=0,this._messageText="",!0}parse(e){return e?(this._closeReason=e.readInt(),this._messageText=e.readString(),!0):!1}get closeReason(){return this._closeReason}get messageText(){return this._messageText}}class a4{flush(){return this._quizCode=null,this._questionIds=[],!0}parse(e){if(!e)return!1;this._quizCode=e.readString();const t=e.readInt();this._questionIds=[];for(let i=0;i<t;i++)this._questionIds.push(e.readInt());return!0}get quizCode(){return this._quizCode}get questionIds(){return this._questionIds}}class o4{flush(){return this._quizCode=null,this._questionIdsForWrongAnswers=[],!0}parse(e){if(!e)return!1;this._quizCode=e.readString();const t=e.readInt();this._questionIdsForWrongAnswers=[];for(let i=0;i<t;i++)this._questionIdsForWrongAnswers.push(e.readInt());return!0}get quizCode(){return this._quizCode}get questionIdsForWrongAnswers(){return this._questionIdsForWrongAnswers}}class l4{constructor(e,t,i,r,n,o,l){this._userIndex=e,this._source=t,this._target=i,this._moveType=r,this._animationTime=n,this._bodyDirection=o,this._headDirection=l}get userIndex(){return this._userIndex}get source(){return this._source}get target(){return this._target}get moveType(){return this._moveType}get animationTime(){return this._animationTime}get bodyDirection(){return this._bodyDirection}get headDirection(){return this._headDirection}}class c4{constructor(e,t,i,r,n){this._furniId=e,this._source=t,this._target=i,this._animationTime=r,this._rotation=n}get furniId(){return this._furniId}get source(){return this._source}get target(){return this._target}get animationTime(){return this._animationTime}get rotation(){return this._rotation}}class u4{constructor(e,t,i,r,n,o,l,c,u,d,_){this._itemId=e,this._isDirectionRight=t,this._oldWallX=i,this._oldWallY=r,this._oldOffsetX=n,this._oldOffsetY=o,this._newWallX=l,this._newWallY=c,this._newOffsetX=u,this._newOffsetY=d,this._animationTime=_}get itemId(){return this._itemId}get isDirectionRight(){return this._isDirectionRight}get oldWallX(){return this._oldWallX}get oldWallY(){return this._oldWallY}get oldOffsetX(){return this._oldOffsetX}get oldOffsetY(){return this._oldOffsetY}get newWallX(){return this._newWallX}get newWallY(){return this._newWallY}get newOffsetX(){return this._newOffsetX}get newOffsetY(){return this._newOffsetY}get animationTime(){return this._animationTime}}class h4{constructor(e,t,i){this._userIndex=e,this._bodyDirection=t,this._headDirection=i}get userIndex(){return this._userIndex}get bodyDirection(){return this._bodyDirection}get headDirection(){return this._headDirection}}const H_=class H_{constructor(e){this._id=e.readInt(),this._title=e.readString(),this._bodyText=e.readString(),this._buttonText=e.readString(),this._linkType=e.readInt(),this._linkContent=e.readString(),this._imageUrl=e.readString()}get id(){return this._id}get title(){return this._title}get bodyText(){return this._bodyText}get buttonText(){return this._buttonText}get linkType(){return this._linkType}get linkContent(){return this._linkContent}get imageUrl(){return this._imageUrl}};H_.LINK_TYPE_URL=0,H_.LINK_TYPE_INTERNAL=1,H_.LINK_TYPE_NO_LINK=2;let xR=H_;class d4{flush(){return this._articles=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let i=0;i<t;i++)this._articles.push(new xR(e));return!0}get articles(){return this._articles}}class _4{flush(){return!0}parse(e){return e?(this._acknowledged=e.readBoolean(),!0):!1}get acknowledged(){return this._acknowledged}}class g4{flush(){return this._newOfferId=-1,this._newPrice=0,this._requestedOfferId=-1,!0}parse(e){return e?(this._result=e.readInt(),this._newOfferId=e.readInt(),this._newPrice=e.readInt(),this._requestedOfferId=e.readInt(),!0):!1}get result(){return this._result}get offerId(){return this._newOfferId}get newPrice(){return this._newPrice}get requestedOfferId(){return this._requestedOfferId}}class m4{flush(){return this._offerId=0,this._success=!1,!0}parse(e){return e?(this._offerId=e.readInt(),this._success=e.readBoolean(),!0):!1}get offerId(){return this._offerId}get success(){return this._success}}class f4{flush(){return this._tokenCount=0,this._result=0,!0}parse(e){return e?(this._result=e.readInt(),this._tokenCount=e.readInt(),!0):!1}get tokenCount(){return this._tokenCount}get resultCode(){return this._result}}class p4{flush(){return this._enabled=!1,this._commission=0,this._credits=0,this._advertisements=0,this._maximumPrice=0,this._minimumPrice=0,this._offerTime=0,this._displayTime=0,!0}parse(e){return e?(this._enabled=e.readBoolean(),this._commission=e.readInt(),this._credits=e.readInt(),this._advertisements=e.readInt(),this._minimumPrice=e.readInt(),this._maximumPrice=e.readInt(),this._offerTime=e.readInt(),this._displayTime=e.readInt(),!0):!1}get enabled(){return this._enabled}get commission(){return this._commission}get credits(){return this._credits}get advertisements(){return this._advertisements}get minimumPrice(){return this._minimumPrice}get maximumPrice(){return this._maximumPrice}get offerTime(){return this._offerTime}get displayTime(){return this._displayTime}}class E4{flush(){return this._result=0,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}}class I4{flush(){return this._averagePrice=0,this._currentOfferCount=0,this._historyLength=0,this._dayOffsets=[],this._averagePrices=[],this._soldAmounts=[],this._furniTypeId=0,this._furniCategoryId=0,!0}parse(e){if(!e)return!1;this._averagePrice=e.readInt(),this._currentOfferCount=e.readInt(),this._historyLength=e.readInt();let t=e.readInt();for(;t>0;)this._dayOffsets.push(e.readInt()),this._averagePrices.push(e.readInt()),this._soldAmounts.push(e.readInt()),t--;return this._furniCategoryId=e.readInt(),this._furniTypeId=e.readInt(),!0}get averagePrice(){return this._averagePrice}get offerCount(){return this._currentOfferCount}get historyLength(){return this._historyLength}get dayOffsets(){return this._dayOffsets}get averagePrices(){return this._averagePrices}get soldAmounts(){return this._soldAmounts}get furniTypeId(){return this._furniTypeId}get furniCategoryId(){return this._furniCategoryId}}class uD{constructor(e,t,i,r,n,o,l,c,u,d=-1,_=0){this._timeLeftMinutes=-1,this._offerId=e,this._furniId=t,this._furniType=i,this._extraData=r,this._stuffData=n,this._price=o,this._status=l,this._timeLeftMinutes=c,this._averagePrice=u,this._offerCount=d,this._rarePrice=_}get offerId(){return this._offerId}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}get averagePrice(){return this._averagePrice}get offerCount(){return this._offerCount}get isUniqueLimitedItem(){return this.stuffData!=null&&this.stuffData.uniqueSeries>0}get rarePrice(){return this._rarePrice}}var Wu;let Wme=(Wu=class{constructor(e,t,i,r,n,o,l,c,u=-1){this._timeLeftMinutes=-1,this._offerId=e,this._furniId=t,this._furniType=i,this._extraData=r,this._stuffData=n,this._price=o,this._status=l,this._averagePrice=c,this._offerCount=u}get offerId(){return this._offerId}set offerId(e){this._offerId=e}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}set price(e){this._price=e}get averagePrice(){return this._averagePrice}get image(){return this._image}set image(e){this._image=e}get imageCallback(){return this._imageCallback}set imageCallback(e){this._imageCallback=e}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}set timeLeftMinutes(e){this._timeLeftMinutes=e}get offerCount(){return this._offerCount}set offerCount(e){this._offerCount=e}get isUniqueLimitedItem(){return this.stuffData&&this.stuffData.uniqueSeries>0}},Wu.TYPE_LANDSCAPE=1,Wu.TYPE_FLOOR=2,Wu);const al=class al{constructor(){this.MAX_LIST_LENGTH=500}flush(){return this._offers=[],this._totalItemsFound=0,!0}parse(e){if(!e)return!1;const t=e.readInt();let i=0;for(;i<t;){const r=e.readInt(),n=e.readInt();let o=e.readInt(),l=-1,c="",u=null;o===al.FURNITYPE_STUFF?(l=e.readInt(),u=Mc.parseObjectData(e)):o===al.FURNITYPE_WALL?(l=e.readInt(),c=e.readString()):o==al.FAKE_FURNITYPE_UNIQUE&&(l=e.readInt(),u=ka.getData(Xr.FORMAT_KEY),u.uniqueNumber=e.readInt(),u.uniqueSeries=e.readInt(),o=al.FURNITYPE_STUFF);const d=e.readInt(),_=e.readInt(),m=e.readInt(),f=e.readInt(),E=e.readInt(),I=new uD(r,l,o,c,u,d,n,_,m,f,E);i<this.MAX_LIST_LENGTH&&this._offers.push(I),i++}return this._totalItemsFound=e.readInt(),!0}get offers(){return this._offers}get totalItemsFound(){return this._totalItemsFound}};al.FURNITYPE_STUFF=1,al.FURNITYPE_WALL=2,al.FAKE_FURNITYPE_UNIQUE=3;let OR=al;const JE=class JE{flush(){return this._offers=[],!0}parse(e){if(!e)return!1;this._offers=[],this._creditsWaiting=e.readInt();const t=e.readInt();for(let i=0;i<t;i++){const r=e.readInt(),n=e.readInt();let o=e.readInt(),l,c,u;o==1?(l=e.readInt(),u=this.getStuffData(e)):o==2?(l=e.readInt(),c=e.readString()):o==3&&(l=e.readInt(),u=ka.getData(Xr.FORMAT_KEY),u.uniqueNumber=e.readInt(),u.uniqueSeries=e.readInt(),o=1);const d=e.readInt(),_=e.readInt(),m=e.readInt(),f=new uD(r,l,o,c,u,d,n,_,m);i<JE.MAX_LIST_LENGTH&&this._offers.push(f)}return!0}get offers(){return this._offers}get creditsWaiting(){return this._creditsWaiting}getStuffData(e){const t=e.readInt(),i=ka.getData(t);return i.parseWrapper(e),i}};JE.MAX_LIST_LENGTH=500;let CR=JE;class T4{constructor(e,t,i,r,n){this._timestamp=e,this._habboId=t,this._username=i,this._message=r,this._hasHighlighting=n}get timestamp(){return this._timestamp}get userId(){return this._habboId}get userName(){return this._username}get message(){return this._message}get hasHighlighting(){return this._hasHighlighting}}const ol=class ol{constructor(e){this._context=new Map,this._chatlog=[],this._recordType=e.readByte();const t=e.readShort();for(let r=0;r<t;r++){const n=e.readString(),o=e.readByte();switch(o){case 0:this._context.set(n,e.readBoolean());break;case 1:this._context.set(n,e.readInt());break;case 2:this._context.set(n,e.readString());break;default:throw new Error("Unknown data type "+o)}}const i=e.readShort();for(let r=0;r<i;r++){const n=e.readString(),o=e.readInt(),l=e.readString(),c=e.readString(),u=e.readBoolean();this._chatlog.push(new T4(n,o,l,c,u))}}get recordType(){return this._recordType}get context(){return this._context}get chatlog(){return this._chatlog}get roomId(){return this.getInt("roomId")}get roomName(){return this._context.get("roomName")}get groupId(){return this.getInt("groupId")}get threadId(){return this.getInt("threadId")}get messageId(){return this.getInt("messageId")}getInt(e){const t=this._context.get(e);return t||0}};ol.TYPE_SIMPLE=0,ol.TYPE_ROOM_CHAT=1,ol.TYPE_IM_SESSION=2,ol.TYPE_DISCUSSION_THREAD=3,ol.TYPE_DISCUSSION_MESSAGE=4,ol.TYPE_SELFIE=5,ol.TYPE_PHOTO=6;let Fg=ol;class S4{constructor(e){this._issueId=e.readInt(),this._callerUserId=e.readInt(),this._reportedUserId=e.readInt(),this._chatRecordId=e.readInt(),this._chatRecord=new Fg(e)}get issueId(){return this._issueId}get callerUserId(){return this._callerUserId}get reportedUserId(){return this._reportedUserId}get chatRecordId(){return this._chatRecordId}get chatRecord(){return this._chatRecord}}class R4{flush(){return this._data=null,!0}parse(e){return e?(this._data=new S4(e),!0):!1}get data(){return this._data}}class x4{flush(){return!0}parse(e){return this._issueId=parseInt(e.readString()),!0}get issueId(){return this._issueId}}const W_=class W_{constructor(e,t,i,r,n,o,l,c,u,d,_,m,f,E,I,p){this._disposed=!1,this._issueId=e,this._state=t,this._categoryId=i,this._reportedCategoryId=r,this._issueAgeInMilliseconds=n,this._priority=o,this._groupingId=l,this._reporterUserId=c,this._reporterUserName=u,this._reportedUserId=d,this._reportedUserName=_,this._pickerUserId=m,this._pickerUserName=f,this._message=E,this._chatRecordId=I,this._patterns=p,this._creationTimeInMilliseconds=nt()}get issueId(){return this._issueId}get state(){return this._state}get categoryId(){return this._categoryId}get reportedCategoryId(){return this._reportedCategoryId}get issueAgeInMilliseconds(){return this._issueAgeInMilliseconds}get priority(){return this._priority}get groupingId(){return this._groupingId}get reporterUserId(){return this._reporterUserId}get reporterUserName(){return this._reporterUserName}get reportedUserId(){return this._reportedUserId}get reportedUserName(){return this._reportedUserName}get pickerUserId(){return this._pickerUserId}get pickerUserName(){return this._pickerUserName}get message(){return this._message}get chatRecordId(){return this._chatRecordId}get patterns(){return this._patterns}dispose(){if(!this.disposed){for(const e of this._patterns)e.dispose();this._patterns=[],this._disposed=!0}}get disposed(){return this._disposed}getOpenTime(e){const i=(this._issueAgeInMilliseconds+e-this._creationTimeInMilliseconds)/1e3/60,r=i%60,n=i/60,o=(r<10?"0":"")+r;return(n<10?"0":"")+n+":"+o}};W_.STATE_OPEN=1,W_.STATE_PICKED=2,W_.STATE_CLOSED=3;let Vu=W_;class O4{constructor(e){this._disposed=!1,this._pattern=e.readString(),this._startIndex=e.readInt(),this._endIndex=e.readInt()}dispose(){this._disposed=!0,this._pattern="",this._startIndex=-1,this._endIndex=-1}get disposed(){return this._disposed}get pattern(){return this._pattern}get startIndex(){return this._startIndex}get endIndex(){return this._endIndex}}class hD{get issueData(){return this._issueData}flush(){return this._issueData=null,!0}parse(e){const t=e.readInt(),i=e.readInt(),r=e.readInt(),n=e.readInt(),o=e.readInt(),l=e.readInt(),c=e.readInt(),u=e.readInt(),d=e.readString(),_=e.readInt(),m=e.readString(),f=e.readInt(),E=e.readString(),I=e.readString(),p=e.readInt(),S=e.readInt(),R=[];for(let O=0;O<S;O++)R.push(new O4(e));return this._issueData=new Vu(t,i,r,n,o,l,c,u,d,_,m,f,E,I,p,R),!0}}class C4{flush(){return this._issues=null,!0}parse(e){this._issues=[];const t=e.readInt();for(let i=0;i<t;i++){const r=e.readInt(),n=e.readInt(),o=e.readString(),l=new Vu(r,0,0,0,0,0,0,0,null,0,null,n,o,null,0,[]);this._issues.push(l)}return this._retryEnabled=e.readBoolean(),this._retryCount=e.readInt(),!0}get issues(){return this._issues}get retryEnabled(){return this._retryEnabled}get retryCount(){return this._retryCount}}class N4{flush(){return this._message="",this._url=null,!0}parse(e){return e?(this._message=e.readString(),this._url=e.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class A4{flush(){return this._userId=-1,this._success=!1,!0}parse(e){return this._userId=e.readInt(),this._success=e.readBoolean(),!0}get userId(){return this._userId}get success(){return this._success}}class b4{constructor(e){this._disposed=!1;const t=new hD;this._issues=[],this._messageTemplates=[],this._roomMessageTemplates=[];let i=e.readInt(),r=0;for(;r<i;)t.parse(e)&&this._issues.push(t.issueData),r++;for(i=e.readInt(),r=0;r<i;)this._messageTemplates.push(e.readString()),r++;for(i=e.readInt(),r=0;r<i;)e.readString(),r++;for(this._cfhPermission=e.readBoolean(),this._chatlogsPermission=e.readBoolean(),this._alertPermission=e.readBoolean(),this._kickPermission=e.readBoolean(),this._banPermission=e.readBoolean(),this._roomAlertPermission=e.readBoolean(),this._roomKickPermission=e.readBoolean(),i=e.readInt(),r=0;r<i;)this._roomMessageTemplates.push(e.readString()),r++}dispose(){this._disposed||(this._disposed=!0,this._messageTemplates=null,this._roomMessageTemplates=null,this._issues=null)}get disposed(){return this._disposed}get messageTemplates(){return this._messageTemplates}get roomMessageTemplates(){return this._roomMessageTemplates}get issues(){return this._issues}get cfhPermission(){return this._cfhPermission}get chatlogsPermission(){return this._chatlogsPermission}get alertPermission(){return this._alertPermission}get kickPermission(){return this._kickPermission}get banPermission(){return this._banPermission}get roomAlertPermission(){return this._roomAlertPermission}get roomKickPermission(){return this._roomKickPermission}}class v4{constructor(){this._data=null}flush(){return this._data=null,!0}parse(e){return this._data=new b4(e),!0}get data(){return this._data}}class y4{flush(){return this._message="",this._url="",!0}parse(e){return e?(this._message=e.readString(),this._url=e.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class D4{constructor(e){if(this._tags=[],this._exists=e.readBoolean(),!this.exists)return;this._name=e.readString(),this._desc=e.readString();const t=e.readInt();for(let i=0;i<t;i++)this._tags.push(e.readString())}get name(){return this._name}get desc(){return this._desc}get tags(){return this._tags}get exists(){return this._exists}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._tags=null)}}class M4{constructor(e){this._flatId=e.readInt(),this._userCount=e.readInt(),this._ownerInRoom=e.readBoolean(),this._ownerId=e.readInt(),this._ownerName=e.readString(),this._room=new D4(e)}get flatId(){return this._flatId}get userCount(){return this._userCount}get ownerInRoom(){return this._ownerInRoom}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get room(){return this._room}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._room!=null&&(this._room.dispose(),this._room=null))}}class j4{flush(){return this._data=null,!0}parse(e){return e?(this._data=new M4(e),!0):!1}get data(){return this._data}}class L4{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,!0}parse(e){return this._windowX=e.readInt(),this._windowY=e.readInt(),this._windowWidth=e.readInt(),this._windowHeight=e.readInt(),!0}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}}class P4{constructor(e){this._lastSanctionTime="",this._sanctionAgeHours=0,this._userId=e.readInt(),this._userName=e.readString(),this._figure=e.readString(),this._registrationAgeInMinutes=e.readInt(),this._minutesSinceLastLogin=e.readInt(),this._online=e.readBoolean(),this._cfhCount=e.readInt(),this._abusiveCfhCount=e.readInt(),this._cautionCount=e.readInt(),this._banCount=e.readInt(),this._tradingLockCount=e.readInt(),this._tradingExpiryDate=e.readString(),this._lastPurchaseDate=e.readString(),this._identityId=e.readInt(),this._identityRelatedBanCount=e.readInt(),this._primaryEmailAddress=e.readString(),this._userClassification=e.readString(),e.bytesAvailable&&(this._lastSanctionTime=e.readString(),this._sanctionAgeHours=e.readInt())}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get registrationAgeInMinutes(){return this._registrationAgeInMinutes}get minutesSinceLastLogin(){return this._minutesSinceLastLogin}get online(){return this._online}get cfhCount(){return this._cfhCount}get abusiveCfhCount(){return this._abusiveCfhCount}get cautionCount(){return this._cautionCount}get banCount(){return this._banCount}get tradingLockCount(){return this._tradingLockCount}get tradingExpiryDate(){return this._tradingExpiryDate}get lastPurchaseDate(){return this._lastPurchaseDate}get identityId(){return this._identityId}get identityRelatedBanCount(){return this._identityRelatedBanCount}get primaryEmailAddress(){return this._primaryEmailAddress}get userClassification(){return this._userClassification}get lastSanctionTime(){return this._lastSanctionTime}get sanctionAgeHours(){return this._sanctionAgeHours}}class U4{flush(){return this._data=null,!0}parse(e){return e?(this._data=new P4(e),!0):!1}get data(){return this._data}}class w4{flush(){return this._data=null,!0}parse(e){return e?(this._data=new Fg(e),!0):!1}get data(){return this._data}}class F4{constructor(e){this._roomId=e.readInt(),this._roomName=e.readString(),this._enterHour=e.readInt(),this._enterMinute=e.readInt()}get roomId(){return this._roomId}get roomName(){return this._roomName}get enterHour(){return this._enterHour}get enterMinute(){return this._enterMinute}}class k4{constructor(e){this._rooms=[],this._userId=e.readInt(),this._userName=e.readString();const t=e.readInt();let i=0;for(;i<t;)this._rooms.push(new F4(e)),i++}get userId(){return this._userId}get userName(){return this._userName}get rooms(){return this._rooms}}class G4{flush(){return!0}parse(e){return this._data=new k4(e),!0}get data(){return this._data}}class B4{flush(){return this._message="",!0}parse(e){return e?(this._message=e.readString(),!0):!1}get message(){return this._message}}class V4{constructor(e){this._roomChatlogs=[],this._userId=e.readInt(),this._username=e.readString();const t=e.readInt();for(let i=0;i<t;i++)this._roomChatlogs.push(new Fg(e))}get userId(){return this._userId}get username(){return this._username}get roomChatlogs(){return this._roomChatlogs}}class H4{flush(){return this._data=null,!0}parse(e){return e?(this._data=new V4(e),!0):!1}get data(){return this._data}}class W4{flush(){return!0}parse(e){return!!e}}class Y4{flush(){return!0}parse(e){return e?(this._contentType=e.readString(),this._classId=e.readInt(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}}class z4{flush(){return this._boxColor=null,this._keyColor=null,!0}parse(e){return e?(this._boxColor=e.readString(),this._keyColor=e.readString(),!0):!1}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}}class K4{flush(){return!0}parse(e){return!!e}}class q4{flush(){return this._canCreate=!1,this._errorCode=0,!0}parse(e){return e?(this._canCreate=e.readBoolean(),this._errorCode=e.readInt(),!0):!1}get canCreate(){return this._canCreate}get errorCode(){return this._errorCode}}const ZE=class ZE{flush(){return!0}parse(e){return e?(this._resultCode=e.readInt(),this._roomLimit=e.readInt(),!0):!1}get resultCode(){return this._resultCode}get roomLimit(){return this._roomLimit}};ZE.CREATION_ALLOWED=0,ZE.ROOM_LIMIT_REACHED=1;let NR=ZE;class X4{constructor(e){this._categoryToCurrentUserCountMap=new Map,this._categoryToMaxUserCountMap=new Map;const t=e.readInt();for(let i=0;i<t;i++){const r=e.readInt(),n=e.readInt(),o=e.readInt();this._categoryToCurrentUserCountMap.set(r,n),this._categoryToMaxUserCountMap.set(r,o)}}get categoryToCurrentUserCountMap(){return this._categoryToCurrentUserCountMap}get categoryToMaxUserCountMap(){return this._categoryToMaxUserCountMap}}class $4{constructor(e,t=0,i=0){this._goalId=t,this._pageIndex=i,e&&(this._goalId=e.readInt(),this._pageIndex=e.readInt(),this._pageCount=e.readInt())}get goalId(){return this._goalId}get pageIndex(){return this._pageIndex}get pageCount(){return this._pageCount}}const ll=class ll{constructor(e){this._index=e.readInt(),this._popupCaption=e.readString(),this._popupDesc=e.readString(),this._showDetails=e.readInt()==1,this._picText=e.readString(),this._picRef=e.readString(),this._folderId=e.readInt(),this._userCount=e.readInt(),this._type=e.readInt(),this._type==ll.TYPE_TAG?this._tag=e.readString():this._type==ll.TYPE_GUEST_ROOM?this._guestRoomData=new is(e):this._open=e.readBoolean()}dispose(){this._disposed||(this._disposed=!0,this._guestRoomData!=null&&(this._guestRoomData.flush(),this._guestRoomData=null))}get disposed(){return this._disposed}get type(){return this._type}get index(){return this._index}get popupCaption(){return this._popupCaption}get popupDesc(){return this._popupDesc}get showDetails(){return this._showDetails}get picText(){return this._picText}get picRef(){return this._picRef}get folderId(){return this._folderId}get tag(){return this._tag}get userCount(){return this._userCount}get guestRoomData(){return this._guestRoomData}get open(){return this._open}toggleOpen(){this._open=!this._open}get maxUsers(){return this.type==ll.TYPE_TAG?0:this.type==ll.TYPE_GUEST_ROOM?this._guestRoomData.maxUserCount:0}};ll.TYPE_TAG=1,ll.TYPE_GUEST_ROOM=2,ll.TYPE_FOLDER=4;let AR=ll;class Q4{constructor(e){this._rooms=[],this._searchType=e.readInt(),this._searchParam=e.readString();const t=e.readInt();for(let r=0;r<t;r++)this._rooms.push(new is(e));e.readBoolean()&&(this._ad=new AR(e))}dispose(){if(!this._disposed){if(this._disposed=!0,this._rooms!=null)for(const e of this._rooms)e.flush();this._ad!=null&&(this._ad.dispose(),this._ad=null),this._rooms=null}}get disposed(){return this._disposed}get searchType(){return this._searchType}get searchParam(){return this._searchParam}get rooms(){return this._rooms}get ad(){return this._ad}}class dD{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._id=-1,this._code=null,this._filter=null,this._localization=null,!0}parse(e){return e?(this._id=e.readInt(),this._code=e.readString(),this._filter=e.readString(),this._localization=e.readString(),!0):!1}get id(){return this._id}get code(){return this._code}get filter(){return this._filter}get localization(){return this._localization}}class J4{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._code=null,this._data=null,this._action=-1,this._closed=!1,this._mode=-1,this._rooms=[],!0}parse(e){if(!e)return!1;this._code=e.readString(),this._data=e.readString(),this._action=e.readInt(),this._closed=e.readBoolean(),this._mode=e.readInt();let t=e.readInt();for(;t>0;)this._rooms.push(new is(e)),t--;return!0}get code(){return this._code}get data(){return this._data}get action(){return this._action}get closed(){return this._closed}get mode(){return this._mode}get rooms(){return this._rooms}}class Z4{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._code=null,this._data=null,this._results=[],!0}parse(e){if(!e)return!1;this._code=e.readString(),this._data=e.readString();let t=e.readInt();for(;t>0;)this._results.push(new J4(e)),t--;return!0}get code(){return this._code}get data(){return this._data}get results(){return this._results}}class e6{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._code=null,this._savedSearches=[],!0}parse(e){if(!e)return!1;this._code=e.readString();let t=e.readInt();for(;t>0;)this._savedSearches.push(new dD(e)),t--;return!0}get code(){return this._code}get savedSearches(){return this._savedSearches}}class t6{constructor(e){this._adId=e.readInt(),this._ownerAvatarId=e.readInt(),this._ownerAvatarName=e.readString(),this._flatId=e.readInt(),this._eventType=e.readInt(),this._eventName=e.readString(),this._eventDescription=e.readString();const t=e.readInt(),i=e.readInt(),r=new Date;let n=r.getTime();const o=t*60*1e3;n=n-o;const l=new Date(n);this._creationTime=l.getDate()+"-"+l.getMonth()+"-"+l.getFullYear()+" "+l.getHours()+":"+l.getMinutes();let c=r.getTime();const u=i*60*1e3;c=c+u,this._expirationDate=new Date(c),this._categoryId=e.readInt()}dispose(){this._disposed||(this._disposed=!0)}get disposed(){return this._disposed}get adId(){return this._adId}get ownerAvatarId(){return this._ownerAvatarId}get ownerAvatarName(){return this._ownerAvatarName}get flatId(){return this._flatId}get categoryId(){return this._categoryId}get eventType(){return this._eventType}get eventName(){return this._eventName}get eventDescription(){return this._eventDescription}get creationTime(){return this._creationTime}get expirationDate(){return this._expirationDate}}class s6{flush(){return!0}parse(e){return e?(this._data=new X4(e),!0):!1}get data(){return this._data}}class i6{flush(){return!0}parse(e){return e?(this._data=new $4(e),!0):!1}get data(){return this._data}}class r6{flush(){return!0}parse(e){return e?(this._globalId=e.readString(),this._convertedId=e.readInt(),!0):!1}get globalId(){return this._globalId}get convertedId(){return this._convertedId}}class n6{flush(){return this._userName=null,!0}parse(e){return e?(this._userName=e.readString(),!0):!1}get userName(){return this._userName}}class a6{flush(){return!0}parse(e){return e?(this._flatId=e.readInt(),this._added=e.readBoolean(),!0):!1}get flatId(){return this._flatId}get added(){return this._added}}class o6{flush(){return!0}parse(e){if(!e)return!1;this._favouriteRoomIds=[],this._limit=e.readInt();const t=e.readInt();for(let i=0;i<t;i++)this._favouriteRoomIds.push(e.readInt());return!0}get limit(){return this._limit}get favoriteRoomIds(){return this._favouriteRoomIds}}class l6{flush(){return this._userName=null,!0}parse(e){return e?(this._userName=e.readString(),!0):!1}get userName(){return this._userName}}class c6{flush(){return this._roomId=-1,this._roomName=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._roomName=e.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class u6{flush(){return this._roomEnter=!1,this._roomForward=!1,this._data=null,this._staffPick=!1,this._isGroupMember=!1,this._moderation=null,this._chat=null,!0}parse(e){return e?(this._roomEnter=e.readBoolean(),this._data=new is(e),this._roomForward=e.readBoolean(),this._staffPick=e.readBoolean(),this._isGroupMember=e.readBoolean(),this.data.allInRoomMuted=e.readBoolean(),this._moderation=new Zt(e),this.data.canMute=e.readBoolean(),this._chat=new Ds(e),!0):!1}get roomEnter(){return this._roomEnter}get roomForward(){return this._roomForward}get data(){return this._data}get staffPick(){return this._staffPick}get isGroupMember(){return this._isGroupMember}get moderation(){return this._moderation}get chat(){return this._chat}}class h6{flush(){return!0}parse(e){return e?(this._data=new Q4(e),!0):!1}get data(){return this._data}}class d6{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._id=-1,this._name=null,this._visible=!1,this._automatic=!1,this._automaticCategoryKey=null,this._globalCategoryKey=null,this._staffOnly=!1,!0}parse(e){return e?(this._id=e.readInt(),this._name=e.readString(),this._visible=e.readBoolean(),this._automatic=e.readBoolean(),this._automaticCategoryKey=e.readString(),this._globalCategoryKey=e.readString(),this._staffOnly=e.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}get automatic(){return this._automatic}get automaticCategoryKey(){return this._automaticCategoryKey}get globalCategoryKey(){return this._globalCategoryKey}get staffOnly(){return this._staffOnly}}class _6{flush(){return this._categories=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._categories.push(e.readString()),t--;return!0}get categories(){return this._categories}}class g6{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._id=-1,this._name=null,this._visible=!1,!0}parse(e){return e?(this._id=e.readInt(),this._name=e.readString(),this._visible=e.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}}class m6{flush(){return this._homeRoomId=-1,this._roomIdToEnter=-1,!0}parse(e){return e?(this._homeRoomId=e.readInt(),this._roomIdToEnter=e.readInt(),!0):!1}get homeRoomId(){return this._homeRoomId}get roomIdToEnter(){return this._roomIdToEnter}}class f6{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._roomId=-1,this._areaId=-1,this._image=null,this._caption=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._areaId=e.readInt(),this._image=e.readString(),this._caption=e.readString(),!0):!1}get roomId(){return this._roomId}get areaId(){return this._areaId}get image(){return this._image}get caption(){return this._caption}}class p6{flush(){return this._rooms=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._rooms.push(new f6(e)),t--;return!0}get rooms(){return this._rooms}}class E6{flush(){return this._topLevelContexts=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._topLevelContexts.push(new e6(e)),t--;return!0}get topLevelContexts(){return this._topLevelContexts}}class I6{flush(){return!0}parse(e){return!!e}}class T6{flush(){return this._searches=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._searches.push(new dD(e)),t--;return!0}get searches(){return this._searches}}class S6{flush(){return this._result=null,!0}parse(e){return e?(this._result=new Z4(e),!0):!1}get result(){return this._result}}class R6{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,this._leftPanelHidden=!1,this._resultsMode=0,!0}parse(e){return e?(this._windowX=e.readInt(),this._windowY=e.readInt(),this._windowWidth=e.readInt(),this._windowHeight=e.readInt(),this._leftPanelHidden=e.readBoolean(),this._resultsMode=e.readInt(),!0):!1}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}get leftPanelHidden(){return this._leftPanelHidden}get resultsMode(){return this._resultsMode}}class x6{constructor(e){this._tagName=e.readString(),this._userCount=e.readInt()}get tagName(){return this._tagName}get userCount(){return this._userCount}}class O6{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._tags=[],!0}parse(e){if(!e)return!1;this._tags=[];const t=e.readInt();let i=0;for(;i<t;)this._tags.push(new x6(e)),i++;return!0}get tags(){return this._tags}}class C6{flush(){return this._data=null,!0}parse(e){return e?(this._data=new O6(e),!0):!1}get data(){return this._data}}class N6{flush(){return!0}parse(e){return!0}}class A6{flush(){return!0}parse(e){return this._data=new t6(e),!0}get data(){return this._data}}class b6{flush(){return this._words=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._words.push(e.readString()),t--;return!0}get words(){return this._words}}class v6{flush(){return this._roomId=0,!0}parse(e){return e?(this._roomId=e.readInt(),!0):!1}get roomId(){return this._roomId}}class y6{flush(){return!0}parse(e){return this._flatId=e.readInt(),this._resultCode=e.readInt(),!0}get flatId(){return this._flatId}get resultCode(){return this._resultCode}}class D6{flush(){return this._categories=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._categories.push(new g6(e)),t--;return!0}get categories(){return this._categories}}class M6{flush(){return this._categories=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._categories.push(new d6(e)),t--;return!0}get categories(){return this._categories}}class j6{constructor(e){this._badgeCode="",this._removedBadgeCode="",this._type=e.readInt(),this._level=e.readInt(),this._badgeId=e.readInt(),this._badgeCode=e.readString(),this._points=e.readInt(),this._levelRewardPoints=e.readInt(),this._levelRewardPointType=e.readInt(),this._bonusPoints=e.readInt(),this._achievementID=e.readInt(),this._removedBadgeCode=e.readString(),this._category=e.readString(),this._showDialogToUser=e.readBoolean()}get type(){return this._type}get level(){return this._level}get points(){return this._points}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get bonusPoints(){return this._bonusPoints}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}get removedBadgeCode(){return this._removedBadgeCode}get achievementID(){return this._achievementID}get category(){return this._category}get showDialogToUser(){return this._showDialogToUser}}class L6{flush(){return this._data=null,!0}parse(e){return e?(this._data=new j6(e),!0):!1}get data(){return this._data}}class P6{flush(){return this._amount=0,this._amountChanged=0,this._type=-1,!0}parse(e){return e?(this._amount=e.readInt(),this._amountChanged=e.readInt(),this._type=e.readInt(),!0):!1}get amount(){return this._amount}get amountChanged(){return this._amountChanged}get type(){return this._type}}class U6{flush(){return this._errorCode=-1,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}class w6{flush(){return this._numGifts=0,!0}parse(e){return e?(this._numGifts=e.readInt(),!0):!1}get numGifts(){return this._numGifts}}class F6{flush(){return this._errorCode=0,this._messageId=0,this._timestamp=null,!0}parse(e){return e?(this._messageId=e.readInt(),this._errorCode=e.readInt(),this._timestamp=e.readString(),!0):!1}get errorCode(){return this._errorCode}get messageId(){return this._messageId}get timestamp(){return this._timestamp}}class k6{flush(){return this._key=null,!0}parse(e){return e?(this._key=e.readString(),!0):!1}get key(){return this._key}}class G6{flush(){return this._message=null,!0}parse(e){return e?(this._message=e.readString(),!0):!1}get message(){return this._message}}class B6{flush(){return this._enabled=!1,!0}parse(e){return e?(this._enabled=e.readBoolean(),!0):!1}get enabled(){return this._enabled}}class V6{flush(){return this._messages=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._messages.push(e.readString()),t--;return!0}get messages(){return this._messages}}class H6{flush(){return this._type=null,this._parameters=new Map,!0}parse(e){if(!e)return!1;this._type=e.readString();let t=e.readInt();for(;t>0;)this._parameters.set(e.readString(),e.readString()),t--;return!0}get type(){return this._type}get parameters(){return this._parameters}}class W6{flush(){return this._contentType=null,this._classId=0,this._name=null,this._description=null,!0}parse(e){return e?(this._contentType=e.readString(),this._classId=e.readInt(),this._name=e.readString(),this._description=e.readString(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}get name(){return this._name}get description(){return this._description}}class Y6{flush(){return this._petId=-1,this._petName=null,this._level=0,this._figureData=null,!0}parse(e){return e?(this._petId=e.readInt(),this._petName=e.readString(),this._level=e.readInt(),this._figureData=new cC(e),!0):!1}get petId(){return this._petId}get petName(){return this._petName}get level(){return this._level}get figureData(){return this._figureData}}class z6{flush(){return this._errorCode=-1,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}class K6{flush(){return!0}parse(e){return!0}}class q6{flush(){return this._alertMessage=null,!0}parse(e){return e?(this._alertMessage=e.readString(),e.bytesAvailable&&(this._titleMessage=e.readString()),!0):!1}get alertMessage(){return this._alertMessage}get titleMessage(){return this._titleMessage}}class X6{flush(){return this._items=new Ms,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const i=e.readInt();let r=e.readInt();const n=[];for(;r>0;)n.push(e.readInt()),r--;this._items.add(i,n),t--}return!0}getItemsByCategory(e){return this._items.getValue(e)}get categories(){return this._items.getKeys()}}class $6{flush(){return this._message=null,this._type=null,this._customData=null,this._link=null,!0}parse(e){return e?(this._message=e.readString(),this._type=e.readString(),this._customData=e.readString(),this._link=e.readString(),!0):!1}get message(){return this._message}get type(){return this._type}get customData(){return this._customData}get link(){return this._link}}class Q6{constructor(e,t,i){this._code=e,this._errorMessage=t,this._isAllowed=i}get code(){return this._code}get errorMessage(){return this._errorMessage}get isAllowed(){return this._isAllowed}}const ln=class ln{};ln.USE_GUIDE_TOOL="USE_GUIDE_TOOL",ln.GIVE_GUIDE_TOUR="GIVE_GUIDE_TOUR",ln.JUDGE_CHAT_REVIEWS="JUDGE_CHAT_REVIEWS",ln.VOTE_IN_COMPETITIONS="VOTE_IN_COMPETITIONS",ln.CALL_ON_HELPERS="CALL_ON_HELPERS",ln.CITIZEN="CITIZEN",ln.TRADE="TRADE",ln.HEIGHTMAP_EDITOR_BETA="HEIGHTMAP_EDITOR_BETA",ln.BUILDER_AT_WORK="BUILDER_AT_WORK",ln.NAVIGATOR_ROOM_THUMBNAIL_CAMERA="NAVIGATOR_ROOM_THUMBNAIL_CAMERA",ln.CAMERA="CAMERA",ln.MOUSE_ZOOM="MOUSE_ZOOM";let Yf=ln;class J6{flush(){return this._perks=[],!0}parse(e){if(!e)return!1;this._perks=[];const t=e.readInt();for(let i=0;i<t;i++)this._perks.push(new Q6(e.readString(),e.readString(),e.readBoolean()));return!0}isAllowed(e){let t=!1;for(const i of this._perks)if(i.code===e){t=i.isAllowed;break}return t}get perks(){return this._perks}}class Z6{flush(){return this._objectId=-1,this._figureData=null,!0}parse(e){return this._objectId=e.readInt(),e.bytesAvailable&&(this._figureData=new Vo(e.readString())),!0}get objectId(){return this._objectId}get figureData(){return this._figureData}}class eK{flush(){return this._objectId=0,this._nameValidationStatus=0,this._nameValidationInfo=null,!0}parse(e){return this._objectId=e.readInt(),this._nameValidationStatus=e.readInt(),this._nameValidationInfo=e.readString(),!0}get objectId(){return this._objectId}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}class tK{flush(){return this._roomIndex=-1,this._petId=-1,this._level=-1,!0}parse(e){return this._roomIndex=e.readInt(),this._petId=e.readInt(),this._level=e.readInt(),!0}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get level(){return this._level}}class sK{flush(){return this._currentAge=-1,this._requiredAge=-1,!0}parse(e){return this._currentAge=e.readInt(),this._requiredAge=e.readInt(),!0}get currentAge(){return this._currentAge}get requiredAge(){return this._requiredAge}}class iK{flush(){return this._petId=-1,this._commands=[],this._enabledCommands=[],!0}parse(e){this._petId=e.readInt();let t=e.readInt();for(;t>0;)this._commands.push(e.readInt()),t--;let i=e.readInt();for(;i>0;)this._enabledCommands.push(e.readInt()),i--;return!0}get petId(){return this._petId}get commands(){return this._commands}get enabledCommands(){return this._enabledCommands}}class rK{constructor(e,t,i){this._value=e,this._choiceText=t,this._choiceType=i}get value(){return this._value}set value(e){this._value=e}get choiceText(){return this._choiceText}set choiceText(e){this._choiceText=e}get choiceType(){return this._choiceType}set choiceType(e){this._choiceType=e}}class nK{constructor(){this._children=[],this._questionChoices=[]}get questionId(){return this._questionId}set questionId(e){this._questionId=e}get questionType(){return this._questionType}set questionType(e){this._questionType=e}get sortOrder(){return this._sortOrder}set sortOrder(e){this._sortOrder=e}get questionText(){return this._questionText}set questionText(e){this._questionText=e}get questionCategory(){return this._questionCategory}set questionCategory(e){this._questionCategory=e}get questionAnswerType(){return this._questionAnswerType}set questionAnswerType(e){this._questionAnswerType=e}get questionAnswerCount(){return this._questionAnswerCount}set questionAnswerCount(e){this._questionAnswerCount=e}get children(){return this._children}set children(e){this._children=e}get questionChoices(){return this._questionChoices}set questionChoices(e){this._questionChoices=e}}class aK{constructor(){this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],this._npsPoll=!1}flush(){return this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],!0}parse(e){this._id=e.readInt(),this._startMessage=e.readString(),this._endMessage=e.readString(),this._numQuestions=e.readInt();for(let t=0;t<this._numQuestions;t++){const i=this.parsePollQuestion(e),r=e.readInt();for(let n=0;n<r;n++)i.children.push(this.parsePollQuestion(e));this._questionArray.push(i)}return this._npsPoll=e.readBoolean(),!0}parsePollQuestion(e){const t=new nK;if(t.questionId=e.readInt(),t.sortOrder=e.readInt(),t.questionType=e.readInt(),t.questionText=e.readString(),t.questionCategory=e.readInt(),t.questionAnswerType=e.readInt(),t.questionAnswerCount=e.readInt(),t.questionType==1||t.questionType==2)for(let i=0;i<t.questionAnswerCount;i++)t.questionChoices.push(new rK(e.readString(),e.readString(),e.readInt()));return t}get id(){return this._id}get startMessage(){return this._startMessage}get endMessage(){return this._endMessage}get numQuestions(){return this._numQuestions}get questionArray(){return this._questionArray}get npsPoll(){return this._npsPoll}}class oK{flush(){throw!0}parse(e){return!0}}class lK{constructor(){this._id=-1,this._type="",this._headline="",this._summary=""}flush(){return this._id=-1,this._type="",this._summary="",!0}parse(e){return this._id=e.readInt(),this._type=e.readString(),this._headline=e.readString(),this._summary=e.readString(),!0}get id(){return this._id}get type(){return this._type}get headline(){return this._headline}get summary(){return this._summary}}class cK{flush(){return this._userId=-1,this._value="",this._answerCounts=null,!0}parse(e){this._userId=e.readInt(),this._value=e.readString(),this._answerCounts=new Map;const t=e.readInt();for(let i=0;i<t;i++){const r=e.readString(),n=e.readInt();this._answerCounts.set(r,n)}return!0}get userId(){return this._userId}get value(){return this._value}get answerCounts(){return this._answerCounts}}class uK{flush(){return this._questionId=-1,this._answerCounts=null,!0}parse(e){this._questionId=e.readInt(),this._answerCounts=new Map;const t=e.readInt();for(let i=0;i<t;i++){const r=e.readString(),n=e.readInt();this._answerCounts.set(r,n)}return!0}get questionId(){return this._questionId}get answerCounts(){return this._answerCounts}}class hK{constructor(){this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null}flush(){return this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,!0}parse(e){this._pollType=e.readString(),this._pollId=e.readInt(),this._questionId=e.readInt(),this._duration=e.readInt();const t=e.readInt(),i=e.readInt(),r=e.readInt(),n=e.readString();if(this._question={id:t,number:i,type:r,content:n},this._question.type==1||this._question.type==2){this._question.selection_min=e.readInt();const o=e.readInt();this._question.selections=[],this._question.selection_values=[],this._question.selection_count=o,this._question.selection_max=o;for(let l=0;l<o;l++)this._question.selection_values.push(e.readString()),this._question.selections.push(e.readString())}return!0}get pollType(){return this._pollType}get pollId(){return this._pollId}get questionId(){return this._questionId}get duration(){return this._duration}get question(){return this._question}}class dK{flush(){return this._question=null,this._choices=[],this._SafeStr_7651=[],this._SafeStr_7654=-1,!0}parse(e){this._question=e.readString(),this._choices=[],this._SafeStr_7651=[];let t=e.readInt();for(;t>0;)this._choices.push(e.readString()),this._SafeStr_7651.push(e.readInt()),t--;return this._SafeStr_7654=e.readInt(),!0}get question(){return this._question}get choices(){return this._choices}get SafeStr_7651(){return this._SafeStr_7651}get SafeStr_7654(){return this._SafeStr_7654}}class _K{flush(){return this._question=null,this._choices=[],!0}parse(e){this._question=e.readString(),this._choices=[];const t=e.readInt();let i=0;for(;i<t;)this._choices.push(e.readString()),i++;return!0}get question(){return this._question}get choices(){return this._choices.slice()}}class gK{constructor(e){this._rewardUserLimits=[],this._hasGoalExpired=e.readBoolean(),this._personalContributionScore=e.readInt(),this._personalContributionRank=e.readInt(),this._communityTotalScore=e.readInt(),this._communityHighestAchievedLevel=e.readInt(),this._scoreRemainingUntilNextLevel=e.readInt(),this._percentCompletionTowardsNextLevel=e.readInt(),this._goalCode=e.readString(),this._timeRemainingInSeconds=e.readInt();const t=e.readInt();for(let i=0;i<t;i++)this._rewardUserLimits.push(e.readInt())}dispose(){this._rewardUserLimits=null}get disposed(){return this._rewardUserLimits==null}get hasGoalExpired(){return this._hasGoalExpired}get personalContributionScore(){return this._personalContributionScore}get personalContributionRank(){return this._personalContributionRank}get communityTotalScore(){return this._communityTotalScore}get communityHighestAchievedLevel(){return this._communityHighestAchievedLevel}get scoreRemainingUntilNextLevel(){return this._scoreRemainingUntilNextLevel}get percentCompletionTowardsNextLevel(){return this._percentCompletionTowardsNextLevel}get timeRemainingInSeconds(){return this._timeRemainingInSeconds}get rewardUserLimits(){return this._rewardUserLimits}get goalCode(){return this._goalCode}}class mK{constructor(e){this._communityGoalId=e.readInt(),this._communityGoalCode=e.readString(),this._userRank=e.readInt(),this._rewardCode=e.readString(),this._badge=e.readBoolean(),this._localizedName=e.readString()}get communityGoalId(){return this._communityGoalId}get communityGoalCode(){return this._communityGoalCode}get userRank(){return this._userRank}get rewardCode(){return this._rewardCode}get badge(){return this._badge}get localizedName(){return this._localizedName}}class fK{flush(){return this._prizes=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let i=0;i<t;i++)this._prizes.push(new mK(e));return!0}get prizes(){return this._prizes}}class pK{constructor(e){this._userId=e.readInt(),this._userName=e.readString(),this._figure=e.readString(),this._rank=e.readInt(),this._currentScore=e.readInt()}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get rank(){return this._rank}get currentScore(){return this._currentScore}}class EK{constructor(e){this._hof=[],this._goalCode=e.readString();const t=e.readInt();for(let i=0;i<t;i++)this._hof.push(new pK(e))}dispose(){this._hof=null}get disposed(){return this._hof==null}get hof(){return this._hof}get goalCode(){return this._goalCode}}class IK{flush(){return this._data=null,!0}parse(e){return e?(this._data=new EK(e),!0):!1}get data(){return this._data}}class TK{flush(){return this._data=null,!0}parse(e){return e?(this._data=new gK(e),!0):!1}get data(){return this._data}}class SK{flush(){return this._state=-1,this._userCount=-1,this._userCountGoal=-1,!0}parse(e){return e?(this._state=e.readInt(),this._userCount=e.readInt(),this._userCountGoal=e.readInt(),!0):!1}get state(){return this._state}get userCount(){return this._userCount}get userCountGoal(){return this._userCountGoal}}class RK{flush(){return this._imageUri="",!0}parse(e){return e?(this._imageUri=e.readString(),!0):!1}get imageUri(){return this._imageUri}}class xK{flush(){return!0}parse(e){return e?(this._expired=e.readBoolean(),!0):!1}get expired(){return this._expired}}class rh{constructor(e){this._receiveTime=new Date,this._campaignCode=e.readString(),this._completedQuestsInCampaign=e.readInt(),this._questCountInCampaign=e.readInt(),this._activityPointType=e.readInt(),this._id=e.readInt(),this._accepted=e.readBoolean(),this._type=e.readString(),this._imageVersion=e.readString(),this._rewardCurrencyAmount=e.readInt(),this._localizationCode=e.readString(),this._completedSteps=e.readInt(),this._totalSteps=e.readInt(),this._sortOrder=e.readInt(),this._catalogPageName=e.readString(),this._chainCode=e.readString(),this._easy=e.readBoolean(),this._expireTime=e.readInt()}static getCampaignLocalizationKeyForCode(e){return"quests."+e}get campaignCode(){return this._campaignCode}get localizationCode(){return this._localizationCode}get completedQuestsInCampaign(){return this._completedQuestsInCampaign}get questCountInCampaign(){return this._questCountInCampaign}get activityPointType(){return this._activityPointType}set accepted(e){this._accepted=e}get accepted(){return this._accepted}set id(e){this._id=e}get id(){return this._id}get type(){return this._type}get imageVersion(){return this._imageVersion}get rewardCurrencyAmount(){return this._rewardCurrencyAmount}get completedSteps(){return this._completedSteps}get totalSteps(){return this._totalSteps}get isCompleted(){return this._completedSteps==this._totalSteps}set waitPeriodSeconds(e){this._waitPeriodSeconds=e}get waitPeriodSeconds(){if(this._waitPeriodSeconds<1)return 0;const t=new Date().getTime()-this._receiveTime.getTime();return Math.max(0,this._waitPeriodSeconds-Math.floor(t/1e3))}getCampaignLocalizationKey(){return rh.getCampaignLocalizationKeyForCode(this.campaignCode)}getQuestLocalizationKey(){return this.getCampaignLocalizationKey()+"."+this._localizationCode}get completedCampaign(){return this._id<1}get lastQuestInCampaign(){return this._completedQuestsInCampaign>=this._questCountInCampaign}get receiveTime(){return this._receiveTime}get sortOrder(){return this._sortOrder}get catalogPageName(){return this._catalogPageName}get chainCode(){return this._chainCode}get easy(){return this._easy}get expireTime(){return this._expireTime}get timeToExpire(){const e=Date.now(),i=this.expireTime*1e3-e,r=Math.round(i/1e3),n=Math.round(r/60),o=Math.round(n/60),l=Math.round(o/24);return l>0?l+" dia"+(l>1?"s":""):o>0?o+" hora"+(o>1?"s":""):n>0?n+" minuto"+(n>1?"s":""):r>0?r+" segundo"+(r>1?"s":""):"Expirado"}get questCaption(){return"quests.category.code.chaincaption=".replace("category",this.campaignCode).replace("code",this.chainCode)}get questName(){return"quests.category.code.name=".replace("category",this.campaignCode).replace("code",this.localizationCode)}get questDesc(){return"quests.category.code.desc=".replace("category",this.campaignCode).replace("code",this.localizationCode)}get questHint(){return"quests.category.code.hint=".replace("category",this.campaignCode).replace("code",this.localizationCode)}get currencyIcon(){switch(this.activityPointType){case 0:return 6;case 1:return 5;case 2:return 0;case 3:return-1}}}class OK{flush(){return this._questData=null,!0}parse(e){return e?(this._questData=new rh(e),this._showDialog=e.readBoolean(),!0):!1}get questData(){return this._questData}get showDialog(){return this._showDialog}}class CK{flush(){return this._quest=null,!0}parse(e){return e?(e.readBoolean()&&(this._quest=new rh(e),this._easyQuestCount=e.readInt(),this._hardQuestCount=e.readInt()),!0):!1}get quest(){return this._quest}get easyQuestCount(){return this._easyQuestCount}get hardQuestCount(){return this._hardQuestCount}}class NK{flush(){return this._quest=null,!0}parse(e){return e?(this._quest=new rh(e),!0):!1}get quest(){return this._quest}}class AK{flush(){return this._quests=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let i=0;i<t;i++)this._quests.push(new rh(e));return this._openWindow=e.readBoolean(),!0}get quests(){return this._quests}get openWindow(){return this._openWindow}}class bK{flush(){return this._quests=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let i=0;i<t;i++)this._quests.push(new rh(e));return!0}get quests(){return this._quests}}class vK{flush(){return this._recyclerFinishedStatus=-1,this._prizeId=0,!0}parse(e){return e?(this._recyclerFinishedStatus=e.readInt(),this._prizeId=e.readInt(),!0):!1}get recyclerFinishedStatus(){return this._recyclerFinishedStatus}get prizeId(){return this._prizeId}}class yK{flush(){return this._recyclerStatus=-1,this._recyclerTimeoutSeconds=0,!0}parse(e){return e?(this._recyclerStatus=e.readInt(),this._recyclerTimeoutSeconds=e.readInt(),!0):!1}get recyclerStatus(){return this._recyclerStatus}get recyclerTimeoutSeconds(){return this._recyclerTimeoutSeconds}}class Rh{constructor(e){this._allowedFurniSources=Rh.readAllowedSources(e),this._allowedUserSources=Rh.readAllowedSources(e),this._defaultFurniSources=Rh.readDefaultSources(e),this._defaultUserSources=Rh.readDefaultSources(e)}static readAllowedSources(e){let t=0,i=0,r=0;const n=[],o=e.readInt();for(t=0;t<o;){for(n[t]=[],r=e.readInt(),i=0;i<r;)n[t][i]=e.readInt(),i++;t++}return n}static readDefaultSources(e){let t=0,i=[],r=e.readInt();for(t=0;t<r;)i.push(e.readInt()),t++;return i}get amountFurniSelections(){return this._allowedFurniSources.length}getAllowedFurniSources(e){return this._allowedFurniSources[e]}get getAllAllowedFurniSources(){return this._allowedFurniSources}get amountUserSelections(){return this._allowedUserSources.length}getAllowedUserSources(e){return this._allowedUserSources[e]}get getAllAllowedUserSources(){return this._allowedUserSources}get defaultFurniSources(){return this._defaultFurniSources}get defaultUserSources(){return this._defaultUserSources}isUsingAdvancedSettings(e,t){let i=0;for(;i<this._defaultFurniSources.length;){if(this._defaultFurniSources[i]!==e[i])return!0;i++}for(i=0;i<this._defaultUserSources.length;){if(this._defaultUserSources[i]!==t[i])return!0;i++}return!1}allowFurniSelection(){let e=0;for(;e<this.amountFurniSelections;){if(this.getAllowedFurniSources(e).indexOf(100)!=-1||this.getAllowedFurniSources(e).indexOf(101)!=-1)return!0;e++}return!1}isFurniSelectionDefault(){return this._defaultFurniSources.indexOf(100)!=-1||this._defaultFurniSources.indexOf(101)!=-1}isDualFurniPickingMode(){let e=!1,t=!1;for(let i=0;i<this.amountFurniSelections;i++)this.getAllowedFurniSources(i).indexOf(100)!==-1&&(e=!0),this.getAllowedFurniSources(i).indexOf(101)!==-1&&(t=!0);return e&&t}}const cl=class cl{};cl.ALL_VARIABLES_IN_ROOM=0,cl.FURNI_VARIABLE_INFO=1,cl.USER_VARIABLE_INFO=2,cl.GLOBAL_VARIABLE_INFO=3,cl.REFERENCE_VARIABLES_LIST=4,cl.VARIABLE_LIST=5,cl.SHARED_GLOBAL_PLACEHOLDERS=6;let $o=cl;const eI=class eI{get variables(){return[]}};eI.EMPTY=new eI;let bR=eI;class DK extends bR{constructor(e){super(),this._hash=e.readInt()}get variables(){return this._variables}get needsSynchronize(){return this._variables==null}get hash(){return this._hash}synchronize(e){this._variables=[],e&&(this._variables=e)}}class oT{constructor(){this._length=0,this._dictionary=new Map,this._values=[],this._keys=[]}get length(){return this._length}get disposed(){return this._dictionary==null}dispose(){this._dictionary!=null&&(this._dictionary.clear(),this._dictionary=null),this._length=0,this._values=null,this._keys=null}reset(){this._dictionary.clear(),this._length=0,this._values=[],this._keys=[]}unshift(e,t){return this._dictionary.has(e)?!1:(this._dictionary.set(e,t),this._values.unshift(t),this._keys.unshift(e),this._length++,!0)}add(e,t){return this._dictionary.has(e)?!1:(this._dictionary.set(e,t),this._values[this._length]=t,this._keys[this._length]=e,this._length++,!0)}remove(e){const t=this._dictionary.get(e);if(t==null)return null;const i=this._values.indexOf(t);return i>=0&&(this._values.splice(i,1),this._keys.splice(i,1),this._length--),this._dictionary.delete(e),t}getWithIndex(e){return e<0||e>=this._length?null:this._values[e]}getKey(e){return e<0||e>=this._length?null:this._keys[e]}getKeys(){return this._keys.slice()}hasKey(e){return this._keys.indexOf(e)>-1}getValue(e){return this._dictionary.get(e)}getValues(){return this._values.slice()}hasValue(e){return this._values.indexOf(e)>-1}indexOf(e){return this._values.indexOf(e)}concatenate(e){const t=e.getKeys();for(const i of t)this.add(i,e.getValue(i))}clone(){const e=new oT;return e.concatenate(this),e}getProperty(e){return this._dictionary.get(e)}setProperty(e,t){this._dictionary.set(e,t);const i=this._keys.indexOf(e);i===-1?(this._values[this._length]=t,this._keys[this._length]=e,this._length++):this._values.splice(i,1,t)}nextNameIndex(e){return e<this._length?e+1:0}nextName(e){return this._keys[e-1]}nextValue(e){return this._values[e-1]}callProperty(e,...t){return e==="toString"?"Map":null}}class dm{constructor(e){if(this._variableId=e.readInt(),this._variableName=e.readString(),this._availabilityType=e.readInt(),this._variableType=e.readInt(),this._variableTarget=e.readInt(),this._alwaysAvailable=e.readBoolean(),this._canCreateAndDelete=e.readBoolean(),this._hasValue=e.readBoolean(),this._canWriteValue=e.readBoolean(),this._canInterceptChanges=e.readBoolean(),this._isInvisible=e.readBoolean(),this._canReadCreationTime=e.readBoolean(),this._canReadLastUpdateTime=e.readBoolean(),e.readBoolean()){this._textConnector=new oT;let i=e.readInt();for(;i>0;){let r=e.readInt(),n=e.readString();this._textConnector.add(r,n),i--}}}get variableId(){return this._variableId}get variableName(){return this._variableName}get availabilityType(){return this._availabilityType}get variableType(){return this._variableType}get variableTarget(){return this._variableTarget}get alwaysAvailable(){return this._alwaysAvailable}get canCreateAndDelete(){return this._canCreateAndDelete}get hasValue(){return this._hasValue}get canWriteValue(){return this._canWriteValue}get canInterceptChanges(){return this._canInterceptChanges}get isInvisible(){return this._isInvisible}get canReadCreationTime(){return this._canReadCreationTime}get canReadLastUpdateTime(){return this._canReadLastUpdateTime}get textConnector(){return this._textConnector}get hasTextConnector(){return this._textConnector!=null}get isStored(){return this._availabilityType<100}}class MK{constructor(e){this._objectId=e.readInt(),this._value=e.readInt()}get objectId(){return this._objectId}get value(){return this._value}}class vR{constructor(e){this._variable=new dm(e),this._holders=[];let t=e.readInt();for(;t>0;)this._holders.push(new MK(e)),t--}get holders(){return this._holders}get variable(){return this._variable}}class jK{constructor(e){this._variable=new dm(e),this._value=e.readInt()}get variable(){return this._variable}get value(){return this._value}}class LK{constructor(e){this._roomId=e.readInt(),this._roomName=e.readString(),this._wiredVariable=new dm(e)}get wiredVariable(){return this._wiredVariable}get roomId(){return this._roomId}get roomName(){return this._roomName}}class PK{constructor(e){this._variables=[],this._sharedVariables=[];let t=e.readInt();for(;t>0;){let i=new LK(e);this._sharedVariables.push(i),this._variables.push(i.wiredVariable),t--}}get sharedVariables(){return this._sharedVariables}get variables(){return this._variables}}class UK{constructor(e){this._variable=[];const t=e.readInt();for(let i=0;i<t;i++){const r=new dm(e);this._variable.push(r)}}get variables(){return this._variable}}class wK{constructor(e){this._roomId=e.readInt(),this._roomName=e.readString(),this._placeholderName=e.readString()}get roomId(){return this._roomId}get roomName(){return this._roomName}get placeholderName(){return this._placeholderName}}class FK{constructor(e){this._sharedPlaceholders=[];const t=e.readInt();for(let i=0;i<t;i++)this._sharedPlaceholders.push(new wK(e))}get sharedPlaceholders(){return this._sharedPlaceholders}}const tI=class tI{constructor(e){if(this._roomVariablesList=null,this._furniVariableInfo=null,this._userVariableInfo=null,this._globalVariableInfo=null,this._referenceVariablesList=null,this._rulesetVariables=null,this._referencePlaceholderList=null,!e)return;let t=e.readInt();for(;t>0;){switch(e.readInt()){case $o.ALL_VARIABLES_IN_ROOM:this._roomVariablesList=new DK(e);break;case $o.FURNI_VARIABLE_INFO:this._furniVariableInfo=new vR(e);break;case $o.USER_VARIABLE_INFO:this._userVariableInfo=new vR(e);break;case $o.GLOBAL_VARIABLE_INFO:this._globalVariableInfo=new jK(e);break;case $o.REFERENCE_VARIABLES_LIST:this._referenceVariablesList=new PK(e);break;case $o.VARIABLE_LIST:this._rulesetVariables=new UK(e);break;case $o.SHARED_GLOBAL_PLACEHOLDERS:this._referencePlaceholderList=new FK(e)}t--}}get roomVariablesList(){return this._roomVariablesList}get furniVariableInfo(){return this._furniVariableInfo}get userVariableInfo(){return this._userVariableInfo}get globalVariableInfo(){return this._globalVariableInfo}get referenceVariablesList(){return this._referenceVariablesList}get rulesetVariables(){return this._rulesetVariables}get referencePlaceholderList(){return this._referencePlaceholderList}};tI.EMPTY=new tI(null);let zf=tI;class qd{constructor(e){this._stuffIds=[],this._stuffIds2=[],this._intParams=[],this._furniSourceTypes=[],this._userSourceTypes=[],this._variableIds=[],this._furniLimit=e.readInt();let t=e.readInt();for(;t>0;)this._stuffIds.push(e.readInt()),t--;for(t=e.readInt();t>0;)this._stuffIds2.push(e.readInt()),t--;for(this._stuffTypeId=e.readInt(),this._id=e.readInt(),this._stringParam=e.readString(),t=e.readInt();t>0;)this._intParams.push(e.readInt()),t--;for(t=e.readInt();t>0;)this._variableIds.push(e.readInt()),t--;for(t=e.readInt();t>0;)this._furniSourceTypes.push(e.readInt()),t--;for(t=e.readInt();t>0;)this._userSourceTypes.push(e.readInt()),t--;this._stuffTypeSelectionCode=e.readInt(),this.readDefinitionSpecifics(e),this._advancedMode=e.readBoolean(),this._inputSourcesConf=new Rh(e),this._allowWallFurni=e.readBoolean(),this.readTypeSpecifics(e),this._wiredContext=e.bytesAvailable?new zf(e):zf.EMPTY}get wiredContext(){return this._wiredContext}get variableIds(){return this._variableIds}get id(){return this._id}get stuffTypeSelectionCode(){return this._stuffTypeSelectionCode}set stuffTypeSelectionCode(e){this._stuffTypeSelectionCode=e}get furniSourceTypes(){return this._furniSourceTypes}get userSourceTypes(){return this._userSourceTypes}get advancedMode(){return this._advancedMode}get inputSourcesConf(){return this._inputSourcesConf}get allowWallFurni(){return this._allowWallFurni}get maximumItemSelectionCount(){return this._furniLimit}get selectedItems(){return this._stuffIds}get selectedItems2(){return this._stuffIds2}get stringData(){return this._stringParam}get intData(){return this._intParams}get code(){return 0}get spriteId(){return this._stuffTypeId}get usingCustomInputSources(){return this._inputSourcesConf.isUsingAdvancedSettings(this._furniSourceTypes,this._userSourceTypes)}getBoolean(e){return this._intParams[e]==1}readDefinitionSpecifics(e){}readTypeSpecifics(e){}}class _m extends qd{constructor(e){super(e)}readDefinitionSpecifics(e){this._quantifierCode=e.readInt(),this._quantifierType=e.readInt(),this._isInvert=e.readBoolean()}get quantifierCode(){return this._quantifierCode}get quantifierType(){return this._quantifierType}get isInvert(){return this._isInvert}get usingCustomInputSources(){return super.usingCustomInputSources||this.quantifierCode!=0}}class hC extends qd{constructor(e){super(e)}}class dC extends qd{constructor(e){super(e)}readDefinitionSpecifics(e){this._delayInPulses=e.readInt()}get delayInPulses(){return this._delayInPulses}}class _C extends qd{constructor(e){super(e)}readDefinitionSpecifics(e){this._isFilter=e.readBoolean(),this._isInvert=e.readBoolean()}get isFilter(){return this._isFilter}get isInvert(){return this._isInvert}}class gC extends qd{constructor(e){super(e)}}class kK{flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new dC(e),!0):!1}get def(){return this._definition}}class GK{flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new _m(e),!0):!1}get def(){return this._definition}}class BK{flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new hC(e),!0):!1}get def(){return this._definition}}class VK{flush(){return this.definition=null,!0}parse(e){return this.definition=new gC(e),!0}get def(){return this.definition}}class HK{flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new _C(e),!0):!1}get def(){return this._definition}}class WK{flush(){return this._stuffId=0,!0}parse(e){return e?(this._stuffId=e.readInt(),!0):!1}get stuffId(){return this._stuffId}}class YK{flush(){return this._reason=0,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}class zK{flush(){return!0}parse(e){return!!e}}class KK{flush(){return this._info=null,!0}parse(e){return e?(this._info=e.readString(),!0):!1}get info(){return this._info}}class xh{static parseUserMove(e){const t=e.readInt(),i=e.readInt(),r=e.readInt(),n=e.readInt(),o=Number(e.readString()),l=Number(e.readString()),c=e.readInt(),u=e.readInt(),d=e.readInt(),_=e.readInt(),m=e.readInt();return new l4(c,new Y(t,i,o),new Y(r,n,l),u==0?"mv":"sld",d,_,m)}static parseFurniMove(e){const t=e.readInt(),i=e.readInt(),r=e.readInt(),n=e.readInt(),o=Number(e.readString()),l=Number(e.readString()),c=e.readInt(),u=e.readInt(),d=e.readInt();return new c4(c,new Y(t,i,o),new Y(r,n,l),u,d)}static parseWallItemMove(e){const t=e.readInt(),i=e.readBoolean(),r=e.readInt(),n=e.readInt(),o=e.readInt(),l=e.readInt(),c=e.readInt(),u=e.readInt(),d=e.readInt(),_=e.readInt(),m=e.readInt();return new u4(t,i,r,n,o,l,c,u,d,_,m)}static parseUserDirUpdate(e){const t=e.readInt(),i=e.readInt(),r=e.readInt();return new h4(t,i,r)}flush(){return this._userMoves=null,this._furniMoves=null,this._wallItemMoves=null,this._userDirUpdates=null,!0}parse(e){if(!e)return!1;this._userMoves=[],this._furniMoves=[],this._wallItemMoves=[],this._userDirUpdates=[];const t=e.readInt();for(let i=0;i<t;i++)switch(e.readInt()){case 0:this._userMoves.push(xh.parseUserMove(e));break;case 1:this._furniMoves.push(xh.parseFurniMove(e));break;case 2:this._wallItemMoves.push(xh.parseWallItemMove(e));break;case 3:this._userDirUpdates.push(xh.parseUserDirUpdate(e))}return!0}get userMoves(){return this._userMoves}get furniMoves(){return this._furniMoves}get wallItemMoves(){return this._wallItemMoves}get userDirUpdates(){return this._userDirUpdates}}class qK{flush(){return this._index=0,this._openMenu=!1,!0}parse(e){return e?(this._index=e.readInt(),this._openMenu=e.readBoolean(),!0):!1}get index(){return this._index}get openMenu(){return this._openMenu}}class XK{flush(){return this._hasClickUserWired=!1,!0}parse(e){return e?(this._hasClickUserWired=e.readBoolean(),!0):!1}get hasClickUserWired(){return this._hasClickUserWired}}const $h=class $h{constructor(e){this._userIndex=-1,this._objectId=-1,this._type=e.readInt(),this._type===$h.TYPE_OBJECT?this._objectId=e.readInt():this._type===$h.TYPE_USER&&(this._userIndex=e.readInt()),this._variableValues=new Map;const t=e.readInt();for(let i=0;i<t;i++){const r=e.readString(),n=e.readString();this._variableValues.set(r,n)}}get type(){return this._type}get userIndex(){return this._userIndex}get objectId(){return this._objectId}get variableValues(){return this._variableValues}};$h.TYPE_OBJECT=0,$h.TYPE_USER=1;let db=$h;class $K{flush(){return!0}parse(e){return!!e}}class QK{flush(){return!0}parse(e){return!0}}class JK{constructor(){this._songDisks=new Ms}flush(){return this._songDisks.reset(),this._maxLength=0,!0}parse(e){this._maxLength=e.readInt();const t=e.readInt();for(let i=0;i<t;i++)this._songDisks.add(e.readInt(),e.readInt());return!0}get songDisks(){return this._songDisks}get maxLength(){return this._maxLength}}class ZK{flush(){return this._currentSongId=-1,this._currentPosition=-1,this._nextSongId=-1,this._nextPosition=-1,this._syncCount=-1,!0}parse(e){return this._currentSongId=e.readInt(),this._currentPosition=e.readInt(),this._nextSongId=e.readInt(),this._nextPosition=e.readInt(),this._syncCount=e.readInt(),!0}get currentSongId(){return this._currentSongId}get currentPosition(){return this._currentPosition}get nextSongId(){return this._nextSongId}get nextPosition(){return this._nextPosition}get syncCount(){return this._syncCount}}class e7{flush(){return this._songId=0,this._officialSongId="",!0}parse(e){return this._officialSongId=e.readString(),this._songId=e.readInt(),!0}get songId(){return this._songId}get officialSongId(){return this._officialSongId}}class lT{constructor(e,t,i,r){this._startPlayHead=0,this._id=e,this._length=t,this._name=i,this._creator=r}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get startPlayHeadPos(){return this._startPlayHead}set startPlayHeadPos(e){this._startPlayHead=e}}class t7{flush(){return this._synchronizationCount=-1,this._playlist=[],!0}parse(e){this._synchronizationCount=e.readInt();const t=e.readInt();for(let i=0;i<t;i++)this._playlist.push(new lT(e.readInt(),e.readInt(),e.readString(),e.readString()));return!0}get synchronizationCount(){return this._synchronizationCount}get playList(){return this._playlist}}class s7{flush(){return this._entry=null,!0}parse(e){return this._entry=new lT(e.readInt(),e.readInt(),e.readString(),e.readString()),!0}get entry(){return this._entry}}class i7 extends lT{constructor(e,t,i,r,n){super(e,t,i,r),this._data="",this._data=n}get data(){return this._data}}class r7{flush(){return this._songs=[],!0}parse(e){const t=e.readInt();for(let i=0;i<t;i++){const r=e.readInt();e.readString();const n=e.readString(),o=e.readString(),l=e.readInt(),c=e.readString(),u=new i7(r,l,n,c,o);this._songs.push(u)}return!0}get songs(){return this._songs}}class n7{constructor(){this._songDiskInventory=new Ms}flush(){return this._songDiskInventory.reset(),!0}parse(e){const t=e.readInt();for(let i=0;i<t;i++)this._songDiskInventory.add(e.readInt(),e.readInt());return!0}getDiskId(e){return e>=0&&e<this._songDiskInventory.length?this._songDiskInventory.getKey(e):-1}getSongId(e){return e>=0&&e<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(e):-1}get songDiskCount(){return this._songDiskInventory.length}}class a7{flush(){return this._soundName=null,this._volume=0,!0}parse(e){return e?(this._soundName=e.readString(),this._volume=e.readInt(),this._loop=e.readBoolean(),!0):!1}get soundName(){return this._soundName}get volume(){return this._volume}get loop(){return this._loop}}class o7{flush(){return this._soundName=null,this._volume=0,!0}parse(e){return e?(this._soundName=e.readString(),this._volume=e.readInt(),!0):!1}get soundName(){return this._soundName}get volume(){return this._volume}}class l7{flush(){return!0}parse(e){return!0}}class c7{flush(){return this._categories=new Map,!0}parse(e){if(!e)return!1;const t=e.readInt();for(let i=0;i<t;i++){const r=e.readString(),n=e.readInt(),o=[];for(let l=0;l<n;l++)o.push(e.readString());this._categories.set(r,o.sort((l,c)=>l.localeCompare(c)))}return this._categories=new Map([...this._categories].sort((i,r)=>i[0].localeCompare(r[0]))),!0}get categories(){return this._categories}}class u7{flush(){return this._categories=new Map,!0}parse(e){if(!e)return!1;const t=e.readInt();for(let i=0;i<t;i++){const r=e.readString(),n=e.readInt(),o=[];for(let l=0;l<n;l++)o.push(e.readString());this._categories.set(r,o.sort((l,c)=>l.localeCompare(c)))}return this._categories=new Map([...this._categories].sort((i,r)=>i[0].localeCompare(r[0]))),!0}get categories(){return this._categories}}class h7{flush(){return this._talentTrackName=null,this._level=-1,this._rewardPerks=[],this._rewardProducts=[],!0}parse(e){if(!e)return!1;let t=0;this._talentTrackName=e.readString(),this._level=e.readInt();const i=e.readInt();for(;t<i;)this._rewardPerks.push(new f7(e)),t++;const r=e.readInt();if(t<r)for(let n=0;n<r;n++){const o=e.readString(),l=e.readInt();this._rewardProducts.push(new _D(o,l)),t++}return!0}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get rewardPerks(){return this._rewardPerks}get rewardProducts(){return this._rewardProducts}}class d7{constructor(e,t,i,r,n){this._level=e,this._state=t,this._tasks=i,this._rewardPerks=r,this._rewardProducts=n}get level(){return this._level}get state(){return this._state}get tasks(){return this._tasks}get perks(){return this._rewardPerks}get items(){return this._rewardProducts}}class _7{flush(){return this._talentTrackName=null,this._level=-1,this._maxLevel=-1,!0}parse(e){return e?(this._talentTrackName=e.readString(),this._level=e.readInt(),this._maxLevel=e.readInt(),!0):!1}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get maxLevel(){return this._maxLevel}}class _D{constructor(e,t){this._productCode=e,this._vipDays=t}get productCode(){return this._productCode}get vipDays(){return this._vipDays}}class g7{constructor(e,t,i,r,n,o){this._id=e,this._requiredLevel=t,this._badgeCode=i,this._state=r,this._currentScore=n,this._totalScore=o}get id(){return this._id}get requiredLevel(){return this._requiredLevel}get badgeCode(){return this._badgeCode}get state(){return this._state}get currentScore(){return this._currentScore}get totalScore(){return this._totalScore}}class m7{flush(){return this._type=null,this._levels=null,!0}parse(e){if(!e)return!1;this._type=e.readString(),this._levels=[];const t=e.readInt();for(let i=0;i<t;i++){const r=e.readInt(),n=e.readInt(),o=[],l=e.readInt();for(let m=0;m<l;m++){const f=e.readInt(),E=e.readInt(),I=e.readString(),p=e.readInt(),S=e.readInt(),R=e.readInt();o.push(new g7(f,E,I,p,S,R))}const c=[],u=e.readInt();for(let m=0;m<u;m++)c.push(e.readString());const d=[],_=e.readInt();for(let m=0;m<_;m++){const f=e.readString(),E=e.readInt();d.push(new _D(f,E))}this._levels.push(new d7(r,n,o,c,d))}return!0}get type(){return this._type}get levels(){return this._levels}}class f7{constructor(e){this._perkId=e.readInt()}get perkId(){return this._perkId}}class p7{flush(){return this._classifiedUsersNames&&(this._classifiedUsersNames=new Map),this._classifiedUsersClass&&(this._classifiedUsersClass=new Map),!0}parse(e){if(!e)return!1;let t,i,r,n=e.readInt();for(this._classifiedUsersNames=new Map,this._classifiedUsersClass=new Map;n>0;)t=e.readInt(),i=e.readString(),r=e.readString(),this._classifiedUsersNames.set(t,i),this._classifiedUsersClass.set(t,r),n--;return!0}get classifiedUsernameMap(){return this._classifiedUsersNames}get classifiedUserTypeMap(){return this._classifiedUsersClass}}class E7{flush(){return this._instantlyRefreshCatalogue=!1,this._newFurniDataHash=null,!0}parse(e){return e?(this._instantlyRefreshCatalogue=e.readBoolean(),e.bytesAvailable&&(this._newFurniDataHash=e.readString()),!0):!1}get instantlyRefreshCatalogue(){return this._instantlyRefreshCatalogue}get newFurniDataHash(){return this._newFurniDataHash}}class I7{flush(){return this._snowImpulses=0,this._sandImpulses=0,this._rankingSnow=[],this._rankingSand=[],this._checkpointRatio=0,this._numCheckpoints=0,!0}parse(e){if(!e)return!1;this._snowImpulses=e.readInt(),this._sandImpulses=e.readInt();const t=e.readInt();for(let r=0;r<t;r++)this._rankingSnow.push({id:e.readInt(),amount:e.readInt()});const i=e.readInt();for(let r=0;r<i;r++)this._rankingSand.push({id:e.readInt(),amount:e.readInt()});return this._checkpointRatio=e.readInt(),this._numCheckpoints=e.readInt(),!0}get snowImpulses(){return this._snowImpulses}get sandImpulses(){return this._sandImpulses}get rankingSnow(){return this._rankingSnow}get rankingSand(){return this._rankingSand}get checkpointRatio(){return this._checkpointRatio}get numCheckpoints(){return this._numCheckpoints}}class T7{flush(){return this._status=!1,!0}parse(e){if(!e)return!1;this._status=e.readBoolean()}get status(){return this._status}}class S7 extends w{constructor(e){super(e,k2)}getParser(){return this.parser}}class R7 extends w{constructor(e){super(e,G2)}getParser(){return this.parser}}class gD extends w{constructor(e){super(e,B2)}getParser(){return this.parser}}class x7 extends w{constructor(e){super(e,V2)}getParser(){return this.parser}}class mD extends w{constructor(e){super(e,H2)}getParser(){return this.parser}}class fD extends w{constructor(e){super(e,W2)}getParser(){return this.parser}}class pD extends w{constructor(e){super(e,Y2)}getParser(){return this.parser}}class ED extends w{constructor(e){super(e,z2)}getParser(){return this.parser}}const co=class co extends w{constructor(e){super(e,K2)}getParser(){return this.parser}};co.NAME_OK=0,co.ERROR_NAME_REQUIRED=1,co.ERROR_NAME_TOO_SHORT=2,co.ERROR_NAME_TOO_LONG=3,co.ERROR_NAME_NOT_VALID=4,co.ERROR_NAME_IN_USE=5,co.ERROR_NAME_CHANGE_NOT_ALLOWED=6,co.ERROR_MERGE_HOTEL_DOWN=7;let kg=co;class ID extends w{constructor(e){super(e,q2)}getParser(){return this.parser}}class mC extends w{constructor(e){super(e,X2)}getParser(){return this.parser}}class O7 extends w{constructor(e){super(e,Q2)}getParser(){return this.parser}}class TD extends w{constructor(e){super(e,J2)}getParser(){return this.parser}}class SD extends w{constructor(e){super(e,Z2)}getParser(){return this.parser}}class C7 extends w{constructor(e){super(e,eH)}getParser(){return this.parser}}class RD extends w{constructor(e){super(e,tH)}getParser(){return this.parser}}class xD extends w{constructor(e){super(e,nH)}getParser(){return this.parser}}class OD extends w{constructor(e){super(e,aH)}getParser(){return this.parser}}class CD extends w{constructor(e){super(e,oH)}getParser(){return this.parser}}class ND extends w{constructor(e){super(e,lH)}getParser(){return this.parser}}class AD extends w{constructor(e){super(e,cH)}getParser(){return this.parser}}class N7 extends w{constructor(e){super(e,uH)}getParser(){return this.parser}}class bD extends w{constructor(e){super(e,hH)}getParser(){return this.parser}}class A7 extends w{constructor(e){super(e,dH)}getParser(){return this.parser}}class vD extends w{constructor(e){super(e,_H)}getParser(){return this.parser}}class b7 extends w{constructor(e){super(e,gH)}getParser(){return this.parser}}class yD extends w{constructor(e){super(e,mH)}getParser(){return this.parser}}class DD extends w{constructor(e){super(e,fH)}getParser(){return this.parser}}class MD extends w{constructor(e){super(e,pH)}getParser(){return this.parser}}class jD extends w{constructor(e){super(e,EH)}getParser(){return this.parser}}class LD extends w{constructor(e){super(e,IH)}getParser(){return this.parser}}class PD extends w{constructor(e){super(e,TH)}getParser(){return this.parser}}class v7 extends w{constructor(e){super(e,RH)}getParser(){return this.parser}}class y7 extends w{constructor(e){super(e,CH)}getParser(){return this.parser}}class UD extends w{constructor(e){super(e,NH)}getParser(){return this.parser}}class wD extends w{constructor(e){super(e,xH)}getParser(){return this.parser}}class D7 extends w{constructor(e){super(e,AH)}getParser(){return this.parser}}class FD extends w{constructor(e){super(e,bH)}getParser(){return this.parser}}class fC extends w{constructor(e){super(e,yH)}getParser(){return this.parser}}class kD extends w{constructor(e){super(e,DH)}getParser(){return this.parser}}class M7 extends w{constructor(e){super(e,jH)}getParser(){return this.parser}}class j7 extends w{constructor(e){super(e,PH)}getParser(){return this.parser}}class GD extends w{constructor(e){super(e,UH)}getParser(){return this.parser}}class BD extends w{constructor(e){super(e,wH)}getParser(){return this.parser}}class L7 extends w{constructor(e){super(e,FH)}getParser(){return this.parser}}class VD extends w{constructor(e){super(e,kH)}getParser(){return this.parser}}class P7 extends w{constructor(e){super(e,GH)}getParser(){return this.parser}}class HD extends w{constructor(e){super(e,BH)}getParser(){return this.parser}}class U7 extends w{constructor(e){super(e,VH)}getParser(){return this.parser}}class w7 extends w{constructor(e){super(e,HH)}getParser(){return this.parser}}class WD extends w{constructor(e){super(e,WH)}getParser(){return this.parser}}class YD extends w{constructor(e){super(e,YH)}getParser(){return this.parser}}class zD extends w{constructor(e){super(e,zH)}getParser(){return this.parser}}class KD extends w{constructor(e){super(e,qH)}getParser(){return this.parser}}class qD extends w{constructor(e){super(e,rY)}getParser(){return this.parser}}class F7 extends w{constructor(e){super(e,nY)}getParser(){return this.parser}}class XD extends w{constructor(e){super(e,oY)}getParser(){return this.parser}}class $D extends w{constructor(e){super(e,uY)}getParser(){return this.parser}}class k7 extends w{constructor(e){super(e,cY)}getParser(){return this.parser}}class QD extends w{constructor(e){super(e,hY)}getParser(){return this.parser}}class JD extends w{constructor(e){super(e,dY)}getParser(){return this.parser}}class ZD extends w{constructor(e){super(e,_Y)}getParser(){return this.parser}}class eM extends w{constructor(e){super(e,gY)}getParser(){return this.parser}}class G7 extends w{constructor(e){super(e,uR)}getParser(){return this.parser}}class B7 extends w{constructor(e){super(e,mY)}getParser(){return this.parser}}class V7 extends w{constructor(e){super(e,fY)}getParser(){return this.parser}}class H7 extends w{constructor(e){super(e,pY)}getParser(){return this.parser}}class W7 extends w{constructor(e){super(e,EY)}getParser(){return this.parser}}class Y7 extends w{constructor(e){super(e,IY)}getParser(){return this.parser}}class tM extends w{constructor(e){super(e,TY)}getParser(){return this.parser}}class sM extends w{constructor(e){super(e,RY)}getParser(){return this.parser}}class iM extends w{constructor(e){super(e,xY)}getParser(){return this.parser}}class rM extends w{constructor(e){super(e,OY)}getParser(){return this.parser}}class Gg extends w{constructor(e){super(e,CY)}getParser(){return this.parser}}class z7 extends w{constructor(e){super(e,AY)}getParser(){return this.parser}}class K7 extends w{constructor(e){super(e,bY)}getParser(){return this.parser}}class q7 extends w{constructor(e){super(e,vY)}getParser(){return this.parser}}class nM extends w{constructor(e){super(e,yY)}getParser(){return this.parser}}class aM extends w{constructor(e){super(e,DY)}getParser(){return this.parser}}class X7 extends w{constructor(e){super(e,MY)}getParser(){return this.parser}}class oM extends w{constructor(e){super(e,jY)}getParser(){return this.parser}}class lM extends w{constructor(e){super(e,LY)}getParser(){return this.parser}}class $7 extends w{constructor(e){super(e,PY)}getParser(){return this.parser}}class Q7 extends w{constructor(e){super(e,UY)}getParser(){return this.parser}}class cM extends w{constructor(e){super(e,wY)}getParser(){return this.parser}}class J7 extends w{constructor(e){super(e,FY)}getParser(){return this.parser}}class Z7 extends w{constructor(e){super(e,kY)}getParser(){return this.parser}}class pC extends w{constructor(e){super(e,GY)}getParser(){return this.parser}}class EC extends w{constructor(e){super(e,BY)}getParser(){return this.parser}}class uM extends w{constructor(e){super(e,VY)}getParser(){return this.parser}}class IC extends w{constructor(e){super(e,HY)}getParser(){return this.parser}}class hM extends w{constructor(e){super(e,WY)}getParser(){return this.parser}}class eq extends w{constructor(e){super(e,_R)}getParser(){return this.parser}}class tq extends w{constructor(e){super(e,YY)}getParser(){return this.parser}}class sq extends w{constructor(e){super(e,gR)}getParser(){return this.parser}}class iq extends w{constructor(e){super(e,mR)}getParser(){return this.parser}}class rq extends w{constructor(e){super(e,zY)}getParser(){return this.parser}}class nq extends w{constructor(e){super(e,KY)}getParser(){return this.parser}}class aq extends w{constructor(e){super(e,qY)}getParser(){return this.parser}}class oq extends w{constructor(e){super(e,XY)}getParser(){return this.parser}}class lq extends w{constructor(e){super(e,$Y)}getParser(){return this.parser}}class cq extends w{constructor(e){super(e,JY)}getParser(){return this.parser}}class uq extends w{constructor(e){super(e,ez)}getParser(){return this.parser}}class dM extends w{constructor(e){super(e,tz)}getParser(){return this.parser}}class _M extends w{constructor(e){super(e,fR)}getParser(){return this.parser}}class hq extends w{constructor(e){super(e,sz)}getParser(){return this.parser}}class dq extends w{constructor(e){super(e,pR)}getParser(){return this.parser}}class _q extends w{constructor(e){super(e,iz)}getParser(){return this.parser}}class gq extends w{constructor(e){super(e,rz)}getParser(){return this.parser}}class TC extends w{constructor(e){super(e,nz)}getParser(){return this.parser}}class mq extends w{constructor(e){super(e,az)}getParser(){return this.parser}}class fq extends w{constructor(e){super(e,oz)}getParser(){return this.parser}}class pq extends w{constructor(e){super(e,aT)}getParser(){return this.parser}}class Eq extends w{constructor(e){super(e,aT)}getParser(){return this.parser}}class Iq extends w{constructor(e){super(e,aT)}getParser(){return this.parser}}class Tq extends w{constructor(e){super(e,aT)}getParser(){return this.parser}}class Sq extends w{constructor(e){super(e,cz)}getParser(){return this.parser}}class Rq extends w{constructor(e){super(e,uz)}getParser(){return this.parser}}class Kf extends w{constructor(e){super(e,hz)}getParser(){return this.parser}}class xq extends w{constructor(e){super(e,dz)}getParser(){return this.parser}}class Oq extends w{constructor(e){super(e,_z)}getParser(){return this.parser}}class Cq extends w{constructor(e){super(e,gz)}getParser(){return this.parser}}class SC extends w{constructor(e){super(e,mz)}getParser(){return this.parser}}class gM extends w{constructor(e){super(e,fz)}getParser(){return this.parser}}class mM extends w{constructor(e){super(e,pz)}getParser(){return this.parser}}class Xd extends w{constructor(e){super(e,Ez)}getParser(){return this.parser}}class fM extends w{constructor(e){super(e,Sz)}getParser(){return this.parser}}class pM extends w{constructor(e){super(e,Rz)}getParser(){return this.parser}}class EM extends w{constructor(e){super(e,xz)}getParser(){return this.parser}}class IM extends w{constructor(e){super(e,Oz)}getParser(){return this.parser}}class TM extends w{constructor(e){super(e,Cz)}getParser(){return this.parser}}class SM extends w{constructor(e){super(e,Nz)}getParser(){return this.parser}}class RM extends w{constructor(e){super(e,Az)}getParser(){return this.parser}}class xM extends w{constructor(e){super(e,bz)}getParser(){return this.parser}}class OM extends w{constructor(e){super(e,vz)}getParser(){return this.parser}}class CM extends w{constructor(e){super(e,yz)}getParser(){return this.parser}}class NM extends w{constructor(e){super(e,Dz)}getParser(){return this.parser}}class AM extends w{constructor(e){super(e,Mz)}getParser(){return this.parser}}class bM extends w{constructor(e){super(e,jz)}getParser(){return this.parser}}class Nq extends w{constructor(e){super(e,Lz)}getParser(){return this.parser}}const Ct=class Ct{};Ct.LOGOUT=0,Ct.JUST_BANNED=1,Ct.CONCURRENT_LOGIN=2,Ct.CONNECTION_LOST_TO_PEER=3,Ct.AVATAR_IDENTITY_CHANGE=4,Ct.REMOVE_FURNITURE_TOOL=5,Ct.STILL_BANNED=10,Ct.DUAL_LOGIN_BY_USERID=11,Ct.HOTEL_CLOSED=12,Ct.DUAL_LOGIN_BY_IP=13,Ct.PEER_CONNECTION_MISSING=16,Ct.NO_LOGIN_PERMISSION=17,Ct.DUPLICATE_CONNECTION=18,Ct.HOTEL_CLOSING=19,Ct.INCORRECT_PASSWORD=20,Ct.INVALID_LOGIN_TICKET=22,Ct.VERSION_CHECK_URL=23,Ct.VERSION_CHECK_PROPERTY=24,Ct.VERSION_CHECK_MACHINE_ID=25,Ct.NO_MESSENGER_SESSION=26,Ct.USER_NOT_FOUND=27,Ct.CRYPTO_NOT_INITIALIZED=28,Ct.DEV_CRYPTO_NOT_ALLOWED=29,Ct.DUPLICATE_UUID_DETECTED=100,Ct.OLD_SESSION_IN_PROXY=101,Ct.PUBLIC_KEY_NOT_NUMERIC=102,Ct.PUBLIC_KEY_TOO_SHORT=103,Ct.SOCKET_READ_GENERIC=104,Ct.SOCKET_READ_FIRST_BYTE=105,Ct.SOCKET_READ_LENGTH=106,Ct.SOCKET_READ_BODY=107,Ct.SOCKET_READ_POLICY=108,Ct.SOCKET_IO_EXCEPTION=109,Ct.SOCKET_WRONG_CRYPTO=110,Ct.PROXY_RUNTIME_EXCEPTION=111,Ct.IDLE_CONNECTION=112,Ct.PONG_TIMEOUT=113,Ct.IDLE_CONNECTION_NOT_AUTH=114,Ct.IDLE_CONNECTION_NO_USER_ID=115,Ct.WRITE_CLOSED_CHANNEL=116,Ct.SOCKET_WRITE_EXCEPTION_1=117,Ct.SOCKET_WRITE_EXCEPTION_2=118,Ct.SOCKET_WRITE_EXCEPTION_3=119;let Oh=Ct;class Aq extends w{constructor(e){super(e,Pz)}getParser(){return this.parser}get reasonString(){switch(this.getParser().reason){case Oh.JUST_BANNED:case Oh.STILL_BANNED:return"banned";case Oh.CONCURRENT_LOGIN:return"concurrentlogin";case Oh.INCORRECT_PASSWORD:return"incorrectpassword";default:return"logout"}}}class bq extends w{constructor(e){super(e,Uz)}getParser(){return this.parser}}class vq extends w{constructor(e){super(e,wz)}getParser(){return this.parser}}class vM extends w{constructor(e){super(e,Fz)}getParser(){return this.parser}}class yM extends w{constructor(e){super(e,kz)}getParser(){return this.parser}}class DM extends w{constructor(e){super(e,Gz)}getParser(){return this.parser}}class MM extends w{constructor(e){super(e,Bz)}getParser(){return this.parser}}class jM extends w{constructor(e){super(e,Vz)}getParser(){return this.parser}}class LM extends w{constructor(e){super(e,Hz)}getParser(){return this.parser}}class yq extends w{constructor(e){super(e,Wz)}getParser(){return this.parser}}class Dq extends w{constructor(e){super(e,Yz)}getParser(){return this.parser}}class Mq extends w{constructor(e){super(e,zz)}getParser(){return this.parser}}class jq extends w{constructor(e){super(e,Kz)}getParser(){return this.parser}}class Lq extends w{constructor(e){super(e,ER)}getParser(){return this.parser}}class PM extends w{constructor(e){super(e,qz)}getParser(){return this.parser}}class Pq extends w{constructor(e){super(e,IR)}getParser(){return this.parser}}class UM extends w{constructor(e){super(e,$z)}getParser(){return this.parser}}class wM extends w{constructor(e){super(e,Qz)}getParser(){return this.parser}}class RC extends w{constructor(e){super(e,Jz)}getParser(){return this.parser}}class xC extends w{constructor(e){super(e,TR)}getParser(){return this.parser}}class FM extends w{constructor(e){super(e,Zz)}getParser(){return this.parser}}class kM extends w{constructor(e){super(e,e4)}getParser(){return this.parser}}class GM extends w{constructor(e){super(e,t4)}getParser(){return this.parser}}class BM extends w{constructor(e){super(e,s4)}getParser(){return this.parser}}class OC extends w{constructor(e){super(e,i4)}getParser(){return this.parser}}class Uq extends w{constructor(e){super(e,SR)}getParser(){return this.parser}}class wq extends w{constructor(e){super(e,RR)}getParser(){return this.parser}}class Fq extends w{constructor(e){super(e,r4)}getParser(){return this.parser}}class VM extends w{constructor(e){super(e,n4)}getParser(){return this.parser}}class kq extends w{constructor(e){super(e,a4)}getParser(){return this.parser}}class Gq extends w{constructor(e){super(e,o4)}getParser(){return this.parser}}const L=class L{};L.ACHIEVEMENT_LIST=305,L.AUTHENTICATED=2491,L.AUTHENTICATION=-1,L.AVAILABILITY_STATUS=2033,L.BUILDERS_CLUB_EXPIRED=1452,L.CLUB_OFFERS=2405,L.CATALOG_PAGE=804,L.CATALOG_PAGE_LIST=1032,L.CATALOG_PURCHASE_OK=869,L.CATALOG_PURCHASE_ERROR=1404,L.CATALOG_PURCHASE_NOT_ALLOWED=3770,L.PRODUCT_OFFER=3388,L.LIMITED_SOLD_OUT=377,L.CATALOG_PUBLISHED=1866,L.CFH_RESULT_MESSAGE=3635,L.CLIENT_LATENCY=10,L.CLIENT_PING=3928,L.DESKTOP_CAMPAIGN=1745,L.DESKTOP_NEWS=286,L.DESKTOP_VIEW=122,L.BUNDLE_DISCOUNT_RULESET=2347,L.FIRST_LOGIN_OF_DAY=793,L.FURNITURE_ALIASES=1723,L.FURNITURE_DATA=2547,L.FURNITURE_FLOOR=1778,L.FURNITURE_FLOOR_ADD=1534,L.FURNITURE_FLOOR_REMOVE=2703,L.FURNITURE_FLOOR_UPDATE=3776,L.FURNITURE_ITEMDATA=2202,L.ONE_WAY_DOOR_STATUS=2011,L.FURNITURE_GROUP_CONTEXT_MENU_INFO=3293,L.FURNITURE_POSTIT_STICKY_POLE_OPEN=2366,L.GAME_CENTER_ACHIEVEMENTS=2265,L.GAME_CENTER_GAME_LIST=222,L.GAME_CENTER_STATUS=2893,L.GAME_CENTER_IN_ARENA_QUEUE=872,L.GAME_CENTER_STOP_COUNTER=3191,L.GAME_CENTER_USER_LEFT_GAME=3138,L.GAME_CENTER_DIRECTORY_STATUS=2246,L.GAME_CENTER_STARTING_GAME_FAILED=2142,L.GAME_CENTER_JOINING_FAILED=1730,L.GAMESTATUSMESSAGE=3805,L.GAMEACHIEVEMENTS=1689,L.GAMEINVITE=904,L.JOININGQUEUEFAILED=3035,L.JOINEDQUEUEMESSAGE=2260,L.LEFTQUEUE=1477,L.LOAD_GAME_URL=2624,L.LOADGAME=3654,L.UNLOADGAME=1715,L.ACHIEVEMENTRESOLUTIONCOMPLETED=740,L.ACHIEVEMENTRESOLUTIONPROGRESS=3370,L.ACHIEVEMENTRESOLUTIONS=66,L.GENERIC_ALERT=3801,L.MODERATOR_MESSAGE=2030,L.GENERIC_ERROR=1600,L.GIFT_WRAPPER_CONFIG=2234,L.GROUP_BADGES=2402,L.GROUP_CREATE_OPTIONS=2159,L.GROUP_FORUM_DATA=3011,L.GROUP_FORUM_LIST=3001,L.GROUP_FORUM_THREADS=1073,L.GROUP_FORUM_POST=2049,L.GROUP_FORUM_POST_THREAD=1862,L.GROUP_FORUM_THREAD_MESSAGES=509,L.GROUP_FORUM_UNREAD_COUNT=2379,L.GROUP_FORUM_UPDATE_MESSAGE=324,L.GROUP_FORUM_UPDATE_THREAD=2528,L.GROUP_INFO=1702,L.GROUP_LIST=420,L.GROUP_MEMBER=265,L.GROUP_MEMBERS=1200,L.GROUP_MEMBERS_REFRESH=2445,L.GROUP_MEMBER_REMOVE_CONFIRM=1876,L.GROUP_PURCHASED=2808,L.GROUP_SETTINGS=3965,L.GROUP_BADGE_PARTS=2238,L.GROUP_MEMBERSHIP_REQUESTED=1180,L.GROUP_DETAILS_CHANGED=1459,L.GROUP_HABBO_JOIN_FAILED=762,L.ADDED_TO_GROUP_WHISPER=1118,L.GUILD_EDIT_FAILED=3988,L.GUILD_MEMBER_MGMT_FAILED=818,L.ITEM_DIMMER_SETTINGS=2710,L.ITEM_STACK_HELPER=2816,L.ITEM_WALL=1369,L.ITEM_WALL_ADD=2187,L.ITEM_WALL_REMOVE=3208,L.ITEM_WALL_UPDATE=2009,L.MARKETPLACE_CONFIG=1823,L.MESSENGER_ACCEPT_FRIENDS=896,L.MESSENGER_CHAT=1587,L.MESSENGER_FIND_FRIENDS=1210,L.MESSENGER_FOLLOW_FAILED=3048,L.MESSENGER_FRIEND_NOTIFICATION=3082,L.MESSENGER_FRIENDS=3130,L.MESSENGER_INIT=1605,L.MESSENGER_INSTANCE_MESSAGE_ERROR=3359,L.MESSENGER_INVITE=3870,L.MESSENGER_INVITE_ERROR=462,L.MESSENGER_MESSAGE_ERROR=892,L.MESSENGER_MINIMAIL_COUNT=2803,L.MESSENGER_MINIMAIL_NEW=1911,L.MESSENGER_RELATIONSHIPS=2016,L.MESSENGER_REQUEST=2219,L.MESSENGER_REQUEST_ERROR=892,L.MESSENGER_REQUESTS=280,L.MESSENGER_SEARCH=973,L.MESSENGER_UPDATE=2800,L.MODERATION_REPORT_DISABLED=1651,L.MODERATION_TOOL=2696,L.MODERATION_USER_INFO=2866,L.MOTD_MESSAGES=2035,L.NAVIGATOR_CATEGORIES=1562,L.NAVIGATOR_COLLAPSED=1543,L.NAVIGATOR_EVENT_CATEGORIES=3244,L.NAVIGATOR_LIFTED=3104,L.NAVIGATOR_METADATA=3052,L.NAVIGATOR_OPEN_ROOM_CREATOR=2064,L.NAVIGATOR_SEARCH=2690,L.NAVIGATOR_SEARCHES=3984,L.NAVIGATOR_SETTINGS=518,L.THUMBNAIL_UPDATE_RESULT=1927,L.CAN_CREATE_ROOM=378,L.CATEGORIES_WITH_VISITOR_COUNT=1455,L.COMPETITION_ROOMS_DATA=3954,L.CONVERTED_ROOM_ID=1331,L.GUEST_ROOM_SEARCH_RESULT=52,L.NOTIFICATION_LIST=1992,L.NOTIFICATION_OFFER_REWARD_DELIVERED=2125,L.NOTIFICATION_SIMPLE_ALERT=5100,L.NOTIFICATION_ELEMENT_POINTER=1787,L.PET_FIGURE_UPDATE=1924,L.PET_INFO=2901,L.PET_TRAINING_PANEL=1164,L.PET_LEVEL_UPDATE=2824,L.PET_SCRATCH_FAILED=1130,L.PET_OPEN_PACKAGE_REQUESTED=2380,L.PET_OPEN_PACKAGE_RESULT=546,L.PET_BREEDING=1746,L.PET_CONFIRM_BREEDING_RESULT=1625,L.PET_GO_TO_BREEDING_NEST_FAILURE=2621,L.PET_NEST_BREEDING_SUCCESS=2527,L.PET_CONFIRM_BREEDING_REQUEST=634,L.PET_BREEDING_RESULT=1553,L.RECYCLER_PRIZES=3164,L.RECYCLER_STATUS=3433,L.RECYCLER_FINISHED=468,L.ROOM_BAN_LIST=1869,L.ROOM_BAN_REMOVE=3429,L.ROOM_CREATED=1304,L.ROOM_DOORBELL=2309,L.ROOM_DOORBELL_ACCEPTED=3783,L.ROOM_DOORBELL_REJECTED=878,L.ROOM_ENTER=758,L.ROOM_ENTER_ERROR=899,L.ROOM_FORWARD=160,L.ROOM_HEIGHT_MAP=2753,L.ROOM_HEIGHT_MAP_UPDATE=558,L.ROOM_INFO=687,L.ROOM_INFO_OWNER=749,L.ROOM_MODEL=1301,L.ROOM_MODEL_BLOCKED_TILES=3990,L.ROOM_MODEL_DOOR=1664,L.ROOM_MODEL_NAME=2031,L.ROOM_MUTED=2533,L.ROOM_MUTE_USER=826,L.ROOM_PAINT=2454,L.ROOM_PROMOTION=2274,L.ROOM_QUEUE_STATUS=2208,L.ROOM_RIGHTS=780,L.ROOM_RIGHTS_CLEAR=2392,L.ROOM_RIGHTS_LIST=1284,L.ROOM_WITHOUT_RIGHTS_LIST=9017,L.ROOM_RIGHTS_LIST_ADD=2088,L.ROOM_RIGHTS_LIST_REMOVE=1327,L.ROOM_RIGHTS_OWNER=339,L.ROOM_ROLLING=3207,L.ROOM_SCORE=482,L.ROOM_SETTINGS=1498,L.ROOM_SETTINGS_CHAT=1191,L.ROOM_SETTINGS_SAVE=948,L.ROOM_SETTINGS_SAVE_ERROR=1555,L.ROOM_INFO_UPDATED=3297,L.ROOM_SPECTATOR=1033,L.ROOM_THICKNESS=3547,L.ROOM_GET_FILTER_WORDS=2937,L.ROOM_MESSAGE_NOTIFICATION=1634,L.ROOM_POPULAR_TAGS_RESULT=2012,L.INFO_FEED_ENABLE=3284,L.SECURITY_MACHINE=1488,L.MYSTERY_BOX_KEYS=2833,L.GOTMYSTERYBOXPRIZEMESSAGE=3712,L.CANCELMYSTERYBOXWAITMESSAGE=596,L.SHOWMYSTERYBOXWAITMESSAGE=3201,L.TRADE_ACCEPTED=2568,L.TRADE_CLOSED=1373,L.TRADE_COMPLETED=1001,L.TRADE_CONFIRMATION=2720,L.TRADE_LIST_ITEM=2024,L.TRADE_NOT_OPEN=3128,L.TRADE_OPEN=2505,L.TRADE_OPEN_FAILED=217,L.TRADE_OTHER_NOT_ALLOWED=1254,L.TRADE_YOU_NOT_ALLOWED=3058,L.TRADE_NO_SUCH_ITEM=2873,L.UNIT=374,L.UNIT_CHANGE_NAME=2182,L.UNIT_CHAT=1446,L.UNIT_CHAT_SHOUT=1036,L.UNIT_CHAT_WHISPER=2704,L.UNIT_DANCE=2233,L.UNIT_EFFECT=1167,L.UNIT_EXPRESSION=1631,L.UNIT_HAND_ITEM=1474,L.UNIT_IDLE=1797,L.UNIT_INFO=3920,L.UNIT_NUMBER=2324,L.UNIT_REMOVE=2661,L.UNIT_STATUS=1640,L.UNIT_TYPING=1717,L.UNSEEN_ITEMS=2103,L.USER_ACHIEVEMENT_SCORE=1968,L.USER_BADGES=717,L.USER_BADGES_ADD=2493,L.USER_BADGES_CURRENT=1087,L.USER_BOT_REMOVE=233,L.USER_BOTS=3086,L.USER_CHANGE_NAME=118,L.USER_CLOTHING=1450,L.USER_CREDITS=3475,L.USER_CURRENCY=2018,L.ACTIVITY_POINT_NOTIFICATION=2275,L.USER_EFFECTS=340,L.USER_FAVORITE_ROOM=2524,L.USER_FAVORITE_ROOM_COUNT=151,L.USER_FIGURE=2429,L.USER_FURNITURE=994,L.USER_FURNITURE_ADD=104,L.USER_FURNITURE_POSTIT_PLACED=1501,L.USER_FURNITURE_REFRESH=3151,L.USER_FURNITURE_REMOVE=159,L.USER_HOME_ROOM=2875,L.ROOM_EVENT_CANCEL=3479,L.ROOM_EVENT=1840,L.USER_IGNORED=126,L.USER_IGNORED_RESULT=207,L.USER_INFO=2725,L.USER_OUTFITS=3315,L.USER_PERKS=2586,L.USER_PERMISSIONS=411,L.USER_PET_ADD=2101,L.USER_PET_REMOVE=3253,L.USER_PETS=3522,L.USER_PROFILE=3898,L.USER_RESPECT=2815,L.USER_KISS=9003,L.SET_KISSES_LEFT=9004,L.OPEN_PINCEL=9005,L.ADD_ALERT=9006,L.GET_PINCEL_SELECTED_COLORS=9007,L.SEND_SOUND=9008,L.OPEN_ROOM_VIDEO=9009,L.USER_SANCTION_STATUS=3679,L.USER_SETTINGS=513,L.USER_SUBSCRIPTION=954,L.USER_WARDROBE_PAGE=3315,L.USER_WARDROBE_PAGES=3316,L.USER_CLASSIFICATION=966,L.GET_USER_TAGS=1255,L.WIRED_ACTION=1434,L.WIRED_CONDITION=1108,L.WIRED_ERROR=156,L.WIRED_OPEN=1830,L.WIRED_REWARD=178,L.WIRED_SAVE=1155,L.WIRED_TRIGGER=383,L.PLAYING_GAME=448,L.FURNITURE_STATE_2=3431,L.REMOVE_BOT_FROM_INVENTORY=233,L.ADD_BOT_TO_INVENTORY=1352,L.ACHIEVEMENT_PROGRESSED=2107,L.MODTOOL_ROOM_INFO=1333,L.MODTOOL_USER_CHATLOG=3377,L.MODTOOL_ROOM_CHATLOG=3434,L.MODTOOL_VISITED_ROOMS_USER=1752,L.MODERATOR_ACTION_RESULT=2335,L.ISSUE_DELETED=3192,L.ISSUE_INFO=3609,L.ISSUE_PICK_FAILED=3150,L.CFH_CHATLOG=607,L.MODERATOR_TOOL_PREFERENCES=1576,L.LOVELOCK_FURNI_START=3753,L.LOVELOCK_FURNI_FRIEND_COMFIRMED=382,L.LOVELOCK_FURNI_FINISHED=770,L.GIFT_RECEIVER_NOT_FOUND=1517,L.GIFT_OPENED=56,L.FLOOD_CONTROL=566,L.REMAINING_MUTE=826,L.USER_EFFECT_LIST=340,L.USER_EFFECT_LIST_ADD=2867,L.USER_EFFECT_LIST_REMOVE=2228,L.USER_EFFECT_ACTIVATE=1959,L.AVATAR_EFFECT_SELECTED=3473,L.CLUB_GIFT_INFO=619,L.REDEEM_VOUCHER_ERROR=714,L.REDEEM_VOUCHER_OK=3336,L.IN_CLIENT_LINK=2023,L.BOT_COMMAND_CONFIGURATION=1618,L.BOT_SKILL_LIST_UPDATE=69,L.BOT_FORCE_OPEN_CONTEXT_MENU=296,L.HAND_ITEM_RECEIVED=354,L.PET_PLACING_ERROR=2913,L.BOT_ERROR=639,L.MARKETPLACE_SELL_ITEM=54,L.MARKETPLACE_ITEM_STATS=725,L.MARKETPLACE_OWN_ITEMS=3884,L.MARKETPLACE_CANCEL_SALE=3264,L.MARKETPLACE_ITEM_POSTED=1359,L.MARKETPLACE_ITEMS_SEARCHED=680,L.MARKETPLACE_AFTER_ORDER_STATUS=2032,L.CATALOG_RECEIVE_PET_BREEDS=3331,L.CATALOG_APPROVE_NAME_RESULT=1503,L.OBJECTS_DATA_UPDATE=1453,L.PET_EXPERIENCE=2156,L.COMMUNITY_GOAL_VOTE_EVENT=1435,L.PROMO_ARTICLES=286,L.COMMUNITY_GOAL_EARNED_PRIZES=3319,L.COMMUNITY_GOAL_PROGRESS=2525,L.CONCURRENT_USERS_GOAL_PROGRESS=2737,L.QUEST_DAILY=1878,L.QUEST_CANCELLED=3027,L.QUEST_COMPLETED=949,L.COMMUNITY_GOAL_HALL_OF_FAME=3005,L.EPIC_POPUP=3945,L.SEASONAL_QUESTS=1122,L.QUESTS=3625,L.QUEST=230,L.BONUS_RARE_INFO=1533,L.CRAFTABLE_PRODUCTS=1e3,L.CRAFTING_RECIPE=2774,L.CRAFTING_RECIPES_AVAILABLE=2124,L.CRAFTING_RESULT=618,L.CAMERA_PUBLISH_STATUS=2057,L.CAMERA_PURCHASE_OK=2783,L.CAMERA_STORAGE_URL=3696,L.CAMERA_SNAPSHOT=463,L.COMPETITION_STATUS=133,L.INIT_CAMERA=3878,L.THUMBNAIL_STATUS=3595,L.ACHIEVEMENT_NOTIFICATION=806,L.CLUB_GIFT_NOTIFICATION=2188,L.INTERSTITIAL_MESSAGE=1808,L.ROOM_AD_ERROR=1759,L.AVAILABILITY_TIME=600,L.HOTEL_CLOSED_AND_OPENS=3728,L.HOTEL_CLOSES_AND_OPENS_AT=2771,L.HOTEL_WILL_CLOSE_MINUTES=1050,L.HOTEL_MAINTENANCE=1350,L.JUKEBOX_PLAYLIST_FULL=105,L.JUKEBOX_SONG_DISKS=34,L.NOW_PLAYING=469,L.OFFICIAL_SONG_ID=1381,L.PLAYLIST=1748,L.PLAYLIST_SONG_ADDED=1140,L.TRAX_SONG_INFO=3365,L.USER_SONG_DISKS_INVENTORY=2602,L.CHECK_USER_NAME=563,L.CFH_SANCTION=2782,L.CFH_TOPICS=325,L.CFH_SANCTION_STATUS=2221,L.CAMPAIGN_CALENDAR_DATA=2531,L.CAMPAIGN_CALENDAR_DOOR_OPENED=2551,L.CAMPAIGN_CALENDAR_DAY_UPDATE=1950,L.BUILDERS_CLUB_FURNI_COUNT=3828,L.BUILDERS_CLUB_SUBSCRIPTION=1452,L.CATALOG_PAGE_EXPIRATION=2668,L.CATALOG_EARLIEST_EXPIRY=2515,L.CLUB_GIFT_SELECTED=659,L.TARGET_OFFER_NOT_FOUND=1237,L.TARGET_OFFER=119,L.DIRECT_SMS_CLUB_BUY=195,L.ROOM_AD_PURCHASE=2468,L.NOT_ENOUGH_BALANCE=3914,L.LIMITED_OFFER_APPEARING_NEXT=44,L.IS_OFFER_GIFTABLE=761,L.CLUB_EXTENDED_OFFER=3964,L.SEASONAL_CALENDAR_OFFER=1889,L.COMPETITION_ENTRY_SUBMIT=1177,L.COMPETITION_VOTING_INFO=3506,L.COMPETITION_TIMING_CODE=1745,L.COMPETITION_USER_PART_OF=3841,L.COMPETITION_NO_OWNED_ROOMS=2064,L.COMPETITION_SECONDS_UNTIL=3926,L.BADGE_POINT_LIMITS=2501,L.BADGE_REQUEST_FULFILLED=2998,L.HELPER_TALENT_TRACK=3406,L.TALENT_TRACK_LEVEL=1203,L.TALENT_TRACK_LEVEL_UP=638,L.USER_BANNED=1683,L.BOT_RECEIVED=3684,L.PET_LEVEL_NOTIFICATION=859,L.PET_RECEIVED=1111,L.MODERATION_CAUTION=1890,L.YOUTUBE_CONTROL_VIDEO=1554,L.YOUTUBE_DISPLAY_PLAYLISTS=1112,L.YOUTUBE_DISPLAY_VIDEO=1411,L.CFH_DISABLED_NOTIFY=1651,L.QUESTION=2665,L.POLL_CONTENTS=2997,L.POLL_ERROR=662,L.POLL_OFFER=3785,L.POLL_ROOM_RESULT=5201,L.POLL_START_ROOM=5200,L.QUESTION_ANSWERED=2589,L.QUESTION_FINISHED=1066,L.CFH_PENDING_CALLS=1121,L.GUIDE_ON_DUTY_STATUS=1548,L.GUIDE_SESSION_ATTACHED=1591,L.GUIDE_SESSION_DETACHED=138,L.GUIDE_SESSION_ENDED=1456,L.GUIDE_SESSION_ERROR=673,L.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM=219,L.GUIDE_SESSION_MESSAGE=841,L.GUIDE_SESSION_PARTNER_IS_TYPING=1016,L.GUIDE_SESSION_REQUESTER_ROOM=1847,L.GUIDE_SESSION_STARTED=3209,L.GUIDE_TICKET_CREATION_RESULT=3285,L.GUIDE_TICKET_RESOLUTION=2674,L.GUIDE_REPORTING_STATUS=3463,L.HOTEL_MERGE_NAME_CHANGE=1663,L.ISSUE_CLOSE_NOTIFICATION=934,L.QUIZ_DATA=2927,L.QUIZ_RESULTS=2772,L.CFH_PENDING_CALLS_DELETED=77,L.CFH_REPLY=3796,L.CHAT_REVIEW_SESSION_DETACHED=30,L.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE=735,L.CHAT_REVIEW_SESSION_RESULTS=3276,L.CHAT_REVIEW_SESSION_STARTED=143,L.CHAT_REVIEW_SESSION_VOTING_STATUS=1829,L.SCR_SEND_KICKBACK_INFO=3277,L.PET_STATUS=1907,L.GROUP_DEACTIVATE=3129,L.PET_RESPECTED=2788,L.PET_SUPPLEMENT=3441,L.NOOBNESS_LEVEL=3738,L.DISCONNECT_REASON=4e3,L.CAN_CREATE_ROOM_EVENT=2599,L.FAVORITE_GROUP_UDPATE=3403,L.NO_SUCH_FLAT=84,L.ROOM_SETTINGS_ERROR=2897,L.SHOW_ENFORCE_ROOM_CATEGORY=3896,L.CUSTOM_USER_NOTIFICATION=909,L.NEW_USER_EXPERIENCE_GIFT_OFFER=3575,L.RESTORE_CLIENT=426,L.FIREWORK_CHARGE_DATA=5210,L.NEW_USER_EXPERIENCE_NOT_COMPLETE=3639,L.CONNECTION_ERROR=1004,L.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE=1243,L.PHONE_COLLECTION_STATE=2890,L.PHONE_TRY_NUMBER_RESULT=800,L.PHONE_TRY_VERIFICATION_CODE_RESULT=91,L.EXTENDED_PROFILE_CHANGED=876,L.WELCOME_GIFT_CHANGE_EMAIL_RESULT=2293,L.WELCOME_GIFT_STATUS=2707,L.HANDSHAKE_INIT_DIFFIE=1347,L.HANDSHAKE_COMPLETE_DIFFIE=3885,L.RENTABLE_SPACE_RENT_OK=2046,L.RENTABLE_SPACE_STATUS=3559,L.RENTABLE_SPACE_RENT_FAILED=1868,L.EMAIL_STATUS=612,L.CHANGE_EMAIL_RESULT=1815,L.WEEKLY_GAME_REWARD=2641,L.WEEKLY_GAME_REWARD_WINNERS=3097,L.WEEKLY_COMPETITIVE_LEADERBOARD=3512,L.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD=3560,L.WEEKLY_GAME2_FRIENDS_LEADERBOARD=2270,L.WEEKLY_GAME2_LEADERBOARD=2196,L.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER=35,L.WIRED_MOVEMENTS=384,L.HANDSHAKE_IDENTITY_ACCOUNT=3523,L.WIRED_CLICK_USER=197,L.WIRED_ENVIRONMENT=202,L.REMOVE_MULTIPLE_FURNI_ITEMS=1273,L.WIRED_ADDON_DATA_EVENT=9010,L.WIRED_SELECTOR_DATA_EVENT=9011,L.STORE_OFFER_LIST=9012,L.STORE_UPDATE=9013,L.FURNITURE_FLOOR_OPACITY=9014,L.VIP_TIMESTAMP=9015,L.HIDE_AREA=9016,L.USER_HEIGHT_MAP_UPDATE=9018,L.SHOW_TELEPORTS_MENU=9019,L.WIRED_VARIABLE_DATA_EVENT=9020,L.WIRED_ALL_VARIABLES_DIFFS=9021,L.SET_PLAYER_BALANCE=9022,L.HIGHSCORE_VARIABLE=9023,L.WIRED_ALL_VARIABLE_HOLDERS=9024,L.WIRED_ALL_VARIABLES_HASH=9025,L.WIRED_ERROR_LOGS=9026,L.WIRED_MENU_ERROR_EVENT=9027,L.WIRED_PERMISSIONS=9028,L.WIRED_ROOM_SETTINGS=9029,L.WIRED_ROOM_STATS=9030,L.WIRED_VARIABLES_FOR_OBJECT=9031,L.HOTEL_COMMANDS=9035,L.RESULT_PROFILE_BACKGROUND=9036,L.NATAL_CAMPAIGN_STATS=9037,L.NATAL_CAMPAIGN_IMPULSE_STATUS=9038,L.PLAY_WIRED_MUSIC=9039,L.PLAY_WIRED_SOUND_EFFECT=9040,L.STOP_ALL_WIRED_SONG=9041,L.WIRED_MUSICS_DATA=9042,L.SOUND_EFFECTS_DATA=9043,L.CUSTOM_ALERT_CONFIRM=9044;let k=L;class HM extends w{constructor(e){super(e,TW)}getParser(){return this.parser}}class WM extends w{constructor(e){super(e,SW)}getParser(){return this.parser}}class YM extends w{constructor(e){super(e,RW)}getParser(){return this.parser}}class Bq extends w{constructor(e){super(e,OW)}getParser(){return this.parser}}class Vq extends w{constructor(e){super(e,CW)}getParser(){return this.parser}}class Hq extends w{constructor(e){super(e,NW)}getParser(){return this.parser}}class Wq extends w{constructor(e){super(e,AW)}getParser(){return this.parser}}class Yq extends w{constructor(e){super(e,bW)}getParser(){return this.parser}}class CC extends w{constructor(e){super(e,yW)}getParser(){return this.parser}}class zM extends w{constructor(e){super(e,DW)}getParser(){return this.parser}}class KM extends w{constructor(e){super(e,MW)}getParser(){return this.parser}}class zq extends w{constructor(e){super(e,jW)}getParser(){return this.parser}}class qM extends w{constructor(e){super(e,LW)}getParser(){return this.parser}}class NC extends w{constructor(e){super(e,E5)}getParser(){return this.parser}}class qf extends w{constructor(e){super(e,T5)}getParser(){return this.parser}}class XM extends w{constructor(e){super(e,I5)}getParser(){return this.parser}}class AC extends w{constructor(e){super(e,S5)}getParser(){return this.parser}}class $M extends w{constructor(e){super(e,R5)}getParser(){return this.parser}}class QM extends w{constructor(e){super(e,x5)}getParser(){return this.parser}}class Kq extends w{constructor(e){super(e,O5)}getParser(){return this.parser}}class qq extends w{constructor(e){super(e,C5)}getParser(){return this.parser}}class Xq extends w{constructor(e){super(e,N5)}getParser(){return this.parser}}class JM extends w{constructor(e){super(e,A5)}getParser(){return this.parser}}class ZM extends w{constructor(e){super(e,b5)}getParser(){return this.parser}}class e0 extends w{constructor(e){super(e,v5)}getParser(){return this.parser}}class t0 extends w{constructor(e){super(e,y5)}getParser(){return this.parser}}class s0 extends w{constructor(e){super(e,M5)}get userID(){return this.getParser().userID}get userAccepts(){return this.getParser().userAccepts}getParser(){return this.parser}}class i0 extends w{constructor(e){super(e,Wf)}get userID(){return this.getParser().userID}getParser(){return this.parser}}class r0 extends w{constructor(e){super(e,j5)}getParser(){return this.parser}}class n0 extends w{constructor(e){super(e,L5)}getParser(){return this.parser}}class a0 extends w{constructor(e){super(e,P5)}get firstUserID(){return this.getParser().firstUserID}get secondUserID(){return this.getParser().secondUserID}get firstUserNumItems(){return this.getParser().firstUserNumItems}get secondUserNumItems(){return this.getParser().secondUserNumItems}get firstUserNumCredits(){return this.getParser().firstUserNumCredits}get secondUserNumCredits(){return this.getParser().secondUserNumCredits}get firstUserItemArray(){return this.getParser().firstUserItemArray}get secondUserItemArray(){return this.getParser().secondUserItemArray}getParser(){return this.parser}}class $q extends w{constructor(e){super(e,U5)}getParser(){return this.parser}}class o0 extends w{constructor(e){super(e,w5)}getParser(){return this.parser}}class l0 extends w{constructor(e){super(e,F5)}get userID(){return this.getParser().userID}get userCanTrade(){return this.getParser().userCanTrade}get otherUserID(){return this.getParser().otherUserID}get otherUserCanTrade(){return this.getParser().otherUserCanTrade}getParser(){return this.parser}}class c0 extends w{constructor(e){super(e,cR)}getParser(){return this.parser}}class u0 extends w{constructor(e){super(e,k5)}getParser(){return this.parser}}class h0 extends w{constructor(e){super(e,G5)}getParser(){return this.parser}}class d0 extends w{constructor(e){super(e,d4)}getParser(){return this.parser}}class Qq extends w{constructor(e){super(e,_4)}getParser(){return this.parser}}class _0 extends w{constructor(e){super(e,g4)}getParser(){return this.parser}}class g0 extends w{constructor(e){super(e,m4)}getParser(){return this.parser}}class Jq extends w{constructor(e){super(e,f4)}getParser(){return this.parser}}class m0 extends w{constructor(e){super(e,p4)}getParser(){return this.parser}}class f0 extends w{constructor(e){super(e,I4)}getParser(){return this.parser}}class p0 extends w{constructor(e){super(e,E4)}getParser(){return this.parser}}class E0 extends w{constructor(e){super(e,OR)}getParser(){return this.parser}}class I0 extends w{constructor(e){super(e,CR)}getParser(){return this.parser}}class T0 extends w{constructor(e){super(e,R4)}getParser(){return this.parser}}class S0 extends w{constructor(e){super(e,x4)}getParser(){return this.parser}}class R0 extends w{constructor(e){super(e,hD)}getParser(){return this.parser}}class x0 extends w{constructor(e){super(e,C4)}getParser(){return this.parser}}class O0 extends w{constructor(e){super(e,A4)}getParser(){return this.parser}}class C0 extends w{constructor(e){super(e,N4)}getParser(){return this.parser}}class N0 extends w{constructor(e){super(e,v4)}getParser(){return this.parser}}class A0 extends w{constructor(e){super(e,y4)}getParser(){return this.parser}}class b0 extends w{constructor(e){super(e,j4)}getParser(){return this.parser}}class v0 extends w{constructor(e){super(e,L4)}getParser(){return this.parser}}class y0 extends w{constructor(e){super(e,U4)}getParser(){return this.parser}}class D0 extends w{constructor(e){super(e,w4)}getParser(){return this.parser}}class M0 extends w{constructor(e){super(e,G4)}getParser(){return this.parser}}class j0 extends w{constructor(e){super(e,B4)}getParser(){return this.parser}}class L0 extends w{constructor(e){super(e,H4)}getParser(){return this.parser}}class P0 extends w{constructor(e){super(e,W4)}getParser(){return this.parser}}class U0 extends w{constructor(e){super(e,Y4)}getParser(){return this.parser}}class w0 extends w{constructor(e){super(e,z4)}getParser(){return this.parser}}class F0 extends w{constructor(e){super(e,K4)}getParser(){return this.parser}}class Zq extends w{constructor(e){super(e,NR)}getParser(){return this.parser}}class k0 extends w{constructor(e){super(e,q4)}getParser(){return this.parser}}class e9 extends w{constructor(e){super(e,s6)}getParser(){return this.parser}}class t9 extends w{constructor(e){super(e,i6)}getParser(){return this.parser}}class s9 extends w{constructor(e){super(e,r6)}getParser(){return this.parser}}class bC extends w{constructor(e){super(e,n6)}getParser(){return this.parser}get userName(){return this.getParser().userName}}class i9 extends w{constructor(e){super(e,a6)}getParser(){return this.parser}}class G0 extends w{constructor(e){super(e,o6)}getParser(){return this.parser}}class Xf extends w{constructor(e){super(e,l6)}getParser(){return this.parser}}class B0 extends w{constructor(e){super(e,c6)}getParser(){return this.parser}}class bl extends w{constructor(e){super(e,u6)}getParser(){return this.parser}}class r9 extends w{constructor(e){super(e,h6)}getParser(){return this.parser}}class n9 extends w{constructor(e){super(e,_6)}getParser(){return this.parser}}class V0 extends w{constructor(e){super(e,m6)}getParser(){return this.parser}}class a9 extends w{constructor(e){super(e,p6)}getParser(){return this.parser}}class H0 extends w{constructor(e){super(e,E6)}getParser(){return this.parser}}class W0 extends w{constructor(e){super(e,I6)}getParser(){return this.parser}}class o9 extends w{constructor(e){super(e,T6)}getParser(){return this.parser}}class Y0 extends w{constructor(e){super(e,S6)}getParser(){return this.parser}}class l9 extends w{constructor(e){super(e,R6)}getParser(){return this.parser}}class c9 extends w{constructor(e){super(e,C6)}getParser(){return this.parser}}class u9 extends w{constructor(e){super(e,N6)}getParser(){return this.parser}}class z0 extends w{constructor(e){super(e,A6)}getParser(){return this.parser}}class K0 extends w{constructor(e){super(e,b6)}getParser(){return this.parser}}class q0 extends w{constructor(e){super(e,v6)}getParser(){return this.parser}}class h9 extends w{constructor(e){super(e,y6)}getParser(){return this.parser}}class X0 extends w{constructor(e){super(e,D6)}getParser(){return this.parser}}class $0 extends w{constructor(e){super(e,M6)}getParser(){return this.parser}}class Q0 extends w{constructor(e){super(e,L6)}getParser(){return this.parser}}class vC extends w{constructor(e){super(e,P6)}getParser(){return this.parser}}class J0 extends w{constructor(e){super(e,U6)}getParser(){return this.parser}}class Z0 extends w{constructor(e){super(e,w6)}getParser(){return this.parser}}class ej extends w{constructor(e){super(e,F6)}getParser(){return this.parser}}class d9 extends w{constructor(e){super(e,k6)}getParser(){return this.parser}}class tj extends w{constructor(e){super(e,G6)}getParser(){return this.parser}}class sj extends w{constructor(e){super(e,B6)}getParser(){return this.parser}}class ij extends w{constructor(e){super(e,V6)}getParser(){return this.parser}}class yC extends w{constructor(e){super(e,H6)}getParser(){return this.parser}}class _9 extends w{constructor(e){super(e,W6)}getParser(){return this.parser}}class rj extends w{constructor(e){super(e,Y6)}getParser(){return this.parser}}class nj extends w{constructor(e){super(e,z6)}getParser(){return this.parser}}class g9 extends w{constructor(e){super(e,K6)}getParser(){return this.parser}}class aj extends w{constructor(e){super(e,q6)}getParser(){return this.parser}}class oj extends w{constructor(e){super(e,X6)}getParser(){return this.parser}}class lj extends w{constructor(e){super(e,$6)}getParser(){return this.parser}}class m9{constructor(e){this._itemName=e.readString(),this._extraInfo=e.readString(),this._extraInfo==""&&(this._extraInfo=null)}get itemName(){return this._itemName}get extraInfo(){return this._extraInfo}}class f9{constructor(e){this._thumbnailUrl=e.readString(),this._thumbnailUrl==""&&(this._thumbnailUrl=null),this._productOfferList=[];const t=e.readInt();let i=0;for(;i<t;)this._productOfferList.push(new m9(e)),i++}get productOfferList(){return this._productOfferList}get thumbnailUrl(){return this._thumbnailUrl}}class p9{flush(){return!0}parse(e){if(!e)return!1;const t=e.readInt();this._giftOptions=[];let i=0;for(;i<t;)this._giftOptions.push(new T9(e)),i++;return!0}get giftOptions(){return this._giftOptions}}class E9{flush(){return!0}parse(e){return!!e}}class I9 extends w{constructor(e){super(e,p9)}getParser(){return this.parser}}class T9{constructor(e){this._dayIndex=e.readInt(),this._stepIndex=e.readInt(),this._options=[];const t=e.readInt();let i=0;for(;i<t;)this._options.push(new f9(e)),i++}get dayIndex(){return this._dayIndex}get stepIndex(){return this._stepIndex}get options(){return this._options}}class S9 extends w{constructor(e){super(e,E9)}getParser(){return this.parser}}class DC extends w{constructor(e){super(e,J6)}getParser(){return this.parser}}class R9 extends w{constructor(e){super(e,lR)}getParser(){return this.parser}}class cj extends w{constructor(e){super(e,Z6)}getParser(){return this.parser}}class uj extends w{constructor(e){super(e,eK)}getParser(){return this.parser}}class hj extends w{constructor(e){super(e,tK)}getParser(){return this.parser}}class dj extends w{constructor(e){super(e,sK)}getParser(){return this.parser}}class _j extends w{constructor(e){super(e,iK)}getParser(){return this.parser}}class gj extends w{constructor(e){super(e,aK)}getParser(){return this.parser}}class mj extends w{constructor(e){super(e,oK)}getParser(){return this.parser}}class fj extends w{constructor(e){super(e,lK)}getParser(){return this.parser}}class pj extends w{constructor(e){super(e,cK)}getParser(){return this.parser}}class Ej extends w{constructor(e){super(e,hK)}getParser(){return this.parser}}class Ij extends w{constructor(e){super(e,uK)}getParser(){return this.parser}}class Tj extends w{constructor(e){super(e,dK)}getParser(){return this.parser}}class Sj extends w{constructor(e){super(e,_K)}getParser(){return this.parser}}class x9 extends w{constructor(e){super(e,fK)}getParser(){return this.parser}}class Rj extends w{constructor(e){super(e,IK)}getParser(){return this.parser}}class O9 extends w{constructor(e){super(e,TK)}getParser(){return this.parser}}class C9 extends w{constructor(e){super(e,SK)}getParser(){return this.parser}}class N9 extends w{constructor(e){super(e,RK)}getParser(){return this.parser}}class xj extends w{constructor(e){super(e,xK)}getParser(){return this.parser}}class Oj extends w{constructor(e){super(e,OK)}getParser(){return this.parser}}class A9 extends w{constructor(e){super(e,CK)}getParser(){return this.parser}}class Cj extends w{constructor(e){super(e,NK)}getParser(){return this.parser}}class Nj extends w{constructor(e){super(e,AK)}getParser(){return this.parser}}class b9 extends w{constructor(e){super(e,bK)}getParser(){return this.parser}}const sI=class sI extends w{constructor(e){super(e,vK)}getParser(){return this.parser}};sI.FINISHED_OK=1,sI.FINISHED_FAIL=2;let yR=sI;const Y_=class Y_ extends w{constructor(e){super(e,yK)}getParser(){return this.parser}};Y_.SYSTEM_STATUS_ENABLED=1,Y_.SYSTEM_STATUS_DISABLED=2,Y_.SYSTEM_STATUS_TIMEOUT=3;let DR=Y_;class $f extends w{constructor(e){super(e,PW)}getParser(){return this.parser}}class MR extends w{constructor(e){super(e,UW)}getParser(){return this.parser}}class Qf extends w{constructor(e){super(e,FW)}getParser(){return this.parser}}class jR extends w{constructor(e){super(e,wW)}getParser(){return this.parser}}class Aj extends w{constructor(e){super(e,Td)}getParser(){return this.parser}}class Jf extends w{constructor(e){super(e,kW)}getParser(){return this.parser}}class bj extends w{constructor(e){super(e,GW)}getParser(){return this.parser}}class vj extends w{constructor(e){super(e,BW)}getParser(){return this.parser}}class v9 extends w{constructor(e){super(e,VW)}getParser(){return this.parser}}class y9 extends w{constructor(e){super(e,WW)}getParser(){return this.parser}}class yj extends w{constructor(e){super(e,i3)}getParser(){return this.parser}}class MC extends w{constructor(e){super(e,r3)}getParser(){return this.parser}}class Dj extends w{constructor(e){super(e,n3)}getParser(){return this.parser}}class Mj extends w{constructor(e){super(e,a3)}getParser(){return this.parser}}class LR extends w{constructor(e){super(e,G3)}getParser(){return this.parser}}class PR extends w{constructor(e){super(e,B3)}getParser(){return this.parser}}class jj extends w{constructor(e){super(e,l3)}getParser(){return this.parser}}class UR extends w{constructor(e){super(e,c3)}getParser(){return this.parser}}class wR extends w{constructor(e){super(e,u3)}getParser(){return this.parser}}class FR extends w{constructor(e){super(e,d3)}getParser(){return this.parser}}class kR extends w{constructor(e){super(e,h3)}getParser(){return this.parser}}class GR extends w{constructor(e){super(e,_3)}getParser(){return this.parser}}class BR extends w{constructor(e){super(e,g3)}getParser(){return this.parser}}class D9 extends w{constructor(e){super(e,m3)}getParser(){return this.parser}}class VR extends w{constructor(e){super(e,f3)}getParser(){return this.parser}}class HR extends w{constructor(e){super(e,Mc)}getParser(){return this.parser}}class Lj extends w{constructor(e){super(e,p3)}getParser(){return this.parser}}class Pj extends w{constructor(e){super(e,E3)}getParser(){return this.parser}}class WR extends w{constructor(e){super(e,I3)}getParser(){return this.parser}}class Uj extends w{constructor(e){super(e,T3)}getParser(){return this.parser}}class wj extends w{constructor(e){super(e,S3)}getParser(){return this.parser}}class Fj extends w{constructor(e){super(e,R3)}getParser(){return this.parser}}class YR extends w{constructor(e){super(e,x3)}getParser(){return this.parser}}class M9 extends w{constructor(e){super(e,O3)}getParser(){return this.parser}}class j9 extends w{constructor(e){super(e,C3)}getParser(){return this.parser}}class kj extends w{constructor(e){super(e,Ln)}getParser(){return this.parser}}class Gj extends w{constructor(e){super(e,N3)}getParser(){return this.parser}}class Bj extends w{constructor(e){super(e,b3)}getParser(){return this.parser}}class L9 extends w{constructor(e){super(e,v3)}getParser(){return this.parser}}class zR extends w{constructor(e){super(e,y3)}getParser(){return this.parser}}class KR extends w{constructor(e){super(e,D3)}getParser(){return this.parser}}class qR extends w{constructor(e){super(e,M3)}getParser(){return this.parser}}class XR extends w{constructor(e){super(e,j3)}getParser(){return this.parser}}class P9 extends w{constructor(e){super(e,L3)}getParser(){return this.parser}}class Vj extends w{constructor(e){super(e,P3)}getParser(){return this.parser}}class Hj extends w{constructor(e){super(e,w3)}getParser(){return this.parser}}class Wj extends w{constructor(e){super(e,F3)}getParser(){return this.parser}}class Yj extends w{constructor(e){super(e,k3)}getParser(){return this.parser}}class Zf extends w{constructor(e){super(e,Vf)}getParser(){return this.parser}}class ep extends w{constructor(e){super(e,V3)}getParser(){return this.parser}}class $R extends w{constructor(e){super(e,Tc)}getParser(){return this.parser}}class QR extends w{constructor(e){super(e,H3)}getParser(){return this.parser}}class zj extends w{constructor(e){super(e,W3)}getParser(){return this.parser}}class JR extends w{constructor(e){super(e,Y3)}getParser(){return this.parser}}class jd extends w{constructor(e){super(e,z3)}getParser(){return this.parser}}class tp extends w{constructor(e){super(e,K3)}getParser(){return this.parser}}class Kj extends w{constructor(e){super(e,q3)}getParser(){return this.parser}}class qj extends w{constructor(e){super(e,X3)}getParser(){return this.parser}}class sp extends w{constructor(e){super(e,$3)}getParser(){return this.parser}}class Xj extends w{constructor(e){super(e,Q3)}getParser(){return this.parser}}class $j extends w{constructor(e){super(e,J3)}getParser(){return this.parser}}class Qj extends w{constructor(e){super(e,e5)}getParser(){return this.parser}}class Jj extends w{constructor(e){super(e,t5)}getParser(){return this.parser}}class Zj extends w{constructor(e){super(e,s5)}getParser(){return this.parser}}class eL extends w{constructor(e){super(e,i5)}getParser(){return this.parser}}class jC extends w{constructor(e){super(e,lC)}getParser(){return this.parser}}class ip extends w{constructor(e){super(e,lC)}getParser(){return this.parser}}class rp extends w{constructor(e){super(e,lC)}getParser(){return this.parser}}class ZR extends w{constructor(e){super(e,r5)}getParser(){return this.parser}}class np extends w{constructor(e){super(e,n5)}getParser(){return this.parser}}class ex extends w{constructor(e){super(e,a5)}getParser(){return this.parser}}class ap extends w{constructor(e){super(e,_5)}getParser(){return this.parser}}class tx extends w{constructor(e){super(e,o5)}getParser(){return this.parser}}class sx extends w{constructor(e){super(e,l5)}getParser(){return this.parser}}class tL extends w{constructor(e){super(e,c5)}getParser(){return this.parser}}class ix extends w{constructor(e){super(e,u5)}getParser(){return this.parser}}class op extends w{constructor(e){super(e,h5)}getParser(){return this.parser}}class rx extends w{constructor(e){super(e,d5)}getParser(){return this.parser}}class lp extends w{constructor(e){super(e,g5)}getParser(){return this.parser}}class nx extends w{constructor(e){super(e,p5)}getParser(){return this.parser}}class sL extends w{constructor(e){super(e,kK)}getParser(){return this.parser}}class iL extends w{constructor(e){super(e,GK)}getParser(){return this.parser}}class rL extends w{constructor(e){super(e,BK)}getParser(){return this.parser}}class U9 extends w{constructor(e){super(e,WK)}getParser(){return this.parser}}const iI=class iI extends w{constructor(e){super(e,YK)}getParser(){return this.parser}};iI.PRODUCT_DONATED_CODE=6,iI.BADGE_DONATED_CODE=7;let ax=iI;class nL extends w{constructor(e){super(e,zK)}getParser(){return this.parser}}class w9 extends w{constructor(e){super(e,KK)}getParser(){return this.parser}}class aL extends w{constructor(e){super(e,xh)}getParser(){return this.parser}}class F9{get allVariablesHash(){return this._allVariablesHash}get isLastChunk(){return this._isLastChunk}get removedVariables(){return this._removedVariables}get addedOrUpdated(){return this._addedOrUpdated}flush(){return this._allVariablesHash=0,this._isLastChunk=!1,this._removedVariables=null,this._addedOrUpdated=null,!0}parse(e){if(!e)return!1;this._allVariablesHash=e.readInt(),this._isLastChunk=e.readBoolean();let t=e.readInt();for(this._removedVariables=[];t>0;)this._removedVariables.push(e.readInt()),t--;for(t=e.readInt(),this._addedOrUpdated=new Map;t>0;){let i=e.readInt(),r=new dm(e);this._addedOrUpdated.set(r,i),t--}return!0}}class oL extends w{constructor(e){super(e,F9)}getParser(){return this.parser}}class LC extends qd{constructor(e){super(e)}}class k9{get def(){return this._definition}flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new LC(e),!0):!1}}class lL extends w{constructor(e){super(e,k9)}getParser(){return this.parser}}class cL extends w{constructor(e){super(e,qK)}getParser(){return this.parser}}class uL extends w{constructor(e){super(e,XK)}getParser(){return this.parser}}class hL extends w{constructor(e){super(e,zW)}getParser(){return this.parser}}class dL extends w{constructor(e){super(e,qW)}getParser(){return this.parser}}class _L extends w{constructor(e){super(e,XW)}getParser(){return this.parser}}class gL extends w{constructor(e){super(e,nD)}getParser(){return this.parser}}class G9 extends w{constructor(e){super(e,$W)}getParser(){return this.parser}}class B9 extends w{constructor(e){super(e,QW)}getParser(){return this.parser}}class mL extends w{constructor(e){super(e,JW)}getParser(){return this.parser}}class V9 extends w{constructor(e){super(e,ZW)}getParser(){return this.parser}}class H9 extends w{constructor(e){super(e,e3)}getParser(){return this.parser}}class fL extends w{constructor(e){super(e,Ug)}getParser(){return this.parser}}class W9 extends w{constructor(e){super(e,t3)}getParser(){return this.parser}}class Y9 extends w{constructor(e){super(e,s3)}getParser(){return this.parser}}class pL extends w{constructor(e){super(e,nD)}getParser(){return this.parser}}class EL extends w{constructor(e){super(e,$K)}getParser(){return this.parser}}class IL extends w{constructor(e){super(e,QK)}getParser(){return this.parser}}class TL extends w{constructor(e){super(e,JK)}getParser(){return this.parser}}class SL extends w{constructor(e){super(e,ZK)}getParser(){return this.parser}}class RL extends w{constructor(e){super(e,e7)}getParser(){return this.parser}}class z9 extends w{constructor(e){super(e,t7)}getParser(){return this.parser}}class K9 extends w{constructor(e){super(e,s7)}getParser(){return this.parser}}class xL extends w{constructor(e){super(e,r7)}getParser(){return this.parser}}class OL extends w{constructor(e){super(e,n7)}getParser(){return this.parser}}class CL extends w{constructor(e){super(e,a7)}getParser(){return this.parser}}class NL extends w{constructor(e){super(e,o7)}getParser(){return this.parser}}class AL extends w{constructor(e){super(e,c7)}getParser(){return this.parser}}class bL extends w{constructor(e){super(e,l7)}getParser(){return this.parser}}class vL extends w{constructor(e){super(e,u7)}getParser(){return this.parser}}class q9 extends w{constructor(e){super(e,h7)}getParser(){return this.parser}}class X9 extends w{constructor(e){super(e,_7)}getParser(){return this.parser}}class $9 extends w{constructor(e){super(e,m7)}getParser(){return this.parser}}class PC extends w{constructor(e){super(e,XH)}getParser(){return this.parser}}class yL extends w{constructor(e){super(e,Ff)}getParser(){return this.parser}}class DL extends w{constructor(e){super(e,$H)}getParser(){return this.parser}}class Q9 extends w{constructor(e){super(e,iR)}getParser(){return this.parser}}class ML extends w{constructor(e){super(e,QH)}getParser(){return this.parser}}class UC extends w{constructor(e){super(e,ZH)}getParser(){return this.parser}}class wC extends w{constructor(e){super(e,eW)}getParser(){return this.parser}}class Ld extends w{constructor(e){super(e,sW)}getParser(){return this.parser}}class cT extends w{constructor(e){super(e,iW)}getParser(){return this.parser}}class jL extends w{constructor(e){super(e,rW)}getParser(){return this.parser}}class uT extends w{constructor(e){super(e,nW)}getParser(){return this.parser}}class FC extends w{constructor(e){super(e,aW)}getParser(){return this.parser}}class LL extends w{constructor(e){super(e,oW)}getParser(){return this.parser}}class PL extends w{constructor(e){super(e,lW)}getParser(){return this.parser}}class J9 extends w{constructor(e){super(e,cW)}getParser(){return this.parser}}class Z9 extends w{constructor(e){super(e,uW)}getParser(){return this.parser}}class eX extends w{constructor(e){super(e,rR)}getParser(){return this.parser}}class tX extends w{constructor(e){super(e,hW)}getParser(){return this.parser}}class kC extends w{constructor(e){super(e,dW)}getParser(){return this.parser}}class UL extends w{constructor(e){super(e,_W)}getParser(){return this.parser}}class sX extends w{constructor(e){super(e,nR)}getParser(){return this.parser}}var Qt=(a=>(a[a.SYSTEM=-1]="SYSTEM",a[a.BASIC=1]="BASIC",a[a.SPECIAL=2]="SPECIAL",a[a.CLUB=3]="CLUB",a[a.ADMIN=4]="ADMIN",a))(Qt||{});class iX{constructor(){this._commands=[]}flush(){return!0}parse(e){if(!e)return!1;const t=e.readString();return t?(this._commands=JSON.parse(t),!0):!1}get commands(){return this._commands}}class wL extends w{constructor(e){super(e,iX)}getParser(){return this.parser}}class FL extends w{constructor(e){super(e,gW)}getParser(){return this.parser}}class GC extends w{constructor(e){super(e,mW)}getParser(){return this.parser}}class kL extends w{constructor(e){super(e,fW)}getParser(){return this.parser}}class GL extends w{constructor(e){super(e,pW)}getParser(){return this.parser}}class BL extends w{constructor(e){super(e,EW)}getParser(){return this.parser}}class VL extends w{constructor(e){super(e,kf)}getParser(){return this.parser}}class BC extends w{constructor(e){super(e,IW)}getParser(){return this.parser}}const ia=class ia{constructor(e){this._type=e.readInt(),this._userId=e.readInt(),this._userName=e.readString(),this._figure=e.readString(),this._memberSince=e.readString()}get userId(){return this._userId}get userName(){return this._userName}get admin(){return this._type==ia.TYPE_ADMIN}get owner(){return this._type==ia.TYPE_OWNER}get pending(){return this._type==ia.TYPE_PENDING}get member(){return this._type!=ia.TYPE_MEMBER}get blocked(){return this._type==ia.TYPE_BLOCKED}get figure(){return this._figure}get memberSince(){return this._memberSince}};ia.TYPE_OWNER=0,ia.TYPE_ADMIN=1,ia.TYPE_PENDING=2,ia.TYPE_MEMBER=3,ia.TYPE_BLOCKED=4;let ox=ia;class HL extends w{constructor(e){super(e,B5)}getParser(){return this.parser}}class WL extends w{constructor(e){super(e,V5)}getParser(){return this.parser}}class VC extends w{constructor(e){super(e,H5)}getParser(){return this.parser}}class YL extends w{constructor(e){super(e,z5)}getParser(){return this.parser}}class HC extends w{constructor(e){super(e,K5)}getParser(){return this.parser}}class rX extends w{constructor(e){super(e,X5)}getParser(){return this.parser}}class zL extends w{constructor(e){super(e,$5)}getParser(){return this.parser}}class WC extends w{constructor(e){super(e,Q5)}getParser(){return this.parser}}class KL extends w{constructor(e){super(e,J5)}getParser(){return this.parser}}class qL extends w{constructor(e){super(e,Z5)}getParser(){return this.parser}}class nX extends w{constructor(e){super(e,eY)}getParser(){return this.parser}}class XL extends w{constructor(e){super(e,tY)}getParser(){return this.parser}}class $L extends w{constructor(e){super(e,iY)}getParser(){return this.parser}}class aX extends w{constructor(e){super(e,p7)}getParser(){return this.parser}}class QL extends w{constructor(e){super(e,E7)}getParser(){return this.parser}}class JL extends w{constructor(e){super(e,I7)}getParser(){return this.parser}}class oX extends w{constructor(e){super(e,T7)}getParser(){return this.parser}}class lX{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class cX{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class ZL{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class uX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class eP{constructor(e=""){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class tP{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Bg{constructor(e="",t="",i="",r=-1,n=-1){this._data=[]}getMessageArray(){return this._data}dispose(){}assignBitmap(e){const t=Vt.generateImageUrl(e);if(!t)return;const i=t.split(",")[1],r=Uint8Array.from(atob(i),n=>n.charCodeAt(0));this._data.push(r.byteLength,r.buffer)}assignBase64(e){const t=e.split(",")[1],i=Uint8Array.from(atob(t),r=>r.charCodeAt(0));this._data.push(i.byteLength,i.buffer)}}class lx extends Bg{constructor(e="",t="",i="",r=-1,n=-1){super(e,t,i,r,n)}}class sP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class iP{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class rP extends Bg{constructor(e="",t="",i="",r=-1,n=-1){super(e,t,i,r,n)}}class nP{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class aP{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class hX{constructor(e=1){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class cx{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class oP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class lP{constructor(e,t){this._data=[e,t]}dispose(){}getMessageArray(){return this._data}}class cP{constructor(e,t){this._data=[e,t]}dispose(){}getMessageArray(){return this._data}}class uP{constructor(e,t){this._data=[e,t]}dispose(){}getMessageArray(){return this._data}}class hP{constructor(e,t){this._data=[e,t]}dispose(){}getMessageArray(){return this._data}}class YC{constructor(e,t,i,r,n,o){this._data=[e,t,i,r,n,o]}getMessageArray(){return this._data}dispose(){}}class zC{constructor(e,t,i,r){this._data=[e,t,i,r]}dispose(){}getMessageArray(){return this._data}}class dP{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class _P{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class dX{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class gP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class mP{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class _X{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class gX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class KC{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class fP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class mX{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class pP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class fX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class pX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class EX{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class IX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class TX{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class EP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class IP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class SX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class TP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class qC{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class RX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class xX{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class SP{constructor(e,t,i,r,n,o,l,c,u){this._data=[e,t,i,r,n,o,l,c,u]}getMessageArray(){return this._data}dispose(){}}class hT{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class RP{constructor(e,t,i,r,n,o,l){this._data=[e,t,i,r,n,o,l]}getMessageArray(){return this._data}dispose(){}}class xP{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class OX{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class OP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class CX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class CP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class NX{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class AX{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class bX{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class vX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class yX{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class DX{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class MX{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class jX{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class LX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}const Qh=class Qh{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}};Qh.CONFIRM_LEVEL_NOT_ACCEPTED=0,Qh.CONFIRM_LEVEL_NOT_SUBMITTED=1,Qh.CONFIRM_LEVEL_NOT_CONFIRMED=2,Qh.CONFIRM_LEVEL_COMMIT=3;let ux=Qh;class PX{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class NP{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class UX{constructor(e,t){this._data=[e,t.length].concat(t)}getMessageArray(){return this._data}dispose(){}}class AP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class bP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class wX{constructor(e,t){this._data=[e,t.length].concat(t)}getMessageArray(){return this._data}dispose(){}}class vP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class yP{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class hx{constructor(...e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class dx{constructor(e,...t){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}class FX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class dT{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class DP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class MP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class jP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class LP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class PP{constructor(...e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class XC{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}let UP=class{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}};class wP{constructor(e,t){this._data=[t.length,...t,e]}getMessageArray(){return this._data}dispose(){}}class Kc{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class kX{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class FP{constructor(e=!0){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class GX{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class BX{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class VX{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class HX{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class kP{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class WX{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class YX{constructor(e,t){this._data=[e,t]}dispose(){}getMessageArray(){return this._data}}class zX{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class KX{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class GP{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class BP{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class VP{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class qX{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class HP{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class XX{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class $X{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class QX{constructor(e,t,i,r,n,o){this._data=[e,t,i,r,n,o]}dispose(){}getMessageArray(){return this._data}}class JX{constructor(e,t,i,r,n,o){this._data=[e,t,i,r,n,o]}dispose(){}getMessageArray(){return this._data}}class ZX{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class e8{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}const IA=class IA{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}};IA.NO_ISSUE_ID=-1;let _x=IA;class t8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}const TA=class TA{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}};TA.NO_ISSUE_ID=-1;let gx=TA;class s8{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class i8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class r8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class WP{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class YP{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class zP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class KP{constructor(e,t,i,r,n,o){this._data=[e,t,i,r,n,o.length,...o]}getMessageArray(){return this._data}dispose(){}}class qP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class XP{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class $P{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class QP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Pd{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class JP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class mx{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class ZP{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class eU{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class _T{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class tU{constructor(e,t){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}class sU{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class iU{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class rU{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class nU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class aU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class n8{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class oU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class a8{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class o8{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class lU{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class l8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class c8{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class u8{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class h8{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class cU{constructor(...e){this._data=[e.length],e.forEach(t=>{this._data.push(t.k),this._data.push(t._arg_2),this._data.push(t._arg_3)})}getMessageArray(){return this._data}dispose(){}}class _b{constructor(e,t,i){this.k=e,this._arg_2=t,this._arg_3=i}}class d8{constructor(e,t,i,r,n){this._data=[e,t,i,r,n]}getMessageArray(){return this._data}dispose(){}}class _8{constructor(e,t,i,r){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class g8{constructor(e,t,i){if(this._type=e,t.length===i.length){this._data=[];for(let r=0;r<t.length;r++)this._data.push(t[r]),this._data.push(i[r])}}getMessageArray(){return this._data}dispose(){}}class uU{constructor(e,t,i,r){this._data=[`NITRO-${Bd.RENDERER_VERSION.replaceAll(".","-")}`,"HTML5",LS.HTML5,jS.BROWSER]}getMessageArray(){return this._data}dispose(){}}class m8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class f8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class hU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class p8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class dU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _U{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class E8{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class I8{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class gU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class mU{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class fU{constructor(e,t,i,r,n){this._data=[e,t,i,r,n]}getMessageArray(){return this._data}dispose(){}}class pU{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class EU{constructor(e,t,i,r){this._data=[e,t,i,r.length/2,...r]}getMessageArray(){return this._data}dispose(){}}class IU{constructor(e,t,i,r,n){this._data=[e,t,i,r,n]}getMessageArray(){return this._data}dispose(){}}class T8{constructor(e,t,i,r,n){this._data=[e,t,i,r,n]}getMessageArray(){return this._data}dispose(){}}class TU{constructor(e,t,i,r,n){this._data=[e,t,i,r,n.length/2,...n]}getMessageArray(){return this._data}dispose(){}}class S8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class R8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class x8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class O8{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class SU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class RU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class C8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class N8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class A8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class xU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class b8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class OU{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class CU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class NU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class AU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class bU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class v8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class vU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class fx{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class y8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class yU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class DU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class D8{constructor(e,t){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}class M8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class j8{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class L8{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class P8{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class U8{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class w8{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class MU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class cp{constructor(){this._badges=[]}getMessageArray(){const e=[];for(let t=1;t<=this._badges.length;t++)e.push(t),e.push(this._badges[t-1]);return e}dispose(){}addActivatedBadge(e){this._badges.push(e)}}class jU{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class LU{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class px{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ex{constructor(e,t=1){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class $C{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class F8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class k8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class G8{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class Ix{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class PU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class UU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class wU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class FU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Tx{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class kU{constructor(...e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class GU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class BU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class VU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class HU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class WU{constructor(e,...t){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}class YU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class B8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Sx{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class V8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class zU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class H8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class KU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qU{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class XU{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class $U{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class QU{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class JU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ZU{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class W8{constructor(e,t,i){this._data=[e,t.length,...t,i]}getMessageArray(){return this._data}dispose(){}}const z_=class z_{constructor(e,t){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}};z_.RESOLUTION_USELESS=1,z_.RESOLUTION_ABUSIVE=2,z_.RESOLUTION_RESOLVED=3;let Lu=z_;const rI=class rI{constructor(e,t,i,r,n,o=-1){this._data=[e,t,i,r,n],o!=rI.NO_ISSUE_ID&&this._data.push(o)}getMessageArray(){return this._data}dispose(){}};rI.NO_ISSUE_ID=-1;let Fo=rI;class e1{constructor(e,t,i,r=-1){this._data=[e,t,i],r!=Fo.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class t1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class s1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class i1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class r1{constructor(e,t=0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class n1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class a1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class o1{constructor(e,t,i,r=-1){this._data=[e,t,i],r!=Fo.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class Rx{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}const Jh=class Jh{constructor(e,t,i){this._data=[],this._data.push(e),this._data.push(t),this._data.push(i)}getMessageArray(){return this._data}dispose(){}};Jh.ACTION_ALERT=0,Jh.ACTION_KICK=1,Jh.ACTION_MESSAGE=3,Jh.ACTION_MESSAGE_AND_SOFT_KICK=4;let Pu=Jh;class l1{constructor(e,t,i,r=-1){this._data=[e,t,i],r!=Fo.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class QC{constructor(e,t,i,r=-1){this._data=[],this._data.push(e),this._data.push(t),this._data.push(""),this._data.push(""),this._data.push(i),r!=Fo.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class c1{constructor(e,t,i,r=-1){this._data=[e,t,i],r!=Fo.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class Y8{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class z8{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class u1{constructor(e,t,i,r,n=-1){this._data=[e,t,i,r],n!=Fo.NO_ISSUE_ID&&this._data.push(n)}getMessageArray(){return this._data}dispose(){}}class h1{constructor(e,t,i,r){this._data=[e.length,...e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class JC{constructor(e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class d1{constructor(e){this._data=[e]}dispose(){}getMessageArray(){return this._data}}class ZC{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class K8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class q8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class X8{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class _1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class g1{constructor(e,t,i,r,n,o){this._data=[e,t,i,r,n,o]}getMessageArray(){return this._data}dispose(){}}class eN{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class m1{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class $8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Q8{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class J8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class f1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Vg{constructor(e,t,i){this._data=[e,t?1:0,i?1:0]}getMessageArray(){return this._data}dispose(){}}class Z8{constructor(e=0){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class e${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class tN{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class p1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class t${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class s${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class i${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class r${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class n${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class a${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class o${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class l${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class c${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class u${constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class h${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class E1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class d${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Ku{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class _${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class g${constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class m${constructor(e,t,i,r,n,o){this._data=[e,t,i,r,n,o]}getMessageArray(){return this._data}dispose(){}}class f${constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class I1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class sN{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class p${constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class E${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class I${constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class T${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class S${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class R${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class x${constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class T1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class iN{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class S1{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class O${constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class R1{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class C${constructor(...e){this._data=[e.length*3],e.forEach(t=>{this._data.push(t.dayIndex),this._data.push(t.stepIndex),this._data.push(t.giftIndex)})}dispose(){}getMessageArray(){return this._data}}class x1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}const j=class j{};j.ACHIEVEMENT_LIST=219,j.AUTHENTICATION=-1,j.BOT_CONFIGURATION=1986,j.ADD_TO_GROUP_WHISPER=1118,j.BOT_PICKUP=3323,j.BOT_PLACE=1592,j.BOT_SKILL_SAVE=2624,j.GET_CLUB_OFFERS=3285,j.GET_CLUB_GIFT_INFO=487,j.GET_CATALOG_INDEX=1195,j.GET_CATALOG_PAGE=412,j.CATALOG_PURCHASE=3492,j.CATALOG_PURCHASE_GIFT=1411,j.GET_PRODUCT_OFFER=2594,j.CLIENT_LATENCY=295,j.CLIENT_LATENCY_MEASURE=96,j.CLIENT_POLICY=26979,j.CLIENT_PONG=2596,j.CLIENT_TOOLBAR_TOGGLE=2313,j.CLIENT_VARIABLES=1053,j.GET_CURRENT_TIMING_CODE=2912,j.DESKTOP_NEWS=1827,j.DESKTOP_VIEW=105,j.GET_BUNDLE_DISCOUNT_RULESET=223,j.EVENT_TRACKER=3457,j.FIND_NEW_FRIENDS=516,j.FURNITURE_ALIASES=3898,j.FURNITURE_FLOOR_UPDATE=248,j.FURNITURE_MULTISTATE=99,j.FURNITURE_PICKUP=3456,j.FURNITURE_PLACE=1258,j.FURNITURE_POSTIT_PLACE=2248,j.FURNITURE_POSTIT_SAVE_STICKY_POLE=3283,j.FURNITURE_RANDOMSTATE=3617,j.FURNITURE_WALL_MULTISTATE=210,j.FURNITURE_WALL_UPDATE=168,j.GAMES_INIT=2914,j.GAMES_LIST=2399,j.ACCEPTGAMEINVITE=3802,j.GAMEUNLOADEDMESSAGE=3207,j.GETGAMEACHIEVEMENTSMESSAGE=741,j.GETGAMESTATUSMESSAGE=3171,j.GETUSERGAMEACHIEVEMENTSMESSAGE=389,j.JOINQUEUEMESSAGE=1458,j.LEAVEQUEUEMESSAGE=2384,j.RESETRESOLUTIONACHIEVEMENTMESSAGE=3144,j.GETWEEKLYGAMEREWARDWINNERS=1054,j.GAME2GETACCOUNTGAMESTATUSMESSAGE=11,j.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE=3259,j.GAME2EXITGAMEMESSAGE=1445,j.GAME2GAMECHATMESSAGE=2502,j.GAME2LOADSTAGEREADYMESSAGE=2415,j.GAME2PLAYAGAINMESSAGE=3196,j.GAME2REQUESTFULLSTATUSUPDATEMESSAGE=1598,j.GAME2GETWEEKLYFRIENDSLEADERBOARD=1232,j.GAME2GETWEEKLYLEADERBOARD=2565,j.GET_GIFT_WRAPPING_CONFIG=418,j.GROUP_ADMIN_ADD=2894,j.GROUP_ADMIN_REMOVE=722,j.GROUP_CREATE_OPTIONS=798,j.GROUP_FAVORITE=3549,j.GET_FORUM_STATS=3149,j.GET_FORUM_THREADS=873,j.GET_FORUMS_LIST=436,j.GET_FORUM_MESSAGES=232,j.GET_FORUM_THREAD=3900,j.GET_UNREAD_FORUMS_COUNT=2908,j.FORUM_MODERATE_MESSAGE=286,j.FORUM_MODERATE_THREAD=1397,j.FORUM_POST_MESSAGE=3529,j.UPDATE_FORUM_READ_MARKER=1855,j.UPDATE_FORUM_SETTINGS=2214,j.FORUM_UPDATE_THREAD=3045,j.GROUP_INFO=2991,j.GROUP_DELETE=1134,j.GROUP_MEMBER_REMOVE_CONFIRM=3593,j.GROUP_MEMBER_REMOVE=593,j.GROUP_MEMBERS=312,j.GROUP_MEMBERSHIPS=367,j.GROUP_REQUEST=998,j.GROUP_REQUEST_ACCEPT=3386,j.GROUP_REQUEST_DECLINE=1894,j.GROUP_SETTINGS=1004,j.GROUP_PARTS=813,j.GROUP_BUY=230,j.GROUP_SAVE_INFORMATION=3137,j.GROUP_SAVE_BADGE=1991,j.GROUP_SAVE_COLORS=1764,j.GROUP_SAVE_PREFERENCES=3435,j.GROUP_BADGES=21,j.GROUP_UNBLOCK_MEMBER=2864,j.GET_BADGE_POINTS_LIMITS=1371,j.REQUESTABADGE=3077,j.GETISBADGEREQUESTFULFILLED=1364,j.ITEM_CLOTHING_REDEEM=3374,j.ITEM_COLOR_WHEEL_CLICK=2144,j.ITEM_DICE_CLICK=1990,j.ITEM_DICE_CLOSE=1533,j.ITEM_DIMMER_SAVE=1648,j.ITEM_DIMMER_SETTINGS=2813,j.ITEM_DIMMER_TOGGLE=2296,j.ITEM_EXCHANGE_REDEEM=3115,j.ITEM_PAINT=711,j.SET_OBJECT_DATA=3608,j.ITEM_STACK_HELPER=3839,j.ITEM_WALL_CLICK=210,j.ITEM_WALL_UPDATE=168,j.MARKETPLACE_CONFIG=2597,j.ACCEPT_FRIEND=137,j.MESSENGER_CHAT=3567,j.DECLINE_FRIEND=2890,j.FOLLOW_FRIEND=3997,j.MESSENGER_FRIENDS=1523,j.MESSENGER_INIT=2781,j.MESSENGER_RELATIONSHIPS=2138,j.SET_RELATIONSHIP_STATUS=3768,j.REMOVE_FRIEND=1689,j.REQUEST_FRIEND=3157,j.GET_FRIEND_REQUESTS=2448,j.SEND_ROOM_INVITE=1276,j.HABBO_SEARCH=1210,j.FRIEND_LIST_UPDATE=1419,j.MOD_TOOL_USER_INFO=3295,j.GET_USER_FLAT_CATS=3027,j.NAVIGATOR_INIT=2110,j.NAVIGATOR_SEARCH=249,j.NAVIGATOR_SEARCH_CLOSE=1834,j.NAVIGATOR_SEARCH_OPEN=637,j.NAVIGATOR_SEARCH_SAVE=2226,j.GET_USER_EVENT_CATS=1782,j.NAVIGATOR_SETTINGS_SAVE=3159,j.NAVIGATOR_CATEGORY_LIST_MODE=1202,j.NAVIGATOR_DELETE_SAVED_SEARCH=1954,j.PET_INFO=2934,j.PET_PICKUP=1581,j.PET_PLACE=2647,j.PET_RESPECT=3202,j.PET_RIDE=1036,j.PET_MOVE=3449,j.PET_OPEN_PACKAGE=3698,j.PET_SELECTED=549,j.PETS_BREED=1638,j.PET_CANCEL_BREEDING=2713,j.PET_CONFIRM_BREEDING=3382,j.GET_PET_TRAINING_PANEL=2161,j.RECYCLER_PRIZES=398,j.RECYCLER_STATUS=1342,j.RECYCLER_ITEMS=2771,j.RELEASE_VERSION=4e3,j.CALL_FOR_HELP=1691,j.ROOM_AMBASSADOR_ALERT=2996,j.ROOM_BAN_GIVE=1477,j.ROOM_BAN_GIVE_BY_NAME=3996,j.ROOM_BAN_LIST=2267,j.ROOM_BAN_REMOVE=992,j.ROOM_CREATE=2752,j.ROOM_DELETE=532,j.ROOM_DOORBELL=1644,j.ROOM_ENTER=2312,j.ROOM_FAVORITE=3817,j.ROOM_FAVORITE_REMOVE=309,j.CAN_CREATE_ROOM=2128,j.CANCEL_ROOM_EVENT=2725,j.EDIT_ROOM_EVENT=3991,j.COMPETITION_ROOM_SEARCH=433,j.FORWARD_TO_RANDOM_PROMOTED_ROOM=10,j.FORWARD_TO_SOME_ROOM=1703,j.GET_CATEGORIES_WITH_USER_COUNT=3782,j.GET_GUEST_ROOM=2230,j.GET_OFFICIAL_ROOMS=1229,j.GET_POPULAR_ROOM_TAGS=826,j.GUILD_BASE_SEARCH=2930,j.MY_FAVOURITE_ROOMS_SEARCH=2578,j.MY_FREQUENT_ROOM_HISTORY_SEARCH=1002,j.MY_FRIENDS_ROOM_SEARCH=2266,j.MY_GUILD_BASES_SEARCH=39,j.MY_RECOMMENDED_ROOMS=2537,j.MY_ROOM_HISTORY_SEARCH=2264,j.MY_ROOM_RIGHTS_SEARCH=272,j.MY_ROOMS_SEARCH=2277,j.POPULAR_ROOMS_SEARCH=2758,j.ROOM_AD_EVENT_TAB_CLICKED=2412,j.ROOM_AD_EVENT_TAB_VIEWED=2668,j.ROOM_AD_SEARCH=2809,j.ROOM_TEXT_SEARCH=3943,j.ROOMS_WHERE_MY_FRIENDS_ARE=1786,j.ROOMS_WITH_HIGHEST_SCORE_SEARCH=2939,j.SET_ROOM_SESSION_TAGS=3305,j.UPDATE_ROOM_THUMBNAIL=2468,j.ROOM_KICK=1320,j.ROOM_LIKE=3582,j.ROOM_MODEL=2300,j.GET_OCCUPIED_TILES=1687,j.GET_ROOM_ENTRY_TILE=3559,j.ROOM_MODEL_SAVE=875,j.ROOM_MUTE=3637,j.ROOM_MUTE_USER=3485,j.ROOM_RIGHTS_GIVE=808,j.ROOM_RIGHTS_LIST=3385,j.ROOM_RIGHTS_REMOVE=2064,j.ROOM_RIGHTS_REMOVE_ALL=2683,j.ROOM_RIGHTS_REMOVE_OWN=3182,j.ROOM_SETTINGS=3129,j.ROOM_SETTINGS_SAVE=1969,j.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE=1265,j.ROOM_STAFF_PICK=1918,j.ROOM_FILTER_WORDS=1911,j.ROOM_FILTER_WORDS_MODIFY=3001,j.MYSTERYBOXWAITINGCANCELEDMESSAGE=2012,j.MYSTERYBOX_OPEN_TROPHY=3074,j.SECURITY_MACHINE=2490,j.SECURITY_TICKET=2419,j.TRADE=1481,j.TRADE_ACCEPT=3863,j.TRADE_CANCEL=2341,j.TRADE_CLOSE=2551,j.TRADE_CONFIRM=2760,j.TRADE_ITEM=3107,j.TRADE_ITEM_REMOVE=3845,j.TRADE_ITEMS=1263,j.TRADE_UNACCEPT=1444,j.UNIT_ACTION=2456,j.UNIT_CHAT=1314,j.UNIT_CHAT_SHOUT=2085,j.UNIT_CHAT_WHISPER=1543,j.UNIT_DANCE=2080,j.UNIT_DROP_HAND_ITEM=2814,j.UNIT_GIVE_HANDITEM=2941,j.UNIT_LOOK=3301,j.UNIT_POSTURE=2235,j.UNIT_SIGN=1975,j.UNIT_TYPING=1597,j.UNIT_TYPING_STOP=1474,j.UNIT_WALK=3320,j.USER_BADGES=2769,j.USER_BADGES_CURRENT=2091,j.USER_BADGES_CURRENT_UPDATE=644,j.USER_BOTS=3848,j.USER_CURRENCY=273,j.USER_EFFECT_ACTIVATE=2959,j.USER_EFFECT_ENABLE=1752,j.USER_FIGURE=2730,j.USER_FURNITURE=3150,j.REQUESTFURNIINVENTORYWHENNOTINROOM=3500,j.USER_HOME_ROOM=1740,j.USER_INFO=357,j.USER_MOTTO=2228,j.USER_IGNORED=3878,j.USER_PETS=3095,j.USER_PROFILE=3265,j.USER_PROFILE_BY_NAME=2249,j.USER_RESPECT=2694,j.USER_KISS=9003,j.GET_SOUND_SETTINGS=2388,j.USER_SETTINGS_CAMERA=1461,j.USER_SETTINGS_CHAT_STYLE=1030,j.USER_SETTINGS_INVITES=1086,j.USER_SETTINGS_OLD_CHAT=1262,j.USER_SETTINGS_VOLUME=1367,j.USER_SETTINGS_WHISPERING_TO_WIRED=3664,j.USER_SUBSCRIPTION=3166,j.GET_WARDROBE=2742,j.GET_WARDROBE_PAGES=2743,j.SAVE_WARDROBE_OUTFIT=800,j.USER_TAGS=17,j.PEER_USERS_CLASSIFICATION=1160,j.USER_CLASSIFICATION=2285,j.VISIT_USER=2970,j.WIRED_ACTION_SAVE=2281,j.WIRED_APPLY_SNAPSHOT=3373,j.WIRED_CONDITION_SAVE=3203,j.WIRED_OPEN=768,j.WIRED_TRIGGER_SAVE=1520,j.GET_ITEM_DATA=3964,j.ONE_WAY_DOOR_CLICK=2765,j.REMOVE_WALL_ITEM=3336,j.SET_ITEM_DATA=3666,j.CATALOG_REDEEM_VOUCHER=339,j.ROOM_TONER_APPLY=2880,j.FRIEND_FURNI_CONFIRM_LOCK=3775,j.MANNEQUIN_SAVE_NAME=2850,j.MANNEQUIN_SAVE_LOOK=2209,j.PRESENT_OPEN_PRESENT=3558,j.CATALOG_SELECT_VIP_GIFT=2276,j.USER_IGNORE_ID=3314,j.USER_IGNORE=1117,j.USER_UNIGNORE=2061,j.MODTOOL_REQUEST_ROOM_INFO=707,j.MODTOOL_CHANGE_ROOM_SETTINGS=3260,j.MODTOOL_REQUEST_USER_CHATLOG=1391,j.MODTOOL_REQUEST_ROOM_CHATLOG=2587,j.MODTOOL_SANCTION_ALERT=229,j.MODTOOL_SANCTION_BAN=2766,j.MODTOOL_SANCTION_KICK=2582,j.MODTOOL_SANCTION_TRADELOCK=3742,j.MODTOOL_ALERTEVENT=1840,j.MODTOOL_SANCTION_MUTE=1945,j.MODTOOL_REQUEST_USER_ROOMS=3526,j.MODTOOL_ROOM_ALERT=3842,j.MODTOOL_PREFERENCES=31,j.CLOSE_ISSUE_DEFAULT_ACTION=2717,j.CLOSE_ISSUES=2067,j.DEFAULT_SANCTION=1681,j.GET_CFH_CHATLOG=211,j.MODTOOL_SANCTION=1392,j.PICK_ISSUES=15,j.RELEASE_ISSUES=1572,j.CONVERT_GLOBAL_ROOM_ID=314,j.REQUEST_SELL_ITEM=848,j.REQUEST_MARKETPLACE_ITEM_STATS=3288,j.MARKETPLACE_SELL_ITEM=3447,j.MARKETPLACE_RESELL_ITEM=3450,j.MARKETPLACE_REQUEST_OWN_ITEMS=2105,j.MARKETPLACE_TAKE_BACK_ITEM=434,j.MARKETPLACE_REDEEM_CREDITS=2650,j.MARKETPLACE_REQUEST_OFFERS=2407,j.MARKETPLACE_BUY_OFFER=1603,j.MARKETPLACE_BUY_TOKENS=1866,j.CATALOG_REQUESET_PET_BREEDS=1756,j.APPROVE_NAME=2109,j.UNIT_GIVE_HANDITEM_PET=2768,j.PET_MOUNT=1036,j.PET_SUPPLEMENT=749,j.FURNITURE_GROUP_INFO=2651,j.ACHIEVEMENT_RESOLUTION_OPEN=359,j.USE_PET_PRODUCT=1328,j.REMOVE_PET_SADDLE=186,j.TOGGLE_PET_RIDING=1472,j.TOGGLE_PET_BREEDING=3379,j.UNSEEN_RESET_CATEGORY=3493,j.UNSEEN_RESET_ITEMS=2343,j.COMMUNITY_GOAL_VOTE_COMPOSER=3536,j.GET_PROMO_ARTICLES=1827,j.ACCEPT_QUEST=3604,j.ACTIVATE_QUEST=793,j.CANCEL_QUEST=3133,j.FRIEND_REQUEST_QUEST_COMPLETE=1148,j.GET_COMMUNITY_GOAL_EARNED_PRIZES=2688,j.GET_COMMUNITY_GOAL_HALL_OF_FAME=2167,j.GET_COMMUNITY_GOAL_PROGRESS=1145,j.GET_CONCURRENT_USERS_GOAL_PROGRESS=1343,j.GET_CONCURRENT_USERS_REWARD=3872,j.GET_DAILY_QUEST=2486,j.GET_QUESTS=3333,j.GET_SEASONAL_QUESTS_ONLY=1190,j.OPEN_QUEST_TRACKER=2750,j.REDEEM_COMMUNITY_GOAL_PRIZE=90,j.REJECT_QUEST=2397,j.START_CAMPAIGN=1697,j.GET_BONUS_RARE_INFO=957,j.CRAFT=3591,j.CRAFT_SECRET=1251,j.GET_CRAFTABLE_PRODUCTS=633,j.GET_CRAFTING_RECIPE=1173,j.GET_CRAFTING_RECIPES_AVAILABLE=3086,j.PHOTO_COMPETITION=3959,j.PUBLISH_PHOTO=2068,j.PURCHASE_PHOTO=2408,j.EDIT_PHOTO_CAPTION=3958,j.RENDER_ROOM=3226,j.RENDER_ROOM_THUMBNAIL=1982,j.REQUEST_CAMERA_CONFIGURATION=796,j.ADD_JUKEBOX_DISK=753,j.GET_JUKEBOX_PLAYLIST=1435,j.GET_NOW_PLAYING=1325,j.GET_OFFICIAL_SONG_ID=3189,j.GET_SONG_INFO=3082,j.GET_SOUND_MACHINE_PLAYLIST=3498,j.GET_USER_SONG_DISKS=2304,j.REMOVE_JUKEBOX_DISK=3050,j.INTERSTITIAL_SHOWN=1109,j.GET_INTERSTITIAL=2519,j.CHANGE_USERNAME=2977,j.CHECK_USERNAME=3950,j.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF=3889,j.OPEN_CAMPAIGN_CALENDAR_DOOR=2257,j.BUILDERS_CLUB_PLACE_ROOM_ITEM=1051,j.BUILDERS_CLUB_PLACE_WALL_ITEM=462,j.BUILDERS_CLUB_QUERY_FURNI_COUNT=2529,j.GET_CATALOG_PAGE_EXPIRATION=742,j.GET_CATALOG_PAGE_WITH_EARLIEST_EXP=3135,j.GET_DIRECT_CLUB_BUY_AVAILABLE=801,j.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER=603,j.GET_HABBO_CLUB_EXTEND_OFFER=2462,j.GET_IS_OFFER_GIFTABLE=1347,j.GET_LIMITED_OFFER_APPEARING_NEXT=410,j.GET_NEXT_TARGETED_OFFER=596,j.GET_ROOM_AD_PURCHASE_INFO=1075,j.GET_SEASONAL_CALENDAR_DAILY_OFFER=3257,j.GET_TARGETED_OFFER=2487,j.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED=2150,j.PURCHASE_BASIC_MEMBERSHIP_EXTENSION=2735,j.PURCHASE_ROOM_AD=777,j.PURCHASE_TARGETED_OFFER=1826,j.PURCHASE_VIP_MEMBERSHIP_EXTENSION=3407,j.ROOM_AD_PURCHASE_INITIATED=2283,j.SET_TARGETTED_OFFER_STATE=2041,j.SHOP_TARGETED_OFFER_VIEWED=3483,j.HELPER_TALENT_TRACK=196,j.TALENT_TRACK_GET_LEVEL=2127,j.FORWARD_TO_A_COMPETITION_ROOM=172,j.FORWARD_TO_A_SUBMITTABLE_ROOM=1450,j.FORWARD_TO_RANDOM_COMPETITION_ROOM=865,j.GET_IS_USER_PART_OF_COMPETITION=2077,j.GET_SECONDS_UNTIL=271,j.ROOM_COMPETITION_INIT=1334,j.SUBMIT_ROOM_TO_COMPETITION=2595,j.VOTE_FOR_ROOM=143,j.GET_GIFT=2436,j.RESET_PHONE_NUMBER_STATE=2741,j.SET_PHONE_NUMBER_VERIFICATION_STATUS=1379,j.TRY_PHONE_NUMBER=790,j.VERIFY_CODE=2721,j.CONTROL_YOUTUBE_DISPLAY_PLAYBACK=3005,j.GET_YOUTUBE_DISPLAY_STATUS=336,j.SET_YOUTUBE_DISPLAY_PLAYLIST=2069,j.GO_TO_FLAT=685,j.CHANGE_QUEUE=3093,j.CALL_FOR_HELP_FROM_FORUM_MESSAGE=1412,j.CALL_FOR_HELP_FROM_FORUM_THREAD=534,j.CALL_FOR_HELP_FROM_IM=2950,j.CALL_FOR_HELP_FROM_PHOTO=2492,j.CALL_FOR_HELP_FROM_SELFIE=2755,j.CHAT_REVIEW_GUIDE_DECIDES=3365,j.CHAT_REVIEW_GUIDE_DETACHED=2501,j.CHAT_REVIEW_GUIDE_VOTE=3961,j.CHAT_REVIEW_SESSION_CREATE=3060,j.DELETE_PENDING_CALLS_FOR_HELP=3605,j.GET_CFH_STATUS=2746,j.GET_FAQ_CATEGORY=3445,j.GET_FAQ_TEXT=1849,j.GET_GUIDE_REPORTING_STATUS=3786,j.GET_PENDING_CALLS_FOR_HELP=3267,j.GET_QUIZ_QUESTIONS=1296,j.GUIDE_SESSION_CREATE=3338,j.GUIDE_SESSION_FEEDBACK=477,j.GUIDE_SESSION_GET_REQUESTER_ROOM=1052,j.GUIDE_SESSION_GUIDE_DECIDES=1424,j.GUIDE_SESSION_INVITE_REQUESTER=234,j.GUIDE_SESSION_IS_TYPING=519,j.GUIDE_SESSION_MESSAGE=3899,j.GUIDE_SESSION_ON_DUTY_UPDATE=1922,j.GUIDE_SESSION_REPORT=3969,j.GUIDE_SESSION_REQUESTER_CANCELS=291,j.GUIDE_SESSION_RESOLVED=887,j.POST_QUIZ_ANSWERS=3720,j.SEARCH_FAQS=2031,j.POLL_ANSWER=3505,j.POLL_REJECT=1773,j.POLL_START=109,j.POLL_VOTE_COUNTER=6200,j.DISCONNECT=2445,j.SCR_GET_KICKBACK_INFO=869,j.COMPOST_PLANT=3835,j.HARVEST_PET=1521,j.SET_CLOTHING_CHANGE_DATA=924,j.GROUP_UNFAVORITE=1820,j.NEW_USER_EXPERIENCE_GET_GIFTS=1822,j.NEW_USER_EXPERIENCE_SCRIPT_PROCEED=1299,j.HANDSHAKE_INIT_DIFFIE=3110,j.HANDSHAKE_COMPLETE_DIFFIE=773,j.WELCOME_OPEN_GIFT=2638,j.WELCOME_GIFT_CHANGE_EMAIL=66,j.EMAIL_GET_STATUS=2557,j.EMAIL_CHANGE=3965,j.APPROVE_ALL_MEMBERSHIP_REQUESTS=882,j.RENTABLE_SPACE_CANCEL_RENT=1667,j.RENTABLE_SPACE_RENT=2946,j.RENTABLE_SPACE_STATUS=872,j.TRACKING_PERFORMANCE_LOG=3230,j.TRACKING_LAG_WARNING_REPORT=3847,j.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION=3736,j.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM=2115,j.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI=1071,j.RENTABLE_GET_RENT_OR_BUYOUT_OFFER=2518,j.DELETE_ITEM_INVENTORY=9001,j.CHANGE_PINCEL_STATE=9004,j.SAVE_PINCEL_COLORS=9005,j.PAINT_FURNI_COLORS=9006,j.CLICK_FURNI=9007,j.UPDATE_ADDON=9008,j.UPDATE_SELECTOR=9009,j.SUBMIT_CODE_RADIO=9010,j.SUBMIT_MUSIC_REQUEST=9011,j.GET_STORE_DATA=9012,j.SEND_CONSTRUCTION_TOOL_DATA=9013,j.CLICK_AVATAR=9014,j.CLICK_BOT=9015,j.HIDE_AREA=9016,j.GIVE_STAR_GEM=9017,j.SHOW_TELEPORTS_MENU=9018,j.KEY_PRESS=9019,j.UPDATE_VARIABLE=9020,j.GET_ALL_VARIABLES_DIFFS=9021,j.CHANGE_BACKGROUND_PROFILE=9022,j.NATAL_CAMPAIGN_STATS=9023,j.NATAL_CAMPAIGN_IMPULSE=9024,j.CHANGE_PROFILE_THEME=9025,j.CHANGE_PROFILE_IMAGE_POSITION=9026,j.HIDE_BADGE=9040,j.UNHIDE_BADGE=9041,j.OPEN_CAMPAIGN_CALENDAR_DOOR_VIP=9042,j.OPEN_CAMPAIGN_CALENDAR_DOOR_VIP_STAFF=9043,j.GET_MUSICS_DATA=9044,j.GET_SOUND_EFFECTS_DATA=9045,j.UPDATE_ROOM_NAVIGATOR_POSITION=9046,j.UPDATE_USER_TAGS=9047,j.GET_PLAYER_BALANCE_LOGS=9048,j.USER_SETTINGS_SET_OPTIONAL_PATH_FINDER=9049,j.HIGHSCORE_VARIABLE=9050,j.UPDATE_USER_SETTINGS=9051,j.WIRED_CLEAR_ERROR_LOGS=9052,j.WIRED_GET_ALL_VARIABLE_HOLDERS=9053,j.WIRED_GET_ALL_VARIABLES_HASH=9054,j.WIRED_GET_ERROR_LOGS=9055,j.WIRED_GET_ROOM_SETTINGS=9056,j.WIRED_GET_ROOM_STATS=9057,j.WIRED_GET_VARIABLES_FOR_OBJECT=9058,j.WIRED_SET_OBJECT_VARIABLE_VALUE=9059,j.WIRED_SET_PREFERENCES=9060,j.WIRED_SET_ROOM_SETTINGS=9061;let P=j;class O1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class xx{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class gm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class N${constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class C1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class N1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class A1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class b1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class v1{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class y1{constructor(e,t,i){this._data=[e,t,i.length,...i]}getMessageArray(){return this._data}dispose(){}}class D1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class M1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class j1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class L1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class A${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class b${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class v${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class y${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class P1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class D${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class M${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class j${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class L${constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class U1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class P${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class U${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class w${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class w1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class F${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class k${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class G${constructor(...e){this._data=[e.length],e.forEach(t=>{this._data.push(t.itemId)})}getMessageArray(){return this._data}dispose(){}}class F1{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class gT{constructor(e,t=null,i=1){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class k1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class G1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class B1{constructor(e,t=0,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class V1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class rN{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class H1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class W1{constructor(e,t,i=0){this._data=[e,i,t]}getMessageArray(){return this._data}dispose(){}}class nN{constructor(...e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class Y1{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class z1{constructor(e,t=0,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class K1{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class d_{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class mT{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class q1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class X1{constructor(e,t,i,r,n,o,l,c,u,d,_,m,f,E,I,p,S,R,O,C,A,b,y,M,U,G,F=!1,H=0,v=0,B=0,z=0,$=0,W=0,V=0,se=0,ee=!0){this._data=[],this._data.push(e,t,i,r,n,o,l),this._data.push(u.length,...u),this._data.push(d,_,m,f,E,I,p,S,R,O,C,A,b,y,M,U,G,F,W,V,v,H,$,z,B,se,ee)}getMessageArray(){return this._data}dispose(){}}class $1{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class fT{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class so{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class Q1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class J1 extends Q1{constructor(e){super(e)}}class Z1{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class ew extends Q1{constructor(e){super(e)}}class Ox{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class tw{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class sw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class iw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class rw{constructor(e,t,i=""){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class nw{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class aN{constructor(e,t){this._data=[e,t.size*2];for(const[i,r]of t.entries())this._data.push(i,r)}getMessageArray(){return this._data}dispose(){}}class aw{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class ow{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class lw{constructor(e,t,i,r,n){this._data=[e,t,i,r,n]}getMessageArray(){return this._data}dispose(){}}class cw{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class uw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class hw{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class B${constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class V${constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Ud{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class dw{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _w{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class pT{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class mm{constructor(e,t,i,r,n,o){this._itemId=e,this._category=t,this._wallLocation=i,this._x=r,this._y=n,this._direction=o}getMessageArray(){switch(this._category){case Q.FLOOR:return[`${this._itemId} ${this._x} ${this._y} ${this._direction}`];case Q.WALL:return[`${this._itemId} ${this._wallLocation} `];default:return[]}}dispose(){}get itemId(){return this._itemId}get category(){return this._category}get wallLocation(){return this._wallLocation}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class Sd{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class ET{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class H${constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class gw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class mw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class fw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class pw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class ko{constructor(e,t=0,i=!1){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class Ew{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Iw{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class up{constructor(e,t=-100){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class oN{constructor(e,t,i=!1){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class Tw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Sw{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Rw{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class lN{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class W${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class xw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Ow{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Cw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Y${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Nw{constructor(e,t,i,r){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class fm{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class o_{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Aw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Cx{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class bw{constructor(e,t,i,r,n,o,l,c,u,d,_){this._data=[e,t,i,r,n,o,l,c,u,d,_]}getMessageArray(){return this._data}dispose(){}}class vw{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Nx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class yw{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class cN{constructor(e,t,i,r,n,o,l){this._data=[e,t,i,r,n,o,l]}getMessageArray(){return this._data}dispose(){}}class Dw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Mw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class jw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class uN{constructor(e,t=0){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Lw{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Pw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Uw{constructor(e,t,i){this._data=[e+" "+t,i]}getMessageArray(){return this._data}dispose(){}}class ww{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Fw{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class kw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Gw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Ax{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Bw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class hN{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Vw{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Hw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Ww{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Yw{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}const K_=class K_{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}};K_.STATE_START=0,K_.STATE_CANCEL=1,K_.STATE_ACCEPT=2;let hp=K_;class z${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class K${constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class zw{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class q${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Kw{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qw{constructor(e,t,i,r,n,o,l,c,u){this._data=[e,t.length,...t,i.length,...i,r,n.length,...n,o.length,...o,l,c.length,...c,u.length,...u]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class Xw{constructor(e,t,i,r,n,o,l,c,u){this._data=[e,t.length,...t,i.length,...i,r,n.length,...n,o.length,...o,l,c.length,...c,u.length,...u]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class $w{constructor(e,t,i,r,n,o,l,c){this._data=[e,t.length,...t,i.length,...i,r,n.length,...n,o.length,...o,l.length,...l,c.length,...c]}getMessageArray(){return this._data}dispose(){}}class Qw{constructor(e,t,i,r,n,o,l,c){this._data=[e,t.length,...t,i.length,...i,r,n.length,...n,o.length,...o,l.length,...l,c.length,...c]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class Jw{constructor(e){if(e==null){this._data=[0];return}this._data=[e.size];for(let t of e){const i=t[0],r=t[1];this._data.push(i),this._data.push(r)}}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class sf{constructor(e){this._data=[e]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class Zw{constructor(){this._data=[]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class eF{constructor(e,t){this._data=[e,t]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class tF{constructor(e,t,i,r){this._data=[e,t,i,r]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class X${constructor(){this._data=[]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class sF{constructor(){this._data=[]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class iF{constructor(){this._data=[]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class rF{constructor(){this._data=[]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class nF{constructor(e,t,i,r){this._data=[e,t,i,r]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class aF{constructor(e,t,i){this._data=[e,t,i]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class $${constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class oF{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class lF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class cF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class uF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class hF{constructor(...e){this._data=[e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class Q${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class J${constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class dF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _F{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class gF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class mF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Z${constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class eQ{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class tQ{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class sQ{constructor(e,t,i,r,n,o,l,c,u,d,_){this._data=[e,t,i,r,n,o,l,c,u,d,_]}getMessageArray(){return this._data}dispose(){}}class fF{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class pm{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class iQ{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class rQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class pF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class EF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class IF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class nQ{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class TF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class SF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class aQ{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class oQ{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class RF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class dN{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class xF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class OF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class CF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class _N{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class gN{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class NF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class AF{constructor(e,t=!0){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class mN{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class bF{constructor(e,t){this._data=[e,...t]}getMessageArray(){return this._data}dispose(){}}class vF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class bx{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class yF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class DF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class MF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class jF{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class LF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class PF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class UF{constructor(e,t,i,r,n,o,l,c,u,d,_){this._data=[e,t,i,r,n,o,l,c,u,d,_]}getMessageArray(){return this._data}dispose(){}}class wF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class fN{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class FF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class kF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class GF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class BF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class VF{constructor(e,t,i){this._data=[e,t,i]}getMessageArray(){return this._data}dispose(){}}class HF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class WF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class YF{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class zF{constructor(e,t){this._data=[e,t]}dispose(){}getMessageArray(){return this._data}}class KF{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class lQ{flush(){return this._author="",this._title="",this._content="",this._color="",this._button=!1,this._buttonType="",this._buttonParam="",!0}parse(e){return e?(this._author=e.readString(),this._title=e.readString(),this._content=e.readString(),this._color=e.readString(),this._button=e.readBoolean(),this._buttonType=e.readString(),this._buttonParam=e.readString(),!0):!1}get author(){return this._author}get title(){return this._title}get content(){return this._content}get color(){return this._color}get button(){return this._button}get buttonType(){return this._buttonType}get buttonParam(){return this._buttonParam}}class qF extends w{constructor(e){super(e,lQ)}getParser(){return this.parser}}class cQ{flush(){return this._furniId=0,!0}parse(e){return e?(this._furniId=e.readInt(),!0):!1}get furniId(){return this._furniId}}class XF extends w{constructor(e){super(e,cQ)}getParser(){return this.parser}}class uQ{flush(){return this._colors="[]",!0}parse(e){return e?(this._colors=e.readString(),!0):!1}get colors(){return this._colors}}class $F extends w{constructor(e){super(e,uQ)}getParser(){return this.parser}}class hQ{flush(){return this._videoCode="",this._usename="",this._hasRights=!1,!0}parse(e){return e?(this._videoCode=e.readString(),this._usename=e.readString(),this._hasRights=e.readBoolean(),!0):!1}get videoCode(){return this._videoCode}get username(){return this._usename}get hasRight(){return this._hasRights}}class QF extends w{constructor(e){super(e,hQ)}getParser(){return this.parser}}class dQ{constructor(){this._volume=.7}flush(){return this._sound="",this._volume=.7,!0}parse(e){return e?(this._sound=e.readString(),e.bytesAvailable&&(this._volume=e.readInt()/100),!0):!1}get sound(){return this._sound}get volume(){return this._volume}}class JF extends w{constructor(e){super(e,dQ)}getParser(){return this.parser}}const mu=class mu{static get available(){return this._isListeningForPostMessages||(this._isListeningForPostMessages=!0,window.addEventListener("message",e=>{if(typeof e.data=="string"&&e.data.startsWith(mu.MESSAGE_KEY)){const{method:t,params:i}=JSON.parse(e.data.substr(mu.MESSAGE_KEY.length)),r=window[t];if(!r)return;r(...i);return}})),!0}static call(e,...t){if(window.top!==window&&window.top.postMessage(mu.MESSAGE_KEY+JSON.stringify({method:e,params:t}),"*"),!("FlashExternalInterface"in window))return;const i=window.FlashExternalInterface[e];return typeof i<"u"?i(...t):void 0}static callGame(e,...t){if(window.top!==window&&window.top.postMessage("Nitro_LegacyExternalGameInterface"+JSON.stringify({method:e,params:t}),"*"),!("FlashExternalGameInterface"in window))return;const i=window.FlashExternalGameInterface[e];return typeof i<"u"?i(...t):void 0}static addCallback(e,t){window[e]=t}};mu.MESSAGE_KEY="Nitro_LegacyExternalInterface",mu._isListeningForPostMessages=!1;let Me=mu;class ZF{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class _Q{get storeData(){return this._storeData}flush(){return this._storeData=null,!0}parse(e){if(!e)return!1;this._storeData={};const t=[],i=[],r=[],n=[],o=[],l=e.readInt();for(let m=0;m<l;m++){const f={};f.id=e.readInt(),f.amount=e.readInt(),f.valueType=e.readString(),f.value=e.readInt(),f.valueReais=e.readInt(),f.valueEuros=e.readInt(),f.smallDescription=e.readString(),f.bgImage=e.readString(),f.endDate=Number(e.readString()),f.bgColor=e.readString(),f.name=e.readString(),f.valueReaisOriginal=e.readInt(),f.valueEurosOriginal=e.readInt(),f.info=JSON.parse(e.readString()),f.limitedIndex=e.readInt(),f.limitedTotal=e.readInt(),t.push(f)}const c=e.readInt();for(let m=0;m<c;m++){const f={};f.id=e.readInt(),f.amount=e.readInt(),f.valueType=e.readString(),f.value=e.readInt(),f.valueReais=e.readInt(),f.valueEuros=e.readInt(),f.smallDescription=e.readString(),f.bgImage=e.readString(),f.endDate=Number(e.readString()),f.bgColor=e.readString(),f.name=e.readString(),f.valueReaisOriginal=e.readInt(),f.valueEurosOriginal=e.readInt(),f.info=JSON.parse(e.readString()),f.limitedIndex=e.readInt(),f.limitedTotal=e.readInt(),i.push(f)}const u=e.readInt();for(let m=0;m<u;m++){const f={};f.id=e.readInt(),f.amount=e.readInt(),f.valueType=e.readString(),f.value=e.readInt(),f.valueReais=e.readInt(),f.valueEuros=e.readInt(),f.smallDescription=e.readString(),f.bgImage=e.readString(),f.endDate=Number(e.readString()),f.bgColor=e.readString(),f.name=e.readString(),f.valueReaisOriginal=e.readInt(),f.valueEurosOriginal=e.readInt(),f.info=JSON.parse(e.readString()),f.limitedIndex=e.readInt(),f.limitedTotal=e.readInt(),r.push(f)}const d=e.readInt();for(let m=0;m<d;m++){const f={};f.id=e.readInt(),f.amount=e.readInt(),f.valueType=e.readString(),f.value=e.readInt(),f.valueReais=e.readInt(),f.valueEuros=e.readInt(),f.smallDescription=e.readString(),f.bgImage=e.readString(),f.endDate=Number(e.readString()),f.bgColor=e.readString(),f.name=e.readString(),f.valueReaisOriginal=e.readInt(),f.valueEurosOriginal=e.readInt(),f.info=JSON.parse(e.readString()),f.limitedIndex=e.readInt(),f.limitedTotal=e.readInt(),n.push(f)}const _=e.readInt();for(let m=0;m<_;m++){const f={};f.id=e.readInt(),f.amount=e.readInt(),f.valueType=e.readString(),f.value=e.readInt(),f.valueReais=e.readInt(),f.valueEuros=e.readInt(),f.smallDescription=e.readString(),f.bgImage=e.readString(),f.endDate=Number(e.readString()),f.bgColor=e.readString(),f.name=e.readString(),f.valueReaisOriginal=e.readInt(),f.valueEurosOriginal=e.readInt(),f.info=JSON.parse(e.readString()),f.limitedIndex=e.readInt(),f.limitedTotal=e.readInt(),o.push(f)}return this._storeData.hubbeCoins=t,this._storeData.diamantes=i,this._storeData.pacotes=r,this._storeData.vip=n,this._storeData.promocoes=o,!0}}class ek extends w{constructor(e){super(e,_Q)}getParser(){return this.parser}}function Oe(){return De.instance}function fs(a){Oe().addLinkEventTracker(a)}function qt(){return Oe().avatar}function gb(a){return qt().structureData.getPalette(a)}function mb(a){return qt().structureData.getSetType(a)}function __(){return Oe().cameraManager}function gQ(){return Oe().core}function mQ(){return gQ().configuration}function Ce(a){a=a.startsWith("event:")?a.substring(6):a,Oe().createLinkEvent(a)}function Hg(){var a;return(a=Oe())==null?void 0:a.communication}function xe(a,e=null){return st.getValue(a,e)}function vl(){var a;return(a=Hg())==null?void 0:a.connection}function tk(){return Oe().localization}const nh=a=>{!a||!a.length||(a.startsWith("http")?Xa.openWebPage(a):Ce(a))};function ps(a){Oe().removeLinkEventTracker(a)}function ce(){return Oe().roomEngine}let zT=!1,vm=0,ym=0;const Dm=(a,e=1,t)=>{const i=a.clientX,r=a.clientY;let n=a.type;switch(n===Re.MOUSE_CLICK&&(vm&&(ym=1,vm>=Date.now()-300&&ym++),vm=Date.now(),ym===2&&(zT||(n=Re.DOUBLE_CLICK),ym=0,vm=null)),n){case Re.MOUSE_CLICK:break;case Re.DOUBLE_CLICK:break;case Re.MOUSE_MOVE:zT=!0;break;case Re.MOUSE_DOWN:zT=!1;break;case Re.MOUSE_UP:break;case Re.RIGHT_CLICK:break;default:return}ce().dispatchMouseEvent(e,i,r,n,a.altKey,a.ctrlKey||a.metaKey,a.shiftKey,!1,t)};let KT=!1,Mm=0,jm=0,r_=null;function fb(a,e){return Math.hypot(e.clientX-a.clientX,e.clientY-a.clientY)}const Lm=(a,e=1,t=!1,i=!1,r=!1,n=!1,o)=>{let l=0,c=0;a.touches[0]?(l=a.touches[0].clientX,c=a.touches[0].clientY):a.changedTouches[0]&&(l=a.changedTouches[0].clientX,c=a.changedTouches[0].clientY);let u=a.type;switch(t&&(u=Kr.TOUCH_LONG),(u===Re.MOUSE_CLICK||u===Kr.TOUCH_END)&&(u=Re.MOUSE_CLICK,Mm&&(jm=1,Mm>=Date.now()-300&&jm++),Mm=Date.now(),jm===2&&(KT||(u=Re.DOUBLE_CLICK),jm=0,Mm=null)),u){case Re.MOUSE_CLICK:break;case Re.DOUBLE_CLICK:break;case Kr.TOUCH_START:if(u=Re.MOUSE_DOWN,KT=!1,a.touches.length===2){const[d,_]=a.touches;r_=fb(d,_)}break;case Kr.TOUCH_MOVE:if(u=Re.MOUSE_MOVE,KT=!0,a.touches.length===2){const[d,_]=a.touches,m=fb(d,_);if(r_!==null){const f=m-r_;Math.abs(f)>5&&(ce().dispatchRollEvent(e,f>0?"up":"down",!0),r_=m)}}break;case Kr.TOUCH_END:u=Re.MOUSE_UP,r_=null;break;case Kr.TOUCH_LONG:u=Re.MOUSE_DOWN_LONG;break;default:return}u===Kr.TOUCH_START&&ce().dispatchMouseEvent(e,l,c,u,i,r,n,!1,o),ce().dispatchMouseEvent(e,l,c,u,i,r,n,!1,o)};function gr(a){if(!a||!a.model)return!1;const e=te().userId,t=a.model.getValue(D.FURNITURE_OWNER_ID);return e===t}function Wg(a,e,t){return a?a.isRoomOwner||a.controllerLevel>=pt.USER_WITH_RIGHTS||te().isModerator||gr(ce().getRoomObject(a.roomId,e,t)):!1}function jl(){return Oe().roomSessionManager}function _c(a,e=null,t=1){jl().createSession(a,e,t)}function fQ(){const a=ah();return a?a.model.getValue(D.FIGURE_CAN_STAND_UP):We.POSTURE_STAND}function qT(){const a=ah();if(!a)return!1;const t=a.model.getValue(D.FIGURE_EFFECT);return!(t===29||t===30||t===185)}function te(){return Oe().sessionDataManager}function ti(){return xe("hc.disabled",!1)?rr.VIP:te().clubLevel}const ul=class ul{};ul.OKAY=0,ul.MISSING_OFFER=1,ul.FURNI_LIMIT_REACHED=2,ul.NOT_IN_ROOM=3,ul.NOT_ROOM_OWNER=4,ul.GUILD_ROOM=5,ul.VISITORS_IN_ROOM=6;let Qo=ul;class pQ{constructor(e,t,i){this._depth=0,this._localization="",this._pageId=-1,this._pageName="",this._iconId=0,this._depth=t,this._parent=i,this._localization=e.localization,this._pageId=e.pageId,this._pageName=e.pageName,this._iconId=e.icon,this._children=[],this._offerIds=e.offerIds,this._isVisible=e.visible,this._isActive=!1,this._isOpen=!1}activate(){this._isActive=!0}deactivate(){this._isActive=!1}open(){this._isOpen=!0}close(){this._isOpen=!1}addChild(e){e&&this._children.push(e)}get depth(){return this._depth}get isBranch(){return this._children.length>0}get isLeaf(){return this._children.length===0}get localization(){return this._localization}get pageId(){return this._pageId}get pageName(){return this._pageName}get iconId(){return this._iconId}get children(){return this._children}get offerIds(){return this._offerIds}get parent(){return this._parent}get isVisible(){return this._isVisible}get isActive(){return this._isActive}get isOpen(){return this._isOpen}}const nI=class nI{constructor(e,t,i,r,n,o=-1){this._pageId=e,this._layoutCode=t,this._localization=i,this._offers=r,this._acceptSeasonCurrencyAsCredits=n;for(const l of r)l.page=this;o===-1?this._mode=nI.MODE_NORMAL:this._mode=o}get pageId(){return this._pageId}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get mode(){return this._mode}};nI.MODE_NORMAL=0;let dp=nI;const ks=class ks{};ks.DUCKET_INFO="ducket_info",ks.CREDITS="credits",ks.AVATAR_EFFECTS="avatar_effects",ks.HC_MEMBERSHIP="hc_membership",ks.CLUB_GIFTS="club_gifts",ks.LIMITED_SOLD="limited_sold",ks.PET_ACCESSORIES="pet_accessories",ks.TRAX_SONGS="trax_songs",ks.NEW_ADDITIONS="new_additions",ks.QUEST_SHELL="quest_shell",ks.QUEST_SNOWFLAKES="quest_snowflakes",ks.VAL_QUESTS="val_quests",ks.GUILD_CUSTOM_FURNI="guild_custom_furni",ks.GIFT_SHOP="gift_shop",ks.HORSE_STYLES="horse_styles",ks.HORSE_SHOE="horse_shoe",ks.SET_EASTER="set_easter",ks.ECOTRON_TRANSFORM="ecotron_transform",ks.LOYALTY_INFO="loyalty_info",ks.ROOM_BUNDLES="room_bundles",ks.ROOM_BUNDLES_MOBILE="room_bundles_mobile",ks.HABBO_CLUB_DESKTOP="habbo_club_desktop",ks.MOBILE_SUBSCRIPTIONS="mobile_subscriptions",ks.PROMOCOINS="promocoins";let Yg=ks;class EQ{constructor(e,t){this.breed=e,this.palettes=t}}const hl=class hl{};hl.NONE=0,hl.CONFIRM=1,hl.PURCHASE=2,hl.NO_CREDITS=3,hl.NO_POINTS=4,hl.SOLD_OUT=5,hl.FAILED=6;let bs=hl;const aI=class aI{};aI.NORMAL="NORMAL",aI.BUILDER="BUILDERS_CLUB";let la=aI;const IQ=a=>"",TQ=a=>"",pb=(a,e)=>{const t=a.get(e),i=[];if(t&&t.length)for(const r of t)r.isVisible&&i.push(r);return i},sk=(a,e,t,i)=>{if(t.isVisible&&t.pageId>0){let r=!1;const n=[t.pageName,t.localization].join(" ").toLowerCase().replace(/ /gi,"");if(n.indexOf(a)>-1&&(i.push(t),r=!0),!r){for(const o of e)if(n.indexOf(o)>=0){i.push(t);break}}}for(const r of t.children)sk(a,e,r,i)};function SQ(a){if(!a.length)return 0;let e=a.length-1;for(;e>=0&&!isNaN(parseInt(a.charAt(e)));)e--;return e>0?parseInt(a.substring(e+1)):-1}function RQ(a,e){switch(a){case 0:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 1:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 2:return[[16579283],[15378351],[8830016],[15257125],[9340985],[8949607],[6198292],[8703620],[9889626],[8972045],[12161285],[13162269],[8620113],[12616503],[8628101],[13827840],[9764857]];case 3:return[[16777215],[15658734],[14540253]];case 4:return[[16777215],[16053490],[15464440],[16248792],[15396319],[15007487]];case 5:return[[16777215],[15658734],[14540253]];case 6:return[[16777215],[15658734],[14540253],[16767177],[16770205],[16751331]];case 7:return[[13421772],[11447982],[16751331],[10149119],[16763290],[16743786]];default:{const t=[];for(const i of e){const r=ce().getPetColorResult(a,i.paletteId);r&&(r.primaryColor===r.secondaryColor?t.push([r.primaryColor]):t.push([r.primaryColor,r.secondaryColor]))}return t}}}const uo=class uo{};uo.WALL="i",uo.FLOOR="s",uo.EFFECT="e",uo.HABBO_CLUB="h",uo.BADGE="b",uo.GAME_TOKEN="GAME_TOKEN",uo.PET="p",uo.ROBOT="r";let dt=uo;const oI=class oI{constructor(e,t,i,r,n,o,l=!1,c=0,u=0){this._productType=e.toLowerCase(),this._productClassId=t,this._extraParam=i,this._productCount=r,this._productData=n,this._furnitureData=o,this._isUniqueLimitedItem=l,this._uniqueLimitedItemSeriesSize=c,this._uniqueLimitedItemsLeft=u}static stripAddonProducts(e){return e.length===1?e:e.filter(t=>t.productType!==dt.BADGE&&t.productType!==dt.EFFECT&&t.productClassId!==oI.EFFECT_CLASSID_NINJA_DISAPPEAR)}getIconUrl(e=null,t=null){switch(this._productType){case dt.FLOOR:return ce().getFurnitureFloorIconUrl(this.productClassId);case dt.WALL:{if(e&&this._furnitureData){let i="";switch(this._furnitureData.className){case"floor":i=["th",this._furnitureData.className,e.product.extraParam].join("_");break;case"wallpaper":i=["th","wall",e.product.extraParam].join("_");break;case"landscape":i=["th",this._furnitureData.className,(e.product.extraParam||"").replace(".","_"),"001"].join("_");break}if(i!=="")return`${xe("catalog.asset.url")}/${i}.png`}return ce().getFurnitureWallIconUrl(this.productClassId,this._extraParam)}case dt.EFFECT:return IQ(this.productClassId);case dt.HABBO_CLUB:return TQ(this.productClassId);case dt.BADGE:return te().getBadgeUrl(this._extraParam);case dt.ROBOT:return null}return null}get productType(){return this._productType}get productClassId(){return this._productClassId}get extraParam(){return this._extraParam}set extraParam(e){this._extraParam=e}get productCount(){return this._productCount}get productData(){return this._productData}get furnitureData(){return this._furnitureData}get isUniqueLimitedItem(){return this._isUniqueLimitedItem}get uniqueLimitedItemSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}set uniqueLimitedItemsLeft(e){this._uniqueLimitedItemsLeft=e}};oI.EFFECT_CLASSID_NINJA_DISAPPEAR=108;let Sc=oI;const Di=class Di{constructor(e,t,i,r,n,o,l,c,u,d){this._clubLevel=0,this._bundlePurchaseAllowed=!1,this._offerId=e,this._localizationId=t,this._isRentOffer=i,this._priceInCredits=r,this._priceInActivityPoints=n,this._activityPointType=o,this._giftable=l,this._clubLevel=c,this._products=u,this._bundlePurchaseAllowed=d,this.setPricingModelForProducts(),this.setPricingType();for(const _ of u)if(_.productType===dt.BADGE){this._badgeCode=_.extraParam;break}}activate(){}get clubLevel(){return this._clubLevel}get page(){return this._page}set page(e){this._page=e}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get giftable(){return this._giftable}get product(){if(!this._products||!this._products.length)return null;if(this._products.length===1)return this._products[0];const e=Sc.stripAddonProducts(this._products);return e.length?e[0]:null}get pricingModel(){return this._pricingModel}get priceType(){return this._priceType}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isRentOffer(){return this._isRentOffer}get badgeCode(){return this._badgeCode}get localizationName(){const e=Rd(this._localizationId);return e?e.name:g(this._localizationId)}get localizationDescription(){const e=Rd(this._localizationId);return e?e.description:g(this._localizationId)}get isLazy(){return!1}get products(){return this._products}setPricingModelForProducts(){const e=Sc.stripAddonProducts(this._products);e.length===1?e[0].productCount===1?this._pricingModel=Di.PRICING_MODEL_SINGLE:this._pricingModel=Di.PRICING_MODEL_MULTI:e.length>1?this._pricingModel=Di.PRICING_MODEL_BUNDLE:this._pricingModel=Di.PRICING_MODEL_UNKNOWN}setPricingType(){this._priceInCredits>0&&this._priceInActivityPoints>0?this._priceType=Di.PRICE_TYPE_CREDITS_ACTIVITYPOINTS:this._priceInCredits>0?this._priceType=Di.PRICE_TYPE_CREDITS:this._priceInActivityPoints>0?this._priceType=Di.PRICE_TYPE_ACTIVITYPOINTS:this._priceType=Di.PRICE_TYPE_NONE}clone(){const e=[],t=Rd(this.localizationId);for(const r of this._products){const n=vx(r.productClassId,r.productType);e.push(new Sc(r.productType,r.productClassId,r.extraParam,r.productCount,t,n))}const i=new Di(this.offerId,this.localizationId,this.isRentOffer,this.priceInCredits,this.priceInActivityPoints,this.activityPointType,this.giftable,this.clubLevel,e,this.bundlePurchaseAllowed);return i.page=this.page,i}};Di.PRICING_MODEL_UNKNOWN="pricing_model_unknown",Di.PRICING_MODEL_SINGLE="pricing_model_single",Di.PRICING_MODEL_MULTI="pricing_model_multi",Di.PRICING_MODEL_BUNDLE="pricing_model_bundle",Di.PRICING_MODEL_FURNITURE="pricing_model_furniture",Di.PRICE_TYPE_NONE="price_type_none",Di.PRICE_TYPE_CREDITS="price_type_credits",Di.PRICE_TYPE_ACTIVITYPOINTS="price_type_activitypoints",Di.PRICE_TYPE_CREDITS_ACTIVITYPOINTS="price_type_credits_and_activitypoints";let Zi=Di;class xQ{constructor(e){this._furniData=e,this._product=new Sc(this._furniData.type,this._furniData.id,this._furniData.customParams,1,Rd(this._furniData.className),this._furniData)}activate(){K(new EP(this._furniData.rentOfferId>0?this._furniData.rentOfferId:this._furniData.purchaseOfferId))}get offerId(){return this.isRentOffer?this._furniData.rentOfferId:this._furniData.purchaseOfferId}get priceInActivityPoints(){return 0}get activityPointType(){return 0}get priceInCredits(){return 0}get page(){return this._page}set page(e){this._page=e}get priceType(){return""}get product(){return this._product}get products(){return[this._product]}get localizationId(){return"roomItem.name."+this._furniData.id}get bundlePurchaseAllowed(){return!1}get isRentOffer(){return this._furniData.rentOfferId>-1}get giftable(){return!1}get pricingModel(){return Zi.PRICING_MODEL_FURNITURE}get clubLevel(){return 0}get badgeCode(){return""}get localizationName(){return this._furniData.name}get localizationDescription(){return this._furniData.description}get isLazy(){return!0}}const pN=(a,e,t=null)=>{let i=null;switch(a.toLocaleLowerCase()){case dt.FLOOR:i=ce().getFurnitureFloorIconUrl(e);break;case dt.WALL:i=ce().getFurnitureWallIconUrl(e,t);break}return i};class OQ{constructor(e){this._isEnabled=!1,this._price=null,this._stuffTypes=null,this._boxTypes=null,this._ribbonTypes=null,this._defaultStuffTypes=null,this._isEnabled=e.isEnabled,this._price=e.price,this._boxTypes=e.boxTypes,this._ribbonTypes=e.ribbonTypes,this._stuffTypes=e.giftWrappers,this._defaultStuffTypes=e.giftFurnis}get isEnabled(){return this._isEnabled}get price(){return this._price}get stuffTypes(){return this._stuffTypes}get boxTypes(){return this._boxTypes}get ribbonTypes(){return this._ribbonTypes}get defaultStuffTypes(){return this._defaultStuffTypes}}const lI=class lI{constructor(e,t,i,r,n,o,l,c,u=-1,d){this._timeLeftMinutes=-1,this._offerId=e,this._furniId=t,this._furniType=i,this._extraData=r,this._stuffData=n,this._price=o,this._status=l,this._averagePrice=c,this._offerCount=u,this._rarePrice=d}get offerId(){return this._offerId}set offerId(e){this._offerId=e}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}set price(e){this._price=e}get averagePrice(){return this._averagePrice}get image(){return this._image}set image(e){this._image=e}get imageCallback(){return this._imageCallback}set imageCallback(e){this._imageCallback=e}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}set timeLeftMinutes(e){this._timeLeftMinutes=e}get offerCount(){return this._offerCount}set offerCount(e){this._offerCount=e}get isUniqueLimitedItem(){return this.stuffData&&this.stuffData.uniqueSeries>0}get rarePrice(){return this._rarePrice}};lI.TYPE_FLOOR=1,lI.TYPE_WALL=2;let qu=lI;const Zh=class Zh{};Zh.ONGOING=1,Zh.ONGOING_OWN=1,Zh.SOLD=2,Zh.EXPIRED=3;let zg=Zh;const q_=class q_{};q_.BY_ACTIVITY=1,q_.BY_VALUE=2,q_.ADVANCED=3;let hr=q_;class ik{constructor(e,t){this._images=e,this._texts=t}getText(e){let t=this._texts[e]||"";return t&&t.length&&(t=t.replace(/\r\n|\r|\n/g,"<br />")),t}getImage(e){const t=this._images[e]||"";if(!t||!t.length)return null;let i=xe("catalog.asset.image.url");return i=i.replace("%name%",t),i}}class CQ{constructor(e,t,i,r,n,o,l,c){this.roomId=e,this.objectId=t,this.category=i,this.wallLocation=r,this.x=n,this.y=o,this.direction=l,this.offer=c}get offerId(){return this.offer.offerId}get productClassId(){return this.offer.product.productClassId}get productData(){return this.offer.product.productData}get furniData(){return this.offer.product.furnitureData}get extraParam(){return this.offer.product.extraParam}}const Na=class Na{constructor(){this._requestType=Na.REQUEST_TYPE_NONE}resetRequest(){this._requestType=Na.REQUEST_TYPE_NONE,this._requestById=-1,this._requestedByOfferId=-1,this._requestByName=null}get requestType(){return this._requestType}get requestById(){return this._requestById}set requestById(e){this._requestType=Na.REQUEST_TYPE_ID,this._requestById=e}get requestedByOfferId(){return this._requestedByOfferId}set requestedByOfferId(e){this._requestType=Na.REQUEST_TYPE_OFFER,this._requestedByOfferId=e}get requestByName(){return this._requestByName}set requestByName(e){this._requestType=Na.REQUEST_TYPE_NAME,this._requestByName=e}};Na.REQUEST_TYPE_NONE=0,Na.REQUEST_TYPE_ID=1,Na.REQUEST_TYPE_OFFER=2,Na.REQUEST_TYPE_NAME=3;let qc=Na;class NQ{constructor(e,t,i){this.searchValue=e,this.offers=t,this.filteredNodes=i}}function vx(a,e){let t=null;switch(e.toLowerCase()){case dt.FLOOR:t=te().getFloorItemData(a);break;case dt.WALL:t=te().getWallItemData(a);break}return t}function IT(a,e,t){const i=ce().getRoomObject(a,e,t);if(!i)return;const r=i.model.getValue(D.FURNITURE_TYPE_ID);switch(t){case Q.FLOOR:return te().getFloorItemData(r);case Q.WALL:return te().getWallItemData(r)}return null}function AQ(){const a=ah();return a?a.model.getValue(D.FIGURE_POSTURE):We.POSTURE_STAND}function Rd(a){return a?te().getProductData(a):null}function $e(){return jl().getSession(-1)}function yx(){K(new vP)}function Uu(){return te().clubLevel>=rr.CLUB}function bQ(){return te().clubLevel>=rr.VIP}function vQ(a){const e=ce().getRoomObject($e().roomId,a,Q.FLOOR);if(!e||!e.model)return!1;const t=te().userId,i=e.model.getValue(D.FURNITURE_OWNER_ID);return t===i}function yQ(){const a=ah();return a?a.model.getValue(D.FIGURE_EFFECT)===77:!1}function DQ(a){jl().startSession(a)}const rk=()=>{$e()&&(yx(),jl().removeSession(-1))};function ah(){const a=te().userId,e=ce().activeRoomId,t=Q.UNIT,i=ce().getTotalObjectsForManager(e,t);let r=0;for(;r<i;){const n=ce().getRoomObjectByIndex(e,r,t);if(n){const o=$e().userDataManager.getUserDataByIndex(n.id);if(o&&o.webID===a)return n}r++}return null}const EN=(a,e,t,i=1)=>{const r=ce().getRoomObjectBoundingRectangle(a,e,t,i);return r?(r.x=Math.round(r.x),r.y=Math.round(r.y),r):null},nk=(a,e,t,i=1)=>{const r=ce().getRoomObjectScreenLocation(a,e,t,i);return r?(r.x=Math.round(r.x),r.y=Math.round(r.y),r):null},MQ=(a,e,t=1)=>{const i=ce(),r=i.activeRoomId;i.initializeRoomInstanceRenderingCanvas(r,t,a,e)};function jQ(a){let e=!1;const t=ce().getRoomObject(a.roomId,a.objectId,a.category);return t&&t.model.getValue(D.FURNITURE_SELECTION_DISABLED)===1&&(e=!0,te().isModerator&&(e=!1)),e}function Xc(a,e,t){ce().processRoomObjectOperation(a,e,t)}function Eb(a){ce().setActiveRoomId(a)}const ak=["Control","Shift","Alt","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],_p={},LQ=(a,e)=>{ak.includes(a.key)&&!_p[a.key]&&(_p[a.key]=!0,e&&e.connection.send(new fN(a.key,0)))},PQ=(a,e)=>{ak.includes(a.key)&&_p[a.key]&&(_p[a.key]=!1,e&&e.connection.send(new fN(a.key,1)))},Ib=(a,e,t)=>{t==="keydown"?LQ(a,e):t==="keyup"&&PQ(a,e)},UQ=(a,e=1)=>{const t=a.deltaY>0?"down":"up";ce().dispatchRollEvent(e,t)},K=a=>vl().send(a);class pn{static getAchievementBadgeCode(e){if(!e)return null;let t=e.badgeId;return e.finalLevel||(t=tk().getPreviousLevelBadgeId(t)),t}static getAchievementCategoryImageUrl(e,t=null,i=!1){const r=xe("achievements.images.url");let n=i?"achicon_":"achcategory_";return n+=e.code,t!==null&&(n+=`_${t>0?"active":"inactive"}`),r.replace("%image%",n)}static getAchievementCategoryMaxProgress(e){if(!e)return 0;let t=0;for(const i of e.achievements)t+=i.levelCount;return t}static getAchievementCategoryProgress(e){if(!e)return 0;let t=0;for(const i of e.achievements)t+=i.finalLevel?i.level:i.level-1;return t}static getAchievementCategoryTotalUnseen(e){if(!e)return 0;let t=0;for(const i of e.achievements)i.unseen>0&&t++;return t}static getAchievementHasStarted(e){return e?!!(e.finalLevel||e.level-1>0):!1}static getAchievementIsIgnored(e){if(!e)return!1;const t=xe("achievements.unseen.ignored"),i=e.badgeId.replace(/[0-9]/g,"");return t.indexOf(i)>=0}static getAchievementLevel(e){return e?e.finalLevel?e.level:e.level-1:0}}class Tb{constructor(e){this._code=e,this._achievements=[]}getProgress(){return pn.getAchievementCategoryProgress(this)}getMaxProgress(){return pn.getAchievementCategoryMaxProgress(this)}get code(){return this._code}get achievements(){return this._achievements}set achievements(e){this._achievements=e}}const ed=class ed{};ed.ACTION_SAVE="AEA_ACTION_SAVE",ed.ACTION_CLEAR="AEA_ACTION_CLEAR",ed.ACTION_RESET="AEA_ACTION_RESET",ed.ACTION_RANDOMIZE="AEA_ACTION_RANDOMIZE";let Qi=ed;class wQ{constructor(e,t=!1){this._partColor=e,this._isDisabled=t,this._isHC=this._partColor.clubLevel>0,this._isSelected=!1}dispose(){this._partColor=null}get partColor(){return this._partColor}get color(){return Ri.int2rgb(this._partColor.rgb)}get isDisabled(){return this._isDisabled}get isHC(){return this._isHC}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e,this.notify&&this.notify()}get notify(){return this._notifier}set notify(e){this._notifier=e}}class IN{constructor(e,t,i){this._selectedPartIndex=-1,this._name=e,this._parts=t,this._palettes=i,this._selectedPartIndex=-1}static defaultColorId(e,t){if(!e||!e.length)return-1;let i=0;for(;i<e.length;){const r=e[i];if(r.partColor&&r.partColor.clubLevel<=t)return r.partColor.id;i++}return-1}init(){for(const e of this._parts)e&&e.init()}dispose(){if(this._parts){for(const e of this._parts)e.dispose();this._parts=null}if(this._palettes){for(const e of this._palettes)for(const t of e)t.dispose();this._palettes=null}this._selectedPartIndex=-1,this._paletteIndexes=null}selectPartId(e){if(!this._parts)return;let t=0;for(;t<this._parts.length;){if(this._parts[t].id===e){this.selectPartIndex(t);return}t++}}selectColorIds(e){if(!e||!this._palettes)return;this._paletteIndexes=new Array(e.length);let t=0;for(;t<this._palettes.length;){const i=this.getPalette(t);if(i){let r=0;if(e.length>t)r=e[t];else{const o=i[0];o&&o.partColor&&(r=o.partColor.id)}let n=0;for(;n<i.length;){const o=i[n];o.partColor.id===r?(this._paletteIndexes[t]=n,o.isSelected=!0):o.isSelected=!1,n++}}t++}this.updatePartColors()}selectPartIndex(e){if(!this._parts)return null;if(this._selectedPartIndex>=0&&this._parts.length>this._selectedPartIndex){const t=this._parts[this._selectedPartIndex];t&&(t.isSelected=!1)}if(this._parts.length>e){const t=this._parts[e];if(t)return t.isSelected=!0,this._selectedPartIndex=e,t}return null}selectColorIndex(e,t){const i=this.getPalette(t);if(!i||i.length<=e)return null;this.deselectColorIndex(this._paletteIndexes[t],t),this._paletteIndexes[t]=e;const r=i[e];return r?(r.isSelected=!0,this.updatePartColors(),r):null}getCurrentColorIndex(e){return this._paletteIndexes[e]}deselectColorIndex(e,t){const i=this.getPalette(t);if(!i||i.length<=e)return;const r=i[e];r&&(r.isSelected=!1)}getSelectedColorIds(){if(!this._paletteIndexes||!this._paletteIndexes.length||!this._palettes||!this._palettes.length)return null;const e=this._palettes[0];if(!e||!e.length)return null;const t=e[0];if(!t||!t.partColor)return null;const i=t.partColor.id,r=[];let n=0;for(;n<this._paletteIndexes.length;){const l=this._palettes[n];if(!(!l||l.length<=n))if(l.length>this._paletteIndexes[n]){const c=l[this._paletteIndexes[n]];c&&c.partColor?r.push(c.partColor.id):r.push(i)}else r.push(i);n++}const o=this.getCurrentPart();return o?r.slice(0,Math.max(o.maxColorIndex,1)):null}getSelectedColors(){const e=[];let t=0;for(;t<this._paletteIndexes.length;){const i=this.getSelectedColor(t);i?e.push(i.partColor):e.push(null),t++}return e}getSelectedColor(e){const t=this.getPalette(e);return!t||t.length<=this._paletteIndexes[e]?null:t[this._paletteIndexes[e]]}getSelectedColorId(e){const t=this.getSelectedColor(e);return t&&t.partColor?t.partColor.id:0}getPalette(e){return!this._paletteIndexes||!this._palettes||this._palettes.length<=e?null:this._palettes[e]}getCurrentPart(){return this._parts[this._selectedPartIndex]}updatePartColors(){const e=this.getSelectedColors();for(const t of this._parts)t&&(t.partColors=e)}hasClubSelectionsOverLevel(e){let t=!1;const i=this.getSelectedColors();if(i){let n=0;for(;n<i.length;){const o=i[n];o&&o.clubLevel>e&&(t=!0),n++}}const r=this.getCurrentPart();if(r&&r.partSet){const n=r.partSet;n&&n.clubLevel>e&&(t=!0)}return t}hasInvalidSelectedItems(e){const t=this.getCurrentPart();if(!t)return!1;const i=t.partSet;if(!(!i||!i.isSellable))return e.indexOf(i.id)>-1}stripClubItemsOverLevel(e){const t=this.getCurrentPart();if(t&&t.partSet&&t.partSet.clubLevel>e){const r=this.selectPartIndex(0);return r&&!r.partSet&&this.selectPartIndex(1),!0}return!1}stripClubColorsOverLevel(e){const t=[],i=this.getSelectedColors(),r=this.getPalette(0);let n=!1;const o=IN.defaultColorId(r,e);if(o===-1)return!1;let l=0;for(;l<i.length;){const c=i[l];c?c.clubLevel>e?(t.push(o),n=!0):t.push(c.id):(t.push(o),n=!0),l++}return n&&this.selectColorIds(t),n}get name(){return this._name}get parts(){return this._parts}get selectedPartIndex(){return this._selectedPartIndex}}const td=class td{static getGender(e){switch(e){case gn.MALE:case"m":case"M":e=gn.MALE;break;case gn.FEMALE:case"f":case"F":e=gn.FEMALE;break;default:e=gn.MALE}return e}static hasFigureSetId(e){return this.FIGURE_SET_IDS.indexOf(e)>=0}static createCategory(e,t){if(!e||!t||!this.CURRENT_FIGURE)return null;const i=[],r=[];let n=0;for(;n<this.MAX_PALETTES;)r.push([]),n++;const o=mb(t);if(!o)return null;const l=gb(o.paletteID);if(!l)return null;let c=this.CURRENT_FIGURE.getColorIds(t);c||(c=[]);const u=new Array(c.length),d=this.clubItemsDimmed,_=ti();for(const S of l.colors.getValues())if(S.isSelectable&&(d||_>=S.clubLevel)){let R=0;for(;R<this.MAX_PALETTES;){const O=_<S.clubLevel,C=new wQ(S,O);r[R].push(C),R++}if(t!==gn.FACE){let O=0;for(;O<c.length;)S.id===c[O]&&(u[O]=S),O++}}let m=[];if(d?m=qt().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,2):m=qt().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,_),m.indexOf(t)===-1){const S=new gp(null,null,!1);S.isClear=!0,i.push(S)}const E=t!==gn.FACE,I=o.partSets;for(n=I.length-1;n>=0;){const S=I.getWithIndex(n);let R=!1;if((S.gender===gn.UNISEX||S.gender===this.CURRENT_FIGURE.gender)&&(R=!0),S.isSelectable&&R&&(d||_>=S.clubLevel)){const O=_<S.clubLevel;let C=!0;S.isSellable&&(C=this.hasFigureSetId(S.id)),C&&i.push(new gp(S,u,E,O))}n--}for(i.sort(this.clubItemsFirst?this.clubSorter:this.noobSorter),n=0;n<this.MAX_PALETTES;)r[n].sort(this.colorSorter),n++;return new IN(t,i,r)}static clubSorter(e,t){const i=e.partSet?e.partSet.clubLevel:9999999999,r=t.partSet?t.partSet.clubLevel:9999999999,n=e.partSet?e.partSet.isSellable:!1,o=t.partSet?t.partSet.isSellable:!1;return n&&!o?1:o&&!n||i>r?-1:i<r?1:e.partSet.id>t.partSet.id?-1:e.partSet.id<t.partSet.id?1:0}static colorSorter(e,t){const i=e.partColor?e.partColor.clubLevel:-1,r=t.partColor?t.partColor.clubLevel:-1;return i<r?-1:i>r?1:e.partColor.index<t.partColor.index?-1:e.partColor.index>t.partColor.index?1:0}static noobSorter(e,t){const i=e.partSet?e.partSet.clubLevel:-1,r=t.partSet?t.partSet.clubLevel:-1,n=e.partSet?e.partSet.isSellable:!1,o=t.partSet?t.partSet.isSellable:!1;return n&&!o?1:o&&!n||i<r?-1:i>r?1:e.partSet.id<t.partSet.id?-1:e.partSet.id>t.partSet.id?1:0}static avatarSetFirstSelectableColor(e){const t=mb(e);if(!t)return-1;const i=gb(t.paletteID);if(!i)return-1;for(const r of i.colors.getValues())if(!(!r.isSelectable||ti()<r.clubLevel))return r.id;return-1}static get clubItemsFirst(){return xe("avatareditor.show.clubitems.first",!0)}static get clubItemsDimmed(){return xe("avatareditor.show.clubitems.dimmed",!0)}};td.MAX_PALETTES=2,td.CURRENT_FIGURE=null,td.FIGURE_SET_IDS=[],td.BOUND_FURNITURE_NAMES=[];let Dx=td;const Qe=class Qe{constructor(){this._gender="M",this._direction=Qe.DEFAULT_DIRECTION,this._avatarEffectType=-1,this._notifier=null}loadAvatarData(e,t){this._data=new Map,this._colors=new Map,this._gender=t,this.parseFigureString(e),this.updateView()}parseFigureString(e){if(!e)return;const t=e.split(".");if(!(!t||!t.length))for(const i of t){const r=i.split("-");if(!r.length)continue;const n=r[0],o=parseInt(r[1]),l=[];let c=2;for(;c<r.length;)l.push(parseInt(r[c])),c++;l.length||l.push(0),this.savePartSetId(n,o,!1),this.savePartSetColourId(n,l,!1)}}getPartSetId(e){const t=this._data.get(e);return t!==void 0?t:-1}getColorIds(e){const t=this._colors.get(e);return t!==void 0?t:[Dx.avatarSetFirstSelectableColor(e)]}getFigureString(){let e="";const t=[];for(const[r,n]of this._data.entries()){const o=this._colors.get(r);let l=r+"-"+n;if(o&&o.length){let c=0;for(;c<o.length;)l=l+("-"+o[c]),c++}t.push(l)}let i=0;for(;i<t.length;)e=e+t[i],i<t.length-1&&(e=e+"."),i++;return e}savePartData(e,t,i,r=!1){this.savePartSetId(e,t,r),this.savePartSetColourId(e,i,r)}savePartSetId(e,t,i=!0){switch(e){case Qe.FACE:case Qe.HAIR:case Qe.HAT:case Qe.HEAD_ACCESSORIES:case Qe.EYE_ACCESSORIES:case Qe.FACE_ACCESSORIES:case Qe.SHIRT:case Qe.JACKET:case Qe.CHEST_ACCESSORIES:case Qe.CHEST_PRINTS:case Qe.TROUSERS:case Qe.SHOES:case Qe.TROUSER_ACCESSORIES:t>=0?this._data.set(e,t):this._data.delete(e);break}i&&this.updateView()}savePartSetColourId(e,t,i=!0){switch(e){case Qe.FACE:case Qe.HAIR:case Qe.HAT:case Qe.HEAD_ACCESSORIES:case Qe.EYE_ACCESSORIES:case Qe.FACE_ACCESSORIES:case Qe.SHIRT:case Qe.JACKET:case Qe.CHEST_ACCESSORIES:case Qe.CHEST_PRINTS:case Qe.TROUSERS:case Qe.SHOES:case Qe.TROUSER_ACCESSORIES:this._colors.set(e,t);break}i&&this.updateView()}getFigureStringWithFace(e,t=!0){let i="";const r=[Qe.FACE],n=[];for(const l of r){const c=this._colors.get(l);if(!c)continue;let u=this._data.get(l);l===Qe.FACE&&t&&(u=e);let d=l+"-"+u;if(u>=0){let _=0;for(;_<c.length;)d=d+("-"+c[_]),_++}n.push(d)}let o=0;for(;o<n.length;)i=i+n[o],o<n.length-1&&(i=i+"."),o++;return i}updateView(){this.notify&&this.notify()}get gender(){return this._gender}get direction(){return this._direction}set direction(e){this._direction=e,this.updateView()}set avatarEffectType(e){this._avatarEffectType=e}get avatarEffectType(){return this._avatarEffectType}get notify(){return this._notifier}set notify(e){this._notifier=e}};Qe.DEFAULT_DIRECTION=4,Qe.MALE="M",Qe.FEMALE="F",Qe.UNISEX="U",Qe.SCALE="h",Qe.STD="std",Qe.DEFAULT_FRAME="0",Qe.FACE="hd",Qe.HAIR="hr",Qe.HAT="ha",Qe.HEAD_ACCESSORIES="he",Qe.EYE_ACCESSORIES="ea",Qe.FACE_ACCESSORIES="fa",Qe.JACKET="cc",Qe.SHIRT="ch",Qe.CHEST_ACCESSORIES="ca",Qe.CHEST_PRINTS="cp",Qe.TROUSERS="lg",Qe.SHOES="sh",Qe.TROUSER_ACCESSORIES="wa",Qe.SET_TYPES=[Qe.FACE,Qe.HAIR,Qe.HAT,Qe.HEAD_ACCESSORIES,Qe.EYE_ACCESSORIES,Qe.FACE_ACCESSORIES,Qe.JACKET,Qe.SHIRT,Qe.CHEST_ACCESSORIES,Qe.CHEST_PRINTS,Qe.TROUSERS,Qe.SHOES,Qe.TROUSERS];let gn=Qe;const ho=class ho{constructor(e,t,i=!0,r=!1){if(this._renderManager=qt(),this._partSet=e,this._partColors=t,this._useColors=i,this._isDisabled=r,this._thumbContainer=null,this._imageUrl=null,this._maxColorIndex=0,this._isValidFigure=!1,this._isHC=!1,this._isSellable=!1,this._isClear=!1,this._isSelected=!1,this._disposed=!1,this._isInitalized=!1,e){const n=e.parts;for(const o of n)this._maxColorIndex=Math.max(this._maxColorIndex,o.colorLayerIndex)}}init(){this._isInitalized||(this._isInitalized=!0,this.update())}dispose(){this._disposed||(this._renderManager=null,this._partSet=null,this._partColors=null,this._imageUrl=null,this._disposed=!0,this._isInitalized=!1,this._thumbContainer&&(this._thumbContainer.destroy(),this._thumbContainer=null))}update(){this.updateThumbVisualization()}analyzeFigure(){if(!this._renderManager||!this._partSet||!this._partSet.parts||!this._partSet.parts.length)return!1;const e=this._renderManager.createFigureContainer(this.partSet.type+"-"+this.partSet.id);return this._renderManager.isFigureContainerReady(e)?(this._isValidFigure=!0,!0):(this._renderManager.downloadAvatarFigure(e,this),!1)}renderThumb(){if(!this._renderManager||!this._partSet||!this._isValidFigure&&!this.analyzeFigure())return null;const e=this._partSet.parts.concat().sort(this.sortByDrawOrder),t=new kn;for(const i of e){if(!i)continue;let r=null,n=0,o=!1;for(;!o&&n<ho.THUMB_DIRECTIONS.length;){const _=gn.SCALE+"_"+gn.STD+"_"+i.type+"_"+i.id+"_"+ho.THUMB_DIRECTIONS[n]+"_"+gn.DEFAULT_FRAME;r=this._renderManager.getAssetByName(_),r&&r.texture?o=!0:n++}if(!o)continue;const l=r.offsetX,c=r.offsetY;let u=null;if(this._useColors&&i.colorLayerIndex>0){const _=this._partColors[i.colorLayerIndex-1];_&&(u=_)}const d=new Is(r.texture);d.position.set(l,c),u&&(d.tint=u.rgb),t.addChild(d)}return t}updateThumbVisualization(){if(!this._isInitalized)return;let e=this._thumbContainer;e||(e=this.renderThumb()),e&&(this._partSet?(this._isHC=this._partSet.clubLevel>0,this._isSellable=this._partSet.isSellable):(this._isHC=!1,this._isSellable=!1),this._isDisabled&&this.setAlpha(e,.2),this._imageUrl=Vt.generateImageUrl(e),this.notify&&this.notify())}setAlpha(e,t){return e.filters=[ho.ALPHA_FILTER],e}sortByDrawOrder(e,t){const i=ho.DRAW_ORDER.indexOf(e.type),r=ho.DRAW_ORDER.indexOf(t.type);return i<r?-1:i>r?1:e.index<t.index?-1:e.index>t.index?1:0}resetFigure(e){this.analyzeFigure()&&this.update()}get disposed(){return this._disposed}get id(){return this._partSet?this._partSet.id:-1}get partSet(){return this._partSet}set partColors(e){this._partColors=e,this.update()}get isDisabled(){return this._isDisabled}set thumbContainer(e){this._thumbContainer=e,this.update()}get imageUrl(){return this._imageUrl}get maxColorIndex(){return this._maxColorIndex}get isHC(){return this._isHC}get isSellable(){return this._isSellable}get isClear(){return this._isClear}set isClear(e){this._isClear=e}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e,this.notify&&this.notify()}get notify(){return this._notifier}set notify(e){this._notifier=e}};ho.ALPHA_FILTER=new Qy(.2),ho.THUMB_DIRECTIONS=[2,6,0,4,3,1],ho.DRAW_ORDER=[Ee.LEFT_HAND_ITEM,Ee.LEFT_HAND,Ee.LEFT_SLEEVE,Ee.LEFT_COAT_SLEEVE,Ee.BODY,Ee.SHOES,Ee.LEGS,Ee.CHEST,Ee.CHEST_ACCESSORY,Ee.COAT_CHEST,Ee.CHEST_PRINT,Ee.WAIST_ACCESSORY,Ee.RIGHT_HAND,Ee.RIGHT_SLEEVE,Ee.RIGHT_COAT_SLEEVE,Ee.HEAD,Ee.FACE,Ee.EYES,Ee.HAIR,Ee.HAIR_BIG,Ee.FACE_ACCESSORY,Ee.EYE_ACCESSORY,Ee.HEAD_ACCESSORY,Ee.HEAD_ACCESSORY_EXTRA,Ee.RIGHT_HAND_ITEM];let gp=ho;const Dr=a=>{if(a==null||typeof a!="object")return a;const e=new a.constructor;for(const t in a)a.hasOwnProperty(t)&&(e[t]=a[t]);return e};class sr{static makeColorHex(e){return"#"+e}static makeColorNumberHex(e){return"#"+e.toString(16).padStart(6,"0")}static convertFromHex(e){return parseInt(e.replace("#",""),16)}static uintHexColor(e){const t=e>>>0;return sr.makeColorHex(t.toString(16).substring(2))}static int_to_8BitVals(e){const t=e>>24&255,i=e>>16&255,r=e>>8&255,n=e&255;return[t,i,r,n]}static eight_bitVals_to_int(e,t,i,r){return(e<<24)+(t<<16)+(i<<8)+(r|0)}static int2rgb(e){e>>>=0;const t=e&255,i=(e&65280)>>>8;return"rgba("+[(e&16711680)>>>16,i,t,1].join(",")+")"}static isColorDarkOrLight(e,t=!1){e=e.replace("#","");const i=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16),o=.299*i+.587*r+.114*n;return o<=100?t?"light":"dark":o>=200?t?"dark":"light":"neutral"}}const Bc=a=>{let e=Math.floor(a/86400),t=Math.floor(a%86400/3600),i=Math.floor(a%86400%3600/60),r=a%86400%3600%60;return e.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0")+":"+i.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")},Kg=a=>{try{return JSON.parse(window.localStorage.getItem(a))??null}catch{return null}},Em=a=>{let e=Oe().localization.getBadgeDesc(a);return(!e||!e.length)&&(e=`badge_desc_${a}`),e},$d=a=>{let e=Oe().localization.getBadgeName(a);return(!e||!e.length)&&(e=`badge_name_${a}`),e};function dr(a){return!a||isNaN(a)?"0":a.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function FQ(a){if(!a||isNaN(a))return"0";let e=Math.abs(a);const t=Math.pow(10,1),i=a<0;let r="";const n=[{key:"Q",value:Math.pow(10,15)},{key:"T",value:Math.pow(10,12)},{key:"B",value:Math.pow(10,9)},{key:"M",value:Math.pow(10,6)},{key:"K",value:1e3}];for(const o of n){let l=e/o.value;if(l=Math.round(l*t)/t,l>=1){e=l,r=o.key;break}}return(i?"-":"")+e+r}function g(a,e=null,t=null){return Oe().getLocalizationWithParameters(a,e,t)}const Sr=class Sr{};Sr.CATALOG_PLACE_MULTIPLE_OBJECTS="catalogPlaceMultipleObjects",Sr.CATALOG_SKIP_PURCHASE_CONFIRMATION="catalogSkipPurchaseConfirmation",Sr.INVENTORY_SKIP_DELETE_ITEM_CONFIRMATION="inventorySkipDeleteItemConfirmation",Sr.WIRED_SKIP_OWNER_CONFIRMATION="wiredSkipOwnerConfirmation",Sr.WIRED_ALWAYS_OPEN_ADVANCED_OPTIONS="wiredAlwaysOpenAdvancedOptions",Sr.FURNITURE_FURNI_DETAILS="furnitureFurniDetails",Sr.SHOW_FPS="showFps",Sr.GROUP_REPEATED_MESSAGES="groupRepeatedMessage",Sr.SHOW_GIFS="nitro.showgifs",Sr.FONT_SIZE="nitro.fontsize",Sr.ROOM_ZOOM="nitro.roomzoom",Sr.ACTIVE_CHAT="nitro.active_chat",Sr.SAVED_SELECT_RESULT="savedSelectResult",Sr.SAVED_INVENTORY_PAGE="savedInventoryPage";let tr=Sr;const ok=(a,e)=>a.dispatchEvent(e),mp=a=>ok(Oe().events,a),Go=new Sn,_i=a=>ok(Go,a);let TN=!1;const yl=a=>{TN&&mp(new Ws(Ws.PLAY_SOUND,a))},kQ=(a,e)=>{TN&&mp(new Ws(Ws.PLAY_SOUND_EFFECT,a,e))},Sb=[Re.MOUSE_CLICK],GQ=()=>{const a=()=>Sb.forEach(t=>window.removeEventListener(t,e)),e=t=>(TN=!0)&&a();Sb.forEach(t=>window.addEventListener(t,e))};GQ();const zs=class zs{};zs.DEFAULT=1,zs.WALL_PAPER=2,zs.FLOOR=3,zs.LANDSCAPE=4,zs.POST_IT=5,zs.POSTER=6,zs.SOUND_SET=7,zs.TRAX_SONG=8,zs.PRESENT=9,zs.ECOTRON_BOX=10,zs.TROPHY=11,zs.CREDIT_FURNI=12,zs.PET_SHAMPOO=13,zs.PET_CUSTOM_PART=14,zs.PET_CUSTOM_PART_SHAMPOO=15,zs.PET_SADDLE=16,zs.GUILD_FURNI=17,zs.GAME_FURNI=18,zs.MONSTERPLANT_SEED=19,zs.MONSTERPLANT_REVIVAL=20,zs.MONSTERPLANT_REBREED=21,zs.MONSTERPLANT_FERTILIZE=22,zs.FIGURE_PURCHASABLE_SET=23;let Je=zs;class qg{constructor(e){e&&(this._locked=!1,this._id=e.itemId,this._type=e.spriteId,this._ref=e.ref,this._category=e.category,this._groupable=e.isGroupable&&!e.rentable,this._tradeable=e.tradable,this._recyclable=e.isRecycleable,this._sellable=e.sellable,this._deletable=e.deletable,this._stuffData=e.stuffData,this._extra=e.extra,this._secondsToExpiration=e.secondsToExpiration,this._expirationTimeStamp=e.expirationTimeStamp,this._hasRentPeriodStarted=e.hasRentPeriodStarted,this._creationDay=e.creationDay,this._creationMonth=e.creationMonth,this._creationYear=e.creationYear,this._slotId=e.slotId,this._songId=e.songId,this._flatId=e.flatId,this._isRented=e.rentable,this._isWallItem=e.isWallItem)}get rentable(){return this._isRented}get id(){return this._id}get ref(){return this._ref}get category(){return this._category}get type(){return this._type}get stuffData(){return this._stuffData}set stuffData(e){this._stuffData=e}get extra(){return this._extra}get recyclable(){return this._recyclable}get isTradable(){return this._tradeable}get isGroupable(){return this._groupable}get sellable(){return this._sellable}get deletable(){return this._deletable}get secondsToExpiration(){if(this._secondsToExpiration===-1)return-1;let e=-1;return this._hasRentPeriodStarted?(e=this._secondsToExpiration-(nt()-this._expirationTimeStamp)/1e3,e<0&&(e=0)):e=this._secondsToExpiration,e}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get slotId(){return this._slotId}get songId(){return this._songId}get locked(){return this._locked}set locked(e){this._locked=e}get flatId(){return this._flatId}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}update(e){this._type=e.spriteId,this._ref=e.ref,this._category=e.category,this._groupable=e.isGroupable&&!e.rentable,this._tradeable=e.tradable,this._recyclable=e.isRecycleable,this._sellable=e.sellable,this._stuffData=e.stuffData,this._extra=e.extra,this._secondsToExpiration=e.secondsToExpiration,this._expirationTimeStamp=e.expirationTimeStamp,this._hasRentPeriodStarted=e.hasRentPeriodStarted,this._creationDay=e.creationDay,this._creationMonth=e.creationMonth,this._creationYear=e.creationYear,this._slotId=e.slotId,this._songId=e.songId,this._flatId=e.flatId,this._isRented=e.rentable,this._isWallItem=e.isWallItem}clone(){const e=new qg(null);return e._expirationTimeStamp=this._expirationTimeStamp,e._isWallItem=this._isWallItem,e._songId=this._songId,e._locked=this._locked,e._id=this._id,e._ref=this._ref,e._category=this._category,e._type=this._type,e._stuffData=this._stuffData,e._extra=this._extra,e._recyclable=this._recyclable,e._tradeable=this._tradeable,e._groupable=this._groupable,e._sellable=this._sellable,e._secondsToExpiration=this._secondsToExpiration,e._hasRentPeriodStarted=this._hasRentPeriodStarted,e._creationDay=this._creationDay,e._creationMonth=this._creationMonth,e._creationYear=this._creationYear,e._slotId=this._slotId,e._isRented=this._isRented,e._flatId=this._flatId,e}}class SN{constructor(e=-1,t=-1,i=null,r=null,n=-1){this._type=e,this._category=t,this._roomEngine=i,this._stuffData=r,this._extra=n,this._isWallItem=!1,this._iconUrl=null,this._name=null,this._description=null,this._locked=!1,this._selected=!1,this._hasUnseenItems=!1,this._items=[]}clone(){const e=new SN;return e._type=this._type,e._category=this._category,e._roomEngine=this._roomEngine,e._stuffData=this._stuffData,e._extra=this._extra,e._isWallItem=this._isWallItem,e._iconUrl=this._iconUrl,e._name=this._name,e._description=this._description,e._locked=this._locked,e._selected=this._selected,e._hasUnseenItems=this._hasUnseenItems,e._items=this._items,e}prepareGroup(){this.setIcon(),this.setName(),this.setDescription()}dispose(){}getItemByIndex(e){return this._items[e]}getItemById(e){for(const t of this._items)if(t.id===e)return t;return null}getTradeItems(e){const t=[],i=this.getLastItem();if(!i)return t;let r=0,n=0;for(;n<this._items.length&&!(r>=e);){const o=this.getItemByIndex(n);!o.locked&&o.isTradable&&o.type===i.type&&(t.push(o),r++),n++}return t}push(e){const t=[...this._items];let i=0;for(;i<t.length;){let r=t[i];if(r.id===e.id){r=r.clone(),r.locked=!1,t.splice(i,1),t.push(r),this._items=t;return}i++}t.push(e),this._items=t,this._items.length===1&&this.prepareGroup()}pop(){const e=[...this._items];let t=null;if(e.length>0){const i=e.length-1;t=e[i],e.splice(i,1)}return this._items=e,t}remove(e){const t=[...this._items];let i=0;for(;i<t.length;){let r=t[i];if(r.id===e)return t.splice(i,1),this._items=t,r;i++}return null}getTotalCount(){if(this._category===Je.POST_IT){let e=0,t=0;for(;t<this._items.length;){const i=this.getItemByIndex(t);e=e+parseInt(i.stuffData.getLegacyString()),t++}return e}return this._items.length}getUnlockedCount(){if(this.category===Je.POST_IT)return this.getTotalCount();let e=0,t=0;for(;t<this._items.length;)this.getItemByIndex(t).locked||e++,t++;return e}getLastItem(){return this._items.length?this.getItemByIndex(this._items.length-1):null}unlockAllItems(){const e=[...this._items];let t=0;for(;t<e.length;){const i=e[t];if(i.locked){const r=i.clone();r.locked=!1,e[t]=r}t++}this._items=e}lockItemIds(e){const t=[...this._items];let i=0,r=!1;for(;i<t.length;){const n=t[i],o=e.indexOf(n.ref)>=0;if(n.locked!==o){r=!0;const l=n.clone();l.locked=o,t[i]=l}i++}return this._items=t,r}setName(){const e=this.getLastItem();if(!e){this._name="";return}let t="";switch(this._category){case Je.POSTER:t="poster_"+e.stuffData.getLegacyString()+"_name";break;case Je.TRAX_SONG:this._name="SONG_NAME";return;default:this.isWallItem?t="wallItem.name."+e.type:t="roomItem.name."+e.type}this._name=g(t)}setDescription(){this._description=""}setIcon(){if(this._iconUrl)return;let e=null;this.isWallItem?e=this._roomEngine.getFurnitureWallIconUrl(this._type,this._stuffData.getLegacyString()):e=this._roomEngine.getFurnitureFloorIconUrl(this._type),e&&(this._iconUrl=e)}get type(){return this._type}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get iconUrl(){return this._iconUrl}get name(){return this._name}get description(){return this._description}get hasUnseenItems(){return this._hasUnseenItems}set hasUnseenItems(e){this._hasUnseenItems=e}get locked(){return this._locked}set locked(e){this._locked=e}get selected(){return this._selected}set selected(e){this._selected=e}get isWallItem(){const e=this.getItemByIndex(0);return e?e.isWallItem:!1}get isGroupable(){const e=this.getItemByIndex(0);return e?e.isGroupable:!1}get isSellable(){const e=this.getItemByIndex(0);return e?e.sellable:!1}get isDeletable(){const e=this.getItemByIndex(0);return e?e.deletable:!1}get items(){return this._items}set items(e){this._items=e}}const RN=(a,e,t,i=NaN)=>new SN(a,e,ce(),t,i),BQ=(a,e,t)=>{const i=[];for(const n of a)n.type===e.type&&i.push(n);for(const n of i)if(n.getItemById(e.id))return n;const r=RN(e.type,e.category,e.stuffData,e.extra);return r.push(e),t?(r.hasUnseenItems=!0,a.unshift(r)):a.push(r),r},VQ=(a,e,t)=>{let i=null;for(const r of a)if(r.type===e.type&&r.isWallItem===e.isWallItem&&r.isGroupable)if(e.category===Je.POSTER){if(r.stuffData.getLegacyString()===e.stuffData.getLegacyString()){i=r;break}}else if(e.category===Je.GUILD_FURNI){if(e.stuffData.compare(r.stuffData)){i=r;break}}else{i=r;break}if(i){if(i.push(e),t){i.hasUnseenItems=!0;const r=a.indexOf(i);r>=0&&a.splice(r,1),a.unshift(i)}return i}return i=RN(e.type,e.category,e.stuffData,e.extra),i.push(e),t?(i.hasUnseenItems=!0,a.unshift(i)):a.push(i),i},Rb=(a,e,t)=>{e.isGroupable?VQ(a,e,t):BQ(a,e,t)},HQ=(a,e,t,i)=>{if(e===1)return a;i[t]=a;for(const n of i)if(!n)return null;const r=new Map;for(const n of i){for(const[o,l]of n)r.set(o,l);n.clear()}return i=null,r},WQ=a=>{const e=[];for(const t of a){let i=t.getTotalCount();t.category===Je.POST_IT&&(i=1);let r=0;for(;r<i;)e.push(t.getItemByIndex(r).id),r++}return e};let lk=!1,ck=-1,uk=-1,hk=!1,dk=0,_k=!1,gk=0,mk=!1,fk=!1,pk=!1,Ek=0,Ik="real",Tk=0,Sk=!1;const xb=()=>pk,YQ=a=>pk=a,Ob=()=>Ek,zQ=a=>Ek=a,Cb=()=>mk,KQ=a=>mk=a,Rk=()=>fk,qQ=a=>fk=a,tn=()=>uk,Mx=a=>uk=a,gc=()=>hk,Nb=()=>_k,jx=a=>hk=a,Lx=a=>_k=a,fp=()=>dk,Px=a=>dk=a,Ab=()=>gk,Ux=a=>gk=a,bb=()=>Sk,XQ=a=>Sk=a,xk=()=>lk,Nc=a=>lk=a,Ac=()=>ck,bc=a=>ck=a,wx=()=>Ik,Ok=a=>Ik=a,Fx=()=>Tk,$Q=a=>Tk=a,Xg=()=>{Ac()!==-1&&(ce().cancelRoomObjectPlacement(),bc(-1),Nc(!1))},kx=(a,e=!1)=>{const t=a.petData;if(!t)return!1;const i=jl().getSession(1);return!i||i.playTestMode||!i.isRoomOwner&&!i.allowPets?!1:(Ce("inventory/hide"),ce().processRoomObjectPlacement(zn.INVENTORY,-t.id,Q.UNIT,Xt.PET,t.figureData.figuredata)&&(bc(t.id),Nc(!0)),!0)},wd=(a,e=!1)=>{var n;if(!a||!a.getUnlockedCount())return!1;const t=a.getLastItem();if(!t)return!1;const i=ce();if(!i)return!1;const r=(n=ce())==null?void 0:n.roomSessionManager.getSession(i.activeRoomId);if(r&&r.playTestMode)return!1;if(t.category===Je.FLOOR||t.category===Je.WALL_PAPER||t.category===Je.LANDSCAPE)return e||K(new Sd(t.id)),!1;{Ce("inventory/hide");let o=0,l=!1;t.isWallItem?o=Q.WALL:o=Q.FLOOR,t.category===Je.POSTER?l=i.processRoomObjectPlacement(zn.INVENTORY,t.id,o,t.type,t.stuffData.getLegacyString()):l=i.processRoomObjectPlacement(zn.INVENTORY,t.id,o,t.type,t.extra.toString(),t.stuffData),l&&(bc(t.ref),Nc(!0))}return!0},QQ=(a,e=!1)=>{var r;if(!a)return!1;const t=ce();if(!t)return!1;const i=(r=ce())==null?void 0:r.roomSessionManager.getSession(t.activeRoomId);if(i&&i.playTestMode)return!1;if(a.category===Je.FLOOR||a.category===Je.WALL_PAPER||a.category===Je.LANDSCAPE)return e||K(new Sd(a.id)),!1;{Ce("inventory/hide");let n=0,o=!1;a.isWallItem?n=Q.WALL:n=Q.FLOOR,a.category===Je.POSTER?o=ce().processRoomObjectPlacement(zn.INVENTORY,a.id,n,a.type,a.stuffData.getLegacyString()):o=ce().processRoomObjectPlacement(zn.INVENTORY,a.id,n,a.type,a.extra.toString(),a.stuffData),o&&(bc(a.ref),Nc(!0))}return!0},Gx=(a,e=!1)=>{const t=a.botData;if(!t||!ce())return!1;const r=jl().getSession(1);return!r||r.playTestMode||!r.isRoomOwner&&!r.moderationSettings.allowAddBot?!1:(Ce("inventory/hide"),ce().processRoomObjectPlacement(zn.INVENTORY,-t.id,Q.UNIT,Xt.RENTABLE_BOT,t.figure)&&(bc(t.id),Nc(!0)),!0)},ql=class ql{};ql.FURNI=1,ql.RENTABLE=2,ql.PET=3,ql.BADGE=4,ql.BOT=5,ql.GAMES=6;let Ps=ql;const JQ=a=>a.map(e=>e.petData.id),Ck=(a,e,t=!0)=>{const i={petData:a};return t?e.unshift(i):e.push(i),i},Nk=(a,e)=>{let t=0;for(;t<e.length;){const i=e[t];if(i&&i.petData.id===a)return Ac()===i.petData.id&&(Xg(),Ce("inventory/open")),e.splice(t,1),i;t++}return null},ZQ=(a,e,t)=>{const i=JQ(a),r=[],n=[];for(const o of e.keys())i.indexOf(o)===-1&&r.push(o);for(const o of i)!e.get(o)&&n.push(o);i.length;for(const o of n)Nk(o,a);for(const o of r){const l=e.get(o);l&&Ck(l,a,t(Ps.PET,l.id))}return a},eJ=(a,e,t,i)=>{if(e===1)return a;i[t]=a;for(const n of i)if(!n)return null;const r=new Map;for(const n of i){for(const[o,l]of n)r.set(o,l);n.clear()}return i=null,r},dl=class dl{};dl.TRADING_STATE_READY=0,dl.TRADING_STATE_RUNNING=1,dl.TRADING_STATE_COUNTDOWN=2,dl.TRADING_STATE_CONFIRMING=3,dl.TRADING_STATE_CONFIRMED=4,dl.TRADING_STATE_COMPLETED=5,dl.TRADING_STATE_CANCELLED=6;let Ti=dl;class vb{constructor(e=-1,t="",i=new Ms,r=0,n=0,o=!1,l=!1){this.userId=e,this.userName=t,this.userItems=i,this.itemCount=r,this.creditsCount=n,this.accepts=o,this.canTrade=l}}const Aa=class Aa{};Aa.ALERT_SCAM=0,Aa.HOTEL_TRADING_DISABLED=1,Aa.YOU_NOT_ALLOWED=2,Aa.THEY_NOT_ALLOWED=4,Aa.ROOM_DISABLED=6,Aa.YOU_OPEN=7,Aa.THEY_OPEN=8,Aa.ERROR_WHILE_COMMIT=9,Aa.THEY_CANCELLED=10;let zr=Aa;const yb=a=>{var e;return((e=te().getWallItemData(a))==null?void 0:e.isExternalImage)||!1},Db=a=>{const e=new Ms;if(a.length)for(const i of a){const r=i.spriteId,n=i.category;let o=i.furniType+r;(!i.isGroupable||yb(r))&&(o="itemid"+i.itemId),i.category===Je.POSTER?o=i.itemId+"poster"+i.stuffData.getLegacyString():i.category===Je.GUILD_FURNI&&(o="");let l=i.isGroupable&&!yb(i.spriteId)?e.getValue(o):null;l||(l=RN(r,n,i.stuffData),e.add(o,l)),l.push(new qg(i))}return e},tJ=(a,e)=>{let t=a.toString();if(!(e instanceof qa))return t;let i=1;for(;i<5;)t=t+(","+e.getValue(i)),i++;return t};class rf{static getProductImageUrl(e,t,i){let r=null;switch(e){case Fa.S:r=ce().getFurnitureFloorIconUrl(t);break;case Fa.I:this.getProductCategory(Fa.I,t)===1&&(r=ce().getFurnitureWallIconUrl(t,i));break}return r}static getProductCategory(e,t){if(e===Fa.S)return 1;if(e===Fa.I){if(t===3001)return Je.WALL_PAPER;if(t===3002)return Je.FLOOR;if(t===4057)return Je.LANDSCAPE}return 1}}let mc=class{static getRandomNumber(e){return Math.floor(Math.random()*e)}static getRandomElement(e){return e[this.getRandomNumber(e.length)]}static getRandomElements(e,t){const i=new Array(t);let r=e.length;const n=new Array(r);for(;t--;){var o=this.getRandomNumber(r);i[t]=e[o in n?n[o]:o],n[o]=--r in n?n[r]:r}return i}};const sJ=a=>a.replace(/:\w+:/g,e=>{const t=e.slice(1,-1),i=ky.emojis[t];return i?i.skins[0].native:e}),Oi=new Map;Oi.set("r","red");Oi.set("b","blue");Oi.set("g","green");Oi.set("y","yellow");Oi.set("w","white");Oi.set("o","orange");Oi.set("c","cyan");Oi.set("br","brown");Oi.set("pr","purple");Oi.set("pk","pink");Oi.set("red","red");Oi.set("blue","blue");Oi.set("green","green");Oi.set("yellow","yellow");Oi.set("white","white");Oi.set("orange","orange");Oi.set("cyan","cyan");Oi.set("brown","brown");Oi.set("purple","purple");Oi.set("pink","pink");const iJ=a=>a.replace(/([\u00A0-\u9999<>&])(.|$)/g,(e,t,i)=>t!=="&"||i!=="#"?(/[\u00A0-\u9999<>&]/.test(i)&&(i="&#"+i.charCodeAt(0)+";"),"&#"+t.charCodeAt(0)+";"+i):e),Va=(a,e="audio")=>{const t=a,i=t.includes(e=="audio"?"https://cdn.hubbe.biz/audios/":"https://media.tenor.com/"),r=t.includes("window")||t.includes("onerror")||t.includes('"')||t.includes(";")||t.includes("'");return i&&!r},Ak=a=>{let e="";if(a=iJ(a),a=sJ(a),Va(a)||Va(a,"gif"))return a.replace(/@[a-zA-Z]+@/g,"");if(a.startsWith("@")&&a.indexOf("@",1)>-1){let i=null;if((i=/@[a-zA-Z]+@/g.exec(a))!==null){const r=i[0].toString(),n=r.substr(1,r.length-2),o=a.replace(r,"");Oi.has(n)?e='<span style="color: '+Oi.get(n)+'">'+o+"</span>":e=o}}else e=a;return e},bk=(a,e)=>window.localStorage.setItem(a,JSON.stringify(e)),Xl=class Xl{};Xl.CAMERA_SHUTTER="camera_shutter",Xl.CREDITS="credits",Xl.DUCKETS="duckets",Xl.MESSENGER_NEW_THREAD="messenger_new_thread",Xl.MESSENGER_MESSAGE_RECEIVED="messenger_message_received",Xl.MODTOOLS_NEW_TICKET="modtools_new_ticket";let Bo=Xl;const cI=class cI{};cI.COLORMATRIX="colormatrix",cI.COMPOSITE="composite";let $g=cI;class rJ{constructor(e,t){this.texture=e,this.imageUrl=t}}class nJ{constructor(e,t){this.effectName=e,this.thumbnailUrl=t}}class Mb{constructor(e,t,i){this._productName=e,this._customImage=t,this._furnitureClassName=i}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}const sd=class sd{};sd.STATE_UNLOCKED=1,sd.STATE_LOCKED_AVAILABLE=2,sd.STATE_LOCKED_EXPIRED=3,sd.STATE_LOCKED_FUTURE=4;let Ei=sd;const X_=class X_{};X_.TYPE_CHAT=1,X_.TYPE_ROOM_INFO=2,X_.TYPE_IM=3;let Ar=X_;const pp=()=>{const a=new Date;return`${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`},jb=(a=0)=>{const e=a?new Date(Date.now()-a*1e3):new Date;return`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`},vk=a=>{if(!a||!a.length)return null;const e=a.split("/"),t=e[0],i=e[1],r=parseInt(e[2]);return{username:t,figure:i,userId:r}},fu=class fu{constructor(){this.id=-1,this.name=null,this.gender=0,this.online=!1,this.followingAllowed=!1,this.figure=null,this.categoryId=0,this.motto=null,this.realName=null,this.lastAccess=null,this.persistedMessageUser=!1,this.vipMember=!1,this.pocketHabboUser=!1,this.relationshipStatus=-1,this.unread=0,this.hasSendOfflineMessage=!1}populate(e){this.id=e.id,this.name=e.name,this.gender=e.gender,this.online=e.online,this.followingAllowed=e.followingAllowed,this.figure=e.figure,this.categoryId=e.categoryId,this.motto=e.motto,this.realName=e.realName,this.lastAccess=e.lastAccess,this.persistedMessageUser=e.persistedMessageUser,this.vipMember=e.vipMember,this.pocketHabboUser=e.pocketHabboUser,this.relationshipStatus=e.relationshipStatus,this.hasSendOfflineMessage=!1}};fu.RELATIONSHIP_NONE=0,fu.RELATIONSHIP_HEART=1,fu.RELATIONSHIP_SMILE=2,fu.RELATIONSHIP_BOBBA=3,fu.RELATIONSHIP_POOP=4;let $i=fu;const uI=class uI{};uI.GROUP_CHAT=0,uI.PRIVATE_CHAT=1;let Hu=uI;const $_=class $_{};$_.HIDDEN=0,$_.SHOW=1,$_.UNREAD=2;let jo=$_;class Lb{populate(e){return e?(this._id=e.requestId,this._name=e.requesterName,this._figureString=e.figureString,this._requesterUserId=e.requesterUserId,!0):!1}get id(){return this._id}get name(){return this._name}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class aJ{constructor(e=0,t=0,i=0,r=[]){this.userFriendLimit=e,this.normalFriendLimit=t,this.extendedFriendLimit=i,this.categories=r}}const id=class id{constructor(e,t,i=0,r=null,n=0){this._type=n,this._senderId=e,this._message=t,this._secondsSinceSent=i,this._extraData=r,this._date=new Date}get type(){return this._type}get senderId(){return this._senderId}get message(){return this._message}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}get date(){return this._date}};id.CHAT=0,id.ROOM_INVITE=1,id.STATUS_NOTIFICATION=2,id.SECURITY_NOTIFICATION=3;let ua=id;class oJ{constructor(e,t=Hu.PRIVATE_CHAT){this._userId=e,this._chats=[],this._type=t}addChat(e){this._chats.push(e)}get userId(){return this._userId}get chats(){return this._chats}get type(){return this._type}set type(e){this._type=e}}const Q_=class Q_{constructor(e){this._threadId=++Q_.THREAD_ID,this._participant=e,this._groups=[],this._lastUpdated=new Date,this._unreadCount=0}addMessage(e,t,i=0,r=null,n=0){const o=e<0&&r,l=o?vk(r).userId:e,c=this.getLastGroup(l);if(!c)return;o&&(c.type=Hu.GROUP_CHAT);const u=new ua(e,t,i,r,n);return c.addChat(u),this._lastUpdated=new Date,this._unreadCount++,u}getLastGroup(e){let t=this._groups[this._groups.length-1];return t&&t.userId===e||(t=new oJ(e),this._groups.push(t)),t}setRead(){this._unreadCount=0}get threadId(){return this._threadId}get participant(){return this._participant}get groups(){return this._groups}get lastUpdated(){return this._lastUpdated}get unreadCount(){return this._unreadCount}get unread(){return this._unreadCount>0}get lastMessage(){const e=this._groups[this._groups.length-1];if(!e)return"";const t=e.chats.filter(i=>i.type===ua.CHAT).pop();return t?t.message:""}};Q_.MESSAGE_RECEIVED="MT_MESSAGE_RECEIVED",Q_.THREAD_ID=0;let Bx=Q_;function TT(a=0){Ce(a===0?"friends-messenger/toggle":`friends-messenger/${a}`)}const lJ=()=>Bd.RENDERER_VERSION,yk=()=>"2.2.0";function Qd(a){K(new Pd(a,!0))}function ST(a){Ce(`groups/manage/${a}`)}function Pb(a,e){Ce(e?`group-members/${a}/${e}`:`group-members/${a}`)}var Cl;let _n=(Cl=class{constructor(e,t,i,r){this.type=e,this.key=t||0,this.color=i||0,this.position=r||4}get code(){return this.key===0&&this.type!==Cl.BASE?null:Cl.getCode(this.type,this.key,this.color,this.position)}static getCode(e,t,i,r){return e+(t<10?"0":"")+t+(i<10?"0":"")+i+r}},Cl.BASE="b",Cl.SYMBOL="s",Cl);const J_=class J_{};J_.NOT_MEMBER=0,J_.MEMBER=1,J_.REQUEST_PENDING=2;let ci=J_;const Z_=class Z_{};Z_.REGULAR=0,Z_.EXCLUSIVE=1,Z_.PRIVATE=2;let Or=Z_;const cJ=a=>{K(a.favourite?new aU(a.groupId):new QP(a.groupId))},xN=a=>K(new JP(a)),fi=class fi{};fi.NONE="NONE",fi.ERROR="ERROR",fi.REJECTED="REJECTED",fi.USER_CREATE="USER_CREATE",fi.USER_PENDING="USER_PENDING",fi.USER_ONGOING="USER_ONGOING",fi.USER_FEEDBACK="USER_FEEDBACK",fi.USER_NO_HELPERS="USER_NO_HELPERS",fi.USER_SOMETHING_WRONG="USER_SOMETHING_WRONG",fi.USER_THANKS="USER_THANKS",fi.USER_GUIDE_DISCONNECTED="USER_GUIDE_DISCONNECTED",fi.GUIDE_TOOL_MENU="GUIDE_TOOL_MENU",fi.GUIDE_ACCEPT="GUIDE_ACCEPT",fi.GUIDE_ONGOING="GUIDE_ONGOING",fi.GUIDE_CLOSED="GUIDE_CLOSED",fi.GUARDIAN_CHAT_REVIEW_ACCEPT="GUARDIAN_CHAT_REVIEW_ACCEPT",fi.GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS",fi.GUARDIAN_CHAT_REVIEW_VOTE="GUARDIAN_CHAT_REVIEW_VOTE",fi.GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS",fi.GUARDIAN_CHAT_REVIEW_RESULTS="GUARDIAN_CHAT_REVIEW_RESULTS";let ts=fi;class Ub{constructor(e,t){this._message=e,this._roomId=t}get message(){return this._message}get roomId(){return this._roomId}}class wb{constructor(e){this._userId=e,this._messages=[]}addChat(e){this._messages.push(e)}get userId(){return this._userId}get messages(){return this._messages}}const eg=class eg{};eg.ACTIVE="active",eg.NONE="none",eg.EXPIRED="expired";let vo=eg;const uJ="HC1",hJ=["ACH_VipHC1","ACH_VipHC2","ACH_VipHC3","ACH_VipHC4","ACH_VipHC5","HC1","HC2","HC3","HC4","HC5"],dJ=a=>{let e=null;return hJ.forEach(t=>a.indexOf(t)>-1&&(e=t)),e||uJ},hI=class hI{};hI.TOO_MANY_PENDING_CALLS_CODE=1,hI.HAS_ABUSIVE_CALL_CODE=2;let Ep=hI;const _J=a=>a===1?"useless":a===2?"abusive":"resolved",pu=class pu{};pu.SELECT_USER=0,pu.SELECT_CHATS=1,pu.SELECT_TOPICS=2,pu.INPUT_REPORT_MESSAGE=3,pu.REPORT_SUMMARY=4;let fr=pu;const _o=class _o{};_o.EMERGENCY=1,_o.GUIDE=2,_o.IM=3,_o.ROOM=4,_o.BULLY=6,_o.THREAD=7,_o.MESSAGE=8,_o.PHOTO=9;let xs=_o;const gJ=a=>{switch(a){case 1:case 2:return"Normal";case 3:return"Automatic";case 4:return"Automatic IM";case 5:return"Guide System";case 6:return"IM";case 7:return"Room";case 8:return"Panic";case 9:return"Guardian";case 10:return"Automatic Helper";case 11:return"Discussion";case 12:return"Selfie";case 14:return"Photo";case 15:return"Ambassador"}return"Unknown"},$l=class $l{constructor(e,t,i,r,n){this._actionId=e,this._name=t,this._actionType=i,this._sanctionTypeId=r,this._actionLengthHours=n}get actionId(){return this._actionId}get name(){return this._name}get actionType(){return this._actionType}get sanctionTypeId(){return this._sanctionTypeId}get actionLengthHours(){return this._actionLengthHours}};$l.ALERT=1,$l.MUTE=2,$l.BAN=3,$l.KICK=4,$l.TRADE_LOCK=5,$l.MESSAGE=6;let us=$l;const ra=class ra{};ra.NONE=0,ra.START_DOORBELL=1,ra.START_PASSWORD=2,ra.STATE_PENDING_SERVER=3,ra.UPDATE_STATE=4,ra.STATE_WAITING=5,ra.STATE_NO_ANSWER=6,ra.STATE_WRONG_PASSWORD=7,ra.STATE_ACCEPTED=8,ra.START_INVISIBLE=9;let Wt=ra;const tg=class tg{};tg.LIST=0,tg.THUMBNAILS=1,tg.FORCED_THUMBNAILS=2;let Fl=tg;const mJ=()=>{const a=[];for(let e=10;e<=100;e=e+10)a.push(e);for(let e=150;e<=500;e=e+50)a.push(e);return a},Fb=mJ(),dh=[{name:"anything",query:null},{name:"room.name",query:"roomname"},{name:"owner",query:"owner"},{name:"tag",query:"tag"},{name:"group",query:"group"}];function qn(a){K(new Vg(a,!1,!0))}const ba=class ba{};ba.DEFAULT="default",ba.MOTD="motd",ba.MODERATION="moderation",ba.EVENT="event",ba.NITRO="nitro",ba.SEARCH="search",ba.ALERT="alert",ba.MARKET_PLACE="marketplace",ba.DELETABLE_DEFAULT="deletable";let lt=ba;const sg=class sg{constructor(e,t=lt.DEFAULT,i=null,r=null,n=null,o=null){sg.ITEM_ID+=1,this._id=sg.ITEM_ID,this._messages=e,this._alertType=t,this._clickUrl=i,this._clickUrlText=r,this._title=n,this._imageUrl=o}get id(){return this._id}get messages(){return this._messages}set alertType(e){this._alertType=e}get alertType(){return this._alertType}get clickUrl(){return this._clickUrl}get clickUrlText(){return this._clickUrlText}get title(){return this._title}get imageUrl(){return this._imageUrl}};sg.ITEM_ID=-1;let Ip=sg;const Fi=class Fi{};Fi.FRIENDOFFLINE="friendoffline",Fi.FRIENDONLINE="friendonline",Fi.THIRDPARTYFRIENDOFFLINE="thirdpartyfriendoffline",Fi.THIRDPARTYFRIENDONLINE="thirdpartyfriendonline",Fi.ACHIEVEMENT="achievement",Fi.BADGE_RECEIVED="badge_received",Fi.INFO="info",Fi.RECYCLEROK="recyclerok",Fi.RESPECT="respect",Fi.KISS="kiss",Fi.CLUB="club",Fi.SOUNDMACHINE="soundmachine",Fi.PETLEVEL="petlevel",Fi.CLUBGIFT="clubgift",Fi.BUYFURNI="buyfurni",Fi.VIP="vip",Fi.ROOMMESSAGESPOSTED="roommessagesposted";let bi=Fi;const ig=class ig{constructor(e,t=bi.INFO,i=null,r=null){ig.ITEM_ID+=1,this._id=ig.ITEM_ID,this._message=e,this._notificationType=t,this._iconUrl=i,this._linkUrl=r}get id(){return this._id}get message(){return this._message}get notificationType(){return this._notificationType}get iconUrl(){return this._iconUrl}get linkUrl(){return this._linkUrl}};ig.ITEM_ID=-1;let Vx=ig;const rg=class rg{constructor(e,t,i,r,n,o,l){rg.ITEM_ID+=1,this._id=rg.ITEM_ID,this._confirmType=e,this._message=t,this._onConfirm=i,this._onCancel=r,this._confirmText=n,this._cancelText=o,this._title=l}get id(){return this._id}get confirmType(){return this._confirmType}get message(){return this._message}get onConfirm(){return this._onConfirm}get onCancel(){return this._onCancel}get confirmText(){return this._confirmText}get cancelText(){return this._cancelText}get title(){return this._title}};rg.ITEM_ID=-1;let Hx=rg;const dI=class dI{};dI.MARRIED_COMMAND="married",dI.SEX_COMMAND="sex";let Tp=dI;const ng=class ng{constructor(e,t,i,r,n,o,l,c){ng.ITEM_ID+=1,this._id=ng.ITEM_ID,this._marketplaceType=e,this._message=t,this._onConfirm=i,this._onCancel=r,this._confirmText=n,this._cancelText=o,this._title=l,this._offer=c}get id(){return this._id}get marketplaceType(){return this._marketplaceType}get message(){return this._message}get onConfirm(){return this._onConfirm}get onCancel(){return this._onCancel}get confirmText(){return this._confirmText}get cancelText(){return this._cancelText}get title(){return this._title}get offer(){return this._offer}};ng.ITEM_ID=-1;let Wx=ng;const ag=class ag{constructor(e,t,i,r,n,o,l,c,u){ag.ITEM_ID+=1,this._id=ag.ITEM_ID,this._groupItem=e,this._amount=t,this._maxAmount=i,this._message=r,this._onConfirm=n,this._onCancel=o,this._confirmText=l,this._cancelText=c,this._title=u}get id(){return this._id}get message(){return this._message}get onConfirm(){return this._onConfirm}get onCancel(){return this._onCancel}get confirmText(){return this._confirmText}get cancelText(){return this._cancelText}get title(){return this._title}get groupItem(){return this._groupItem}get amount(){return this._amount}get maxAmount(){return this._maxAmount}};ag.ITEM_ID=-1;let Yx=ag;class ON{constructor(){this._credits=0,this._activityPoints=new Map,this._clubDays=0,this._clubPeriods=0,this._isVIP=!1,this._pastClubDays=0,this._pastVipDays=0,this._isExpiring=!1,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,this._lastUpdated=0}static from(e){const t=new ON;return t._credits=e._credits,t._activityPoints=e._activityPoints,t._clubDays=e._clubDays,t._clubPeriods=e._clubPeriods,t._isVIP=e._isVIP,t._pastClubDays=e._pastClubDays,t._pastVipDays=e._pastVipDays,t._isExpiring=e._isExpiring,t._minutesUntilExpiration=e._minutesUntilExpiration,t._minutesSinceLastModified=e._minutesSinceLastModified,t._lastUpdated=e._lastUpdated,t}get credits(){return this._credits}set credits(e){this._lastUpdated=nt(),this._credits=e}get activityPoints(){return this._activityPoints}set activityPoints(e){this._lastUpdated=nt(),this._activityPoints=e}get clubDays(){return this._clubDays}set clubDays(e){this._lastUpdated=nt(),this._clubDays=e}get clubPeriods(){return this._clubPeriods}set clubPeriods(e){this._lastUpdated=nt(),this._clubPeriods=e}get hasClubLeft(){return this._clubDays>0||this._clubPeriods>0}get isVip(){return this._isVIP}set isVip(e){this._isVIP=e}get pastClubDays(){return this._pastClubDays}set pastClubDays(e){this._lastUpdated=nt(),this._pastClubDays=e}get pastVipDays(){return this._pastVipDays}set pastVipDays(e){this._lastUpdated=nt(),this._pastVipDays=e}get isExpiring(){return this._isExpiring}set isExpiring(e){this._isExpiring=e}get minutesUntilExpiration(){var e=(nt()-this._lastUpdated)/6e4,t=this._minutesUntilExpiration-e;return t>0?t:0}set minutesUntilExpiration(e){this._lastUpdated=nt(),this._minutesUntilExpiration=e}get minutesSinceLastModified(){return this._minutesSinceLastModified}set minutesSinceLastModified(e){this._lastUpdated=nt(),this._minutesSinceLastModified=e}get lastUpdated(){return this._lastUpdated}get clubLevel(){return this.clubDays===0&&this.clubPeriods===0?rr.NO_CLUB:this.isVip?rr.VIP:rr.CLUB}}class Im extends _t{}const og=class og extends Im{constructor(e,t){super(e),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._pollType="",this._npsPoll=!1,this._id=t}get id(){return this._id}get summary(){return this._summary}set summary(e){this._summary=e}get headline(){return this._headline}set headline(e){this._headline=e}get numQuestions(){return this._numQuestions}set numQuestions(e){this._numQuestions=e}get startMessage(){return this._startMessage}set startMessage(e){this._startMessage=e}get endMessage(){return this._endMessage}set endMessage(e){this._endMessage=e}get questionArray(){return this._questionArray}set questionArray(e){this._questionArray=e}get pollType(){return this._pollType}set pollType(e){this._pollType=e}get npsPoll(){return this._npsPoll}set npsPoll(e){this._npsPoll=e}};og.OFFER="RWPUW_OFFER",og.ERROR="RWPUW_ERROR",og.CONTENT="RWPUW_CONTENT";let kl=og;const _I=class _I extends Im{constructor(e,t=0,i=0,r=0){super(e),this._hue=t,this._saturation=i,this._lightness=r}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}};_I.PREVIEW="RWUBCPE_PREVIEW",_I.CLEAR_PREVIEW="RWUBCPE_CLEAR_PREVIEW";let fc=_I;const Eu=class Eu extends Im{constructor(e,t){super(Eu.CHAT_INPUT_CONTENT),this._chatMode="",this._userName="",this._chatMode=e,this._userName=t}get chatMode(){return this._chatMode}get userName(){return this._userName}};Eu.CHAT_INPUT_CONTENT="RWUCICE_CHAT_INPUT_CONTENT",Eu.WHISPER="whisper",Eu.WHISPER_GROUP="whisper.group",Eu.SHOUT="shout";let Lo=Eu;const gI=class gI extends Im{constructor(e,t,i,r,n,o,l){super(gI.UPDATE_CHAT),this._objectId=e,this._category=t,this._botId=i,this._chat=r,this._automaticChat=n,this._chatDelay=o,this._mixSentences=l}get objectId(){return this._objectId}get category(){return this._category}get botId(){return this._botId}get chat(){return this._chat}get automaticChat(){return this._automaticChat}get chatDelay(){return this._chatDelay}get mixSentences(){return this._mixSentences}};gI.UPDATE_CHAT="RWURBCE_UPDATE_CHAT";let Sp=gI;const na=class na extends Im{constructor(e,t,i,r,n=!0){super(e),this._id=t,this._category=i,this._roomId=r,this._sendClickPacket=n||!1}get sendClickPacket(){return this._sendClickPacket}get id(){return this._id}get category(){return this._category}get roomId(){return this._roomId}};na.OBJECT_SELECTED="RWUROE_OBJECT_SELECTED",na.OBJECT_DESELECTED="RWUROE_OBJECT_DESELECTED",na.USER_REMOVED="RWUROE_USER_REMOVED",na.FURNI_REMOVED="RWUROE_FURNI_REMOVED",na.FURNI_ADDED="RWUROE_FURNI_ADDED",na.USER_ADDED="RWUROE_USER_ADDED",na.OBJECT_ROLL_OVER="RWUROE_OBJECT_ROLL_OVER",na.OBJECT_ROLL_OUT="RWUROE_OBJECT_ROLL_OUT",na.OBJECT_REQUEST_MANIPULATION="RWUROE_OBJECT_REQUEST_MANIPULATION",na.OBJECT_DOUBLE_CLICKED="RWUROE_OBJECT_DOUBLE_CLICKED";let hs=na;const SA=class SA{constructor(e){this.type=e,this.id=0,this.category=0,this.name="",this.description="",this.image=null,this.isWallItem=!1,this.isStickie=!1,this.isRoomOwner=!1,this.roomControllerLevel=0,this.isAnyRoomController=!1,this.expiration=-1,this.purchaseCatalogPageId=-1,this.purchaseOfferId=-1,this.extraParam="",this.isOwner=!1,this.stuffData=null,this.groupId=0,this.ownerId=0,this.ownerName="",this.usagePolicy=0,this.rentCatalogPageId=-1,this.rentOfferId=-1,this.purchaseCouldBeUsedForBuyout=!1,this.rentCouldBeUsedForBuyout=!1,this.availableForBuildersClub=!1,this.tileSizeX=1,this.tileSizeY=1,this.canEditAds=!1,this.classId=-1}};SA.FURNI="IFI_FURNI";let Vn=SA;class Dk{constructor(e,t,i,r,n,o,l,c=!1){this.roomIndex=e,this.category=t,this.id=i,this.name=r,this.nick=n,this.coloredName=o,this.userType=l,this.isFriend=c}}const RA=class RA{constructor(e){this.type=e,this.level=0,this.maximumLevel=0,this.experience=0,this.levelExperienceGoal=0,this.energy=0,this.maximumEnergy=0,this.happyness=0,this.maximumHappyness=0,this.respectsPetLeft=0,this.respect=0,this.age=0,this.name="",this.id=-1,this.image=null,this.petType=0,this.petBreed=0,this.petFigure="",this.posture="std",this.isOwner=!1,this.ownerId=-1,this.ownerName="",this.canRemovePet=!1,this.roomIndex=0,this.unknownRarityLevel=0,this.saddle=!1,this.rider=!1,this.breedable=!1,this.skillTresholds=[],this.publiclyRideable=0,this.fullyGrown=!1,this.dead=!1,this.rarityLevel=0,this.maximumTimeToLive=0,this.remainingTimeToLive=0,this.remainingGrowTime=0,this.publiclyBreedable=!1}};RA.PET_INFO="IPI_PET_INFO";let Xu=RA;const xA=class xA{constructor(e){this.type=e,this.name="",this.motto="",this.webID=0,this.figure="",this.badges=[],this.carryItem=0,this.roomIndex=0,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.ownerId=-1,this.ownerName="",this.botSkills=[]}};xA.RENTABLE_BOT="IRBI_RENTABLE_BOT";let $u=xA;const go=class go{constructor(e){this.type=e,this.name="",this.nick="",this.coloredName="",this.motto="",this.achievementScore=0,this.webID=0,this.xp=0,this.userType=-1,this.figure="",this.badges=[],this.groupId=0,this.groupName="",this.groupBadgeId="",this.carryItem=0,this.roomIndex=0,this.isSpectatorMode=!1,this.allowNameChange=!1,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.canBeKicked=!1,this.canBeBanned=!1,this.canBeMuted=!1,this.respectLeft=0,this.kissLeft=0,this.isIgnored=!1,this.isGuildRoom=!1,this.canTrade=!1,this.canTradeReason=0,this.targetRoomControllerLevel=0,this.isAmbassador=!1}get isOwnUser(){return this.type===go.OWN_USER}};go.OWN_USER="IUI_OWN_USER",go.PEER="IUI_PEER",go.BOT="IUI_BOT",go.TRADE_REASON_OK=0,go.TRADE_REASON_SHUTDOWN=2,go.TRADE_REASON_NO_TRADING=3,go.DEFAULT_BOT_BADGE_ID="BOT";let $s=go;class Co{static getObjectName(e,t){const i=$e();let r=-1,n=null,o=null,l=null,c=0;switch(t){case Q.FLOOR:case Q.WALL:{const u=ce().getRoomObject(i.roomId,e,t);if(!u)break;if(u.type.indexOf("poster")===0)n=g("${poster_"+parseInt(u.type.replace("poster",""))+"_name}");else{let d=null;const _=u.model.getValue(D.FURNITURE_TYPE_ID);if(t===Q.FLOOR?d=te().getFloorItemData(_):t===Q.WALL&&(d=te().getWallItemData(_)),!d)break;r=d.id,n=d.name}break}case Q.UNIT:{const u=i.userDataManager.getUserDataByIndex(e);if(!u)break;r=u.webID,n=u.name,o=u.nick,l=u.coloredName,c=u.type;break}}return!n||!n.length?null:new Dk(e,t,r,n,o,l,c)}static getFurniInfo(e,t){const i=$e(),r=new Vn(Vn.FURNI);r.id=e,r.category=t;const n=ce().getRoomObject(i.roomId,e,t);if(!n)return;const o=n.model;o.getValue(hi.INFOSTAND_EXTRA_PARAM)&&(r.extraParam=o.getValue(hi.INFOSTAND_EXTRA_PARAM));const l=o.getValue(D.FURNITURE_DATA_FORMAT),c=ka.getData(l);c.initializeFromRoomObjectModel(o),r.stuffData=c;const u=n.type;if(u.indexOf("poster")===0){const E=parseInt(u.replace("poster",""));r.name=g("${poster_"+E+"_name}"),r.description=g("${poster_"+E+"_desc}")}else{const E=o.getValue(D.FURNITURE_TYPE_ID);let I=null;t===Q.FLOOR?I=te().getFloorItemData(E):t===Q.WALL&&(I=te().getWallItemData(E)),I&&(r.name=I.name,r.description=I.description,r.purchaseOfferId=I.purchaseOfferId,r.purchaseCouldBeUsedForBuyout=I.purchaseCouldBeUsedForBuyout,r.rentOfferId=I.rentOfferId,r.rentCouldBeUsedForBuyout=I.rentCouldBeUsedForBuyout,r.availableForBuildersClub=I.availableForBuildersClub,r.tileSizeX=I.tileSizeX,r.tileSizeY=I.tileSizeY,r.classId=I.id)}u.indexOf("post_it")>-1&&(r.isStickie=!0);const d=o.getValue(D.FURNITURE_EXPIRY_TIME),_=o.getValue(D.FURNITURE_EXPIRTY_TIMESTAMP);r.expiration=d<0?d:Math.max(0,d-(nt()-_)/1e3);let m=ce().getRoomObjectImage(i.roomId,e,t,new Y(180),64,null);(!m.data||m.data.width>140||m.data.height>200)&&(m=ce().getRoomObjectImage(i.roomId,e,t,new Y(180),1,null)),r.image=m.getImage(),r.isWallItem=t===Q.WALL,r.isRoomOwner=i.isRoomOwner,r.roomControllerLevel=i.controllerLevel,r.canEditAds=i.canEditAds,r.isAnyRoomController=te().isModerator,r.ownerId=o.getValue(D.FURNITURE_OWNER_ID),r.ownerName=o.getValue(D.FURNITURE_OWNER_NAME),r.usagePolicy=o.getValue(D.FURNITURE_USAGE_POLICY);const f=o.getValue(D.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID);return f!==0&&(r.groupId=f),gr(n)&&(r.isOwner=!0),r}static getUserInfo(e,t){const i=$e();let r=$s.OWN_USER;t.webID!==te().userId&&(r=$s.PEER);const n=new $s(r);n.isSpectatorMode=i.isSpectator,n.name=t.name,n.nick=t.nick,n.coloredName=t.coloredName,n.motto=t.custom,n.achievementScore=t.activityPoints,n.webID=t.webID,n.roomIndex=t.roomIndex,n.userType=Xt.USER;const o=ce().getRoomObject(i.roomId,t.roomIndex,e);if(o&&(n.carryItem=o.model.getValue(D.FIGURE_CARRY_OBJECT)||0),r===$s.OWN_USER&&(n.allowNameChange=te().canChangeName),n.amIOwner=i.isRoomOwner,n.isGuildRoom=i.isGuildRoom,n.roomControllerLevel=i.controllerLevel,n.amIAnyRoomController=te().isModerator,n.isAmbassador=te().isAmbassador,r===$s.PEER){if(o){const u=o.model.getValue(D.FIGURE_FLAT_CONTROL);u!==null&&(n.targetRoomControllerLevel=u),n.canBeMuted=this.canBeMuted(n),n.canBeKicked=this.canBeKicked(n),n.canBeBanned=this.canBeBanned(n)}n.isIgnored=te().isUserIgnored(t.webID),n.respectLeft=te().respectsLeft,n.kissLeft=te().kissesLeft;const l=te().isSystemShutdown,c=i.tradeMode;if(l)n.canTrade=!1;else switch(c){case pd.ROOM_CONTROLLER_REQUIRED:{const u=n.roomControllerLevel!==pt.NONE&&n.roomControllerLevel!==pt.GUILD_MEMBER,d=n.targetRoomControllerLevel!==pt.NONE&&n.targetRoomControllerLevel!==pt.GUILD_MEMBER;n.canTrade=u||d;break}case pd.NO_TRADING:n.canTrade=!0;break;default:n.canTrade=!1;break}n.canTradeReason=$s.TRADE_REASON_OK,l&&(n.canTradeReason=$s.TRADE_REASON_SHUTDOWN),c!==pd.FREE_TRADING&&(n.canTradeReason=$s.TRADE_REASON_NO_TRADING)}return n.groupId=t.groupId,n.groupBadgeId=te().getGroupBadge(n.groupId),n.groupName=t.groupName,n.badges=i.userDataManager.getUserBadges(t.webID),n.figure=t.figure,n}static getBotInfo(e,t){const i=$e(),r=new $s($s.BOT);r.name=t.name,r.motto=t.custom,r.webID=t.webID,r.roomIndex=t.roomIndex,r.userType=t.type;const n=ce().getRoomObject(i.roomId,t.roomIndex,e);return n&&(r.carryItem=n.model.getValue(D.FIGURE_CARRY_OBJECT)||0),r.amIOwner=i.isRoomOwner,r.isGuildRoom=i.isGuildRoom,r.roomControllerLevel=i.controllerLevel,r.amIAnyRoomController=te().isModerator,r.isAmbassador=te().isAmbassador,r.badges=[$s.DEFAULT_BOT_BADGE_ID],r.figure=t.figure,r}static getRentableBotInfo(e,t){const i=$e(),r=new $u($u.RENTABLE_BOT);r.name=t.name,r.motto=t.custom,r.webID=t.webID,r.roomIndex=t.roomIndex,r.ownerId=t.ownerId,r.ownerName=t.ownerName,r.botSkills=t.botSkills;const n=ce().getRoomObject(i.roomId,t.roomIndex,e);return n&&(r.carryItem=n.model.getValue(D.FIGURE_CARRY_OBJECT)||0),r.amIOwner=i.isRoomOwner,r.roomControllerLevel=i.controllerLevel,r.amIAnyRoomController=te().isModerator,r.badges=[$s.DEFAULT_BOT_BADGE_ID],r.figure=t.figure,r}static getPetInfo(e){const t=$e(),i=t.userDataManager.getPetData(e.id);if(!i)return;const r=new Vo(i.figure);let n=null;r.typeId===ui.MONSTERPLANT&&(e.level>=e.adultLevel?n="std":n="grw"+e.level);const o=e.ownerId===te().userId,l=new Xu(Xu.PET_INFO);return l.name=i.name,l.id=e.id,l.ownerId=e.ownerId,l.ownerName=e.ownerName,l.rarityLevel=e.rarityLevel,l.petType=r.typeId,l.petBreed=r.paletteId,l.petFigure=i.figure,l.posture=n,l.isOwner=o,l.roomIndex=i.roomIndex,l.level=e.level,l.maximumLevel=e.maximumLevel,l.experience=e.experience,l.levelExperienceGoal=e.levelExperienceGoal,l.energy=e.energy,l.maximumEnergy=e.maximumEnergy,l.happyness=e.happyness,l.maximumHappyness=e.maximumHappyness,l.respect=e.respect,l.respectsPetLeft=te().respectsPetLeft,l.age=e.age,l.saddle=e.saddle,l.rider=e.rider,l.breedable=e.breedable,l.fullyGrown=e.fullyGrown,l.dead=e.dead,l.rarityLevel=e.rarityLevel,l.skillTresholds=e.skillTresholds,l.canRemovePet=!1,l.publiclyRideable=e.publiclyRideable,l.maximumTimeToLive=e.maximumTimeToLive,l.remainingTimeToLive=e.remainingTimeToLive,l.remainingGrowTime=e.remainingGrowTime,l.publiclyBreedable=e.publiclyBreedable,(o||t.isRoomOwner||te().isModerator||t.controllerLevel>=pt.USER_WITH_RIGHTS)&&(l.canRemovePet=!0),l}static checkGuildSetting(e){return e.isGuildRoom?e.roomControllerLevel>=pt.GUILD_ADMIN:e.roomControllerLevel>=pt.USER_WITH_RIGHTS}static isValidSetting(e,t){const i=$e();if(!i.isPrivateRoom)return!1;const r=i.moderationSettings;let n=!1;return r&&(n=t(e,r)),n&&e.targetRoomControllerLevel<pt.ROOM_OWNER}static canBeMuted(e){const t=(i,r)=>{switch(r.allowMute){case Zt.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(i);default:return i.roomControllerLevel>=pt.ROOM_OWNER}};return this.isValidSetting(e,t)}static canBeKicked(e){const t=(i,r)=>{switch(r.allowKick){case Zt.MODERATION_LEVEL_ALL:return!0;case Zt.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(i);default:return i.roomControllerLevel>=pt.ROOM_OWNER}};return this.isValidSetting(e,t)}static canBeBanned(e){const t=(i,r)=>{switch(r.allowBan){case Zt.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(i);default:return i.roomControllerLevel>=pt.ROOM_OWNER}};return this.isValidSetting(e,t)}}const lr=class lr{};lr.GENERIC_SKILL=0,lr.DRESS_UP=1,lr.SETUP_CHAT=2,lr.RANDOM_WALK=3,lr.DANCE=4,lr.CHANGE_BOT_NAME=5,lr.SERVE_BEVERAGE=6,lr.INCLIENT_LINK=7,lr.NUX_PROCEED=8,lr.CHANGE_BOT_MOTTO=9,lr.NUX_TAKE_TOUR=10,lr.NO_PICK_UP=12,lr.NAVIGATOR_SEARCH=14,lr.DONATE_TO_USER=24,lr.DONATE_TO_ALL=25;let Rs=lr;const mI=class mI{constructor(e=-1,t=-1,i=-1,r="",n="",o="",l=null,c=0,u=0,d=null,_=null,m=null,f=null,E=!1){this.senderId=e,this.senderCategory=t,this.roomId=i,this.text=r,this.formattedText=n,this.username=o,this.location=l,this.type=c,this.styleId=u,this.imageUrl=d,this.color=_,this.pureContent=m,this.uniqueName=f,this.hasNickname=E,this.id="-1",this.width=0,this.height=0,this.elementRef=null,this.skipMovement=!1,this.repeatCount=1,this._top=0,this._left=0,this.id=(Math.random()+1).toString(36).substring(7)+(++mI.BUBBLE_COUNTER+"")}get top(){return this._top}set top(e){this._top=e,this.elementRef&&(this.elementRef.style.top=this._top+"px")}get left(){return this._left}set left(e){this._left=e,this.elementRef&&(this.elementRef.style.left=this._left+"px")}};mI.BUBBLE_COUNTER=0;let zx=mI;const lg=class lg{};lg.CHAT_DEFAULT=0,lg.CHAT_WHISPER=1,lg.CHAT_SHOUT=2;let yo=lg;class kb{constructor(e=0,t=0,i=0,r=0){this.id=e,this.type=t,this.color=i,this.light=r}}const fJ=(a,e,t,i=0)=>!(a.left+i+a.width<e.left+i||a.left+i>e.left+i+e.width||a.top+a.height<e.top+t||a.top>e.top+t+e.height),rd=class rd{static savePreset(e,t,i,r,n){$e().updateMoodlightData(e,t,i,r,n)}static changeState(){$e().toggleMoodlightState()}static previewDimmer(e,t,i){ce().updateObjectRoomColor($e().roomId,e,t,i)}static scaleBrightness(e){return~~((e-this.MIN_BRIGHTNESS)*100/(this.MAX_BRIGHTNESS-this.MIN_BRIGHTNESS)+0)}};rd.AVAILABLE_COLORS=[7665141,21495,15161822,15353138,15923281,8581961,0],rd.HTML_COLORS=["#74F5F5","#0053F7","#E759DE","#EA4532","#F2F851","#82F349","#000000"],rd.MIN_BRIGHTNESS=76,rd.MAX_BRIGHTNESS=255;let No=rd;const pJ=130,EJ=100,IJ=130,TJ=100,SJ=130,RJ=100,Mk=a=>{let e=0,t=0,i=0,r=0;for(;r<a.length;){switch(r%3){case 0:e=e+a.charCodeAt(r)*37;break;case 1:t=t+a.charCodeAt(r)*37;break;case 2:i=i+a.charCodeAt(r)*37;break}r++}return e=e%EJ+pJ,t=t%TJ+IJ,i=i%RJ+SJ,`rgb(${e},${t},${i})`},fI=class fI{static getMergedMannequinFigureContainer(e,t){const i=qt().createFigureContainer(e),r=qt().createFigureContainer(t);for(const n of this.MANNEQUIN_CLOTHING_PART_TYPES)i.removePart(n);for(const n of r.getPartTypeIds())i.updatePart(n,r.getPartSetId(n),r.getPartColorIds(n));return i}static transformAsMannequinFigure(e){for(const t of e.getPartTypeIds())this.MANNEQUIN_CLOTHING_PART_TYPES.indexOf(t)>=0||e.removePart(t);e.updatePart(this.MANNEQUIN_FIGURE[0],this.MANNEQUIN_FIGURE[1],this.MANNEQUIN_FIGURE[2])}};fI.MANNEQUIN_FIGURE=["hd",99999,[99998]],fI.MANNEQUIN_CLOTHING_PART_TYPES=[Ee.CHEST_ACCESSORY,Ee.COAT_CHEST,Ee.CHEST,Ee.LEGS,Ee.SHOES,Ee.WAIST_ACCESSORY];let xd=fI;const pI=class pI{};pI.POSTURE_STAND=0,pI.POSTURE_SIT=1;let Rp=pI;class wu{constructor(e,t,i,r="",n=0,o=0,l=0){this._id=e,this._category=t,this._name=i,this._furnitureOwner=r,this._unitLote=n,this._unitTotal=o,this._type=l}get id(){return this._id}get category(){return this._category}get name(){return this._name}get furnitureOwner(){return this._furnitureOwner}get unitLote(){return this._unitLote}get unitTotal(){return this._unitTotal}get type(){return this._type}}class jk{constructor(e,t,i,r,n,o,l){this.id=e,this.category=t,this.name=i,this.requestRoomObjectId=r,this.targetRoomObjectId=n,this.requestInventoryStripId=o,this.replace=l}}const xp="0",Lk="1",Ql=class Ql{};Ql.UNSTARTED=-1,Ql.ENDED=0,Ql.PLAYING=1,Ql.PAUSED=2,Ql.BUFFERING=3,Ql.CUED=5;let pc=Ql;function ir(a){K(new AF(a))}const oh=a=>{const e=Math.floor(a/2);return a%2?(e+.5).toString():e.toString()},Ge=class Ge{};Ge.TOGGLE_FURNI_STATE=0,Ge.RESET=1,Ge.SET_FURNI_STATE=3,Ge.MOVE_FURNI=4,Ge.GIVE_SCORE=6,Ge.CHAT=7,Ge.TELEPORT=8,Ge.JOIN_TEAM=9,Ge.LEAVE_TEAM=10,Ge.CHASE=11,Ge.FLEE=12,Ge.MOVE_AND_ROTATE_FURNI=13,Ge.GIVE_SCORE_TO_PREDEFINED_TEAM=14,Ge.TOGGLE_TO_RANDOM_STATE=15,Ge.MOVE_FURNI_TO=16,Ge.GIVE_REWARD=17,Ge.CALL_ANOTHER_STACK=18,Ge.KICK_FROM_ROOM=19,Ge.MUTE_USER=20,Ge.BOT_TELEPORT=21,Ge.BOT_MOVE=22,Ge.BOT_TALK=23,Ge.BOT_GIVE_HAND_ITEM=24,Ge.BOT_FOLLOW_AVATAR=25,Ge.BOT_CHANGE_FIGURE=26,Ge.BOT_TALK_DIRECT_TO_AVTR=27,Ge.CONTROL_CLOCK=28,Ge.SET_FURNI_ALTITUDE=29,Ge.SEND_SIGNAL=30,Ge.FREEZE_USER=31,Ge.UNFREEZE_USER=32,Ge.RELATIVE_FURNI_MOVE=33,Ge.MOVE_FURNI_TO_FURNI=34,Ge.MOVE_FURNI_TO_USER=35,Ge.NEG_CALL_ANOTHER_STACK=36,Ge.NEG_SEND_SIGNAL=37,Ge.ADJUST_CLOCK=38,Ge.YOUTUBE=39,Ge.MEMORY_OPERATION=40,Ge.GIVE_BADGE=41,Ge.SEND_SCRIPT_SIGNAL=42,Ge.SUPER_WIRED=43,Ge.MEMORY_BOX=44,Ge.MEMORY_USER=45,Ge.MEMORY_BOX_STRING=46,Ge.MEMORY_USER_STRING=47,Ge.ROTATE_BOT=48,Ge.OPACITY_ITEM=50,Ge.RESET_HIGHSCORE=51,Ge.BOT_ACTIONS=52,Ge.INFINITE_MUTE_USER=53,Ge.BOT_SET_HAND_ITEM=54,Ge.LIGHT_CONTROLLER=55,Ge.PAINT_FURNI=56,Ge.PLAYER_VISIBLE=57,Ge.DISABLE_WIRED=58,Ge.MOVE_USER=59,Ge.TOGGLE_USER_INTERACTION=60,Ge.GIVE_SCORE_CUSTOM=61,Ge.DEFAULT=62,Ge.GIVE_VAR=63,Ge.CHANGE_VAR=64,Ge.REMOVE_VAR=65,Ge.USER_ACTIONS=66,Ge.USER_NOTIFICATION=67,Ge.PLAY_SOUND_EFFECT=68,Ge.FAST_WALK=69,Ge.BOT_FREEZE=70,Ge.COLLISION_AROUND=71,Ge.PLAY_MUSIC=72,Ge.MOVE_FURNI_BY_COORDINATES=73,Ge.MOVE_USER_TO_FURNI=74,Ge.CHANGE_BOT_MOTTO=75,Ge.SET_EFFECT=76,Ge.FOLLOW_FURNI=76;let Fe=Ge;const tt=class tt{};tt.STATES_MATCH=0,tt.FURNIS_HAVE_AVATARS=1,tt.ACTOR_IS_ON_FURNI=2,tt.TIME_ELAPSED_MORE=3,tt.TIME_ELAPSED_LESS=4,tt.USER_COUNT_IN=5,tt.ACTOR_IS_IN_TEAM=6,tt.HAS_STACKED_FURNIS=7,tt.STUFF_TYPE_MATCHES=8,tt.STUFFS_IN_FORMATION=9,tt.ACTOR_IS_GROUP_MEMBER=10,tt.ACTOR_IS_WEARING_BADGE=11,tt.ACTOR_IS_WEARING_EFFECT=12,tt.NOT_STATES_MATCH=13,tt.FURNI_NOT_HAVE_HABBO=14,tt.NOT_ACTOR_ON_FURNI=15,tt.NOT_USER_COUNT_IN=16,tt.NOT_ACTOR_IN_TEAM=17,tt.NOT_HAS_STACKED_FURNIS=18,tt.NOT_FURNI_IS_OF_TYPE=19,tt.NOT_STUFFS_IN_FORMATION=20,tt.NOT_ACTOR_IN_GROUP=21,tt.NOT_ACTOR_WEARS_BADGE=22,tt.NOT_ACTOR_WEARING_EFFECT=23,tt.DATE_RANGE_ACTIVE=24,tt.ACTOR_HAS_HANDITEM=25,tt.TRIGGERER_MATCHES=26,tt.NOT_TRIGGERER_MATCHES=27,tt.TIME_MATCHES=28,tt.DATE_MATCHES=29,tt.NOT_HAS_HANDITEM=30,tt.TEAM_IS_WINNING=31,tt.PERFORMING_ACTION=32,tt.NOT_PERFORMING_ACTION=33,tt.TEAM_HAS_SCORE=34,tt.CLOCK_TIME_MATCHES=35,tt.FURNI_HAS_ALTITUDE=36,tt.USER_DIRECTION=37,tt.INPUT_SOURCE_QUANTITY=38,tt.CAN_PERFORM_MOVE=39,tt.MEMORY_BOX_UNIVERSAL=40,tt.HABBO_HAS_RIGHTS=41,tt.HABBO_HAS_DIAMONDS=42,tt.HABBO_HAS_DUCKETS=43,tt.MEMORY_BOX=44,tt.MEMORY_USER=45,tt.MEMORY_BOX_STRING=46,tt.MEMORY_USER_STRING=47,tt.FURNI_CLOSE=48,tt.HAS_MOTTO=49,tt.HAS_POINTS_SCOREBOARD=50,tt.HAS_TAG=51,tt.NAMES_MATCHES=52,tt.FURNI_SAME_DIRECTION=53,tt.FURNI_COLORS_MATCHES=54,tt.HAS_VARIABLE=55,tt.VARIABLE_VALUE=56,tt.VARIABLE_AGE=57,tt.IS_PRESSING_KEY=61;let et=tt;const Gb=a=>`${a.getFullYear()}/${("0"+(a.getMonth()+1)).slice(-2)}/${("0"+a.getDate()).slice(-2)} ${("0"+a.getHours()).slice(-2)}:${("0"+a.getMinutes()).slice(-2)}`,nd=class nd{};nd.STUFF_SELECTION_OPTION_NONE=0,nd.STUFF_SELECTION_OPTION_BY_ID=1,nd.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE=2,nd.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT=3;let ge=nd;const xJ=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,OJ=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec3 lineColor;
uniform vec3 color;
void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec3 colorLine = lineColor * currentColor.a;
    vec3 colorOverlay = color * currentColor.a;
    
    
    if(currentColor.r >= 0.45 && currentColor.g >= 0.55 && currentColor.b >= 0.55 && currentColor.a > 0.0) {
        gl_FragColor = vec4(currentColor.r, currentColor.g, currentColor.b, currentColor.a);
    } else if(currentColor.r <= 0.45 && currentColor.g <= 0.55 && currentColor.b <= 0.55 && currentColor.a > 0.0) {
        gl_FragColor = vec4(currentColor.r, currentColor.g, currentColor.b, currentColor.a);
    } else if(currentColor.a > 0.0) {
        gl_FragColor = vec4(1.0, 1.0, 1.0, 1);
    }
}`;class CJ extends Jy{constructor(e,t){super(xJ,OJ),this.uniforms.lineColor=new Float32Array(3),this.uniforms.color=new Float32Array(3),this.lineColor=e,this.color=t}get lineColor(){return this._lineColor}set lineColor(e){const t=this.uniforms.lineColor;typeof e=="number"?(Ri.hex2rgb(e,t),this._lineColor=e):(t[0]=e[0],t[1]=e[1],t[2]=e[2],this._lineColor=Ri.rgb2hex(t))}get color(){return this._color}set color(e){const t=this.uniforms.color;typeof e=="number"?(Ri.hex2rgb(e,t),this._color=e):(t[0]=e[0],t[1]=e[1],t[2]=e[2],this._color=Ri.rgb2hex(t))}}const On=class On{static show(e,t=!1,i=1){this.activateFurni(this.getRoomObject(e),e<0,t,i)}static hide(e,t=!1,i=1){this.inactivateFurni(this.getRoomObject(e),e<0,t,i)}static hideAll(e){for(const t of e)this.inactivateFurni(this.getRoomObject(t),t<0,!0,1)}static showAll(e,t=!1,i=1){for(const r of e)this.activateFurni(this.getRoomObject(r),r<0,t,i)}static highlightActiveWired(e){this._activeWiredFilter.matrix=this._activeWiredMatrix,this.addFiltersToFurni(this.getRoomObject(e),[this._activeWiredFilter])}static unhighlightActiveWired(e){this._activeWiredFilter.matrix=this._activeWiredMatrix,this.removeFiltersFromFurni(this.getRoomObject(e),[this._activeWiredFilter])}static activateFurni(e,t,i,r){this._matrixFilter.matrix=this._bwFilter;const n=[this._matrixFilter,this._selectionShader],o=[this._matrixFilter,this._selectionShader,this._glow];if(this.addFiltersToFurni(e,t?o:n,!0),i){const l=r===1?this._dualPicking1Filter:this._dualPicking2Filter;l.matrix=r===1?this._dualMatrix1:this._dualMatrix2,this.addFiltersToFurni(e,[l])}}static hasFilters(e,t){if(!e)return!1;const i=e.visualization;if(!i.filters)return!1;const r=i.filters.slice();for(const n of t)if(r.indexOf(n)!==-1)return!0;return!1}static inactivateFurni(e,t,i,r){this._matrixFilter.matrix=this._bwFilter;const n=[this._matrixFilter,this._selectionShader],o=[this._matrixFilter,this._selectionShader,this._glow];if(this.removeFiltersFromFurni(e,t?o:n),i){const l=r===1?this._dualPicking1Filter:this._dualPicking2Filter,c=r===1?this._dualPicking2Filter:this._dualPicking1Filter;l.matrix=r===1?this._dualMatrix1:this._dualMatrix2,c.matrix=r===1?this._dualMatrix2:this._dualMatrix1,this.removeFiltersFromFurni(e,[l]),this.removeFiltersFromFurni(e,[c])}}static addFiltersToFurni(e,t,i=!1){if(!e)return;const r=e.visualization;let n=r.filters||[];r.filters=i?t.concat(n):n.concat(t)}static removeFiltersFromFurni(e,t){if(!e)return;const i=e.visualization;if(!i.filters)return;const r=i.filters.slice();for(const n of t){const o=r.indexOf(n);o!==-1&&r.splice(o,1)}i.filters=r}static getRoomObject(e){const t=ce();return t?t.getRoomObject(t.activeRoomId,e,Q.FLOOR)||t.getRoomObject(t.activeRoomId,e,Q.WALL):null}};On._matrixFilter=new Yc,On._matrixFilter2=new Yc,On._dualPicking1Filter=new Yc,On._dualPicking2Filter=new Yc,On._activeWiredFilter=new Yc,On._selectionShader=new CJ([1,1,1],[.6,.6,.6]),On._glow=new iC({color:16777215,outerStrength:0,innerStrength:3,distance:5,quality:1,knockout:!1}),On._bwFilter=[.25,0,0,0,.45,0,.25,0,0,.55,0,0,.25,0,.55,0,0,0,1,0],On._activeWiredMatrix=[.9,0,0,0,0,0,1,0,0,.4,0,0,1,0,.8,0,0,0,.8,0],On._dualMatrix1=[.65,0,0,0,.45,0,.65,0,0,.45,0,0,1,0,0,0,0,0,1,0],On._dualMatrix2=[1,0,0,0,0,0,1,0,0,0,0,0,1.15,0,40,0,0,0,1,0];let Ai=On;const Yt="	",Ss=class Ss{};Ss.AVATAR_SAYS_SOMETHING=0,Ss.AVATAR_WALKS_ON_FURNI=1,Ss.AVATAR_WALKS_OFF_FURNI=2,Ss.EXECUTE_ONCE=3,Ss.TOGGLE_FURNI=4,Ss.EXECUTE_PERIODICALLY=6,Ss.AVATAR_ENTERS_ROOM=7,Ss.GAME_STARTS=8,Ss.GAME_ENDS=9,Ss.SCORE_ACHIEVED=10,Ss.COLLISION=11,Ss.EXECUTE_PERIODICALLY_LONG=12,Ss.BOT_REACHED_STUFF=13,Ss.BOT_REACHED_AVATAR=14,Ss.CLOCK_REACH_TIME=15,Ss.PERFORM_ACTION=16,Ss.RECEIVE_SIGNAL=17,Ss.AVATAR_CLICKS_FURNI=18,Ss.PERIODIC_SHORT=19,Ss.STATE_CHANGE=20,Ss.CLICK_BLOCK=21,Ss.ENTER_OR_LEAVE_TEAM=22,Ss.RECEIVE_SCRIPT_SIGNAL=23,Ss.AVATAR_CLICKS_AVATAR=24,Ss.COMMANDS=25,Ss.KEYBOARD=26,Ss.VAR_CHANGED=27;let Ts=Ss;const pi=class pi{};pi.CONDITION_EVALUATION=0,pi.PICK_ONE_RANDOMLY_PROPAGATION=1,pi.PICK_IN_ORDER_PROPAGATION=2,pi.EXECUTION_LIMIT=5,pi.NO_MOVE_ANIMATION=6,pi.MOVEMENT_FISICS=7,pi.CARRY_USERS=8,pi.ANIMATION_TIME=9,pi.FURNI_SELECTOR_FILTER=10,pi.USER_SELECTOR_FILTER=11,pi.MEMORY_BOX=12,pi.SCRIPT_BOX=13,pi.ORDER_EXECUTE=14,pi.CAPTURE_VAR=15,pi.USERNAME_FIELD=16,pi.VARIABLE_FIELD=17,pi.TEXT_CONNECTOR=18,pi.FURNI_VAR_FILTER=19,pi.USER_VAR_FILTER=20,pi.REPEAT_STACK=21;let mi=pi;const Gs=class Gs{};Gs.FURNI_BY_TYPE=0,Gs.FURNI_CHOOSER=1,Gs.USERS_BY_TYPE=2,Gs.USERS_IN_TEAM=3,Gs.FURNI_ON_FURNI=4,Gs.FURNI_FROM_SIGNAL=5,Gs.FURNI_IN_NEIGHBORHOOD=6,Gs.FURNI_IN_AREA=7,Gs.USERS_ON_FURNI=8,Gs.USERS_PERFORMING_ACTION=9,Gs.USERS_FROM_SIGNAL=10,Gs.USERS_BY_NAME=11,Gs.USERS_IN_NEIGHBORHOOD=12,Gs.USERS_IN_AREA=13,Gs.USERS_WITH_HANDITEM=14,Gs.USERS_IN_GROUP=15,Gs.FURNI_WITH_ALTITUDE=16,Gs.FURNI_WITH_OPACITY=17,Gs.USERS_WITH_VAR=18,Gs.FURNI_WITH_VAR=19,Gs.REMOTE_SELECTION=21,Gs.USERS_WITH_EFFECT=22,Gs.USERS_IN_NEIGHBORHOOD2=23,Gs.FURNI_IN_NEIGHBORHOOD2=24;let Fs=Gs;const Jl=class Jl{};Jl.FURNITURE_PLACE=0,Jl.FURNITURE_FLOOR_UPDATE=1,Jl.FURNITURE_WALL_UPDATE=2,Jl.FURNITURE_PICKUP=3,Jl.FURNITURE_SET_STATE=4,Jl.FURNITURE_WALL_SET_STATE=5;let It=Jl;const EI=class EI{static addUndo(e,t){this._undoMessageComposers.length>=this.LIMIT&&this._undoMessageComposers.shift(),this._undoMessageComposers.push({packetType:e,data:t})}static hasData(e){return this._undoMessageComposers.some(t=>JSON.stringify(t.data)===JSON.stringify(e))}static clearHistory(){this._undoMessageComposers=[]}static undo(){if(!this._undoMessageComposers.length)return;const e=this._undoMessageComposers.pop();if(!e)return;const t=this.reversePacket(e.packetType,e.data);t&&(K(t),Fd.addRedo(this.reversePacketType(e.packetType),e.data))}static reversePacket(e,t){if(e===It.FURNITURE_PLACE){const[i,r]=t;return new pT(r,i)}else if(e===It.FURNITURE_FLOOR_UPDATE){const[i,r,n,o]=t;return new Ud(i,r,n,o)}else if(e===It.FURNITURE_WALL_UPDATE){const[i,r]=t;return new fm(i,r)}else if(e===It.FURNITURE_PICKUP){const[i,r,n,o,l,c,u]=t;return u?new ET(i,n):new mm(i,r,n,o,l,c)}else if(e===It.FURNITURE_SET_STATE){const[i,r]=t;return new ko(i,r,!0)}else if(e===It.FURNITURE_WALL_SET_STATE){const[i,r]=t;return new oN(i,r,!0)}return null}static reversePacketType(e){let t=null;switch(e){case It.FURNITURE_PLACE:t=It.FURNITURE_PICKUP;break;case It.FURNITURE_FLOOR_UPDATE:t=It.FURNITURE_FLOOR_UPDATE;break;case It.FURNITURE_WALL_UPDATE:t=It.FURNITURE_WALL_UPDATE;break;case It.FURNITURE_PICKUP:t=It.FURNITURE_PLACE;break;case It.FURNITURE_SET_STATE:t=It.FURNITURE_SET_STATE;break;case It.FURNITURE_WALL_SET_STATE:t=It.FURNITURE_WALL_SET_STATE;break}return t}};EI._undoMessageComposers=[],EI.LIMIT=30;let Cr=EI;const II=class II{static addRedo(e,t){this._redoMessageComposers.length>=this.LIMIT&&this._redoMessageComposers.shift(),this._redoMessageComposers.push({packetType:e,data:t})}static hasData(e){return this._redoMessageComposers.some(t=>JSON.stringify(t.data)===JSON.stringify(e))}static clearHistory(){this._redoMessageComposers=[]}static redo(){if(!this._redoMessageComposers.length)return;const e=this._redoMessageComposers.pop();if(!e)return;const t=this.reversePacket(e.packetType,e.data);t&&(K(t),Cr.addUndo(this.reversePacketType(e.packetType),e.data))}static reversePacket(e,t){if(e===It.FURNITURE_PLACE){const[i,r]=t;return new pT(r,i)}else if(e===It.FURNITURE_FLOOR_UPDATE){const[i,r,n,o,l,c,u]=t;return new Ud(i,l,c,u)}else if(e===It.FURNITURE_WALL_UPDATE){const[i,r]=t;return new fm(i,r)}else if(e===It.FURNITURE_PICKUP){const[i,r,n,o,l,c,u]=t;return u?new ET(i,n):new mm(i,r,n,o,l,c)}else if(e===It.FURNITURE_SET_STATE){const[i,r]=t;return new ko(i,r)}else if(e===It.FURNITURE_WALL_SET_STATE){const[i,r]=t;return new ko(i,r)}return null}static reversePacketType(e){let t=null;switch(e){case It.FURNITURE_PLACE:t=It.FURNITURE_PICKUP;break;case It.FURNITURE_FLOOR_UPDATE:t=It.FURNITURE_FLOOR_UPDATE;break;case It.FURNITURE_WALL_UPDATE:t=It.FURNITURE_WALL_UPDATE;break;case It.FURNITURE_PICKUP:t=It.FURNITURE_PLACE;break;case It.FURNITURE_SET_STATE:t=It.FURNITURE_SET_STATE;break;case It.FURNITURE_WALL_SET_STATE:t=It.FURNITURE_WALL_SET_STATE;break}return t}};II._redoMessageComposers=[],II.LIMIT=30;let Fd=II;class Op{constructor(e,t,i,r,n,o,l,c,u,d){this._data=[e,t,i,r,n,o,l,c,u,d]}getMessageArray(){return this._data}dispose(){}}class NJ{static setup(e){e.registerMessageEvent(new $F(r.bind(this))),e.registerMessageEvent(new qF(l.bind(this))),e.registerMessageEvent(new QF(c.bind(this))),e.registerMessageEvent(new JF(u.bind(this))),e.registerMessageEvent(new XF(d.bind(this))),e.registerMessageEvent(new ek(f.bind(this))),e.registerMessageEvent(new QL(E.bind(this))),e.registerMessageEvent(new WC(I.bind(this))),e.registerMessageEvent(new zL(p.bind(this))),Me.addCallback("goRoom",_.bind(this)),Me.addCallback("sendMusicRequest",t.bind(this)),Me.addCallback("verifyRadioCode",i.bind(this)),Me.addCallback("getStoreIndex",m.bind(this)),Me.addCallback("constChangeForcedState",S.bind(this)),Me.addCallback("constChangeInputForcedState",R.bind(this)),Me.addCallback("constChangeForcedHeight",O.bind(this)),Me.addCallback("constChangeInputForcedHeight",C.bind(this)),Me.addCallback("constChangeInputForcedDirection",A.bind(this)),Me.addCallback("constChangeFreezeAvatar",b.bind(this)),Me.addCallback("constSendConstructionData",y.bind(this)),Me.addCallback("constChangeKeepHeight",H.bind(this)),Me.addCallback("constChangeIncreaseHeightChecked",M.bind(this)),Me.addCallback("constChangeIncreaseHeight",U.bind(this)),Me.addCallback("storeChangeCurrency",G.bind(this)),Me.addCallback("historyUndo",Cr.undo.bind(Cr)),Me.addCallback("historyRedo",Fd.redo.bind(Fd)),Me.addCallback("openWallEditor",F.bind(this));function t(v){e.connection.send(new WF(v))}function i(v){e.connection.send(new YF(v))}function r(v){Me.call("openPincel",v.getParser().colors),Me.addCallback("changePincelStatus",n.bind(this)),Me.addCallback("savePincelColors",o.bind(this))}function n(v){e.connection.send(new BF(v))}function o(v){Me.addCallback("changePincelStatus",null),Me.addCallback("savePincelColors",null),e.connection.send(new HF(v))}function l(v){Me.call("addAlert",v.getParser().author,v.getParser().title,v.getParser().content,v.getParser().color,v.getParser().button,v.getParser().buttonType,v.getParser().buttonParam)}function c(v){Me.call("openYoutubeVideo",v.getParser().videoCode,v.getParser().username,v.getParser().hasRight)}function u(v){Me.call("sendSound",v.getParser().sound,v.getParser().volume)}function d(v){const{color1:B,color2:z}=Me.call("getPincelSelectedColors");e.connection.send(new VF(v.getParser().furniId,B,z))}function _(v){De.instance.createLinkEvent(`navigator/goto/${v}`)}function m(){e.connection.send(new ZF)}function f(v){Me.call("setLojaData",v.getParser().storeData)}function E(v){Me.call("resetLoja")}function I(v){$Q(v.getParser().vipTimestamp),Me.call("setVipTimestamp",v.getParser().vipTimestamp)}function p(v){if(!v)return;const B=v.getParser();B&&(Px(B.forcedHeight),jx(B.forcedHeight!=0))}function S(v){Lx(v)}function R(v){Ux(v)}function O(v){jx(v)}function C(v){Px(v)}function A(v){Mx(v)}function b(v){KQ(v)}function y(v,B,z,$,W,V,se,ee,ie,Z){qQ(ie),e.connection.send(new Op(!!v,B+"",!!z,$,!!W,!!V,!!se,!!ee,!!ie,!!Z))}function M(v){YQ(v)}function U(v){zQ(v)}function G(v){Ok(v)}function F(){const v=$e();v&&v.controllerLevel>=pt.ROOM_OWNER&&Ce("wall-editor/show")}function H(v){XQ(v)}}}class AJ extends Wo{constructor(e){super(),this._communication=e,this._handShaking=!1,this._didConnect=!1,this._pongInterval=null,this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.sendPong=this.sendPong.bind(this)}onInit(){const e=this._communication.connection;e&&(e.addEventListener(er.CONNECTION_OPENED,this.onConnectionOpenedEvent),e.addEventListener(er.CONNECTION_CLOSED,this.onConnectionClosedEvent),e.addEventListener(er.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._communication.registerMessageEvent(new ZD(this.onClientPingEvent.bind(this))),this._communication.registerMessageEvent(new EL(this.onAuthenticatedEvent.bind(this))),NJ.setup(this._communication)}onDispose(){const e=this._communication.connection;e&&(e.removeEventListener(er.CONNECTION_OPENED,this.onConnectionOpenedEvent),e.removeEventListener(er.CONNECTION_CLOSED,this.onConnectionClosedEvent),e.removeEventListener(er.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._handShaking=!1,this.stopPonging(),super.onDispose()}onConnectionOpenedEvent(e){const t=this._communication.connection;t&&(this._didConnect=!0,this.dispatchCommunicationDemoEvent(Si.CONNECTION_ESTABLISHED,t),st.getValue("system.pong.manually",!1)&&this.startPonging(),this.startHandshake(t),t.send(new uU(null,null,null,null)),this.tryAuthentication(t))}onConnectionClosedEvent(e){const t=this._communication.connection;t&&(this.stopPonging(),this._didConnect&&this.dispatchCommunicationDemoEvent(Si.CONNECTION_CLOSED,t))}onConnectionErrorEvent(e){const t=this._communication.connection;t&&(this.stopPonging(),this.dispatchCommunicationDemoEvent(Si.CONNECTION_ERROR,t))}tryAuthentication(e){if(!e||!this.getSSO()){this.getSSO()||ze.error("Login without an SSO ticket is not supported"),this.dispatchCommunicationDemoEvent(Si.CONNECTION_HANDSHAKE_FAILED,e);return}e.send(new _U(this.getSSO(),nt()))}onClientPingEvent(e){!e||!e.connection||this.sendPong(e.connection)}onAuthenticatedEvent(e){!e||!e.connection||(this.completeHandshake(e.connection),this.dispatchCommunicationDemoEvent(Si.CONNECTION_AUTHENTICATED,e.connection),e.connection.send(new hU))}startHandshake(e){this.dispatchCommunicationDemoEvent(Si.CONNECTION_HANDSHAKING,e),this._handShaking=!0}completeHandshake(e){this.dispatchCommunicationDemoEvent(Si.CONNECTION_HANDSHAKED,e),this._handShaking=!1}startPonging(){this.stopPonging(),this._pongInterval=setInterval(this.sendPong,st.getValue("system.pong.interval.ms",2e4))}stopPonging(){this._pongInterval&&(clearInterval(this._pongInterval),this._pongInterval=null)}sendPong(e=null){e=e||this._communication.connection||null,e&&e.send(new dU)}dispatchCommunicationDemoEvent(e,t){De.instance.events.dispatchEvent(new Si(e,t))}getSSO(){return st.getValue("sso.ticket",null)}}class bJ{get areaHideMessageData(){return this._areaHideMessageData}flush(){return this._areaHideMessageData=null,!0}parse(e){return e?(this._areaHideMessageData=new aD(e),!0):!1}}class Kx extends w{constructor(e){super(e,bJ)}getParser(){return this.parser}}class vJ{get ids(){return this._ids}get pickerId(){return this._pickerId}flush(){return this._ids=[],this._pickerId=0,!0}parse(e){if(!e)return!1;let t=e.readInt();this._ids=[];for(let i=0;i<t;i++)this._ids.push(e.readInt());return this._pickerId=e.readInt(),!0}}class qx extends w{constructor(e){super(e,vJ)}getParser(){return this.parser}}class Pk extends w{constructor(e){super(e,VK)}getParser(){return this.parser}}class Uk extends w{constructor(e){super(e,HK)}getParser(){return this.parser}}class wk{constructor(e,t,i,r,n,o,l,c,u,d){this._data=[e,t,i,r,n,o,l,c,u,d]}getMessageArray(){return this._data}dispose(){}}class Fk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Xx{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class kk{constructor(e,t,i,r,n,o,l,c){this._data=[e,t.length,...t,i.length,...i,r,n.length,...n,o.length,...o,l.length,...l,c.length,...c]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class Gk{constructor(e,t,i,r,n,o,l,c,u,d){this._data=[e,t.length,...t,i.length,...i,r,n.length,...n,o.length,...o,l,c,u.length,...u,d.length,...d]}get disposed(){return!1}getMessageArray(){return this._data}dispose(){}}class Bk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Vk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class yJ{get allVariablesHash(){return this._allVariablesHash}flush(){return this._allVariablesHash=0,!0}parse(e){return e?(this._allVariablesHash=e.readInt(),!0):!1}}class Hk extends w{constructor(e){super(e,yJ)}getParser(){return this.parser}}class DJ{get variableInfoAndHolders(){return this._variableInfoAndHolders}flush(){return this._variableInfoAndHolders=null,!0}parse(e){return e?(e.readInt(),this._variableInfoAndHolders=new vR(e),!0):!1}}class Wk extends w{constructor(e){super(e,DJ)}getParser(){return this.parser}}const ad=class ad{constructor(e){this._type=e.readInt(),this._type===ad.OBJECT?this._objectId=e.readInt():this._type===ad.USER&&(this._userIndex=e.readInt()),this._variableValues=new oT;let t=e.readInt();for(;t>0;){let i=e.readString(),r=e.readInt();this._variableValues.add(i,r),t--}}get type(){return this._type}get userIndex(){return this._userIndex}get objectId(){return this._objectId}get variableValues(){return this._variableValues}};ad.OBJECT=0,ad.USER=1;let $x=ad;class MJ{get data(){return this._data}flush(){return this._data=null,!0}parse(e){return e?(this._data=new $x(e),!0):!1}}class Yk extends w{constructor(e){super(e,MJ)}getParser(){return this.parser}}class jJ{constructor(e){this._errorId=e.readInt(),this._errorName=e.readString(),this._category=e.readString(),this._throwCount=e.readInt(),this._msSinceLastOccurrence=e.readInt()}get errorId(){return this._errorId}get errorName(){return this._errorName}get category(){return this._category}get throwCount(){return this._throwCount}get msSinceLastOccurrence(){return this._msSinceLastOccurrence}}class LJ{get errors(){return this._errors}flush(){return this._errors=null,!0}parse(e){if(!e)return!1;this._errors=[];let t=e.readInt();for(;t>0;)this._errors.push(new jJ(e)),t--;return!0}}class zk extends w{constructor(e){super(e,LJ)}getParser(){return this.parser}}class PJ{get canModify(){return this._canModify}get canRead(){return this._canRead}flush(){return this._canModify=!1,this._canRead=!1,!0}parse(e){return e?(this._canModify=e.readBoolean(),this._canRead=e.readBoolean(),!0):!1}}class Kk extends w{constructor(e){super(e,PJ)}getParser(){return this.parser}}const cg=class cg{get errorCode(){return this._errorCode}flush(){return this._errorCode=0,!0}parse(e){return e?(this._errorCode=e.readShort(),!0):!1}};cg.ERROR_CODE0=0,cg.ERROR_CODE1=1,cg.ERROR_CODE2=2;let Qx=cg;class UJ extends w{constructor(e){super(e,Qx)}getParser(){return this.parser}}class wJ{get readPermissionMask(){return this._readPermissionMask}get modifyPermissionMask(){return this._modifyPermissionMask}get timezone(){return this._timezone}flush(){return this._readPermissionMask=0,this._modifyPermissionMask=0,this._timezone="",!0}parse(e){return e?(this._modifyPermissionMask=e.readInt(),this._readPermissionMask=e.readInt(),this._timezone=e.readString(),!0):!1}}class qk extends w{constructor(e){super(e,wJ)}getParser(){return this.parser}}class FJ{constructor(e){this._executionCost=Number(Number(e.readString()).toFixed(0)),this._executionCostCap=Number(Number(e.readString()).toFixed(0)),this._isHeavy=e.readBoolean(),this._floorItemCount=e.readInt(),this._floorItemCap=e.readInt(),this._wallItemCount=e.readInt(),this._wallItemCap=e.readInt(),this._permanentFurniVariables=e.readInt(),this._maxPermanentFurniVariables=e.readInt(),this._permanentUserVariables=e.readInt(),this._maxPermanentUserVariables=e.readInt(),this._permanentGlobalVariables=e.readInt(),this._maxPermanentGlobalVariables=e.readInt()}get executionCost(){return this._executionCost}get executionCostCap(){return this._executionCostCap}get isHeavy(){return this._isHeavy}get floorItemCount(){return this._floorItemCount}get floorItemCap(){return this._floorItemCap}get wallItemCount(){return this._wallItemCount}get wallItemCap(){return this._wallItemCap}get permanentFurniVariables(){return this._permanentFurniVariables}get maxPermanentFurniVariables(){return this._maxPermanentFurniVariables}get permanentUserVariables(){return this._permanentUserVariables}get maxPermanentUserVariables(){return this._maxPermanentUserVariables}get permanentGlobalVariables(){return this._permanentGlobalVariables}get maxPermanentGlobalVariables(){return this._maxPermanentGlobalVariables}}class kJ{get roomStats(){return this._roomStats}flush(){return this._roomStats=null,!0}parse(e){return e?(this._roomStats=new FJ(e),!0):!1}}class Xk extends w{constructor(e){super(e,kJ)}getParser(){return this.parser}}class GJ{constructor(){this._events=new Map,this._composers=new Map,this.registerEvents(),this.registerComposers()}get events(){return this._events}get composers(){return this._composers}registerEvents(){this._events.set(k.INTERSTITIAL_MESSAGE,S7),this._events.set(k.ROOM_AD_ERROR,R7),this._events.set(k.AVAILABILITY_STATUS,gD),this._events.set(k.AVAILABILITY_TIME,x7),this._events.set(k.HOTEL_CLOSED_AND_OPENS,mD),this._events.set(k.HOTEL_CLOSES_AND_OPENS_AT,fD),this._events.set(k.HOTEL_WILL_CLOSE_MINUTES,pD),this._events.set(k.HOTEL_MAINTENANCE,ED),this._events.set(k.USER_CHANGE_NAME,kg),this._events.set(k.CHECK_USER_NAME,ID),this._events.set(k.USER_FIGURE,mC),this._events.set(k.USER_OUTFITS,O7),this._events.set(k.RESULT_PROFILE_BACKGROUND,ML),this._events.set(k.ADD_BOT_TO_INVENTORY,TD),this._events.set(k.USER_BOTS,SD),this._events.set(k.BOT_RECEIVED,C7),this._events.set(k.REMOVE_BOT_FROM_INVENTORY,RD),this._events.set(k.CFH_SANCTION,xD),this._events.set(k.CFH_TOPICS,OD),this._events.set(k.CFH_SANCTION_STATUS,CD),this._events.set(k.CAMERA_PUBLISH_STATUS,ND),this._events.set(k.CAMERA_PURCHASE_OK,AD),this._events.set(k.CAMERA_STORAGE_URL,bD),this._events.set(k.COMPETITION_STATUS,A7),this._events.set(k.INIT_CAMERA,vD),this._events.set(k.THUMBNAIL_STATUS,b7),this._events.set(k.CAMERA_SNAPSHOT,N7),this._events.set(k.CAMPAIGN_CALENDAR_DATA,yD),this._events.set(k.CAMPAIGN_CALENDAR_DOOR_OPENED,DD),this._events.set(k.CAMPAIGN_CALENDAR_DAY_UPDATE,MD),this._events.set(k.NATAL_CAMPAIGN_STATS,JL),this._events.set(k.NATAL_CAMPAIGN_IMPULSE_STATUS,oX),this._events.set(k.BONUS_RARE_INFO,jD),this._events.set(k.BUILDERS_CLUB_FURNI_COUNT,LD),this._events.set(k.BUILDERS_CLUB_SUBSCRIPTION,PD),this._events.set(k.BUNDLE_DISCOUNT_RULESET,v7),this._events.set(k.CATALOG_PAGE_EXPIRATION,y7),this._events.set(k.CATALOG_PAGE,UD),this._events.set(k.CATALOG_PAGE_LIST,wD),this._events.set(k.CATALOG_EARLIEST_EXPIRY,D7),this._events.set(k.CATALOG_PUBLISHED,FD),this._events.set(k.CLUB_GIFT_INFO,fC),this._events.set(k.CLUB_GIFT_SELECTED,kD),this._events.set(k.DIRECT_SMS_CLUB_BUY,M7),this._events.set(k.GIFT_RECEIVER_NOT_FOUND,GD),this._events.set(k.GIFT_WRAPPER_CONFIG,BD),this._events.set(k.CLUB_EXTENDED_OFFER,L7),this._events.set(k.CLUB_OFFERS,VD),this._events.set(k.IS_OFFER_GIFTABLE,P7),this._events.set(k.LIMITED_SOLD_OUT,HD),this._events.set(k.LIMITED_OFFER_APPEARING_NEXT,U7),this._events.set(k.NOT_ENOUGH_BALANCE,w7),this._events.set(k.PRODUCT_OFFER,WD),this._events.set(k.CATALOG_PURCHASE_ERROR,YD),this._events.set(k.CATALOG_PURCHASE_NOT_ALLOWED,zD),this._events.set(k.CATALOG_PURCHASE_OK,KD),this._events.set(k.ROOM_AD_PURCHASE,qD),this._events.set(k.SEASONAL_CALENDAR_OFFER,F7),this._events.set(k.CATALOG_RECEIVE_PET_BREEDS,XD),this._events.set(k.TARGET_OFFER,$D),this._events.set(k.TARGET_OFFER_NOT_FOUND,k7),this._events.set(k.REDEEM_VOUCHER_ERROR,QD),this._events.set(k.REDEEM_VOUCHER_OK,JD),this._events.set(k.CLIENT_PING,ZD),this._events.set(k.CLIENT_LATENCY,eM),this._events.set(k.COMPETITION_ENTRY_SUBMIT,G7),this._events.set(k.COMPETITION_VOTING_INFO,B7),this._events.set(k.COMPETITION_TIMING_CODE,V7),this._events.set(k.COMPETITION_USER_PART_OF,H7),this._events.set(k.COMPETITION_NO_OWNED_ROOMS,W7),this._events.set(k.COMPETITION_SECONDS_UNTIL,Y7),this._events.set(k.CRAFTABLE_PRODUCTS,tM),this._events.set(k.CRAFTING_RECIPE,sM),this._events.set(k.CRAFTING_RECIPES_AVAILABLE,iM),this._events.set(k.CRAFTING_RESULT,rM),this._events.set(k.DESKTOP_VIEW,Gg),this._events.set(k.MESSENGER_ACCEPT_FRIENDS,z7),this._events.set(k.MESSENGER_FIND_FRIENDS,K7),this._events.set(k.MESSENGER_FOLLOW_FAILED,q7),this._events.set(k.MESSENGER_FRIENDS,nM),this._events.set(k.MESSENGER_UPDATE,aM),this._events.set(k.MESSENGER_FRIEND_NOTIFICATION,X7),this._events.set(k.MESSENGER_REQUESTS,oM),this._events.set(k.MESSENGER_SEARCH,lM),this._events.set(k.MESSENGER_INSTANCE_MESSAGE_ERROR,$7),this._events.set(k.MESSENGER_MESSAGE_ERROR,Q7),this._events.set(k.MESSENGER_INIT,cM),this._events.set(k.MESSENGER_MINIMAIL_NEW,J7),this._events.set(k.MESSENGER_MINIMAIL_COUNT,Z7),this._events.set(k.MESSENGER_CHAT,pC),this._events.set(k.MESSENGER_REQUEST,EC),this._events.set(k.MESSENGER_INVITE_ERROR,uM),this._events.set(k.MESSENGER_INVITE,IC),this._events.set(k.ADDED_TO_GROUP_WHISPER,XL),this._events.set(k.ACHIEVEMENTRESOLUTIONCOMPLETED,aq),this._events.set(k.ACHIEVEMENTRESOLUTIONPROGRESS,oq),this._events.set(k.ACHIEVEMENTRESOLUTIONS,lq),this._events.set(k.LOAD_GAME_URL,TC),this._events.set(k.LOADGAME,gq),this._events.set(k.UNLOADGAME,mq),this._events.set(k.GAME_CENTER_GAME_LIST,dM),this._events.set(k.GAMESTATUSMESSAGE,_M),this._events.set(k.GAME_CENTER_ACHIEVEMENTS,fq),this._events.set(k.GAME_CENTER_STATUS,hM),this._events.set(k.GAME_CENTER_IN_ARENA_QUEUE,tq),this._events.set(k.GAME_CENTER_STOP_COUNTER,rq),this._events.set(k.GAME_CENTER_USER_LEFT_GAME,nq),this._events.set(k.GAME_CENTER_DIRECTORY_STATUS,eq),this._events.set(k.GAME_CENTER_STARTING_GAME_FAILED,iq),this._events.set(k.GAME_CENTER_JOINING_FAILED,sq),this._events.set(k.GAMEACHIEVEMENTS,cq),this._events.set(k.GAMEINVITE,uq),this._events.set(k.JOINEDQUEUEMESSAGE,hq),this._events.set(k.JOININGQUEUEFAILED,dq),this._events.set(k.LEFTQUEUE,_q),this._events.set(k.WEEKLY_GAME_REWARD,Sq),this._events.set(k.WEEKLY_GAME_REWARD_WINNERS,Rq),this._events.set(k.WEEKLY_COMPETITIVE_LEADERBOARD,Tq),this._events.set(k.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD,Iq),this._events.set(k.WEEKLY_GAME2_FRIENDS_LEADERBOARD,pq),this._events.set(k.WEEKLY_GAME2_LEADERBOARD,Eq),this._events.set(k.GROUP_INFO,Xd),this._events.set(k.GROUP_MEMBER_REMOVE_CONFIRM,mM),this._events.set(k.GROUP_MEMBERS,fM),this._events.set(k.GROUP_CREATE_OPTIONS,gM),this._events.set(k.GROUP_BADGE_PARTS,SC),this._events.set(k.GROUP_SETTINGS,EM),this._events.set(k.GROUP_PURCHASED,pM),this._events.set(k.GROUP_BADGES,UL),this._events.set(k.GROUP_DEACTIVATE,IM),this._events.set(k.GROUP_MEMBERSHIP_REQUESTED,Z9),this._events.set(k.GROUP_DETAILS_CHANGED,J9),this._events.set(k.GROUP_HABBO_JOIN_FAILED,sX),this._events.set(k.GROUP_FORUM_DATA,TM),this._events.set(k.GROUP_FORUM_LIST,SM),this._events.set(k.GROUP_FORUM_THREADS,RM),this._events.set(k.GROUP_FORUM_POST,xM),this._events.set(k.GROUP_FORUM_POST_THREAD,OM),this._events.set(k.GROUP_FORUM_THREAD_MESSAGES,CM),this._events.set(k.GROUP_FORUM_UNREAD_COUNT,NM),this._events.set(k.GROUP_FORUM_UPDATE_MESSAGE,AM),this._events.set(k.GROUP_FORUM_UPDATE_THREAD,bM),this._events.set(k.CFH_DISABLED_NOTIFY,yM),this._events.set(k.CFH_PENDING_CALLS_DELETED,DM),this._events.set(k.CFH_PENDING_CALLS,MM),this._events.set(k.CFH_REPLY,jM),this._events.set(k.CFH_RESULT_MESSAGE,LM),this._events.set(k.GUIDE_ON_DUTY_STATUS,PM),this._events.set(k.GUIDE_SESSION_ATTACHED,UM),this._events.set(k.GUIDE_SESSION_DETACHED,wM),this._events.set(k.GUIDE_SESSION_ENDED,RC),this._events.set(k.GUIDE_SESSION_ERROR,xC),this._events.set(k.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM,FM),this._events.set(k.GUIDE_SESSION_MESSAGE,kM),this._events.set(k.GUIDE_SESSION_PARTNER_IS_TYPING,GM),this._events.set(k.GUIDE_SESSION_REQUESTER_ROOM,BM),this._events.set(k.GUIDE_SESSION_STARTED,OC),this._events.set(k.GUIDE_TICKET_CREATION_RESULT,Uq),this._events.set(k.GUIDE_TICKET_RESOLUTION,wq),this._events.set(k.GUIDE_REPORTING_STATUS,Pq),this._events.set(k.HOTEL_MERGE_NAME_CHANGE,Fq),this._events.set(k.ISSUE_CLOSE_NOTIFICATION,VM),this._events.set(k.QUIZ_DATA,kq),this._events.set(k.QUIZ_RESULTS,Gq),this._events.set(k.CHAT_REVIEW_SESSION_DETACHED,yq),this._events.set(k.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE,Dq),this._events.set(k.CHAT_REVIEW_SESSION_RESULTS,Mq),this._events.set(k.CHAT_REVIEW_SESSION_STARTED,jq),this._events.set(k.CHAT_REVIEW_SESSION_VOTING_STATUS,Lq),this._events.set(k.ACHIEVEMENT_PROGRESSED,HM),this._events.set(k.ACHIEVEMENT_LIST,WM),this._events.set(k.USER_ACHIEVEMENT_SCORE,YM),this._events.set(k.USER_EFFECT_ACTIVATE,Bq),this._events.set(k.USER_EFFECT_LIST_ADD,Vq),this._events.set(k.USER_EFFECT_LIST_REMOVE,Hq),this._events.set(k.USER_EFFECT_LIST,Yq),this._events.set(k.AVATAR_EFFECT_SELECTED,Wq),this._events.set(k.USER_BADGES,KM),this._events.set(k.USER_BADGES_ADD,zM),this._events.set(k.BADGE_POINT_LIMITS,CC),this._events.set(k.BADGE_REQUEST_FULFILLED,zq),this._events.set(k.USER_CLOTHING,qM),this._events.set(k.USER_FURNITURE_ADD,NC),this._events.set(k.USER_FURNITURE,qf),this._events.set(k.USER_FURNITURE_REFRESH,XM),this._events.set(k.USER_FURNITURE_REMOVE,AC),this._events.set(k.USER_FURNITURE_POSTIT_PLACED,$M),this._events.set(k.USER_PETS,ZM),this._events.set(k.USER_PET_REMOVE,t0),this._events.set(k.USER_PET_ADD,JM),this._events.set(k.PET_RECEIVED,e0),this._events.set(k.PET_PLACING_ERROR,nj),this._events.set(k.YOUTUBE_CONTROL_VIDEO,Vj),this._events.set(k.YOUTUBE_DISPLAY_PLAYLISTS,Hj),this._events.set(k.YOUTUBE_DISPLAY_VIDEO,Wj),this._events.set(k.TRADE_ACCEPTED,s0),this._events.set(k.TRADE_CLOSED,i0),this._events.set(k.TRADE_COMPLETED,r0),this._events.set(k.TRADE_CONFIRMATION,n0),this._events.set(k.TRADE_LIST_ITEM,a0),this._events.set(k.TRADE_NOT_OPEN,o0),this._events.set(k.TRADE_OPEN_FAILED,c0),this._events.set(k.TRADE_OPEN,l0),this._events.set(k.TRADE_OTHER_NOT_ALLOWED,u0),this._events.set(k.TRADE_YOU_NOT_ALLOWED,h0),this._events.set(k.TRADE_NO_SUCH_ITEM,$q),this._events.set(k.COMMUNITY_GOAL_VOTE_EVENT,Qq),this._events.set(k.PROMO_ARTICLES,d0),this._events.set(k.MARKETPLACE_AFTER_ORDER_STATUS,_0),this._events.set(k.MARKETPLACE_CANCEL_SALE,g0),this._events.set(k.MARKETPLACE_SELL_ITEM,Jq),this._events.set(k.MARKETPLACE_CONFIG,m0),this._events.set(k.MARKETPLACE_ITEM_STATS,f0),this._events.set(k.MARKETPLACE_ITEM_POSTED,p0),this._events.set(k.MARKETPLACE_ITEMS_SEARCHED,E0),this._events.set(k.MARKETPLACE_OWN_ITEMS,I0),this._events.set(k.USER_BANNED,j0),this._events.set(k.MODERATION_CAUTION,C0),this._events.set(k.MODTOOL_ROOM_INFO,b0),this._events.set(k.MODTOOL_USER_CHATLOG,L0),this._events.set(k.MODTOOL_ROOM_CHATLOG,D0),this._events.set(k.MODERATION_USER_INFO,y0),this._events.set(k.MODERATION_TOOL,N0),this._events.set(k.MODTOOL_VISITED_ROOMS_USER,M0),this._events.set(k.CFH_CHATLOG,T0),this._events.set(k.ISSUE_DELETED,S0),this._events.set(k.ISSUE_INFO,R0),this._events.set(k.ISSUE_PICK_FAILED,x0),this._events.set(k.MODERATOR_ACTION_RESULT,O0),this._events.set(k.MODERATOR_MESSAGE,A0),this._events.set(k.MODERATOR_TOOL_PREFERENCES,v0),this._events.set(k.MYSTERY_BOX_KEYS,w0),this._events.set(k.GOTMYSTERYBOXPRIZEMESSAGE,U0),this._events.set(k.CANCELMYSTERYBOXWAITMESSAGE,P0),this._events.set(k.SHOWMYSTERYBOXWAITMESSAGE,F0),this._events.set(k.CAN_CREATE_ROOM,Zq),this._events.set(k.CAN_CREATE_ROOM_EVENT,k0),this._events.set(k.CATEGORIES_WITH_VISITOR_COUNT,e9),this._events.set(k.COMPETITION_ROOMS_DATA,t9),this._events.set(k.CONVERTED_ROOM_ID,s9),this._events.set(k.ROOM_DOORBELL,bC),this._events.set(k.USER_FAVORITE_ROOM,i9),this._events.set(k.USER_FAVORITE_ROOM_COUNT,G0),this._events.set(k.ROOM_DOORBELL_REJECTED,Xf),this._events.set(k.ROOM_CREATED,B0),this._events.set(k.ROOM_INFO,bl),this._events.set(k.GUEST_ROOM_SEARCH_RESULT,r9),this._events.set(k.USER_HOME_ROOM,V0),this._events.set(k.ROOM_EVENT_CANCEL,u9),this._events.set(k.ROOM_EVENT,z0),this._events.set(k.ROOM_INFO_UPDATED,q0),this._events.set(k.THUMBNAIL_UPDATE_RESULT,h9),this._events.set(k.NAVIGATOR_EVENT_CATEGORIES,X0),this._events.set(k.NAVIGATOR_CATEGORIES,$0),this._events.set(k.NAVIGATOR_COLLAPSED,n9),this._events.set(k.NAVIGATOR_LIFTED,a9),this._events.set(k.NAVIGATOR_METADATA,H0),this._events.set(k.NAVIGATOR_OPEN_ROOM_CREATOR,W0),this._events.set(k.NAVIGATOR_SEARCHES,o9),this._events.set(k.NAVIGATOR_SEARCH,Y0),this._events.set(k.NAVIGATOR_SETTINGS,l9),this._events.set(k.GENERIC_ALERT,tj),this._events.set(k.CUSTOM_ALERT_CONFIRM,lj),this._events.set(k.MOTD_MESSAGES,ij),this._events.set(k.NOTIFICATION_LIST,yC),this._events.set(k.UNSEEN_ITEMS,oj),this._events.set(k.ACHIEVEMENT_NOTIFICATION,Q0),this._events.set(k.INFO_FEED_ENABLE,sj),this._events.set(k.CLUB_GIFT_NOTIFICATION,Z0),this._events.set(k.ACTIVITY_POINT_NOTIFICATION,vC),this._events.set(k.BOT_ERROR,J0),this._events.set(k.PET_LEVEL_NOTIFICATION,rj),this._events.set(k.NOTIFICATION_OFFER_REWARD_DELIVERED,_9),this._events.set(k.NOTIFICATION_SIMPLE_ALERT,aj),this._events.set(k.NOTIFICATION_ELEMENT_POINTER,d9),this._events.set(k.USER_PERKS,DC),this._events.set(k.PET_TRAINING_PANEL,_j),this._events.set(k.PET_LEVEL_UPDATE,hj),this._events.set(k.PET_SCRATCH_FAILED,dj),this._events.set(k.PET_OPEN_PACKAGE_REQUESTED,cj),this._events.set(k.PET_OPEN_PACKAGE_RESULT,uj),this._events.set(k.PET_BREEDING_RESULT,Kj),this._events.set(k.QUESTION,Ej),this._events.set(k.POLL_CONTENTS,gj),this._events.set(k.POLL_ERROR,mj),this._events.set(k.POLL_OFFER,fj),this._events.set(k.POLL_START_ROOM,Sj),this._events.set(k.QUESTION_ANSWERED,pj),this._events.set(k.QUESTION_FINISHED,Ij),this._events.set(k.POLL_ROOM_RESULT,Tj),this._events.set(k.COMMUNITY_GOAL_EARNED_PRIZES,x9),this._events.set(k.COMMUNITY_GOAL_PROGRESS,O9),this._events.set(k.CONCURRENT_USERS_GOAL_PROGRESS,C9),this._events.set(k.QUEST_DAILY,A9),this._events.set(k.QUEST_CANCELLED,xj),this._events.set(k.QUEST_COMPLETED,Oj),this._events.set(k.COMMUNITY_GOAL_HALL_OF_FAME,Rj),this._events.set(k.EPIC_POPUP,N9),this._events.set(k.SEASONAL_QUESTS,b9),this._events.set(k.QUESTS,Nj),this._events.set(k.QUEST,Cj),this._events.set(k.ROOM_ENTER_ERROR,Aj),this._events.set(k.ROOM_ENTER,Jf),this._events.set(k.ROOM_FORWARD,bj),this._events.set(k.ROOM_DOORBELL_ACCEPTED,$f),this._events.set(k.ROOM_RIGHTS_CLEAR,MR),this._events.set(k.ROOM_RIGHTS_OWNER,jR),this._events.set(k.ROOM_RIGHTS,Qf),this._events.set(k.BOT_COMMAND_CONFIGURATION,vj),this._events.set(k.BOT_SKILL_LIST_UPDATE,y9),this._events.set(k.BOT_FORCE_OPEN_CONTEXT_MENU,v9),this._events.set(k.ROOM_SETTINGS_CHAT,yj),this._events.set(k.ROOM_INFO_OWNER,MC),this._events.set(k.ROOM_SCORE,Dj),this._events.set(k.ROOM_ROLLING,PR),this._events.set(k.FURNITURE_FLOOR_ADD,wR),this._events.set(k.FURNITURE_FLOOR,FR),this._events.set(k.FURNITURE_FLOOR_REMOVE,GR),this._events.set(k.FURNITURE_FLOOR_OPACITY,kR),this._events.set(k.FURNITURE_FLOOR_UPDATE,BR),this._events.set(k.ITEM_WALL_ADD,zR),this._events.set(k.ITEM_WALL,KR),this._events.set(k.ITEM_WALL_REMOVE,qR),this._events.set(k.ITEM_WALL_UPDATE,XR),this._events.set(k.FURNITURE_ALIASES,VR),this._events.set(k.FURNITURE_DATA,HR),this._events.set(k.FURNITURE_ITEMDATA,WR),this._events.set(k.ITEM_STACK_HELPER,Lj),this._events.set(k.ONE_WAY_DOOR_STATUS,YR),this._events.set(k.ITEM_DIMMER_SETTINGS,Bj),this._events.set(k.FURNITURE_STATE_2,UR),this._events.set(k.LOVELOCK_FURNI_FINISHED,Uj),this._events.set(k.LOVELOCK_FURNI_FRIEND_COMFIRMED,wj),this._events.set(k.LOVELOCK_FURNI_START,Fj),this._events.set(k.OBJECTS_DATA_UPDATE,LR),this._events.set(k.FURNITURE_GROUP_CONTEXT_MENU_INFO,Pj),this._events.set(k.FURNITURE_POSTIT_STICKY_POLE_OPEN,Gj),this._events.set(k.ROOM_SPECTATOR,Jj),this._events.set(k.CUSTOM_USER_NOTIFICATION,jj),this._events.set(k.ROOM_MESSAGE_NOTIFICATION,L9),this._events.set(k.ROOM_POPULAR_TAGS_RESULT,c9),this._events.set(k.ROOM_RIGHTS_LIST,gL),this._events.set(k.ROOM_WITHOUT_RIGHTS_LIST,pL),this._events.set(k.ROOM_RIGHTS_LIST_ADD,dL),this._events.set(k.ROOM_RIGHTS_LIST_REMOVE,_L),this._events.set(k.ROOM_BAN_LIST,hL),this._events.set(k.ROOM_SETTINGS_SAVE_ERROR,fL),this._events.set(k.ROOM_SETTINGS,mL),this._events.set(k.ROOM_SETTINGS_SAVE,H9),this._events.set(k.ROOM_SETTINGS_ERROR,V9),this._events.set(k.SHOW_ENFORCE_ROOM_CATEGORY,W9),this._events.set(k.ROOM_BAN_REMOVE,Y9),this._events.set(k.ROOM_MUTED,G9),this._events.set(k.NO_SUCH_FLAT,B9),this._events.set(k.FAVORITE_GROUP_UDPATE,Mj),this._events.set(k.ROOM_MODEL_DOOR,ep),this._events.set(k.ROOM_HEIGHT_MAP,$R),this._events.set(k.ROOM_HEIGHT_MAP_UPDATE,QR),this._events.set(k.ROOM_MODEL,Zf),this._events.set(k.ROOM_MODEL_NAME,jd),this._events.set(k.ROOM_PAINT,JR),this._events.set(k.ROOM_THICKNESS,tp),this._events.set(k.ROOM_GET_FILTER_WORDS,K0),this._events.set(k.ROOM_MODEL_BLOCKED_TILES,zj),this._events.set(k.PET_FIGURE_UPDATE,sp),this._events.set(k.PET_INFO,Xj),this._events.set(k.PET_STATUS,$j),this._events.set(k.PET_EXPERIENCE,qj),this._events.set(k.PLAYING_GAME,Qj),this._events.set(k.UNIT_DANCE,np),this._events.set(k.UNIT_EFFECT,ex),this._events.set(k.UNIT,ap),this._events.set(k.UNIT_EXPRESSION,tx),this._events.set(k.UNIT_HAND_ITEM,sx),this._events.set(k.UNIT_IDLE,ix),this._events.set(k.UNIT_INFO,op),this._events.set(k.UNIT_NUMBER,rx),this._events.set(k.UNIT_REMOVE,lp),this._events.set(k.UNIT_STATUS,nx),this._events.set(k.HAND_ITEM_RECEIVED,tL),this._events.set(k.FLOOD_CONTROL,Zj),this._events.set(k.REMAINING_MUTE,eL),this._events.set(k.UNIT_CHAT,jC),this._events.set(k.UNIT_CHAT_SHOUT,ip),this._events.set(k.UNIT_CHAT_WHISPER,rp),this._events.set(k.UNIT_TYPING,ZR),this._events.set(k.WIRED_ACTION,sL),this._events.set(k.WIRED_CONDITION,iL),this._events.set(k.WIRED_TRIGGER,rL),this._events.set(k.WIRED_OPEN,U9),this._events.set(k.WIRED_REWARD,ax),this._events.set(k.WIRED_SAVE,nL),this._events.set(k.WIRED_ERROR,w9),this._events.set(k.WIRED_CLICK_USER,cL),this._events.set(k.WIRED_ENVIRONMENT,uL),this._events.set(k.AUTHENTICATED,EL),this._events.set(k.JUKEBOX_PLAYLIST_FULL,IL),this._events.set(k.JUKEBOX_SONG_DISKS,TL),this._events.set(k.NOW_PLAYING,SL),this._events.set(k.OFFICIAL_SONG_ID,RL),this._events.set(k.PLAYLIST,z9),this._events.set(k.PLAYLIST_SONG_ADDED,K9),this._events.set(k.TRAX_SONG_INFO,xL),this._events.set(k.USER_SONG_DISKS_INVENTORY,OL),this._events.set(k.HELPER_TALENT_TRACK,$9),this._events.set(k.TALENT_TRACK_LEVEL,X9),this._events.set(k.TALENT_TRACK_LEVEL_UP,q9),this._events.set(k.IN_CLIENT_LINK,kL),this._events.set(k.USER_IGNORED,FL),this._events.set(k.USER_IGNORED_RESULT,GC),this._events.set(k.USER_RESPECT,VC),this._events.set(k.USER_KISS,BC),this._events.set(k.SET_KISSES_LEFT,HC),this._events.set(k.USER_PERMISSIONS,PC),this._events.set(k.USER_BADGES_CURRENT,wC),this._events.set(k.USER_INFO,Ld),this._events.set(k.UNIT_CHANGE_NAME,cT),this._events.set(k.USER_SETTINGS,uT),this._events.set(k.USER_PROFILE,jL),this._events.set(k.MESSENGER_RELATIONSHIPS,UC),this._events.set(k.GIFT_OPENED,QM),this._events.set(k.USER_CREDITS,GL),this._events.set(k.USER_CURRENCY,BL),this._events.set(k.USER_SUBSCRIPTION,VL),this._events.set(k.USER_WARDROBE_PAGE,KL),this._events.set(k.USER_WARDROBE_PAGES,qL),this._events.set(k.USER_CLASSIFICATION,aX),this._events.set(k.GET_USER_TAGS,FC),this._events.set(k.SCR_SEND_KICKBACK_INFO,YL),this._events.set(k.PET_RESPECTED,HL),this._events.set(k.PET_SUPPLEMENT,WL),this._events.set(k.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE,yL),this._events.set(k.SET_PLAYER_BALANCE,$L),this._events.set(k.GENERIC_ERROR,Kf),this._events.set(k.GROUP_LIST,kC),this._events.set(k.CATALOG_APPROVE_NAME_RESULT,DL),this._events.set(k.CONNECTION_ERROR,ej),this._events.set(k.GUILD_EDIT_FAILED,eX),this._events.set(k.GUILD_MEMBER_MGMT_FAILED,tX),this._events.set(k.EXTENDED_PROFILE_CHANGED,PL),this._events.set(k.NOOBNESS_LEVEL,vM),this._events.set(k.DISCONNECT_REASON,Aq),this._events.set(k.HANDSHAKE_INIT_DIFFIE,vq),this._events.set(k.HANDSHAKE_COMPLETE_DIFFIE,Nq),this._events.set(k.HANDSHAKE_IDENTITY_ACCOUNT,bq),this._events.set(k.NEW_USER_EXPERIENCE_GIFT_OFFER,I9),this._events.set(k.NEW_USER_EXPERIENCE_NOT_COMPLETE,S9),this._events.set(k.RESTORE_CLIENT,g9),this._events.set(k.FIREWORK_CHARGE_DATA,j7),this._events.set(k.PHONE_COLLECTION_STATE,xq),this._events.set(k.PHONE_TRY_NUMBER_RESULT,Oq),this._events.set(k.PHONE_TRY_VERIFICATION_CODE_RESULT,Cq),this._events.set(k.WELCOME_GIFT_CHANGE_EMAIL_RESULT,nX),this._events.set(k.WELCOME_GIFT_STATUS,P9),this._events.set(k.RENTABLE_SPACE_RENT_OK,j9),this._events.set(k.RENTABLE_SPACE_STATUS,kj),this._events.set(k.RENTABLE_SPACE_RENT_FAILED,M9),this._events.set(k.RECYCLER_STATUS,DR),this._events.set(k.RECYCLER_FINISHED,yR),this._events.set(k.EMAIL_STATUS,LL),this._events.set(k.CHANGE_EMAIL_RESULT,Q9),this._events.set(k.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER,D9),this._events.set(k.SHOW_TELEPORTS_MENU,rX),this._events.set(k.WIRED_ADDON_DATA_EVENT,Pk),this._events.set(k.WIRED_SELECTOR_DATA_EVENT,Uk),this._events.set(k.WIRED_VARIABLE_DATA_EVENT,lL),this._events.set(k.WIRED_MOVEMENTS,aL),this._events.set(k.OPEN_PINCEL,$F),this._events.set(k.ADD_ALERT,qF),this._events.set(k.OPEN_ROOM_VIDEO,QF),this._events.set(k.SEND_SOUND,JF),this._events.set(k.GET_PINCEL_SELECTED_COLORS,XF),this._events.set(k.STORE_OFFER_LIST,ek),this._events.set(k.STORE_UPDATE,QL),this._events.set(k.VIP_TIMESTAMP,WC),this._events.set(k.HIDE_AREA,Kx),this._events.set(k.REMOVE_MULTIPLE_FURNI_ITEMS,qx),this._events.set(k.WIRED_ALL_VARIABLES_DIFFS,oL),this._events.set(k.WIRED_ALL_VARIABLES_HASH,Hk),this._events.set(k.USER_HEIGHT_MAP_UPDATE,zL),this._events.set(k.HOTEL_COMMANDS,wL),this._events.set(k.WIRED_MUSICS_DATA,vL),this._events.set(k.SOUND_EFFECTS_DATA,AL),this._events.set(k.PLAY_WIRED_MUSIC,CL),this._events.set(k.PLAY_WIRED_SOUND_EFFECT,NL),this._events.set(k.STOP_ALL_WIRED_SONG,bL),this._events.set(k.HIGHSCORE_VARIABLE,Yj),this._events.set(k.WIRED_ALL_VARIABLE_HOLDERS,Wk),this._events.set(k.WIRED_VARIABLES_FOR_OBJECT,Yk),this._events.set(k.WIRED_ERROR_LOGS,zk),this._events.set(k.WIRED_MENU_ERROR_EVENT,UJ),this._events.set(k.WIRED_PERMISSIONS,Kk),this._events.set(k.WIRED_ROOM_SETTINGS,qk),this._events.set(k.WIRED_ROOM_STATS,Xk)}registerComposers(){this._composers.set(P.AUTHENTICATION,g8),this._composers.set(P.INTERSTITIAL_SHOWN,cX),this._composers.set(P.GET_INTERSTITIAL,lX),this._composers.set(P.GET_WARDROBE,hX),this._composers.set(P.GET_WARDROBE_PAGES,oP),this._composers.set(P.SAVE_WARDROBE_OUTFIT,cx),this._composers.set(P.CHANGE_USERNAME,nP),this._composers.set(P.CHECK_USERNAME,aP),this._composers.set(P.CHANGE_BACKGROUND_PROFILE,rP),this._composers.set(P.REQUEST_CAMERA_CONFIGURATION,sP),this._composers.set(P.RENDER_ROOM,Bg),this._composers.set(P.RENDER_ROOM_THUMBNAIL,lx),this._composers.set(P.PURCHASE_PHOTO,tP),this._composers.set(P.EDIT_PHOTO_CAPTION,iP),this._composers.set(P.PUBLISH_PHOTO,eP),this._composers.set(P.PHOTO_COMPETITION,uX),this._composers.set(P.OPEN_CAMPAIGN_CALENDAR_DOOR,cP),this._composers.set(P.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF,lP),this._composers.set(P.OPEN_CAMPAIGN_CALENDAR_DOOR_VIP,hP),this._composers.set(P.OPEN_CAMPAIGN_CALENDAR_DOOR_VIP_STAFF,uP),this._composers.set(P.NATAL_CAMPAIGN_STATS,KF),this._composers.set(P.NATAL_CAMPAIGN_IMPULSE,zF),this._composers.set(P.BUILDERS_CLUB_PLACE_ROOM_ITEM,YC),this._composers.set(P.BUILDERS_CLUB_PLACE_WALL_ITEM,zC),this._composers.set(P.BUILDERS_CLUB_QUERY_FURNI_COUNT,dP),this._composers.set(P.GET_CATALOG_INDEX,gP),this._composers.set(P.GET_CATALOG_PAGE,mP),this._composers.set(P.CATALOG_PURCHASE,hT),this._composers.set(P.CATALOG_PURCHASE_GIFT,SP),this._composers.set(P.GET_PRODUCT_OFFER,EP),this._composers.set(P.GET_CLUB_OFFERS,fP),this._composers.set(P.GET_CLUB_GIFT_INFO,KC),this._composers.set(P.CATALOG_REDEEM_VOUCHER,OP),this._composers.set(P.GROUP_MEMBERSHIPS,pm),this._composers.set(P.GET_GIFT_WRAPPING_CONFIG,pP),this._composers.set(P.CATALOG_SELECT_VIP_GIFT,CP),this._composers.set(P.CATALOG_REQUESET_PET_BREEDS,TP),this._composers.set(P.GET_BONUS_RARE_INFO,_P),this._composers.set(P.GET_BUNDLE_DISCOUNT_RULESET,dX),this._composers.set(P.GET_CATALOG_PAGE_EXPIRATION,_X),this._composers.set(P.GET_CATALOG_PAGE_WITH_EARLIEST_EXP,gX),this._composers.set(P.GET_DIRECT_CLUB_BUY_AVAILABLE,mX),this._composers.set(P.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER,fX),this._composers.set(P.GET_HABBO_CLUB_EXTEND_OFFER,pX),this._composers.set(P.GET_IS_OFFER_GIFTABLE,EX),this._composers.set(P.GET_LIMITED_OFFER_APPEARING_NEXT,IX),this._composers.set(P.GET_NEXT_TARGETED_OFFER,TX),this._composers.set(P.GET_ROOM_AD_PURCHASE_INFO,IP),this._composers.set(P.GET_SEASONAL_CALENDAR_DAILY_OFFER,SX),this._composers.set(P.GET_TARGETED_OFFER,qC),this._composers.set(P.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED,RX),this._composers.set(P.PURCHASE_BASIC_MEMBERSHIP_EXTENSION,xX),this._composers.set(P.PURCHASE_ROOM_AD,RP),this._composers.set(P.PURCHASE_TARGETED_OFFER,xP),this._composers.set(P.PURCHASE_VIP_MEMBERSHIP_EXTENSION,OX),this._composers.set(P.ROOM_AD_PURCHASE_INITIATED,CX),this._composers.set(P.SET_TARGETTED_OFFER_STATE,NX),this._composers.set(P.SHOP_TARGETED_OFFER_VIEWED,AX),this._composers.set(P.FORWARD_TO_A_COMPETITION_ROOM,bX),this._composers.set(P.FORWARD_TO_A_SUBMITTABLE_ROOM,vX),this._composers.set(P.FORWARD_TO_RANDOM_COMPETITION_ROOM,yX),this._composers.set(P.GET_CURRENT_TIMING_CODE,DX),this._composers.set(P.GET_IS_USER_PART_OF_COMPETITION,MX),this._composers.set(P.GET_SECONDS_UNTIL,jX),this._composers.set(P.ROOM_COMPETITION_INIT,LX),this._composers.set(P.SUBMIT_ROOM_TO_COMPETITION,ux),this._composers.set(P.VOTE_FOR_ROOM,PX),this._composers.set(P.CRAFT,NP),this._composers.set(P.CRAFT_SECRET,UX),this._composers.set(P.GET_CRAFTABLE_PRODUCTS,bP),this._composers.set(P.GET_CRAFTING_RECIPE,AP),this._composers.set(P.GET_CRAFTING_RECIPES_AVAILABLE,wX),this._composers.set(P.FRIEND_FURNI_CONFIRM_LOCK,yP),this._composers.set(P.ACCEPT_FRIEND,hx),this._composers.set(P.DECLINE_FRIEND,dx),this._composers.set(P.FIND_NEW_FRIENDS,FX),this._composers.set(P.FOLLOW_FRIEND,dT),this._composers.set(P.FRIEND_LIST_UPDATE,DP),this._composers.set(P.GET_FRIEND_REQUESTS,MP),this._composers.set(P.HABBO_SEARCH,jP),this._composers.set(P.MESSENGER_INIT,LP),this._composers.set(P.REMOVE_FRIEND,PP),this._composers.set(P.REQUEST_FRIEND,XC),this._composers.set(P.MESSENGER_CHAT,UP),this._composers.set(P.SEND_ROOM_INVITE,wP),this._composers.set(P.SET_RELATIONSHIP_STATUS,Kc),this._composers.set(P.VISIT_USER,kX),this._composers.set(P.ADD_TO_GROUP_WHISPER,Fk),this._composers.set(P.ACHIEVEMENT_RESOLUTION_OPEN,VP),this._composers.set(P.ACCEPTGAMEINVITE,YX),this._composers.set(P.GAMEUNLOADEDMESSAGE,zX),this._composers.set(P.GETGAMEACHIEVEMENTSMESSAGE,KX),this._composers.set(P.GAMES_LIST,GP),this._composers.set(P.GETGAMESTATUSMESSAGE,BP),this._composers.set(P.GETUSERGAMEACHIEVEMENTSMESSAGE,qX),this._composers.set(P.JOINQUEUEMESSAGE,HP),this._composers.set(P.LEAVEQUEUEMESSAGE,XX),this._composers.set(P.RESETRESOLUTIONACHIEVEMENTMESSAGE,$X),this._composers.set(P.GAMES_INIT,ZX),this._composers.set(P.GETWEEKLYGAMEREWARDWINNERS,e8),this._composers.set(P.GAME2GETACCOUNTGAMESTATUSMESSAGE,kP),this._composers.set(P.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE,HX),this._composers.set(P.GAME2EXITGAMEMESSAGE,FP),this._composers.set(P.GAME2GAMECHATMESSAGE,GX),this._composers.set(P.GAME2LOADSTAGEREADYMESSAGE,BX),this._composers.set(P.GAME2PLAYAGAINMESSAGE,VX),this._composers.set(P.GAME2REQUESTFULLSTATUSUPDATEMESSAGE,WX),this._composers.set(P.GAME2GETWEEKLYFRIENDSLEADERBOARD,QX),this._composers.set(P.GAME2GETWEEKLYLEADERBOARD,JX),this._composers.set(P.GET_GIFT,_x),this._composers.set(P.RESET_PHONE_NUMBER_STATE,t8),this._composers.set(P.SET_PHONE_NUMBER_VERIFICATION_STATUS,gx),this._composers.set(P.TRY_PHONE_NUMBER,s8),this._composers.set(P.VERIFY_CODE,i8),this._composers.set(P.GET_FORUM_STATS,oU),this._composers.set(P.GET_FORUMS_LIST,n8),this._composers.set(P.GET_FORUM_MESSAGES,a8),this._composers.set(P.GET_FORUM_THREAD,o8),this._composers.set(P.GET_FORUM_THREADS,lU),this._composers.set(P.GET_UNREAD_FORUMS_COUNT,l8),this._composers.set(P.FORUM_MODERATE_MESSAGE,c8),this._composers.set(P.FORUM_MODERATE_THREAD,u8),this._composers.set(P.FORUM_POST_MESSAGE,h8),this._composers.set(P.UPDATE_FORUM_READ_MARKER,cU),this._composers.set(P.UPDATE_FORUM_SETTINGS,d8),this._composers.set(P.FORUM_UPDATE_THREAD,_8),this._composers.set(P.CLIENT_PONG,dU),this._composers.set(P.CLIENT_LATENCY,gU),this._composers.set(P.CLIENT_LATENCY_MEASURE,mU),this._composers.set(P.RELEASE_VERSION,uU),this._composers.set(P.SECURITY_TICKET,_U),this._composers.set(P.USER_INFO,hU),this._composers.set(P.DISCONNECT,f8),this._composers.set(P.SECURITY_MACHINE,E8),this._composers.set(P.CLIENT_VARIABLES,I8),this._composers.set(P.HANDSHAKE_INIT_DIFFIE,p8),this._composers.set(P.HANDSHAKE_COMPLETE_DIFFIE,m8),this._composers.set(P.CALL_FOR_HELP_FROM_FORUM_MESSAGE,fU),this._composers.set(P.CALL_FOR_HELP_FROM_FORUM_THREAD,pU),this._composers.set(P.CALL_FOR_HELP_FROM_IM,EU),this._composers.set(P.CALL_FOR_HELP_FROM_PHOTO,IU),this._composers.set(P.CALL_FOR_HELP_FROM_SELFIE,T8),this._composers.set(P.CALL_FOR_HELP,TU),this._composers.set(P.CHAT_REVIEW_GUIDE_DECIDES,S8),this._composers.set(P.CHAT_REVIEW_GUIDE_DETACHED,R8),this._composers.set(P.CHAT_REVIEW_GUIDE_VOTE,x8),this._composers.set(P.CHAT_REVIEW_SESSION_CREATE,O8),this._composers.set(P.DELETE_PENDING_CALLS_FOR_HELP,SU),this._composers.set(P.GET_CFH_STATUS,RU),this._composers.set(P.GET_FAQ_CATEGORY,C8),this._composers.set(P.GET_FAQ_TEXT,N8),this._composers.set(P.GET_GUIDE_REPORTING_STATUS,A8),this._composers.set(P.GET_PENDING_CALLS_FOR_HELP,xU),this._composers.set(P.GET_QUIZ_QUESTIONS,b8),this._composers.set(P.GUIDE_SESSION_CREATE,OU),this._composers.set(P.GUIDE_SESSION_FEEDBACK,CU),this._composers.set(P.GUIDE_SESSION_GET_REQUESTER_ROOM,NU),this._composers.set(P.GUIDE_SESSION_GUIDE_DECIDES,AU),this._composers.set(P.GUIDE_SESSION_INVITE_REQUESTER,bU),this._composers.set(P.GUIDE_SESSION_IS_TYPING,v8),this._composers.set(P.GUIDE_SESSION_MESSAGE,vU),this._composers.set(P.GUIDE_SESSION_ON_DUTY_UPDATE,fx),this._composers.set(P.GUIDE_SESSION_REPORT,y8),this._composers.set(P.GUIDE_SESSION_REQUESTER_CANCELS,yU),this._composers.set(P.GUIDE_SESSION_RESOLVED,DU),this._composers.set(P.POST_QUIZ_ANSWERS,D8),this._composers.set(P.SEARCH_FAQS,M8),this._composers.set(P.DESKTOP_VIEW,vP),this._composers.set(P.GROUP_INFO,Pd),this._composers.set(P.GROUP_REQUEST,JP),this._composers.set(P.GROUP_MEMBER_REMOVE_CONFIRM,XP),this._composers.set(P.GROUP_MEMBER_REMOVE,_T),this._composers.set(P.GROUP_MEMBERS,mx),this._composers.set(P.GROUP_ADMIN_ADD,WP),this._composers.set(P.GROUP_ADMIN_REMOVE,YP),this._composers.set(P.GROUP_REQUEST_ACCEPT,ZP),this._composers.set(P.GROUP_REQUEST_DECLINE,eU),this._composers.set(P.GROUP_DELETE,$P),this._composers.set(P.GROUP_CREATE_OPTIONS,qP),this._composers.set(P.GROUP_PARTS,zP),this._composers.set(P.GROUP_BUY,KP),this._composers.set(P.GROUP_SETTINGS,nU),this._composers.set(P.GROUP_SAVE_BADGE,tU),this._composers.set(P.GROUP_SAVE_COLORS,sU),this._composers.set(P.GROUP_SAVE_INFORMATION,iU),this._composers.set(P.GROUP_SAVE_PREFERENCES,rU),this._composers.set(P.GROUP_FAVORITE,QP),this._composers.set(P.GROUP_UNFAVORITE,aU),this._composers.set(P.GROUP_BADGES,pF),this._composers.set(P.APPROVE_ALL_MEMBERSHIP_REQUESTS,r8),this._composers.set(P.GROUP_UNBLOCK_MEMBER,nQ),this._composers.set(P.ROOM_FAVORITE,ZC),this._composers.set(P.CAN_CREATE_ROOM,q8),this._composers.set(P.CANCEL_ROOM_EVENT,K8),this._composers.set(P.CONVERT_GLOBAL_ROOM_ID,_1),this._composers.set(P.COMPETITION_ROOM_SEARCH,X8),this._composers.set(P.ROOM_CREATE,g1),this._composers.set(P.GET_USER_FLAT_CATS,p1),this._composers.set(P.GET_USER_EVENT_CATS,tN),this._composers.set(P.ROOM_FAVORITE_REMOVE,eN),this._composers.set(P.EDIT_ROOM_EVENT,m1),this._composers.set(P.FORWARD_TO_RANDOM_PROMOTED_ROOM,$8),this._composers.set(P.FORWARD_TO_SOME_ROOM,Q8),this._composers.set(P.GET_CATEGORIES_WITH_USER_COUNT,J8),this._composers.set(P.GET_GUEST_ROOM,Vg),this._composers.set(P.GET_OFFICIAL_ROOMS,Z8),this._composers.set(P.GET_POPULAR_ROOM_TAGS,e$),this._composers.set(P.GUILD_BASE_SEARCH,t$),this._composers.set(P.MY_FAVOURITE_ROOMS_SEARCH,s$),this._composers.set(P.MY_FREQUENT_ROOM_HISTORY_SEARCH,i$),this._composers.set(P.MY_FRIENDS_ROOM_SEARCH,r$),this._composers.set(P.MY_GUILD_BASES_SEARCH,n$),this._composers.set(P.MY_RECOMMENDED_ROOMS,a$),this._composers.set(P.MY_ROOM_HISTORY_SEARCH,o$),this._composers.set(P.MY_ROOM_RIGHTS_SEARCH,l$),this._composers.set(P.MY_ROOMS_SEARCH,c$),this._composers.set(P.POPULAR_ROOMS_SEARCH,f$),this._composers.set(P.ROOM_LIKE,I1),this._composers.set(P.ROOM_RIGHTS_REMOVE_OWN,sN),this._composers.set(P.ROOM_AD_EVENT_TAB_CLICKED,p$),this._composers.set(P.ROOM_AD_EVENT_TAB_VIEWED,E$),this._composers.set(P.ROOM_AD_SEARCH,I$),this._composers.set(P.ROOM_TEXT_SEARCH,R$),this._composers.set(P.ROOMS_WHERE_MY_FRIENDS_ARE,T$),this._composers.set(P.ROOMS_WITH_HIGHEST_SCORE_SEARCH,S$),this._composers.set(P.SET_ROOM_SESSION_TAGS,x$),this._composers.set(P.ROOM_STAFF_PICK,T1),this._composers.set(P.ROOM_FILTER_WORDS,f1),this._composers.set(P.ROOM_FILTER_WORDS_MODIFY,S1),this._composers.set(P.USER_HOME_ROOM,iN),this._composers.set(P.UPDATE_ROOM_THUMBNAIL,O$),this._composers.set(P.NAVIGATOR_INIT,E1),this._composers.set(P.NAVIGATOR_SEARCH_CLOSE,d$),this._composers.set(P.NAVIGATOR_SEARCH,Ku),this._composers.set(P.NAVIGATOR_SEARCH_OPEN,_$),this._composers.set(P.NAVIGATOR_SEARCH_SAVE,g$),this._composers.set(P.NAVIGATOR_SETTINGS_SAVE,m$),this._composers.set(P.NAVIGATOR_CATEGORY_LIST_MODE,u$),this._composers.set(P.NAVIGATOR_DELETE_SAVED_SEARCH,h$),this._composers.set(P.POLL_ANSWER,y1),this._composers.set(P.POLL_REJECT,D1),this._composers.set(P.POLL_START,M1),this._composers.set(P.POLL_VOTE_COUNTER,j1),this._composers.set(P.USER_EFFECT_ACTIVATE,j8),this._composers.set(P.USER_EFFECT_ENABLE,L8),this._composers.set(P.USER_BADGES,MU),this._composers.set(P.USER_BADGES_CURRENT_UPDATE,cp),this._composers.set(P.GET_BADGE_POINTS_LIMITS,P8),this._composers.set(P.REQUESTABADGE,w8),this._composers.set(P.GETISBADGEREQUESTFULFILLED,U8),this._composers.set(P.HIDE_BADGE,jU),this._composers.set(P.UNHIDE_BADGE,LU),this._composers.set(P.USER_BOTS,px),this._composers.set(P.USER_FURNITURE,$C),this._composers.set(P.REQUESTFURNIINVENTORYWHENNOTINROOM,F8),this._composers.set(P.CLICK_FURNI,uw),this._composers.set(P.CLICK_AVATAR,hw),this._composers.set(P.CLICK_BOT,Xx),this._composers.set(P.USER_PETS,Ix),this._composers.set(P.TRADE_ACCEPT,PU),this._composers.set(P.TRADE_CANCEL,UU),this._composers.set(P.TRADE_CLOSE,wU),this._composers.set(P.TRADE_CONFIRM,FU),this._composers.set(P.TRADE_ITEM,Tx),this._composers.set(P.TRADE_ITEMS,kU),this._composers.set(P.TRADE_ITEM_REMOVE,GU),this._composers.set(P.TRADE,BU),this._composers.set(P.TRADE_UNACCEPT,VU),this._composers.set(P.UNSEEN_RESET_CATEGORY,HU),this._composers.set(P.UNSEEN_RESET_ITEMS,WU),this._composers.set(P.ACHIEVEMENT_LIST,ZL),this._composers.set(P.PET_MOUNT,xx),this._composers.set(P.PET_RESPECT,gm),this._composers.set(P.PET_SUPPLEMENT,N$),this._composers.set(P.REMOVE_PET_SADDLE,C1),this._composers.set(P.PET_INFO,N1),this._composers.set(P.TOGGLE_PET_BREEDING,A1),this._composers.set(P.TOGGLE_PET_RIDING,b1),this._composers.set(P.USE_PET_PRODUCT,v1),this._composers.set(P.GET_PET_TRAINING_PANEL,O1),this._composers.set(P.PET_OPEN_PACKAGE,lN),this._composers.set(P.PET_SELECTED,z$),this._composers.set(P.PETS_BREED,hp),this._composers.set(P.PET_CANCEL_BREEDING,k8),this._composers.set(P.PET_CONFIRM_BREEDING,G8),this._composers.set(P.ROOM_ENTER,gT),this._composers.set(P.ROOM_DOORBELL,F1),this._composers.set(P.GO_TO_FLAT,jw),this._composers.set(P.CHANGE_QUEUE,Mw),this._composers.set(P.ROOM_AMBASSADOR_ALERT,G1),this._composers.set(P.ROOM_BAN_GIVE,B1),this._composers.set(P.ROOM_BAN_GIVE_BY_NAME,z1),this._composers.set(P.ROOM_BAN_REMOVE,Y1),this._composers.set(P.ROOM_RIGHTS_GIVE,rN),this._composers.set(P.ROOM_KICK,H1),this._composers.set(P.ROOM_MUTE_USER,W1),this._composers.set(P.ROOM_RIGHTS_REMOVE,nN),this._composers.set(P.ROOM_RIGHTS_REMOVE_ALL,k1),this._composers.set(P.ROOM_DELETE,V1),this._composers.set(P.ROOM_SETTINGS,mT),this._composers.set(P.ROOM_SETTINGS_SAVE,X1),this._composers.set(P.ROOM_RIGHTS_LIST,q1),this._composers.set(P.ROOM_BAN_LIST,d_),this._composers.set(P.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE,$$),this._composers.set(P.BOT_CONFIGURATION,K1),this._composers.set(P.GET_ITEM_DATA,Z1),this._composers.set(P.REMOVE_WALL_ITEM,iw),this._composers.set(P.BOT_PLACE,$1),this._composers.set(P.BOT_PICKUP,fT),this._composers.set(P.BOT_SKILL_SAVE,so),this._composers.set(P.PET_PLACE,tw),this._composers.set(P.PET_MOVE,Ox),this._composers.set(P.PET_PICKUP,sw),this._composers.set(P.SET_ITEM_DATA,nw),this._composers.set(P.SET_OBJECT_DATA,aN),this._composers.set(P.COMPOST_PLANT,J1),this._composers.set(P.HARVEST_PET,ew),this._composers.set(P.SET_CLOTHING_CHANGE_DATA,rw),this._composers.set(P.FURNITURE_ALIASES,dw),this._composers.set(P.FURNITURE_GROUP_INFO,_w),this._composers.set(P.FURNITURE_PICKUP,pT),this._composers.set(P.FURNITURE_PLACE,mm),this._composers.set(P.ITEM_PAINT,Sd),this._composers.set(P.FURNITURE_POSTIT_PLACE,ET),this._composers.set(P.FURNITURE_POSTIT_SAVE_STICKY_POLE,aw),this._composers.set(P.CONTROL_YOUTUBE_DISPLAY_PLAYBACK,o_),this._composers.set(P.GET_YOUTUBE_DISPLAY_STATUS,Aw),this._composers.set(P.SET_YOUTUBE_DISPLAY_PLAYLIST,Cx),this._composers.set(P.FURNITURE_FLOOR_UPDATE,Ud),this._composers.set(P.FURNITURE_WALL_UPDATE,fm),this._composers.set(P.ITEM_DIMMER_SETTINGS,ow),this._composers.set(P.ITEM_DIMMER_SAVE,lw),this._composers.set(P.ITEM_DIMMER_TOGGLE,cw),this._composers.set(P.ROOM_TONER_APPLY,Nw),this._composers.set(P.ITEM_COLOR_WHEEL_CLICK,gw),this._composers.set(P.ITEM_DICE_CLICK,mw),this._composers.set(P.ITEM_DICE_CLOSE,fw),this._composers.set(P.FURNITURE_MULTISTATE,ko),this._composers.set(P.FURNITURE_RANDOMSTATE,Iw),this._composers.set(P.ITEM_STACK_HELPER,up),this._composers.set(P.FURNITURE_WALL_MULTISTATE,oN),this._composers.set(P.ONE_WAY_DOOR_CLICK,Ew),this._composers.set(P.ITEM_EXCHANGE_REDEEM,pw),this._composers.set(P.ITEM_CLOTHING_REDEEM,Dw),this._composers.set(P.ROOM_MODEL,Nx),this._composers.set(P.GET_OCCUPIED_TILES,vw),this._composers.set(P.GET_ROOM_ENTRY_TILE,yw),this._composers.set(P.ROOM_MODEL_SAVE,cN),this._composers.set(P.UNIT_ACTION,kw),this._composers.set(P.UNIT_DANCE,Gw),this._composers.set(P.UNIT_DROP_HAND_ITEM,Ax),this._composers.set(P.UNIT_GIVE_HANDITEM,Bw),this._composers.set(P.UNIT_GIVE_HANDITEM_PET,hN),this._composers.set(P.UNIT_LOOK,Vw),this._composers.set(P.UNIT_SIGN,Ww),this._composers.set(P.UNIT_POSTURE,Hw),this._composers.set(P.UNIT_WALK,Yw),this._composers.set(P.UNIT_CHAT,uN),this._composers.set(P.UNIT_CHAT_SHOUT,Lw),this._composers.set(P.USER_SETTINGS_CHAT_STYLE,Pw),this._composers.set(P.UNIT_CHAT_WHISPER,Uw),this._composers.set(P.UNIT_TYPING,ww),this._composers.set(P.UNIT_TYPING_STOP,Fw),this._composers.set(P.WIRED_APPLY_SNAPSHOT,zw),this._composers.set(P.WIRED_OPEN,q$),this._composers.set(P.WIRED_ACTION_SAVE,qw),this._composers.set(P.WIRED_CONDITION_SAVE,Xw),this._composers.set(P.WIRED_TRIGGER_SAVE,$w),this._composers.set(P.ROOM_MUTE,Kw),this._composers.set(P.APPROVE_NAME,fF),this._composers.set(P.USER_RESPECT,SF),this._composers.set(P.USER_KISS,TF),this._composers.set(P.GIVE_STAR_GEM,EF),this._composers.set(P.SCR_GET_KICKBACK_INFO,IF),this._composers.set(P.SHOW_TELEPORTS_MENU,wF),this._composers.set(P.KEY_PRESS,fN),this._composers.set(P.CHANGE_PROFILE_THEME,Vk),this._composers.set(P.CHANGE_PROFILE_IMAGE_POSITION,Bk),this._composers.set(P.GET_PLAYER_BALANCE_LOGS,FF),this._composers.set(P.PEER_USERS_CLASSIFICATION,kF),this._composers.set(P.USER_CLASSIFICATION,GF),this._composers.set(P.USER_IGNORED,RF),this._composers.set(P.USER_IGNORE,xF),this._composers.set(P.USER_IGNORE_ID,OF),this._composers.set(P.USER_UNIGNORE,CF),this._composers.set(P.USER_BADGES_CURRENT,_N),this._composers.set(P.USER_FIGURE,gN),this._composers.set(P.USER_MOTTO,NF),this._composers.set(P.USER_PROFILE,AF),this._composers.set(P.USER_PROFILE_BY_NAME,oQ),this._composers.set(P.USER_TAGS,dN),this._composers.set(P.MESSENGER_RELATIONSHIPS,mN),this._composers.set(P.MANNEQUIN_SAVE_NAME,Sw),this._composers.set(P.MANNEQUIN_SAVE_LOOK,Tw),this._composers.set(P.PRESENT_OPEN_PRESENT,xw),this._composers.set(P.MARKETPLACE_CONFIG,KU),this._composers.set(P.MARKETPLACE_SELL_ITEM,QU),this._composers.set(P.MARKETPLACE_RESELL_ITEM,ZU),this._composers.set(P.MARKETPLACE_REQUEST_OWN_ITEMS,$U),this._composers.set(P.MARKETPLACE_TAKE_BACK_ITEM,zU),this._composers.set(P.MARKETPLACE_REQUEST_OFFERS,XU),this._composers.set(P.MARKETPLACE_BUY_OFFER,Sx),this._composers.set(P.MARKETPLACE_REDEEM_CREDITS,JU),this._composers.set(P.MARKETPLACE_BUY_TOKENS,V8),this._composers.set(P.REQUEST_SELL_ITEM,H8),this._composers.set(P.REQUEST_MARKETPLACE_ITEM_STATS,qU),this._composers.set(P.USER_BOTS,px),this._composers.set(P.USER_PETS,Ix),this._composers.set(P.USER_CURRENCY,vF),this._composers.set(P.USER_SUBSCRIPTION,bx),this._composers.set(P.MODTOOL_REQUEST_ROOM_INFO,s1),this._composers.set(P.MODTOOL_CHANGE_ROOM_SETTINGS,Rx),this._composers.set(P.MODTOOL_REQUEST_USER_CHATLOG,a1),this._composers.set(P.MODTOOL_REQUEST_ROOM_CHATLOG,r1),this._composers.set(P.MOD_TOOL_USER_INFO,i1),this._composers.set(P.MODTOOL_SANCTION_ALERT,o1),this._composers.set(P.MODTOOL_SANCTION_BAN,Fo),this._composers.set(P.MODTOOL_SANCTION_KICK,l1),this._composers.set(P.MODTOOL_SANCTION_TRADELOCK,u1),this._composers.set(P.MODTOOL_ALERTEVENT,QC),this._composers.set(P.MODTOOL_SANCTION_MUTE,c1),this._composers.set(P.MODTOOL_REQUEST_USER_ROOMS,n1),this._composers.set(P.MODTOOL_ROOM_ALERT,Pu),this._composers.set(P.CLOSE_ISSUE_DEFAULT_ACTION,W8),this._composers.set(P.CLOSE_ISSUES,Lu),this._composers.set(P.DEFAULT_SANCTION,e1),this._composers.set(P.GET_CFH_CHATLOG,t1),this._composers.set(P.MODTOOL_PREFERENCES,Y8),this._composers.set(P.MODTOOL_SANCTION,z8),this._composers.set(P.PICK_ISSUES,h1),this._composers.set(P.RELEASE_ISSUES,JC),this._composers.set(P.MYSTERYBOXWAITINGCANCELEDMESSAGE,d1),this._composers.set(P.MYSTERYBOX_OPEN_TROPHY,Rw),this._composers.set(P.USER_SETTINGS_CAMERA,yF),this._composers.set(P.USER_SETTINGS_OLD_CHAT,DF),this._composers.set(P.USER_SETTINGS_INVITES,MF),this._composers.set(P.USER_SETTINGS_VOLUME,jF),this._composers.set(P.USER_SETTINGS_WHISPERING_TO_WIRED,LF),this._composers.set(P.USER_SETTINGS_SET_OPTIONAL_PATH_FINDER,PF),this._composers.set(P.UPDATE_USER_SETTINGS,UF),this._composers.set(P.COMMUNITY_GOAL_VOTE_COMPOSER,B8),this._composers.set(P.GET_PROMO_ARTICLES,YU),this._composers.set(P.ACCEPT_QUEST,L1),this._composers.set(P.ACTIVATE_QUEST,A$),this._composers.set(P.CANCEL_QUEST,b$),this._composers.set(P.FRIEND_REQUEST_QUEST_COMPLETE,v$),this._composers.set(P.GET_COMMUNITY_GOAL_EARNED_PRIZES,y$),this._composers.set(P.GET_COMMUNITY_GOAL_HALL_OF_FAME,P1),this._composers.set(P.GET_COMMUNITY_GOAL_PROGRESS,D$),this._composers.set(P.GET_CONCURRENT_USERS_GOAL_PROGRESS,M$),this._composers.set(P.GET_CONCURRENT_USERS_REWARD,j$),this._composers.set(P.GET_DAILY_QUEST,L$),this._composers.set(P.GET_QUESTS,U1),this._composers.set(P.GET_SEASONAL_QUESTS_ONLY,P$),this._composers.set(P.OPEN_QUEST_TRACKER,U$),this._composers.set(P.REDEEM_COMMUNITY_GOAL_PRIZE,w$),this._composers.set(P.REJECT_QUEST,w1),this._composers.set(P.START_CAMPAIGN,F$),this._composers.set(P.GET_SOUND_SETTINGS,J$),this._composers.set(P.ADD_JUKEBOX_DISK,oF),this._composers.set(P.GET_JUKEBOX_PLAYLIST,lF),this._composers.set(P.GET_NOW_PLAYING,cF),this._composers.set(P.GET_OFFICIAL_SONG_ID,uF),this._composers.set(P.GET_SONG_INFO,hF),this._composers.set(P.GET_SOUND_MACHINE_PLAYLIST,Q$),this._composers.set(P.GET_USER_SONG_DISKS,dF),this._composers.set(P.REMOVE_JUKEBOX_DISK,_F),this._composers.set(P.HELPER_TALENT_TRACK,eQ),this._composers.set(P.TALENT_TRACK_GET_LEVEL,Z$),this._composers.set(P.NEW_USER_EXPERIENCE_GET_GIFTS,C$),this._composers.set(P.NEW_USER_EXPERIENCE_SCRIPT_PROCEED,x1),this._composers.set(P.WELCOME_OPEN_GIFT,W$),this._composers.set(P.WELCOME_GIFT_CHANGE_EMAIL,aQ),this._composers.set(P.EMAIL_GET_STATUS,rQ),this._composers.set(P.EMAIL_CHANGE,iQ),this._composers.set(P.RENTABLE_SPACE_CANCEL_RENT,Ow),this._composers.set(P.RENTABLE_SPACE_RENT,Cw),this._composers.set(P.RENTABLE_SPACE_STATUS,Y$),this._composers.set(P.RECYCLER_STATUS,k$),this._composers.set(P.RECYCLER_ITEMS,G$),this._composers.set(P.TRACKING_PERFORMANCE_LOG,sQ),this._composers.set(P.TRACKING_LAG_WARNING_REPORT,tQ),this._composers.set(P.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION,K$),this._composers.set(P.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM,V$),this._composers.set(P.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI,B$),this._composers.set(P.RENTABLE_GET_RENT_OR_BUYOUT_OFFER,H$),this._composers.set(P.UPDATE_ADDON,kk),this._composers.set(P.UPDATE_SELECTOR,Gk),this._composers.set(P.UPDATE_VARIABLE,Qw),this._composers.set(P.DELETE_ITEM_INVENTORY,Ex),this._composers.set(P.CHANGE_PINCEL_STATE,BF),this._composers.set(P.SAVE_PINCEL_COLORS,HF),this._composers.set(P.PAINT_FURNI_COLORS,VF),this._composers.set(P.SUBMIT_MUSIC_REQUEST,WF),this._composers.set(P.SUBMIT_CODE_RADIO,YF),this._composers.set(P.GET_STORE_DATA,ZF),this._composers.set(P.SEND_CONSTRUCTION_TOOL_DATA,Op),this._composers.set(P.HIDE_AREA,wk),this._composers.set(P.GET_MUSICS_DATA,gF),this._composers.set(P.GET_SOUND_EFFECTS_DATA,mF),this._composers.set(P.GET_ALL_VARIABLES_DIFFS,Jw),this._composers.set(P.UPDATE_ROOM_NAVIGATOR_POSITION,R1),this._composers.set(P.UPDATE_USER_TAGS,bF),this._composers.set(P.HIGHSCORE_VARIABLE,bw),this._composers.set(P.WIRED_GET_ALL_VARIABLES_HASH,Zw),this._composers.set(P.WIRED_GET_ALL_VARIABLE_HOLDERS,sf),this._composers.set(P.WIRED_GET_VARIABLES_FOR_OBJECT,eF),this._composers.set(P.WIRED_SET_OBJECT_VARIABLE_VALUE,tF),this._composers.set(P.WIRED_CLEAR_ERROR_LOGS,X$),this._composers.set(P.WIRED_GET_ERROR_LOGS,sF),this._composers.set(P.WIRED_GET_ROOM_SETTINGS,iF),this._composers.set(P.WIRED_GET_ROOM_STATS,rF),this._composers.set(P.WIRED_SET_PREFERENCES,nF),this._composers.set(P.WIRED_SET_ROOM_SETTINGS,aF)}}class BJ extends Wo{constructor(e){super(),this._communication=e,this._connection=null,this._messages=new GJ,this._demo=new AJ(this),this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.onConnectionAuthenticatedEvent=this.onConnectionAuthenticatedEvent.bind(this)}onInit(){this._connection||(De.instance.events.addEventListener(Si.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),this._connection=this._communication.createConnection(this),this._connection.registerMessages(this._messages),this._connection.addEventListener(er.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.addEventListener(er.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.addEventListener(er.CONNECTION_ERROR,this.onConnectionErrorEvent),this._demo&&this._demo.init(),this._connection.init(st.getValue("socket.url")))}onDispose(){this._demo&&this._demo.dispose(),this._connection&&(this._connection.removeEventListener(er.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.removeEventListener(er.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.removeEventListener(er.CONNECTION_ERROR,this.onConnectionErrorEvent)),De.instance.events.removeEventListener(Si.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),super.onDispose()}onConnectionOpenedEvent(e){ze.log("Connection Initialized")}onConnectionClosedEvent(e){ze.log("Connection Closed")}onConnectionErrorEvent(e){ze.log("Connection Error")}onConnectionAuthenticatedEvent(e){ze.log("Connection Authenticated"),this._connection&&this._connection.authenticated()}connectionInit(e){ze.log("Initializing Connection",e)}registerMessageEvent(e){return this._connection&&this._connection.addMessageEvent(e),e}removeMessageEvent(e){this._connection&&this._connection.removeMessageEvent(e)}get demo(){return this._demo}get connection(){return this._connection}}class VJ{constructor(e){e.addMessageEvent(new TC(this.onLoadGameUrl.bind(this)))}onLoadGameUrl(e){if(!e)return;const t=e.getParser();t&&Me.callGame("showGame",t.url)}}class XT{constructor(e){this._badgeId="",this._level=1,this._base="",this._badgeId=e,this.parseText()}parseText(){let e=this._badgeId.length-1;for(;e>0&&this.isNumber(this._badgeId.charAt(e));)e--;this._base=this._badgeId.substr(0,e+1);const t=this._badgeId.substr(e+1,this._badgeId.length);t&&t!==""&&(this._level=Number.parseInt(t))}isNumber(e){const t=e.charCodeAt(0);return t>=48&&t<=57}get level(){return this._level}set level(e){this._level=Math.max(1,e)}get getBadgeId(){return this._base+this._level}get base(){return this._base}}class HJ extends Wo{constructor(e){super(),this._communication=e,this._definitions=new Map,this._parameters=new Map,this._badgePointLimits=new Map,this._romanNumerals=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX","XXI","XXII","XXIII","XXIV","XXV","XXVI","XXVII","XXVIII","XXIX","XXX"],this._pendingUrls=[]}onInit(){this._communication.registerMessageEvent(new CC(this.onBadgePointLimitsEvent.bind(this)));let e=st.getValue("external.texts.url");Array.isArray(e)||(e=[st.getValue("external.texts.url")]);for(let t=0;t<e.length;t++)e[t]=st.interpolate(e[t]);this._pendingUrls=e,this.loadNextLocalization()}loadNextLocalization(){if(!this._pendingUrls.length){this.events&&this.events.dispatchEvent(new hc(hc.LOADED));return}this.loadLocalizationFromURL(this._pendingUrls[0])}loadLocalizationFromURL(e){fetch(e).then(t=>t.json()).then(t=>this.onLocalizationLoaded(t,e)).catch(t=>this.onLocalizationFailed(t))}onLocalizationLoaded(e,t){if(!e)return;if(!this.parseLocalization(e))throw new Error(`Invalid json data for file ${t}`);const i=this._pendingUrls.indexOf(t);i>=0&&this._pendingUrls.splice(i,1),this.loadNextLocalization()}onLocalizationFailed(e){this.events&&this.events.dispatchEvent(new hc(hc.FAILED))}parseLocalization(e){if(!e)return!1;for(const t in e)this._definitions.set(t,e[t]);return!0}onBadgePointLimitsEvent(e){const t=e.getParser();for(const i of t.data)this.setBadgePointLimit(i.badgeId,i.limit)}getBadgePointLimit(e){return this._badgePointLimits.get(e)||-1}setBadgePointLimit(e,t){this._badgePointLimits.set(e,t)}getRomanNumeral(e){return this._romanNumerals[Math.max(0,e-1)]}getPreviousLevelBadgeId(e){const t=new XT(e);return t.level--,t.getBadgeId}hasValue(e){return this._definitions.has(e)}getValue(e,t=!0){if(!e||!e.length)return null;const i=e.match(/\$\{.[^}]*\}/g);if(i&&i.length)for(const n of i)e=e.replace(n,this.getValue(n.slice(2,-1),t));let r=this._definitions.get(e)||null;if(!r&&(r=st.definitions.get(e),r))return r;if(r&&t){const n=this._parameters.get(e);if(n)for(const[o,l]of n)r=r.replace("%"+o+"%",l)}return r||e}getValueWithParameter(e,t,i){const r=this.getValue(e,!1),n=r.replace("%"+t+"%",i);if(r.startsWith("%{")){const o=new RegExp("%{"+t.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),l=r.match(o);if(!l)return n;let c=-1;switch(Number.parseInt(i)){case 0:c=1;break;case 1:c=2;break;default:case 2:c=3;break}if(c==-1||typeof l[c]>"u")return n;const d=l[c];if(d)return d.replace("%%",i)}return n}getValueWithParameters(e,t,i){let r=this.getValue(e,!1);if(t)for(let n=0;n<t.length;n++){const o=t[n],l=i[n];if(l!==void 0&&(r=r.replace("%"+o+"%",l),r.startsWith("%{"))){const c=new RegExp("%{"+o.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),u=r.match(c);if(!u)continue;const d=parseInt(l);let _=-1;switch(d){case 0:_=1;break;case 1:_=2;break;case 2:default:_=3;break}if(_===-1||typeof u[_]>"u")continue;const m=u[_];m&&(r=m.replace("%%",l))}}return r}setValue(e,t){this._definitions.set(e,t)}registerParameter(e,t,i){if(!e||e.length===0||!t||t.length===0)return;let r=this._parameters.get(e);r||(r=new Map,this._parameters.set(e,r)),r.set(t,i)}getBadgeName(e){const t=new XT(e),i=["badge_name_"+e,"badge_name_"+t.base];let r=this.fixBadLocalization(this.getExistingKey(i));return r=r.replace("%roman%",this.getRomanNumeral(t.level)),r}getBadgeDesc(e){const t=new XT(e),i=["badge_desc_"+e,"badge_desc_"+t.base];let r=this.fixBadLocalization(this.getExistingKey(i));const n=this.getBadgePointLimit(e);return n>-1&&(r=r.replace("%limit%",n.toString())),r=r.replace("%roman%",this.getRomanNumeral(t.level)),r}getExistingKey(e){for(const t of e){const i=this.getValue(t);if(i!=t)return i}return""}fixBadLocalization(e){return e.replace("${","$").replace("{","$").replace("}","$")}}XB.add($B,QB,JB,ZB,eV,tV,sV);class Bb{constructor(){this.id=0,this.data=null,this.image=null}getImage(){return this.image?this.image:this.data?Vt.generateImage(this.data):null}}const TI=class TI extends xi{constructor(e){super(null,null),this._type=e}get type(){return this._type}};TI.IMAGE_LOADED="ROAUM_IMAGE_LOADED",TI.IMAGE_LOADING_FAILED="ROAUM_IMAGE_FAILED";let Pr=TI;class Ci extends xi{constructor(){super(null,null)}}class $k extends Ci{constructor(e,t){super(),this._itemType=e,this._itemName=t}get itemType(){return this._itemType}get itemName(){return this._itemName}}class CN extends Ci{constructor(e=0){super(),this._numberOfWords=e}get numberOfWords(){return this._numberOfWords}}class Qk extends Ci{constructor(e=0){super(),this._danceStyle=e}get danceStyle(){return this._danceStyle}}class Jk extends Ci{constructor(e,t=0){super(),this._effect=e,this._delayMilliseconds=t}get effect(){return this._effect}get delayMilliseconds(){return this._delayMilliseconds}}class Zk extends Ci{constructor(e){super(),this._gainedExperience=e}get gainedExperience(){return this._gainedExperience}}class eG extends Ci{constructor(e=0){super(),this._expressionType=e}get expressionType(){return this._expressionType}}class Cp extends Ci{constructor(e,t=null,i=null,r=!1){super(),this._figure=e,this._gender=t,this._subType=i,this._isRiding=r}get figure(){return this._figure}get gender(){return this._gender}get subType(){return this._subType}get isRiding(){return this._isRiding}}class tG extends Ci{constructor(e=0){super(),this._level=e}get level(){return this._level}}class sG extends Ci{constructor(e=0){super(),this._gesture=e}get gesture(){return this._gesture}}class WJ extends Ci{constructor(e){super(),this._guideStatus=e}get guideStatus(){return this._guideStatus}}class iG extends Ci{constructor(e=!1){super(),this._isMuted=e}get isMuted(){return this._isMuted}}class rG extends Ci{}class nG extends Ci{constructor(e){super(),this._gesture=e}get gesture(){return this._gesture}}class aG extends Ci{constructor(e){super(),this._value=e}get value(){return this._value}}class oG extends Ci{constructor(e){super(),this._isPlayingGame=e}get isPlayingGame(){return this._isPlayingGame}}class NN extends Ci{constructor(e,t=""){super(),this._postureType=e,this._parameter=t}get postureType(){return this._postureType}get parameter(){return this._parameter}}class Np extends Ci{constructor(e){super(),this._selected=e}get selected(){return this._selected}}class lG extends Ci{constructor(e=0){super(),this._signType=e}get signType(){return this._signType}}class AN extends Ci{constructor(e=!1){super(),this._isSleeping=e}get isSleeping(){return this._isSleeping}}class cG extends Ci{constructor(e=!1){super(),this._isTyping=e}get isTyping(){return this._isTyping}}class Al extends xi{constructor(e,t,i,r=NaN,n=!1,o=!1){super(e,i),this._targetLocation=t,this._isSlide=n,this._animationTime=r,this._skipPositionUpdate=o}get targetLocation(){return this._targetLocation?this._targetLocation:this.location}get isSlide(){return this._isSlide}get animationTime(){return this._animationTime}get skipPositionUpdate(){return this._skipPositionUpdate}}class Ap extends Al{constructor(e,t,i,r,n,o,l=NaN,c=!1){super(e,t,i,l,!1,c),this._headDirection=r,this._canStandUp=n,this._baseY=o}get headDirection(){return this._headDirection}get canStandUp(){return this._canStandUp}get baseY(){return this._baseY}}class uG extends Ci{constructor(e){super(),this._itemType=e}get itemType(){return this._itemType}}class os extends xi{constructor(e,t,i=null){super(null,null),this._state=e,this._data=t,this._extra=i}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}}const OA=class OA extends xi{constructor(e,t){super(null,null),this._badgeId=e,this._assetName=t}get badgeId(){return this._badgeId}get assetName(){return this._assetName}};OA.BADGE_LOADED="ROGBUM_BADGE_LOADED";let Qu=OA;class hG extends xi{constructor(e,t,i){super(e,t),this._height=i}get height(){return this._height}}class bN extends xi{constructor(e){super(null,null),this._data=e}get data(){return this._data}}class dG extends xi{constructor(e,t){super(null,null),this._numberKey=e,this._numberValue=t}get numberKey(){return this._numberKey}get numberValue(){return this._numberValue}}const CA=class CA extends xi{constructor(e,t,i,r){super(null,null),this._type=e,this._color=t,this._light=i,this._backgroundOnly=r}get type(){return this._type}get color(){return this._color}get light(){return this._light}get backgroundOnly(){return this._backgroundOnly}};CA.BACKGROUND_COLOR="RORCUM_BACKGROUND_COLOR";let Qg=CA;const SI=class SI extends xi{constructor(e,t,i=0,r=0,n=0,o=0,l=!1){super(null,null),this._type=e,this._id=t,this._x=i,this._y=r,this._width=n,this._height=o,this._invert=l}get invert(){return this._invert}get type(){return this._type}get id(){return this._id}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}};SI.ADD="ORPFHUM_ADD",SI.REMOVE="ORPFHUM_REMOVE";let wn=SI;const RI=class RI extends xi{constructor(e){super(null,null),this._type=RI.UPDATE_MAP,this._mapData=e}get type(){return this._type}get mapData(){return this._mapData}};RI.UPDATE_MAP="RORMUM_UPDATE_MAP";let bp=RI;const Iu=class Iu extends xi{constructor(e,t,i=null,r=null,n="window"){super(null,null),this._type=e,this._maskId=t,this._maskType=i,this._maskLocation=r?new Y(r.x,r.y,r.z):null,this._maskCategory=n}get type(){return this._type}get maskId(){return this._maskId}get maskType(){return this._maskType}get maskLocation(){return this._maskLocation}get maskCategory(){return this._maskCategory}};Iu.ADD_MASK="RORMUM_ADD_MASK",Iu.REMOVE_MASK="RORMUM_ADD_MASK",Iu.DOOR="door",Iu.WINDOW="window",Iu.HOLE="hole";let xr=Iu;const xI=class xI extends xi{constructor(e,t){super(null,null),this._type=e,this._value=t}get type(){return this._type}get value(){return this._value}};xI.WALL_THICKNESS="RORPPUM_WALL_THICKNESS",xI.FLOOR_THICKNESS="RORPVUM_FLOOR_THICKNESS";let Rl=xI;const OI=class OI extends xi{constructor(e,t){super(null,null),this._type=e,this._visible=t}get type(){return this._type}get visible(){return this._visible}};OI.WALL_VISIBILITY="RORPVUM_WALL_VISIBILITY",OI.FLOOR_VISIBILITY="RORPVUM_FLOOR_VISIBILITY";let xl=OI;const ug=class ug extends xi{constructor(e,t){super(null,null),this._type=e,this._value=t}get type(){return this._type}get value(){return this._value}};ug.ROOM_WALL_UPDATE="RORUM_ROOM_WALL_UPDATE",ug.ROOM_FLOOR_UPDATE="RORUM_ROOM_FLOOR_UPDATE",ug.ROOM_LANDSCAPE_UPDATE="RORUM_ROOM_LANDSCAPE_UPDATE";let Xi=ug;class Jg extends Ci{constructor(e){super(),this._selected=e}get selected(){return this._selected}}class Eh extends xi{constructor(e,t,i,r,n=!1){super(e,null),this._height=t,this._visible=i,this._sourceEventId=r,this._toggleVisibility=n}get height(){return this._height}get visible(){return this._visible}get sourceEventId(){return this._sourceEventId}get toggleVisibility(){return this._toggleVisibility}}const CI=class CI extends xi{constructor(e){super(null,null),this._type=e}get type(){return this._type}};CI.ENABLED="ROVUM_ENABLED",CI.DISABLED="ROVUM_DISABLED";let Ol=CI;class _G extends xi{constructor(e,t,i){super(e,t),this._headDirection=i}get headDirection(){return this._headDirection}}const Tu=class Tu extends iT{constructor(){super(),this._liftAmount=0,this._location=new Y,this._locationDelta=new Y,this._lastUpdateTime=0,this._changeTime=0,this._updateInterval=Tu.DEFAULT_UPDATE_INTERVAL}get lastUpdateTime(){return this._lastUpdateTime}set updateInterval(e){e<=0&&(e=1),this._updateInterval=e}update(e){super.update(e);const t=this.getLocationOffset(),i=this.object&&this.object.model;if(i&&(t?this._liftAmount!==t.z&&(this._liftAmount=t.z,i.setValue(D.FURNITURE_LIFT_AMOUNT,this._liftAmount)):this._liftAmount!==0&&(this._liftAmount=0,i.setValue(D.FURNITURE_LIFT_AMOUNT,this._liftAmount))),this._locationDelta.length>0||t){const r=Tu.TEMP_VECTOR;let n=this.time-this._changeTime;n===this._updateInterval>>1&&n++,n>this._updateInterval&&(n=this._updateInterval),this._locationDelta.length>0?(r.assign(this._locationDelta),r.multiply(n/this._updateInterval),r.add(this._location)):r.assign(this._location),t&&r.add(t),this.object.setLocation(r),n===this._updateInterval&&(this._locationDelta.x=0,this._locationDelta.y=0,this._locationDelta.z=0),this.eventDispatcher.dispatchEvent(new Bi(Bi.SLIDE_ANIMATION,this.object))}this._lastUpdateTime=this.time}setObject(e){super.setObject(e),e&&this._location.assign(e.getLocation())}processUpdateMessage(e){if(e&&(super.processUpdateMessage(e),!(e instanceof Al&&e.skipPositionUpdate)&&(e.location&&(this._location.assign(e.location),this._locationDelta.x=0,this._locationDelta.y=0,this._locationDelta.z=0),e instanceof Al)))return this.processMoveMessage(e)}onDispose(){this._liftAmount=0,super.onDispose()}getLocationOffset(){return null}resetPosition(){}processMoveMessage(e){!e||!this.object||!e.location||(this._changeTime=this._lastUpdateTime,this.updateInterval=isNaN(e.animationTime)?Tu.DEFAULT_UPDATE_INTERVAL:e.animationTime,this._locationDelta.assign(e.targetLocation),this._locationDelta.subtract(this._location))}};Tu.DEFAULT_UPDATE_INTERVAL=500,Tu.TEMP_VECTOR=new Y;let Ju=Tu;const oi=class oi extends Ju{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._effectChangeTimeStamp=0,this._newEffect=0,this._blinkingStartTimestamp=nt()+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=0,this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0,this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1,this._animationEndTimestamp=0,this._signEndTimestamp=0,this._gestureEndTimestamp=0,this._numberValueEndTimestamp=0}getEventTypes(){const e=[rt.CLICK,rt.DOUBLE_CLICK,Bi.POSITION_CHANGED,rt.MOUSE_ENTER,rt.MOUSE_LEAVE,Ae.MOUSE_BUTTON,Ae.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),e)}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Bi(Bi.OBJECT_REMOVED,this.object)),super.dispose(),this._reportedLocation=null}update(e){if(super.update(e),this._selected&&this.object&&this.eventDispatcher){const i=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==i.x||this._reportedLocation.y!==i.y||this._reportedLocation.z!==i.z)&&(this._reportedLocation||(this._reportedLocation=new Y),this._reportedLocation.assign(i),this.eventDispatcher.dispatchEvent(new Bi(Bi.POSITION_CHANGED,this.object)))}const t=this.object&&this.object.model;t&&this.updateModel(this.time,t)}updateModel(e,t){this._talkingEndTimestamp>0&&(e>this._talkingEndTimestamp?(t.setValue(D.FIGURE_TALK,0),this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0):!this._talkingPauseEndTimestamp&&!this._talkingPauseStartTimestamp?(this._talkingPauseStartTimestamp=e+this.randomTalkingPauseStartTimestamp(),this._talkingPauseEndTimestamp=this._talkingPauseStartTimestamp+this.randomTalkingPauseEndTimestamp()):this._talkingPauseStartTimestamp>0&&e>this._talkingPauseStartTimestamp?(t.setValue(D.FIGURE_TALK,0),this._talkingPauseStartTimestamp=0):this._talkingPauseEndTimestamp>0&&e>this._talkingPauseEndTimestamp&&(t.setValue(D.FIGURE_TALK,1),this._talkingPauseEndTimestamp=0)),this._animationEndTimestamp>0&&e>this._animationEndTimestamp&&(t.setValue(D.FIGURE_EXPRESSION,0),this._animationEndTimestamp=0),this._gestureEndTimestamp>0&&e>this._gestureEndTimestamp&&(t.setValue(D.FIGURE_GESTURE,0),this._gestureEndTimestamp=0),this._signEndTimestamp>0&&e>this._signEndTimestamp&&(t.setValue(D.FIGURE_SIGN,-1),this._signEndTimestamp=0),this._carryObjectEndTimestamp>0&&e>this._carryObjectEndTimestamp&&(t.setValue(D.FIGURE_CARRY_OBJECT,0),t.setValue(D.FIGURE_USE_OBJECT,0),this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1),this._allowUseCarryObject&&e-this._carryObjectStartTimestamp>5e3&&((e-this._carryObjectStartTimestamp)%1e4<1e3?t.setValue(D.FIGURE_USE_OBJECT,1):t.setValue(D.FIGURE_USE_OBJECT,0)),this._blinkingStartTimestamp>-1&&e>this._blinkingStartTimestamp&&(t.setValue(D.FIGURE_BLINK,1),this._blinkingStartTimestamp=e+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=e+this.randomBlinkEndTimestamp()),this._blinkingEndTimestamp>0&&e>this._blinkingEndTimestamp&&(t.setValue(D.FIGURE_BLINK,0),this._blinkingEndTimestamp=0),this._effectChangeTimeStamp>0&&e>this._effectChangeTimeStamp&&(t.setValue(D.FIGURE_EFFECT,this._newEffect),this._effectChangeTimeStamp=0),this._numberValueEndTimestamp>0&&e>this._numberValueEndTimestamp&&(t.setValue(D.FIGURE_NUMBER_VALUE,0),this._numberValueEndTimestamp=0)}processUpdateMessage(e){if(!e||!this.object)return;super.processUpdateMessage(e);const t=this.object&&this.object.model;if(t){if(e instanceof NN){t.setValue(D.FIGURE_POSTURE,e.postureType),t.setValue(D.FIGURE_POSTURE_PARAMETER,e.parameter);return}if(e instanceof CN){t.setValue(D.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+e.numberOfWords*1e3;return}if(e instanceof cG){t.setValue(D.FIGURE_IS_TYPING,e.isTyping?1:0);return}if(e instanceof iG){t.setValue(D.FIGURE_IS_MUTED,e.isMuted?1:0);return}if(e instanceof oG){t.setValue(D.FIGURE_IS_PLAYING_GAME,e.isPlayingGame?1:0);return}if(e instanceof Ap){t.setValue(D.HEAD_DIRECTION,e.headDirection),t.setValue(D.FIGURE_CAN_STAND_UP,e.canStandUp),t.setValue(D.FIGURE_VERTICAL_OFFSET,e.baseY);return}if(e instanceof _G){t.setValue(D.HEAD_DIRECTION,e.headDirection);return}if(e instanceof sG){t.setValue(D.FIGURE_GESTURE,e.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(e instanceof eG){t.setValue(D.FIGURE_EXPRESSION,e.expressionType),this._animationEndTimestamp=We.getExpressionTimeout(t.getValue(D.FIGURE_EXPRESSION)),this._animationEndTimestamp>-1&&(this._animationEndTimestamp+=this.time);return}if(e instanceof Qk){t.setValue(D.FIGURE_DANCE,e.danceStyle);return}if(e instanceof AN){t.setValue(D.FIGURE_SLEEP,e.isSleeping?1:0),e.isSleeping?this._blinkingStartTimestamp=-1:this._blinkingStartTimestamp=this.time+this.randomBlinkStartTimestamp();return}if(e instanceof aG){t.setValue(D.FIGURE_NUMBER_VALUE,e.value),this._numberValueEndTimestamp=this.time+3e3;return}if(e instanceof Jk){this.updateAvatarEffect(e.effect,e.delayMilliseconds,t);return}if(e instanceof $k){t.setValue(D.FIGURE_CARRY_OBJECT,e.itemType),t.setValue(D.FIGURE_USE_OBJECT,0),e.itemType===0?(this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1):(this._carryObjectStartTimestamp=this.time,e.itemType<oi.MAX_HAND_ID?(this._carryObjectEndTimestamp=0,this._allowUseCarryObject=e.itemType<=oi.MAX_HAND_USE_ID):(this._carryObjectEndTimestamp=this._carryObjectStartTimestamp+1500,this._allowUseCarryObject=!1));return}if(e instanceof uG){t.setValue(D.FIGURE_USE_OBJECT,e.itemType);return}if(e instanceof lG){t.setValue(D.FIGURE_SIGN,e.signType),this._signEndTimestamp=this.time+5e3;return}if(e instanceof tG){t.setValue(D.FIGURE_FLAT_CONTROL,e.level);return}if(e instanceof Cp){t.setValue(D.FIGURE,e.figure),t.setValue(D.GENDER,e.gender);return}if(e instanceof Np){this._selected=e.selected,this._reportedLocation=null;return}if(e instanceof rG){t.setValue(D.OWN_USER,1);return}}}updateAvatarEffect(e,t,i){if(e===oi.EFFECT_TYPE_SPLASH)this._effectChangeTimeStamp=nt()+oi.EFFECT_SPLASH_LENGTH,this._newEffect=oi.EFFECT_TYPE_SWIM;else if(e===oi.EFFECT_TYPE_SPLASH_DARK)this._effectChangeTimeStamp=nt()+oi.EFFECT_SPLASH_LENGTH,this._newEffect=oi.EFFECT_TYPE_SWIM_DARK;else if(i.getValue(D.FIGURE_EFFECT)===oi.EFFECT_TYPE_SWIM)this._effectChangeTimeStamp=nt()+oi.EFFECT_SPLASH_LENGTH,this._newEffect=e,e=oi.EFFECT_TYPE_SPLASH;else if(i.getValue(D.FIGURE_EFFECT)===oi.EFFECT_TYPE_SWIM_DARK)this._effectChangeTimeStamp=nt()+oi.EFFECT_SPLASH_LENGTH,this._newEffect=e,e=oi.EFFECT_TYPE_SPLASH_DARK;else if(t===0)this._effectChangeTimeStamp=0;else{this._effectChangeTimeStamp=nt()+t,this._newEffect=e;return}i.setValue(D.FIGURE_EFFECT,e)}mouseEvent(e,t){let i=null;switch(e.type){case Re.MOUSE_CLICK:i=rt.CLICK;break;case Re.DOUBLE_CLICK:i=rt.DOUBLE_CLICK;break;case Re.ROLL_OVER:i=rt.MOUSE_ENTER,this.object.model&&this.object.model.setValue(D.FIGURE_HIGHLIGHT,1),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Ae(Ae.MOUSE_BUTTON,this.object));break;case Re.ROLL_OUT:i=rt.MOUSE_LEAVE,this.object.model&&this.object.model.setValue(D.FIGURE_HIGHLIGHT,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Ae(Ae.MOUSE_ARROW,this.object));break}i&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new rt(i,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown))}randomTalkingPauseStartTimestamp(){return 100+Math.random()*200}randomTalkingPauseEndTimestamp(){return 75+Math.random()*75}randomBlinkStartTimestamp(){return 4500+Math.random()*1e3}randomBlinkEndTimestamp(){return 50+Math.random()*200}};oi.MAX_HAND_ID=999999999,oi.MAX_HAND_USE_ID=999,oi.EFFECT_TYPE_SPLASH=28,oi.EFFECT_SPLASH_LENGTH=500,oi.EFFECT_TYPE_SWIM=29,oi.EFFECT_TYPE_SPLASH_DARK=184,oi.EFFECT_TYPE_SWIM_DARK=185;let Jx=oi;const Gr=class Gr extends Ju{constructor(){super(),this._sizeX=0,this._sizeY=0,this._sizeZ=0,this._centerX=0,this._centerY=0,this._centerZ=0,this._directions=[],this._mouseOver=!1,this._locationOffset=new Y,this._bouncingStep=0,this._storedRotateMessage=null,this._directionInitialized=!1,Gr.BOUNCING_STEPS===-1&&(Gr.BOUNCING_STEPS=st.getValue("furni.rotation.bounce.steps",8)),Gr.BOUNCING_Z===-1&&(Gr.BOUNCING_Z=st.getValue("furni.rotation.bounce.height",.0625))}getEventTypes(){const e=[At.STATE_CHANGE,rt.CLICK,rt.MOUSE_DOWN,rt.MOUSE_DOWN_LONG,vs.ROOM_AD_TOOLTIP_SHOW,vs.ROOM_AD_TOOLTIP_HIDE,vs.ROOM_AD_FURNI_DOUBLE_CLICK,vs.ROOM_AD_FURNI_CLICK];return this.widget&&e.push(re.OPEN_WIDGET,re.CLOSE_WIDGET),this.contextMenu&&e.push(re.OPEN_FURNI_CONTEXT_MENU,re.CLOSE_FURNI_CONTEXT_MENU),this.mergeTypes(super.getEventTypes(),e)}initialize(e){if(!e)return;const t=this.object&&this.object.model;if(t){if(e.logic){if(e.logic.model){const i=e.logic.model.dimensions;i&&(this._sizeX=i.x,this._sizeY=i.y,this._sizeZ=i.z,this._centerX=this._sizeX/2,this._centerY=this._sizeY/2,this._centerZ=this._sizeZ/2);const r=e.logic.model.directions;if(r&&r.length){for(const n of r)this._directions.push(n);this._directions.sort((n,o)=>n-o)}}if(e.logic.customVars){const i=e.logic.customVars.variables;i&&i.length&&t.setValue(D.FURNITURE_CUSTOM_VARIABLES,i)}}t.setValue(D.FURNITURE_SIZE_X,this._sizeX),t.setValue(D.FURNITURE_SIZE_Y,this._sizeY),t.setValue(D.FURNITURE_SIZE_Z,this._sizeZ),t.setValue(D.FURNITURE_CENTER_X,this._centerX),t.setValue(D.FURNITURE_CENTER_Y,this._centerY),t.setValue(D.FURNITURE_CENTER_Z,this._centerZ),t.setValue(D.FURNITURE_ALLOWED_DIRECTIONS,this._directions),t.setValue(D.FURNITURE_ALPHA_MULTIPLIER,1)}}setObject(e){super.setObject(e),e&&e.getLocation().length&&(this._directionInitialized=!0)}update(e){super.update(e),this._bouncingStep>0&&(this._bouncingStep++,this._bouncingStep>Gr.BOUNCING_STEPS&&(this._bouncingStep=0))}processUpdateMessage(e){if(e instanceof os){this.processDataUpdateMessage(e);return}if(e instanceof hG){this.processObjectHeightUpdateMessage(e);return}if(e instanceof bN){this.processItemDataUpdateMessage(e);return}if(this._mouseOver=!1,e.location&&e.direction){if(e instanceof Al)e.direction!=null&&this.object.setDirection(e.direction);else{const t=this.object.getDirection(),i=this.object.getLocation();t.x!==e.direction.x&&this._directionInitialized&&i.x===e.location.x&&i.y===e.location.y&&i.z===e.location.z&&(this._bouncingStep=1,this._storedRotateMessage=new xi(e.location,e.direction),e=null)}this._directionInitialized=!0}if(e instanceof Jg&&this.contextMenu&&this.eventDispatcher&&this.object){const t=e.selected?re.OPEN_FURNI_CONTEXT_MENU:re.CLOSE_FURNI_CONTEXT_MENU;this.eventDispatcher.dispatchEvent(new re(t,this.object))}super.processUpdateMessage(e)}mouseEvent(e,t){var r,n;const i=this.getAdClickUrl(this.object.model);switch(e.type){case Re.MOUSE_MOVE:if(this.eventDispatcher){const o=new rt(rt.MOUSE_MOVE,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);o.localX=e.localX,o.localY=e.localY,o.spriteOffsetX=e.spriteOffsetX,o.spriteOffsetY=e.spriteOffsetY,this.eventDispatcher.dispatchEvent(o)}return;case Re.ROLL_OVER:if(!this._mouseOver){if(this.eventDispatcher){i&&i.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new vs(vs.ROOM_AD_TOOLTIP_SHOW,this.object));const o=new rt(rt.MOUSE_ENTER,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);o.localX=e.localX,o.localY=e.localY,o.spriteOffsetX=e.spriteOffsetX,o.spriteOffsetY=e.spriteOffsetY,this.eventDispatcher.dispatchEvent(o)}this._mouseOver=!0}return;case Re.ROLL_OUT:if(this._mouseOver){if(this.eventDispatcher){i&&i.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new vs(vs.ROOM_AD_TOOLTIP_HIDE,this.object));const o=new rt(rt.MOUSE_LEAVE,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);o.localX=e.localX,o.localY=e.localY,o.spriteOffsetX=e.spriteOffsetX,o.spriteOffsetY=e.spriteOffsetY,this.eventDispatcher.dispatchEvent(o)}this._mouseOver=!1}return;case Re.DOUBLE_CLICK:Ac()<=0&&!xk()&&((n=ce())==null?void 0:n.objectEventHandler.getSelectedRoomObjectData((r=ce())==null?void 0:r.activeRoomId))==null&&this.useObject();return;case Re.MOUSE_CLICK:if(this.eventDispatcher){const o=new rt(rt.CLICK,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);o.localX=e.localX,o.localY=e.localY,o.spriteOffsetX=e.spriteOffsetX,o.spriteOffsetY=e.spriteOffsetY,this.eventDispatcher.dispatchEvent(o),i&&i.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new vs(vs.ROOM_AD_TOOLTIP_HIDE,this.object)),i&&i.length&&this.handleAdClick(this.object.id,this.object.type,i),De.instance.sessionDataManager.isDoubleClick&&Ac()<=0&&this.useObject()}return;case Re.MOUSE_DOWN:if(this.eventDispatcher){const o=new rt(rt.MOUSE_DOWN,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);this.eventDispatcher.dispatchEvent(o)}return;case Re.MOUSE_DOWN_LONG:if(this.eventDispatcher){const o=new rt(rt.MOUSE_DOWN_LONG,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);this.eventDispatcher.dispatchEvent(o)}return}}useObject(){if(!this.object||!this.eventDispatcher)return;const e=this.getAdClickUrl(this.object.model);e&&e.length&&this.eventDispatcher.dispatchEvent(new vs(vs.ROOM_AD_FURNI_DOUBLE_CLICK,this.object,null,e)),this.widget&&this.eventDispatcher.dispatchEvent(new re(re.OPEN_WIDGET,this.object)),this.eventDispatcher.dispatchEvent(new At(At.STATE_CHANGE,this.object))}tearDown(){this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.widget&&this.eventDispatcher.dispatchEvent(new re(re.CLOSE_WIDGET,this.object)),this.contextMenu&&this.eventDispatcher.dispatchEvent(new re(re.CLOSE_FURNI_CONTEXT_MENU,this.object))),super.tearDown()}onDispose(){this._storedRotateMessage=null,this._directions=null,super.onDispose()}getAdClickUrl(e){return e.getValue(D.FURNITURE_AD_URL)}handleAdClick(e,t,i){this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new vs(vs.ROOM_AD_FURNI_CLICK,this.object))}getLocationOffset(){return this._bouncingStep<=0?null:(this._locationOffset.x=0,this._locationOffset.y=0,this._bouncingStep<=Gr.BOUNCING_STEPS/2?this._locationOffset.z=Gr.BOUNCING_Z*this._bouncingStep:this._bouncingStep<=Gr.BOUNCING_STEPS&&(this._storedRotateMessage&&(super.processUpdateMessage(this._storedRotateMessage),this._storedRotateMessage=null),this._locationOffset.z=Gr.BOUNCING_Z*(Gr.BOUNCING_STEPS-this._bouncingStep)),this._locationOffset)}processDataUpdateMessage(e){e&&(this.object.setState(e.state,0),e.data&&e.data.writeRoomObjectModel(this.object.model),e.extra!==null&&this.object.model.setValue(D.FURNITURE_EXTRAS,e.extra.toString()),this.object.model.setValue(D.FURNITURE_STATE_UPDATE_TIME,this.lastUpdateTime))}processObjectHeightUpdateMessage(e){e&&this.object.model.setValue(D.FURNITURE_SIZE_Z,e.height)}processItemDataUpdateMessage(e){e&&this.object.model.setValue(D.FURNITURE_ITEMDATA,e.data)}resetPosition(){this._bouncingStep>0&&this._bouncingStep<=Gr.BOUNCING_STEPS||this._location.assign(this.object.location)}};Gr.BOUNCING_STEPS=-1,Gr.BOUNCING_Z=-1;let $t=Gr;class gG extends $t{getEventTypes(){const e=[re.BADGE_DISPLAY_ENGRAVING,Wa.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){if(super.processUpdateMessage(e),!!this.object){if(e instanceof os){const t=e.data;t instanceof qa&&this.updateBadge(t.getValue(1));return}if(e instanceof Qu){e.assetName!=="loading_icon"&&(this.object.model.setValue(D.FURNITURE_BADGE_ASSET_NAME,e.assetName),this.object.model.setValue(D.FURNITURE_BADGE_IMAGE_STATUS,1),this.update(nt()));return}}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.BADGE_DISPLAY_ENGRAVING,this.object))}updateBadge(e){e!==""&&this.eventDispatcher&&(this.object.model.setValue(D.FURNITURE_BADGE_IMAGE_STATUS,-1),this.eventDispatcher.dispatchEvent(new Wa(Wa.LOAD_BADGE,this.object,e,!1)))}}const cn=class cn extends gG{getEventTypes(){const e=[re.ACHIEVEMENT_RESOLUTION_OPEN,re.ACHIEVEMENT_RESOLUTION_ENGRAVING,re.ACHIEVEMENT_RESOLUTION_FAILED,Wa.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof Qu&&e.assetName!=="loading_icon"&&this.object.model.setValue(D.FURNITURE_BADGE_VISIBLE_IN_STATE,cn.BADGE_VISIBLE_IN_STATE),e instanceof Jg){if(!this.eventDispatcher||!this.object)return;this.eventDispatcher.dispatchEvent(new re(re.CLOSE_FURNI_CONTEXT_MENU,this.object))}}useObject(){if(!this.object||!this.eventDispatcher)return;let e=null;switch(this.object.getState(0)){case cn.STATE_RESOLUTION_NOT_STARTED:case cn.STATE_RESOLUTION_IN_PROGRESS:e=new re(re.ACHIEVEMENT_RESOLUTION_OPEN,this.object);break;case cn.STATE_RESOLUTION_ACHIEVED:e=new re(re.ACHIEVEMENT_RESOLUTION_ENGRAVING,this.object);break;case cn.STATE_RESOLUTION_FAILED:e=new re(re.ACHIEVEMENT_RESOLUTION_FAILED,this.object);break}e&&this.eventDispatcher.dispatchEvent(e)}updateBadge(e){e!==cn.ACH_NOT_SET&&super.updateBadge(e)}};cn.STATE_RESOLUTION_NOT_STARTED=0,cn.STATE_RESOLUTION_IN_PROGRESS=1,cn.STATE_RESOLUTION_ACHIEVED=2,cn.STATE_RESOLUTION_FAILED=3,cn.ACH_NOT_SET="ach_0",cn.BADGE_VISIBLE_IN_STATE=2;let Zx=cn;class YJ extends $t{constructor(){super(),this.onRoomToObjectOwnAvatarMoveEvent=this.onRoomToObjectOwnAvatarMoveEvent.bind(this)}initialize(e){super.initialize(e),this.eventDispatcher&&this.eventDispatcher.addEventListener(yd.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent)}tearDown(){this.eventDispatcher&&this.eventDispatcher.removeEventListener(yd.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent),super.tearDown()}onRoomToObjectOwnAvatarMoveEvent(e){if(!e||!this.object)return;const t=this.object.getLocation(),i=e.targetLocation;if(!i)return;let r=this.object.model.getValue(D.FURNITURE_SIZE_X),n=this.object.model.getValue(D.FURNITURE_SIZE_Y);const o=(Math.floor(this.object.getDirection().x)+45)%360/90;(o===1||o===3)&&([r,n]=[n,r]),i.x>=t.x&&i.x<t.x+r&&i.y>=t.y&&i.y<t.y+n?this.object.setState(1,0):this.object.setState(0,0)}}class zJ extends $t{getEventTypes(){const e=[re.CLOTHING_CHANGE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e);const t=this.object.model.getValue(D.FURNITURE_DATA);this.updateClothingData(t)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof os&&e.data&&this.updateClothingData(e.data.getLegacyString())}updateClothingData(e){if(!e||!e.length)return;const[t,i]=e.split(",");t&&t.length&&this.object.model.setValue(D.FURNITURE_CLOTHING_BOY,t),i&&i.length&&this.object.model.setValue(D.FURNITURE_CLOTHING_GIRL,i)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.CLOTHING_CHANGE,this.object))}}class KJ extends $t{getEventTypes(){const e=[At.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),e)}mouseEvent(e,t){if(!e||!t||!this.object)return;let i=null;switch(e.type){case Re.DOUBLE_CLICK:switch(e.spriteTag){case"start_stop":i=new At(At.STATE_CHANGE,this.object,1);break;case"reset":i=new At(At.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&i){this.eventDispatcher.dispatchEvent(i);return}break}super.mouseEvent(e,t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new At(At.STATE_CHANGE,this.object,1))}}class qJ extends $t{processUpdateMessage(e){super.processUpdateMessage(e),this.object&&this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(hi.INFOSTAND_EXTRA_PARAM,hi.CRACKABLE_FURNI)}}class XJ extends $t{get widget(){return Ng.CRAFTING}}class $J extends $t{getEventTypes(){const e=[re.CREDITFURNI];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e);let t=0;e.logic&&e.logic.credits&&e.logic.credits!==""&&e.logic.credits.length>0&&(t=parseInt(e.logic.credits)),this.object.model.setValue(D.FURNITURE_CREDIT_VALUE,t)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new re(re.CREDITFURNI,this.object)),super.useObject())}}class ii extends $t{getEventTypes(){const e=[Ae.MOUSE_BUTTON,Ae.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),e)}mouseEvent(e,t){if(!(!e||!t||!this.object)){switch(e.type){case Re.ROLL_OVER:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Ae(Ae.MOUSE_BUTTON,this.object));break;case Re.ROLL_OUT:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Ae(Ae.MOUSE_ARROW,this.object));break}super.mouseEvent(e,t)}}}class QJ extends ii{constructor(){super(...arguments),this._state=1}getEventTypes(){const e=[Tl.PLAY_SOUND_AT_PITCH];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof os&&(this._state!==-1&&e.state!==this._state&&this.dispatchSoundEvent(this.object.location.z),this._state=e.state)}dispatchSoundEvent(e){const t=Math.pow(2,e-1.2);this.eventDispatcher.dispatchEvent(new Tl(Tl.PLAY_SOUND_AT_PITCH,this.object,"FURNITURE_cuckoo_clock",t))}}class JJ extends ii{getEventTypes(){const e=[re.STACK_HEIGHT];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),this.object&&this.object.model&&this.object.model.setValue(D.FURNITURE_ALWAYS_STACKABLE,1)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new re(re.STACK_HEIGHT,this.object)),super.useObject())}}class ZJ extends $t{constructor(){super(),this._noTags=!1,this._noTagsLastStateActivate=!1}getEventTypes(){const e=[Ae.DICE_ACTIVATE,Ae.DICE_OFF];return this.mergeTypes(super.getEventTypes(),e)}mouseEvent(e,t){if(!e||!t||!this.object)return;let i=null;switch(e.type){case Re.DOUBLE_CLICK:this._noTags?!this._noTagsLastStateActivate||this.object.getState(0)===0||this.object.getState(0)===100?(i=new Ae(Ae.DICE_ACTIVATE,this.object),this._noTagsLastStateActivate=!0):(i=new Ae(Ae.DICE_OFF,this.object),this._noTagsLastStateActivate=!1):e.spriteTag==="activate"||this.object.getState(0)===0||this.object.getState(0)===100?i=new Ae(Ae.DICE_ACTIVATE,this.object):e.spriteTag==="deactivate"&&(i=new Ae(Ae.DICE_OFF,this.object)),i&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(i);return}super.mouseEvent(e,t)}}class eZ extends $t{getEventTypes(){const e=[re.ECOTRONBOX];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.ECOTRONBOX,this.object))}}class tZ extends $t{constructor(){super(),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const e=[re.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.action&&e.logic.action.startState===1&&(this._showStateOnceRendered=!0)}update(e){super.update(e),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount>20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(e){this.object&&this.object.model&&this.object.model.setValue(D.FURNITURE_AUTOMATIC_STATE_INDEX,e)}mouseEvent(e,t){!e||!t||(e.type===Re.DOUBLE_CLICK&&this.setAutomaticStateIndex(0),super.mouseEvent(e,t))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.INERNAL_LINK,this.object))}}class sZ extends $t{getEventTypes(){const e=[re.ROOM_LINK];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.action&&e.logic.action.link&&e.logic.action.link!==""&&e.logic.action.link.length>0&&this.object&&this.object.model&&this.object.model.setValue(D.FURNITURE_INTERNAL_LINK,e.logic.action.link)}onDispose(){this._timer&&(clearTimeout(this._timer),this._timer=null),super.onDispose()}setAutomaticStateIndex(e){this.object&&this.object.model&&this.object.model.setValue(D.FURNITURE_AUTOMATIC_STATE_INDEX,e)}useObject(){this.setAutomaticStateIndex(1),this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout(()=>{this.setAutomaticStateIndex(0),this._timer=null},2500),!(!this.object||!this.eventDispatcher)&&this.eventDispatcher.dispatchEvent(new re(re.ROOM_LINK,this.object))}}class iZ extends $t{getEventTypes(){const e=[re.EFFECTBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.EFFECTBOX_OPEN_DIALOG,this.object))}get contextMenu(){return ys.EFFECT_BOX}}class rZ extends ii{getEventTypes(){const e=[re.EXTERNAL_IMAGE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){if(super.initialize(e),!!e&&this.object&&this.object.model){let t="";e.logic&&e.logic.maskType&&e.logic.maskType!==""&&e.logic.maskType.length>0&&(t=e.logic.maskType),this.object.model.setValue(D.FURNITURE_USES_PLANE_MASK,0),this.object.model.setValue(D.FURNITURE_PLANE_MASK_TYPE,t)}}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new re(re.EXTERNAL_IMAGE,this.object)),super.useObject())}}class nZ extends $t{getEventTypes(){const e=[At.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.particleSystems&&e.logic.particleSystems.length&&this.object.model.setValue(D.FURNITURE_FIREWORKS_DATA,e.logic.particleSystems)}mouseEvent(e,t){if(!e||!t||!this.object)return;let i=null;switch(e.type){case Re.DOUBLE_CLICK:switch(e.spriteTag){case"start_stop":i=new At(At.STATE_CHANGE,this.object,1);break;case"reset":i=new At(At.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&i){this.eventDispatcher.dispatchEvent(i);return}break}super.mouseEvent(e,t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new At(At.STATE_CHANGE,this.object,0))}}const Su=class Su extends ii{constructor(){super(),this._currentState=-1,this._currentLocation=null}getEventTypes(){const e=[Rr.ADD_HOLE,Rr.REMOVE_HOLE];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this._currentState===Su.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new Rr(Rr.REMOVE_HOLE,this.object)),super.onDispose()}update(e){super.update(e),this.handleAutomaticStateUpdate()}processUpdateMessage(e){if(super.processUpdateMessage(e),!this.object)return;e instanceof os&&this.handleStateUpdate(this.object.getState(0));const t=this.object.getLocation();this._currentLocation?(t.x!==this._currentLocation.x||t.y!==this._currentLocation.y)&&this._currentState===Su.STATE_HOLE&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Rr(Rr.ADD_HOLE,this.object)):this._currentLocation=new Y,this._currentLocation.assign(t)}handleStateUpdate(e){e!==this._currentState&&(this.eventDispatcher&&(e===Su.STATE_HOLE?this.eventDispatcher.dispatchEvent(new Rr(Rr.ADD_HOLE,this.object)):this._currentState===Su.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new Rr(Rr.REMOVE_HOLE,this.object))),this._currentState=e)}handleAutomaticStateUpdate(){if(!this.object)return;const e=this.object.model;if(!e)return;const t=e.getValue(D.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(t)||this.handleStateUpdate(t%2)}};Su.STATE_HOLE=0;let eO=Su;const Ru=class Ru extends ii{constructor(){super(...arguments),this._state=-1}initialize(e){super.initialize(e),this.object&&this.object.model.setValue(D.FURNITURE_FRIENDFURNI_ENGRAVING,this.engravingDialogType)}processUpdateMessage(e){if(e instanceof os){const t=e.data;t?this._state=t.state:this._state=e.state}super.processUpdateMessage(e)}getEventTypes(){const e=[re.FRIEND_FURNITURE_ENGRAVING];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||(this._state===Ru.STATE_LOCKED?this.eventDispatcher.dispatchEvent(new re(re.FRIEND_FURNITURE_ENGRAVING,this.object)):super.useObject())}get engravingDialogType(){return 0}get contextMenu(){return this._state===Ru.STATE_UNLOCKED?ys.FRIEND_FURNITURE:ys.DUMMY}};Ru.STATE_UNINITIALIZED=-1,Ru.STATE_UNLOCKED=0,Ru.STATE_LOCKED=1;let Zg=Ru;const mo=class mo extends ii{getEventTypes(){const e=[Wa.LOAD_BADGE,re.GUILD_FURNI_CONTEXT_MENU,re.CLOSE_FURNI_CONTEXT_MENU];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof os){const t=e.data;t instanceof qa&&(this.updateGroupId(t.getValue(mo.GROUPID_KEY)),this.updateBadge(t.getValue(mo.BADGE_KEY)),this.updateColors(t.getValue(mo.COLOR1_KEY),t.getValue(mo.COLOR2_KEY)))}else e instanceof Qu?e.assetName!=="loading_icon"?(this.object.model.setValue(D.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME,e.assetName),this.update(nt())):e.badgeId&&e.badgeId.length&&this.updateBadge(e.badgeId):e instanceof Jg&&(e.selected||this.eventDispatcher.dispatchEvent(new re(re.CLOSE_FURNI_CONTEXT_MENU,this.object)))}updateGroupId(e){this.object.model.setValue(D.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID,parseInt(e))}updateBadge(e){this.eventDispatcher.dispatchEvent(new Wa(Wa.LOAD_BADGE,this.object,e,!0))}updateColors(e,t){this.object.model.setValue(D.FURNITURE_GUILD_CUSTOMIZED_COLOR_1,parseInt(e,16)),this.object.model.setValue(D.FURNITURE_GUILD_CUSTOMIZED_COLOR_2,parseInt(t,16))}mouseEvent(e,t){if(!(!e||!t||!this.object)){switch(e.type){case Re.MOUSE_CLICK:this.openContextMenu()}super.mouseEvent(e,t)}}openContextMenu(){this.eventDispatcher.dispatchEvent(new re(re.GUILD_FURNI_CONTEXT_MENU,this.object))}};mo.GROUPID_KEY=1,mo.BADGE_KEY=2,mo.COLOR1_KEY=3,mo.COLOR2_KEY=4;let vp=mo;class aZ extends vp{getEventTypes(){const e=[re.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),e)}updateGroupId(e){super.updateGroupId(e),this.object.model.setValue(D.FURNITURE_INTERNAL_LINK,`groupforum/${e}`)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new re(re.INERNAL_LINK,this.object)),super.useObject())}}class oZ extends $t{getEventTypes(){const e=[Ae.USE_HABBOWHEEL];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Ae(Ae.USE_HABBOWHEEL,this.object))}}const NI=class NI extends $t{constructor(){super(...arguments),this._state=-1}getEventTypes(){return[re.HIGH_SCORE_DISPLAY,re.HIDE_HIGH_SCORE_DISPLAY]}tearDown(){this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new re(re.HIDE_HIGH_SCORE_DISPLAY,this.object)),super.tearDown()}processUpdateMessage(e){super.processUpdateMessage(e),this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&e instanceof os&&(e.state===NI.SHOW_WIDGET_IN_STATE?this.eventDispatcher.dispatchEvent(new re(re.HIGH_SCORE_DISPLAY,this.object)):this.eventDispatcher.dispatchEvent(new re(re.HIDE_HIGH_SCORE_DISPLAY,this.object)),this._state=e.state)}};NI.SHOW_WIDGET_IN_STATE=1;let tO=NI;class lZ extends $t{getEventTypes(){const e=[At.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),e)}mouseEvent(e,t){if(!e||!t||!this.object)return;let i=null;switch(e.type){case Re.DOUBLE_CLICK:switch(e.spriteTag){case"off":i=new At(At.STATE_CHANGE,this.object,3);break}break;case Re.MOUSE_CLICK:switch(e.spriteTag){case"inc":i=new At(At.STATE_CHANGE,this.object,2);break;case"dec":i=new At(At.STATE_CHANGE,this.object,1);break}break}if(this.eventDispatcher&&i){this.eventDispatcher.dispatchEvent(i);return}super.mouseEvent(e,t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new At(At.STATE_CHANGE,this.object,3))}}class cZ extends Zg{get engravingDialogType(){return Og.HABBOWEEN}}class uZ extends ii{constructor(){super(),this._nextState=0,this._nextStateTimestamp=0}update(e){if(this._nextStateTimestamp>0&&e>=this._nextStateTimestamp){this._nextStateTimestamp=0;const t=new Xr;t.setString(this._nextState.toString()),super.processUpdateMessage(new os(this._nextState,t,this._nextStateExtra))}super.update(e)}processUpdateMessage(e){if(e instanceof os){this.processUpdate(e);return}super.processUpdateMessage(e)}processUpdate(e){if(!e)return;const t=~~(e.state/1e3),i=~~(e.state%1e3);if(i)this._nextState=t,this._nextStateExtra=e.extra,this._nextStateTimestamp=this.time+i;else{this._nextStateTimestamp=0;const r=new Xr;r.setString(t.toString()),super.processUpdateMessage(new os(t,r,e.extra))}}}class hZ extends $t{constructor(){super(...arguments),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const e=[re.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.action&&(this.object.model.setValue(D.FURNITURE_INTERNAL_LINK,e.logic.action.link),e.logic.action.startState===1&&(this._showStateOnceRendered=!0))}update(e){super.update(e),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount===20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(e){this.object&&this.object.model&&this.object.model.setValue(D.FURNITURE_AUTOMATIC_STATE_INDEX,e)}mouseEvent(e,t){!e||!t||(e.type===Re.DOUBLE_CLICK&&this._showStateOnceRendered&&this.setAutomaticStateIndex(0),super.mouseEvent(e,t))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.INERNAL_LINK,this.object))}}class dZ extends ii{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const e=[Ae.JUKEBOX_START,Ae.JUKEBOX_MACHINE_STOP,Ae.JUKEBOX_DISPOSE,Ae.JUKEBOX_INIT,re.JUKEBOX_PLAYLIST_EDITOR];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(e){if(super.processUpdateMessage(e),this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(hi.INFOSTAND_EXTRA_PARAM,hi.JUKEBOX),e instanceof os)){const t=this.object.getState(0);t!==this._currentState&&(this._currentState=t,t===1?this.requestPlayList():t===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new Ae(Ae.JUKEBOX_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new Ae(Ae.JUKEBOX_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Ae(Ae.JUKEBOX_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Ae(Ae.JUKEBOX_DISPOSE,this.object))}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new re(re.JUKEBOX_PLAYLIST_EDITOR,this.object)),this.eventDispatcher.dispatchEvent(new At(At.STATE_CHANGE,this.object,-1)))}}class Vb extends Zg{get engravingDialogType(){return Og.LOVE_LOCK}}const Zl=class Zl extends $t{getEventTypes(){const e=[re.MANNEQUIN];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof os&&(e.data.writeRoomObjectModel(this.object.model),this.processObjectData())}processObjectData(){if(!this.object||!this.object.model)return;const e=new Yu;e.initializeFromRoomObjectModel(this.object.model),this.object.model.setValue(D.FURNITURE_MANNEQUIN_GENDER,e.getValue(Zl.GENDER)),this.object.model.setValue(D.FURNITURE_MANNEQUIN_FIGURE,e.getValue(Zl.FIGURE)),this.object.model.setValue(D.FURNITURE_MANNEQUIN_NAME,e.getValue(Zl.OUTFIT_NAME))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.MANNEQUIN,this.object))}};Zl.GENDER="GENDER",Zl.FIGURE="FIGURE",Zl.OUTFIT_NAME="OUTFIT_NAME";let sO=Zl;class _Z extends ii{getEventTypes(){const e=[re.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return ys.MONSTERPLANT_SEED}}class gZ extends ii{initialize(e){super.initialize(e),this.object&&this.object.model&&this.object.model.setValue(D.FURNITURE_IS_VARIABLE_HEIGHT,1)}}class mZ extends ii{getEventTypes(){const e=[re.MYSTERYBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.MYSTERYBOX_OPEN_DIALOG,this.object))}get contextMenu(){return ys.MYSTERY_BOX}}class fZ extends ii{getEventTypes(){const e=[re.MYSTERYTROPHY_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.MYSTERYTROPHY_OPEN_DIALOG,this.object))}get contextMenu(){return ys.MYSTERY_TROPHY}}class pZ extends $t{getEventTypes(){const e=[Ae.ENTER_ONEWAYDOOR];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Ae(Ae.ENTER_ONEWAYDOOR,this.object))}}class EZ extends $t{getEventTypes(){const e=[re.PET_PRODUCT_MENU];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){super.processUpdateMessage(e),this.object&&this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(hi.INFOSTAND_EXTRA_PARAM,hi.USABLE_PRODUCT)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.PET_PRODUCT_MENU,this.object))}}class IZ extends $t{getEventTypes(){const e=[re.PLACEHOLDER];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.PLACEHOLDER,this.object))}}class TZ extends $t{initialize(e){super.initialize(e),e.logic&&e.logic.planetSystems&&this.object.model.setValue(D.FURNITURE_PLANETSYSTEM_DATA,e.logic.planetSystems)}}const aa=class aa extends $t{getEventTypes(){const e=[re.PRESENT];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.particleSystems&&e.logic.particleSystems.length&&this.object.model.setValue(D.FURNITURE_FIREWORKS_DATA,e.logic.particleSystems)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof os&&(e.data.writeRoomObjectModel(this.object.model),this.updateStuffData()),e instanceof dG&&e.numberKey===D.FURNITURE_DISABLE_PICKING_ANIMATION&&this.object.model.setValue(D.FURNITURE_DISABLE_PICKING_ANIMATION,e.numberValue)}updateStuffData(){if(!this.object||!this.object.model)return;const e=new Yu;e.initializeFromRoomObjectModel(this.object.model);const t=e.getValue(aa.MESSAGE),i=this.object.model.getValue(D.FURNITURE_DATA);!t&&typeof i=="string"?this.object.model.setValue(D.FURNITURE_DATA,i.substr(1)):this.object.model.setValue(D.FURNITURE_DATA,e.getValue(aa.MESSAGE)),this.writeToModel(D.FURNITURE_TYPE_ID,e.getValue(aa.PRODUCT_CODE)),this.writeToModel(D.FURNITURE_PURCHASER_NAME,e.getValue(aa.PURCHASER_NAME)),this.writeToModel(D.FURNITURE_PURCHASER_FIGURE,e.getValue(aa.PURCHASER_FIGURE))}writeToModel(e,t){t&&this.object.model.setValue(e,t)}mouseEvent(e,t){if(!(!e||!t||!this.object)){switch(e.type){case Re.ROLL_OVER:this.eventDispatcher.dispatchEvent(new Ae(Ae.MOUSE_BUTTON,this.object));break;case Re.ROLL_OUT:this.eventDispatcher.dispatchEvent(new Ae(Ae.MOUSE_ARROW,this.object));break}super.mouseEvent(e,t)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.PRESENT,this.object))}};aa.MESSAGE="MESSAGE",aa.PRODUCT_CODE="PRODUCT_CODE",aa.EXTRA_PARAM="EXTRA_PARAM",aa.PURCHASER_NAME="PURCHASER_NAME",aa.PURCHASER_FIGURE="PURCHASER_FIGURE";let iO=aa;class SZ extends ii{getEventTypes(){const e=[re.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return ys.PURCHASABLE_CLOTHING}}const _l=class _l extends ii{constructor(){super(),this.updateInterval=Ju.DEFAULT_UPDATE_INTERVAL,this._oldLocation=new Y}processUpdateMessage(e){if(!e)return;const t=e instanceof Al;if(this.object&&!t&&e.location){const r=this.object.getLocation(),n=Y.dif(e.location,r);if(n&&Math.abs(n.x)<2&&Math.abs(n.y)<2){let o=r;(Math.abs(n.x)>1||Math.abs(n.y)>1)&&(o=Y.sum(r,Y.product(n,.5))),super.processUpdateMessage(new Al(o,e.location,e.direction));return}}e.location&&!t&&super.processUpdateMessage(new Al(e.location,e.location,e.direction));const i=!t||isNaN(e.animationTime)?Ju.DEFAULT_UPDATE_INTERVAL:e.animationTime;if(e instanceof os){e.state>0?this.updateInterval=i/this.getUpdateIntervalValue(e.state):this.updateInterval=1,this.handleDataUpdate(e);return}t&&e.isSlide&&(this.updateInterval=i),super.processUpdateMessage(e)}update(e){this.object&&(this._oldLocation.assign(this.object.getLocation()),super.update(e),Y.dif(this.object.getLocation(),this._oldLocation).length===0&&this.object.getState(0)!==_l.ANIMATION_NOT_MOVING&&this.object.setState(_l.ANIMATION_NOT_MOVING,0))}getUpdateIntervalValue(e){return e/_l.MAX_ANIMATION_COUNT}getAnimationValue(e){return e%_l.MAX_ANIMATION_COUNT}handleDataUpdate(e){const t=this.getAnimationValue(e.state);if(t!==e.state){const i=new Xr;i.setString(t.toString()),e=new os(t,i,e.extra)}super.processUpdateMessage(e)}};_l.ANIMATION_NOT_MOVING=0,_l.ANIMATION_MOVING=1,_l.MAX_ANIMATION_COUNT=10;let rO=_l;class RZ extends $t{getEventTypes(){const e=[At.STATE_RANDOM];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new At(At.STATE_RANDOM,this.object))}}class xZ extends ii{get contextMenu(){return ys.RANDOM_TELEPORT}}class OZ extends $t{getEventTypes(){const e=[da.RODRE_CURRENT_USER_ID,re.RENTABLE_SPACE];return this.mergeTypes(super.getEventTypes(),e)}update(e){if(super.update(e),this.object&&this.object.model){this.object.model.getValue(D.SESSION_CURRENT_USER_ID)||this.eventDispatcher.dispatchEvent(new da(da.RODRE_CURRENT_USER_ID,this.object));const t=this.object.model.getValue(D.FURNITURE_DATA).split(":")[0],i=this.object.model.getValue(D.SESSION_CURRENT_USER_ID);t&&t!="0"?t===i+""?this.object.setState(2,0):this.object.setState(1,0):this.object.setState(0,0)}}get widget(){return Ng.RENTABLESPACE}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new At(At.STATE_CHANGE,this.object)),this.eventDispatcher.dispatchEvent(new re(re.RENTABLE_SPACE,this.object)))}}class CZ extends ii{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const e=[re.BACKGROUND_COLOR,El.ROOM_BACKGROUND_COLOR];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this._roomColorUpdated&&(this.eventDispatcher&&this.object&&this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new El(El.ROOM_BACKGROUND_COLOR,this.object,!1,0,0,0)),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof os&&(e.data.writeRoomObjectModel(this.object.model),this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processColorUpdate())}processColorUpdate(){if(!this.object||!this.object.model)return;const e=new bd;e.initializeFromRoomObjectModel(this.object.model);const t=e.getValue(0),i=e.getValue(1),r=e.getValue(2),n=e.getValue(3);t>-1&&i>-1&&r>-1&&n>-1&&(this.object.model.setValue(D.FURNITURE_ROOM_BACKGROUND_COLOR_HUE,i),this.object.model.setValue(D.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION,r),this.object.model.setValue(D.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS,n),this.object.setState(t,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new El(El.ROOM_BACKGROUND_COLOR,this.object,t===1,i,r,n)),this._roomColorUpdated=!0)}mouseEvent(e,t){if(!(!e||!t||!this.object)){switch(e.type){case Re.DOUBLE_CLICK:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new re(re.BACKGROUND_COLOR,this.object));return}super.mouseEvent(e,t)}}}const Ks=class Ks extends $t{constructor(){super(),this._disableFurnitureSelection=!1,this._hasClickUrl=!1}getEventTypes(){const e=[vs.ROOM_AD_LOAD_IMAGE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),this._disableFurnitureSelection&&this.object.model.setValue(D.FURNITURE_SELECTION_DISABLED,1)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof os&&this.processAdDataUpdateMessage(e),e instanceof Pr&&this.processAdUpdate(e)}processAdDataUpdateMessage(e){if(e)try{const t=new Yu;t.initializeFromRoomObjectModel(this.object.model);const i=parseInt(t.getValue(Ks.STATE));!isNaN(i)&&this.object.getState(0)!==i&&this.object.setState(i,0);const r=t.getValue(Ks.IMAGEURL_KEY),n=this.object.model.getValue(D.FURNITURE_BRANDING_IMAGE_URL);(!n||n!==r)&&(this.object.model.setValue(D.FURNITURE_BRANDING_IMAGE_URL,r),this.object.model.setValue(D.FURNITURE_BRANDING_IMAGE_STATUS,0),this.downloadBackground());const o=t.getValue(Ks.CLICKURL_KEY);if(o){const f=this.object.model.getValue(D.FURNITURE_BRANDING_URL);(!f||f!==o)&&this.object.model&&this.object.model.setValue(D.FURNITURE_BRANDING_URL,o)}const l=parseInt(t.getValue(Ks.OFFSETX_KEY)),c=parseInt(t.getValue(Ks.OFFSETY_KEY)),u=parseInt(t.getValue(Ks.OFFSETZ_KEY));isNaN(l)||this.object.model.setValue(D.FURNITURE_BRANDING_OFFSET_X,l),isNaN(c)||this.object.model.setValue(D.FURNITURE_BRANDING_OFFSET_Y,c),isNaN(u)||this.object.model.setValue(D.FURNITURE_BRANDING_OFFSET_Z,u);const d=parseInt(t.getValue(Ks.OPACITY));isNaN(d)||this.object.model.setValue(D.FURNITURE_BRANDING_ALPHA,d);const _=parseInt(t.getValue(Ks.BLEND_MODE));isNaN(_)||this.object.model.setValue(D.FURNITURE_BRANDING_BLEND_MODE,_);let m=Ks.IMAGEURL_KEY+"="+(r!==null?r:"")+"	";this._hasClickUrl&&(m=m+(Ks.CLICKURL_KEY+"="+(o!==null?o:"")+"	")),m=m+(Ks.OFFSETX_KEY+"="+l+"	"),m=m+(Ks.OFFSETY_KEY+"="+c+"	"),m=m+(Ks.OFFSETZ_KEY+"="+u+"	"),m=m+(Ks.OPACITY+"="+d+"	"),m=m+(Ks.BLEND_MODE+"="+_+"	"),this.object.model.setValue(hi.INFOSTAND_EXTRA_PARAM,hi.BRANDING_OPTIONS+m)}catch(t){ze.error(t)}}processAdUpdate(e){if(!(!e||!this.object))switch(e.type){case Pr.IMAGE_LOADED:this.object.model.setValue(D.FURNITURE_BRANDING_IMAGE_STATUS,1);break;case Pr.IMAGE_LOADING_FAILED:this.object.model.setValue(D.FURNITURE_BRANDING_IMAGE_STATUS,-1);break}}mouseEvent(e,t){!e||!t||e.type===Re.MOUSE_MOVE||e.type===Re.DOUBLE_CLICK||super.mouseEvent(e,t)}async downloadBackground(){const e=this.object&&this.object.model;if(!e)return;const t=e.getValue(D.FURNITURE_BRANDING_IMAGE_URL),i=e.getValue(D.FURNITURE_BRANDING_IMAGE_STATUS);if(!(!t||t===""||i===1))if(t.endsWith(".gif"))this.object.model.setValue(D.FURNITURE_BRANDING_IS_ANIMATED,!0),fetch(t).then(r=>r.arrayBuffer()).then(r=>iV(r)).then(r=>{const n=r.lsd.width,o=r.lsd.height,l=n*o,c=rV(r,!1),u=[],d=[];let _=new Uint8Array(l*4);for(let m=0;m<c.length;m++){m>0&&(_=_.slice(0));const f=c[m].pixels,E=c[m].colorTable,I=c[m].transparentIndex,p=c[m].dims;for(let R=0;R<p.height;R++)for(let O=0;O<p.width;O++){const C=f[R*p.width+O],A=(R+p.top)*n+(O+p.left);if(I!==C){const b=E[C];_[4*A]=b[0],_[4*A+1]=b[1],_[4*A+2]=b[2],_[4*A+3]=255}}const S=JI.fromBuffer(_,n,o);u.push(new Qs(S)),d.push(c[m].delay)}De.instance.roomEngine.roomContentLoader.createGifCollection(t,u,d),this.processUpdateMessage(new Pr(Pr.IMAGE_LOADED))}).catch(r=>{this.processUpdateMessage(new Pr(Pr.IMAGE_LOADING_FAILED))});else{const r=vr();if(!r)return;if(!r.getTexture(t)){await r.downloadAsset(t)?this.processUpdateMessage(new Pr(Pr.IMAGE_LOADED)):this.processUpdateMessage(new Pr(Pr.IMAGE_LOADING_FAILED));return}this.processUpdateMessage(new Pr(Pr.IMAGE_LOADED))}}};Ks.STATE="state",Ks.IMAGEURL_KEY="imageUrl",Ks.CLICKURL_KEY="clickUrl",Ks.OFFSETX_KEY="offsetX",Ks.OFFSETY_KEY="offsetY",Ks.OFFSETZ_KEY="offsetZ",Ks.BLEND_MODE="blendMode",Ks.OPACITY="opacity";let yp=Ks;class NZ extends yp{getAdClickUrl(e){return null}}class AZ extends yp{constructor(){super(),this._hasClickUrl=!0}getAdClickUrl(e){return e.getValue(D.FURNITURE_BRANDING_URL)}handleAdClick(e,t,i){if(i.indexOf("http")===0){Xa.openWebPage(i);return}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new vs(vs.ROOM_AD_FURNI_CLICK,this.object,"",i))}}class bZ extends $t{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const e=[re.DIMMER,re.WIDGET_REMOVE_DIMMER,Bu.DIMMER_STATE];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this._roomColorUpdated&&this.eventDispatcher&&this.object&&(this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.eventDispatcher.dispatchEvent(new Bu(this.object,0,1,1,16777215,255)),this.eventDispatcher.dispatchEvent(new re(re.WIDGET_REMOVE_DIMMER,this.object))),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(e){if(e instanceof os){if(e.data){const t=e.data.getLegacyString();this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processDimmerData(t),super.processUpdateMessage(new os(this.getStateFromDimmerData(t),e.data))}return}super.processUpdateMessage(e)}getStateFromDimmerData(e){if(!e)return 0;const t=e.split(",");return t.length>=5?parseInt(t[0])-1:0}processDimmerData(e){if(!e)return;const t=e.split(",");if(t.length>=5){const i=this.getStateFromDimmerData(e),r=parseInt(t[1]),n=parseInt(t[2]),o=t[3];let l=parseInt(o.substr(1),16),c=parseInt(t[4]);i||(l=16777215,c=255),this.eventDispatcher&&this.object&&(this.eventDispatcher.dispatchEvent(new Bu(this.object,i,r,n,l,c)),this._roomColorUpdated=!0)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.DIMMER,this.object))}update(e){super.update(e)}}const ec=class ec extends $t{constructor(){super(),this._score=0,this._scoreIncreaser=50,this._scoreTimer=0}processUpdateMessage(e){if(e instanceof os)return this.updateScore(e.state);super.processUpdateMessage(e)}updateScore(e){this._score=e;const t=this.object.getState(0);if(this._score!==t){let i=this._score-t;i<0&&(i=-i),i*ec.UPDATE_INTERVAL>ec.MAX_UPDATE_TIME?this._scoreIncreaser=ec.MAX_UPDATE_TIME/i:this._scoreIncreaser=ec.UPDATE_INTERVAL,this._scoreTimer=nt()}}update(e){super.update(e);const t=this.object.getState(0);if(t!==this._score&&e>=this._scoreTimer+this._scoreIncreaser){const i=e-this._scoreTimer;let r=i/this._scoreIncreaser,n=1;this._score<t&&(n=-1),r>n*(this._score-t)&&(r=n*(this._score-t)),this.object.setState(t+n*r,0),this._scoreTimer=e-(i-r*this._scoreIncreaser)}}};ec.UPDATE_INTERVAL=50,ec.MAX_UPDATE_TIME=3e3;let nO=ec;class vZ extends $t{processUpdateMessage(e){if(super.processUpdateMessage(e),this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1){const t=this.object.model.getValue(D.FURNITURE_EXTRAS),i=parseInt(t);this.object.model.setValue(hi.INFOSTAND_EXTRA_PARAM,hi.SONGDISK+i)}}}const Cn=class Cn extends ii{constructor(){super(...arguments),this._state=-1,this._sampleId=-1,this._noPitch=!1,this._lastLocZ=0}getEventTypes(){const e=[Ii.ROOM_OBJECT_INITIALIZED,Ii.ROOM_OBJECT_DISPOSED,Ii.PLAY_SAMPLE,Ii.CHANGE_PITCH];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.soundSample&&(this._sampleId=e.logic.soundSample.id,this._noPitch=e.logic.soundSample.noPitch),this.object.model.setValue(D.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,1)}onDispose(){this._state!==Cn.STATE_UNINITIALIZED&&this.eventDispatcher.dispatchEvent(new Ii(Ii.ROOM_OBJECT_DISPOSED,this.object,this._sampleId)),super.onDispose()}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof os&&this.updateSoundBlockMessage(e)}updateSoundBlockMessage(e){if(!e)return;const t=this.object&&this.object.model,i=this.object&&this.object.location;!t||!i||(this._state===Cn.STATE_UNINITIALIZED&&t.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._lastLocZ=i.z,this.eventDispatcher.dispatchEvent(new Ii(Ii.ROOM_OBJECT_INITIALIZED,this.object,this._sampleId,this.getPitchForHeight(i.z)))),this._state!==Cn.STATE_UNINITIALIZED&&t.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&this._lastLocZ!==i.z&&(this._lastLocZ=i.z,this.eventDispatcher.dispatchEvent(new Ii(Ii.CHANGE_PITCH,this.object,this._sampleId,this.getPitchForHeight(i.z)))),this._state!==Cn.STATE_UNINITIALIZED&&e.state!==this._state&&this.playSoundAt(i.z),this._state=e.state)}playSoundAt(e){if(!this.object)return;const t=this.getPitchForHeight(e);this.object.model.setValue(D.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,t),this.eventDispatcher.dispatchEvent(new Ii(Ii.PLAY_SAMPLE,this.object,this._sampleId,t))}getPitchForHeight(e){if(this._noPitch)return 1;let t=e*2;return t>Cn.HIGHEST_SEMITONE?t=Cn.HIGHEST_SEMITONE:t<Cn.LOWEST_SEMITONE&&(t=Cn.LOWEST_SEMITONE),Math.pow(2,t/12)}};Cn.HIGHEST_SEMITONE=24,Cn.LOWEST_SEMITONE=-24,Cn.STATE_UNINITIALIZED=-1;let aO=Cn;class yZ extends ii{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const e=[Ae.SOUND_MACHINE_START,Ae.SOUND_MACHINE_STOP,Ae.SOUND_MACHINE_DISPOSE,Ae.SOUND_MACHINE_INIT];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(e){if(super.processUpdateMessage(e),this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(hi.INFOSTAND_EXTRA_PARAM,hi.JUKEBOX),e instanceof os)){const t=this.object.getState(0);t!==this._currentState&&(this._currentState=t,t===1?this.requestPlayList():t===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new Ae(Ae.SOUND_MACHINE_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new Ae(Ae.SOUND_MACHINE_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Ae(Ae.SOUND_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Ae(Ae.SOUND_MACHINE_DISPOSE,this.object))}}const AI=class AI extends $t{getEventTypes(){const e=[re.STICKIE,Ae.STICKIE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),this.updateColor(),this.object&&this.object.model.setValue(D.FURNITURE_IS_STICKIE,"")}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof bN&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new re(re.STICKIE,this.object)),this.updateColor()}updateColor(){if(!this.object)return;const e=this.object.model.getValue(D.FURNITURE_DATA);let t=AI.STICKIE_COLORS.indexOf(e);t<0&&(t=3),this.object.model.setValue(D.FURNITURE_COLOR,t+1)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Ae(Ae.STICKIE,this.object))}};AI.STICKIE_COLORS=["9CCEFF","FF9CFF","9CFF9C","FFFF33"];let oO=AI;class DZ extends $t{getEventTypes(){const e=[re.TROPHY];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.TROPHY,this.object))}}const tc=class tc extends ii{constructor(){super(),this._total=0,this._lastUpdate=0,this._interval=33}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof os){const t=e.data;if(!t)return;this.updateTotal(t.result)}}updateTotal(e){if(this._total=e,!this._lastUpdate){this.object.model.setValue(D.FURNITURE_VOTE_COUNTER_COUNT,e),this._lastUpdate=nt();return}if(this._total!==this.currentTotal){const t=Math.abs(this._total-this.currentTotal);t*tc.UPDATE_INTERVAL>tc.MAX_UPDATE_TIME?this._interval=tc.MAX_UPDATE_TIME/t:this._interval=tc.UPDATE_INTERVAL,this._lastUpdate=nt()}}update(e){if(super.update(e),this.object&&this.currentTotal!==this._total&&e>=this._lastUpdate+this._interval){const t=e-this._lastUpdate;let i=t/this._interval,r=1;this._total<this.currentTotal&&(r=-1),i>r*(this._total-this.currentTotal)&&(i=r*(this._total-this.currentTotal)),this.object.model.setValue(D.FURNITURE_VOTE_COUNTER_COUNT,this.currentTotal+r*i),this._lastUpdate=e-(t-i*this._interval)}}get currentTotal(){return this.object.model.getValue(D.FURNITURE_VOTE_COUNTER_COUNT)}};tc.UPDATE_INTERVAL=33,tc.MAX_UPDATE_TIME=1e3;let lO=tc;class MZ extends ii{processUpdateMessage(e){if(super.processUpdateMessage(e),!!this.object&&e instanceof os){const t=e.data;t instanceof Cg&&this.object.model.setValue(D.FURNITURE_VOTE_MAJORITY_RESULT,t.result)}}}class jZ extends ii{mouseEvent(e,t){!e||!t||(e.type===Re.DOUBLE_CLICK&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new At(At.STATE_CHANGE,this.object)),super.mouseEvent(e,t))}}class LZ extends ii{initialize(e){super.initialize(e);let t="";e.logic&&e.logic.maskType&&e.logic.maskType!==""&&e.logic.maskType.length>0&&(t=e.logic.maskType),this.object.model.setValue(D.FURNITURE_USES_PLANE_MASK,1),this.object.model.setValue(D.FURNITURE_PLANE_MASK_TYPE,t)}}class PZ extends $t{getEventTypes(){const e=[re.YOUTUBE,da.RODRE_URL_PREFIX];return this.mergeTypes(super.getEventTypes(),e)}update(e){super.update(e),this.object.model.getValue(D.SESSION_URL_PREFIX)||this.eventDispatcher.dispatchEvent(new da(da.RODRE_URL_PREFIX,this.object))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.YOUTUBE,this.object))}}class UZ extends ii{getEventTypes(){const e=[re.HIDE_AREA];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof os){if(e.data.writeRoomObjectModel(this.object.model),!this.object)return;this.object.model.getValue(D.FURNITURE_REAL_ROOM_OBJECT)===1&&this.setupObject()}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new re(re.HIDE_AREA,this.object))}mouseEvent(e,t){if(!e||!t||!this.object)return;let i=null;switch(e.type){case Re.DOUBLE_CLICK:switch(e.spriteTag){case"turn_on":i=new At(At.STATE_CHANGE,this.object);break;case"turn_off":i=new At(At.STATE_CHANGE,this.object);break}if(this.eventDispatcher&&i){this.eventDispatcher.dispatchEvent(i);return}break}super.mouseEvent(e,t)}setupObject(){if(!this.object||!this.object.model)return;const e=new bd;e.initializeFromRoomObjectModel(this.object.model);const t=e.getValue(0),i=e.getValue(1),r=e.getValue(2),n=e.getValue(3),o=e.getValue(4),l=e.getValue(5)==1,c=e.getValue(6)==1,u=e.getValue(7)==1,d=e.getValue(8)==1,_=e.getValue(9)==1;this.object.model.setValue(D.FURNITURE_AREA_HIDE_ROOT_X,i),this.object.model.setValue(D.FURNITURE_AREA_HIDE_ROOT_Y,r),this.object.model.setValue(D.FURNITURE_AREA_HIDE_WIDTH,n),this.object.model.setValue(D.FURNITURE_AREA_HIDE_LENGTH,o),this.object.model.setValue(D.FURNITURE_AREA_HIDE_INVISIBILITY,l?1:0),this.object.model.setValue(D.FURNITURE_AREA_HIDE_WALLITEMS,c?1:0),this.object.model.setValue(D.FURNITURE_AREA_HIDE_INVERT,u?1:0),this.object.model.setValue(D.FURNITURE_AREA_HIDE_INVERT,u?1:0),this.object.model.setValue(D.FURNITURE_AREA_HIDE_ENTITIES,d?1:0),this.object.model.setValue(D.FURNITURE_AREA_HIDE_WALKABLE,_?1:0),this.object.setState(t,0)}}class wZ extends Zg{get engravingDialogType(){return Og.WILD_WEST_WANTED}}class FZ extends Ju{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._postureIndex=0,this._gestureIndex=0,this._headDirectionDelta=0,this._directions=[],this._talkingEndTimestamp=0,this._gestureEndTimestamp=0,this._expressionEndTimestamp=0}getEventTypes(){const e=[rt.CLICK,Bi.POSITION_CHANGED];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){if(!e)return;const t=this.object&&this.object.model;if(t){if(e.logic&&e.logic.model){const i=e.logic.model.directions;if(i&&i.length){for(const r of i)this._directions.push(r);this._directions.sort()}}t.setValue(D.PET_ALLOWED_DIRECTIONS,this._directions)}}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Bi(Bi.OBJECT_REMOVED,this.object)),this._directions=null,this._reportedLocation=null}update(e){if(super.update(e),this._selected&&this.object&&this.eventDispatcher){const t=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==t.x||this._reportedLocation.y!==t.y||this._reportedLocation.z!==t.z)&&(this._reportedLocation||(this._reportedLocation=new Y),this._reportedLocation.assign(t),this.eventDispatcher.dispatchEvent(new Bi(Bi.POSITION_CHANGED,this.object)))}this.object&&this.object.model&&this.updateModel(e,this.object.model)}updateModel(e,t){this._gestureEndTimestamp>0&&e>this._gestureEndTimestamp&&(t.setValue(D.FIGURE_GESTURE,null),this._gestureEndTimestamp=0),this._talkingEndTimestamp>0&&e>this._talkingEndTimestamp&&(t.setValue(D.FIGURE_TALK,0),this._talkingEndTimestamp=0),this._expressionEndTimestamp>0&&e>this._expressionEndTimestamp&&(t.setValue(D.FIGURE_EXPRESSION,0),this._expressionEndTimestamp=0)}processUpdateMessage(e){if(!e||!this.object)return;super.processUpdateMessage(e);const t=this.object&&this.object.model;if(t){if(e instanceof Ap){t.setValue(D.HEAD_DIRECTION,e.headDirection);return}if(e instanceof Cp){const i=new Vo(e.figure);t.setValue(D.FIGURE,e.figure),t.setValue(D.RACE,e.subType),t.setValue(D.PET_PALETTE_INDEX,i.paletteId),t.setValue(D.PET_COLOR,i.color),t.setValue(D.PET_TYPE,i.typeId),t.setValue(D.PET_CUSTOM_LAYER_IDS,i.customLayerIds),t.setValue(D.PET_CUSTOM_PARTS_IDS,i.customPartIds),t.setValue(D.PET_CUSTOM_PALETTE_IDS,i.customPaletteIds),t.setValue(D.PET_IS_RIDING,e.isRiding?1:0);return}if(e instanceof NN){t.setValue(D.FIGURE_POSTURE,e.postureType);return}if(e instanceof CN){t.setValue(D.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+e.numberOfWords*1e3;return}if(e instanceof AN){t.setValue(D.FIGURE_SLEEP,e.isSleeping?1:0);return}if(e instanceof nG){t.setValue(D.FIGURE_GESTURE,e.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(e instanceof Np){this._selected=e.selected,this._reportedLocation=null;return}if(e instanceof Zk){t.setValue(D.FIGURE_EXPERIENCE_TIMESTAMP,this.time),t.setValue(D.FIGURE_GAINED_EXPERIENCE,e.gainedExperience);return}}}mouseEvent(e,t){let i=null;switch(e.type){case Re.MOUSE_CLICK:i=rt.CLICK;break;case Re.DOUBLE_CLICK:break;case Re.MOUSE_DOWN:{this.object.model.getValue(D.PET_TYPE)===ui.MONSTERPLANT&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new rt(rt.MOUSE_DOWN,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown));break}}i&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new rt(i,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown))}}class mG{constructor(){this._width=0,this._height=0,this._wallHeight=0,this._fixedWallsHeight=0,this._tileMap=[],this._holeMap=[],this._doors=[],this._dimensions={minX:0,maxX:0,minY:0,maxY:0},this._restrictsDragging=!1,this._restrictedScale=1,this._restrictsScaling=!1}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}get wallHeight(){return this._wallHeight}set wallHeight(e){this._wallHeight=e}get fixedWallsHeight(){return this._fixedWallsHeight}set fixedWallsHeight(e){this._fixedWallsHeight=e}get tileMap(){return this._tileMap}get holeMap(){return this._holeMap}get doors(){return this._doors}get dimensions(){return this._dimensions}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(e){this._restrictsDragging=e}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(e){this._restrictsScaling=e}get restrictedScale(){return this._restrictedScale}set restrictedScale(e){this._restrictedScale=e}}const bI=class bI{constructor(e,t,i){this.type=e,this.loc=t,this.category=i}get loc(){return this._loc}set loc(e){this._loc||(this._loc=new Y),this._loc.assign(e)}get type(){return this._type}set type(e){this._type=e}get category(){return this._category}set category(e){this._category=e}dispose(){this._loc=null}};bI.WINDOW="window",bI.HOLE="hole";let Zu=bI;class kZ{constructor(){this._masks=[]}get masks(){return this._masks}}class fG{constructor(){this._masks=new Map}get maskCount(){return this._masks.size}dispose(){this._masks&&(this.reset(),this._masks=null)}initialize(e){if(!e)return!1;if(this._masks.clear(),e.masks.length)for(const t of e.masks){if(!t)continue;const i=t.locations.length?t.locations[0]:null;i&&this._masks.set(t.id,new Zu(t.type,i,t.category))}return!0}reset(){for(const e of this._masks.values())e&&e.dispose();this._masks.clear()}addMask(e,t,i,r){const n=new Zu(t,i,r);this._masks.delete(e),this._masks.set(e,n)}removeMask(e){const t=this._masks.get(e);return t?(this._masks.delete(e),t.dispose(),!0):!1}getXML(){const e=new kZ;for(const[t,i]of this._masks.entries()){if(!i)continue;const r=this.getMaskType(i),n=this.getMaskCategory(i),o=this.getMaskLocation(i);if(r&&n&&o){const l={id:t,type:r,category:n,locations:[{x:o.x,y:o.y,z:o.z}]};e.masks.push(l)}}return e}getMaskLocation(e){return e?e.loc:null}getMaskType(e){return e?e.type:null}getMaskCategory(e){return e?e.category:null}get masks(){return this._masks}}class GZ{constructor(e,t,i,r){this._leftSideLoc=0,this._rightSideLoc=0,this._leftSideLength=0,this._rightSideLength=0,this._leftSideLoc=e,this._rightSideLoc=t,this._leftSideLength=i,this._rightSideLength=r}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}const xu=class xu{constructor(e,t,i,r,n){this._type=0,this._loc=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._normalDirection=null;let o,l,c,u,d,_,m,f;if(this._secondaryNormals=[],this._masks=[],this._loc=new Y,this._loc.assign(t),this._leftSide=new Y,this._leftSide.assign(i),this._rightSide=new Y,this._rightSide.assign(r),this._type=e,i!=null&&r!=null&&(this._normal=Y.crossProduct(i,r),o=0,l=0,c=0,u=0,d=0,this.normal.x!=0||this.normal.y!=0?(u=this.normal.x,d=this.normal.y,o=360+Math.atan2(d,u)/Math.PI*180,o>=360&&(o=o-360),u=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y),d=this.normal.z,l=360+Math.atan2(d,u)/Math.PI*180,l>=360&&(l=l-360)):this.normal.z<0?l=90:l=270,this._normalDirection=new Y(o,l,c)),n!=null&&n.length>0)for(_=0;_<n.length;)m=n[_],m!=null&&m.length>0&&(f=new Y,f.assign(m),f.multiply(1/f.length),this._secondaryNormals.push(f)),_++}get type(){return this._type}get loc(){return this._loc}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get normal(){return this._normal}get normalDirection(){return this._normalDirection}get secondaryNormalCount(){return this._secondaryNormals.length}get maskCount(){return this._masks.length}getSecondaryNormal(e){if(e<0||e>=this.secondaryNormalCount)return null;const t=new Y;return t.assign(this._secondaryNormals[e]),t}addMask(e,t,i,r){const n=new GZ(e,t,i,r);this._masks.push(n)}getMask(e){return e<0||e>=this.maskCount?null:this._masks[e]}getMaskLeftSideLoc(e){const t=this.getMask(e);return t!=null?t.leftSideLoc:-1}getMaskRightSideLoc(e){const t=this.getMask(e);return t!=null?t.rightSideLoc:-1}getMaskLeftSideLength(e){const t=this.getMask(e);return t!=null?t.leftSideLength:-1}getMaskRightSideLength(e){const t=this.getMask(e);return t!=null?t.rightSideLength:-1}};xu.PLANE_UNDEFINED=0,xu.PLANE_FLOOR=1,xu.PLANE_WALL=2,xu.PLANE_LANDSCAPE=3,xu.PLANE_BILLBOARD=4;let Xs=xu;class Hb{constructor(e,t,i,r){this._x=e,this._y=t,this._width=i,this._height=r}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}const od=class od{constructor(){this._corners=[],this._endPoints=[],this._directions=[],this._lengths=[],this._leftTurns=[],this._borders=[],this._hideWalls=[],this._manuallyLeftCut=[],this._manuallyRightCut=[],this._addDuplicates=!1,this._count=0}addWall(e,t,i,r,n){(this._addDuplicates||this.checkIsNotDuplicate(e,t,i,r,n))&&(this._corners.push(e),this._directions.push(t),this._lengths.push(i),this._borders.push(r),this._leftTurns.push(n),this._hideWalls.push(!1),this._manuallyLeftCut.push(!1),this._manuallyRightCut.push(!1),this._count++)}checkIsNotDuplicate(e,t,i,r,n){let o=0;for(;o<this._count;){if(this._corners[o].x==e.x&&this._corners[o].y==e.y&&this._directions[o]==t&&this._lengths[o]==i&&this._borders[o]==r&&this._leftTurns[o]==n)return!1;o++}return!0}get count(){return this._count}getCorner(e){return this._corners[e]}getEndPoint(e){return this.calculateWallEndPoints(),this._endPoints[e]}getLength(e){return this._lengths[e]}getDirection(e){return this._directions[e]}getBorder(e){return this._borders[e]}getHideWall(e){return this._hideWalls[e]}getLeftTurn(e){return this._leftTurns[e]}getManuallyLeftCut(e){return this._manuallyLeftCut[e]}getManuallyRightCut(e){return this._manuallyRightCut[e]}setHideWall(e,t){this._hideWalls[e]=t}setLength(e,t){t<this._lengths[e]&&(this._lengths[e]=t,this._manuallyRightCut[e]=!0)}moveCorner(e,t){let i;if(t>0&&t<this._lengths[e]){const r=this._corners[e];i=od.WALL_DIRECTION_VECTORS[this.getDirection(e)],this._corners[e]=new ot(r.x+t*i.x,r.y+t*i.y),this._lengths[e]=this._lengths[e]-t,this._manuallyLeftCut[e]=!0}}calculateWallEndPoints(){let e,t,i,r,n;if(this._endPoints.length!=this.count)for(this._endPoints=[],e=0;e<this.count;)t=this.getCorner(e),i=new ot(t.x,t.y),r=od.WALL_DIRECTION_VECTORS[this.getDirection(e)],n=this.getLength(e),i.x=i.x+r.x*n,i.y=i.y+r.y*n,this._endPoints.push(i),e++}};od.WALL_DIRECTION_VECTORS=[new Y(1,0,0),new Y(0,1,0),new Y(-1,0,0),new Y(0,-1,0)],od.WALL_NORMAL_VECTORS=[new Y(0,1,0),new Y(-1,0,0),new Y(0,-1,0),new Y(1,0,0)];let io=od;const Lt=class Lt{constructor(){this._width=0,this._height=0,this._fixedWallHeight=-1,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._floorHeight=0,this._restrictsScaling=!1,this._restrictedScale=1,this._tileMatrix=[],this._tileMatrixOriginal=[],this._highlights=[],this._planes=[],this._floorHoleMatrix=[],this._wallHeight=3.6,this._wallThicknessMultiplier=1,this._floorThicknessMultiplier=1,this._floorHoles=new Map,this._floorHolesInverted=new Map}get minX(){return this._minX}get maxX(){return this._maxX}get minY(){return this._minY}get maxY(){return this._maxY}get wallHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight+3.6:this._wallHeight}set wallHeight(e){e<0&&(e=0),this._wallHeight=e}get wallThicknessMultiplier(){return this._wallThicknessMultiplier}set wallThicknessMultiplier(e){e<0&&(e=0),this._wallThicknessMultiplier=e}get floorThicknessMultiplier(){return this._floorThicknessMultiplier}set floorThicknessMultiplier(e){e<0&&(e=0),this._floorThicknessMultiplier=e}get floorHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight:this._floorHeight}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(e){this._restrictsDragging=e}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(e){this._restrictsScaling=e}get restrictedScale(){return this._restrictedScale}set restrictedScale(e){this._restrictedScale=e}get tileMapWidth(){return this._width}get tileMapHeight(){return this._height}get planeCount(){return this._planes.length}static getFloorHeight(e){const t=e.length;if(!t)return 0;let i=0,r=0;for(;r<t;){const n=e[r];let o=0;for(;o<n.length;){const l=n[o];l>i&&(i=l),o++}r++}return i}static findEntranceTile(e){if(!e)return null;const t=e.length;if(!t)return null;const i=[];let r=0;for(;r<t;){const n=e[r];if(!n||!n.length)return null;let o=0;for(;o<n.length;){if(n[o]>=0){i.push(o);break}o++}i.length<r+1&&i.push(n.length+1),r++}for(r=1;r<i.length-1;){if(Math.trunc(i[r])<=Math.trunc(i[r-1])-1&&Math.trunc(i[r])<=Math.trunc(i[r+1])-1)return new ot(Math.trunc(i[r]|0),r);r++}return null}static expandFloorTiles(e){let t,i,r,n,o,l,c,u,d,_,m,f;const E=e.length,I=e[0].length,p=[];for(i=0;i<E*4;)p[i]=[],i++;let S=0;for(i=0;i<E;){for(o=0,t=0;t<I;){if(l=e[i][t],l<0||l<=255)for(n=0;n<4;){for(r=0;r<4;)p[S+n]===void 0&&(p[S+n]=[]),p[S+n][o+r]=l<0?l:l*4,r++;n++}else{for(c=(l&255)*4,u=c+(l>>11&1)*3,d=c+(l>>10&1)*3,_=c+(l>>9&1)*3,m=c+(l>>8&1)*3,r=0;r<3;)f=r+1,p[S][o+r]=(u*(3-r)+d*r)/3,p[S+3][o+f]=(_*(3-f)+m*f)/3,p[S+f][o]=(u*(3-f)+_*f)/3,p[S+r][o+3]=(d*(3-r)+m*r)/3,r++;p[S+1][o+1]=u>c?c+2:c+1,p[S+1][o+2]=d>c?c+2:c+1,p[S+2][o+1]=_>c?c+2:c+1,p[S+2][o+2]=m>c?c+2:c+1}o=o+4,t++}S=S+4,i++}return p}static addTileTypes(e){let t,i,r,n,o,l,c,u,d,_,m,f,E;const I=e.length-1,p=e[0].length-1;for(i=1;i<I;){for(t=1;t<p;)r=e[i][t],r<0||(n=e[i-1][t-1]&255,o=e[i-1][t]&255,l=e[i-1][t+1]&255,c=e[i][t-1]&255,u=e[i][t+1]&255,d=e[i+1][t-1]&255,_=e[i+1][t]&255,m=e[i+1][t+1]&255,f=r+1,E=(n==f||o==f||c==f?8:0)|(l==f||o==f||u==f?4:0)|(d==f||_==f||c==f?2:0)|(m==f||_==f||u==f?1:0),E==15&&(E=0),e[i][t]=r|E<<8),t++;i++}}static unpadHeightMap(e){e.shift(),e.pop();for(const t of e)t.shift(),t.pop()}static padHeightMap(e){const t=[],i=[];for(const r of e)r.push(Lt.TILE_BLOCKED),r.unshift(Lt.TILE_BLOCKED);for(const r of e[0])t.push(Lt.TILE_BLOCKED),i.push(Lt.TILE_BLOCKED);e.push(i),e.unshift(t)}dispose(){this._planes=null,this._tileMatrix=null,this._tileMatrixOriginal=null,this._floorHoleMatrix=null,this._floorHoles!=null&&(this._floorHoles.clear(),this._floorHoles=null),this._floorHolesInverted!=null&&(this._floorHolesInverted.clear(),this._floorHolesInverted=null)}reset(){this._planes=[],this._tileMatrix=[],this._tileMatrixOriginal=[],this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._floorHeight=0,this._floorHoleMatrix=[]}initializeTileMap(e,t){e<0&&(e=0),t<0&&(t=0),this._tileMatrix=[],this._tileMatrixOriginal=[],this._floorHoleMatrix=[];let i=0;for(;i<t;){const r=[],n=[],o=[];let l=0;for(;l<e;)r[l]=Lt.TILE_BLOCKED,n[l]=Lt.TILE_BLOCKED,o[l]=!1,l++;this._tileMatrix.push(r),this._tileMatrixOriginal.push(n),this._floorHoleMatrix.push(o),i++}return this._width=e,this._height=t,this._minX=this._width,this._maxX=-1,this._minY=this._height,this._maxY=-1,!0}setTileHeight(e,t,i){let r,n,o,l,c;if(e>=0&&e<this._width&&t>=0&&t<this._height){if(r=this._tileMatrix[t],r[e]=i,i>=0)e<this._minX&&(this._minX=e),e>this._maxX&&(this._maxX=e),t<this._minY&&(this._minY=t),t>this._maxY&&(this._maxY=t);else{if(e==this._minX||e==this._maxX){for(n=!1,o=this._minY;o<this._maxY;){if(this.getTileHeightInternal(e,o)>=0){n=!0;break}o++}n||(e==this._minX&&this._minX++,e==this._maxX&&this._maxX--)}if(t==this._minY||t==this._maxY){for(l=!1,c=this._minX;c<this._maxX;){if(this.getTileHeight(c,t)>=0){l=!0;break}c++}l||(t==this._minY&&this._minY++,t==this._maxY&&this._maxY--)}}return!0}return!1}getTileHeight(e,t){if(e<0||e>=this._width||t<0||t>=this._height)return Lt.TILE_BLOCKED;const i=this._tileMatrix[t];return i[e]===void 0?0:Math.abs(i[e])}initializeFromTileData(e=-1){let t,i;for(this._fixedWallHeight=e,i=0;i<this._height;){for(t=0;t<this._width;)this._tileMatrixOriginal[i]===void 0&&(this._tileMatrixOriginal[i]=[]),this._tileMatrixOriginal[i][t]=this._tileMatrix[i][t],t++;i++}const r=Lt.findEntranceTile(this._tileMatrix);for(i=0;i<this._height;){for(t=0;t<this._width;)this._floorHoleMatrix[i]===void 0&&(this._floorHoleMatrix[i]=[]),this._floorHoleMatrix[i][t]&&this.setTileHeight(t,i,Lt.TILE_HOLE),t++;i++}return this.initialize(r)}initializeHighlightArea(e,t,i,r){this.clearHighlightArea(),this.extractPlanes(this.floorTiles,e*4,t*4,i*4,r*4,!0)}clearHighlightArea(){const e=this._highlights.length;return this._planes=this._planes.slice(0,this._planes.length-this._highlights.length),this._highlights.length=0,e}initializeFromMapData(e){if(!e)return!1;this.reset(),this.resetFloorHoles();const t=e.width,i=e.height,r=e.wallHeight,n=e.fixedWallsHeight;if(this.initializeTileMap(t,i),e.tileMap){let o=0;for(;o<e.tileMap.length;){const l=e.tileMap[o];if(l){let c=0;for(;c<l.length;){const u=l[c];u&&this.setTileHeight(c,o,u.height),c++}}o++}}if(e.holeMap&&e.holeMap.length){let o=0;for(;o<e.holeMap.length;){const l=e.holeMap[o];l&&(this.addFloorHole(l.id,l.x,l.y,l.width,l.height,l.invert),o++)}this.initializeHoleMap()}return this.wallHeight=r,this.restrictsDragging=e.restrictsDragging,this.restrictsScaling=e.restrictsScaling,this.restrictedScale=e.restrictedScale,this.initializeFromTileData(n),!0}isPlaneTemporaryHighlighter(e){if(e<0||e>=this.planeCount)return!1;const t=this._planes[e];return t==null?!1:this._highlights.indexOf(t)!=-1}getMapData(){const e=new mG;e.width=this._width,e.height=this._height,e.wallHeight=this._wallHeight,e.fixedWallsHeight=this._fixedWallHeight,e.dimensions.minX=this.minX,e.dimensions.maxX=this.maxX,e.dimensions.minY=this.minY,e.dimensions.maxY=this.maxY,e.restrictsDragging=this.restrictsDragging,e.restrictsScaling=this.restrictsScaling,e.restrictedScale=this.restrictedScale;let t=0;for(;t<this._height;){const i=[],r=this._tileMatrixOriginal[t];let n=0;for(;n<this._width;){const o=r[n];i.push({height:o}),n++}e.tileMap.push(i),t++}for(const[i,r]of this._floorHoles.entries())r&&e.holeMap.push({id:i,x:r.x,y:r.y,width:r.width,height:r.height,invert:!1});for(const[i,r]of this._floorHolesInverted.entries())r&&e.holeMap.push({id:i,x:r.x,y:r.y,width:r.width,height:r.height,invert:!0});return e}getPlaneLocation(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.loc:null}getPlaneNormal(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.normal:null}getPlaneLeftSide(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.leftSide:null}getPlaneRightSide(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.rightSide:null}getPlaneNormalDirection(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.normalDirection:null}getPlaneSecondaryNormals(e){let t,i;if(e<0||e>=this.planeCount)return null;const r=this._planes[e];if(r!=null){for(t=[],i=0;i<r.secondaryNormalCount;)t.push(r.getSecondaryNormal(i)),i++;return t}return null}getPlaneType(e){if(e<0||e>=this.planeCount)return Xs.PLANE_UNDEFINED;const t=this._planes[e];return t?t.type:Xs.PLANE_UNDEFINED}getPlaneMaskCount(e){if(e<0||e>=this.planeCount)return 0;const t=this._planes[e];return t?t.maskCount:0}getPlaneMaskLeftSideLoc(e,t){if(e<0||e>=this.planeCount)return-1;const i=this._planes[e];return i?i.getMaskLeftSideLoc(t):-1}getPlaneMaskRightSideLoc(e,t){if(e<0||e>=this.planeCount)return-1;const i=this._planes[e];return i?i.getMaskRightSideLoc(t):-1}getPlaneMaskLeftSideLength(e,t){if(e<0||e>=this.planeCount)return-1;const i=this._planes[e];return i?i.getMaskLeftSideLength(t):-1}getPlaneMaskRightSideLength(e,t){if(e<0||e>=this.planeCount)return-1;const i=this._planes[e];return i?i.getMaskRightSideLength(t):-1}addFloorHole(e,t,i,r,n,o=!1){this.removeFloorHole(e),o?this._floorHolesInverted.set(e,new Hb(t,i,r,n)):this._floorHoles.set(e,new Hb(t,i,r,n))}removeFloorHole(e){this._floorHoles.delete(e),this._floorHolesInverted.delete(e)}resetFloorHoles(){this._floorHoles.clear(),this._floorHolesInverted.clear()}getTileHeightOriginal(e,t){return e<0||e>=this._width||t<0||t>=this._height?Lt.TILE_BLOCKED:this._floorHoleMatrix[t][e]?Lt.TILE_HOLE:this._tileMatrixOriginal[t][e]}getTileHeightInternal(e,t){return e<0||e>=this._width||t<0||t>=this._height?Lt.TILE_BLOCKED:this._tileMatrix[t][e]}initialize(e){let t=0;e!=null&&(t=this.getTileHeight(e.x,e.y),this.setTileHeight(e.x,e.y,Lt.TILE_BLOCKED)),this._floorHeight=Lt.getFloorHeight(this._tileMatrix),this.createWallPlanes();const i=[];for(const r of this._tileMatrix)i.push(r.concat());return Lt.padHeightMap(i),Lt.addTileTypes(i),Lt.unpadHeightMap(i),this.floorTiles=Lt.expandFloorTiles(i),this.extractPlanes(this.floorTiles),e!=null&&(this.setTileHeight(e.x,e.y,t),this.addFloor(new Y(e.x+.5,e.y+.5,t),new Y(-1,0,0),new Y(0,-1,0),!1,!1,!1,!1)),!0}generateWallData(e,t){let i,r,n,o,l;const c=new io,u=[this.extractTopWall.bind(this),this.extractRightWall.bind(this),this.extractBottomWall.bind(this),this.extractLeftWall.bind(this)];let d=0,_=new ot(e.x,e.y),m=0;for(;m++<1e3;){if(i=!1,r=!1,n=d,(_.x<this.minX||_.x>this.maxX||_.y<this.minY||_.y>this.maxY)&&(i=!0),o=u[d](_,t),o==null)return null;if(l=Math.abs(o.x-_.x)+Math.abs(o.y-_.y),_.x==o.x||_.y==o.y?(d=(d-1+u.length)%u.length,l=l+1,r=!0):(d=(d+1)%u.length,l--),c.addWall(_,n,l,i,r),o.x==e.x&&o.y==e.y&&(o.x!=_.x||o.y!=_.y))break;_=o}return c.count==0?null:c}hidePeninsulaWallChains(e){let t,i,r,n,o=0;const l=e.count;for(;o<l;){const c=o;for(t=o,i=0,r=!1;!e.getBorder(o)&&o<l;)e.getLeftTurn(o)?i++:i>0&&i--,i>1&&(r=!0),t=o,o++;if(r)for(n=c;n<=t;)e.setHideWall(n,!0),n++;o++}}updateWallsNextToHoles(e){let t,i,r,n,o,l,c;const u=e.count;let d=0;for(;d<u;){if(!e.getHideWall(d)){for(t=e.getCorner(d),i=e.getDirection(d),r=e.getLength(d),n=io.WALL_DIRECTION_VECTORS[i],o=io.WALL_NORMAL_VECTORS[i],l=0,c=0;c<r;){if(this.getTileHeightInternal(t.x+c*n.x-o.x,t.y+c*n.y-o.y)==Lt.TILE_HOLE){if(c>0&&l==0){e.setLength(d,c);break}l++}else if(l>0){e.moveCorner(d,l);break}c++}l==r&&e.setHideWall(d,!0)}d++}}resolveOriginalWallIndex(e,t,i){let r,n,o,l,c,u;const d=Math.min(e.y,t.y),_=Math.max(e.y,t.y),m=Math.min(e.x,t.x),f=Math.max(e.x,t.x),E=i.count;let I=0;for(;I<E;){if(r=i.getCorner(I),n=i.getEndPoint(I),e.x==t.x){if(r.x==e.x&&n.x==e.x&&(o=Math.min(r.y,n.y),l=Math.max(r.y,n.y),o<=d&&_<=l))return I}else if(e.y==t.y&&r.y==e.y&&n.y==e.y&&(c=Math.min(r.x,n.x),u=Math.max(r.x,n.x),c<=m&&f<=u))return I;I++}return-1}hideOriginallyHiddenWalls(e,t){let i,r,n,o,l;const c=e.count;let u=0;for(;u<c;)e.getHideWall(u)||(i=e.getCorner(u),r=new ot(i.x,i.y),n=io.WALL_DIRECTION_VECTORS[e.getDirection(u)],o=e.getLength(u),r.x=r.x+n.x*o,r.y=r.y+n.y*o,l=this.resolveOriginalWallIndex(i,r,t),l>=0?t.getHideWall(l)&&e.setHideWall(u,!0):e.setHideWall(u,!0)),u++}checkWallHiding(e,t){this.hidePeninsulaWallChains(t),this.updateWallsNextToHoles(e),this.hideOriginallyHiddenWalls(e,t)}addWalls(e,t){const i=e.count,r=t.count;let n=0;for(;n<i;){if(!e.getHideWall(n)){const o=e.getCorner(n),l=e.getDirection(n),c=e.getLength(n),u=io.WALL_DIRECTION_VECTORS[l],d=io.WALL_NORMAL_VECTORS[l];let _=-1,m=0;for(;m<c;){const F=this.getTileHeightInternal(o.x+m*u.x+d.x,o.y+m*u.y+d.y);F>=0&&(F<_||_<0)&&(_=F),m++}const f=_;let E=new Y(o.x,o.y,f);E=Y.sum(E,Y.product(d,.5)),E=Y.sum(E,Y.product(u,-.5));const I=this.wallHeight+Math.min(Lt.MAX_WALL_ADDITIONAL_HEIGHT,this.floorHeight)-_,p=Y.product(u,-c),S=new Y(0,0,I);E=Y.dif(E,p);const R=this.resolveOriginalWallIndex(o,e.getEndPoint(n),t);let O=0,C=0;R>=0?(O=t.getDirection((R+1)%r),C=t.getDirection((R-1+r)%r)):(O=e.getDirection((n+1)%i),C=e.getDirection((n-1+i)%i));let A=null;(O-l+4)%4==3?A=io.WALL_NORMAL_VECTORS[O]:(l-C+4)%4==3&&(A=io.WALL_NORMAL_VECTORS[C]);const b=e.getLeftTurn(n),y=e.getLeftTurn((n-1+i)%i),M=e.getHideWall((n+1)%i),U=e.getManuallyLeftCut(n),G=e.getManuallyRightCut(n);this.addWall(E,p,S,A,!y||U,!b||G,!M)}n++}}createWallPlanes(){const e=this._tileMatrix;if(e==null)return!1;let t,i,r;const n=e.length;let o=0;if(n==0)return!1;for(t=0;t<n;){if(r=e[t],r==null||r.length==0)return!1;o>0?o=Math.min(o,r.length):o=r.length,t++}const l=Math.min(Lt.MAX_WALL_ADDITIONAL_HEIGHT,this._fixedWallHeight!=-1?this._fixedWallHeight:Lt.getFloorHeight(e)),c=this.minX;let u=this.minY;for(u=this.minY;u<=this.maxY;){if(this.getTileHeightInternal(c,u)>Lt.TILE_HOLE){u--;break}u++}if(u>this.maxY)return!1;const d=new ot(c,u),_=this.generateWallData(d,!0),m=this.generateWallData(d,!1);for(_!=null&&(_.count,m.count,this.checkWallHiding(_,m),this.addWalls(_,m)),i=0;i<this.tileMapHeight;){for(t=0;t<this.tileMapWidth;)this.getTileHeightInternal(t,i)<0&&this.setTileHeight(t,i,-(l+this.wallHeight)),t++;i++}return!0}extractTopWall(e,t){if(e==null)return null;let i=1,r=Lt.TILE_HOLE;for(t||(r=Lt.TILE_BLOCKED);i<1e3;){if(this.getTileHeightInternal(e.x+i,e.y)>r)return new ot(e.x+i-1,e.y);if(this.getTileHeightInternal(e.x+i,e.y+1)<=r)return new ot(e.x+i,e.y+1);i++}return null}extractRightWall(e,t){if(e==null)return null;let i=1,r=Lt.TILE_HOLE;for(t||(r=Lt.TILE_BLOCKED);i<1e3;){if(this.getTileHeightInternal(e.x,e.y+i)>r)return new ot(e.x,e.y+(i-1));if(this.getTileHeightInternal(e.x-1,e.y+i)<=r)return new ot(e.x-1,e.y+i);i++}return null}extractBottomWall(e,t){if(e==null)return null;let i=1,r=Lt.TILE_HOLE;for(t||(r=Lt.TILE_BLOCKED);i<1e3;){if(this.getTileHeightInternal(e.x-i,e.y)>r)return new ot(e.x-(i-1),e.y);if(this.getTileHeightInternal(e.x-i,e.y-1)<=r)return new ot(e.x-i,e.y-1);i++}return null}extractLeftWall(e,t){if(e==null)return null;let i=1,r=Lt.TILE_HOLE;for(t||(r=Lt.TILE_BLOCKED);i<1e3;){if(this.getTileHeightInternal(e.x,e.y-i)>r)return new ot(e.x,e.y-(i-1));if(this.getTileHeightInternal(e.x+1,e.y-i)<=r)return new ot(e.x+1,e.y-i);i++}return null}addWall(e,t,i,r,n,o,l){this.addPlane(Xs.PLANE_WALL,e,t,i,[r]),this.addPlane(Xs.PLANE_LANDSCAPE,e,t,i,[r]);const c=Lt.WALL_THICKNESS*this._wallThicknessMultiplier,u=Lt.FLOOR_THICKNESS*this._floorThicknessMultiplier,d=Y.crossProduct(t,i),_=Y.product(d,1/d.length*-c);if(this.addPlane(Xs.PLANE_WALL,Y.sum(e,i),t,_,[d,r]),n&&this.addPlane(Xs.PLANE_WALL,Y.sum(Y.sum(e,t),i),Y.product(i,-(i.length+u)/i.length),_,[d,r]),o&&(this.addPlane(Xs.PLANE_WALL,Y.sum(e,Y.product(i,-u/i.length)),Y.product(i,(i.length+u)/i.length),_,[d,r]),l)){const m=Y.product(t,c/t.length);this.addPlane(Xs.PLANE_WALL,Y.sum(Y.sum(e,i),Y.product(m,-1)),m,_,[d,t,r])}}addFloor(e,t,i,r,n,o,l,c=!1){let u,d,_;this.addPlane(Xs.PLANE_FLOOR,e,t,i,null,c)!=null&&(u=Lt.FLOOR_THICKNESS*this._floorThicknessMultiplier,d=new Y(0,0,u),_=Y.dif(e,d),o&&this.addPlane(Xs.PLANE_FLOOR,_,t,d,null,c),l&&this.addPlane(Xs.PLANE_FLOOR,Y.sum(_,Y.sum(t,i)),Y.product(t,-1),d,null,c),r&&this.addPlane(Xs.PLANE_FLOOR,Y.sum(_,i),Y.product(i,-1),d,null,c),n&&this.addPlane(Xs.PLANE_FLOOR,Y.sum(_,t),i,d,null,c))}addPlane(e,t,i,r,n=null,o=!1){if(i.length==0||r.length==0)return null;const l=new Xs(e,t,i,r,n);return this._planes.push(l),o&&this._highlights.push(l),l}initializeHoleMap(){let e,t,i;for(t=0;t<this._height;){for(i=this._floorHoleMatrix[t],e=0;e<this._width;)i[e]=this._floorHolesInverted.size>0,e++;t++}for(const r of this._floorHolesInverted.values())this.initializeHole(r,!0);for(const r of this._floorHoles.values())this.initializeHole(r)}initializeHole(e,t=!1){let i,r,n,o,l,c,u,d;if(o=e,o!=null)for(l=o.x,c=o.x+o.width-1,u=o.y,d=o.y+o.height-1,l=l<0?0:l,c=c>=this._width?this._width-1:c,u=u<0?0:u,d=d>=this._height?this._height-1:d,r=u;r<=d;){for(n=this._floorHoleMatrix[r],i=l;i<=c;)n[i]=!t,i++;r++}}extractPlanes(e,t=0,i=0,r=-1,n=-1,o=!1){let l=0,c=0,u=0,d=0,_=0,m=0,f=!1,E=!1,I=!1,p=!1,S=0,R=0,O=!1,C=NaN,A=NaN,b=NaN,y=NaN;const M=e.length,U=e[0].length,G=n==-1?M:Math.min(M,i+n),F=r==-1?U:Math.min(U,t+r),H=[];for(l=0;l<G;)H[l]=[],l++;for(c=i;c<G;){for(u=t;u<F;){if(!((d=e[c][u])<0||H[c][u])){for(f=u==0||e[c][u-1]!=d,E=c==0||e[c-1][u]!=d,_=u+1;_<F&&!(e[c][_]!=d||H[c][_]||c>0&&e[c-1][_]==d==E);)_++;for(I=_==U||e[c][_]!=d,O=!1,m=c+1;m<=G&&!O&&(p=m==M||e[m][u]!=d,O=m==G||p||u>0&&e[m][u-1]==d==f||_<U&&e[m][_]==d==I,m!=M);){for(S=u;S<_;){if(e[m][S]==d==p){O=!0,_=S;break}S++}if(O)break;m++}for(p||(p=m==M),I=_==U||e[c][_]!=d,R=c;R<m;){for(S=u;S<_;)H[R][S]=!0,S++;R++}C=u/4-.5,A=c/4-.5,b=(_-u)/4,y=(m-c)/4,this.addFloor(new Y(C+b,A+y,d/4),new Y(-b,0,0),new Y(0,-y,0),I,f,p,E,o)}u++}c++}}};Lt.TILE_BLOCKED=-110,Lt.TILE_HOLE=-100,Lt.FLOOR_THICKNESS=.25,Lt.WALL_THICKNESS=.25,Lt.MAX_WALL_ADDITIONAL_HEIGHT=20;let vi=Lt;class pG{constructor(e,t,i){this._id=e,this._type=t,this._visualization=i}dispose(){this._visualization=null}update(e,t){}animate(e){return!1}get id(){return this._id}get type(){return this._type}get visualization(){return this._visualization}}const un=class un extends pG{constructor(e,t,i){super(e,t,i),this._asset=null,this._startTime=nt(),this._delta=0,this._offsetY=0,this._scale=0,this._state=0}update(e,t){if(!e)return;this._scale=t;let i=64,r=0;if(t<48?(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss_small"),this.visualization.angle===90||this.visualization.angle===270?r=0:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?r=6:r=-6,this._offsetY=-38,i=32):(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss"),this.visualization.angle===90||this.visualization.angle===270?r=-3:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?r=22:r=-30,this._offsetY=-70),this.visualization.posture===We.POSTURE_SIT?this._offsetY+=i/2:this.visualization.posture===We.POSTURE_LAY&&(this._offsetY+=i),this._asset){e.texture=this._asset,e.offsetX=r,e.offsetY=this._offsetY,e.relativeDepth=-.02,e.alpha=0;const n=this._delta;this.animate(e),this._delta=n}}animate(e){if(!e)return!1;if(this._asset&&(e.texture=this._asset),this._state===un.STATE_DELAY)return nt()-this._startTime<un.DELAY_BEFORE_ANIMATION?!1:(this._state=un.STATE_FADE_IN,e.alpha=0,e.visible=!0,this._delta=0,!0);if(this._state===un.STATE_FADE_IN)return this._delta+=.1,e.offsetY=this._offsetY,e.alpha=Math.pow(this._delta,.9)*255,this._delta>=1&&(e.alpha=255,this._delta=0,this._state=un.STATE_FLOAT),!0;if(this._state===un.STATE_FLOAT){const t=Math.pow(this._delta,.9);this._delta+=.05;const i=this._scale<48?-30:-40;return e.offsetY=this._offsetY+(this._delta<1?t:1)*i,e.alpha=(1-t)*255,e.alpha<=0&&(e.visible=!1,this._state=un.STATE_COMPLETE),!0}return!1}};un.DELAY_BEFORE_ANIMATION=300,un.STATE_DELAY=0,un.STATE_FADE_IN=1,un.STATE_FLOAT=2,un.STATE_COMPLETE=3;let cO=un;const Ou=class Ou{static getExpressionAddition(e,t,i){switch(t){case this.BLOW:return new cO(e,this.BLOW,i);default:return new pG(e,t,i)}}};Ou.WAVE=1,Ou.BLOW=2,Ou.LAUGH=3,Ou.CRY=4,Ou.IDLE=5;let uO=Ou;const cr=class cr{constructor(e,t){this._id=e,this._visualization=t,this._asset=null,this._startTime=nt(),this._offsetY=0,this._scale=0,this._state=0}dispose(){this._visualization=null,this._asset=null}getSpriteAssetName(e){let t="left";return(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270)&&(t="right"),"avatar_addition_user_idle_"+t+"_"+e+(this._scale<48?"_small":"")}update(e,t){if(!e)return;this._scale=t,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(this._state===cr.STATE_FRAME_A?1:2));let i=64,r=0;t<48?(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?r=10:r=-16,this._offsetY=-38,i=32):(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?r=22:r=-30,this._offsetY=-70),this._visualization.posture===We.POSTURE_SIT?this._offsetY+=i/2:this._visualization.posture===We.POSTURE_LAY&&(this._offsetY+=i-.3*i),this._asset&&(e.texture=this._asset,e.offsetX=r,e.offsetY=this._offsetY,e.relativeDepth=-.02,e.alpha=0)}animate(e){if(!e)return!1;const t=nt();return this._state===cr.STATE_DELAY&&t-this._startTime>=cr.DELAY_BEFORE_ANIMATION&&(this._state=cr.STATE_FRAME_A,this._startTime=t,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._state===cr.STATE_FRAME_A&&t-this._startTime>=cr.DELAY_PER_FRAME&&(this._state=cr.STATE_FRAME_B,this._startTime=t,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(2))),this._state===cr.STATE_FRAME_B&&t-this._startTime>=cr.DELAY_PER_FRAME&&(this._state=cr.STATE_FRAME_A,this._startTime=t,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._asset?(e.texture=this._asset,e.alpha=255,e.visible=!0):e.visible=!1,!1}get id(){return this._id}};cr.DELAY_BEFORE_ANIMATION=2e3,cr.DELAY_PER_FRAME=2e3,cr.STATE_DELAY=0,cr.STATE_FRAME_A=1,cr.STATE_FRAME_B=2;let hO=cr;const fo=class fo{constructor(e){this._id=e,this._asset=null,this._disposed=!1}dispose(){this._asset=null}update(e,t){if(e){if(!this._asset){const i=new si(Qs.WHITE);i.alpha=0,i.width=fo.WIDTH,i.height=fo.HEIGHT,this._asset=Vt.generateTexture(i)}e.visible=!0,e.texture=this._asset,e.offsetX=fo.OFFSET_X,e.offsetY=fo.OFFSET_Y,e.alphaTolerance=Ha.MATCH_ALL_PIXELS}}animate(e){return!1}get id(){return this._id}};fo.WIDTH=46,fo.HEIGHT=60,fo.OFFSET_X=-23,fo.OFFSET_Y=-48;let dO=fo;class BZ{constructor(e,t,i){this._id=e,this._visualization=t,this._asset=null,this._relativeDepth=0,this._status=i}dispose(){this._visualization=null,this._asset=null}update(e,t){if(!e)return;e.visible=!0,e.relativeDepth=this._relativeDepth,e.alpha=255;let i=64,r=0,n=0;this._asset=this._visualization.getAvatarRenderAsset(this._status===Oo.GUIDE?"avatar_addition_user_guide_bubble":"avatar_addition_user_guide_requester_bubble"),t<48?(r=-19,n=-80,i=32):(r=-19,n=-120),this._visualization.posture===We.POSTURE_SIT?n+=i/2:this._visualization.posture===We.POSTURE_LAY&&(n+=t),this._asset&&(e.texture=this._asset,e.offsetX=r,e.offsetY=n,e.relativeDepth=-.02+0)}animate(e){return this._asset&&e&&(e.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(e){this._relativeDepth=e}}class VZ{constructor(e,t){this._id=e,this._visualization=t,this._asset=null}dispose(){this._visualization=null,this._asset=null}update(e,t){if(!e)return;let i=64,r=0,n=0;t<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted_small"),i=32,r=-12,n=-66):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted"),r=-15,n=-110),this._visualization.posture===We.POSTURE_SIT?n+=i/2:this._visualization.posture===We.POSTURE_LAY&&(n+=t),this._asset?(e.visible=!0,e.texture=this._asset,e.offsetX=r,e.offsetY=n,e.relativeDepth=-.02):e.visible=!1}animate(e){return this._asset&&e&&(e.texture=this._asset),!1}get id(){return this._id}}class HZ{constructor(e,t,i){this._id=e,this._visualization=i,this._asset=null,this._scale=0,this._number=t,this._numberValueFadeDirection=0,this._numberValueMoving=!1,this._numberValueMoveCounter=0}dispose(){this._visualization=null,this._asset=null}update(e,t){if(!e)return;this._scale=t;let i=64,r=0,n=0;this._number>0?(t<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number+"_small"),i=32,r=-6,n=-52):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number),r=-8,n=-105),this._visualization.posture===We.POSTURE_SIT?n+=i/2:this._visualization.posture===We.POSTURE_LAY&&(n+=t),this._asset?(e.visible=!0,e.texture=this._asset,e.offsetX=r,e.offsetY=n,e.relativeDepth=-.01,e.alpha=0,this._numberValueFadeDirection=1,this._numberValueMoving=!0,this._numberValueMoveCounter=0):e.visible=!1):e.visible&&(this._numberValueFadeDirection=-1)}animate(e){if(!e)return!1;this._asset&&(e.texture=this._asset);let t=e.alpha,i=!1;if(this._numberValueMoving){if(this._numberValueMoveCounter++,this._numberValueMoveCounter<10)return!1;if(this._numberValueFadeDirection<0)this._scale<48?e.offsetY-=2:e.offsetY-=4;else{let r=4;this._scale<48&&(r=8),this._numberValueMoveCounter%r||(e.offsetY--,i=!0)}}return this._numberValueFadeDirection>0?(t<255&&(t+=32),t>=255&&(t=255,this._numberValueFadeDirection=0),e.alpha=t,!0):this._numberValueFadeDirection<0?(t>=0&&(t-=32),t<=0&&(this._numberValueFadeDirection=0,this._numberValueMoving=!1,t=0,e.visible=!1),e.alpha=t,!0):i}get id(){return this._id}}class WZ{constructor(e,t){this._id=e,this._visualization=t,this._asset=null,this._relativeDepth=0}dispose(){this._visualization=null,this._asset=null}update(e,t){if(!e)return;e.visible=!0,e.relativeDepth=this._relativeDepth,e.alpha=255;let i=64,r=0,n=0;t<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing_small"),r=3,n=-42,i=32):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing"),r=14,n=-83),this._visualization.posture===We.POSTURE_SIT?n+=i/2:this._visualization.posture===We.POSTURE_LAY&&(n+=t),this._asset&&(e.texture=this._asset,e.offsetX=r,e.offsetY=n,e.relativeDepth=-.02+0)}animate(e){return this._asset&&e&&(e.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(e){this._relativeDepth=e}}class Dp extends Qr{constructor(){super()}initialize(e){return!0}onDispose(){this._avatarRenderer=null}createAvatarImage(e,t,i=null,r=null,n=null){let o=null;return t>48?o=this._avatarRenderer.createAvatarImage(e,Hn.LARGE,i,r,n):o=this._avatarRenderer.createAvatarImage(e,Hn.SMALL,i,r,n),o}getAvatarRendererAsset(e){return this._avatarRenderer?this._avatarRenderer.assets.getTexture(e):null}get avatarManager(){return this._avatarRenderer}set avatarManager(e){this._avatarRenderer=e}get layerCount(){return 0}}const we=class we extends Dd{constructor(){super(),this._data=null,this._avatarImage=null,this._cachedAvatars=new Ms,this._cachedAvatarEffects=new Ms,this._shadow=null,this._lastUpdate=-1e3,this._disposed=!1,this._figure=null,this._gender=null,this._direction=-1,this._headDirection=-1,this._posture="",this._postureParameter="",this._canStandUp=!1,this._postureOffset=0,this._verticalOffset=0,this._angle=-1,this._headAngle=-1,this._talk=!1,this._expression=0,this._sleep=!1,this._blink=!1,this._gesture=0,this._sign=-1,this._highlightEnabled=!1,this._highlight=!1,this._isWiredHighlight=!1,this._dance=0,this._effect=0,this._carryObject=0,this._useObject=0,this._ownUser=!1,this._isLaying=!1,this._layInside=!1,this._isAnimating=!1,this._extraSpritesStartIndex=2,this._forcedAnimFrames=0,this._updatesUntilFrameUpdate=0,this._isAvatarReady=!1,this._needsUpdate=!1,this._geometryUpdateCounter=-1,this._additions=new Map,we.VARIABLE_HOLDER_FILTER[0].matrix=[.9,0,0,0,0,0,1,0,0,40,0,0,1,0,80,0,0,0,.85,0]}initialize(e){return e instanceof Dp?(this._data=e,this.createSprites(we.INITIAL_RESERVED_SPRITES),super.initialize(e),!0):!1}dispose(){this._disposed||(super.dispose(),this._avatarImage&&this._avatarImage.dispose(),this._shadow=null,this._disposed=!0)}update(e,t,i,r){if(!this.object||!e||!this._data||t<this._lastUpdate+we.UPDATE_TIME_INCREASER)return;this._lastUpdate+=we.UPDATE_TIME_INCREASER,this._lastUpdate+we.UPDATE_TIME_INCREASER<t&&(this._lastUpdate=t-we.UPDATE_TIME_INCREASER);const n=this.object.model,o=e.scale,l=this._effect;let c=!1,u=!1,d=!1,_=!1;const m=this.updateModel(n,o);if(m||o!==this._scale||!this._avatarImage){if(o!==this._scale&&(c=!0,this.updateScale(o)),l!==this._effect&&(u=!0),c||!this._avatarImage||u){if(this._avatarImage=this.createAvatarImage(o,this._effect),!this._avatarImage)return;d=!0;const I=this.getSprite(we.AVATAR_LAYER_ID);I&&this._avatarImage&&this._avatarImage.isPlaceholder()?I.alpha=150:I&&(I.alpha=255)}if(!this._avatarImage)return;if(u&&this._avatarImage.animationHasResetOnToggle&&this._avatarImage.resetAnimationFrameCounter(),this.updateShadow(o),_=this.updateObject(this.object,e,i,!0),this.processActionsForAvatar(this._avatarImage),this._additions){let I=this._extraSpritesStartIndex;for(const p of this._additions.values())p.update(this.getSprite(I++),o)}this._scale=o}else _=this.updateObject(this.object,e,i);if(this._additions){let I=this._extraSpritesStartIndex;for(const p of this._additions.values())p.animate(this.getSprite(I++))&&this.updateSpriteCounter++}const f=_||m||c,E=(this._isAnimating||this._forcedAnimFrames>0)&&i;if(f&&(this._forcedAnimFrames=we.ANIMATION_FRAME_UPDATE_INTERVAL),f||E){if(this.updateSpriteCounter++,this._forcedAnimFrames--,this._updatesUntilFrameUpdate--,this._updatesUntilFrameUpdate<=0||c||m||d)this._avatarImage.updateAnimationByFrames(1),this._updatesUntilFrameUpdate=we.ANIMATION_FRAME_UPDATE_INTERVAL;else return;let I=this._avatarImage.getCanvasOffsets();(!I||I.length<3)&&(I=we.DEFAULT_CANVAS_OFFSETS);const p=this.getSprite(we.SPRITE_INDEX_AVATAR);if(p){const C=this.object.model.getValue(D.FIGURE_HIGHLIGHT_ENABLE)===1&&this.object.model.getValue(D.FIGURE_HIGHLIGHT)===1,A=this._avatarImage.getImage(ki.FULL,C||this._isWiredHighlight);A&&(p.texture=A,C||(this._isWiredHighlight?p.filters=we.VARIABLE_HOLDER_FILTER:p.filters=[])),p.texture&&(p.offsetX=-1*o/2+I[0]-(p.texture.width-o)/2,p.offsetY=-p.texture.height+o/4+I[1]+this._postureOffset),this._isLaying?this._layInside?p.relativeDepth=-.5:p.relativeDepth=we.AVATAR_SPRITE_LAYING_DEPTH+I[2]:p.relativeDepth=we.AVATAR_SPRITE_DEFAULT_DEPTH+I[2],this._ownUser?(p.relativeDepth-=we.AVATAR_OWN_DEPTH_ADJUST,p.spriteType=Gn.AVATAR_OWN):p.spriteType=Gn.AVATAR}const S=this.getAddition(we.TYPING_BUBBLE_ID);S&&(this._isLaying?S.relativeDepth=we.AVATAR_SPRITE_LAYING_DEPTH-.01+I[2]:S.relativeDepth=we.AVATAR_SPRITE_DEFAULT_DEPTH-.01+I[2]),this._isAnimating=this._avatarImage.isAnimating();let R=we.INITIAL_RESERVED_SPRITES;const O=this._avatarImage.getDirection();for(const C of this._avatarImage.getSprites())if(C.id===we.AVATAR){const A=this.getSprite(we.SPRITE_INDEX_AVATAR);if(A){const b=this._avatarImage.getLayerData(C);let y=C.getDirectionOffsetX(O),M=C.getDirectionOffsetY(O);b&&(y+=b.dx,M+=b.dy),o<48&&(y/=2,M/=2),this._canStandUp||(A.offsetX+=y,A.offsetY+=M)}}else{const A=this.getSprite(R);if(A){A.alphaTolerance=Ha.MATCH_NOTHING,A.visible=!0;const b=this._avatarImage.getLayerData(C);let y=0,M=C.getDirectionOffsetX(O),U=C.getDirectionOffsetY(O);const G=C.getDirectionOffsetZ(O);let F=0;C.hasDirections&&(F=O),b&&(y=b.animationFrame,M+=b.dx,U+=b.dy,F+=b.dd),o<48&&(M/=2,U/=2),F<0?F+=8:F>7&&(F-=8);const H=this._avatarImage.getScale()+"_"+C.member+"_"+F+"_"+y,v=this._avatarImage.getAsset(H);if(!v)continue;A.texture=v.texture,A.offsetX=v.offsetX-o/2+M,A.offsetY=v.offsetY+U,A.flipH=v.flipH,C.hasStaticY?A.offsetY+=this._verticalOffset*o/(2*we.BASE_Y_SCALE):A.offsetY+=this._postureOffset,this._isLaying?A.relativeDepth=we.AVATAR_SPRITE_LAYING_DEPTH-.001*this.totalSprites*G:A.relativeDepth=we.AVATAR_SPRITE_DEFAULT_DEPTH-.001*this.totalSprites*G,C.ink===33?A.blendMode=ss.ADD:A.blendMode=ss.NORMAL}R++}}}createAvatarImage(e,t){let i=null,r="avatarImage"+e.toString();if(t?(r+="-"+t,i=this._cachedAvatarEffects.getValue(r)):i=this._cachedAvatars.getValue(r),!i&&(i=this._data.createAvatarImage(this._figure,e,this._gender,this,this),i))if(!t)this._cachedAvatars.add(r,i);else{if(this._cachedAvatarEffects.length>=we.MAX_EFFECT_CACHE){const n=this._cachedAvatarEffects.remove(this._cachedAvatarEffects.getKey(0));n&&n.dispose()}this._cachedAvatarEffects.add(r,i)}return i}updateObject(e,t,i,r=!1){if(!r&&this.updateObjectCounter===e.updateCounter&&this._geometryUpdateCounter===t.updateId)return!1;let n=e.getDirection().x-t.direction.x,o=this._headDirection-t.direction.x;return this._posture==="float"&&(o=n),n=(n%360+360)%360,o=(o%360+360)%360,this._posture==="sit"&&this._canStandUp&&(n-=n%90-45,o-=o%90-45),(n!==this._angle||r)&&(i=!0,this._angle=n,n=n-(135-22.5),n=(n+360)%360,this._avatarImage.setDirectionAngle(ki.FULL,n)),(o!==this._headAngle||r)&&(i=!0,this._headAngle=o,this._headAngle!==this._angle&&(o=o-(135-22.5),o=(o+360)%360,this._avatarImage.setDirectionAngle(ki.HEAD,o))),this._geometryUpdateCounter=t.updateId,this.updateObjectCounter=this.object.updateCounter,i}updateModel(e,t){if(!e||this.updateModelCounter===e.updateCounter)return!1;let i=!1;const r=e.getValue(D.FIGURE_TALK)>0;r!==this._talk&&(this._talk=r,i=!0);const n=e.getValue(D.FIGURE_EXPRESSION);n!==this._expression&&(this._expression=n,i=!0);const o=e.getValue(D.FIGURE_SLEEP)>0;o!==this._sleep&&(this._sleep=o,i=!0);const l=e.getValue(D.FIGURE_BLINK)>0;l!==this._blink&&(this._blink=l,i=!0);const c=e.getValue(D.FIGURE_GESTURE)||0;c!==this._gesture&&(this._gesture=c,i=!0);const u=e.getValue(D.FIGURE_POSTURE);u!==this._posture&&(this._posture=u,i=!0);const d=e.getValue(D.FIGURE_POSTURE_PARAMETER);d!==this._postureParameter&&(this._postureParameter=d,i=!0);const _=e.getValue(D.FIGURE_CAN_STAND_UP);_!==this._canStandUp&&(this._canStandUp=_,i=!0);const m=e.getValue(D.FIGURE_VERTICAL_OFFSET)*we.BASE_Y_SCALE;m!==this._verticalOffset&&(this._verticalOffset=m,i=!0);const f=e.getValue(D.FIGURE_DANCE)||0;f!==this._dance&&(this._dance=f,i=!0);const E=e.getValue(D.FIGURE_EFFECT)||0;E!==this._effect&&(this._effect=E,i=!0);const I=e.getValue(D.FIGURE_CARRY_OBJECT)||0;I!==this._carryObject&&(this._carryObject=I,i=!0);const p=e.getValue(D.FIGURE_USE_OBJECT)||0;p!==this._useObject&&(this._useObject=p,i=!0);const S=e.getValue(D.HEAD_DIRECTION);S!==this._headDirection&&(this._headDirection=S,i=!0),this._carryObject>0&&p>0?this._useObject!==this._carryObject&&(this._useObject=this._carryObject,i=!0):this._useObject!==0&&(this._useObject=0,i=!0);let R=this.getAddition(we.FLOATING_IDLE_Z_ID);this._sleep?(R||(R=this.addAddition(new hO(we.FLOATING_IDLE_Z_ID,this))),i=!0):R&&this.removeAddition(we.FLOATING_IDLE_Z_ID);const O=e.getValue(D.FIGURE_IS_MUTED)>0;let C=this.getAddition(we.MUTED_BUBBLE_ID);if(O)C||(C=this.addAddition(new VZ(we.MUTED_BUBBLE_ID,this))),i=!0;else{C&&(this.removeAddition(we.MUTED_BUBBLE_ID),i=!0);const $=e.getValue(D.FIGURE_IS_TYPING)>0;let W=this.getAddition(we.TYPING_BUBBLE_ID);$?(W||(W=this.addAddition(new WZ(we.TYPING_BUBBLE_ID,this))),i=!0):W&&(this.removeAddition(we.TYPING_BUBBLE_ID),i=!0)}const A=e.getValue(D.FIGURE_GUIDE_STATUS)||0;A!==Oo.NONE?(this.removeAddition(we.GUIDE_BUBBLE_ID),this.addAddition(new BZ(we.GUIDE_BUBBLE_ID,this,A)),i=!0):this.getAddition(we.GUIDE_BUBBLE_ID)&&(this.removeAddition(we.GUIDE_BUBBLE_ID),i=!0);const b=e.getValue(D.FIGURE_IS_PLAYING_GAME)>0;let y=this.getAddition(we.GAME_CLICK_TARGET_ID);b?(y||(y=this.addAddition(new dO(we.GAME_CLICK_TARGET_ID))),i=!0):y&&this.removeAddition(we.GAME_CLICK_TARGET_ID);const M=e.getValue(D.FIGURE_NUMBER_VALUE);let U=this.getAddition(we.NUMBER_BUBBLE_ID);M>0?(U||(U=this.addAddition(new HZ(we.NUMBER_BUBBLE_ID,M,this))),i=!0):U&&this.removeAddition(we.NUMBER_BUBBLE_ID);let G=this.getAddition(we.EXPRESSION_ID);this._expression>0?G||(G=uO.getExpressionAddition(we.EXPRESSION_ID,this._expression,this),G&&this.addAddition(G)):G&&this.removeAddition(we.EXPRESSION_ID),this.updateScale(t);const F=e.getValue(D.GENDER);F!==this._gender&&(this._gender=F,i=!0),this.updateFigure(e.getValue(D.FIGURE))&&(i=!0);let H=e.getValue(D.FIGURE_SIGN);H===null&&(H=-1),this._sign!==H&&(this._sign=H,i=!0);const v=e.getValue(D.FIGURE_HIGHLIGHT_ENABLE)>0;if(v!==this._highlightEnabled&&(this._highlightEnabled=v,i=!0),this._highlightEnabled){const $=e.getValue(D.FIGURE_HIGHLIGHT)>0;$!==this._highlight&&(this._highlight=$,i=!0)}const B=e.getValue(D.AVATAR_WIRED_VARIABLE_HOLDER_HIGHLIGHT)>0;B!==this._isWiredHighlight&&(this._isWiredHighlight=B,i=!0);const z=e.getValue(D.OWN_USER)>0;return z!==this._ownUser&&(this._ownUser=z,i=!0),this.updateModelCounter=e.updateCounter,i}setDirection(e){this._direction!==e&&(this._direction=e,this._needsUpdate=!0)}updateScale(e){e<48&&(this._blink=!1),this._posture==="sit"||this._posture==="lay"?this._postureOffset=e/2:this._postureOffset=0,this._layInside=!1,this._isLaying=!1,this._posture==="lay"&&(this._isLaying=!0,parseInt(this._postureParameter)<0&&(this._layInside=!0))}processActionsForAvatar(e){if(!e)return;if(e.initActionAppends(),e.appendAction(We.POSTURE,this._posture,this._postureParameter),this._gesture>0&&this._avatarImage.appendAction(We.GESTURE,We.getGesture(this._gesture)),this._dance>0&&this._avatarImage.appendAction(We.DANCE,this._dance),this._sign>-1&&this._avatarImage.appendAction(We.SIGN,this._sign),this._carryObject>0&&this._avatarImage.appendAction(We.CARRY_OBJECT,this._carryObject),this._useObject>0&&this._avatarImage.appendAction(We.USE_OBJECT,this._useObject),this._talk&&this._avatarImage.appendAction(We.TALK),(this._sleep||this._blink)&&this._avatarImage.appendAction(We.SLEEP),this._expression>0){const i=We.getExpression(this._expression);if(i!=="")switch(i){case We.DANCE:this._avatarImage.appendAction(We.DANCE,2);break;default:this._avatarImage.appendAction(i);break}}this._effect>0&&this._avatarImage.appendAction(We.EFFECT,this._effect),e.endActionAppends(),this._isAnimating=e.isAnimating();let t=we.INITIAL_RESERVED_SPRITES;for(const i of this._avatarImage.getSprites())i.id!==we.AVATAR&&t++;if(t!==this.totalSprites&&this.createSprites(t),this._extraSpritesStartIndex=t,this._additions)for(const i of this._additions.values())this.createSprite()}updateFigure(e){return this._figure===e?!1:(this._figure=e,this.clearAvatar(),!0)}resetFigure(e){this.clearAvatar()}resetEffect(e){this.clearAvatar()}clearAvatar(){for(const t of this._cachedAvatars.getValues())t&&t.dispose();for(const t of this._cachedAvatarEffects.getValues())t&&t.dispose();this._cachedAvatars.reset(),this._cachedAvatarEffects.reset(),this._avatarImage=null;const e=this.getSprite(we.AVATAR_LAYER_ID);e&&(e.texture=Qs.EMPTY,e.alpha=255)}getAddition(e){if(!this._additions)return null;const t=this._additions.get(e);return t||null}addAddition(e){if(!this.getAddition(e.id))return this._additions.set(e.id,e),e}removeAddition(e){const t=this.getAddition(e);t&&(this._additions.delete(t.id),t.dispose())}updateShadow(e){this._shadow=null;const t=this.getSprite(we.SHADOW_LAYER_ID);if(!t)return;let i=this._posture==="mv"||this._posture==="std"||this._posture==="sit"&&this._canStandUp;if(this._effect===we.SNOWBOARDING_EFFECT&&(i=!1),i){if(t.visible=!0,!this._shadow||e!==this._scale){let r=0,n=0;e<48?(t.libraryAssetName="sh_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(t.libraryAssetName),r=-8,n=this._canStandUp?6:-3):(t.libraryAssetName="h_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(t.libraryAssetName),r=-17,n=this._canStandUp?10:-7),this._shadow?(t.texture=this._shadow.texture,t.offsetX=r,t.offsetY=n,t.alpha=50,t.relativeDepth=1):t.visible=!1}}else this._shadow=null,t.visible=!1}getAvatarRenderAsset(e){return this._data?this._data.getAvatarRendererAsset(e):null}get direction(){return this._direction}get posture(){return this._posture}get angle(){return this._angle}get disposed(){return this._disposed}};we.AVATAR="avatar",we.FLOATING_IDLE_Z_ID=1,we.TYPING_BUBBLE_ID=2,we.EXPRESSION_ID=3,we.NUMBER_BUBBLE_ID=4,we.GAME_CLICK_TARGET_ID=5,we.MUTED_BUBBLE_ID=6,we.GUIDE_BUBBLE_ID=7,we.OWN_USER_ID=4,we.UPDATE_TIME_INCREASER=41,we.AVATAR_LAYER_ID=0,we.SHADOW_LAYER_ID=1,we.SNOWBOARDING_EFFECT=97,we.INITIAL_RESERVED_SPRITES=2,we.ANIMATION_FRAME_UPDATE_INTERVAL=2,we.DEFAULT_CANVAS_OFFSETS=[0,0,0],we.MAX_EFFECT_CACHE=2,we.SPRITE_INDEX_AVATAR=0,we.BASE_Y_SCALE=1e3,we.AVATAR_SPRITE_DEFAULT_DEPTH=-.01,we.AVATAR_OWN_DEPTH_ADJUST=.001,we.AVATAR_SPRITE_LAYING_DEPTH=-.409,we.VARIABLE_HOLDER_FILTER=[new Yc,new iC({color:12318714,outerStrength:1,innerStrength:1,distance:4,quality:1,knockout:!1})];let _O=we;const hn=class hn{static allocate(e,t,i,r,n,o,l=-1,c=0){const u=hn.POOL.length?hn.POOL.pop():new hn;return r<1&&(r=1),n<0&&(n=hn.FRAME_REPEAT_FOREVER),u._id=e,u._x=t||0,u._y=i||0,u._repeats=r,u._frameRepeats=n,u._remainingFrameRepeats=n,u._isLastFrame=o,u._isRecycled=!1,l>=0?(u._activeSequence=l,u._activeSequenceOffset=c):(u._activeSequence=-1,u._activeSequenceOffset=0),u}get id(){return this._id>=0?this._id:-this._id*Math.random()}get x(){return this._x}get y(){return this._y}get repeats(){return this._repeats}get frameRepeats(){return this._frameRepeats}get isLastFrame(){return this._isLastFrame}get remainingFrameRepeats(){return this._frameRepeats<0?hn.FRAME_REPEAT_FOREVER:this._remainingFrameRepeats}set remainingFrameRepeats(e){e<0&&(e=0),this._frameRepeats>0&&e>this._frameRepeats&&(e=this._frameRepeats),this._remainingFrameRepeats=e}get activeSequence(){return this._activeSequence}get activeSequenceOffset(){return this._activeSequenceOffset}recycle(){this._isRecycled||(this._isRecycled=!0,hn.POOL.length<hn.POOL_SIZE_LIMIT&&hn.POOL.push(this))}};hn.FRAME_REPEAT_FOREVER=-1,hn.SEQUENCE_NOT_DEFINED=-1,hn.POOL_SIZE_LIMIT=3e3,hn.POOL=[];let Rc=hn;class EG{constructor(e,t,i,r,n,o){this._id=0,this._x=0,this._y=0,this._randomX=0,this._randomY=0,this._repeats=1,this._id=e,this._x=t,this._y=i,this._randomX=r,this._randomY=n,this._repeats=o}get id(){return this._id}hasDirectionalOffsets(){return!1}getX(e){return this._x}getY(e){return this._y}get x(){return this._x}get y(){return this._y}get randomX(){return this._randomX}get randomY(){return this._randomY}get repeats(){return this._repeats}}class YZ extends EG{constructor(e,t,i,r,n,o,l){super(e,t,i,r,n,l),this._directionalOffsets=o}hasDirectionalOffsets(){return this._directionalOffsets!==null}getX(e){return this._directionalOffsets?this._directionalOffsets.getXOffset(e,super.getX(e)):super.getX(e)}getY(e){return this._directionalOffsets?this._directionalOffsets.getYOffset(e,super.getY(e)):super.getY(e)}}class zZ{constructor(e,t){this._frames=[],this._frameIndexes=[],this._frameRepeats=[],this._isRandom=t,this._loopCount=e<1?1:e}get isRandom(){return this._isRandom}get frameCount(){return this._frameIndexes.length*this._loopCount}dispose(){this._frames=[]}initialize(){let e=this._frameIndexes.length-1,t=-1,i=1;for(;e>=0;)this._frameIndexes[e]===t?i++:(t=this._frameIndexes[e],i=1),this._frameRepeats[e]=i,e--}addFrame(e,t,i,r,n,o){let l=1;if(this._frames.length>0){const u=this._frames[this._frames.length-1];u.id===e&&!u.hasDirectionalOffsets()&&u.x===t&&u.y===i&&u.randomX===r&&r===0&&u.randomY===n&&n===0&&(l+=u.repeats,this._frames.pop())}const c=o?new YZ(e,t,i,r,n,o,l):new EG(e,t,i,r,n,l);this._frames.push(c),this._frameIndexes.push(this._frames.length-1),this._frameRepeats.push(1)}getFrame(e){return!this._frames.length||e<0||e>=this.frameCount?null:this._frames[this._frameIndexes[e%this._frameIndexes.length]]}getFrameIndex(e){return e<0||e>=this.frameCount?-1:(this._isRandom&&(e=Math.round(Math.random()*this._frameIndexes.length),e===this._frameIndexes.length&&e--),e)}getRepeats(e){return e<0||e>=this.frameCount?0:this._frameRepeats[e%this._frameRepeats.length]}}class KZ{constructor(e,t,i){this._frameSequences=[],this._frameCount=-1,this._loopCount=e<0?0:e,this._frameRepeat=t<1?1:t,this._isRandom=i}get frameCount(){return this._frameCount<0&&this.calculateLength(),this._frameCount}dispose(){if(!(!this._frameSequences||!this._frameSequences.length)){for(const e of this._frameSequences)e&&e.dispose();this._frameSequences=[]}}addFrameSequence(e,t){const i=new zZ(e,t);return this._frameSequences.push(i),i}calculateLength(){this._frameCount=0;for(const e of this._frameSequences)e&&(this._frameCount+=e.frameCount)}getFrame(e,t){if(this._frameCount<1)return null;if(t=t/this._frameRepeat,!this._isRandom){const n=Math.floor(t/this._frameCount);t=Math.floor(t%this._frameCount);let o=!1,l=null;(this._loopCount>0&&n>=this._loopCount||this._loopCount<=0&&this._frameCount===1)&&(t=this._frameCount-1,o=!0);let c=0,u=0;for(;u<this._frameSequences.length;){if(l=this._frameSequences[u],l){if(t<c+l.frameCount)break;c+=l.frameCount}u++}return this.getFrameFromSpecificSequence(e,l,u,t-c,o)}const i=Math.trunc(this._frameSequences.length*Math.random()),r=this._frameSequences[i];return r.frameCount<1?null:this.getFrameFromSpecificSequence(e,r,i,0,!1)}getFrameFromSequence(e,t,i,r){if(t<0||t>=this._frameSequences.length)return null;const n=this._frameSequences[t];return n?i>=n.frameCount?this.getFrame(e,r):this.getFrameFromSpecificSequence(e,n,t,i,!1):null}getFrameFromSpecificSequence(e,t,i,r,n){if(!t)return null;const o=t.getFrameIndex(r),l=t.getFrame(o);if(!l)return null;let c=l.getX(e),u=l.getY(e);const d=l.randomX,_=l.randomY;let m=l.repeats,f=!1;d&&(c=Math.trunc(c+d*Math.random())),_&&(u=Math.trunc(u+_*Math.random())),m>1&&(m=t.getRepeats(o));let E=this._frameRepeat*m;return n&&(E=Rc.FRAME_REPEAT_FOREVER),!this._isRandom&&!t.isRandom&&i===this._frameSequences.length-1&&r===t.frameCount-1&&(f=!0),Rc.allocate(l.id,c,u,m,E,f,i,r)}}class IG{constructor(){this._offsetX=new Map,this._offsetY=new Map}getXOffset(e,t){const i=this._offsetX.get(e);return i??t}getYOffset(e,t){const i=this._offsetY.get(e);return i??t}setDirection(e,t,i){this._offsetX.set(e,t),this._offsetY.set(e,i)}}const po=class po{constructor(){this._layers=new Map,this._frameCount=-1,this._randomStart=!1,this._immediateChanges=null}static getTransitionToAnimationId(e){return po.TRANSITION_TO_ANIMATION_OFFSET+e}static getTransitionFromAnimationId(e){return po.TRANSITION_FROM_ANIMATION_OFFSET+e}static isTransitionToAnimation(e){return e>=po.TRANSITION_TO_ANIMATION_OFFSET&&e<po.TRANSITION_FROM_ANIMATION_OFFSET}static isTransitionFromAnimation(e){return e>=po.TRANSITION_FROM_ANIMATION_OFFSET}dispose(){for(const e of this._layers.values())e&&e.dispose();this._layers.clear(),this._immediateChanges=null}setImmediateChanges(e){this._immediateChanges=e}isImmediateChange(e){return!(!this._immediateChanges||this._immediateChanges.indexOf(e)===-1)}getStartFrame(e){return this._randomStart?Math.random()*this._frameCount:0}initialize(e){if(e.randomStart&&(this._randomStart=!0),e.layers)for(const t in e.layers){const i=e.layers[t];if(!i)return!1;const r=parseInt(t),n=i.loopCount!==void 0?i.loopCount:1,o=i.frameRepeat!==void 0?i.frameRepeat:1,l=i.random!==void 0&&i.random!==0;if(!this.addLayer(r,n,o,l,i))return!1}return!0}addLayer(e,t,i,r,n){const o=new KZ(t,i,r);if(n.frameSequences)for(const c in n.frameSequences){const u=n.frameSequences[c];if(!u)continue;const d=u.loopCount!==void 0?u.loopCount:1,_=u.random!==void 0&&u.random!==0,m=o.addFrameSequence(d,_);if(u.frames)for(const f in u.frames){const E=u.frames[f];if(!E)return o.dispose(),!1;m.addFrame(E.id,E.x||0,E.y||0,E.randomX||0,E.randomY||0,this.readDirectionalOffsets(E))}m.initialize()}o.calculateLength(),this._layers.set(e,o);const l=o.frameCount;return l>this._frameCount&&(this._frameCount=l),!0}readDirectionalOffsets(e){let t=null;if(e&&e.offsets)for(const i in e.offsets){const r=e.offsets[i];r&&(t||(t=new IG),t.setDirection(r.direction,r.x,r.y))}return t}getFrame(e,t,i){const r=this._layers.get(t);return r?r.getFrame(e,i):null}getFrameFromSequence(e,t,i,r,n){const o=this._layers.get(t);return o?o.getFrameFromSequence(e,i,r,n):null}};po.TRANSITION_TO_ANIMATION_OFFSET=1e6,po.TRANSITION_FROM_ANIMATION_OFFSET=2e6,po.DEFAULT_FRAME_NUMBER=0;let Mi=po;const hg=class hg{constructor(e){this._colors=[],this.createColors(e)}createColors(e){if(e)for(let t=0;t<e;t++)this._colors.push(hg.DEFAULT_COLOR)}dispose(){this._colors=[]}getLayerColor(e){const t=this._colors[e];return t||hg.DEFAULT_COLOR}setColorLayer(e,t){this._colors[e]&&(this._colors[e]=t)}};hg.DEFAULT_COLOR=16777215;let eh=hg;const Ki=class Ki{constructor(){this._tag=Ki.DEFAULT_TAG,this._ink=Ki.DEFAULT_INK,this._alpha=Ki.DEFAULT_ALPHA,this._ignoreMouse=Ki.DEFAULT_IGNORE_MOUSE,this._xOffset=Ki.DEFAULT_XOFFSET,this._yOffset=Ki.DEFAULT_YOFFSET,this._zOffset=Ki.DEFAULT_ZOFFSET}setFromLayer(e){e&&(this._tag=e.tag,this._ink=e.ink,this._alpha=e.alpha,this._ignoreMouse=e.ignoreMouse,this._xOffset=e.xOffset,this._yOffset=e.yOffset,this._zOffset=e.zOffset)}get tag(){return this._tag}set tag(e){this._tag=e}get ink(){return this._ink}set ink(e){this._ink=e}get alpha(){return this._alpha}set alpha(e){this._alpha=e}get ignoreMouse(){return this._ignoreMouse}set ignoreMouse(e){this._ignoreMouse=e}get xOffset(){return this._xOffset}set xOffset(e){this._xOffset=e}get yOffset(){return this._yOffset}set yOffset(e){this._yOffset=e}get zOffset(){return this._zOffset}set zOffset(e){this._zOffset=e}};Ki.DEFAULT_COUNT=0,Ki.DEFAULT_DIRECTION=0,Ki.DEFAULT_TAG="",Ki.DEFAULT_INK=ss.NORMAL,Ki.DEFAULT_ALPHA=255,Ki.DEFAULT_IGNORE_MOUSE=!1,Ki.DEFAULT_XOFFSET=0,Ki.DEFAULT_YOFFSET=0,Ki.DEFAULT_ZOFFSET=0;let ns=Ki;const NA=class NA{constructor(e){this._layers=[],this.createLayers(e)}createLayers(e){if(e)for(let t=0;t<e;t++)this._layers.push(new ns)}dispose(){this._layers=[]}setFromDirection(e){if(!e)return;const t=this.layerCount;if(t===e.layerCount)for(let i=0;i<t;i++){const r=this.getLayer(i),n=e.getLayer(i);r&&r.setFromLayer(n)}}getLayer(e){const t=this._layers[e];return t||null}getLayerTag(e){const t=this.getLayer(e);return t?t.tag:ns.DEFAULT_TAG}setLayerTag(e,t){const i=this.getLayer(e);i&&(i.tag=t)}getLayerInk(e){const t=this.getLayer(e);return t?t.ink:ns.DEFAULT_INK}setLayerInk(e,t){const i=this.getLayer(e);i&&(isNaN(t)||(i.ink=t))}getLayerAlpha(e){const t=this.getLayer(e);return t?t.alpha:ns.DEFAULT_ALPHA}setLayerAlpha(e,t){const i=this.getLayer(e);i&&(isNaN(t)||(i.alpha=t))}getLayerIgnoreMouse(e){const t=this.getLayer(e);return t?t.ignoreMouse:ns.DEFAULT_IGNORE_MOUSE}setLayerIgnoreMouse(e,t){const i=this.getLayer(e);i&&(i.ignoreMouse=t||!1)}getLayerXOffset(e){const t=this.getLayer(e);return t?t.xOffset:ns.DEFAULT_XOFFSET}setLayerXOffset(e,t){const i=this.getLayer(e);i&&(isNaN(t)||(i.xOffset=t))}getLayerYOffset(e){const t=this.getLayer(e);return t?t.yOffset:ns.DEFAULT_YOFFSET}setLayerYOffset(e,t){const i=this.getLayer(e);i&&(isNaN(t)||(i.yOffset=t))}getLayerZOffset(e){const t=this.getLayer(e);return t?t.zOffset:ns.DEFAULT_ZOFFSET}setLayerZOffset(e,t){const i=this.getLayer(e);i&&(isNaN(t)||(i.zOffset=t))}get layerCount(){return this._layers.length}};NA.USE_DEFAULT_DIRECTION=-1;let Ec=NA;const dg=class dg{constructor(e,t){this._layerCount=e<0?0:e>dg.MAX_LAYERS?dg.MAX_LAYERS:e,this._angle=t<1?1:t>360?360:t,this._defaultDirection=new Ec(this._layerCount),this._directions=new Map,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1}dispose(){this._defaultDirection&&this._defaultDirection.dispose();for(const e of this._directions.values())e&&e.dispose();for(const e of this._colors)e&&e.dispose();this.reset()}reset(){this._defaultDirection=null,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1,this._directions.clear()}processLayers(e){return e?this.setDirectionLayers(this._defaultDirection,e):!1}processDirections(e){if(!e)return!1;for(const t in e){const i=e[t];if(!i)continue;const r=parseInt(t);if(this._directions.get(r))return!1;const n=new Ec(this._layerCount);n.setFromDirection(this._defaultDirection),this.setDirectionLayers(n,i.layers),this._directions.set(r,n),this._lastDirectionData=null,this._lastDirection=-1}return!0}processColors(e){if(!e)return!1;for(const t in e){const i=e[t];if(!i)continue;const r=parseInt(t);if(this._colors[r])return!1;const n=new eh(this._layerCount);for(const o in i.layers){const l=i.layers[o];if(!l)continue;const c=parseInt(o),u=l.color;n.setColorLayer(c,u)}this._colors[r]=n}return!0}setDirectionLayers(e,t){if(!e||!t)return!1;for(const i in t){const r=t[i];if(!r)continue;const n=parseInt(i);if(n<0||n>=this._layerCount)return!1;r.ink!==void 0&&e.setLayerInk(n,y2.inkToBlendMode(r.ink)),r.tag!==void 0&&e.setLayerTag(n,r.tag),r.alpha!==void 0&&e.setLayerAlpha(n,r.alpha),r.ignoreMouse!==void 0&&e.setLayerIgnoreMouse(n,r.ignoreMouse),r.x!==void 0&&e.setLayerXOffset(n,r.x),r.y!==void 0&&e.setLayerYOffset(n,r.y),r.z!==void 0&&e.setLayerZOffset(n,r.z/-1e3)}return!0}getValidDirection(e){if(this._directions.get(e))return e;e=(e%360+360)%360;let i=-1,r=-1;for(const n of this._directions.keys()){let o=(n*this._angle-e+360)%360;o>180&&(o=360-o),(o<i||i<0)&&(i=o,r=n)}return r>=0?Math.trunc(r):0}getDirectionData(e){if(e===this._lastDirection&&this._lastDirectionData)return this._lastDirectionData;let t=this._directions.get(e);return t||(t=this._defaultDirection),this._lastDirection=e,this._lastDirectionData=t,this._lastDirectionData}getLayerTag(e,t){const i=this.getDirectionData(e);return i?i.getLayerTag(t):ns.DEFAULT_TAG}getLayerInk(e,t){const i=this.getDirectionData(e);return i?i.getLayerInk(t):ns.DEFAULT_INK}getLayerAlpha(e,t){const i=this.getDirectionData(e);return i?i.getLayerAlpha(t):ns.DEFAULT_ALPHA}getLayerColor(e,t){const i=this._colors[t];return i?i.getLayerColor(e):eh.DEFAULT_COLOR}getLayerIgnoreMouse(e,t){const i=this.getDirectionData(e);return i?i.getLayerIgnoreMouse(t):ns.DEFAULT_IGNORE_MOUSE}getLayerXOffset(e,t){const i=this.getDirectionData(e);return i?i.getLayerXOffset(t):ns.DEFAULT_XOFFSET}getLayerYOffset(e,t){const i=this.getDirectionData(e);return i?i.getLayerYOffset(t):ns.DEFAULT_YOFFSET}getLayerZOffset(e,t){const i=this.getDirectionData(e);return i?i.getLayerZOffset(t):ns.DEFAULT_ZOFFSET}get layerCount(){return this._layerCount}};dg.MAX_LAYERS=26;let Mp=dg;class jp extends Mp{constructor(e,t){super(e,t),this._animations=new Map,this._animationIds=[]}dispose(){super.dispose();for(const e of this._animations.values())e&&e.dispose();this._animations.clear(),this._animationIds=[]}defineAnimations(e){if(!e)return!0;for(const t in e){const i=e[t];if(!i)return!1;let r=parseInt(t.split("_")[0]),n=!1;const o=i.transitionTo,l=i.transitionFrom;o!==void 0&&(r=Mi.getTransitionToAnimationId(o),n=!0),l!==void 0&&(r=Mi.getTransitionFromAnimationId(l),n=!0);const c=this.createAnimationData();if(!c.initialize(i))return c.dispose(),!1;const u=i.immediateChangeFrom;if(u!==void 0){const d=u.split(","),_=[];for(const m of d){const f=parseInt(m);_.indexOf(f)===-1&&_.push(f)}c.setImmediateChanges(_)}this._animations.set(r,c),n||this._animationIds.push(r)}return!0}createAnimationData(){return new Mi}hasAnimation(e){return!!this._animations.get(e)}getAnimationCount(){return this._animationIds.length||0}getAnimationId(e){const t=this.getAnimationCount();return e<0||t<=0?0:this._animationIds[e%t]}isImmediateChange(e,t){const i=this._animations.get(e);return i?i.isImmediateChange(t):!1}getStartFrame(e,t){const i=this._animations.get(e);return i?i.getStartFrame(t):0}getFrame(e,t,i,r){const n=this._animations.get(e);return n?n.getFrame(t,i,r):null}getFrameFromSequence(e,t,i,r,n,o){const l=this._animations.get(e);return l?l.getFrameFromSequence(t,i,r,n,o):null}}class TG{constructor(){this._animationId=-1,this._animationAfterTransitionId=0,this._animationOver=!1,this._frameCounter=0,this._frames=[],this._lastFramePlayed=[],this._animationPlayed=[],this._layerCount=0}get animationOver(){return this._animationOver}set animationOver(e){this._animationOver=e}get frameCounter(){return this._frameCounter}set frameCounter(e){this._frameCounter=e}get animationId(){return this._animationId}set animationId(e){e!==this._animationId&&(this._animationId=e,this.resetAnimationFrames(!1))}get animationAfterTransitionId(){return this._animationAfterTransitionId}set animationAfterTransitionId(e){this._animationAfterTransitionId=e}dispose(){this.recycleFrames(),this._frames=null,this._lastFramePlayed=null,this._animationPlayed=null}setLayerCount(e){this._layerCount=e,this.resetAnimationFrames()}resetAnimationFrames(e=!0){(e||!this._frames)&&(this.recycleFrames(),this._frames=[]),this._lastFramePlayed=[],this._animationPlayed=[],this._animationOver=!1,this._frameCounter=0;let t=0;for(;t<this._layerCount;){if(e||this._frames.length<=t)this._frames[t]=null;else{const i=this._frames[t];i&&(i.recycle(),this._frames[t]=Rc.allocate(i.id,i.x,i.y,i.repeats,0,i.isLastFrame))}this._lastFramePlayed[t]=!1,this._animationPlayed[t]=!1,t++}}recycleFrames(){if(!(!this._frames||!this._frames.length))for(const e of this._frames)e&&e.recycle()}getFrame(e){return e<0||e>=this._layerCount?null:this._frames[e]}setFrame(e,t){if(e<0||e>=this._layerCount)return;const i=this._frames[e];i&&i.recycle(),this._frames[e]=t}getAnimationPlayed(e){return e<0||e>=this._layerCount?!0:this._animationPlayed[e]}setAnimationPlayed(e,t){e<0||e>=this._layerCount||(this._animationPlayed[e]=t)}getLastFramePlayed(e){return e<0||e>=this._layerCount?!0:this._lastFramePlayed[e]}setLastFramePlayed(e,t){e<0||e>=this._layerCount||(this._lastFramePlayed[e]=t)}}const vI=class vI extends jp{constructor(e,t){super(e,t),this._posturesToAnimations=new Map,this._gesturesToAnimations=new Map,this._defaultPosture=null}processPostures(e){if(!e||(e.defaultPosture&&e.defaultPosture.length&&(this._defaultPosture=e.defaultPosture),!e.postures))return!1;for(const t of e.postures)this._posturesToAnimations.get(t.id)||(this._defaultPosture===null&&(this._defaultPosture=t.id),this._posturesToAnimations.set(t.id,t.animationId));return this._posturesToAnimations.get(this._defaultPosture)!==void 0}processGestures(e){if(!e)return!1;for(const t of e)this._gesturesToAnimations.get(t.id)||this._gesturesToAnimations.set(t.id,t.animationId);return!0}postureToAnimation(e){return this._posturesToAnimations.get(e)||(e=this._defaultPosture),this._posturesToAnimations.get(e)}getGestureDisabled(e){return e==="ded"}gestureToAnimation(e){return this._gesturesToAnimations.get(e)?this._gesturesToAnimations.get(e):vI.DEFAULT}animationToPosture(e,t){if(e>=0&&e<this._posturesToAnimations.size){const i=this._posturesToAnimations.keys();for(;;){const r=i.next();if(r.done)return null;if(e<=0)return r.value;--e}}return t?this._defaultPosture:null}animationToGesture(e){if(e>=0&&e<this._gesturesToAnimations.size){const t=this._gesturesToAnimations.keys();for(;;){const i=t.next();if(i.done)return null;if(e<=0)return i.value;--e}}return null}getGestureForAnimationId(e){for(const t of this._gesturesToAnimations.keys())if(this._gesturesToAnimations.get(t)===e)return t;return null}get totalPostures(){return this._posturesToAnimations.size}get totalGestures(){return this._gesturesToAnimations.size}};vI.DEFAULT=-1;let $c=vI;const AA=class AA{constructor(){this._type="",this._sizes=[],this._sizeDatas=new Map,this._lastSize=-1,this._lastSizeScale=-1,this._lastSizeData=null,this._lastSizeDataScale=-1}initialize(e){return this.reset(),e?(this._type=e.name,this.defineVisualizations(e.visualizations)?!0:(this.reset(),!1)):!1}dispose(){if(this._sizeDatas&&this._sizeDatas.size){for(const e of this._sizeDatas.values())e&&e.dispose();this._sizeDatas=null}this._lastSizeData=null,this._sizes=null}reset(){if(this._type="",this._sizeDatas&&this._sizeDatas.size)for(const e of this._sizeDatas.values())e&&e.dispose();this._sizeDatas.clear(),this._sizes=[],this._lastSizeData=null,this._lastSizeDataScale=-1}createSizeData(e,t,i){return new Mp(t,i)}defineVisualizations(e){if(!e)return!1;for(const t in e){const i=e[t],r=i.layerCount,n=i.angle;let o=i.size;if(o<1&&(o=1),this._sizeDatas.get(o))return!1;const l=this.createSizeData(o,r,n);if(!l)return!1;for(const c in i){const u=i[c];if(!this.processVisualElement(l,c,u))return l.dispose(),!1}this._sizeDatas.set(o,l),this._sizes.push(o)}return this._sizes.sort(),!0}processVisualElement(e,t,i){if(!e||!t||!i)return!1;switch(t){case"layers":if(!e.processLayers(i))return!1;break;case"directions":if(!e.processDirections(i))return!1;break;case"colors":if(!e.processColors(i))return!1;break}return!0}getValidSize(e){if(e===this._lastSizeScale)return this._lastSize;const t=this.getSizeIndex(e);let i=-1;return t<this._sizes.length&&(i=this._sizes[t]),this._lastSizeScale=e,this._lastSize=i,i}getSizeIndex(e){if(e<=0)return 0;let t=0,i=1;for(;i<this._sizes.length;){if(this._sizes[i]>e){this._sizes[i]/e<e/this._sizes[i-1]&&(t=i);break}t=i,i++}return t}getSizeData(e){if(e===this._lastSizeDataScale)return this._lastSizeData;const t=this.getSizeIndex(e);return t<this._sizes.length?this._lastSizeData=this._sizeDatas.get(this._sizes[t]):this._lastSizeData=null,this._lastSizeDataScale=e,this._lastSizeData}getLayerCount(e){const t=this.getSizeData(e);return t?t.layerCount:ns.DEFAULT_COUNT}getValidDirection(e,t){const i=this.getSizeData(e);return i?i.getValidDirection(t):ns.DEFAULT_DIRECTION}getLayerTag(e,t,i){const r=this.getSizeData(e);return r?r.getLayerTag(t,i):ns.DEFAULT_TAG}getLayerInk(e,t,i){const r=this.getSizeData(e);return r?r.getLayerInk(t,i):ns.DEFAULT_INK}getLayerAlpha(e,t,i){const r=this.getSizeData(e);return r?r.getLayerAlpha(t,i):ns.DEFAULT_ALPHA}getLayerColor(e,t,i){const r=this.getSizeData(e);return r?r.getLayerColor(t,i):eh.DEFAULT_COLOR}getLayerIgnoreMouse(e,t,i){const r=this.getSizeData(e);return r?r.getLayerIgnoreMouse(t,i):ns.DEFAULT_IGNORE_MOUSE}getLayerXOffset(e,t,i){const r=this.getSizeData(e);return r?r.getLayerXOffset(t,i):ns.DEFAULT_XOFFSET}getLayerYOffset(e,t,i){const r=this.getSizeData(e);return r?r.getLayerYOffset(t,i):ns.DEFAULT_YOFFSET}getLayerZOffset(e,t,i){const r=this.getSizeData(e);return r?r.getLayerZOffset(t,i):ns.DEFAULT_ZOFFSET}get type(){return this._type}};AA.LAYER_LETTERS=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];let Uo=AA;class vN extends Uo{createSizeData(e,t,i){return new jp(t,i)}processVisualElement(e,t,i){if(!e||!t||!i)return!1;switch(t){case"animations":if(!(e instanceof jp)||!e.defineAnimations(i))return!1;break;default:if(!super.processVisualElement(e,t,i))return!1;break}return!0}hasAnimation(e,t){const i=this.getSizeData(e);return i?i.hasAnimation(t):null}getAnimationCount(e){const t=this.getSizeData(e);return t?t.getAnimationCount():null}getAnimationId(e,t){const i=this.getSizeData(e);return i?i.getAnimationId(t):null}isImmediateChange(e,t,i){const r=this.getSizeData(e);return r?r.isImmediateChange(t,i):null}getStartFrame(e,t,i){const r=this.getSizeData(e);return r?r.getStartFrame(t,i):null}getFrame(e,t,i,r,n){const o=this.getSizeData(e);return o?o.getFrame(t,i,r,n):null}getFrameFromSequence(e,t,i,r,n,o,l){const c=this.getSizeData(e);return c?c.getFrameFromSequence(t,i,r,n,o,l):null}}const _g=class _g extends Dd{constructor(){super(),this._data=null,this._type=null,this._direction=0,this._lastCameraAngle=NaN,this._selectedColor=0,this._furnitureLift=0,this._alphaMultiplier=1,this._alphaChanged=!1,this._clickUrl=null,this._clickHandling=!1,this._cacheDirection=-1,this._cacheScale=0,this._cacheSize=-1,this._layerCount=0,this._shadowLayerIndex=-1,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._animationNumber=0,this._lookThrough=!1,this._update=!1,this._update2=!1,this._clickThrough=!1}get filters(){return this._filters}set filters(e){this._filters=e,this._update2=!0}set lookTrough(e){this._lookThrough!=e&&(this._update=!0,this._lookThrough=e)}get data(){return this._data}get direction(){return this._direction}initialize(e){return this.reset(),e instanceof Uo?(this._type=e.type,this._data=e,!0):!1}dispose(){super.dispose(),this._data=null,this._updatedLayers=null,this._assetNames=null,this._spriteTags=null,this._spriteInks=null,this._spriteAlphas=null,this._spriteColors=null,this._spriteMouseCaptures=null,this._spriteXOffsets=null,this._spriteYOffsets=null,this._spriteZOffsets=null,this._filters=null}update(e,t,i,r){if(!e)return;const n=e.scale;let o=!1;this.updateObject(n,e.direction.x)&&(o=!0),this.updateModel(n)&&(o=!0);let l=0;this._update&&(o=!0,this._update=!1),this._update2&&(o=!0,this._update2=!1),r?this._animationNumber=this._animationNumber|this.updateAnimation(n):(l=this.updateAnimation(n)|this._animationNumber,this._animationNumber=0),(o||l!==0)&&(this.updateSprites(n,o,l),this._scale=n,this.updateSpriteCounter++)}getAsset(e,t=-1){return this.asset?this.asset.getAsset(e):null}reset(){super.reset(),this.setDirection(-1),this._data=null,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this.createSprites(0)}resetLayers(e,t){this._cacheDirection===t&&this._cacheScale===e||(this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._cacheDirection=t,this._cacheScale=e,this._cacheSize=this.getValidSize(e),this.setLayerCount((this._data&&this._data.getLayerCount(e)||0)+this.getAdditionalLayerCount()))}updateObject(e,t){if(!this.object||this.updateObjectCounter===this.object.updateCounter&&e===this._scale&&this._lastCameraAngle===t)return!1;let i=this.object.getDirection().x-(t+135);if(i=(i%360+360)%360,this._data){const r=this._data.getValidDirection(e,i);this.setDirection(r)}return this._lastCameraAngle=t,this._scale=e,this.updateObjectCounter=this.object.updateCounter,this.resetLayers(e,this._direction),!0}updateModel(e){const t=this.object&&this.object.model;if(!t||this.updateModelCounter===t.updateCounter)return!1;this._selectedColor=t.getValue(D.FURNITURE_COLOR),this._clickUrl=t.getValue(D.FURNITURE_AD_URL),this._clickHandling=this._clickUrl&&this._clickUrl!==""&&this._clickUrl.indexOf("http")===0||!1,this._furnitureLift=t.getValue(D.FURNITURE_LIFT_AMOUNT)||0;let i=t.getValue(D.FURNITURE_ALPHA_MULTIPLIER);return this._clickThrough=t.getValue(D.FURNITURE_CLICK_THROUGH_ENABLED),isNaN(i)&&(i=1),this._alphaMultiplier!==i&&(this._alphaMultiplier=i,this._alphaChanged=!0),this.updateModelCounter=t.updateCounter,!0}updateSprites(e,t,i){if(this._layerCount!==this.totalSprites&&this.createSprites(this._layerCount),t){let r=this.totalSprites-1;for(;r>=0;)this.updateSprite(e,r),r--}else{let r=0;for(;i>0;)i&&this.updateSprite(e,r),r++,i=i>>1}this._alphaChanged=!1}updateSprite(e,t){const i=this.getSpriteAssetName(e,t),r=this.getSprite(t);if(i&&r){const n=this.getAsset(i,t);if(n&&n.texture){r.visible=!0,r.type=this._type,r.texture=n.texture,r.flipH=n.flipH,r.flipV=n.flipV,r.direction=this._direction;let o=0;t!==this._shadowLayerIndex?(r.tag=this.getLayerTag(e,this._direction,t),r.alpha=this.getLayerAlpha(e,this._direction,t),r.color=this.getLayerColor(e,t,this._selectedColor),r.offsetX=n.offsetX+this.getLayerXOffset(e,this._direction,t),r.offsetY=n.offsetY+this.getLayerYOffset(e,this._direction,t),r.blendMode=this.getLayerInk(e,this._direction,t),r.alphaTolerance=this.getLayerIgnoreMouse(e,this._direction,t)?Ha.MATCH_NOTHING:Ha.MATCH_OPAQUE_PIXELS,o=this.getLayerZOffset(e,this._direction,t),o=o-t*.001):(r.offsetX=n.offsetX,r.offsetY=n.offsetY+this.getLayerYOffset(e,this._direction,t),r.alpha=48*this._alphaMultiplier,r.alphaTolerance=Ha.MATCH_NOTHING,o=1),this._lookThrough&&(r.alpha*=.2),r.relativeDepth=o*_g.DEPTH_MULTIPLIER,r.name=i,r.libraryAssetName=this.getLibraryAssetNameForSprite(n,r),r.posture=this.getPostureForAsset(e,n.source),r.clickHandling=this._clickHandling,r.skipMouseHandling=this._clickThrough,r.blendMode!=ss.ADD&&(r.filters=this._filters)}else this.resetSprite(r)}else r&&this.resetSprite(r)}getLibraryAssetNameForSprite(e,t){return e.source}getPostureForAssetFile(e,t){return null}getSpriteAssetName(e,t){if(!this._data||t>=Uo.LAYER_LETTERS.length)return"";let i=this._assetNames[t],r=this._updatedLayers[t];return(!i||!i.length)&&(i=this.cacheSpriteAssetName(e,t,!0),r=this._cacheSize!==1),r&&(i+=this.getFrameNumber(e,t)),i}cacheSpriteAssetName(e,t,i){this._type;const r=i?this._cacheSize:this.getValidSize(e);let n="";const o=r!==1;if(t!==this._shadowLayerIndex?n=Uo.LAYER_LETTERS[t]||"":n="sd",n==="")return null;const l=this._type+(o?"_"+r+"_"+n+"_"+this._direction+"_":"_icon_"+n);return i&&(this._assetNames[t]=l,this._updatedLayers[t]=o),l}getLayerTag(e,t,i){const r=this._spriteTags[i];if(r!==void 0)return r;if(!this._data)return ns.DEFAULT_TAG;const n=this._data.getLayerTag(e,t,i);return this._spriteTags[i]=n,n}getLayerInk(e,t,i){const r=this._spriteInks[i];if(r!==void 0)return r;if(!this._data)return ns.DEFAULT_INK;const n=this._data.getLayerInk(e,t,i);return this._spriteInks[i]=n,n}getLayerAlpha(e,t,i){if(!this._alphaChanged){const n=this._spriteAlphas[i];if(n!==void 0)return n}if(!this._data)return ns.DEFAULT_ALPHA;let r=this._data.getLayerAlpha(e,t,i);return this._alphaMultiplier!==null&&(r=r*this._alphaMultiplier),this._spriteAlphas[i]=r,r}getLayerColor(e,t,i){const r=this._spriteColors[t];if(r!==void 0)return r;if(!this._data)return eh.DEFAULT_COLOR;const n=this._data.getLayerColor(e,t,i);return this._spriteColors[t]=n,n}getLayerIgnoreMouse(e,t,i){const r=this._spriteMouseCaptures[i];if(r!==void 0)return r;if(!this._data)return ns.DEFAULT_IGNORE_MOUSE;const n=this._data.getLayerIgnoreMouse(e,t,i);return this._spriteMouseCaptures[i]=n,n}getLayerXOffset(e,t,i){const r=this._spriteXOffsets[i];if(r!==void 0)return r;if(!this._data)return ns.DEFAULT_XOFFSET;const n=this._data.getLayerXOffset(e,t,i);return this._spriteXOffsets[i]=n,n}getLayerYOffset(e,t,i){if(i===this._shadowLayerIndex)return Math.ceil(this._furnitureLift*(e/2));const r=this._spriteYOffsets[i];if(r!==void 0)return r;if(!this._data)return ns.DEFAULT_YOFFSET;const n=this._data.getLayerYOffset(e,t,i);return this._spriteYOffsets[i]=n,n}getLayerZOffset(e,t,i){const r=this._spriteZOffsets[i];if(r!==void 0)return r;if(!this._data)return ns.DEFAULT_ZOFFSET;const n=this._data.getLayerZOffset(e,t,i);return this._spriteZOffsets[i]=n,n}getValidSize(e){return this._data?this._data.getValidSize(e):e}setLayerCount(e){this._layerCount=e,this._shadowLayerIndex=e-this.getAdditionalLayerCount()}setDirection(e){this._direction!==e&&(this._direction=e)}getAdditionalLayerCount(){return 1}updateAnimation(e){return 0}getFrameNumber(e,t){return 0}getPostureForAsset(e,t){return null}resetSprite(e){e&&(e.texture=null,e.libraryAssetName="",e.posture="",e.tag="",e.offsetX=0,e.offsetY=0,e.flipH=!1,e.flipV=!1,e.relativeDepth=0,e.clickHandling=!1)}};_g.TYPE=Ue.FURNITURE_STATIC,_g.DEPTH_MULTIPLIER=Math.sqrt(.5);let Dl=_g;const ld=class ld extends Dl{constructor(){super(),this._state=-1,this._frameIncrease=1,this._animationData=new TG,this._animationScale=0,this._animationChangeTime=0,this._animatedLayerCount=0,this._directionChanged=!1}initialize(e){return e instanceof vN?super.initialize(e):!1}dispose(){super.dispose(),this._animationData&&(this._animationData.dispose(),this._animationData=null)}get animatedLayerCount(){return this._animatedLayerCount}get animationId(){return this._animationData.animationId}getAnimationId(e){return this.animationId!==ld.DEFAULT_ANIMATION_ID&&this.data.hasAnimation(this._animationScale,this.animationId)?this.animationId:ld.DEFAULT_ANIMATION_ID}updateObject(e,t){if(super.updateObject(e,t)){const i=this.object.getState(0);return i!==this._state&&(this.setAnimation(i),this._state=i,this._animationChangeTime=this.object.model.getValue(D.FURNITURE_STATE_UPDATE_TIME)||0),!0}return!1}updateModel(e){if(super.updateModel(e)){if(this.usesAnimationResetting()){const i=this.object.model.getValue(D.FURNITURE_STATE_UPDATE_TIME);i>this._animationChangeTime&&(this._animationChangeTime=i,this.setAnimation(this._state))}const t=this.object.model.getValue(D.FURNITURE_AUTOMATIC_STATE_INDEX);if(!isNaN(t)){const i=this.data.getAnimationId(this._animationScale,t);this.setAnimation(i)}return!0}return!1}isPlayingTransition(e,t){return!(!Mi.isTransitionFromAnimation(e.animationId)&&!Mi.isTransitionToAnimation(e.animationId)||t!==e.animationAfterTransitionId||e.animationOver)}getCurrentState(e){const t=e.animationId;return!Mi.isTransitionFromAnimation(t)&&!Mi.isTransitionToAnimation(t)?t:e.animationAfterTransitionId}setAnimation(e){this.data&&this.setSubAnimation(this._animationData,e,this._state>=0)}setSubAnimation(e,t,i=!0){const r=e.animationId;if(i){if(this.isPlayingTransition(e,t))return!1;const n=this.getCurrentState(e);if(t!==n){if(!this.data.isImmediateChange(this._animationScale,t,n)){let o=Mi.getTransitionFromAnimationId(n);this.data.hasAnimation(this._animationScale,o)?(e.animationAfterTransitionId=t,t=o):(o=Mi.getTransitionToAnimationId(t),this.data.hasAnimation(this._animationScale,o)&&(e.animationAfterTransitionId=t,t=o))}}else if(Mi.isTransitionFromAnimation(e.animationId)){const o=Mi.getTransitionToAnimationId(t);this.data.hasAnimation(this._animationScale,o)&&(e.animationAfterTransitionId=t,t=o)}else if(!Mi.isTransitionToAnimation(e.animationId)&&this.usesAnimationResetting()){const o=Mi.getTransitionFromAnimationId(n);if(this.data.hasAnimation(this._animationScale,o))e.animationAfterTransitionId=t,t=o;else{const l=Mi.getTransitionToAnimationId(t);this.data.hasAnimation(this._animationScale,l)&&(e.animationAfterTransitionId=t,t=l)}}}return r!==t?(e.animationId=t,!0):!1}getLastFramePlayed(e){return this._animationData.getLastFramePlayed(e)}resetAllAnimationFrames(){this._animationData&&this._animationData.setLayerCount(this._animatedLayerCount)}updateAnimation(e){if(!this.data)return 0;e!==this._animationScale&&(this._animationScale=e,this._animatedLayerCount=this.data.getLayerCount(e),this.resetAllAnimationFrames());const t=this.updateAnimations(e);return this._directionChanged=!1,t}updateAnimations(e){if(this._animationData.animationOver&&!this._directionChanged)return 0;const t=this.updateFramesForAnimation(this._animationData,e);return this._animationData.animationOver&&(Mi.isTransitionFromAnimation(this._animationData.animationId)||Mi.isTransitionToAnimation(this._animationData.animationId))&&(this.setAnimation(this._animationData.animationAfterTransitionId),this._animationData.animationOver=!1),t}updateFramesForAnimation(e,t){if(e.animationOver&&!this._directionChanged)return 0;const i=this.getAnimationId(e);let r=e.frameCounter;r||(r=this.data.getStartFrame(t,i,this._direction)),r+=this.frameIncrease,e.frameCounter=r,e.animationOver=!0;let n=!1,o=this._animatedLayerCount-1,l=0,c=1<<this._animatedLayerCount-1;for(;o>=0;){let u=0;if(n=e.getAnimationPlayed(o),!n||this._directionChanged){let d=e.getLastFramePlayed(o),_=e.getFrame(o);_&&_.isLastFrame&&_.remainingFrameRepeats<=this.frameIncrease&&(d=!0),(this._directionChanged||!_||_.remainingFrameRepeats>=0&&(_.remainingFrameRepeats=_.remainingFrameRepeats-this.frameIncrease)<=0)&&(u=Rc.SEQUENCE_NOT_DEFINED,_&&(u=_.activeSequence),u===Rc.SEQUENCE_NOT_DEFINED?_=this.data.getFrame(t,i,this._direction,o,r):_=this.data.getFrameFromSequence(t,i,this._direction,o,u,_.activeSequenceOffset+_.repeats,r),e.setFrame(o,_),l=l|c),!_||_.remainingFrameRepeats==Rc.FRAME_REPEAT_FOREVER?(d=!0,n=!0):e.animationOver=!1,e.setLastFramePlayed(o,d),e.setAnimationPlayed(o,n)}c=c>>1,o--}return l}getFrameNumber(e,t){const i=this._animationData.getFrame(t);return i?i.id:super.getFrameNumber(e,t)}getLayerXOffset(e,t,i){const r=super.getLayerXOffset(e,t,i),n=this._animationData.getFrame(i);return n?r+n.x:r}getLayerYOffset(e,t,i){const r=super.getLayerYOffset(e,t,i),n=this._animationData.getFrame(i);return n?r+n.y:r}usesAnimationResetting(){return!1}setDirection(e){this._direction!==e&&(super.setDirection(e),this._directionChanged=!0)}get frameIncrease(){return this._frameIncrease}get data(){return this._data}};ld.TYPE=Ue.FURNITURE_ANIMATED,ld.DEFAULT_ANIMATION_ID=0;let gi=ld;const cd=class cd extends gi{constructor(){super(),this._badgeId="",this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="",this._badgeVisibleInState=-1}updateModel(e){let t=super.updateModel(e);const i=this.object.model.getValue(D.FURNITURE_BADGE_IMAGE_STATUS),r=this.object.model.getValue(D.FURNITURE_BADGE_ASSET_NAME);if(i===-1)this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="";else if(i===1&&r!==this._badgeId){this._badgeId=r,this._badgeAssetNameNormalScale=this._badgeId,this._badgeAssetNameSmallScale===""&&(this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32");const n=this.object.model.getValue(D.FURNITURE_BADGE_VISIBLE_IN_STATE);isNaN(n)||(this._badgeVisibleInState=n),t=!0}return t}getSpriteAssetName(e,t){return this.getLayerTag(e,this.direction,t)!==cd.BADGE||this._badgeVisibleInState!==-1&&this.object.getState(0)!==this._badgeVisibleInState?super.getSpriteAssetName(e,t):e===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale}getLayerXOffset(e,t,i){let r=super.getLayerXOffset(e,t,i);if(this.getLayerTag(e,t,i)===cd.BADGE){const n=this.getAsset(e===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,i);n&&(e===64?r+=(40-n.width)/2:r+=(20-n.width)/2)}return r}getLayerYOffset(e,t,i){let r=super.getLayerYOffset(e,t,i);if(this.getLayerTag(e,t,i)===cd.BADGE){const n=this.getAsset(e===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,i);n&&(e===64?r+=(40-n.height)/2:r+=(20-n.height)/2)}return r}};cd.BADGE="BADGE";let gO=cd;const Nn=class Nn extends Dl{constructor(){super(),this._imageUrl=null,this._shortUrl=null,this._imageReady=!1,this._isAnimated=!1,this._gifCollection=null,this._offsetX=0,this._offsetY=0,this._offsetZ=0,this._blendMode=0,this._alpha=100,this._currentFrame=-1,this._totalFrames=-1}dispose(){super.dispose(),this._imageUrl&&this.asset&&this.asset.disposeAsset(this._imageUrl)}updateObject(e,t){return super.updateObject(e,t)?(this._imageReady&&this.checkAndCreateImageForCurrentState(),!0):!1}updateModel(e){const t=super.updateModel(e);if(t&&(this._offsetX=this.object.model.getValue(D.FURNITURE_BRANDING_OFFSET_X)||0,this._offsetY=this.object.model.getValue(D.FURNITURE_BRANDING_OFFSET_Y)||0,this._offsetZ=this.object.model.getValue(D.FURNITURE_BRANDING_OFFSET_Z)||0,this._blendMode=this.object.model.getValue(D.FURNITURE_BRANDING_BLEND_MODE)||0,this._alpha=this.object.model.getValue(D.FURNITURE_BRANDING_ALPHA)||100,this._isAnimated=this.object.model.getValue(D.FURNITURE_BRANDING_IS_ANIMATED)||!1),this._imageReady){if(this.checkIfImageChanged())return this._imageReady=!1,this._imageUrl=null,!0}else if(this._imageReady=this.checkIfImageReady(),this._imageReady)return this.checkAndCreateImageForCurrentState(),!0;return t}checkIfImageChanged(){const e=this.object.model.getValue(D.FURNITURE_BRANDING_IMAGE_URL);return e&&e===this._imageUrl?!1:(this._gifCollection,this.asset&&this.asset.disposeAsset(this._imageUrl),!0)}checkIfImageReady(){if(!(this.object&&this.object.model))return!1;const t=this.object.model.getValue(D.FURNITURE_BRANDING_IMAGE_URL);if(!t||this._imageUrl&&this._imageUrl===t)return!1;if(this.object.model.getValue(D.FURNITURE_BRANDING_IMAGE_STATUS)===1){let r=null;if(this._isAnimated){const n=De.instance.roomEngine.roomContentLoader.getGifCollection(t);n&&(this._gifCollection=n,r=n.textures[0])}else r=vr().getTexture(t);return r?(this.imageReady(r,t),!0):!1}return!1}imageReady(e,t){if(!e){this._imageUrl=null;return}this._imageUrl=t}checkAndCreateImageForCurrentState(){if(this._isAnimated){this.buildAssetsForGif();return}if(!this._imageUrl)return;const e=vr().getTexture(this._imageUrl);if(!e)return;const t=this.object.getState(0);this.addBackgroundAsset(e,t,0)}buildAssetsForGif(){if(!this._gifCollection)return;const e=this._gifCollection.textures,t=this._gifCollection.durations;if(!e.length||!t.length||e.length!==t.length)return;const i=this.object.getState(0);for(let r=0;r<e.length;r++){const n=e[r];t[r],n&&this.addBackgroundAsset(n,i,r)}this._currentFrame=-1,this._totalFrames=e.length}addBackgroundAsset(e,t,i){let r=0,n=0,o=!1,l=!1;switch(t){case Nn.STATE_0:r=0,n=0,o=!1,l=!1;break;case Nn.STATE_1:r=-e.width,n=0,o=!0,l=!1;break;case Nn.STATE_2:r=-e.width,n=-e.height,o=!0,l=!0;break;case Nn.STATE_3:r=0,n=-e.height,o=!1,l=!0;break}this.asset.addAsset(`${this._imageUrl}_${i}`,e,!0,r,n,o,l)}getSpriteAssetName(e,t){return this.getLayerTag(e,this._direction,t)===Nn.BRANDED_IMAGE&&this._imageUrl?`${this._imageUrl}_${this.getFrameNumber(e,t)}`:super.getSpriteAssetName(e,t)}updateAnimation(e){return!this._imageReady||!this._isAnimated||this._totalFrames<=0?0:1}getFrameNumber(e,t){if(!this._imageReady||!this._isAnimated||this._totalFrames<=0)return 0;if(this.getLayerTag(e,this._direction,t)===Nn.BRANDED_IMAGE&&this._imageUrl){let r=this._currentFrame;return r<0?r=0:r+=1,r===this._totalFrames&&(r=0),this._currentFrame=r,this._currentFrame}return 0}getLayerInk(e,t,i){return this._blendMode}getLayerAlpha(e,t,i){return Math.max(0,Math.min(this._alpha/100*255,255))}};Nn.BRANDED_IMAGE="branded_image",Nn.STATE_0=0,Nn.STATE_1=1,Nn.STATE_2=2,Nn.STATE_3=3;let em=Nn;class SG extends em{getLayerXOffset(e,t,i){return super.getLayerXOffset(e,t,i)+this._offsetX}getLayerYOffset(e,t,i){return super.getLayerYOffset(e,t,i)+this._offsetY}getLayerZOffset(e,t,i){return super.getLayerZOffset(e,t,i)+this._offsetZ}}const sc=class sc extends gi{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(e){if(e===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(sc.ANIMATION_ID_ROLL);return}if(e>=0&&e<=7){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(sc.ANIMATION_ID_OFFSET_SLOW1),this._stateQueue.push(sc.ANIMATION_ID_OFFSET_SLOW2+e),this._stateQueue.push(e);return}super.setAnimation(e)}}updateAnimation(e){return this.getLastFramePlayed(0)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(e)}};sc.ANIMATION_ID_OFFSET_SLOW1=20,sc.ANIMATION_ID_OFFSET_SLOW2=9,sc.ANIMATION_ID_ROLL=-1;let mO=sc;class qZ extends Dl{}const Eo=class Eo extends gi{getFrameNumber(e,t){const i=this.getLayerTag(e,this.direction,t),r=this.object.getState(0);switch(i){case Eo.SECONDS_SPRITE:return Math.floor(r%60%10);case Eo.TEN_SECONDS_SPRITE:return Math.floor(r%60/10);case Eo.MINUTES_SPRITE:return Math.floor(r/60%10);case Eo.TEN_MINUTES_SPRITE:return Math.floor(r/60/10%10);default:return super.getFrameNumber(e,t)}}get animationId(){return 0}};Eo.SECONDS_SPRITE="seconds_sprite",Eo.TEN_SECONDS_SPRITE="ten_seconds_sprite",Eo.MINUTES_SPRITE="minutes_sprite",Eo.TEN_MINUTES_SPRITE="ten_minutes_sprite";let fO=Eo;class XZ extends Dd{}const gg=class gg extends gi{constructor(){super(),this._thumbnailAssetNameNormal=null,this._thumbnailImageNormal=null,this._thumbnailDirection=-1,this._thumbnailChanged=!1,this._hasOutline=!1}get hasThumbnailImage(){return this._thumbnailImageNormal!=null}setThumbnailImages(e){this._thumbnailImageNormal=e,this._thumbnailChanged=!0}updateModel(e){const t=super.updateModel(e);return!this._thumbnailChanged&&this._thumbnailDirection===this.direction?t:(this.refreshThumbnail(),!0)}refreshThumbnail(){this.asset!=null&&(this._thumbnailImageNormal?this.addThumbnailAsset(this._thumbnailImageNormal,64):this.asset.disposeAsset(this.getThumbnailAssetName(64)),this._thumbnailChanged=!1,this._thumbnailDirection=this.direction)}addThumbnailAsset(e,t){let i=0;for(;i<this.totalSprites;){if(this.getLayerTag(t,this.direction,i)===gg.THUMBNAIL){const r=this.cacheSpriteAssetName(t,i,!1)+this.getFrameNumber(t,i),n=this.getAsset(r,i);if(n){const o=this.generateTransformedThumbnail(e,n),l=this.getThumbnailAssetName(t);this.asset.disposeAsset(l),this.asset.addAsset(l,o,!0,n.offsetX,n.offsetY,!1,!1)}return}i++}}generateTransformedThumbnail(e,t){if(this._hasOutline){const l=new Is,c=new Is(sC.WHITE);c.tint=0,c.width=e.width+40,c.height=e.height+40;const u=new Is(e),d=(c.width-u.width)/2,_=(c.height-u.height)/2;u.position.set(d,_),l.addChild(c,u),e=Vt.generateTexture(l)}const i=1.1,r=new qr,n=t.width/e.width;switch(this.direction){case 2:r.a=n,r.b=-.5*n,r.c=0,r.d=n*i,r.tx=0,r.ty=.5*n*e.width;break;case 0:case 4:r.a=n,r.b=.5*n,r.c=0,r.d=n*i,r.tx=0,r.ty=0;break;default:r.a=n,r.b=0,r.c=0,r.d=n,r.tx=0,r.ty=0}const o=new Is(e);return o.transform.setFromMatrix(r),Vt.generateTexture(o)}getSpriteAssetName(e,t){return this._thumbnailImageNormal&&this.getLayerTag(e,this.direction,t)===gg.THUMBNAIL?this.getThumbnailAssetName(e):super.getSpriteAssetName(e,t)}getThumbnailAssetName(e){return this._thumbnailAssetNameNormal=this.getFullThumbnailAssetName(this.object.id,64),this._thumbnailAssetNameNormal}getFullThumbnailAssetName(e,t){return[this._type,e,"thumb",t].join("_")}};gg.THUMBNAIL="THUMBNAIL";let Lp=gg;class RG extends Lp{constructor(){super(),this._cachedUrl=null,this._hasOutline=!0}updateModel(e){if(this.object){const t=this.getThumbnailURL();if(this._cachedUrl!==t)if(this._cachedUrl=t,this._cachedUrl&&this._cachedUrl!==""){const i=new Image;i.src=t,i.crossOrigin="*",i.onload=()=>{const r=Qs.from(i);r.baseTexture.scaleMode=AS.LINEAR,this.setThumbnailImages(r)}}else this.setThumbnailImages(null)}return super.updateModel(e)}getThumbnailURL(){throw new Error("This method must be overridden!")}}class $Z extends RG{constructor(){super(),this._url=null,this._typePrefix=null}getThumbnailURL(){if(!this.object)return null;if(this._url)return this._url;const e=this.object.model.getValue(D.FURNITURE_DATA);if(!e||e==="")return null;this.object.type.indexOf("")>=0&&(this._typePrefix=this.object.type.indexOf("")>=0?"":"postcards/selfie/");let i=JSON.parse(e).w||"";return i=this.buildThumbnailUrl(i),this._url=i,this._url}buildThumbnailUrl(e){return e}}class Wb{constructor(){this._hasMoved=!1,this._age=0,this._isEmitter=!1,this._fade=!1,this._alphaMultiplier=1}init(e,t,i,r,n,o,l,c=!1,u=null,d=!1){this._x=e,this._y=t,this._z=i,this._particleDirection=new Yn(r.x,r.y,r.z),this._particleDirection.scaleBy(n),this._lastX=this._x-this._particleDirection.x*o,this._lastY=this._y-this._particleDirection.y*o,this._lastZ=this._z-this._particleDirection.z*o,this._age=0,this._hasMoved=!1,this._lifeTime=l,this._isEmitter=c,this._frames=u,this._fade=d,this._alphaMultiplier=1,this._fadeTime=.5+Math.random()*.5}dispose(){this._particleDirection=null}update(){this._age++,this._age===this._lifeTime&&this.ignite(),this._fade&&this._age/this._lifeTime>this._fadeTime&&(this._alphaMultiplier=(this._lifeTime-this._age)/(this._lifeTime*(1-this._fadeTime)))}getAsset(){return this._frames&&this._frames.length>0?this._frames[this._age%this._frames.length]:null}ignite(){}get fade(){return this._fade}get alphaMultiplier(){return this._alphaMultiplier}get direction(){return this._particleDirection}get age(){return this._age}get isEmitter(){return this._isEmitter}get isAlive(){return this._age<=this._lifeTime}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get z(){return this._z}set z(e){this._z=e}get lastX(){return this._lastX}set lastX(e){this._hasMoved=!0,this._lastX=e}get lastY(){return this._lastY}set lastY(e){this._hasMoved=!0,this._lastY=e}get lastZ(){return this._lastZ}set lastZ(e){this._hasMoved=!0,this._lastZ=e}get hasMoved(){return this._hasMoved}toString(){return[this._x,this._y,this._z].toString()}copy(e,t){this._x=e._x*t,this._y=e._y*t,this._z=e._z*t,this._lastX=e._lastX*t,this._lastY=e._lastY*t,this._lastZ=e._lastZ*t,this._hasMoved=e.hasMoved,this._particleDirection=e._particleDirection,this._age=e._age,this._lifeTime=e._lifeTime,this._isEmitter=e._isEmitter,this._fade=e._fade,this._fadeTime=e._fadeTime,this._alphaMultiplier=e._alphaMultiplier}}const ic=class ic extends Wb{constructor(e="",t=-1){super(),this._roomObjectSpriteId=-1,this._timeStep=.1,this._fuseTime=10,this._energy=1,this._hasIgnited=!1,this._burstPulse=1,this._particles=[],this._name=e,this._roomObjectSpriteId=t,this._particleConfigurations=[]}dispose(){for(const e of this._particles)e.dispose();this._particles=null,this._particleConfigurations=null,super.dispose()}setup(e,t,i,r,n,o,l,c,u,d){this._maxNumberOfParticles=e,this._particlesPerFrame=t,this._force=i,this._emitterDirection=r,this._emitterDirection.normalize(),this._gravity=n,this._airFriction=o,this._explosionShape=l,this._fuseTime=u,this._energy=c,this._burstPulse=d,this.reset()}reset(){for(const e of this._particles)e.dispose();this._particles=[],this._emittedParticles=0,this._hasIgnited=!1,this.init(0,0,0,this._emitterDirection,this._force,this._timeStep,this._fuseTime,!0)}copyStateFrom(e,t){super.copy(e,t),this._force=e._force,this._emitterDirection=e._emitterDirection,this._gravity=e._gravity,this._airFriction=e._airFriction,this._explosionShape=e._explosionShape,this._fuseTime=e._fuseTime,this._energy=e._energy,this._burstPulse=e._burstPulse,this._timeStep=e._timeStep,this._hasIgnited=e._hasIgnited}configureParticle(e,t,i,r){const n={};n.lifeTime=e,n.isEmitter=t,n.frames=i,n.fade=r,this._particleConfigurations.push(n)}ignite(){this._hasIgnited=!0,this._emittedParticles<this._maxNumberOfParticles&&this.age>1&&this.releaseParticles(this,this.direction)}releaseParticles(e,t=null){t||(t=new Yn);const i=new Yn,r=this.getRandomParticleConfiguration();let n=0;for(;n<this._particlesPerFrame;){switch(this._explosionShape){case ic.CONE:i.x=this.randomBoolean(.5)?Math.random():-Math.random(),i.y=-(Math.random()+1),i.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case ic.PLANE:i.x=this.randomBoolean(.5)?Math.random():-Math.random(),i.y=0,i.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case ic.SPHERE:i.x=this.randomBoolean(.5)?Math.random():-Math.random(),i.y=this.randomBoolean(.5)?Math.random():-Math.random(),i.z=this.randomBoolean(.5)?Math.random():-Math.random();break}i.normalize();const o=new Wb;let l=0,c=!1,u=!1,d=[];r?(l=Math.floor(Math.random()*r.lifeTime+10),c=r.isEmitter,d=r.frames,u=r.fade):(l=Math.trunc(Math.floor(Math.random()*20+10)),c=!1,d=[]),o.init(e.x,e.y,e.z,i,this._energy,this._timeStep,l,c,d,u),this._particles.push(o),this._emittedParticles++,n++}}getRandomParticleConfiguration(){const e=Math.trunc(Math.floor(Math.random()*this._particleConfigurations.length));return this._particleConfigurations[e]}update(){super.update(),this.accumulateForces(),this.verlet(),this.satisfyConstraints(),!this.isAlive&&this._emittedParticles<this._maxNumberOfParticles&&this.age%this._burstPulse===0&&this.releaseParticles(this,this.direction)}verlet(){if(this.isAlive||this._emittedParticles<this._maxNumberOfParticles){const t=this.x,i=this.y,r=this.z;this.x=(2-this._airFriction)*this.x-(1-this._airFriction)*this.lastX,this.y=(2-this._airFriction)*this.y-(1-this._airFriction)*this.lastY+this._gravity*this._timeStep*this._timeStep,this.z=(2-this._airFriction)*this.z-(1-this._airFriction)*this.lastZ,this.lastX=t,this.lastY=i,this.lastZ=r}const e=[];for(const t of this._particles){t.update();const i=t.x,r=t.y,n=t.z;t.x=(2-this._airFriction)*t.x-(1-this._airFriction)*t.lastX,t.y=(2-this._airFriction)*t.y-(1-this._airFriction)*t.lastY+this._gravity*this._timeStep*this._timeStep,t.z=(2-this._airFriction)*t.z-(1-this._airFriction)*t.lastZ,t.lastX=i,t.lastY=r,t.lastZ=n,(t.y>10||!t.isAlive)&&e.push(t)}for(const t of e)t.isEmitter,this._particles.splice(this._particles.indexOf(t),1),t.dispose()}satisfyConstraints(){}accumulateForces(){for(const e of this._particles);}get particles(){return this._particles}get hasIgnited(){return this._hasIgnited}randomBoolean(e){return Math.random()<e}get roomObjectSpriteId(){return this._roomObjectSpriteId}};ic.CONE="cone",ic.PLANE="plane",ic.SPHERE="sphere";let pO=ic;class QZ{constructor(e){this._canvasId=-1,this._hasIgnited=!1,this._centerX=0,this._centerY=0,this._scaleMultiplier=1,this._blend=1,this._bgColor=4278190080,this._isDone=!1,this._emitters=new Ms,this._visualization=e,this._blackOverlayAlphaTransform=new CS,this._blackOverlayAlphaTransform.alpha=1,this._particleColorTransform=new CS,this._identityMatrix=new qr,this._translationMatrix=new qr}dispose(){for(const e of this._emitters.getValues())e.dispose();this._emitters=null,this._canvasTexture&&(this._canvasTexture.destroy(),this._canvasTexture=null),this._blackOverlay&&(this._blackOverlay.destroy(),this._blackOverlay=null),this._emptySprite&&(this._emptySprite.destroy(),this._emptySprite=null),this._blackOverlayAlphaTransform=null,this._particleColorTransform=null,this._identityMatrix=null,this._translationMatrix=null}reset(){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=null,this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}setAnimation(e){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=this._emitters.getValue(e),this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}updateCanvas(){if(!(!this._currentEmitter||this._canvasId===-1)&&(this._roomSprite=this._visualization.getSprite(this._canvasId),this._roomSprite&&this._roomSprite.texture)){if(this._roomSprite.width<=1||this._roomSprite.height<=1)return;this._canvasTexture&&(this._canvasTexture.width!==this._roomSprite.width||this._canvasTexture.height!==this._roomSprite.height)&&(this._canvasTexture=null),this.clearCanvas(),this._centerX=-this._roomSprite.offsetX,this._centerY=-this._roomSprite.offsetY,this._roomSprite.texture=this._canvasTexture}}getLayerYOffset(e,t,i){return this._currentEmitter&&this._currentEmitter.roomObjectSpriteId===i?this._currentEmitter.y*this._scaleMultiplier:0}controlsSprite(e){return this._currentEmitter?this._currentEmitter.roomObjectSpriteId==e:!1}updateSprites(){!this._currentEmitter||!this._roomSprite||(this._canvasTexture&&this._roomSprite.texture!==this._canvasTexture&&(this._roomSprite.texture=this._canvasTexture),this._hasIgnited&&this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1))}updateAnimation(){if(!this._currentEmitter||!this._roomSprite||this._isDone)return;const e=10;!this._hasIgnited&&this._currentEmitter.hasIgnited&&(this._hasIgnited=!0);const t=this._offsetY*this._scaleMultiplier;if(this._currentEmitter.update(),this._hasIgnited){this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1),this._canvasTexture||this.updateCanvas(),this.clearCanvas();for(const i of this._currentEmitter.particles){const r=this._centerX+(i.x-i.z)*e/10*this._scaleMultiplier,n=this._centerY-t+(i.y+(i.x+i.z)/2)*e/10*this._scaleMultiplier,o=i.getAsset();if(o&&o.texture)if(i.fade&&i.alphaMultiplier<1){this._translationMatrix.identity(),this._translationMatrix.translate(r+o.offsetX,n+o.offsetY);const l=new Is(o.texture);this._particleColorTransform.alpha=i.alphaMultiplier,l.filters=[this._particleColorTransform],di.instance.renderer.render(l,{renderTexture:this._canvasTexture,transform:this._translationMatrix,clear:!1})}else{const l=new ei(r+o.offsetX,n+o.offsetY),c=new Is(o.texture);c.x=l.x,c.y=l.y,di.instance.renderer.render(c,{renderTexture:this._canvasTexture,clear:!1})}else{const l=new Is(Qs.WHITE);l.tint=16777215,l.x=r-1,l.y=n-1,l.width=2,l.height=2,di.instance.renderer.render(l,{renderTexture:this._canvasTexture,clear:!1})}}if(!this._currentEmitter.particles.length){this._isDone=!0;return}}}parseData(e){this._size=e.size,this._canvasId=e.canvasId!==void 0?e.canvasId:-1,this._offsetY=e.offsetY!==void 0?e.offsetY:10,this._scaleMultiplier=this._size/64,this._blend=e.blend!==void 0?e.blend:1,this._blend=Math.min(this._blend,1),this._blackOverlayAlphaTransform.alpha=this._blend;const t=e.bgColor!==void 0?e.bgColor:"0";if(this._bgColor=parseInt(t,16)||0,!(!e.emitters||!e.emitters.length))for(const i of e.emitters){const r=i.id,n=i.name,o=i.spriteId,l=new pO(n,o);this._emitters.add(r,l);const c=i.maxNumParticles,u=i.particlesPerFrame,d=i.burstPulse!==void 0?i.burstPulse:1,_=i.fuseTime,m=i.simulation.force,f=i.simulation.direction,E=i.simulation.gravity,I=i.simulation.airFriction,p=i.simulation.shape,S=i.simulation.energy;for(const R of i.particles){const O=R.lifeTime,C=R.isEmitter||!1,A=R.fade||!1,b=[];for(const y of R.frames)b.push(this._visualization.asset.getAsset(y));l.configureParticle(O,C,b,A)}l.setup(c,u,m,new Yn(0,f,0),E,I,p,S,_,d)}}copyStateFrom(e){let t=0;e._emitters&&e._currentEmitter&&(t=e._emitters.getKey(e._emitters.getValues().indexOf(e._currentEmitter))),this.setAnimation(t),this._currentEmitter&&this._currentEmitter.copyStateFrom(e._currentEmitter,e._size/this._size),this._canvasTexture=null}clearCanvas(){this._emptySprite||(this._emptySprite=new Is(Qs.EMPTY),this._emptySprite.alpha=0),this._canvasTexture?di.instance.renderer.render(this._emptySprite,{renderTexture:this._canvasTexture,clear:!0}):this._canvasTexture=Ka.create({width:this._roomSprite.width,height:this._roomSprite.height})}}class xG extends gi{dispose(){if(super.dispose(),this._currentParticleSystem=null,this._particleSystems){for(const e of this._particleSystems.getValues())e.dispose();this._particleSystems=null}}updateObject(e,t){if(super.updateObject(e,t)){if(!this._particleSystems)this.readDefinition(),this._particleSystems?this._currentParticleSystem=this._particleSystems.getValue(e):ze.log("ERROR Particle systems could not be read!",this.object.type);else if(e!==this._scale||this._particleSystems.getValue(e)!==this._currentParticleSystem){const i=this._particleSystems.getValue(e);i.copyStateFrom(this._currentParticleSystem),this._currentParticleSystem&&this._currentParticleSystem.reset(),this._currentParticleSystem=i}return!0}return!1}updateSprites(e,t,i){super.updateSprites(e,t,i),this._currentParticleSystem&&this._currentParticleSystem.updateSprites()}updateAnimation(e){return this._currentParticleSystem&&this._currentParticleSystem.updateAnimation(),super.updateAnimation(e)}setAnimation(e){this._currentParticleSystem&&this._currentParticleSystem.setAnimation(e),super.setAnimation(e)}getLayerYOffset(e,t,i){return this._currentParticleSystem&&this._currentParticleSystem.controlsSprite(i)?this._currentParticleSystem.getLayerYOffset(e,t,i):super.getLayerYOffset(e,t,i)}readDefinition(){if(!this.object||!this.object.model)return!1;const e=this.object.model.getValue(D.FURNITURE_FIREWORKS_DATA);if(!e||!e.length)return!1;this._particleSystems=new Ms;for(const t of e){const i=t.size,r=new QZ(this);r.parseData(t),this._particleSystems.add(i,r)}return!0}}const rc=class rc extends xG{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0,this._lastAnimationId=0}update(e,t,i,r){this.updatePresentWrap(),super.update(e,t,i,r)}updatePresentWrap(){if(!this.object)return;const e=1e3,t=this.object.model.getValue(D.FURNITURE_EXTRAS),i=parseInt(t),r=Math.floor(i/e),n=i%e;this._packetType=r>rc.MAX_PACKET_TYPE_VALUE?0:r,this._ribbonType=n>rc.MAX_RIBBON_TYPE_VALUE?0:n}getFrameNumber(e,t){if(this._lastAnimationId===rc.PRESENT_DEFAULT_STATE){if(t<=1)return this._packetType;if(t===2)return this._ribbonType}return super.getFrameNumber(e,t)}getSpriteAssetName(e,t){const i=this.getValidSize(e);let r=this._type,n="";t<this.spriteCount-1?n=String.fromCharCode(97+t):n="sd";const o=this.getFrameNumber(e,t);return r=r+("_"+i+"_"+n+"_"+this.direction),r=r+("_"+o),r}setAnimation(e){this._lastAnimationId=e,super.setAnimation(e)}};rc.PRESENT_DEFAULT_STATE=0,rc.MAX_PACKET_TYPE_VALUE=9,rc.MAX_RIBBON_TYPE_VALUE=11;let EO=rc;class JZ extends Dl{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0}update(e,t,i,r){this.updatePresentWrap(),super.update(e,t,i,r)}updatePresentWrap(){if(!this.object)return;const e=this.object.model.getValue(D.FURNITURE_EXTRAS),t=1e3,i=parseInt(e);this._packetType=Math.floor(i/t),this._ribbonType=i%t}getFrameNumber(e,t){return t<=1?this._packetType:this._ribbonType}getSpriteAssetName(e,t){const i=this.getValidSize(e);let r=this._type,n="";t<this.spriteCount-1?n=String.fromCharCode(97+t):n="sd";const o=this.getFrameNumber(e,t);return r=r+("_"+i+"_"+n+"_"+this.direction),r=r+("_"+o),r}}const Br=class Br extends gi{constructor(){super(),this._color1=Br.DEFAULT_COLOR_1,this._color2=Br.DEFAULT_COLOR_2,this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale=""}updateModel(e){const t=super.updateModel(e);if(this._badgeAssetNameNormalScale===""){const n=this.object.model.getValue(D.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);n&&(this._badgeAssetNameNormalScale=n,this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32")}const i=this.object.model.getValue(D.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=i||Br.DEFAULT_COLOR_1;const r=this.object.model.getValue(D.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=r||Br.DEFAULT_COLOR_2,t}getLayerColor(e,t,i){switch(this.getLayerTag(e,this._direction,t)){case Br.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case Br.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(e,t,i)}getSpriteAssetName(e,t){return this.getLayerTag(e,this._direction,t)===Br.BADGE?e===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale:super.getSpriteAssetName(e,t)}getLibraryAssetNameForSprite(e,t){return t.tag===Br.BADGE?"%group.badge.url%"+t.libraryAssetName.replace("badge_",""):super.getLibraryAssetNameForSprite(e,t)}};Br.PRIMARY_COLOUR_SPRITE_TAG="COLOR1",Br.SECONDARY_COLOUR_SPRITE_TAG="COLOR2",Br.BADGE="BADGE",Br.DEFAULT_COLOR_1=15658734,Br.DEFAULT_COLOR_2=4934475;let IO=Br;const va=class va extends Lp{updateModel(e){const t=super.updateModel(e);if(!this.hasThumbnailImage){const n=this.object.model.getValue(D.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);n&&n.length&&this.setThumbnailImages(this.getBitmapAsset(n))}const i=this.object.model.getValue(D.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=i||va.DEFAULT_COLOR_1;const r=this.object.model.getValue(D.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=r||va.DEFAULT_COLOR_2,t}generateTransformedThumbnail(e,t){const r=new qr,n=t.width/e.width;switch(this.direction){case 2:r.a=n,r.b=-.5*n,r.c=0,r.d=n*1.1,r.tx=0,r.ty=.5*n*e.width;break;case 0:case 4:r.a=n,r.b=.5*n,r.c=0,r.d=n*1.1,r.tx=0,r.ty=0;break;default:r.a=n,r.b=0,r.c=0,r.d=n,r.tx=0,r.ty=0}const o=new Is(e);return o.transform.setFromMatrix(r),o.position.set(0),Vt.generateTexture(o)}getLayerColor(e,t,i){switch(this.getLayerTag(e,this._direction,t)){case va.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case va.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(e,t,i)}getLibraryAssetNameForSprite(e,t){return t.tag===va.THUMBNAIL&&this.object&&this.object.model.getValue(D.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME)?"%group.badge.url%"+this.object.model.getValue(D.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME):super.getLibraryAssetNameForSprite(e,t)}getBitmapAsset(e){const t=this.asset.getAsset(e);return!t||!t.texture?null:t.texture}};va.PRIMARY_COLOUR_SPRITE_TAG="COLOR1",va.SECONDARY_COLOUR_SPRITE_TAG="COLOR2",va.DEFAULT_COLOR_1=15658734,va.DEFAULT_COLOR_2=4934475;let TO=va;const ya=class ya extends gi{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(e){if(e===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(ya.ANIMATION_ID_START_ROLL),this._stateQueue.push(ya.ANIMATION_ID_ROLL);return}if(e>0&&e<=ya.ANIMATION_ID_OFFSET_SLOW1){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(ya.ANIMATION_ID_OFFSET_SLOW1+e),this._stateQueue.push(ya.ANIMATION_ID_OFFSET_SLOW2+e),this._stateQueue.push(e);return}super.setAnimation(e)}}updateAnimation(e){return this.getLastFramePlayed(1)&&this.getLastFramePlayed(2)&&this.getLastFramePlayed(3)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(e)}};ya.ANIMATION_ID_OFFSET_SLOW1=10,ya.ANIMATION_ID_OFFSET_SLOW2=20,ya.ANIMATION_ID_START_ROLL=31,ya.ANIMATION_ID_ROLL=32;let SO=ya;class ZZ extends SG{constructor(){super(...arguments),this._needsTransform=!0}transformGifTextures(e){if(!this._gifCollection)return;const t=this._gifCollection.textures;if(t.length){for(let i=0;i<t.length;i++){const r=t[i];if(!r||!this.getAsset(`${this._imageUrl}_${i}`))continue;const o=1.1,l=new qr,c=e.width/r.width;switch(this.direction){case 2:l.a=c,l.b=-.5*c,l.c=0,l.d=c*o,l.tx=0,l.ty=.5*c*r.width;break;case 0:case 4:l.a=c,l.b=.5*c,l.c=0,l.d=c*o,l.tx=0,l.ty=0;break;default:l.a=c,l.b=0,l.c=0,l.d=c,l.tx=0,l.ty=0}const u=new Is(r),d=Ka.create({width:e.width+l.tx,height:e.height+l.ty});di.instance.renderer.render(u,{renderTexture:d,clear:!0,transform:l}),this.asset.disposeAsset(`${this._imageUrl}_${i}`),this.asset.addAsset(`${this._imageUrl}_${i}`,d,!0,e.x,e.y,e.flipH,e.flipV)}this._needsTransform=!1}}generateTransformedImage(e,t){const r=new qr,n=t.width/e.width;switch(this.direction){case 2:r.a=n,r.b=-.5*n,r.c=0,r.d=n*1.1,r.tx=0,r.ty=.5*n*e.width;break;case 0:case 4:r.a=n,r.b=.5*n,r.c=0,r.d=n*1.1,r.tx=0,r.ty=0;break;default:r.a=n,r.b=0,r.c=0,r.d=n,r.tx=0,r.ty=0}const o=new Is(e),l=Ka.create({width:t.width+r.tx,height:t.height+r.ty});di.instance.renderer.render(o,{renderTexture:l,clear:!0,transform:r}),this.asset.disposeAsset(`${this._imageUrl}_0`),this.asset.addAsset(`${this._imageUrl}_0`,l,!0,o.x,o.y,t.flipH,t.flipV),this._needsTransform=!1}checkAndCreateImageForCurrentState(){super.checkAndCreateImageForCurrentState(),this._needsTransform=!0}getSpriteAssetName(e,t){return this.getLayerTag(e,this._direction,t)===em.BRANDED_IMAGE&&this._imageUrl?(this._needsTransform&&(this._isAnimated?this.transformGifTextures(this.getAsset(super.getSpriteAssetName(e,t))):this.generateTransformedImage(vr().getTexture(this._imageUrl),this.getAsset(super.getSpriteAssetName(e,t)))),`${this._imageUrl}_${this.getFrameNumber(e,t)}`):super.getSpriteAssetName(e,t)}}class RO extends Uo{constructor(){super(),this._avatarData=new Dp}dispose(){super.dispose(),this._avatarData&&(this._avatarData.dispose(),this._avatarData=null)}createAvatarImage(e,t,i=null,r=null,n=null){return this._avatarData.createAvatarImage(e,t,i,r,n)}set avatarManager(e){this._avatarData.avatarManager=e}}const ud=class ud extends Dl{constructor(){super(),this._mannequinScale=-1,this._figure=null,this._gender=null,this._dynamicAssetName=null,this._needsUpdate=!1,this._placeHolderFigure="hd-99999-99998",this._disposed=!1}initialize(e){return e instanceof RO?super.initialize(e):!1}dispose(){this._disposed||(this._disposed=!0,this._dynamicAssetName&&this.asset&&(this.asset.disposeAsset(this._dynamicAssetName),this._dynamicAssetName=null),super.dispose())}updateObject(e,t){const i=super.updateObject(e,t);return i&&this._mannequinScale!==e&&(this._mannequinScale=e,this.updateAvatar()),i}updateModel(e){let t=super.updateModel(e);if(t){const i=this.object.model.getValue(D.FURNITURE_MANNEQUIN_FIGURE)||null;i&&(this._figure=i+"."+this._placeHolderFigure,this._gender=this.object.model.getValue(D.FURNITURE_MANNEQUIN_GENDER)||null,this.updateAvatar())}return t=t||this._needsUpdate,this._needsUpdate=!1,t}updateAvatar(e=!1){if(!this.avatarExists()||e){const t=this.data.createAvatarImage(this._figure,this._mannequinScale,this._gender,this);t&&(t.setDirection(ki.FULL,this.direction),this._dynamicAssetName&&this.asset.disposeAsset(this._dynamicAssetName),this.asset.addAsset(this.getAvatarAssetName(),t.getImage(ki.FULL,!1,1,!1),!0),this._dynamicAssetName=this.getAvatarAssetName(),this._needsUpdate=!0,t.dispose())}}avatarExists(){return this._figure&&this.getAsset(this.getAvatarAssetName())!==null}getAvatarAssetName(){return"mannequin_"+this._figure+"_"+this._mannequinScale+"_"+this.direction+"_"+this.object.id}resetFigure(e){e===this._figure&&this.updateAvatar(!0)}getSpriteAssetName(e,t){const i=this.getLayerTag(e,this.direction,t);return this._figure&&i===ud.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?this.getAvatarAssetName():super.getSpriteAssetName(e,t)}getLayerXOffset(e,t,i){return this.getLayerTag(e,t,i)===ud.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(i).width/2:super.getLayerXOffset(e,t,i)}getLayerYOffset(e,t,i){return this.getLayerTag(e,t,i)===ud.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(i).height:super.getLayerYOffset(e,t,i)}get disposed(){return this._disposed}get data(){return this._data}};ud.AVATAR_IMAGE_SPRITE_TAG="avatar_image";let xO=ud;const An=class An extends gi{constructor(){super(),this._animOffsetIndex=[]}updateAnimation(e){this._animSpeedIndex||this.initItems(e);let t=this.getSprite(2);return t&&(this._animOffsetIndex[0]=this.getNewPoint(e,0)),t=this.getSprite(3),t&&(this._animOffsetIndex[1]=this.getNewPoint(e,1)),super.updateAnimation(e)}getNewPoint(e,t){let i=0,r=this._animPhaseIndex[t],n=this._animDirectionIndex[t];const o=this._animSpeedIndex[t],l=this._animFactorIndex[t];let c=1;e==32?(i=An.AREA_DIAMETER_SMALL,c=.5):i=An.AREA_DIAMETER_LARGE;const u=r+n*o;Math.abs(u)>=i&&(n>0?r=r-(u-i):r=r+(-i-u),n=-n,this._animDirectionIndex[t]=n);const d=(i-Math.abs(r))*l;let _=n*Math.sin(Math.abs(r/4))*d;return n>0?_=_-d:_=_+d,r=r+n*o*c,this._animPhaseIndex[t]=r,Math.trunc(_)==0&&(this._animFactorIndex[t]=this.getRandomAmplitudeFactor()),new ei(r,_)}initItems(e){let t;e===32?t=An.AREA_DIAMETER_SMALL:t=An.AREA_DIAMETER_LARGE,this._animPhaseIndex=[],this._animPhaseIndex.push(Math.random()*t*1.5),this._animPhaseIndex.push(Math.random()*t*1.5),this._animDirectionIndex=[],this._animDirectionIndex.push(1),this._animDirectionIndex.push(-1),this._animSpeedIndex=[],this._animSpeedIndex.push(An.ANIM_SPEED_FAST),this._animSpeedIndex.push(An.ANIM_SPEED_SLOW),this._animFactorIndex=[],this._animFactorIndex.push(this.getRandomAmplitudeFactor()),this._animFactorIndex.push(this.getRandomAmplitudeFactor())}getLayerXOffset(e,t,i){return(i===2||i===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[i-2].x:super.getLayerXOffset(e,t,i)}getLayerYOffset(e,t,i){return(i===2||i===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[i-2].y:super.getLayerYOffset(e,t,i)}getRandomAmplitudeFactor(){return Math.random()*30/100+.15}};An.UPDATE_INTERVAL=2,An.AREA_DIAMETER_SMALL=15,An.AREA_DIAMETER_LARGE=31,An.ANIM_SPEED_FAST=2,An.ANIM_SPEED_SLOW=1;let OO=An;const yI=class yI{constructor(e,t,i,r,n,o){this._name=e,this._index=t,this._radius=i,this._arcSpeed=r*Math.PI*2/360,this._arcOffset=n*Math.PI*2/360,this._height=o,this._position=0,this._positionVector=new Y(0,0,0),this._children=[]}dispose(){for(;this._children.length>0;)this._children.shift().dispose()}update(e,t,i){this._position=this._position+this._arcSpeed/yI.SYSTEM_TEMPO,e[this._index]=this.getPositionVector(t,i);for(const r of this._children)r.update(e,this._positionVector,i)}getPositionVector(e,t){const i=this._radius*Math.cos(this._position+this._arcOffset),r=this._radius*Math.sin(this._position+this._arcOffset);return this._positionVector.x=(i-r)*(t/2),this._positionVector.y=(r+i)*(t/2)*.5-this._height*(t/2),this._positionVector.z=-Math.trunc(4*(i+r)-.7),e&&this._positionVector.add(e),this._positionVector}addChild(e){this._children.indexOf(e)>=0||this._children.push(e)}hasChild(e){return!!this.getChild(e)}getChild(e){for(const t of this._children){if(t.name===e)return t;if(t.hasChild(e))return t.getChild(e)}return null}get name(){return this._name}};yI.SYSTEM_TEMPO=30;let CO=yI;class eee extends gi{constructor(){super(),this._offsetArray=[],this._rootPosition=new Y}dispose(){if(this._planetIndex)for(;this._planetIndex.length>0;)this._planetIndex.shift().dispose();this._planetIndex=null,this._planetNameIndex=null}updateAnimation(e){if(!this._planetIndex&&this.spriteCount>0&&!this.processPlanets())return 0;if(this._planetIndex){for(const t of this._planetIndex)t.update(this._offsetArray,this._rootPosition,e);return super.updateAnimation(e)}return 0}getLayerXOffset(e,t,i){return this._offsetArray[i]?this._offsetArray[i].x:super.getLayerXOffset(e,t,i)}getLayerYOffset(e,t,i){return this._offsetArray[i]?this._offsetArray[i].y:super.getLayerYOffset(e,t,i)}getLayerZOffset(e,t,i){return this._offsetArray[i]?this._offsetArray[i].z:super.getLayerZOffset(e,t,i)}processPlanets(){if(!this.object||!this.object.model)return;const e=this.object.model.getValue(D.FURNITURE_PLANETSYSTEM_DATA);if(!e)return!1;this._planetIndex=[],this._planetNameIndex=[];for(const t of e)this.getSprite(t.id)&&this.addPlanet(t.name,t.id,t.parent,t.radius||0,t.arcSpeed||0,t.arcOffset||0,t.height||0);return!0}addPlanet(e,t,i,r,n,o,l){if(!this._planetIndex)return;const c=new CO(e,t,r,n,o,l),u=this.getPlanet(i);u?u.addChild(c):(this._planetIndex.push(c),this._planetNameIndex.push(e))}getPlanet(e){for(const t of this._planetIndex){if(t.name===e)return t;if(t.hasChild(e))return t.getChild(e)}return null}}class tee extends gi{}const gl=class gl extends gi{constructor(){super(),this._stateQueue=[],this._animationCounter=-1}setAnimation(e){return e===gl.ANIMATION_ID_ROLL_ONCE&&(this._stateQueue=[],this._stateQueue.push(gl.ANIMATION_ID_NORMAL),this._animationCounter=gl.ANIMATION_DURATION),super.setAnimation(e)}updateAnimation(e){return this._animationCounter>0&&this._animationCounter--,this._animationCounter||this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(e)}usesAnimationResetting(){return!0}};gl.ANIMATION_ID_ROLL=3,gl.ANIMATION_ID_ROLL_ONCE=2,gl.ANIMATION_ID_NORMAL=1,gl.ANIMATION_DURATION=15;let NO=gl;class see extends gi{usesAnimationResetting(){return!0}}class iee extends em{imageReady(e,t){super.imageReady(e,t),e&&this.setImageOffset(e.width,e.height)}setImageOffset(e,t){const i=new IG;i.setDirection(1,0,-t),i.setDirection(3,0,0),i.setDirection(5,-e,0),i.setDirection(7,-e,-t),i.setDirection(4,-e/2,-t/2),this._imageOffset=i}getLayerXOffset(e,t,i){if(this._imageOffset){const r=this._imageOffset.getXOffset(t,0);if(r!==void 0)return r+this._offsetX}return super.getLayerXOffset(e,t,i)+this._offsetX}getLayerYOffset(e,t,i){if(this._imageOffset){const r=this._imageOffset.getYOffset(t,0);if(r!==void 0)return r+this._offsetY}return super.getLayerYOffset(e,t,i)+this._offsetY}getLayerZOffset(e,t,i){return super.getLayerZOffset(e,t,i)+-this._offsetZ}getLayerIgnoreMouse(e,t,i){return!0}}const Io=class Io extends gi{getFrameNumber(e,t){const i=this.getLayerTag(e,this.direction,t),r=this.object.getState(0);switch(i){case Io.ONES_SPRITE:return Math.floor(r%10);case Io.TENS_SPRITE:return Math.floor(r/10%10);case Io.HUNDREDS_SPRITE:return Math.floor(r/100%10);case Io.THOUSANDS_SPRITE:return Math.floor(r/1e3%10);default:return super.getFrameNumber(e,t)}}};Io.ONES_SPRITE="ones_sprite",Io.TENS_SPRITE="tens_sprite",Io.HUNDREDS_SPRITE="hundreds_sprite",Io.THOUSANDS_SPRITE="thousands_sprite";let AO=Io;class ree extends gi{constructor(){super(...arguments),this._internalFrameIncreaseCounter=0}updateAnimations(e){return this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter+this.object.model.getValue(D.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED),this._frameIncrease=this._internalFrameIncreaseCounter,this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter-this._frameIncrease,super.updateAnimations(e)}}class nee extends Dl{getLayerColor(e,t,i){return this._data?this._data.getLayerColor(e,t,i):eh.DEFAULT_COLOR}}const ur=class ur extends gi{constructor(){super(),this._stateQueue=[],this._running=!1,super.setAnimation(ur.ANIMATION_ID_OFF)}setAnimation(e){if(e===0&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(ur.ANIMATION_ID_START_ROLL),this._stateQueue.push(ur.ANIMATION_ID_ROLL);return}if(e>0&&e<=ur.ANIMATION_ID_OFFSET_SLOW2){if(this._running){this._running=!1,this._stateQueue=[],this.direction===2?(this._stateQueue.push(ur.ANIMATION_ID_OFFSET_SLOW1+5),this._stateQueue.push(ur.ANIMATION_ID_OFFSET_SLOW2+5)):(this._stateQueue.push(ur.ANIMATION_ID_OFFSET_SLOW1+e),this._stateQueue.push(ur.ANIMATION_ID_OFFSET_SLOW2+e)),this._stateQueue.push(ur.ANIMATION_ID_OFF);return}super.setAnimation(ur.ANIMATION_ID_OFF)}}updateAnimation(e){return this.getLastFramePlayed(11)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(e)}};ur.ANIMATION_ID_OFFSET_SLOW1=20,ur.ANIMATION_ID_OFFSET_SLOW2=10,ur.ANIMATION_ID_START_ROLL=31,ur.ANIMATION_ID_ROLL=32,ur.ANIMATION_ID_OFF=30;let bO=ur;const bn=class bn extends gi{updateObject(e,t){return super.updateObject(e,t),!0}getFrameNumber(e,t){const i=this.object.model.getValue(D.FURNITURE_VOTE_COUNTER_COUNT);switch(this.getLayerTag(e,this.direction,t)){case bn.ONES_SPRITE:return i%10;case bn.TENS_SPRITE:return i/10%10;case bn.HUNDREDS_SPRITE:return i/100%10;default:return super.getFrameNumber(e,t)}}getLayerAlpha(e,t,i){if(this.object.model.getValue(D.FURNITURE_VOTE_COUNTER_COUNT)===bn.HIDE_COUNTER_SCORE)switch(this.getLayerTag(e,t,i)){case bn.ONES_SPRITE:case bn.TENS_SPRITE:case bn.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(e,t,i)}};bn.ONES_SPRITE="ones_sprite",bn.TENS_SPRITE="tens_sprite",bn.HUNDREDS_SPRITE="hundreds_sprite",bn.HIDE_COUNTER_SCORE=-1;let vO=bn;const Vr=class Vr extends gi{getFrameNumber(e,t){const i=this.object.model.getValue(D.FURNITURE_VOTE_MAJORITY_RESULT);switch(this.getLayerTag(e,this.direction,t)){case Vr.ONES_SPRITE:return i%10;case Vr.TENS_SPRITE:return i/10%10;case Vr.HUNDREDS_SPRITE:return i/100%10;default:return super.getFrameNumber(e,t)}}getLayerAlpha(e,t,i){const r=this.object.model.getValue(D.FURNITURE_VOTE_MAJORITY_RESULT);if(Vr.HIDE_RESULTS_STATES.indexOf(this.object.getState(0))!==-1||r===Vr.HIDE_RESULTS_VALUE)switch(this.getLayerTag(e,t,i)){case Vr.ONES_SPRITE:case Vr.TENS_SPRITE:case Vr.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(e,t,i)}};Vr.ONES_SPRITE="ones_sprite",Vr.TENS_SPRITE="tens_sprite",Vr.HUNDREDS_SPRITE="hundreds_sprite",Vr.HIDE_RESULTS_STATES=[-1,1],Vr.HIDE_RESULTS_VALUE=-1;let yO=Vr;class aee extends gi{}const DI=class DI extends RG{getThumbnailURL(){if(!this.object)return null;const e=this.object.model.getValue(D.FURNITURE_DATA);return e&&e[DI.THUMBNAIL_URL]||null}};DI.THUMBNAIL_URL="THUMBNAIL_URL";let DO=DI;class oee{constructor(e){this._sprite=new Is(e),this._texture=null,this._amount=-1,this._alpha=0}renderBubble(e){if(!this._sprite||this._amount===e)return null;const t=new kn;t.addChild(this._sprite);const i=new nV("+"+e,{fontFamily:"Arial",fontSize:9,fill:16777215,align:"center"});return i.anchor.x=.5,i.x=this._sprite.width/2,i.y=19,t.addChild(i),this._texture?di.instance.renderer.render(t,{renderTexture:this._texture,clear:!0}):this._texture=Vt.generateTexture(t),this._texture}get amount(){return this._amount}set amount(e){this._amount=e}get alpha(){return this._alpha}set alpha(e){this._alpha=e}}class OG extends vN{constructor(){super(),this._isAllowedToTurnHead=!0}createSizeData(e,t,i){return e>1?new $c(t,i):new jp(t,i)}defineVisualizations(e){return this._isAllowedToTurnHead=!0,super.defineVisualizations(e)}processVisualElement(e,t,i){if(!e||!t||!i)return!1;switch(t){case"postures":if(!(e instanceof $c)||!e.processPostures(i))return!1;break;case"gestures":if(!(e instanceof $c)||!e.processGestures(i))return!1;break;default:if(!super.processVisualElement(e,t,i))return!1;break}return!0}postureToAnimation(e,t){const i=this.getSizeData(e);return i?i.postureToAnimation(t):$c.DEFAULT}getGestureDisabled(e,t){const i=this.getSizeData(e);return i?i.getGestureDisabled(t):!1}gestureToAnimation(e,t){const i=this.getSizeData(e);return i?i.gestureToAnimation(t):$c.DEFAULT}animationToPosture(e,t,i){const r=this.getSizeData(e);return r?r.animationToPosture(t,i):null}animationToGesture(e,t){const i=this.getSizeData(e);return i?i.animationToGesture(t):null}getGestureForAnimationId(e,t){const i=this.getSizeData(e);return i?i.getGestureForAnimationId(t):null}totalPostures(e){const t=this.getSizeData(e);return t?t.totalPostures:0}totalGestures(e){const t=this.getSizeData(e);return t?t.totalGestures:0}get isAllowedToTurnHead(){return this._isAllowedToTurnHead}}const Ns=class Ns extends gi{constructor(){for(super(),this._posture="",this._gesture="",this._isSleeping=!1,this._headDirection=-1,this._headOnly=!1,this._nonHeadSprites=[],this._headSprites=[],this._saddleSprites=[],this._animationOver=!1,this._paletteIndex=-1,this._paletteName="",this._customLayerIds=[],this._customPartIds=[],this._customPaletteIds=[],this._isRiding=!1,this._color=16777215,this._experience=0,this._experienceTimestamp=0,this._experienceData=null,this._previousAnimationDirection=-1,this._animationStates=[];this._animationStates.length<Ns.ANIMATION_INDEX_COUNT;)this._animationStates.push(new TG)}initialize(e){if(!(e instanceof OG))return!1;const t=this.getPetAdditionAsset(Ns.PET_EXPERIENCE_BUBBLE);return t&&(this._experienceData=new oee(t)),super.initialize(e)}dispose(){if(super.dispose(),this._animationStates){for(;this._animationStates.length;){const e=this._animationStates[0];e&&e.dispose(),this._animationStates.pop()}this._animationStates=null}}getAnimationId(e){return e.animationId}update(e,t,i,r){super.update(e,t,i,r),this.updateExperienceBubble(t)}updateExperienceBubble(e){if(this._experienceData&&(this._experienceData.alpha=0,this._experienceTimestamp)){const t=e-this._experienceTimestamp;t<Ns.EXPERIENCE_BUBBLE_VISIBLE_IN_MS?this._experienceData.alpha=Math.sin(t/Ns.EXPERIENCE_BUBBLE_VISIBLE_IN_MS*Math.PI)*255:this._experienceTimestamp=0;const i=this.getSprite(this.totalSprites-1);if(i){if(this._experienceData.alpha>0){const r=this._experienceData.renderBubble(this._experience);if(r){i.texture=r,i.offsetX=-20,i.offsetY=-80,i.alpha=this._experienceData.alpha,i.visible=!0,i.relativeDepth=-.2;return}}i.texture=null,i.visible=!1}}}updateModel(e){const t=this.object&&this.object.model;if(!t||this.updateModelCounter===t.updateCounter)return!1;const i=t.getValue(D.FIGURE_POSTURE),r=t.getValue(D.FIGURE_GESTURE);this.setPostureAndGesture(i,r);let n=t.getValue(D.FURNITURE_ALPHA_MULTIPLIER)||null;(n===null||isNaN(n))&&(n=1),this._alphaMultiplier!==n&&(this._alphaMultiplier=n,this._alphaChanged=!0),this._isSleeping=t.getValue(D.FIGURE_SLEEP)>0;const o=t.getValue(D.HEAD_DIRECTION);!isNaN(o)&&this.data.isAllowedToTurnHead?this._headDirection=o:this._headDirection=this.object.getDirection().x,this._experience=t.getValue(D.FIGURE_GAINED_EXPERIENCE),this._experienceTimestamp=t.getValue(D.FIGURE_EXPERIENCE_TIMESTAMP);const l=t.getValue(D.PET_PALETTE_INDEX),c=t.getValue(D.PET_CUSTOM_LAYER_IDS),u=t.getValue(D.PET_CUSTOM_PARTS_IDS),d=t.getValue(D.PET_CUSTOM_PALETTE_IDS),_=t.getValue(D.PET_IS_RIDING),m=t.getValue(D.PET_HEAD_ONLY),f=t.getValue(D.PET_COLOR);return l!==this._paletteIndex&&(this._paletteIndex=l,this._paletteName=this._paletteIndex.toString()),this._customLayerIds=c||[],this._customPartIds=u||[],this._customPaletteIds=d||[],this._isRiding=!isNaN(_)&&_>0,this._headOnly=!isNaN(m)&&m>0,!isNaN(f)&&this._color!==f&&(this._color=f),this.updateModelCounter=t.updateCounter,!0}updateAnimation(e){if(this.object){const t=this.object.getDirection().x;t!==this._previousAnimationDirection&&(this._previousAnimationDirection=t,this.resetAllAnimationFrames())}return super.updateAnimation(e)}setPostureAndGesture(e,t){this.data&&(e!==this._posture&&(this._posture=e,this.setAnimationForIndex(Ns.POSTURE_ANIMATION_INDEX,this.data.postureToAnimation(this._scale,e))),this.data.getGestureDisabled(this._scale,e)&&(t=null),t!==this._gesture&&(this._gesture=t,this.setAnimationForIndex(Ns.GESTURE_ANIMATION_INDEX,this.data.gestureToAnimation(this._scale,t))))}getAnimationStateData(e){return e>=0&&e<this._animationStates.length?this._animationStates[e]:null}setAnimationForIndex(e,t){const i=this.getAnimationStateData(e);i&&this.setSubAnimation(i,t)&&(this._animationOver=!1)}resetAllAnimationFrames(){this._animationOver=!1;let e=this._animationStates.length-1;for(;e>=0;){const t=this._animationStates[e];t&&t.setLayerCount(this.animatedLayerCount),e--}}updateAnimations(e){if(this._animationOver)return 0;let t=!0,i=0,r=0;for(;r<this._animationStates.length;){const n=this._animationStates[r];if(n&&!n.animationOver){const o=this.updateFramesForAnimation(n,e);i=i|o,n.animationOver?(Mi.isTransitionFromAnimation(n.animationId)||Mi.isTransitionToAnimation(n.animationId))&&(this.setAnimationForIndex(r,n.animationAfterTransitionId),t=!1):t=!1}r++}return this._animationOver=t,i}getSpriteAssetName(e,t){if(this._headOnly&&this.isNonHeadSprite(t)||this._isRiding&&this._parser3(t))return null;const i=this.totalSprites;if(t<i-Ns.ADDITIONAL_SPRITE_COUNT){const r=this.getValidSize(e);if(t<i-(1+Ns.ADDITIONAL_SPRITE_COUNT)){if(t>=Uo.LAYER_LETTERS.length)return null;const n=Uo.LAYER_LETTERS[t];return r===1?this._type+"_icon_"+n:this._type+"_"+r+"_"+n+"_"+this.getDirection(e,t)+"_"+this.getFrameNumber(r,t)}return this._type+"_"+r+"_sd_"+this.getDirection(e,t)+"_0"}return null}getLayerColor(e,t,i){return t<this.totalSprites-Ns.ADDITIONAL_SPRITE_COUNT?this._color:16777215}getLayerXOffset(e,t,i){let r=super.getLayerXOffset(e,t,i),n=this._animationStates.length-1;for(;n>=0;){const o=this._animationStates[n];if(o){const l=o.getFrame(i);l&&(r+=l.x)}n--}return r}getLayerYOffset(e,t,i){let r=super.getLayerYOffset(e,t,i),n=this._animationStates.length-1;for(;n>=0;){const o=this._animationStates[n];if(o){const l=o.getFrame(i);l&&(r+=l.y)}n--}return r}getLayerZOffset(e,t,i){return this.data?this.data.getLayerZOffset(e,this.getDirection(e,i),i):ns.DEFAULT_ZOFFSET}getDirection(e,t){return this.isHeadSprite(t)?this.data.getValidDirection(e,this._headDirection):this._direction}getFrameNumber(e,t){let i=this._animationStates.length-1;for(;i>=0;){const r=this._animationStates[i];if(r){const n=r.getFrame(t);if(n)return n.id}i--}return super.getFrameNumber(e,t)}isHeadSprite(e){if(this._headSprites[e]===void 0){const t=this.data.getLayerTag(this._scale,Ec.USE_DEFAULT_DIRECTION,e)===Ns.HEAD,i=this.data.getLayerTag(this._scale,Ec.USE_DEFAULT_DIRECTION,e)===Ns.HAIR;t||i?this._headSprites[e]=!0:this._headSprites[e]=!1}return this._headSprites[e]}isNonHeadSprite(e){if(this._nonHeadSprites[e]===void 0)if(e<this.totalSprites-(1+Ns.ADDITIONAL_SPRITE_COUNT)){const t=this.data.getLayerTag(this._scale,Ec.USE_DEFAULT_DIRECTION,e);t&&t.length>0&&t!==Ns.HEAD&&t!==Ns.HAIR?this._nonHeadSprites[e]=!0:this._nonHeadSprites[e]=!1}else this._nonHeadSprites[e]=!0;return this._nonHeadSprites[e]}_parser3(e){return this._saddleSprites[e]===void 0&&(this.data.getLayerTag(this._scale,Ec.USE_DEFAULT_DIRECTION,e)===Ns.SADDLE?this._saddleSprites[e]=!0:this._saddleSprites[e]=!1),this._saddleSprites[e]}getAsset(e,t=-1){if(!this.asset)return null;const i=this._customLayerIds.indexOf(t);let r=this._paletteName,n=-1,o=-1;return i>-1&&(n=this._customPartIds[i],o=this._customPaletteIds[i],r=o>-1?o.toString():this._paletteName),!isNaN(n)&&n>-1&&(e=e+"_"+n),this.asset.getAssetWithPalette(e,r)}getAdditionalLayerCount(){return super.getAdditionalLayerCount()+Ns.ADDITIONAL_SPRITE_COUNT}setLayerCount(e){super.setLayerCount(e),this._headSprites=[]}getPostureForAsset(e,t){const i=t.split("_");let r=i.length,n=0;for(;n<i.length;){if(i[n]==="64"||i[n]==="32"){r=n+3;break}n++}let o=null;if(r<i.length){let l=i[r];l=l.split("@")[0],o=this.data.animationToPosture(e,parseInt(l)/100,!1),o||(o=this.data.getGestureForAnimationId(e,parseInt(l)/100))}return o}getPetAdditionAsset(e){return vr().getTexture(e)}get data(){return this._data}};Ns.TYPE=Ue.PET_ANIMATED,Ns.HEAD="head",Ns.SADDLE="saddle",Ns.HAIR="hair",Ns.ADDITIONAL_SPRITE_COUNT=1,Ns.EXPERIENCE_BUBBLE_VISIBLE_IN_MS=1e3,Ns.PET_EXPERIENCE_BUBBLE="avatar_addition_pet_experience_bubble",Ns.POSTURE_ANIMATION_INDEX=0,Ns.GESTURE_ANIMATION_INDEX=1,Ns.ANIMATION_INDEX_COUNT=2;let MO=Ns;const MI=class MI{constructor(e,t=-1,i=1,r=-1,n=1){this._normalMinX=t,this._normalMaxX=i,this._normalMinY=r,this._normalMaxY=n,this._asset=e}get asset(){return this._asset}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}dispose(){this._asset=null}};MI.MIN_NORMAL_COORDINATE_VALUE=-1,MI.MAX_NORMAL_COORDINATE_VALUE=1;let jO=MI;const jI=class jI{constructor(){this._bitmaps=[]}dispose(){for(const e of this._bitmaps)e&&e.dispose();this._bitmaps=null}addBitmap(e,t=-1,i=1,r=-1,n=1){this._bitmaps.push(new jO(e,t,i,r,n))}getAsset(e){if(!e)return null;for(const t of this._bitmaps)if(t&&e.x>=t.normalMinX&&e.x<=t.normalMaxX&&e.y>=t.normalMinY&&e.y<=t.normalMaxY)return t.asset;return null}};jI.MIN_NORMAL_COORDINATE_VALUE=-1,jI.MAX_NORMAL_COORDINATE_VALUE=1;let Fu=jI;class lee{constructor(){this._sizes=[],this._maskVisualizations=new Map,this._assetNames=new Map,this._lastMaskVisualization=null,this._lastSize=-1}dispose(){if(this._maskVisualizations){for(const e of this._maskVisualizations.values())e&&e.dispose();this._maskVisualizations=null}this._lastMaskVisualization=null,this._sizes=null}createMaskVisualization(e){if(this._maskVisualizations.get(e))return null;const i=new Fu;return this._maskVisualizations.set(e,i),this._sizes.push(e),this._sizes.sort(),i}getSizeIndex(e){let t=0,i=1;for(;i<this._sizes.length;){if(this._sizes[i]>e){this._sizes[i]-e<e-this._sizes[i-1]&&(t=i);break}t=i,i++}return t}getMaskVisualization(e){if(e===this._lastSize)return this._lastMaskVisualization;const t=this.getSizeIndex(e);return t<this._sizes.length?this._lastMaskVisualization=this._maskVisualizations.get(this._sizes[t]):this._lastMaskVisualization=null,this._lastSize=e,this._lastMaskVisualization}getGraphicAsset(e,t){const i=this.getMaskVisualization(e);return i?i.getAsset(t):null}getAssetName(e){return this._assetNames&&this._assetNames.get(e)||null}setAssetName(e,t){this._assetNames&&this._assetNames.set(e,t)}}class cee{constructor(){this._assetCollection=null,this._masks=new Map,this._data=null}get data(){return this._data}dispose(){if(this._assetCollection=null,this._data=null,this._masks&&this._masks.size){for(const e of this._masks.values())e&&e.dispose();this._masks.clear()}}initialize(e){this._data=e}initializeAssetCollection(e){this.data&&(this._assetCollection=e,this.parseMasks(this.data,e))}parseMasks(e,t){if(!(!e||!t)&&e.masks&&e.masks.length){let i=0;for(;i<e.masks.length;){const r=e.masks[i];if(r){const n=r.id;if(this._masks.get(n))continue;const l=new lee;if(r.visualizations&&r.visualizations.length){let c=0;for(;c<r.visualizations.length;){const u=r.visualizations[c];if(u){const d=u.size,_=l.createMaskVisualization(d);if(_){const m=this.parseMaskBitmaps(u.bitmaps,_,t);l.setAssetName(d,m)}}c++}}this._masks.set(n,l)}i++}}}parseMaskBitmaps(e,t,i){if(!e||!e.length)return null;let r=null;for(const n of e){if(!n)continue;const o=n.assetName,l=i.getAsset(o);if(!l)continue;let c=Fu.MIN_NORMAL_COORDINATE_VALUE,u=Fu.MAX_NORMAL_COORDINATE_VALUE,d=Fu.MIN_NORMAL_COORDINATE_VALUE,_=Fu.MAX_NORMAL_COORDINATE_VALUE;n.normalMinX!==void 0&&(c=n.normalMinX),n.normalMaxX!==void 0&&(u=n.normalMaxX),n.normalMinY!==void 0&&(d=n.normalMinY),n.normalMaxY!==void 0&&(_=n.normalMaxY),l.flipH||(r=o),t.addBitmap(l,c,u,d,_)}return r}updateMask(e,t,i,r,n,o){const l=this._masks.get(t);if(!l)return!0;const c=l.getGraphicAsset(i,r);if(!c)return!0;const u=c.texture;if(!u)return!0;const d=new ot(n+c.offsetX,o+c.offsetY),_=new qr;let m=1,f=1,E=0,I=0,p=d.x+E,S=d.y+I;return c.flipH&&(m=-1,E=u.width,p=d.x+E-u.width),c.flipV&&(f=-1,I=u.height,S=d.y+I-u.height),_.scale(m,f),_.translate(p,S),di.instance.renderer.render(new si(u),{renderTexture:e,clear:!1,transform:_}),!0}getMask(e){return!this._masks||!this._masks.size?null:this._masks.get(e)||null}}class l_{constructor(e=null,t=0,i=!1){this._assetNames=[],this._maskAssetNames=[],this._maskAssetLocations=[],this._maskAssetFlipHs=[],this._maskAssetFlipVs=[],e!=null&&(this._maskAssetNames=e._maskAssetNames,this._maskAssetLocations=e._maskAssetLocations,this._maskAssetFlipHs=e._maskAssetFlipHs,this._maskAssetFlipVs=e._maskAssetFlipVs),this._color=t,this._alignBottom=i}addMask(e,t,i,r){this._maskAssetNames.push(e),this._maskAssetLocations.push(t),this._maskAssetFlipHs.push(i),this._maskAssetFlipVs.push(r)}addAssetColumn(e){this._assetNames.push(e)}set z(e){this._z=e}get z(){return this._z}set cornerPoints(e){this._points=e}get cornerPoints(){return this._points}get color(){return this._color}get maskAssetNames(){return this._maskAssetNames}get maskAssetLocations(){return this._maskAssetLocations}get maskAssetFlipHs(){return this._maskAssetFlipHs}get maskAssetFlipVs(){return this._maskAssetFlipVs}isBottomAligned(){return this._alignBottom}get assetNameColumns(){return this._assetNames}}class uee{constructor(e,t,i,r,n){this._x=e,this._y=t,this._speedX=i,this._speedY=r,this._asset=n,isNaN(this._x)&&(this._x=0),isNaN(this._y)&&(this._y=0),isNaN(this._speedX)&&(this._speedX=0),isNaN(this._speedY)&&(this._speedY=0)}get bitmapData(){return this._asset}dispose(){this._asset=null}getPosition(e,t,i,r,n){let o=this._x,l=this._y;i>0&&(o=o+this._speedX/i*n/1e3),r>0&&(l=l+this._speedY/r*n/1e3);const c=Math.trunc(o%1*e),u=Math.trunc(l%1*t);return new ot(c,u)}}const nc=class nc{constructor(e,t,i,r=0){this._material=e,this._offset=r,this._align=i,this._color=t,this._isDisposed=!1}get offset(){return this._offset}get align(){return this._align}get disposed(){return this._isDisposed}dispose(){this._isDisposed=!0,this._material=null,this.clearCache()}clearCache(){}render(e,t,i,r,n,o,l,c,u){const d=this._color>>16,_=this._color>>8&255,m=this._color&255,f=d<255||_<255||m<255;if(this._material){const E=this._material.render(e,t,f?null:i,r,n,o,l,c,u+this.offset,this.align===nc.ALIGN_TOP);if(E&&f){const I=new si(E);f&&(I.tint=this._color),t.writeToRenderTexture(I,i,!1)}}else{const E=t.createAndFillRenderTexture(r,n,e,this._color);t.writeToRenderTexture(new si(E),i,!1)}return i}getMaterial(){return this._material}getColor(){return this._color}};nc.DEFAULT_OFFSET=0,nc.ALIGN_TOP=1,nc.ALIGN_BOTTOM=2,nc.ALIGN_DEFAULT=nc.ALIGN_TOP;let _a=nc;class hee{constructor(e,t,i){this._layers=[],this._geometry=i,this._cachedBitmapNormal=new Y,this._isCached=!1,this._hasAnimationLayers=!1,t<0&&(t=0);let r=0;for(;r<t;)this._layers.push(null),r++}get geometry(){return this._geometry}get hasAnimationLayers(){return this._hasAnimationLayers}dispose(){if(this._layers&&this._layers.length){for(const e of this._layers)e&&e.dispose();this._layers=null}this._geometry=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&this._cachedBitmapNormal.assign(new Y),this._layers&&this._layers.length)for(const e of this._layers){if(!e)continue;e.clearCache()}this._isCached=!1}}setLayer(e,t,i,r,n=0){if(e<0||e>this._layers.length)return!1;let o=this._layers[e];return o&&o.dispose(),o=new _a(t,i,r,n),this._layers[e]=o,!0}setAnimationLayer(e,t,i){if(e<0||e>this._layers.length)return!1;let r=this._layers[e];return r&&r.dispose(),r=new Yb(t,i),this._layers[e]=r,this._hasAnimationLayers=!0,!0}getLayers(){return this._layers}render(e,t,i,r,n,o,l,c=0,u=0,d=0,_=0,m=0,f=0,E=0){r<1&&(r=1),n<1&&(n=1),(!i||i.width!==r||i.height!==n)&&(i=null),this._isCached=!0;const I=t.createAndFillRenderTexture(r,n,e);if(this._cachedBitmapNormal.assign(o),this._layers&&this._layers.length)for(const p of this._layers)p&&(p instanceof _a?p.render(`${e}:${this._layers.indexOf(p)}`,t,I,r,n,o,l,c,u):p instanceof Yb&&p.render(t,I,r,n,o,c,u,d,_,m,f,E));return I}}class yN{constructor(){this._planeVisualizations=new Map,this._sizes=[],this._lastPlaneVisualization=null,this._lastSize=-1}isStatic(e){return!0}dispose(){for(const e of this._planeVisualizations.values())e&&e.dispose();this._planeVisualizations=null,this._lastPlaneVisualization=null,this._sizes=null,this._lastSize=-1}clearCache(){for(const e of this._planeVisualizations.values())e&&e.clearCache()}createPlaneVisualization(e,t,i){if(this._planeVisualizations.get(e.toString()))return null;const n=new hee(e,t,i);return this._planeVisualizations.set(e.toString(),n),this._sizes.push(e),this._sizes.sort(),n}getSizeIndex(e){let t=0,i=1;for(;i<this._sizes.length;){if(this._sizes[i]>e){this._sizes[i]-e<e-this._sizes[i-1]&&(t=i);break}t=i,i++}return t}getPlaneVisualization(e){if(e===this._lastSize)return this._lastPlaneVisualization;const t=this.getSizeIndex(e);return t<this._sizes.length?this._lastPlaneVisualization=this._planeVisualizations.get(this._sizes[t].toString()):this._lastPlaneVisualization=null,this._lastSize=e,this._lastPlaneVisualization}getLayers(){return this.getPlaneVisualization(this._lastSize).getLayers()}}const mg=class mg extends yN{render(e,t,i,r,n,o,l,c,u,d){const _=this.getPlaneVisualization(o);if(!_||!_.geometry)return null;const m=_.geometry.getScreenPoint(new Y(0,0,0)),f=_.geometry.getScreenPoint(new Y(0,n/_.geometry.scale,0)),E=_.geometry.getScreenPoint(new Y(r/_.geometry.scale,0,0));let I=0,p=0;if(m&&f&&E){r=Math.round(Math.abs(m.x-E.x)),n=Math.round(Math.abs(m.x-f.x));const S=m.x-_.geometry.getScreenPoint(new Y(1,0,0)).x;I=u*Math.trunc(Math.abs(S)),p=d*Math.trunc(Math.abs(S))}return _.render(e,t,i,r,n,l,c,I,p)}};mg.DEFAULT_COLOR=16777215,mg.HORIZONTAL_ANGLE_DEFAULT=45,mg.VERTICAL_ANGLE_DEFAULT=30;let Od=mg;class Pp{constructor(e,t){this._texture=e,this._timeStamp=t}dispose(){this._texture=null}get texture(){return this._texture}get timeStamp(){return this._timeStamp}}const Ni=class Ni{constructor(){this._seed=1,this._modulus=16777216,this._multiplier=69069,this._increment=5}static setSeed(e=1){Ni._randomizer||(Ni._randomizer=new Ni),Ni._randomizer.seed=e}static setModulus(e=16777216){Ni._randomizer||(Ni._randomizer=new Ni),Ni._randomizer.modulus=e}static getValues(e,t,i){return Ni._randomizer||(Ni._randomizer=new Ni),Ni._randomizer.getRandomValues(e,t,i)}static getArray(e,t){return Ni._randomizer||(Ni._randomizer=new Ni),Ni._randomizer.getRandomArray(e,t)}set seed(e){this._seed=e}set modulus(e){e<1&&(e=1),this._modulus=e}dispose(){}getRandomValues(e,t,i){const r=[];let n=0;for(;n<e;)r.push(this.iterateScaled(t,i-t)),n++;return r}getRandomArray(e,t){if(e>t||t>1e3)return null;const i=[];let r=0;for(;r<=t;)i.push(r),r++;const n=[];let o=0;for(;o<e;){const l=this.iterateScaled(0,i.length-1);n.push(i[l]),i.splice(l,1),o++}return n}iterate(){let e=bG(Math.trunc(this._multiplier*this._seed)+this._increment);return e<0&&(e=-e),e=e%this._modulus,this._seed=e,e}iterateScaled(e,t){let i=this.iterate();return t<1?e:(i=Math.trunc(e+i/this._modulus*t),i)}};Ni.DEFAULT_SEED=1,Ni.DEFAULT_MODULUS=16777216,Ni._randomizer=null;let vc=Ni;const Hr=class Hr{constructor(e,t,i=1){if(this._cells=[],this._repeatMode=i,this._width=e<1?1:e,this._cachedBitmapData=null,this._cachedBitmapNormal=null,this._cachedBitmapDataOffsetX=0,this._cachedBitmapDataOffsetY=0,this._isCached=!1,this._isStatic=!0,t&&t.length){let r=0;for(;r<t.length;){const n=t[r];n&&(this._cells.push(n),n.isStatic||(this._isStatic=!1)),r++}}}get isStatic(){return this._isStatic}isRepeated(){return this._repeatMode!==Hr.REPEAT_MODE_NONE}get width(){return this._width}dispose(){if(this._cells&&this._cells.length){for(const e of this._cells)e&&e.dispose();this._cells=null}this._cachedBitmapData=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._cells&&this._cells.length)for(const e of this._cells)e&&e.clearCache();this._isCached=!1}}render(e,t,i,r,n,o){if(this._repeatMode===Hr.REPEAT_MODE_NONE&&(i=this.getCellsHeight(this._cells,r)),this._cachedBitmapNormal||(this._cachedBitmapNormal=new Y),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.height===i&&Y.isEqual(this._cachedBitmapNormal,r)&&this._cachedBitmapDataOffsetX===n&&this._cachedBitmapDataOffsetY===o)return this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapData||(this._cachedBitmapData=t.createRenderTexture(this._width,i,`${e}:column`)),this._cachedBitmapNormal.assign(r),this._cachedBitmapDataOffsetX=n,this._cachedBitmapDataOffsetY=o,!this._cells.length)return this._cachedBitmapData;switch(this._repeatMode){case Hr.REPEAT_MODE_NONE:this.renderRepeatNone(r);break;case Hr.REPEAT_MODE_BORDERS:this.renderRepeatBorders(r);break;case Hr.REPEAT_MODE_CENTER:this.renderRepeatCenter(r);break;case Hr.REPEAT_MODE_FIRST:this.renderRepeatFirst(r);break;case Hr.REPEAT_MODE_LAST:this.renderRepeatLast(r);break;default:this.renderRepeatAll(r,n,o);break}return this._cachedBitmapData}getCellsHeight(e,t){if(!e||!e.length)return 0;let i=0,r=0;for(;r<e.length;){const n=e[r];n&&(i+=n.getHeight(t)),r++}return i}renderCells(e,t,i,r,n=0,o=0){if(!e||!e.length||!this._cachedBitmapData)return t;let l=0;for(;l<e.length;){let c=null;if(i?c=e[l]:c=e[e.length-1-l],c){const u=c.render(r,n,o);if(u&&(i||(t-=u.height),u.y=t,Vt.writeToRenderTexture(u,this._cachedBitmapData,!1),i&&(t=t+u.height),i&&t>=this._cachedBitmapData.height||!i&&t<=0))return t}l++}return t}renderRepeatNone(e){!this._cells.length||!this._cachedBitmapData||this.renderCells(this._cells,0,!0,e)}renderRepeatAll(e,t,i){if(!this._cells.length||!this._cachedBitmapData)return;let r=0;for(;r<this._cachedBitmapData.height;)if(r=this.renderCells(this._cells,r,!0,e,t,i),!r)return}renderRepeatBorders(e){if(!this._cells.length||!this._cachedBitmapData)return;const t=[];let i=0,r=1;for(;r<this._cells.length-1;){const c=this._cells[r];if(c){const u=c.getHeight(e);u>0&&(i=i+u,t.push(c))}r++}if(this._cells.length==1){const c=this._cells[0];if(c){const u=c.getHeight(e);u>0&&(i=i+u,t.push(c))}}let n=this._cachedBitmapData.height-i>>1,o=this.renderCells(t,n,!0,e),l=this._cells[0];if(l){const c=[l];for(;n>=0;)n=this.renderCells(c,n,!1,e)}if(l=this._cells[this._cells.length-1],l){const c=[l];for(;o<this._cachedBitmapData.height;)o=this.renderCells(c,o,!0,e)}}renderRepeatCenter(e){if(!this._cells.length||!this._cachedBitmapData)return;const t=[],i=[];let r=0,n=0,o=0;for(;o<this._cells.length>>1;){const u=this._cells[o];if(u){const d=u.getHeight(e);d>0&&(r=r+d,t.push(u))}o++}for(o=(this._cells.length>>1)+1;o<this._cells.length;){const u=this._cells[o];if(u){const d=u.getHeight(e);d>0&&(n=n+d,i.push(u))}o++}let l=0,c=this._cachedBitmapData.height;if(r+n>this._cachedBitmapData.height&&(l=r+n-this._cachedBitmapData.height,c=c+(l-(l>>1))),l==0){const u=this._cells[this._cells.length>>1];if(u){const d=u.getHeight(e);if(d>0){const _=this._cachedBitmapData.height-(r+n),m=Math.ceil(_/d)*d;let f=r-(m-_>>1);const E=f+m,I=[u];for(;f<E;)f=this.renderCells(I,f,!0,e)}}}this.renderCells(t,0,!0,e),this.renderCells(i,c,!1,e)}renderRepeatFirst(e){if(!this._cells.length||!this._cachedBitmapData)return;let t=this.renderCells(this._cells,this._cachedBitmapData.height,!1,e);const i=this._cells[0];if(!i)return;const r=[i];for(;t>=0;)t=this.renderCells(r,t,!1,e)}renderRepeatLast(e){if(!this._cells.length||!this._cachedBitmapData)return;let t=this.renderCells(this._cells,0,!0,e);const i=this._cells[this._cells.length-1];if(!i)return;const r=[i];for(;t<this._cachedBitmapData.height;)t=this.renderCells(r,t,!0,e)}getCells(){return this._cells}};Hr.REPEAT_MODE_NONE=0,Hr.REPEAT_MODE_ALL=1,Hr.REPEAT_MODE_BORDERS=2,Hr.REPEAT_MODE_CENTER=3,Hr.REPEAT_MODE_FIRST=4,Hr.REPEAT_MODE_LAST=5;let xo=Hr;const As=class As{constructor(e,t=1,i=1,r=-1,n=1,o=-1,l=1){this._repeatMode=1,this._align=1,this._cachedBitmapNormal=null,this._cachedBitmapHeight=0,this._isCached=!1,this._isStatic=!0,this._normalMinX=-1,this._normalMaxX=1,this._normalMinY=-1,this._normalMaxY=1,this._columns=[],e<1&&(e=1);let c=0;for(;c<e;)this._columns.push(null),c++;this._repeatMode=t,this._align=i,this._normalMinX=r,this._normalMaxX=n,this._normalMinY=o,this._normalMaxY=l,this._repeatMode===As.REPEAT_MODE_RANDOM&&(this._isStatic=!1)}static nextRandomColumnIndex(e){return vc.getValues(1,0,e*17631)[0]%e}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}isBottomAligned(){return this._align===As.ALIGN_BOTTOM}get isStatic(){return this._isStatic}dispose(){this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._columns&&this._columns.length)for(const e of this._columns)e&&e.clearCache();this._isCached=!1}}createColumn(e,t,i,r=1){if(e<0||e>=this._columns.length)return!1;const n=new xo(t,i,r),o=this._columns[e];return o&&o.dispose(),this._columns[e]=n,n&&!n.isStatic&&(this._isStatic=!1),!0}render(e,t,i,r,n,o,l,c,u,d){if(r<1&&(r=1),n<1&&(n=1),this._cachedBitmapNormal||(this._cachedBitmapNormal=new Y),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.baseTexture&&this._cachedBitmapData.width===r&&this._cachedBitmapData.height===n&&Y.isEqual(this._cachedBitmapNormal,o))return i?(this.copyCachedBitmapOnCanvas(i,this._cachedBitmapHeight,u,d),i):this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapNormal.assign(o),!l)return this._cachedBitmapHeight=n,this._cachedBitmapData?t.clearAndFillRenderTexture(this._cachedBitmapData):this._cachedBitmapData=t.createAndFillRenderTexture(r,n,`${e}:matrix`),this._cachedBitmapData;this._cachedBitmapData||(this._cachedBitmapHeight=n,this._cachedBitmapData=t.createRenderTexture(r,n,`${e}:matrix`),t.clearRenderTexture(this._cachedBitmapData));const _=[];let m=0;for(;m<this._columns.length;){const E=this._columns[m];if(E){const I=E.render(e,t,n,o,c,u);I&&_.push(I)}m++}if(!_.length)return i||this._cachedBitmapData;let f=0;switch(this._repeatMode){case As.REPEAT_MODE_BORDERS:ze.log("REPEAT_MODE_BORDERS");break;case As.REPEAT_MODE_CENTER:ze.log("REPEAT_MODE_CENTER");break;case As.REPEAT_MODE_FIRST:ze.log("REPEAT_MODE_FIRST");break;case As.REPEAT_MODE_LAST:ze.log("REPEAT_MODE_LAST");break;case As.REPEAT_MODE_RANDOM:f=this.renderRepeatRandom(this._cachedBitmapData,_);break;default:f=this.renderRepeatAll(this._cachedBitmapData,_);break}return this._cachedBitmapHeight=f,i?(this.copyCachedBitmapOnCanvas(i,f,u,d),i):this._cachedBitmapData}copyCachedBitmapOnCanvas(e,t,i,r){if(!e||!this._cachedBitmapData||e===this._cachedBitmapData)return;r||(i=e.height-t-i);let n=null;this._align===As.ALIGN_TOP?n=new En(0,0,this._cachedBitmapData.width,this._cachedBitmapHeight):n=new En(0,this._cachedBitmapData.height-this._cachedBitmapHeight,this._cachedBitmapData.width,this._cachedBitmapHeight);const o=new Ka(this._cachedBitmapData.baseTexture,n),l=new si(o);l.position.set(0,i),Vt.writeToRenderTexture(l,e,!1)}getColumnsWidth(e){if(!e||!e.length)return 0;let t=0;for(const i of e)i&&(t+=i.width);return t}renderColumns(e,t,i,r){if(!e||!t||!t.length)return new ot(i,0);let n=0,o=0;for(;o<t.length;){const l=r?t[o]:t[t.length-1-o];if(l){r||(i=i-l.width);let c=0;this._align==As.ALIGN_BOTTOM&&(c=e.height-l.height);const u=new si(l);if(u.position.set(i,c),Vt.writeToRenderTexture(u,e,!1),l.height>n&&(n=l.height),r&&(i=i+l.width),r&&i>=e.width||!r&&i<=0)return new ot(i,n)}o++}return new ot(i,n)}renderRepeatAll(e,t){if(!e||!t||!t.length)return 0;this.getColumnsWidth(t);let i=0,r=0;for(;i<e.width;){const n=this.renderColumns(e,t,i,!0);if(i=n.x,n.y>r&&(r=n.y),!n.x)return r}return r}renderRepeatRandom(e,t){if(!e||!t||!t.length)return 0;let i=0,r=0;for(;r<e.width;){const n=t[As.nextRandomColumnIndex(t.length)];if(n!=null){const o=this.renderColumns(e,[n],r,!0);r=o.x,o.y>i&&(i=o.y)}else return i}return i}getColumns(e){if(this._repeatMode===As.REPEAT_MODE_RANDOM){const t=[];let i=0;for(;i<e;){const r=this._columns[As.nextRandomColumnIndex(this._columns.length)];if(r)if(t.push(r),r.width>1)i+=r.width;else break;else break}return t}return this._columns}};As.REPEAT_MODE_ALL=1,As.REPEAT_MODE_BORDERS=2,As.REPEAT_MODE_CENTER=3,As.REPEAT_MODE_FIRST=4,As.REPEAT_MODE_LAST=5,As.REPEAT_MODE_RANDOM=6,As.REPEAT_MODE_DEFAULT=As.REPEAT_MODE_ALL,As.MIN_NORMAL_COORDINATE_VALUE=-1,As.MAX_NORMAL_COORDINATE_VALUE=1,As.ALIGN_TOP=1,As.ALIGN_BOTTOM=2,As.ALIGN_DEFAULT=As.ALIGN_TOP;let qi=As;const LI=class LI{constructor(){this._planeMaterialItems=[],this._isCached=!1}dispose(){if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const e of this._planeMaterialItems)e&&e.dispose();this._planeMaterialItems=null}this._isCached=!1}clearCache(){if(this._isCached){if(this._planeMaterialItems&&this._planeMaterialItems.length)for(const e of this._planeMaterialItems)e&&e.clearCache();this._isCached=!1}}addMaterialCellMatrix(e,t,i,r=-1,n=1,o=-1,l=1){const c=new qi(e,t,i,r,n,o,l);return this._planeMaterialItems.push(c),c}getMaterialCellMatrix(e){if(!e)return null;if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const t of this._planeMaterialItems)if(t&&e.x>=t.normalMinX&&e.x<=t.normalMaxX&&e.y>=t.normalMinY&&e.y<=t.normalMaxY)return t}return null}render(e,t,i,r,n,o,l,c,u,d){r<1&&(r=1),n<1&&(n=1);const _=this.getMaterialCellMatrix(o);return _?(this._isCached=!0,_.render(e,t,i,r,n,o,l,c,u,d)):null}};LI.MIN_NORMAL_COORDINATE_VALUE=-1,LI.MAX_NORMAL_COORDINATE_VALUE=1;let LO=LI;class dee{constructor(e,t=null,i=null,r=0){if(this._extraItemCount=0,this._texture=e,this._extraItemOffsets=[],this._extraItemAssets=[],this._extraItemCount=0,t&&t.length&&r>0){let n=0;for(;n<t.length;){const o=t[n];o&&this._extraItemAssets.push(o),n++}if(this._extraItemAssets.length){if(i){let o=0;for(;o<i.length;){const l=i[o];l&&this._extraItemOffsets.push(new ot(l.x,l.y)),o++}}this._extraItemCount=r}}}get isStatic(){return this._extraItemCount===0}dispose(){this._texture&&(this._texture.dispose(),this._texture=null),this._extraItemAssets=null,this._extraItemOffsets=null,this._extraItemCount=0}clearCache(){}getHeight(e){if(this._texture){const t=this._texture.getBitmap(e);if(t)return t.height}return 0}render(e,t,i){if(!this._texture)return null;const r=this._texture.getBitmap(e);if(!r)return null;const n=new aV(r,r.width,r.height);if(t!==0||i!==0){for(;t<0;)t+=r.width;for(;i<0;)i+=r.height;n.tilePosition.set(t%r.width,i%r.height),n.uvRespectAnchor=!0,t&&(n.anchor.x=1,n.scale.x=-1),i&&(n.anchor.y=1,n.scale.y=-1)}if(!this.isStatic){const o=Math.min(this._extraItemCount,this._extraItemOffsets.length),l=Math.max(this._extraItemCount,this._extraItemOffsets.length),c=vc.getArray(this._extraItemCount,l);let u=0;for(;u<o;){const d=this._extraItemOffsets[c[u]],_=this._extraItemAssets[u%this._extraItemAssets.length];if(d&&_){const m=_.texture;if(m){let f=_.offsetX,E=_.offsetY,I=1,p=1,S=0,R=0;_.flipH&&(I=-1,S=m.width,f=-(_.width+_.x)),_.flipV&&(p=-1,R=m.height,E=-(_.height+_.y));const O=new ot(d.x+f,d.y+E),C=new qr;let A=O.x+S;A=A>>1<<1,C.scale(I,p),C.translate(A,O.y+R);const b=new si(m);b.transform.setFromMatrix(C),n.addChild(b)}}u++}}return n}getAssetName(e){return this._texture==null?null:this._texture.getAssetName(e)}}const PI=class PI{constructor(e,t=-1,i=1,r=-1,n=1,o=null){this._bitmap=e,this._normalMinX=t,this._normalMaxX=i,this._normalMinY=r,this._normalMaxY=n,this._assetName=o}get bitmap(){return this._bitmap}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}get assetName(){return this._assetName}dispose(){this._bitmap=null}};PI.MIN_NORMAL_COORDINATE_VALUE=-1,PI.MAX_NORMAL_COORDINATE_VALUE=1;let PO=PI;const UI=class UI{constructor(){this._bitmaps=[]}dispose(){if(this._bitmaps){for(const e of this._bitmaps)e&&e.dispose();this._bitmaps=null}}addBitmap(e,t=-1,i=1,r=-1,n=1,o=null){this._bitmaps.push(new PO(e,t,i,r,n,o))}getBitmap(e){const t=this.getPlaneTextureBitmap(e);return t?t.bitmap:null}getPlaneTextureBitmap(e){if(!e)return null;for(const t of this._bitmaps)if(t&&e.x>=t.normalMinX&&e.x<=t.normalMaxX&&e.y>=t.normalMinY&&e.y<=t.normalMaxY)return t;return null}getAssetName(e){const t=this.getPlaneTextureBitmap(e);return t?t.assetName:null}};UI.MIN_NORMAL_COORDINATE_VALUE=-1,UI.MAX_NORMAL_COORDINATE_VALUE=1;let Qc=UI;const wI=class wI{constructor(){this._assetCollection=null,this._textures=new Map,this._materials=new Map,this._planes=new Map,this._geometries=new Map,this._data=null}get data(){return this._data}get assetCollection(){return this._assetCollection}initializeDimensions(e,t){return!0}dispose(){if(this._planes){for(const e of this._planes.values())e&&e.dispose();this._planes=null}if(this._materials&&(this.resetMaterials(),this._materials=null),this._textures&&(this.resetTextures(),this._textures=null),this._geometries){for(const e of this._geometries.values())e&&e.dispose();this._geometries=null}this._data=null,this._assetCollection=null}clearCache(){for(const e of this._planes.values())e&&e.clearCache();for(const e of this._materials.values())e&&e.clearCache()}initialize(e){this._data=e}reinitialize(){this.resetTextures(),this.resetMaterials(),this.initializeAll()}resetMaterials(){for(const e of this._materials.values())e&&e.dispose();this._materials.clear()}resetTextures(){for(const e of this._textures.values())e&&e.dispose();this._textures.clear()}getTexture(e){return this._textures.get(e)}getMaterial(e){return this._materials.get(e)}getPlane(e){return this._planes.get(e)}addPlane(e,t){return t?this._planes.get(e)?!1:(this._planes.set(e,t),!0):!1}initializeAssetCollection(e){this._data&&(this._assetCollection=e,this.initializeAll())}initializeAll(){this._data&&(this.initializeTexturesAndMaterials(),this.initializePlanes())}initializeTexturesAndMaterials(){this._data.textures&&this._data.textures.length&&this.parseTextures(this._data.textures,this.assetCollection),this._data.materials&&this._data.materials.length&&this.parsePlaneMaterials(this._data.materials)}initializePlanes(){}parseTextures(e,t){if(!(!e||!t)&&e.length)for(const i of e){if(!i)continue;const r=i.id;if(!this._textures.get(r)){const n=new Qc;if(i.bitmaps&&i.bitmaps.length)for(const o of i.bitmaps){if(!o)continue;const l=o.assetName;let c=Qc.MIN_NORMAL_COORDINATE_VALUE,u=Qc.MAX_NORMAL_COORDINATE_VALUE,d=Qc.MIN_NORMAL_COORDINATE_VALUE,_=Qc.MAX_NORMAL_COORDINATE_VALUE;o.normalMinX!==void 0&&(c=o.normalMinX),o.normalMaxX!==void 0&&(u=o.normalMaxX),o.normalMinY!==void 0&&(d=o.normalMinY),o.normalMaxY!==void 0&&(_=o.normalMaxY);const m=t.getAsset(l);if(m){const f=m.texture;if(f){let E=f;m.flipH?E=v2.getFlipHBitmapData(f):E=E.clone(),n.addBitmap(E,c,u,d,_,l)}}}this._textures.set(r,n)}}}parsePlaneMaterials(e){if(!(!e||!e.length))for(const t of e){if(!t)continue;const i=t.id,r=new LO;if(t.matrices&&t.matrices.length)for(const n of t.matrices){if(!n)continue;let o=qi.REPEAT_MODE_DEFAULT,l=qi.ALIGN_DEFAULT,c=qi.MIN_NORMAL_COORDINATE_VALUE,u=qi.MAX_NORMAL_COORDINATE_VALUE,d=qi.MIN_NORMAL_COORDINATE_VALUE,_=qi.MAX_NORMAL_COORDINATE_VALUE;switch(n.normalMinX!==void 0&&(c=n.normalMinX),n.normalMaxX!==void 0&&(u=n.normalMaxX),n.normalMinY!==void 0&&(d=n.normalMinY),n.normalMaxY!==void 0&&(_=n.normalMaxY),n.repeatMode){case"borders":o=qi.REPEAT_MODE_BORDERS;break;case"center":o=qi.REPEAT_MODE_CENTER;break;case"first":o=qi.REPEAT_MODE_FIRST;break;case"last":o=qi.REPEAT_MODE_LAST;break;case"random":o=qi.REPEAT_MODE_RANDOM;break;default:o=qi.REPEAT_MODE_DEFAULT;break}switch(n.align){case"top":l=qi.ALIGN_TOP;break;case"bottom":l=qi.ALIGN_BOTTOM;break;default:l=qi.ALIGN_DEFAULT;break}if(n.columns&&n.columns.length){const m=r.addMaterialCellMatrix(n.columns.length,o,l,c,u,d,_);let f=0;for(;f<n.columns.length;){const E=n.columns[f];E&&this.parsePlaneMaterialCellColumn(E,m,f),f++}}}this._materials.set(i,r)}}parsePlaneMaterialCellColumn(e,t,i){if(!e||!t)return;let r=xo.REPEAT_MODE_ALL;const n=e.width,o=this.parsePlaneMaterialCells(e);switch(e.repeatMode){case"borders":r=xo.REPEAT_MODE_BORDERS;break;case"center":r=xo.REPEAT_MODE_CENTER;break;case"first":r=xo.REPEAT_MODE_FIRST;break;case"last":r=xo.REPEAT_MODE_LAST;break;case"none":r=xo.REPEAT_MODE_NONE;break;default:r=xo.REPEAT_MODE_ALL;break}t.createColumn(i,n,o,r)}parsePlaneMaterialCells(e){if(!e||!e.cells||!e.cells.length)return null;const t=[];let i=0;for(;i<e.cells.length;){const r=e.cells[i];if(r){const n=r.textureId;let o=null,l=null,c=null,u=0;if(r.extraData){const m=r.extraData.extraItemTypes,f=r.extraData.offsets;m&&f&&m.length&&f.length&&(o=this.parseExtraItemTypes(m),l=this.parseExtraItemOffsets(f),u=l.length,r.extraData.limitMax!==void 0&&(u=r.extraData.limitMax))}if(o&&o.length){c=[];for(const m of o){if(!m)continue;const f=this._assetCollection.getAsset(m);f&&c.push(f)}}const d=this.getTexture(n),_=new dee(d,c,l,u);t.push(_)}i++}return!t||!t.length?null:t}parseExtraItemTypes(e){const t=[];if(e&&e.length){let i=0;for(;i<e.length;){const r=e[i];r&&t.push(r),i++}}return t}parseExtraItemOffsets(e){const t=[];if(e&&e.length){let i=0;for(;i<e.length;){const[r,n]=e[i];t.push(new ot(r,n)),i++}}return t}getGeometry(e,t,i){t=Math.abs(t),t>90&&(t=90),i=Math.abs(i),i>90&&(i=90);const r=`${e}_${Math.round(t)}_${Math.round(i)}`;let n=this._geometries.get(r);return n||(n=new Cc(e,new Y(t,i),new Y(-10,0,0)),this._geometries.set(r,n),n)}parseVisualizations(e,t){if(!(!e||!t)&&t&&t.length)for(const i of t){if(!i)continue;const r=i.size;let n=Od.HORIZONTAL_ANGLE_DEFAULT,o=Od.VERTICAL_ANGLE_DEFAULT;i.horizontalAngle!==void 0&&(n=i.horizontalAngle),i.verticalAngle!==void 0&&(o=i.verticalAngle);const l=i.allLayers,c=e.createPlaneVisualization(r,l&&l.length||0,this.getGeometry(r,n,o));if(c&&l&&l.length){let u=0;for(;u<l.length;){const d=l[u];if(d){let _=null,m=_a.ALIGN_DEFAULT,f=Od.DEFAULT_COLOR,E=_a.DEFAULT_OFFSET;d.materialId&&(_=this.getMaterial(d.materialId)),d.color&&(f=d.color),d.offset&&(E=d.offset),d.align&&(d.align==="bottom"?m=_a.ALIGN_BOTTOM:d.align=="top"&&(m=_a.ALIGN_TOP)),c.setLayer(u,_,f,m,E)}u++}}}}render(e,t,i,r,n,o,l,c,u,d=0,_=0,m=0,f=0,E=0){return null}getTextureIdentifier(e,t){return e.toString()}getLayers(e){let t=this.getPlane(e);return t||(t=this.getPlane(wI.DEFAULT)),t.getLayers()}};wI.DEFAULT="default";let th=wI;class _ee extends th{initializePlanes(){if(!this.data)return;const e=this.data.planes;e&&e.length&&this.parseFloors(e)}parseFloors(e){if(e)for(const t in e){const i=e[t];if(!i)continue;const r=i.id,n=i.visualizations,o=new Od;this.parseVisualizations(o,n),this.addPlane(r,o)||o.dispose()}}render(e,t,i,r,n,o,l,c,u,d=0,_=0,m=0,f=0,E=0){let I=this.getPlane(r);if(I||(I=this.getPlane(th.DEFAULT)),!I)return null;i&&t.clearAndFillRenderTexture(i);let p=I.render(e,t,i,n,o,l,c,u,d,_);return p&&p!==i&&(p=new Ka(p.baseTexture),!p)?null:new Pp(p,-1)}}const fg=class fg extends yN{render(e,t,i,r,n,o,l,c){const u=this.getPlaneVisualization(o);if(!u||!u.geometry)return null;const d=u.geometry.getScreenPoint(new Y(0,0,0)),_=u.geometry.getScreenPoint(new Y(0,0,n/u.geometry.scale)),m=u.geometry.getScreenPoint(new Y(0,r/u.geometry.scale,0));return d&&_&&m&&(r=Math.round(Math.abs(d.x-m.x)),n=Math.round(Math.abs(d.y-_.y))),u.render(e,t,i,r,n,l,c)}};fg.DEFAULT_COLOR=16777215,fg.HORIZONTAL_ANGLE_DEFAULT=45,fg.VERTICAL_ANGLE_DEFAULT=30;let UO=fg;class gee extends th{initializePlanes(){if(!this.data)return;const e=this.data.planes;e&&e.length&&this.parseWalls(e)}parseWalls(e){if(e)for(const t in e){const i=e[t];if(!i)continue;const r=i.id,n=i.visualizations,o=new UO;this.parseVisualizations(o,n),this.addPlane(r,o)||o.dispose()}}render(e,t,i,r,n,o,l,c,u,d=0,_=0,m=0,f=0,E=0){let I=this.getPlane(r);if(I||(I=this.getPlane(th.DEFAULT)),!I)return null;i&&t.clearAndFillRenderTexture(i);let p=I.render(e,t,i,n,o,l,c,u);return p&&p!==i&&(p=new Ka(p.baseTexture),!p)?null:new Pp(p,-1)}getTextureIdentifier(e,t){return t?`${e}_${t.x}_${t.y}_${t.z}`:super.getTextureIdentifier(e,t)}}const pg=class pg extends yN{constructor(){super(...arguments),this._width=0,this._height=0}isStatic(e){const t=this.getPlaneVisualization(e);return t?!t.hasAnimationLayers:super.isStatic(e)}initializeDimensions(e,t){e<0&&(e=0),t<0&&(t=0),(e!==this._width||t!==this._height)&&(this._width=e,this._height=t)}render(e,t,i,r,n,o,l,c,u,d,_,m,f){const E=this.getPlaneVisualization(o);if(!E||!E.geometry)return null;const I=E.geometry.getScreenPoint(new Y(0,0,0)),p=E.geometry.getScreenPoint(new Y(0,0,1)),S=E.geometry.getScreenPoint(new Y(0,1,0));if(I&&p&&S){r=Math.round(Math.abs((I.x-S.x)*r/E.geometry.scale)),n=Math.round(Math.abs((I.y-p.y)*n/E.geometry.scale));const R=Math.trunc(u*Math.abs(I.x-S.x)),O=Math.trunc(d*Math.abs(I.y-p.y)),C=Math.trunc(_*Math.abs(I.x-S.x)),A=Math.trunc(m*Math.abs(I.y-p.y));return E.render(e,t,i,r,n,l,c,R,O,C,A,_,m,f)}return null}};pg.DEFAULT_COLOR=16777215,pg.HORIZONTAL_ANGLE_DEFAULT=45,pg.VERTICAL_ANGLE_DEFAULT=30;let Ch=pg;const To=class To extends th{constructor(){super(...arguments),this._landscapeWidth=0,this._landscapeHeight=0,this._cachedBitmap=null}initializeDimensions(e,t){return e<0&&(e=0),t<0&&(t=0),this._landscapeWidth=e,this._landscapeHeight=t,!0}initializePlanes(){if(!this.data)return;const e=this.data.planes;e&&e.length&&this.parseLandscapes(e)}parseLandscapes(e){if(!e)return;const t=Math.trunc(Math.random()*654321);for(const i in e){const r=e[i];if(!r)continue;const n=r.id,o=r.animatedVisualization,l=new Ch;for(const c of o){if(!c)continue;const u=c.size;let d=Ch.HORIZONTAL_ANGLE_DEFAULT,_=Ch.VERTICAL_ANGLE_DEFAULT;c.horizontalAngle!==void 0&&(d=c.horizontalAngle),c.verticalAngle!==void 0&&(_=c.verticalAngle);const m=c.allLayers.length??0,f=l.createPlaneVisualization(u,m||0,this.getGeometry(u,d,_));if(f){vc.setSeed(t);let E=0;for(;E<m;){const I=c.allLayers[E];if(I){if(I.items===void 0){const p=I;let S=null,R=_a.ALIGN_DEFAULT,O=Ch.DEFAULT_COLOR,C=_a.DEFAULT_OFFSET;p.materialId&&(S=this.getMaterial(p.materialId)),p.color&&(O=p.color),p.offset&&(C=p.offset),p.align&&(p.align==="bottom"?R=_a.ALIGN_BOTTOM:p.align==="top"&&(R=_a.ALIGN_TOP)),f.setLayer(E,S,O,R,C)}else{const S=I.items,R=[];if(S&&S.length){for(const O of S)if(O){O.id;const C=O.assetId,A=this.getCoordinateValue(O.x||"",O.randomX||""),b=this.getCoordinateValue(O.y||"",O.randomY||""),y=O.speedX,M=O.speedY;R.push({asset:C,x:A,y:b,speedX:y,speedY:M})}}f.setAnimationLayer(E,R,this.assetCollection)}E++}}}}this.addPlane(n,l)||l.dispose()}}getCoordinateValue(e,t){let i=0;if(e.length>0&&e.charAt(e.length-1)==="%"&&(e=e.substr(0,e.length-1),i=parseFloat(e)/100),t.length>0){const o=vc.getValues(1,0,1e4)[0]/1e4;t.charAt(t.length-1)==="%"&&(t=t.substr(0,t.length-1),i=i+o*parseFloat(t)/100)}return i}render(e,t,i,r,n,o,l,c,u,d=0,_=0,m=0,f=0,E=0){let I=this.getPlane(r);if(I||(I=this.getPlane(To.DEFAULT)),!I)return null;i&&t.clearRenderTexture(i);let p=I.render(e,t,i,n,o,l,c,u,d,_,m,f,E);if(p&&p!==i&&(p=new Ka(p.baseTexture),!p))return null;let S=null;return!I.isStatic(l)&&To.UPDATE_INTERVAL>0?S=new Pp(p,Math.round(E/To.UPDATE_INTERVAL)*To.UPDATE_INTERVAL+To.UPDATE_INTERVAL):S=new Pp(p,-1),S}getTextureIdentifier(e,t){return t?t.x<0?e+"_0":e+"_1":super.getTextureIdentifier(e,t)}};To.LANDSCAPES_ENABLED=!0,To.LANDSCAPE_DEFAULT_COLOR=8828617,To.UPDATE_INTERVAL=500;let Up=To;class Yb{constructor(e,t){if(this._color=0,this._isDisposed=!1,this._color=0,this._isDisposed=!1,this._items=[],e&&t)for(const i of e){if(!i)continue;const r=i.asset;if(r){const n=t.getAsset(r);n&&this._items.push(new uee(i.x,i.y,i.speedX,i.speedY,n))}}}get disposed(){return this._isDisposed}dispose(){if(this._isDisposed=!0,this._items){for(const e of this._items)e&&e.dispose();this._items=[]}}clearCache(){}render(e,t,i,r,n,o,l,c,u,d,_,m){if(c>0&&u>0){let f=0;for(;f<this._items.length;){const E=this._items[f];if(E){const I=E.getPosition(c,u,d,_,m);if(I.x=Math.trunc(I.x-o),I.y=Math.trunc(I.y-l),E.bitmapData){if(I.x>-E.bitmapData.width&&I.x<t.width&&I.y>-E.bitmapData.height&&I.y<t.height){const p=new si(E.bitmapData.texture);p.position.set(I.x,I.y),e.writeToRenderTexture(p,t,!1)}if(I.x-c>-E.bitmapData.width&&I.x-c<t.width&&I.y>-E.bitmapData.height&&I.y<t.height){const p=new si(E.bitmapData.texture);p.position.set(I.x-c,I.y),e.writeToRenderTexture(p,t,!1)}if(I.x>-E.bitmapData.width&&I.x<t.width&&I.y-u>-E.bitmapData.height&&I.y-u<t.height){const p=new si(E.bitmapData.texture);p.position.set(I.x,I.y-u),e.writeToRenderTexture(p,t,!1)}if(I.x-c>-E.bitmapData.width&&I.x-c<t.width&&I.y-u>-E.bitmapData.height&&I.y-u<t.height){const p=new si(E.bitmapData.texture);p.position.set(I.x-c,I.y-u),e.writeToRenderTexture(p,t,!1)}}}f++}}return t}}class zb{constructor(e,t,i){this._type=e,this._leftSideLoc=t,this._rightSideLoc=i}get type(){return this._type}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}}class Kb{constructor(e,t,i,r){this._leftSideLoc=e,this._rightSideLoc=t,this._leftSideLength=i,this._rightSideLength=r}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}const Wr=class Wr{constructor(e,t,i,r,n,o,l,c,u,d=0,_=0,m=0,f=0){if(this._maskManager=null,this._width=0,this._height=0,this._extraDepth=0,this._isHighlighter=!1,this._textureCache=e,this._secondaryNormals=[],this._bitmapMasks=[],this._rectangleMasks=[],this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._randomSeed=u,this._bitmapData=null,this._maskBitmapData=null,this._maskChanged=!1,this._activeTexture=null,this._origin=new Y,this._origin.assign(t),this._location=new Y,this._location.assign(i),this._leftSide=new Y,this._leftSide.assign(r),this._rightSide=new Y,this._rightSide.assign(n),this._normal=Y.crossProduct(this._leftSide,this._rightSide),this._normal.length>0&&this._normal.multiply(1/this._normal.length),c!=null)for(const E of c){if(!E)continue;const I=new Y;I.assign(E),this._secondaryNormals.push(I)}this._disposed=!1,this._isVisible=!1,this._id=null,this._hasTexture=!0,this._geometryUpdateId=-1,this._offset=new ot,this._relativeDepth=0,this._type=o,this._color=0,this._rasterizer=null,this._canBeVisible=!0,this._cornerA=new Y,this._cornerB=new Y,this._cornerC=new Y,this._cornerD=new Y,this._width=0,this._height=0,this._textureOffsetX=d,this._textureOffsetY=_,this._textureMaxX=m,this._textureMaxY=f,this._useMask=l,this._uniqueId=++Wr._uniqueIdCounter}static blend(e,t){return Ri.colorize(t,e|4278190080)&16777215}set canBeVisible(e){e!==this._canBeVisible&&(this._canBeVisible||this.resetTextureCache(),this._canBeVisible=e)}get canBeVisible(){return this._canBeVisible}get bitmapData(){return!this.visible||!this._bitmapData?null:this._bitmapData}get maskBitmapData(){return!this.visible||!this._maskBitmapData?null:this._maskBitmapData}get visible(){return this._isVisible&&this._canBeVisible}get offset(){return this._offset}get relativeDepth(){return this._relativeDepth+this._extraDepth}set extraDepth(e){this._extraDepth=e}get color(){return this._color}set color(e){this._color=e}get type(){return this._type}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get location(){return this._location}get normal(){return this._normal}get hasTexture(){return this._hasTexture}set hasTexture(e){this._hasTexture=e}set rasterizer(e){this._rasterizer=e}set maskManager(e){this._maskManager=e}set id(e){e!==this._id&&(this.resetTextureCache(),this._id=e)}get uniqueId(){return this._uniqueId}dispose(){this._activeTexture=null,this._location=null,this._origin=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._rasterizer=null,this._cornerA=null,this._cornerB=null,this._cornerC=null,this._cornerD=null,this._bitmapMasks=null,this._rectangleMasks=null,this._maskPixels=null,this._maskBitmapData&&(this._maskBitmapData.destroy(!0),this._maskBitmapData=null),this._disposed=!0}copyBitmapData(e){return!this.visible||!this._bitmapData||!e||this._bitmapData.width!==e.width||this._bitmapData.height!==e.height?null:e}resetTextureCache(e=null){this._activeTexture=null}getTextureIdentifier(e){return this._rasterizer?this._rasterizer.getTextureIdentifier(e,this.normal):e.toString()}needsNewTexture(e,t){if(!e)return!1;const i=this._activeTexture;return this.updateMaskChangeStatus(),!!(this._canBeVisible&&(!i||i.timeStamp>=0&&t>i.timeStamp||this._maskChanged))}getTexture(e,t){if(!e)return null;let i=null;if(this.needsNewTexture(e,t)){this.getTextureIdentifier(e.scale);const r=this._leftSide.length*e.scale,n=this._rightSide.length*e.scale,o=e.getCoordinatePosition(this._normal);i=this._rasterizer.render(this._uniqueId.toString(),this._textureCache,null,this._id,r,n,e.scale,o,this._hasTexture,this._textureOffsetX,this._textureOffsetY,this._textureMaxX,this._textureMaxY,t),i&&this.updateMask(i.texture,e)}else this._activeTexture&&(i=this._activeTexture);return i?(this._activeTexture=i,i.texture):null}resolveMasks(e){if(!this._useMask)return null;const t=new l_,i=0;for(;i<this._bitmapMasks.length;){const r=this._bitmapMasks[i];if(r){const n=this._maskManager.getMask(r.type);if(n){const o=n.getAssetName(e.scale);if(o){const l=e.getCoordinatePosition(this._normal),c=n.getGraphicAsset(e.scale,l);if(c){const u=this._maskBitmapData.width*(1-r.leftSideLoc/this._leftSide.length),d=this._maskBitmapData.height*(1-r.rightSideLoc/this._rightSide.length);t.addMask(o,new ot(u+c.offsetX,d+c.offsetY),c.flipH,c.flipV)}}}}}return t}screenWidth(e){const t=e.getScreenPoint(new Y(0,0,0)),i=e.getScreenPoint(new Y(0,1,0));return Math.round(this._leftSide.length*Math.abs(t.x-i.x))}getDrawingDatas(e){const t=[];if(this._isVisible){const i=this.resolveMasks(e),r=this._rasterizer.getLayers(this._id);for(const n of r)if(this._hasTexture&&n.getMaterial()){const o=e.getCoordinatePosition(this._normal),l=n.getMaterial().getMaterialCellMatrix(o),c=new l_(i,Wr.blend(this._color,n.getColor()),l.isBottomAligned());vc.setSeed(this._randomSeed);for(const u of l.getColumns(this.screenWidth(e))){const d=[];for(const _ of u.getCells()){const m=_.getAssetName(o);m&&d.push(m)}d.length>0&&(u.isRepeated()||d.push(""),c.addAssetColumn(d))}c.assetNameColumns.length>0&&t.push(c)}else{const o=new l_(i,Wr.blend(this._color,n.getColor()));t.push(o)}t.length||t.push(new l_(i,this._color))}return t}update(e,t){if(!e||this._disposed)return!1;let i=!1;if(this._geometryUpdateId!=e.updateId&&(i=!0),(!i||!this._canBeVisible)&&!this.visible)return!1;if(i){this._activeTexture=null;let r=0;if(r=Y.cosAngle(e.directionAxis,this.normal),r>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;let n=0;for(;n<this._secondaryNormals.length;){if(r=Y.cosAngle(e.directionAxis,this._secondaryNormals[n]),r>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;n++}this.updateCorners(e);const l=e.getScreenPosition(this._origin).z;let c=Math.max(this._cornerA.z,this._cornerB.z,this._cornerC.z,this._cornerD.z)-l;this._type===Wr.TYPE_FLOOR&&(c=c-(this._location.z+Math.min(0,this._leftSide.z,this._rightSide.z))*8),this._type===Wr.TYPE_LANDSCAPE&&(c=c+.02),this._relativeDepth=c,this._isVisible=!0,this._geometryUpdateId=e.updateId}if(i||this.needsNewTexture(e,t)){if(!this._bitmapData||this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData)if(this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData.destroy(),this._bitmapData=null,this._width<1||this._height<1)return!0;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}else{if(this._width<1||this._height<1)return this._bitmapData.destroy(),this._bitmapData=null,!0;this._textureCache.clearAndFillRenderTexture(this._bitmapData)}else{if(this._width<1||this._height<1)return!1;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}if(!this._bitmapData)return!1}else this._textureCache.clearAndFillRenderTexture(this._bitmapData);vc.setSeed(this._randomSeed);const r=this.getTexture(e,t);if(r)this.renderTexture(e,r);else return this.dispose(),!1;return r!==null||i}return!1}updateCorners(e){this._cornerA.assign(e.getScreenPosition(this._location)),this._cornerB.assign(e.getScreenPosition(Y.sum(this._location,this._rightSide))),this._cornerC.assign(e.getScreenPosition(Y.sum(Y.sum(this._location,this._leftSide),this._rightSide))),this._cornerD.assign(e.getScreenPosition(Y.sum(this._location,this._leftSide))),this._offset=e.getScreenPoint(this._origin),this._cornerA.x=Math.round(this._cornerA.x),this._cornerA.y=Math.round(this._cornerA.y),this._cornerB.x=Math.round(this._cornerB.x),this._cornerB.y=Math.round(this._cornerB.y),this._cornerC.x=Math.round(this._cornerC.x),this._cornerC.y=Math.round(this._cornerC.y),this._cornerD.x=Math.round(this._cornerD.x),this._cornerD.y=Math.round(this._cornerD.y),this._offset.x=Math.round(this._offset.x),this._offset.y=Math.round(this._offset.y);const t=Math.min(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x),i=Math.max(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x)-t,r=Math.min(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y),n=Math.max(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y)-r;this._offset.x=this._offset.x-t,this._cornerA.x=this._cornerA.x-t,this._cornerB.x=this._cornerB.x-t,this._cornerC.x=this._cornerC.x-t,this._cornerD.x=this._cornerD.x-t,this._offset.y=this._offset.y-r,this._cornerA.y=this._cornerA.y-r,this._cornerB.y=this._cornerB.y-r,this._cornerC.y=this._cornerC.y-r,this._cornerD.y=this._cornerD.y-r,this._width=i,this._height=n}getMatrixForDimensions(e,t){let i=this._cornerD.x-this._cornerC.x,r=this._cornerD.y-this._cornerC.y,n=this._cornerB.x-this._cornerC.x,o=this._cornerB.y-this._cornerC.y;(this._type===Wr.TYPE_WALL||this._type===Wr.TYPE_LANDSCAPE)&&(Math.abs(n-e)<=1&&(n=e),Math.abs(o-e)<=1&&(o=e),Math.abs(i-t)<=1&&(i=t),Math.abs(r-t)<=1&&(r=t));const l=n/e,c=o/e,u=i/t,d=r/t,_=new qr(l,c,u,d);return _.translate(this._cornerC.x,this._cornerC.y),_}renderTexture(e,t){this._cornerA==null||this._cornerB==null||this._cornerC==null||this._cornerD==null||t==null||this._bitmapData==null||this.draw(t,this.getMatrixForDimensions(t.width,t.height))}draw(e,t){this._textureCache.writeToRenderTexture(new si(e),this._bitmapData,!0,t)}resetBitmapMasks(){this._disposed||!this._useMask||!this._bitmapMasks.length||(this._maskChanged=!0,this._bitmapMasks=[])}addBitmapMask(e,t,i){if(!this._useMask)return!1;for(const n of this._bitmapMasks)if(n&&n.type===e&&n.leftSideLoc===t&&n.rightSideLoc===i)return!1;const r=new zb(e,t,i);return this._bitmapMasks.push(r),this._maskChanged=!0,!0}resetRectangleMasks(){!this._useMask||!this._rectangleMasks.length||(this._maskChanged=!0,this._rectangleMasks=[])}addRectangleMask(e,t,i,r){if(this._useMask){for(const o of this._rectangleMasks)if(o&&o.leftSideLoc===e&&o.rightSideLoc===t&&o.leftSideLength===i&&o.rightSideLength===r)return!1;const n=new Kb(e,t,i,r);return this._rectangleMasks.push(n),this._maskChanged=!0,!0}return!1}updateMaskChangeStatus(){if(!this._maskChanged)return;let e=!0;if(this._bitmapMasks.length===this._bitmapMasksOld.length)for(const t of this._bitmapMasks){if(!t)continue;let i=!1;for(const r of this._bitmapMasksOld)if(r&&r.type===t.type&&r.leftSideLoc===t.leftSideLoc&&r.rightSideLoc===t.rightSideLoc){i=!0;break}if(!i){e=!1;break}}else e=!1;this._rectangleMasks.length>this._rectangleMasksOld.length&&(e=!1),e&&(this._maskChanged=!1)}updateMask(e,t){if(!e||!t||!this._useMask||!this._bitmapMasks.length&&!this._rectangleMasks.length&&!this._maskChanged||!this._maskManager)return;const i=e.width,r=e.height;if(this.updateMaskChangeStatus(),!this._maskBitmapData||this._maskBitmapData.width!==i||this._maskBitmapData.height!==r){const n=this._maskBitmapData;this._maskBitmapData=this._textureCache.createAndFillRenderTexture(i,r,"mask"),this._maskChanged=n!==this._maskBitmapData}if(this._maskChanged){this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._maskBitmapData&&this._textureCache.clearAndFillRenderTexture(this._maskBitmapData),this.resetTextureCache(e);const n=t.getCoordinatePosition(this._normal);let o=null,l=0,c=0,u=0;for(;u<this._bitmapMasks.length;){const d=this._bitmapMasks[u];d&&(o=d.type,l=this._maskBitmapData.width-this._maskBitmapData.width*d.leftSideLoc/this._leftSide.length,c=this._maskBitmapData.height-this._maskBitmapData.height*d.rightSideLoc/this._rightSide.length,this._maskManager.updateMask(this._maskBitmapData,o,t.scale,n,l,c),this._bitmapMasksOld.push(new zb(o,d.leftSideLoc,d.rightSideLoc))),u++}for(u=0;u<this._rectangleMasks.length;){const d=this._rectangleMasks[u];if(d){l=this._maskBitmapData.width-this._maskBitmapData.width*d.leftSideLoc/this._leftSide.length,c=this._maskBitmapData.height-this._maskBitmapData.height*d.rightSideLoc/this._rightSide.length;const _=this._maskBitmapData.width*d.leftSideLength/this._leftSide.length,m=this._maskBitmapData.height*d.rightSideLength/this._rightSide.length,f=new si(Qs.WHITE);f.tint=0,f.width=_,f.height=m,f.position.set(l-_,c-m),this._textureCache.writeToRenderTexture(f,this._maskBitmapData,!1),this._rectangleMasksOld.push(new Kb(d.leftSideLength,d.rightSideLoc,d.leftSideLength,d.rightSideLength))}u++}this._maskPixels=this._textureCache.getPixels(this._maskBitmapData),this._maskChanged=!1}this.combineTextureMask(e,this._maskPixels)}combineTextureMask(e,t){var o,l;if(!e||!t)return;const i=this._textureCache.getPixels(e);for(let c=0;c<i.length;c+=4){const u=t[c],d=t[c+1],_=t[c+2];t[c+3],!u&&!d&&!_&&(i[c+3]=0)}const r=(o=e.baseTexture._glTextures[1])==null?void 0:o.texture,n=(l=di.instance.renderer)==null?void 0:l.gl;!r||!n||(n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e.width,e.height,0,n.RGBA,n.UNSIGNED_BYTE,i),n.bindTexture(n.TEXTURE_2D,null))}get isHighlighter(){return this._isHighlighter}set isHighlighter(e){this._isHighlighter=e}};Wr.ZERO_POINT=new ot(0,0),Wr.TYPE_UNDEFINED=0,Wr.TYPE_WALL=1,Wr.TYPE_FLOOR=2,Wr.TYPE_LANDSCAPE=3,Wr._uniqueIdCounter=1;let rs=Wr;class CG extends Qr{constructor(){super(),this._wallRasterizer=new gee,this._floorRasterizer=new _ee,this._landscapeRasterizer=new Up,this._maskManager=new cee,this._initialized=!1}initialize(e){if(!e.roomVisualization)return!1;const t=e.roomVisualization.wallData;t&&this._wallRasterizer.initialize(t);const i=e.roomVisualization.floorData;i&&this._floorRasterizer.initialize(i);const r=e.roomVisualization.landscapeData;r&&this._landscapeRasterizer.initialize(r);const n=e.roomVisualization.maskData;return n&&this._maskManager.initialize(n),!0}onDispose(){this._wallRasterizer&&(this._wallRasterizer.dispose(),this._wallRasterizer=null),this._floorRasterizer&&(this._floorRasterizer.dispose(),this._floorRasterizer=null),this._landscapeRasterizer&&(this._landscapeRasterizer.dispose(),this._landscapeRasterizer=null),this._maskManager&&(this._maskManager.dispose(),this._maskManager=null),super.onDispose()}setGraphicAssetCollection(e){this._initialized||(this._wallRasterizer.initializeAssetCollection(e),this._floorRasterizer.initializeAssetCollection(e),this._landscapeRasterizer.initializeAssetCollection(e),this._maskManager.initializeAssetCollection(e),this._initialized=!0)}clearCache(){this._wallRasterizer&&this._wallRasterizer.clearCache(),this._floorRasterizer&&this._floorRasterizer.clearCache(),this._landscapeRasterizer&&this._landscapeRasterizer.clearCache()}get wallRasterizer(){return this._wallRasterizer}get floorRasterizer(){return this._floorRasterizer}get landscapeRasterizer(){return this._landscapeRasterizer}get maskManager(){return this._maskManager}}const Es=class Es extends Dd{constructor(){super(),this._highlightAreaX=0,this._highlightAreaY=0,this._highlightAreaWidth=0,this._highlightAreaHeight=0,this._data=null,this._roomPlaneParser=new vi,this._roomPlaneBitmapMaskParser=new fG,this._geometryUpdateId=-1,this._directionX=0,this._directionY=0,this._directionZ=0,this._floorThickness=1,this._wallThickness=1,this._holeUpdateTime=NaN,this._planes=[],this.dictionaryVar=new Map,this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],this._roomScale=0,this._lastUpdateTime=-1e3,this._updateIntervalTime=250,this._wallType=null,this._floorType=null,this._landscapeType=null,this._colorBackgroundOnly=!0,this._color=16777215,this._redColor=255,this._greenColor=255,this._blueColor=255,this._typeVisibility=[],this._assetUpdateCounter=0,this._maskData=null,this._isPlaneSet=!1,this._textureCache=new yS,this._typeVisibility[rs.TYPE_UNDEFINED]=!1,this._typeVisibility[rs.TYPE_FLOOR]=!0,this._typeVisibility[rs.TYPE_WALL]=!0,this._typeVisibility[rs.TYPE_LANDSCAPE]=!0}get planes(){const e=[];for(const t of this._visiblePlanes)e.push(t);return e}get floorRelativeDepth(){return Es.ROOM_DEPTH_OFFSET+.1}get wallRelativeDepth(){return Es.ROOM_DEPTH_OFFSET+.5}initialize(e){return e instanceof CG?(this._data=e,super.initialize(e),this._data.setGraphicAssetCollection(this.asset),!0):!1}dispose(){super.dispose(),this.clearPlanes(),this._planes=null,this.dictionaryVar=null,this._visiblePlanes=null,this._visiblePlaneSpriteNumbers=null,this._roomPlaneParser&&(this._roomPlaneParser.dispose(),this._roomPlaneParser=null),this._roomPlaneBitmapMaskParser&&(this._roomPlaneBitmapMaskParser.dispose(),this._roomPlaneBitmapMaskParser=null),this._data&&(this._data.clearCache(),this._data=null),this._textureCache&&this._textureCache.clearCache()}update(e,t,i,r){if(!this.object||!e)return;const n=this.updateGeometry(e),o=this.object.model;let l=!1;if(this.updateThickness(o)&&(l=!0),this.updateHole(o)&&(l=!0),this.initializeRoomPlanes(),l=this.updateMasks(o),!(t<this._lastUpdateTime+this._updateIntervalTime&&!n&&!l)){if(this.updatePlaneTexturesAndVisibilities(o)&&(l=!0),this.updatePlanes(e,n,t)&&(l=!0),l){let c=0;for(;c<this._visiblePlanes.length;){const u=this._visiblePlaneSpriteNumbers[c],d=this.getSprite(u),_=this._visiblePlanes[c];if(d&&_&&_.type!==rs.TYPE_LANDSCAPE)if(this._colorBackgroundOnly){let m=_.color;const f=(m&255)*this._redColor/255,E=(m>>8&255)*this._greenColor/255,I=(m>>16&255)*this._blueColor/255;m=(m>>24<<24)+(I<<16)+(E<<8)+f,d.color=m}else d.color=_.color;c++}this.updateSpriteCounter++}this.updateModelCounter=o.updateCounter,this._lastUpdateTime=t}}initializeHighlightArea(e,t,i,r,n){this.clearHighlightArea(),this._highlightAreaX=e,this._highlightAreaY=t,this._highlightAreaWidth=i,this._highlightAreaHeight=r,this._highlightFilter=n,this._roomPlaneParser.initializeHighlightArea(e,t,i,r),this.createPlanesAndSprites(this._planes.length),this.reset()}clearHighlightArea(){let e=0,t=0;this._highlightAreaX=0,this._highlightAreaY=0,this._highlightAreaWidth=0,this._highlightAreaHeight=0;const i=this._roomPlaneParser.clearHighlightArea();let r=0;for(e=this._roomPlaneParser.planeCount;e<this._roomPlaneParser.planeCount+i;)t=this.dictionaryVar[e],t!=-1&&(r+=1,this.dictionaryVar[e]=-1),e+=1;this._planes=this._planes.slice(0,this._planes.length-r),this.createSprites(this._planes.length),this.reset()}getBoundingRectangle(){return this._boundingRectangle||(this._boundingRectangle=super.getBoundingRectangle()),new En(this._boundingRectangle.x,this._boundingRectangle.y,this._boundingRectangle.width,this._boundingRectangle.height)}reset(){super.reset(),this._floorType=null,this._wallType=null,this._landscapeType=null,this._maskData=null,this._geometryUpdateId=-1,this._roomScale=0}initializeRoomPlanes(){if(!this.object||this._isPlaneSet)return;isNaN(this._floorThickness)||(this._roomPlaneParser.floorThicknessMultiplier=this._floorThickness),isNaN(this._wallThickness)||(this._roomPlaneParser.wallThicknessMultiplier=this._wallThickness);const e=this.object.model.getValue(D.ROOM_MAP_DATA);this._roomPlaneParser.clearHighlightArea(),this._roomPlaneParser.initializeFromMapData(e)&&this.createPlanesAndSprites()}createPlanesAndSprites(e=0){const t=this.getLandscapeWidth(),i=this.getLandscapeHeight();let r=0,n=this.object.model.getValue(D.ROOM_RANDOM_SEED),o=e;for(;o<this._roomPlaneParser.planeCount;){this.dictionaryVar[o]=-1;const l=this._roomPlaneParser.getPlaneLocation(o),c=this._roomPlaneParser.getPlaneLeftSide(o),u=this._roomPlaneParser.getPlaneRightSide(o),d=this._roomPlaneParser.getPlaneSecondaryNormals(o),_=this._roomPlaneParser.getPlaneType(o);let m=null;if(l&&c&&u){const f=Y.crossProduct(c,u);if(n=bG(Math.trunc(n*7613+517)>>>0),m=null,_===Xs.PLANE_FLOOR){const E=l.x+c.x+.5,I=l.y+u.y+.5,p=Math.trunc(E)-E,S=Math.trunc(I)-I;m=new rs(this._textureCache,this.object.getLocation(),l,c,u,rs.TYPE_FLOOR,!0,d,n,-p,-S),f.z!==0?m.color=Es.FLOOR_COLOR:m.color=f.x!==0?Es.FLOOR_COLOR_RIGHT:Es.FLOOR_COLOR_LEFT,this._data&&(m.rasterizer=this._data.floorRasterizer)}else _===Xs.PLANE_WALL?(m=new rs(this._textureCache,this.object.getLocation(),l,c,u,rs.TYPE_WALL,!0,d,n),(c.length<1||u.length<1)&&(m.hasTexture=!1),f.x===0&&f.y===0?m.color=Es.WALL_COLOR_BORDER:f.y>0?m.color=Es.WALL_COLOR_TOP:f.y===0?m.color=Es.WALL_COLOR_SIDE:m.color=Es.WALL_COLOR_BOTTOM,this._data&&(m.rasterizer=this._data.wallRasterizer)):_===Xs.PLANE_LANDSCAPE?(m=new rs(this._textureCache,this.object.getLocation(),l,c,u,rs.TYPE_LANDSCAPE,!0,d,n,r,0,t,i),f.y>0?m.color=Es.LANDSCAPE_COLOR_TOP:f.y==0?m.color=Es.LANDSCAPE_COLOR_SIDE:m.color=Es.LANDSCAPE_COLOR_BOTTOM,this._data&&(m.rasterizer=this._data.landscapeRasterizer),r=r+c.length):_==Xs.PLANE_BILLBOARD&&(m=new rs(this._textureCache,this.object.getLocation(),l,c,u,rs.TYPE_WALL,!0,d,n),(c.length<1||u.length<1)&&(m.hasTexture=!1),f.x==0&&f.y==0?m.color=Es.WALL_COLOR_BORDER:f.y>0?m.color=Es.WALL_COLOR_TOP:f.y==0?m.color=Es.WALL_COLOR_SIDE:m.color=Es.WALL_COLOR_BOTTOM);if(m){m.maskManager=this._data.maskManager;let E=0;for(;E<this._roomPlaneParser.getPlaneMaskCount(o);){const I=this._roomPlaneParser.getPlaneMaskLeftSideLoc(o,E),p=this._roomPlaneParser.getPlaneMaskRightSideLoc(o,E),S=this._roomPlaneParser.getPlaneMaskLeftSideLength(o,E),R=this._roomPlaneParser.getPlaneMaskRightSideLength(o,E);m.addRectangleMask(I,p,S,R),E++}this.dictionaryVar[o]=this._planes.length,this._planes.push(m)}}else return;o++}this._isPlaneSet=!0,this.defineSprites(e)}defineSprites(e=0){this.createSprites(this._planes.length);let t=e;for(;t<this._planes.length;){const i=this._planes[t],r=this.getSprite(t);i&&r&&i.leftSide&&i.rightSide&&(i.type===rs.TYPE_WALL&&(i.leftSide.length<1||i.rightSide.length<1)?r.alphaTolerance=Ha.MATCH_NOTHING:r.alphaTolerance=Ha.MATCH_OPAQUE_PIXELS,i.type===rs.TYPE_WALL?r.tag="plane.wall@"+(t+1):i.type===rs.TYPE_FLOOR?r.tag="plane.floor@"+(t+1):r.tag="plane@"+(t+1),r.spriteType=Gn.ROOM_PLANE,this._roomPlaneParser.isPlaneTemporaryHighlighter(t)?(r.filters=this._highlightFilter,r.skipMouseHandling=!0,i.extraDepth=-100,i.isHighlighter=!0):(r.filters=[],r.skipMouseHandling=!1,i.extraDepth=0,i.isHighlighter=!1)),t++}}updatePlaneTypes(e,t,i){if(e!==this._floorType?this._floorType=e:e=null,t!==this._wallType?this._wallType=t:t=null,i!==this._landscapeType?this._landscapeType=i:i=null,!e&&!t&&!i)return!1;let r=0;for(;r<this._planes.length;){const n=this._planes[r];n&&(n.type===rs.TYPE_FLOOR&&e?n.id=e:n.type===rs.TYPE_WALL&&t?n.id=t:n.type===rs.TYPE_LANDSCAPE&&i&&(n.id=i)),r++}return!0}updatePlanes(e,t,i){if(!e||!this.object)return!1;this._assetUpdateCounter++,t&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[]);const r=this._visiblePlanes.length>0;let n=this._visiblePlanes;this._visiblePlanes.length||(n=this._planes);let o=0,l=!1,c=0;for(;c<n.length;){let u=c;r&&(u=this._visiblePlaneSpriteNumbers[c]);const d=this.getSprite(u);if(d){const _=n[c];_?(d.id=_.uniqueId,_.update(e,i)&&(_.visible&&(o=_.relativeDepth+this.floorRelativeDepth+u/1e3,_.type!==rs.TYPE_FLOOR&&(o=_.relativeDepth+this.wallRelativeDepth+u/1e3,(_.leftSide.length<1||_.rightSide.length<1)&&(o=o+Es.ROOM_DEPTH_OFFSET*.5)),this.updateSprite(d,e,_,`plane ${u} ${e.scale}`,o)),l=!0),d.visible!=(_.visible&&this._typeVisibility[_.type])&&(d.visible=!d.visible,l=!0),d.visible&&(r||(this._visiblePlanes.push(_),this._visiblePlaneSpriteNumbers.push(c)))):(d.id=0,d.visible&&(d.visible=!1,l=!0))}c++}return l}updatePlaneMasks(e){if(!e)return;this._roomPlaneBitmapMaskParser.initialize(e);const t=[],i=[];let r=!1,n=0;for(;n<this._planes.length;){const o=this._planes[n];o&&(o.resetBitmapMasks(),o.type===rs.TYPE_LANDSCAPE&&t.push(n)),n++}for(const o of this._roomPlaneBitmapMaskParser.masks.values()){const l=this._roomPlaneBitmapMaskParser.getMaskType(o),c=this._roomPlaneBitmapMaskParser.getMaskLocation(o),u=this._roomPlaneBitmapMaskParser.getMaskCategory(o);if(c){let d=0;for(;d<this._planes.length;){const _=this._planes[d];if((_.type===rs.TYPE_WALL||_.type===rs.TYPE_LANDSCAPE)&&_&&_.location&&_.normal){const m=Y.dif(c,_.location);if(Math.abs(Y.scalarProjection(m,_.normal))<.01&&_.leftSide&&_.rightSide){const E=Y.scalarProjection(m,_.leftSide),I=Y.scalarProjection(m,_.rightSide);_.type===rs.TYPE_WALL||_.type===rs.TYPE_LANDSCAPE&&u===Zu.HOLE?_.addBitmapMask(l,E,I):_.type===rs.TYPE_LANDSCAPE&&(_.canBeVisible||(r=!0),_.canBeVisible=!0,i.push(d))}}d++}}}for(n=0;n<t.length;){const o=t[n];if(i.indexOf(o)<0){const l=this._planes[o];l.canBeVisible=!1,r=!0}n++}r&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[])}updateGeometry(e){if(!e||this._geometryUpdateId===e.updateId)return!1;this._geometryUpdateId=e.updateId,this._boundingRectangle=null;const t=e.direction;return t&&(t.x!==this._directionX||t.y!==this._directionY||t.z!==this._directionZ||e.scale!==this._roomScale)?(this._directionX=t.x,this._directionY=t.y,this._directionZ=t.z,this._roomScale=e.scale,!0):!1}updateThickness(e){if(this.updateModelCounter===e.updateCounter)return!1;const t=e.getValue(D.ROOM_FLOOR_THICKNESS),i=e.getValue(D.ROOM_WALL_THICKNESS);return!isNaN(t)&&!isNaN(i)&&(t!==this._floorThickness||i!==this._wallThickness)?(this._floorThickness=t,this._wallThickness=i,this.clearPlanes(),!0):!1}updateHole(e){if(this.updateModelCounter===e.updateCounter)return!1;const t=e.getValue(D.ROOM_FLOOR_HOLE_UPDATE_TIME);return!isNaN(t)&&t!==this._holeUpdateTime?(this._holeUpdateTime=t,this.clearPlanes(),!0):!1}updateMasks(e){if(this.updateModelCounter===e.updateCounter)return!1;let t=!1;const i=e.getValue(D.ROOM_PLANE_MASK_XML);i!==this._maskData&&(this.updatePlaneMasks(i),this._maskData=i,t=!0);const r=e.getValue(D.ROOM_BACKGROUND_COLOR);r!==this._color&&(this._color=r,this._redColor=this._color&255,this._greenColor=this._color>>8&255,this._blueColor=this._color>>16&255,t=!0);const n=e.getValue(D.ROOM_COLORIZE_BG_ONLY)||!1;return n!==this._colorBackgroundOnly&&(this._colorBackgroundOnly=n,t=!0),t}updatePlaneTexturesAndVisibilities(e){if(this.updateModelCounter===e.updateCounter)return!1;const t=e.getValue(D.ROOM_FLOOR_TYPE),i=e.getValue(D.ROOM_WALL_TYPE),r=e.getValue(D.ROOM_LANDSCAPE_TYPE),n=e.getValue(D.ROOM_FLOOR_VISIBILITY)===1,o=e.getValue(D.ROOM_WALL_VISIBILITY)===1,l=e.getValue(D.ROOM_LANDSCAPE_VISIBILITY)===1;return this.updatePlaneTypes(t,i,r)||this.updatePlaneVisibility(n,o,l)}clearPlanes(){if(this._planes){for(;this._planes.length;){const e=this._planes[0];e&&e.dispose(),this._planes.pop()}this._planes=[],this.dictionaryVar=new Map}this._isPlaneSet=!1,this._assetUpdateCounter=this._assetUpdateCounter+1,this.reset()}getLandscapeWidth(){let e=0,t=0;for(;t<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(t)===Xs.PLANE_LANDSCAPE){const r=this._roomPlaneParser.getPlaneLeftSide(t);e+=r.length}t++}return e}getLandscapeHeight(){let e=0,t=0;for(;t<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(t)===Xs.PLANE_LANDSCAPE){const r=this._roomPlaneParser.getPlaneRightSide(t);r.length>e&&(e=r.length)}t++}return e>5&&(e=5),e}updatePlaneVisibility(e,t,i){return e===this._typeVisibility[rs.TYPE_FLOOR]&&t===this._typeVisibility[rs.TYPE_WALL]&&i===this._typeVisibility[rs.TYPE_LANDSCAPE]?!1:(this._typeVisibility[rs.TYPE_FLOOR]=e,this._typeVisibility[rs.TYPE_WALL]=t,this._typeVisibility[rs.TYPE_LANDSCAPE]=i,this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],!0)}updateSprite(e,t,i,r,n){const o=i.offset;e.offsetX=-o.x,e.offsetY=-o.y,e.relativeDepth=n,e.color=i.color,e.texture=i.bitmapData,e.name=r+"_"+this._assetUpdateCounter}};Es.FLOOR_COLOR=16777215,Es.FLOOR_COLOR_LEFT=14540253,Es.FLOOR_COLOR_RIGHT=12303291,Es.LANDSCAPE_COLOR_TOP=16777215,Es.LANDSCAPE_COLOR_SIDE=13421772,Es.LANDSCAPE_COLOR_BOTTOM=10066329,Es.WALL_COLOR_TOP=16777215,Es.WALL_COLOR_SIDE=13421772,Es.WALL_COLOR_BOTTOM=10066329,Es.WALL_COLOR_BORDER=10066329,Es.ROOM_DEPTH_OFFSET=1e3;let tm=Es;class mee extends gi{constructor(){super(),this._tileHeight=0}getLayerYOffset(e,t,i){return i===1?(this._tileHeight=this.object.model.getValue(D.TILE_CURSOR_HEIGHT),-this._tileHeight*32):super.getLayerYOffset(e,t,i)}}class fee extends iT{constructor(){super(),this._planeParser=new vi,this._planeBitmapMaskParser=new fG,this._color=16777215,this._light=255,this._originalColor=16777215,this._originalLight=255,this._targetColor=16777215,this._targetLight=255,this._colorChangedTime=0,this._colorTransitionLength=1500,this._lastHoleUpdate=0,this._needsMapUpdate=!1,this._skipColorTransition=!1}getEventTypes(){const e=[rt.MOUSE_MOVE,rt.CLICK];return this.mergeTypes(super.getEventTypes(),e)}dispose(){super.dispose(),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null),this._planeBitmapMaskParser&&(this._planeBitmapMaskParser.dispose(),this._planeBitmapMaskParser=null)}initialize(e){!e||!this.object||e instanceof mG&&this._planeParser.initializeFromMapData(e)&&(this.object.model.setValue(D.ROOM_MAP_DATA,e),this.object.model.setValue(D.ROOM_BACKGROUND_COLOR,16777215),this.object.model.setValue(D.ROOM_FLOOR_VISIBILITY,1),this.object.model.setValue(D.ROOM_WALL_VISIBILITY,1),this.object.model.setValue(D.ROOM_LANDSCAPE_VISIBILITY,1),this._skipColorTransition=st.getValue("room.color.skip.transition")===!0)}update(e){if(super.update(e),this.updateBackgroundColor(e),this._needsMapUpdate){if(this._lastHoleUpdate&&e-this._lastHoleUpdate<5)return;const t=this.object&&this.object.model;if(t){const i=this._planeParser.getMapData();t.setValue(D.ROOM_MAP_DATA,i),t.setValue(D.ROOM_FLOOR_HOLE_UPDATE_TIME,e),this._planeParser.initializeFromMapData(i)}this._lastHoleUpdate=0,this._needsMapUpdate=!1}}processUpdateMessage(e){if(!e||!this.object)return;const t=this.object.model;if(t){if(e instanceof Xi){this.onObjectRoomUpdateMessage(e,t);return}if(e instanceof xr){this.onObjectRoomMaskUpdateMessage(e,t);return}if(e instanceof xl){this.onObjectRoomPlaneVisibilityUpdateMessage(e,t);return}if(e instanceof Rl){this.onObjectRoomPlanePropertyUpdateMessage(e,t);return}if(e instanceof wn){this.onObjectRoomFloorHoleUpdateMessage(e,t);return}if(e instanceof Qg){this.onObjectRoomColorUpdateMessage(e,t);return}e instanceof bp&&this.onObjectRoomMapUpdateMessage(e)}}mouseEvent(e,t){if(!e||!t||!this.object||!this.object.model)return;const i=e.spriteTag;let r=0;if(i&&i.indexOf("@")>=0&&(r=parseInt(i.substr(i.indexOf("@")+1))),r<1||r>this._planeParser.planeCount){e.type===Re.ROLL_OUT&&this.object.model.setValue(D.ROOM_SELECTED_PLANE,0);return}r--;let n=null;const o=this._planeParser.getPlaneLocation(r),l=this._planeParser.getPlaneLeftSide(r),c=this._planeParser.getPlaneRightSide(r),u=this._planeParser.getPlaneNormalDirection(r),d=this._planeParser.getPlaneType(r);if(o==null||l==null||c==null||u==null)return;const _=l.length,m=c.length;if(_==0||m==0)return;const f=e.screenX,E=e.screenY,I=new ot(f,E);if(n=t.getPlanePosition(I,o,l,c),!n){this.object.model.setValue(D.ROOM_SELECTED_PLANE,0);return}const p=Y.product(l,n.x/_);p.add(Y.product(c,n.y/m)),p.add(o);const S=p.x,R=p.y,O=p.z;if(n.x>=0&&n.x<_&&n.y>=0&&n.y<m)this.object.model.setValue(D.ROOM_SELECTED_X,S),this.object.model.setValue(D.ROOM_SELECTED_Y,R),this.object.model.setValue(D.ROOM_SELECTED_Z,O),this.object.model.setValue(D.ROOM_SELECTED_PLANE,r+1);else{this.object.model.setValue(D.ROOM_SELECTED_PLANE,0);return}let C=null;switch(e.type===Re.MOUSE_MOVE||e.type===Re.ROLL_OVER?C=rt.MOUSE_MOVE:e.type===Re.MOUSE_CLICK?C=rt.CLICK:e.type===Re.MOUSE_DOWN&&(C=rt.MOUSE_DOWN),e.type){case Re.MOUSE_MOVE:case Re.ROLL_OVER:case Re.MOUSE_DOWN:case Re.MOUSE_CLICK:{let A=null;if(d===Xs.PLANE_FLOOR)A=new Ta(C,this.object,e.eventId,S,R,O,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);else if(d===Xs.PLANE_WALL||d===Xs.PLANE_LANDSCAPE){let b=90;u&&(b=u.x+90,b>360&&(b-=360));const y=l.length*n.x/_,M=c.length*n.y/m;A=new ph(C,this.object,e.eventId,o,l,c,y,M,b,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown)}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(A);return}}}updateBackgroundColor(e){if(!this.object||!this._colorChangedTime)return;let t=this._color,i=this._light;if(e-this._colorChangedTime>=this._colorTransitionLength)t=this._targetColor,i=this._targetLight,this._colorChangedTime=0;else{let n=this._originalColor>>16&255,o=this._originalColor>>8&255,l=this._originalColor&255;const c=this._targetColor>>16&255,u=this._targetColor>>8&255,d=this._targetColor&255,_=(e-this._colorChangedTime)/this._colorTransitionLength;n=n+(c-n)*_,o=o+(u-o)*_,l=l+(d-l)*_,t=(n<<16)+(o<<8)+l,i=this._originalLight+(this._targetLight-this._originalLight)*_,this._color=t,this._light=i}let r=Ri.rgbToHSL(t);r=(r&16776960)+i,t=Ri.hslToRGB(r),this.object.model&&this.object.model.setValue(D.ROOM_BACKGROUND_COLOR,t)}onObjectRoomUpdateMessage(e,t){switch(e.type){case Xi.ROOM_FLOOR_UPDATE:t.setValue(D.ROOM_FLOOR_TYPE,e.value);return;case Xi.ROOM_WALL_UPDATE:t.setValue(D.ROOM_WALL_TYPE,e.value);return;case Xi.ROOM_LANDSCAPE_UPDATE:t.setValue(D.ROOM_LANDSCAPE_TYPE,e.value);return}}onObjectRoomMaskUpdateMessage(e,t){let i=null,r=!1;switch(e.type){case xr.ADD_MASK:i=Zu.WINDOW,e.maskCategory===xr.HOLE&&(i=Zu.HOLE),this._planeBitmapMaskParser.addMask(e.maskId,e.maskType,e.maskLocation,i),r=!0;break;case xr.REMOVE_MASK:r=this._planeBitmapMaskParser.removeMask(e.maskId);break}r&&t.setValue(D.ROOM_PLANE_MASK_XML,this._planeBitmapMaskParser.getXML())}onObjectRoomPlaneVisibilityUpdateMessage(e,t){let i=0;switch(e.visible&&(i=1),e.type){case xl.FLOOR_VISIBILITY:t.setValue(D.ROOM_FLOOR_VISIBILITY,i);break;case xl.WALL_VISIBILITY:t.setValue(D.ROOM_WALL_VISIBILITY,i),t.setValue(D.ROOM_LANDSCAPE_VISIBILITY,i);break}const r=this.object.visualization;r instanceof tm&&r.updatePlaneTexturesAndVisibilities(t)}onObjectRoomPlanePropertyUpdateMessage(e,t){switch(e.type){case Rl.FLOOR_THICKNESS:t.setValue(D.ROOM_FLOOR_THICKNESS,e.value);break;case Rl.WALL_THICKNESS:t.setValue(D.ROOM_WALL_THICKNESS,e.value);break}const i=this.object.visualization;i instanceof tm&&i.updateThickness(t)}onObjectRoomFloorHoleUpdateMessage(e,t){switch(e.type){case wn.ADD:this._planeParser.addFloorHole(e.id,e.x,e.y,e.width,e.height,e.invert),this._needsMapUpdate=!0;break;case wn.REMOVE:this._planeParser.removeFloorHole(e.id),this._needsMapUpdate=!0;break}this._lastHoleUpdate=this.time}onObjectRoomColorUpdateMessage(e,t){!e||!t||(this._originalColor=this._color,this._originalLight=this._light,this._targetColor=e.color,this._targetLight=e.light,this._colorChangedTime=this.time,this._skipColorTransition?this._colorTransitionLength=0:this._colorTransitionLength=1500,t.setValue(D.ROOM_COLORIZE_BG_ONLY,e.backgroundOnly))}onObjectRoomMapUpdateMessage(e){!e||!e.mapData||(this.object.model.setValue(D.ROOM_MAP_DATA,e.mapData),this.object.model.setValue(D.ROOM_FLOOR_HOLE_UPDATE_TIME,this.time),this._planeParser.initializeFromMapData(e.mapData))}}class pee extends iT{initialize(e){this.object&&(this.object.model.setValue(D.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(1,0))}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof Ol&&this.object)switch(e.type){case Ol.ENABLED:this.object.setState(0,0);return;case Ol.DISABLED:this.object.setState(1,0);return}}}const ml=class ml extends iT{constructor(){super(),this._lastEventId=null,this._isHidden=!1}initialize(e){this.object&&(this.object.model.setValue(D.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(ml.CURSOR_HIDDEN_STATE,0))}processUpdateMessage(e){e instanceof Eh&&(this._lastEventId&&this._lastEventId===e.sourceEventId||(e.toggleVisibility&&(this._isHidden=!this._isHidden),super.processUpdateMessage(e),this.object&&(this._isHidden?this.object.setState(ml.CURSOR_HIDDEN_STATE,0):e.visible?(this.object.model.setValue(D.TILE_CURSOR_HEIGHT,e.height),this.object.setState(ml.CURSOR_VISIBLE_STATE)):this.object.setState(ml.CURSOR_HIDDEN_STATE,0)),this._lastEventId=e.sourceEventId))}};ml.CURSOR_VISIBLE_STATE=0,ml.CURSOR_HIDDEN_STATE=1,ml.CURSOR_HEIGHT_STATE=6;let wO=ml;const FI=class FI{constructor(){this._visualizationDatas=new Map}getVisualization(e){const t=this.getVisualizationType(e);return t?new t:null}getVisualizationType(e){if(!e)return null;let t=null;switch(e){case Ue.ROOM:t=tm;break;case Ue.TILE_CURSOR:t=mee;break;case Ue.USER:case Ue.BOT:case Ue.RENTABLE_BOT:t=_O;break;case Ue.PET_ANIMATED:t=MO;break;case Ue.FURNITURE_STATIC:t=Dl;break;case Ue.FURNITURE_ANIMATED:t=gi;break;case Ue.FURNITURE_RESETTING_ANIMATED:t=see;break;case Ue.FURNITURE_BADGE_DISPLAY:t=gO;break;case Ue.FURNITURE_BG:t=iee;break;case Ue.FURNITURE_BB:t=SG;break;case Ue.FURNITURE_ISOMETRIC_BB:t=ZZ;break;case Ue.FURNITURE_BOTTLE:t=mO;break;case Ue.FURNITURE_BUILDER_PLACEHOLDER:t=qZ;break;case Ue.FURNITURE_COUNTER_CLOCK:t=fO;break;case Ue.FURNITURE_CUBOID:t=XZ;break;case Ue.FURNITURE_EXTERNAL_IMAGE:t=$Z;break;case Ue.FURNITURE_FIREWORKS:t=xG;break;case Ue.FURNITURE_GIFT_WRAPPED_FIREWORKS:t=EO;break;case Ue.FURNITURE_GIFT_WRAPPED:t=JZ;break;case Ue.FURNITURE_GUILD_CUSTOMIZED:t=IO;break;case Ue.FURNITURE_GUILD_ISOMETRIC_BADGE:t=TO;break;case Ue.FURNITURE_HABBOWHEEL:t=SO;break;case Ue.FURNITURE_MANNEQUIN:t=xO;break;case Ue.FURNITURE_PARTY_BEAMER:t=OO;break;case Ue.FURNITURE_PLANET_SYSTEM:t=eee;break;case Ue.FURNITURE_POSTER:t=tee;break;case Ue.FURNITURE_QUEUE_TILE:t=NO;break;case Ue.FURNITURE_SCORE_BOARD:t=AO;break;case Ue.FURNITURE_SOUNDBLOCK:t=ree;break;case Ue.FURNITURE_STICKIE:t=nee;break;case Ue.FURNITURE_VAL_RANDOMIZER:t=bO;break;case Ue.FURNITURE_VOTE_COUNTER:t=vO;break;case Ue.FURNITURE_VOTE_MAJORITY:t=yO;break;case Ue.FURNITURE_WATER_AREA:t=aee;break;case Ue.FURNITURE_YOUTUBE:t=DO;break}return t||(ze.log("Unknown Visualization",e),null)}getVisualizationData(e,t,i){const r=this._visualizationDatas.get(e);if(r)return r;let n=null;switch(t){case Ue.FURNITURE_STATIC:case Ue.FURNITURE_GIFT_WRAPPED:case Ue.FURNITURE_BB:case Ue.FURNITURE_ISOMETRIC_BB:case Ue.FURNITURE_BG:case Ue.FURNITURE_STICKIE:case Ue.FURNITURE_BUILDER_PLACEHOLDER:n=new Uo;break;case Ue.FURNITURE_ANIMATED:case Ue.FURNITURE_RESETTING_ANIMATED:case Ue.FURNITURE_POSTER:case Ue.FURNITURE_HABBOWHEEL:case Ue.FURNITURE_VAL_RANDOMIZER:case Ue.FURNITURE_BOTTLE:case Ue.FURNITURE_PLANET_SYSTEM:case Ue.FURNITURE_QUEUE_TILE:case Ue.FURNITURE_PARTY_BEAMER:case Ue.FURNITURE_COUNTER_CLOCK:case Ue.FURNITURE_WATER_AREA:case Ue.FURNITURE_SCORE_BOARD:case Ue.FURNITURE_FIREWORKS:case Ue.FURNITURE_GIFT_WRAPPED_FIREWORKS:case Ue.FURNITURE_GUILD_CUSTOMIZED:case Ue.FURNITURE_GUILD_ISOMETRIC_BADGE:case Ue.FURNITURE_VOTE_COUNTER:case Ue.FURNITURE_VOTE_MAJORITY:case Ue.FURNITURE_SOUNDBLOCK:case Ue.FURNITURE_BADGE_DISPLAY:case Ue.FURNITURE_EXTERNAL_IMAGE:case Ue.FURNITURE_YOUTUBE:case Ue.TILE_CURSOR:n=new vN;break;case Ue.FURNITURE_MANNEQUIN:n=new RO;break;case Ue.ROOM:n=new CG;break;case Ue.USER:case Ue.BOT:case Ue.RENTABLE_BOT:n=new Dp;break;case Ue.PET_ANIMATED:n=new OG;break}return n?n.initialize(i)?((n instanceof Dp||n instanceof RO)&&(n.avatarManager=De.instance.avatar),FI.CACHING_ENABLED&&this._visualizationDatas.set(e,n),n):(n.dispose(),null):null}};FI.CACHING_ENABLED=!0;let FO=FI;const Bs=class Bs{constructor(e){this.tileXInit=0,this.tileYInit=0,this.tileXEnd=0,this.tileYEnd=0,this._highlightRootX=0,this._highlightRootY=0,this._highlightWidth=0,this._highlightHeight=0,this._highlightType="highlight_brighten",this.selection=Bs.NOT_ACTIVE,this._roomEngine=e}get areaSelectionState(){return this.selection}static createHighlightFilters(){const e={},t=new Gu,i=new Gu,r=new Gu;return t.matrix=[1.5,0,0,0,0,0,1.5,0,0,20,0,0,1.5,0,20,0,0,0,1,0],i.matrix=[1.05,0,0,0,0,0,1.3,0,0,8,0,0,1.8,0,20,0,0,0,1,0],r.matrix=[.55,0,0,0,-10,0,.55,0,0,-10,0,0,.55,0,-10,0,0,0,1,0],e.highlight_brighten=[t],e.highlight_blue=[i],e.highlight_darken=[r],e}startSelecting(){this.selection==Bs.NOT_SELECTING_AREA&&(this.clearHighlightSilent(),this.selection=Bs.AWAITING_MOUSE_DOWN,this._roomEngine.setMoveBlocked(!0))}handleTileMouseEvent(e){let t=0,i=0,r=0,n=0,o=this.selection==Bs.AWAITING_MOUSE_DOWN&&e.type==rt.MOUSE_DOWN;e.shiftKey&&this.selection==Bs.NOT_SELECTING_AREA&&e.type==rt.MOUSE_DOWN&&(this.startSelecting(),o=!0),o?(this.selection=Bs.SELECTING,this.tileXInit=e.tileXAsInt,this.tileYInit=e.tileYAsInt,this.tileXEnd=e.tileXAsInt,this.tileYEnd=e.tileYAsInt,this.setHighlight(this.tileXInit,this.tileYInit,1,1)):this.selection==Bs.SELECTING&&e.type==rt.MOUSE_MOVE&&(e.tileXAsInt!=this.tileXEnd||e.tileYAsInt!=this.tileYEnd)&&(this.tileXEnd=e.tileXAsInt,this.tileYEnd=e.tileYAsInt,this.tileXEnd>this.tileXInit?(t=this.tileXInit,r=this.tileXEnd-this.tileXInit+1):(t=this.tileXEnd,r=this.tileXInit-this.tileXEnd+1),this.tileYEnd>this.tileYInit?(i=this.tileYInit,n=this.tileYEnd-this.tileYInit+1):(i=this.tileYEnd,n=this.tileYInit-this.tileYEnd+1),this.setHighlight(t,i,r,n))}finishSelecting(){return this.selection==Bs.SELECTING?(this.selection=Bs.NOT_SELECTING_AREA,this._roomEngine.setMoveBlocked(!1),this._callback!=null&&this._callback(this._highlightRootX,this._highlightRootY,this._highlightWidth,this._highlightHeight),!0):!1}clearHighlight(){this.selection!=Bs.NOT_ACTIVE&&(this.clearHighlightSilent(),this.selection=Bs.NOT_SELECTING_AREA,this._roomEngine.setMoveBlocked(!1),this._callback!=null&&this._callback(0,0,0,0))}setHighlight(e,t,i,r){if(this.selection==Bs.NOT_ACTIVE)return;this._highlightRootX=e,this._highlightRootY=t,this._highlightWidth=i,this._highlightHeight=r;let n;(n=this._roomEngine.getRoomObject(this._roomEngine.activeRoomId,-1,0))!=null&&n.visualization.initializeHighlightArea(e,t,i,r,Bs.HIGHLIGHT_FILTERS[this._highlightType])}activate(e,t="highlight_brighten"){return this.selection!=Bs.NOT_ACTIVE?!1:(this._callback=e,this._highlightType=t,this.getAllFurnis().forEach(i=>{const r=i.visualization;r&&(r.lookTrough=!0)}),this.selection=Bs.NOT_SELECTING_AREA,!0)}deactivate(){this.selection!=Bs.NOT_ACTIVE&&(this._callback=null,this.getAllFurnis().forEach(e=>{const t=e.visualization;t&&(t.lookTrough=!1)}),this.clearHighlight(),this.selection=Bs.NOT_ACTIVE)}onRoomObjectAdded(e){if(this.selection===Bs.NOT_ACTIVE||e.roomId!==this._roomEngine.activeRoomId||e.type!==ke.ADDED||e.category!==10&&e.category!==20)return;const t=this._roomEngine.getRoomObject(e.roomId,e.objectId,e.category);if(!t)return;const i=t.visualization;i&&(i.lookTrough=!0)}getAllFurnis(){return this._roomEngine.getRoomObjects(this._roomEngine.activeRoomId,20).concat(this._roomEngine.getRoomObjects(this._roomEngine.activeRoomId,10))}clearHighlightSilent(){let e=null;const t=this._roomEngine.getRoomObject(this._roomEngine.activeRoomId,-1,0);t!=null&&(e=t.visualization,e.clearHighlightArea())}};Bs.NOT_ACTIVE=0,Bs.NOT_SELECTING_AREA=1,Bs.AWAITING_MOUSE_DOWN=2,Bs.SELECTING=3,Bs.HIGHLIGHT_FILTERS=Bs.createHighlightFilters();let Cd=Bs;const vn=class vn{};vn.ROOM_MIN_X="room_min_x",vn.ROOM_MAX_X="room_max_x",vn.ROOM_MIN_Y="room_min_y",vn.ROOM_MAX_Y="room_max_y",vn.ROOM_IS_PUBLIC="room_is_public",vn.ROOM_Z_SCALE="room_z_scale",vn.AD_DISPLAY_DELAY="ad_display_delay",vn.IS_PLAYING_GAME="is_playing_game",vn.RESTRICTS_DRAGGING="restricts_dragging",vn.RESTRICTS_SCALING="restricts_scaling",vn.RESTRICTED_SCALE="room_scale";let Vs=vn;class Eee{constructor(e,t){this._width=e,this._height=t,this._heights=[],this._isNotStackable=[],this._isRoomTile=[];let i=e*t;for(;i>0;)this._heights.push(0),this._isNotStackable.push(!1),this._isRoomTile.push(!1),i--}dispose(){this._width=0,this._height=0,this._height=null,this._isNotStackable=null,this._isRoomTile=null}validPosition(e,t){return e>=0&&e<this._width&&t>=0&&t<this._height}getTileHeight(e,t){return this.validPosition(e,t)?this._heights[t*this._width+e]:0}setTileHeight(e,t,i){this.validPosition(e,t)&&(this._heights[t*this._width+e]=i)}setStackingBlocked(e,t,i){this.validPosition(e,t)&&(this._isNotStackable[t*this._width+e]=i)}setIsRoomTile(e,t,i){this.validPosition(e,t)&&(this._isRoomTile[t*this._width+e]=i)}validateLocation(e,t,i,r,n,o,l,c,u,d=-1){return this.validPosition(e,t)}get width(){return this._width}get height(){return this._height}}const yn=class yn{constructor(){this._isDisposed=!1,this._scale=64,this._heightMap=[],this._width=0,this._height=0,this._floorHeight=0}get disposed(){return this._isDisposed}get scale(){return this._scale}set scale(e){this._scale=e}dispose(){this.reset(),this._isDisposed=!0}initialize(e,t,i){if(e<=this._width&&t<=this._height){this._width=e,this._height=t,this._floorHeight=i;return}this.reset();let r=0;for(;r<t;){const n=[];this._heightMap.push(n);let o=0;for(;o<e;)n.push(0),o++;r++}this._width=e,this._height=t,this._floorHeight=i}reset(){this._heightMap=[]}setHeight(e,t,i){if(e<0||e>=this._width||t<0||t>=this._height)return!1;const r=this._heightMap[t];return r?(r[e]=i,!0):!1}getHeight(e,t){if(e<0||e>=this._width||t<0||t>=this._height)return 0;const i=this._heightMap[t];return i?i[e]:0}getLocation(e,t,i,r,n){if(e==0&&t==0){e=this._width,t=this._height;const d=Math.round(this.scale/10);if(n==yn.R){let _=this._width-1;for(;_>=0;){let m=1;for(;m<this._height;){if(this.getHeight(_,m)<=this._floorHeight){m-1<t&&(e=_,t=m-1);break}m++}_--}r=r+(this.scale/4-d/2),i=i+this.scale/2}else{let _=this._height-1;for(;_>=0;){let m=1;for(;m<this._width;){if(this.getHeight(m,_)<=this._floorHeight){m-1<e&&(e=m-1,t=_);break}m++}_--}r=r+(this.scale/4-d/2),i=i-d}}let o=e,l=t,c=this.getHeight(e,t);return n==yn.R?(o=o+(i/(this._scale/2)-.5),l=l+.5,c=c-(r-i/2)/(this._scale/2)):(l=l+((this._scale/2-i)/(this._scale/2)-.5),o=o+.5,c=c-(r-(this._scale/2-i)/2)/(this._scale/2)),new Y(o,l,c)}getLocationOldFormat(e,t,i){let r,n,o=0,l=0;n=Math.ceil(e),o=n-e;let c,u,d,_=0;for(r=0;r<this._width;){if(n>=0&&n<this._height){if(this.getHeight(r,n)<=this._floorHeight){c=r-1,u=n,l=r,i=yn.L;break}if(this.getHeight(r,n+1)<=this._floorHeight){c=r,u=n,l=u-e,i=yn.R;break}}n++,r++}const m=this.scale/2*o;let f=-l*this.scale/2;return f=f+-t*18/32*this.scale/2,_=this.getHeight(c,u),d=_*this.scale/2+f,i==yn.R?d=d+o*this.scale/4:d=d+(1-o)*this.scale/4,this.getLocation(c,u,m,d,i)}getOldLocation(e,t){if(e==null)return null;let i=0,r=0,n=0,o=0,l="",c=0;if(t==90)i=Math.floor(e.x-.5),r=Math.floor(e.y+.5),c=this.getHeight(i,r),n=this._scale/2-(e.y-r+.5)*(this._scale/2),o=(c-e.z)*(this._scale/2)+(this._scale/2-n)/2,l=yn.L;else if(t==180)i=Math.floor(e.x+.5),r=Math.floor(e.y-.5),c=this.getHeight(i,r),n=(e.x+.5-i)*(this._scale/2),o=(c-e.z)*(this._scale/2)+n/2,l=yn.R;else return null;return[i,r,n,o,l]}getOldLocationString(e,t){const i=this.getOldLocation(e,t);if(i==null)return null;const r=Math.trunc(i[0]),n=Math.trunc(i[1]),o=Math.trunc(i[2]),l=Math.trunc(i[3]),c=i[4];return":w="+r+","+n+" l="+o+","+l+" "+c}getDirection(e){return e==yn.R?180:90}getFloorAltitude(e,t){const i=this.getHeight(e,t),r=i+1;return i+(Math.trunc(this.getHeight(e-1,t-1))==r||Math.trunc(this.getHeight(e,t-1))==r||Math.trunc(this.getHeight(e+1,t-1))==r||Math.trunc(this.getHeight(e-1,t))==r||Math.trunc(this.getHeight(e+1,t))==r||Math.trunc(this.getHeight(e-1,t+1))==r||Math.trunc(this.getHeight(e,t+1))==r||Math.trunc(this.getHeight(e+1,t+1))==r?.5:0)}isRoomTile(e,t){return e>=0&&e<this._width&&t>=0&&t<this._height&&this._heightMap[t][e]>=0}};yn.DEFAULT_SCALE=32,yn.L="l",yn.R="r";let sm=yn;const kI=class kI{constructor(){this._targetId=-1,this._targetCategory=-2,this._targetLoc=null,this._moveDistance=0,this._previousMoveSpeed=0,this._maintainPreviousMoveSpeed=!1,this._currentLoc=null,this._limitedLocX=!1,this._limitedLocY=!1,this._centeredLocX=!1,this._centeredLocY=!1,this._screenWd=0,this._screenHt=0,this._scale=0,this._roomWd=0,this._roomHt=0,this._geometryUpdateId=-1,this._scaleChanged=!1,this._targetObjectLoc=new Y}get location(){return this._currentLoc}get targetId(){return this._targetId}set targetId(e){this._targetId=e}get targetCategory(){return this._targetCategory}set targetCategory(e){this._targetCategory=e}get targetObjectLoc(){return this._targetObjectLoc}set targetObjectLoc(e){this._targetObjectLoc.assign(e)}get limitedLocationX(){return this._limitedLocX}set limitedLocationX(e){this._limitedLocX=e}get limitedLocationY(){return this._limitedLocY}set limitedLocationY(e){this._limitedLocY=e}get centeredLocX(){return this._centeredLocX}set centeredLocX(e){this._centeredLocX=e}get centeredLocY(){return this._centeredLocY}set centeredLocY(e){this._centeredLocY=e}get screenWd(){return this._screenWd}set screenWd(e){this._screenWd=e}get screenHt(){return this._screenHt}set screenHt(e){this._screenHt=e}get scale(){return this._scale}set scale(e){this._scale!=e&&(this._scale=e,this._scaleChanged=!0)}get roomWd(){return this._roomWd}set roomWd(e){this._roomWd=e}get roomHt(){return this._roomHt}set roomHt(e){this._roomHt=e}get geometryUpdateId(){return this._geometryUpdateId}set geometryUpdateId(e){this._geometryUpdateId=e}get isMoving(){return this._targetLoc!=null&&this._currentLoc!=null}set target(e){let t;this._targetLoc==null&&(this._targetLoc=new Y),(this._targetLoc.x!=e.x||this._targetLoc.y!=e.y||this._targetLoc.z!=e.z)&&(this._targetLoc.assign(e),t=Y.dif(this._targetLoc,this._currentLoc),this._moveDistance=t.length,this._maintainPreviousMoveSpeed=!0)}dispose(){this._targetLoc=null,this._currentLoc=null}initializeLocation(e){this._currentLoc==null&&(this._currentLoc=new Y,this._currentLoc.assign(e))}resetLocation(e){this._currentLoc==null&&(this._currentLoc=new Y),this._currentLoc.assign(e)}update(e,t){let i,r,n,o,l;if(this._followDuration>0&&this._targetLoc!=null&&this._currentLoc!=null){if(this._scaleChanged){this._scaleChanged=!1,this._currentLoc=this._targetLoc,this._targetLoc=null;return}i=Y.dif(this._targetLoc,this._currentLoc),i.length>this._moveDistance&&(this._moveDistance=i.length),i.length<=t?(this._currentLoc=this._targetLoc,this._targetLoc=null,this._previousMoveSpeed=0):(r=Math.sin(Math.PI*i.length/this._moveDistance),n=t*.5,o=this._moveDistance/kI.MOVE_SPEED_DENOMINATOR,l=n+(o-n)*r,this._maintainPreviousMoveSpeed&&(l<this._previousMoveSpeed?(l=this._previousMoveSpeed,l>i.length&&(l=i.length)):this._maintainPreviousMoveSpeed=!1),this._previousMoveSpeed=l,i.divide(i.length),i.multiply(l),this._currentLoc=Y.sum(this._currentLoc,i))}}reset(){this._geometryUpdateId=-1}activateFollowing(e){this._followDuration=e}};kI.MOVE_SPEED_DENOMINATOR=12;let kO=kI;class qb{constructor(e,t){this._roomId=e,this._data=t,this._floorType=null,this._wallType=null,this._landscapeType=null}get roomId(){return this._roomId}get data(){return this._data}get floorType(){return this._floorType}set floorType(e){this._floorType=e}get wallType(){return this._wallType}set wallType(e){this._wallType=e}get landscapeType(){return this._landscapeType}set landscapeType(e){this._landscapeType=e}}class $T{constructor(e,t,i,r,n,o,l,c=NaN,u=-1,d=0,_=0,m="",f=!0,E=!0,I=-1,p=10,S=!0){this._id=e,this._typeId=t,this._type=i,this._state=o,this._data=l,this._extra=c,this._expiryTime=u,this._usagePolicy=d,this._ownerId=_,this._ownerName=m,this._synchronized=f,this._realRoomObject=E,this._sizeZ=I,this._opacity=p,this._clickable=S,this._location=new Y,this._direction=new Y,this._location.assign(r),this._direction.assign(n)}get id(){return this._id}get typeId(){return this._typeId}get type(){return this._type}get location(){return this._location}get direction(){return this._direction}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}get expiryTime(){return this._expiryTime}get usagePolicy(){return this._usagePolicy}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get synchronized(){return this._synchronized}get realRoomObject(){return this._realRoomObject}get sizeZ(){return this._sizeZ}get opacity(){return this._opacity}get clickable(){return this._clickable}}class Iee{constructor(e,t){this._tileObjectMap=new Map;let i=0;for(;i<t;)this._tileObjectMap.set(i,new Map),i++;this._width=e,this._height=t}clear(){for(const e of this._tileObjectMap.values())e&&e.clear();this._tileObjectMap.clear()}populate(e){this.clear();for(const t of e)this.addRoomObject(t)}dispose(){this._tileObjectMap=null,this._width=0,this._height=0}getObjectIntTile(e,t){if(e>=0&&e<this._width&&t>=0&&t<this._height){const i=this._tileObjectMap.get(t);if(i)return i.get(e)}return null}setObjectInTile(e,t,i){if(!i.isReady){ze.log("Assigning non initialized object to tile object map!");return}if(e>=0&&e<this._width&&t>=0&&t<this._height){const r=this._tileObjectMap.get(t);r&&r.set(e,i)}}addRoomObject(e){if(!e||!e.model||!e.isReady)return;const t=e.getLocation(),i=e.getDirection();if(!t||!i)return;let r=e.model.getValue(D.FURNITURE_SIZE_X),n=e.model.getValue(D.FURNITURE_SIZE_Y);r<1&&(r=1),n<1&&(n=1);const o=Math.trunc(i.x+45)%360/90;(o===1||o===3)&&([r,n]=[n,r]);let l=t.y;for(;l<t.y+n;){let c=t.x;for(;c<t.x+r;){const u=this.getObjectIntTile(c,l);(!u||u!==e&&u.getLocation().z<=t.z)&&this.setObjectInTile(c,l,e),c++}l++}}}class Tee{constructor(e){this._roomId=e,this._modelName=null,this._legacyGeometry=new sm,this._tileObjectMap=null,this._roomCamera=new kO,this._selectedObject=null,this._placedObject=null,this._furnitureStackingHeightMap=null,this._floorStack=new Map,this._wallStack=new Map,this._mouseButtonCursorOwners=[]}dispose(){}setModelName(e){this._modelName=e}setSelectedObject(e){this._selectedObject&&this._selectedObject.dispose(),this._selectedObject=e}setPlacedObject(e){this._placedObject&&this._placedObject.dispose(),this._placedObject=e}setFurnitureStackingHeightMap(e){this._furnitureStackingHeightMap&&this._furnitureStackingHeightMap.dispose(),this._furnitureStackingHeightMap=e,this._tileObjectMap&&this._tileObjectMap.dispose(),this._furnitureStackingHeightMap&&(this._tileObjectMap=new Iee(this._furnitureStackingHeightMap.width,this._furnitureStackingHeightMap.height))}addPendingFurnitureFloor(e){e&&(this._floorStack.delete(e.id),this._floorStack.set(e.id,e))}removePendingFunitureFloor(e){const t=this._floorStack.get(e);return t?(this._floorStack.delete(e),t):null}getPendingFurnitureFloor(e){const t=this._floorStack.get(e);return t?(this._floorStack.delete(e),t):null}getNextPendingFurnitureFloor(){if(!this._floorStack.size)return null;const e=this._floorStack.keys();return this.getPendingFurnitureFloor(e.next().value)}addPendingFurnitureWall(e){e&&(this._wallStack.delete(e.id),this._wallStack.set(e.id,e))}removePendingFurnitureWall(e){const t=this._wallStack.get(e);return t?(this._wallStack.delete(e),t):null}getPendingFurnitureWall(e){const t=this._wallStack.get(e);return t?(this._wallStack.delete(e),t):null}getNextPendingFurnitureWall(){if(!this._wallStack.size)return null;const e=this._wallStack.keys();return this.getPendingFurnitureWall(e.next().value)}addButtonMouseCursorOwner(e){return this._mouseButtonCursorOwners.indexOf(e)===-1?(this._mouseButtonCursorOwners.push(e),!0):!1}removeButtonMouseCursorOwner(e){const t=this._mouseButtonCursorOwners.indexOf(e);return t>-1?(this._mouseButtonCursorOwners.splice(t,1),!0):!1}hasButtonMouseCursorOwners(){return this._mouseButtonCursorOwners.length>0}get roomId(){return this._roomId}get modelName(){return this._modelName}get legacyGeometry(){return this._legacyGeometry}get tileObjectMap(){return this._tileObjectMap}get roomCamera(){return this._roomCamera}get selectedObject(){return this._selectedObject}get placedObject(){return this._placedObject}get furnitureStackingHeightMap(){return this._furnitureStackingHeightMap}}class See{constructor(e,t){this._object=e,this._groupBadge=t}get object(){return this._object}get groupBadge(){return this._groupBadge}}class QT{constructor(e,t,i,r,n,o=0,l=null,c=null,u=-1,d=-1,_=null){this._id=0,this._category=0,this._operation="",this._loc=null,this._dir=null,this._typeId=0,this._instanceData=null,this._stuffData=null,this._state=-1,this._animFrame=-1,this._posture=null,this._id=e,this._category=t,this._operation=i,this._loc=new Y,this._loc.assign(r),this._dir=new Y,this._dir.assign(n),this._typeId=o,this._instanceData=l,this._stuffData=c,this._state=u,this._animFrame=d,this._posture=_}get id(){return this._id}get category(){return this._category}get operation(){return this._operation}get loc(){return this._loc}get dir(){return this._dir}get typeId(){return this._typeId}get instanceData(){return this._instanceData}get stuffData(){return this._stuffData}get state(){return this._state}get animFrame(){return this._animFrame}get posture(){return this._posture}dispose(){this._loc=null,this._dir=null}}const Yr=class Yr{constructor(){this.spriteCount=0,this.externalImageCount=0}static addMannequinSprites(e,t){const i=[];for(const r of e)if(r)if(r.type==="boutique_mannequin1"&&r.name.indexOf("mannequin_")===0){const n=t.getRoomObject(t.activeRoomId,r.objectId,Q.FLOOR);if(n){const o=n.visualization.getSpriteList();if(o)for(const l of o)l.x=l.x+(r.x+r.width/2+Yr.MANNEQUIN_MAGIC_X_OFFSET),l.y=l.y+(r.y+r.height+Yr.MANNEQUIN_MAGIC_Y_OFFSET),l.z=l.z+r.z,i.push(l)}}else i.push(r);return i}static sortSpriteDataObjects(e,t){return e.z<t.z?1:(e.z>t.z,-1)}static isSpriteInViewPort(e,t,i){return!0}static sortQuadPoints(e,t,i,r){const n=[];if(e.x==t.x?n.push(e,i,t,r):e.x==i.x?n.push(e,t,i,r):t.x<e.x&&t.y>e.y||t.x>e.x&&t.y<e.y?n.push(e,i,t,r):n.push(e,t,i,r),n[0].x<n[1].x){let o=n[0];n[0]=n[1],n[1]=o,o=n[2],n[2]=n[3],n[3]=o}if(n[0].y<n[2].y){let o=n[0];n[0]=n[2],n[2]=o,o=n[1],n[1]=n[3],n[3]=o}return n}getFurniData(e,t,i,r){const n=[];let o=t.getSortableSpriteList();const l=i.getRoomObjects(i.activeRoomId,Q.UNIT);for(const c of l)if(c.id!==r){const u=c.visualization.getSpriteList();if(u){let d=0,_=0;for(const f of o)if(f.name==="avatar_"+c.id){d=f.z,_=f.y+f.height-t.geometry.scale/4;break}const m=i.getRoomObjectScreenLocation(i.activeRoomId,c.id,Q.UNIT,t.id);if(m){_===0&&(_=m.y);for(const f of u)f.x=f.x+(m.x-t.screenOffsetX),f.y=f.y+_,f.z=f.z+d,(f.name.indexOf("h_std_fx29_")===0||f.name.indexOf("h_std_fx185_")===0)&&(f.y=f.y+Yr.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET),o.push(f)}}}o=Yr.addMannequinSprites(o,i),o.sort(Yr.sortSpriteDataObjects);for(const c of o)c.name!==null&&c.name.length>0&&c.name.indexOf("tile_cursor_")!==0&&Yr.isSpriteInViewPort(c,e,t)&&(r<0||c.objectId!=r)&&(n.push(this.getSpriteDataObject(c,e,t,i)),this.maxZ||(this.maxZ=c.z),this.spriteCount++);return JSON.stringify(n)}getRoomRenderingModifiers(e){return JSON.stringify(new Object)}getSpriteDataObject(e,t,i,r){let n=[];const o={};let l=e.name;return e.name.indexOf("@")!==-1&&(n=e.name.split("@"),l=n[0],n[1]),o.name=l,o.x=e.x-t.x,o.y=e.y-t.y,o.x=o.x+i.screenOffsetX,o.y=o.y+i.screenOffsetY,o.z=e.z,e.alpha&&e.alpha.toString()!=="255"&&(o.alpha=e.alpha),e.flipH&&(o.flipH=e.flipH),e.skew&&(o.skew=e.skew),e.frame&&(o.frame=e.frame),e.color&&e.color.length>0&&(o.color=parseInt(e.color)),e.blendMode&&e.blendMode!=="normal"&&(o.blendMode=e.blendMode),l.indexOf("http")===0&&(o.width=e.width,o.height=e.height,this.externalImageCount++,this.externalImageCount>Yr.MAX_EXTERNAL_IMAGE_COUNT&&(o.name="box")),e.posture&&(o.posture=e.posture),o}makeBackgroundPlane(e,t,i){const r=new ot(0,0),n=new ot(e.width,0),o=new ot(0,e.height),l=new ot(e.width,e.height),c=Yr.sortQuadPoints(r,n,o,l);let u=0;i.length>0?(u=i[0].z,this.maxZ&&(u=Math.max(this.maxZ,u))):u=this.maxZ?this.maxZ:0,u=u+(this.spriteCount*1.776104+i.length*2.31743);const d=new l_(null,t);return d.cornerPoints=c,d.z=u,d}sortRoomPlanes(e,t,i){const r=new Map;let n=1;this.maxZ&&(n=n+this.maxZ);for(const c of e){const u={plane:c,z:n};r.set(c.uniqueId,u)}const o=t.getPlaneSortableSprites();o.sort((c,u)=>u.z-c.z),o.reverse();let l=[];for(const c of o){const u=c.sprite;if(u){const d=r.get(u.id);d&&(r.delete(u.id),d.z=c.z,l.push(d))}}return l=l.concat(Array.from(r.values())),l}getRoomPlanes(e,t,i,r){const n=[],l=i.getRoomObject(i.activeRoomId,rm.ROOM_OBJECT_ID,Q.ROOM).visualization;if(l){const c=t.geometry,u=this.sortRoomPlanes(l.planes,t,i),d=di.instance.stage;for(const _ of u){const m=_.plane,f=[],E=Y.sum(m.location,m.leftSide),I=c.getScreenPoint(m.location),p=c.getScreenPoint(E),S=c.getScreenPoint(Y.sum(m.location,m.rightSide)),R=c.getScreenPoint(Y.sum(E,m.rightSide));f.push(I,p,S,R);let O=0,C=0;for(const A of f)A.x+=d.width/2,A.y+=d.height/2,A.x+=t.screenOffsetX,A.y+=t.screenOffsetY,A.x+=-e.x,A.y+=-e.y,A.x<0?O--:A.x>=e.width&&O++,A.y<0?C--:A.y>=e.height&&C++;if(!(Math.abs(O)===4||Math.abs(C)===4)){const A=Yr.sortQuadPoints(I,p,S,R);for(const b of m.getDrawingDatas(c))b.cornerPoints=A,b.z=_.z,n.push(b)}}n.unshift(this.makeBackgroundPlane(e,r,n))}return n}};Yr.MANNEQUIN_MAGIC_X_OFFSET=1,Yr.MANNEQUIN_MAGIC_Y_OFFSET=-16,Yr.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET=-52,Yr.MAX_EXTERNAL_IMAGE_COUNT=30;let GO=Yr;class Ree extends Qr{constructor(e){super(),this._connection=null,this._roomCreator=e,this._planeParser=new vi,this._latestEntryTileEvent=null,this._currentRoomId=0,this._ownUserId=0,this._initialConnection=!0,this._guideId=-1,this._requesterId=-1}get currentRoomId(){return this._currentRoomId}setConnection(e){this._connection||!e||(this._connection=e,this._connection.addMessageEvent(new Ld(this.onUserInfoEvent.bind(this))),this._connection.addMessageEvent(new jd(this.onRoomReadyMessageEvent.bind(this))),this._connection.addMessageEvent(new JR(this.onRoomPaintEvent.bind(this))),this._connection.addMessageEvent(new Zf(this.onRoomModelEvent.bind(this))),this._connection.addMessageEvent(new $R(this.onRoomHeightMapEvent.bind(this))),this._connection.addMessageEvent(new QR(this.onRoomHeightMapUpdateEvent.bind(this))),this._connection.addMessageEvent(new tp(this.onRoomThicknessEvent.bind(this))),this._connection.addMessageEvent(new ep(this.onRoomDoorEvent.bind(this))),this._connection.addMessageEvent(new PR(this.onRoomRollingEvent.bind(this))),this._connection.addMessageEvent(new aL(this.onWiredMovementsMessageEvent.bind(this))),this._connection.addMessageEvent(new LR(this.onObjectsDataUpdateEvent.bind(this))),this._connection.addMessageEvent(new VR(this.onFurnitureAliasesEvent.bind(this))),this._connection.addMessageEvent(new wR(this.onFurnitureFloorAddEvent.bind(this))),this._connection.addMessageEvent(new FR(this.onFurnitureFloorEvent.bind(this))),this._connection.addMessageEvent(new GR(this.onFurnitureFloorRemoveEvent.bind(this))),this._connection.addMessageEvent(new kR(this.onFurnitureFloorOpacityEvent.bind(this))),this._connection.addMessageEvent(new BR(this.onFurnitureFloorUpdateEvent.bind(this))),this._connection.addMessageEvent(new zR(this.onFurnitureWallAddEvent.bind(this))),this._connection.addMessageEvent(new KR(this.onFurnitureWallEvent.bind(this))),this._connection.addMessageEvent(new qR(this.onFurnitureWallRemoveEvent.bind(this))),this._connection.addMessageEvent(new XR(this.onFurnitureWallUpdateEvent.bind(this))),this._connection.addMessageEvent(new HR(this.onFurnitureDataEvent.bind(this))),this._connection.addMessageEvent(new WR(this.onItemDataUpdateMessageEvent.bind(this))),this._connection.addMessageEvent(new YR(this.onOneWayDoorStatusMessageEvent.bind(this))),this._connection.addMessageEvent(new np(this.onRoomUnitDanceEvent.bind(this))),this._connection.addMessageEvent(new ex(this.onRoomUnitEffectEvent.bind(this))),this._connection.addMessageEvent(new ap(this.onRoomUnitEvent.bind(this))),this._connection.addMessageEvent(new tx(this.onRoomUnitExpressionEvent.bind(this))),this._connection.addMessageEvent(new sx(this.onRoomUnitHandItemEvent.bind(this))),this._connection.addMessageEvent(new ix(this.onRoomUnitIdleEvent.bind(this))),this._connection.addMessageEvent(new op(this.onRoomUnitInfoEvent.bind(this))),this._connection.addMessageEvent(new rx(this.onRoomUnitNumberEvent.bind(this))),this._connection.addMessageEvent(new lp(this.onRoomUnitRemoveEvent.bind(this))),this._connection.addMessageEvent(new nx(this.onRoomUnitStatusEvent.bind(this))),this._connection.addMessageEvent(new jC(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new ip(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new rp(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new ZR(this.onRoomUnitTypingEvent.bind(this))),this._connection.addMessageEvent(new sp(this.onPetFigureUpdateEvent.bind(this))),this._connection.addMessageEvent(new qj(this.onPetExperienceEvent.bind(this))),this._connection.addMessageEvent(new Qj(this.onYouArePlayingGameEvent.bind(this))),this._connection.addMessageEvent(new UR(this.onDiceValueMessageEvent.bind(this))),this._connection.addMessageEvent(new GC(this.onIgnoreResultEvent.bind(this))),this._connection.addMessageEvent(new OC(this.onGuideSessionStartedMessageEvent.bind(this))),this._connection.addMessageEvent(new RC(this.onGuideSessionEndedMessageEvent.bind(this))),this._connection.addMessageEvent(new xC(this.onGuideSessionErrorMessageEvent.bind(this))),this._connection.addMessageEvent(new Kx(this.onAreaHide.bind(this))),this._connection.addMessageEvent(new qx(this.onObjectRemoveMultiple.bind(this))))}setRoomId(e){this._currentRoomId!==0&&this._roomCreator&&this._roomCreator.destroyRoom(this._currentRoomId),this._currentRoomId=e,this._latestEntryTileEvent=null}clearRoomId(){this._currentRoomId=0,this._latestEntryTileEvent=null}onWiredMovementsMessageEvent(e){if(!this._roomCreator)return;const t=e.getParser();t.userMoves.forEach(i=>this.onWiredUserMove(i)),t.furniMoves.forEach(i=>this.onWiredFurniMove(i)),t.wallItemMoves.forEach(i=>this.onWiredWallItemMove(i)),t.userDirUpdates.forEach(i=>this.onWiredUserDirectionUpdate(i))}onDispose(){super.onDispose(),this._connection=null,this._roomCreator=null,this._latestEntryTileEvent=null,this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}onUserInfoEvent(e){if(!(e instanceof Ld)||!e.connection)return;const t=e.getParser();t&&(this._ownUserId=t.userInfo.userId)}onRoomReadyMessageEvent(e){const t=e.getParser();if(this._currentRoomId!==t.roomId&&this.setRoomId(t.roomId),this._roomCreator&&this._roomCreator.setRoomInstanceModelName(t.roomId,t.name),this._initialConnection){e.connection.send(new dw),this._initialConnection=!1;return}e.connection.send(new Nx)}onRoomPaintEvent(e){if(!(e instanceof JR))return;const t=e.getParser();if(!t)return;const i=t.floorType,r=t.wallType,n=t.landscapeType;this._roomCreator&&this._roomCreator.updateRoomInstancePlaneType(this._currentRoomId,i,r,n)}onRoomModelEvent(e){if(!(e instanceof Zf)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const i=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!i)return;this._planeParser.reset();const r=t.width,n=t.height;this._planeParser.initializeTileMap(r,n);let o=null;this._latestEntryTileEvent&&(o=this._latestEntryTileEvent.getParser());let l=-1,c=-1,u=0,d=0,_=0;for(;_<n;){let E=0;for(;E<r;){const I=t.getHeight(E,_);(_>0&&_<n-1||E>0&&E<r-1)&&I!=vi.TILE_BLOCKED&&(o==null||E==o.x&&_==o.y)&&(t.getHeight(E,_-1)==vi.TILE_BLOCKED&&t.getHeight(E-1,_)==vi.TILE_BLOCKED&&t.getHeight(E,_+1)==vi.TILE_BLOCKED&&(l=E+.5,c=_,u=I,d=90),t.getHeight(E,_-1)==vi.TILE_BLOCKED&&t.getHeight(E-1,_)==vi.TILE_BLOCKED&&t.getHeight(E+1,_)==vi.TILE_BLOCKED&&(l=E,c=_+.5,u=I,d=180)),this._planeParser.setTileHeight(E,_,I),E++}_++}this._planeParser.setTileHeight(Math.floor(l),Math.floor(c),u),this._planeParser.initializeFromTileData(t.wallHeight),this._planeParser.setTileHeight(Math.floor(l),Math.floor(c),u+this._planeParser.wallHeight),t.scale===64?(this._planeParser.restrictsDragging=!0,this._planeParser.restrictsScaling=!0,this._planeParser.restrictedScale=.5):(this._planeParser.restrictsDragging=!1,this._planeParser.restrictsScaling=!1,this._planeParser.restrictedScale=1),i.scale=sm.DEFAULT_SCALE,i.initialize(r,n,this._planeParser.floorHeight);let m=t.height-1;for(;m>=0;){let E=t.width-1;for(;E>=0;)i.setHeight(E,m,this._planeParser.getTileHeight(E,m)),E--;m--}const f=this._planeParser.getMapData();f.doors.push({x:l,y:c,z:u,dir:d}),this._roomCreator.createRoomInstance(this._currentRoomId,f),t.areaHideData.forEach(E=>{this._roomCreator.updateAreaHide(this._currentRoomId,E.furniId,E.on,E.rootX,E.rootY,E.width,E.length,E.invert)})}onRoomHeightMapEvent(e){if(!(e instanceof $R)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const i=t.width,r=t.height,n=new Eee(i,r);let o=0;for(;o<r;){let l=0;for(;l<i;)n.setTileHeight(l,o,t.getTileHeight(l,o)),n.setStackingBlocked(l,o,t.getStackingBlocked(l,o)),n.setIsRoomTile(l,o,t.isRoomTile(l,o)),l++;o++}this._roomCreator.setFurnitureStackingHeightMap(this._currentRoomId,n)}onRoomHeightMapUpdateEvent(e){if(!(e instanceof QR)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const i=this._roomCreator.getFurnitureStackingHeightMap(this._currentRoomId);if(i){for(;t.next();)i.setTileHeight(t.x,t.y,t.tileHeight()),i.setStackingBlocked(t.x,t.y,t.isStackingBlocked()),i.setIsRoomTile(t.x,t.y,t.isRoomTile());this._roomCreator.refreshTileObjectMap(this._currentRoomId,"RoomMessageHandler.onRoomHeightMapUpdateEvent()")}}onRoomThicknessEvent(e){if(!(e instanceof tp))return;const t=e.getParser();if(!t)return;const i=!t.hideWalls,r=!0,n=t.thicknessWall,o=t.thicknessFloor,l=t.filter;this._roomCreator&&(this._roomCreator.updateRoomInstancePlaneVisibility(this._currentRoomId,i,r),this._roomCreator.updateRoomInstancePlaneThickness(this._currentRoomId,n,o),this._roomCreator.updateRoomInstancePlaneFilter(this._currentRoomId,l))}onAreaHide(e){if(!(e instanceof Kx))return;const t=e.getParser();if(!t)return;const i=t.areaHideMessageData;this._roomCreator&&this._roomCreator.updateAreaHide(this._currentRoomId,i.furniId,i.on,i.rootX,i.rootY,i.width,i.length,i.invert)}onObjectRemoveMultiple(e){if(!(e instanceof qx)||!this._roomCreator)return;const t=e.getParser();if(t){for(let i of t.ids)this._roomCreator.removeRoomObjectFloor(this._currentRoomId,i,-1,!1);this._roomCreator.refreshTileObjectMap(this._currentRoomId,"RoomEngine.onObjectRemoveMultiple()")}}onRoomDoorEvent(e){e instanceof ep&&(this._latestEntryTileEvent=e)}onRoomRollingEvent(e){if(!(e instanceof PR)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.rollerId,null,null,1,null),this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.rollerId,null,null,2,null);const i=t.itemsRolling;if(i&&i.length)for(const n of i)n&&this._roomCreator.rollRoomObjectFloor(this._currentRoomId,n.id,n.location,null,n.targetLocation);const r=t.unitRolling;if(r){this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,r.id,r.location,r.targetLocation);const n=this._roomCreator.getRoomObjectUser(this._currentRoomId,r.id);if(n&&n.type!==Ft.MONSTER_PLANT){let o="std";switch(r.movementType){case wa.MOVE:o="mv";break;case wa.SLIDE:const l=n.model.getValue(D.FIGURE_POSTURE);o=l==="mv"?"std":l;break}this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,r.id,o)}}}onWiredFurniMove(e){const t=new Y(e.rotation%8*45);this._roomCreator.rollRoomObjectFloor(this._currentRoomId,e.furniId,this.roundLocation(e.source),t,this.roundLocation(e.target),e.animationTime)}roundLocation(e){let t;if((t=this._roomCreator.getRoomGeometry(this._currentRoomId))==null)return e;let i;if((i=t.getScreenPosition(e))==null)return e;const r=new Y(e.x,e.y,e.z+.01),n=t.getScreenPosition(r);if(n==null)return e;let o;const l=((o=Number(i.y))-n.y)*100,c=o-Math.round(o),u=e.z+c/l;return new Y(e.x,e.y,u)}onWiredUserDirectionUpdate(e){const t=e.bodyDirection%8*45,i=new Y(t);this._roomCreator.updateRoomObjectUserDir(this._currentRoomId,e.userIndex,i,t)}onWiredWallItemMove(e){const t=this._roomCreator.getLegacyWallGeometry(this._currentRoomId),i=e.isDirectionRight?"r":"l",r=t.getLocation(e.oldWallX,e.oldWallY,e.oldOffsetX,e.oldOffsetY,i),n=t.getLocation(e.newWallX,e.newWallY,e.newOffsetX,e.newOffsetY,i);this._roomCreator.updateRoomObjectWallLocation(this._currentRoomId,e.itemId,this.roundLocation(r),this.roundLocation(n),e.animationTime)}onWiredUserMove(e){let t=!1;if(e.moveType=="sld"){const n=this._roomCreator.getRoomObjectUser(this._currentRoomId,e.userIndex);if(!n)return;t=n.model.getValue(D.FIGURE_CAN_STAND_UP)}const i=new Y(e.bodyDirection%8*45),r=e.headDirection%8*45;this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,e.userIndex,this.roundLocation(e.source),this.roundLocation(e.target),t,0,i,r,e.animationTime),this.setUserMovePosture(e.userIndex,e.moveType)}setUserMovePosture(e,t){const i=this._roomCreator.getRoomObjectUser(this._currentRoomId,e);if(i&&i.type!==Ft.MONSTER_PLANT){let r="std";switch(t){case wa.MOVE:r="mv";break;case wa.SLIDE:const n=i.model.getValue(D.FIGURE_POSTURE);r=n==="mv"?"std":n;break}this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,e,r)}}onObjectsDataUpdateEvent(e){if(!(e instanceof LR)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(t)for(const i of t.objects)this._roomCreator.updateRoomObjectFloor(this._currentRoomId,i.id,null,null,i.state,i.data)}onFurnitureAliasesEvent(e){!(e instanceof VR)||!e.connection||!this._roomCreator||(e.getParser().aliases,this._connection.send(new Nx))}onFurnitureFloorAddEvent(e){if(!(e instanceof wR)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;if(t.items.length){for(const r of t.items)r&&this.addRoomObjectFurnitureFloor(this._currentRoomId,r);return}const i=t.item;i&&(xb()&&gc()&&Me.call("increaseConstructionHeight",Ob()),this.addRoomObjectFurnitureFloor(this._currentRoomId,i))}onFurnitureFloorEvent(e){if(!(e instanceof FR)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const i=t.items.length;let r=0;for(;r<i;){const n=t.items[r];n&&this.addRoomObjectFurnitureFloor(this._currentRoomId,n),r++}}onFurnitureFloorRemoveEvent(e){if(!(e instanceof GR)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(t){if(t.itemsIds.length){for(const i of t.itemsIds)i.delay>0?setTimeout(()=>{this._roomCreator.removeRoomObjectFloor(this._currentRoomId,i.itemId,i.isExpired?-1:i.userId,!0)},i.delay):this._roomCreator.removeRoomObjectFloor(this._currentRoomId,i.itemId,i.isExpired?-1:i.userId,!0);return}t.delay>0?setTimeout(()=>{this._roomCreator.removeRoomObjectFloor(this._currentRoomId,t.itemId,t.isExpired?-1:t.userId,!0)},t.delay):this._roomCreator.removeRoomObjectFloor(this._currentRoomId,t.itemId,t.isExpired?-1:t.userId,!0)}}onFurnitureFloorOpacityEvent(e){if(!(e instanceof kR)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(t)if(t.delay>0)setTimeout(()=>{for(const i of t.itemsId){const r=this._roomCreator.getRoomObject(this._currentRoomId,i,Q.FLOOR);this._roomCreator.useFurnitureAlphaMultiplier(r,t.multiplier/10,t.clickable)}},t.delay);else for(const i of t.itemsId){const r=this._roomCreator.getRoomObject(this._currentRoomId,i,Q.FLOOR);this._roomCreator.useFurnitureAlphaMultiplier(r,t.multiplier/10,t.clickable)}}onFurnitureFloorUpdateEvent(e){if(!(e instanceof BR)||!e.connection||!this._roomCreator)return;const t=e.getParser().items;for(const i of t){if(!i)return;const r=new Y(i.x,i.y,i.z),n=new Y(i.direction);xb()&&gc()&&Me.call("increaseConstructionHeight",Ob()),this._roomCreator.updateRoomObjectFloor(this._currentRoomId,i.itemId,r,n,i.data.state,i.data,i.extra),this._roomCreator.updateRoomObjectFloorHeight(this._currentRoomId,i.itemId,i.stackHeight),this._roomCreator.updateRoomObjectFloorExpiration(this._currentRoomId,i.itemId,i.expires)}}onFurnitureWallAddEvent(e){if(!(e instanceof zR)||!e.connection||!this._roomCreator)return;const t=e.getParser().item;t&&this.addRoomObjectFurnitureWall(this._currentRoomId,t)}onFurnitureWallEvent(e){if(!(e instanceof KR)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const i=t.items.length;let r=0;for(;r<i;){const n=t.items[r];n&&this.addRoomObjectFurnitureWall(this._currentRoomId,n),r++}}onFurnitureWallRemoveEvent(e){if(!(e instanceof qR)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(t){if(t.getWallItems().length){for(const i of t.getWallItems())this._roomCreator.removeRoomObjectWall(this._currentRoomId,i.itemId,i.userId);return}this._roomCreator.removeRoomObjectWall(this._currentRoomId,t.itemId,t.userId)}}onFurnitureWallUpdateEvent(e){if(!(e instanceof XR)||!e.connection||!this._roomCreator)return;const t=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!t)return;const i=e.getParser().item;if(!i)return;const r=t.getLocation(i.width,i.height,i.localX,i.localY,i.direction),n=new Y(t.getDirection(i.direction));this._roomCreator.updateRoomObjectWall(this._currentRoomId,i.itemId,r,n,i.state,i.stuffData),this._roomCreator.updateRoomObjectWallExpiration(this._currentRoomId,i.itemId,i.secondsToExpiration)}onFurnitureDataEvent(e){if(!(e instanceof HR)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.furnitureId,null,null,t.objectData.state,t.objectData)}onItemDataUpdateMessageEvent(e){if(!(e instanceof WR)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectWallItemData(this._currentRoomId,t.furnitureId,t.data)}onOneWayDoorStatusMessageEvent(e){if(!(e instanceof YR)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.itemId,null,null,t.state,new Xr)}onDiceValueMessageEvent(e){if(!(e instanceof UR)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.itemId,null,null,t.value,new Xr)}onRoomUnitDanceEvent(e){!(e instanceof np)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,D.FIGURE_DANCE,e.getParser().danceId)}onRoomUnitEffectEvent(e){!(e instanceof ex)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserEffect(this._currentRoomId,e.getParser().unitId,e.getParser().effectId,e.getParser().delay)}onRoomUnitEvent(e){if(!(e instanceof ap)||!e.connection||!this._roomCreator)return;const t=e.getParser().users;if(!(!t||!t.length)){for(const i of t){if(!i)continue;const r=new Y(i.x,i.y,i.z),n=new Y(i.dir);this._roomCreator.addRoomObjectUser(this._currentRoomId,i.roomIndex,r,n,i.dir,i.userType,i.figure),i.webID===this._ownUserId&&(this._roomCreator.setRoomSessionOwnUser(this._currentRoomId,i.roomIndex),this._roomCreator.updateRoomObjectUserOwn(this._currentRoomId,i.roomIndex)),this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,i.roomIndex,i.figure,i.sex,i.subType,i.isRiding),Ft.getTypeString(i.userType)===Ft.PET&&this._roomCreator.getPetTypeId(i.figure)===ui.MONSTERPLANT&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,i.roomIndex,i.petPosture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,D.FIGURE_IS_MUTED,this._roomCreator.sessionDataManager.isUserIgnored(i.webID)?1:0)}this.updateGuideMarker()}}onRoomUnitExpressionEvent(e){!(e instanceof tx)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,D.FIGURE_EXPRESSION,e.getParser().expression)}onRoomUnitHandItemEvent(e){!(e instanceof sx)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,D.FIGURE_CARRY_OBJECT,e.getParser().handId)}onRoomUnitIdleEvent(e){!(e instanceof ix)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,D.FIGURE_SLEEP,e.getParser().isIdle?1:0)}onRoomUnitInfoEvent(e){!(e instanceof op)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,e.getParser().unitId,e.getParser().figure,e.getParser().gender)}onRoomUnitNumberEvent(e){if(!(e instanceof rx)||!e.connection||!this._roomCreator)return;const t=e.getParser();t&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.unitId,D.FIGURE_NUMBER_VALUE,t.value)}onRoomUnitRemoveEvent(e){if(!(e instanceof lp)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(t){if(t.unitsIds.length)for(const i of t.unitsIds)this._roomCreator.removeRoomObjectUser(this._currentRoomId,i);else this._roomCreator.removeRoomObjectUser(this._currentRoomId,t.unitId);this.updateGuideMarker()}}onRoomUnitStatusEvent(e){if(!(e instanceof nx)||!e.connection||!this._roomCreator)return;const t=e.getParser().statuses;if(!t||!t.length)return;const i=this._roomCreator.getRoomInstance(this._currentRoomId);if(!i)return;const r=i.model.getValue(Vs.ROOM_Z_SCALE)||1;for(const n of t){if(!n)continue;let o=n.height;o&&(o=o/r);const l=new Y(n.x,n.y,n.z+o),c=new Y(n.direction);let u=null;n.didMove&&(u=new Y(n.targetX,n.targetY,n.targetZ)),this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,n.id,l,u,n.canStandUp,o,c,n.headDirection,NaN,n.skipPositionUpdate),this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,null);let d=!0,_=!1,m=D.STD,f="";if(n.actions&&n.actions.length){for(const E of n.actions)if(E)switch(E.action){case"flatctrl":this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,E.value);break;case"sign":n.actions.length===1&&(d=!1),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,n.id,D.FIGURE_SIGN,parseInt(E.value));break;case"gst":n.actions.length===1&&(d=!1),this._roomCreator.updateRoomObjectUserPetGesture(this._currentRoomId,n.id,E.value);break;case"wav":case"mv":_=!0,m=E.action,f=E.value;break;case"trd":break;default:_=!0,m=E.action,f=E.value;break}}_?this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,m,f):d&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,D.STD,"")}this.updateGuideMarker()}onRoomUnitChatEvent(e){if(!e.connection||!this._roomCreator)return;const t=e.getParser();t&&(this._roomCreator.updateRoomObjectUserGesture(this._currentRoomId,t.roomIndex,t.gesture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.roomIndex,D.FIGURE_TALK,t.message.length/10))}onRoomUnitTypingEvent(e){!(e instanceof ZR)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,D.FIGURE_IS_TYPING,e.getParser().isTyping?1:0)}onPetFigureUpdateEvent(e){if(!(e instanceof sp)||!e.connection||!this._roomCreator)return;const t=e.getParser();t&&this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,t.roomIndex,t.figureData.figuredata,"","",t.isRiding)}onPetExperienceEvent(e){const t=e.getParser();t&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.roomIndex,D.FIGURE_GAINED_EXPERIENCE,t.gainedExperience)}onYouArePlayingGameEvent(e){if(!e)return;const t=e.getParser();t&&this._roomCreator.setRoomEngineGameMode(this._currentRoomId,t.isPlaying)}addRoomObjectFurnitureFloor(e,t){if(!t||!this._roomCreator)return;const i=new Y(t.x,t.y,t.z),r=new Y(t.direction);t.spriteName?this._roomCreator.addFurnitureFloorByTypeName(e,t.itemId,t.spriteName,i,r,t.state,t.data,t.extra,t.expires,t.usagePolicy,t.userId,t.username,!0,!0,t.stackHeight,t.opacity,t.clickable):this._roomCreator.addFurnitureFloor(e,t.itemId,t.spriteId,i,r,t.state,t.data,t.extra,t.expires,t.usagePolicy,t.userId,t.username,!0,!0,t.stackHeight,t.opacity,t.clickable)}addRoomObjectFurnitureWall(e,t){if(!t||!this._roomCreator)return;const i=this._roomCreator.getLegacyWallGeometry(e);if(!i)return;let r=null;t.isOldFormat||(r=i.getLocation(t.width,t.height,t.localX,t.localY,t.direction));const n=new Y(i.getDirection(t.direction));this._roomCreator.addFurnitureWall(e,t.itemId,t.spriteId,r,n,t.state,t.stuffData,t.secondsToExpiration,t.usagePolicy,t.userId,t.username)}onIgnoreResultEvent(e){if(!e)return;const t=e.getParser();if(!t)return;const i=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(i)for(const r of t.ids){const n=i.userDataManager.getUserData(r);if(!n)return;switch(t.result){case 1:case 2:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,n.roomIndex,D.FIGURE_IS_MUTED,1);return;case 3:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,n.roomIndex,D.FIGURE_IS_MUTED,0);return}}}onGuideSessionStartedMessageEvent(e){const t=e.getParser();this._guideId=t.guideUserId,this._requesterId=t.requesterUserId,this.updateGuideMarker()}onGuideSessionEndedMessageEvent(e){this.removeGuideMarker()}onGuideSessionErrorMessageEvent(e){this.removeGuideMarker()}updateGuideMarker(){const e=this._roomCreator.sessionDataManager.userId;this.setUserGuideStatus(this._guideId,this._requesterId===e?Oo.GUIDE:Oo.NONE),this.setUserGuideStatus(this._requesterId,this._guideId===e?Oo.REQUESTER:Oo.NONE)}removeGuideMarker(){this.setUserGuideStatus(this._guideId,Oo.NONE),this.setUserGuideStatus(this._requesterId,Oo.NONE),this._guideId=-1,this._requesterId=-1}setUserGuideStatus(e,t){if(!this._roomCreator||!this._roomCreator.roomSessionManager)return;const i=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!i)return;const r=i.userDataManager.getDataByType(e,Xt.USER);r&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,r.roomIndex,D.FIGURE_GUIDE_STATUS,t)}}const bA=class bA extends Ie{constructor(e,t,i,r){super("RETWE_UPDATE_STATE_AREA_HIDE",e,t,i),this._isOn=r}get isOn(){return this._isOn}};bA.UPDATE_STATE_AREA_HIDE="RETWE_UPDATE_STATE_AREA_HIDE";let im=bA;class xee extends Qr{constructor(e){super(),this._roomEngine=e,this._eventIds=new Map,this._selectedAvatarId=-1,this._selectedObjectId=-1,this._selectedObjectCategory=-2,this._whereYouClickIsWhereYouGo=!0,this._objectPlacementSource=null,this.onRoomEngineObjectEvent=this.onRoomEngineObjectEvent.bind(this),this._roomEngine.events.addEventListener(ke.ADDED,this.onRoomEngineObjectEvent)}get selectedAvatarId(){return this._selectedAvatarId}get engine(){return this._roomEngine}useFurnitureAlphaMultiplier(e,t,i){!e||!e.model||(e.model.setValue(D.FURNITURE_ALPHA_MULTIPLIER,t),t>=1?this.disableClickThrough(e):i?this.disableClickThrough(e):this.enableClickThrough(e))}enableClickThrough(e){e.model.setValue(D.FURNITURE_CLICK_THROUGH_ENABLED,!0)}disableClickThrough(e){e.model.setValue(D.FURNITURE_CLICK_THROUGH_ENABLED,!1)}dispose(){this._eventIds&&(this._eventIds=null),this._roomEngine.events.removeEventListener(ke.ADDED,this.onRoomEngineObjectEvent),this._roomEngine=null}processRoomCanvasMouseEvent(e,t,i){if(!e||!t||Bn.isRunning())return;const r=t.type;let n=this._roomEngine.getRoomObjectCategoryForType(r);if(n!==Q.ROOM&&(!this._roomEngine.isPlayingGame()||n!==Q.UNIT)&&(n=Q.MINIMUM),this.getMouseEventId(n,e.type)===e.eventId){if(e.type===Re.MOUSE_CLICK||e.type===Re.DOUBLE_CLICK||e.type===Re.MOUSE_DOWN||e.type===Re.MOUSE_UP||e.type===Re.MOUSE_MOVE)return}else e.eventId&&this.setMouseEventId(n,e.type,e.eventId);t.mouseHandler&&t.mouseHandler.mouseEvent(e,i)}processRoomObjectPlacement(e,t,i,r,n,o=null,l=null,c=-1,u=-1,d=null){this._objectPlacementSource=e;const _=new Y(-100,-100),m=new Y(0);return this.setSelectedRoomObjectData(t,i,r,_,m,at.OBJECT_PLACE,n,o,l,c,u,d),this._roomEngine&&(this._roomEngine.setObjectMoverIconSprite(n,r,!1,o,l,c,u,d),this._roomEngine.setObjectMoverIconSpriteVisible(!1)),!0}cancelRoomObjectInsert(e){return this.resetSelectedObjectData(e),!0}handleRoomObjectEvent(e,t,i){if(e){if(e instanceof rt){this.handleRoomObjectMouseEvent(e,t,i);return}switch(e.type){case At.STATE_CHANGE:case At.STATE_RANDOM:this.onRoomObjectStateChangedEvent(e,t);return;case Bu.DIMMER_STATE:this.onRoomObjectDimmerStateUpdateEvent(e,t);return;case Bi.POSITION_CHANGED:case Bi.OBJECT_REMOVED:this.handleSelectedObjectRemove(e,t);return;case Bi.SLIDE_ANIMATION:this.handleObjectSlide(e,t);return;case re.OPEN_WIDGET:case re.CLOSE_WIDGET:case re.OPEN_FURNI_CONTEXT_MENU:case re.CLOSE_FURNI_CONTEXT_MENU:case re.PLACEHOLDER:case re.CREDITFURNI:case re.STACK_HEIGHT:case re.EXTERNAL_IMAGE:case re.STICKIE:case re.PRESENT:case re.TROPHY:case re.HIDE_AREA:case im.UPDATE_STATE_AREA_HIDE:case re.TEASER:case re.ECOTRONBOX:case re.DIMMER:case re.WIDGET_REMOVE_DIMMER:case re.CLOTHING_CHANGE:case re.JUKEBOX_PLAYLIST_EDITOR:case re.MANNEQUIN:case re.PET_PRODUCT_MENU:case re.GUILD_FURNI_CONTEXT_MENU:case re.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:case re.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:case re.BACKGROUND_COLOR:case re.MYSTERYBOX_OPEN_DIALOG:case re.EFFECTBOX_OPEN_DIALOG:case re.MYSTERYTROPHY_OPEN_DIALOG:case re.ACHIEVEMENT_RESOLUTION_OPEN:case re.ACHIEVEMENT_RESOLUTION_ENGRAVING:case re.ACHIEVEMENT_RESOLUTION_FAILED:case re.FRIEND_FURNITURE_CONFIRM:case re.FRIEND_FURNITURE_ENGRAVING:case re.BADGE_DISPLAY_ENGRAVING:case re.HIGH_SCORE_DISPLAY:case re.HIDE_HIGH_SCORE_DISPLAY:case re.INERNAL_LINK:case re.ROOM_LINK:case re.YOUTUBE:case re.RENTABLE_SPACE:this.onRoomObjectWidgetRequestEvent(e,t);return;case Ae.DICE_ACTIVATE:case Ae.DICE_OFF:case Ae.USE_HABBOWHEEL:case Ae.STICKIE:case Ae.ENTER_ONEWAYDOOR:this.onRoomObjectFurnitureActionEvent(e,t);return;case Ae.SOUND_MACHINE_INIT:case Ae.SOUND_MACHINE_START:case Ae.SOUND_MACHINE_STOP:case Ae.SOUND_MACHINE_DISPOSE:this.handleObjectSoundMachineEvent(e,t);return;case Ae.JUKEBOX_INIT:case Ae.JUKEBOX_START:case Ae.JUKEBOX_MACHINE_STOP:case Ae.JUKEBOX_DISPOSE:this.handleObjectJukeboxEvent(e,t);return;case Rr.ADD_HOLE:case Rr.REMOVE_HOLE:this.onRoomObjectFloorHoleEvent(e,t);return;case vs.ROOM_AD_FURNI_CLICK:case vs.ROOM_AD_FURNI_DOUBLE_CLICK:case vs.ROOM_AD_TOOLTIP_SHOW:case vs.ROOM_AD_TOOLTIP_HIDE:case vs.ROOM_AD_LOAD_IMAGE:this.onRoomObjectRoomAdEvent(e,t);return;case Wa.LOAD_BADGE:this.onRoomObjectBadgeAssetEvent(e,t);return;case Ae.MOUSE_ARROW:case Ae.MOUSE_BUTTON:this.handleMousePointer(e,t);return;case Tl.PLAY_SOUND:case Tl.PLAY_SOUND_AT_PITCH:this.handleRoomObjectPlaySoundEvent(e,t);return;case Ii.ROOM_OBJECT_INITIALIZED:case Ii.ROOM_OBJECT_DISPOSED:case Ii.PLAY_SAMPLE:case Ii.CHANGE_PITCH:this.handleRoomObjectSamplePlaybackEvent(e,t);return;case El.ROOM_BACKGROUND_COLOR:this.onHSLColorEnableEvent(e,t);return;case da.RODRE_CURRENT_USER_ID:case da.RODRE_URL_PREFIX:this.onRoomObjectDataRequestEvent(e,t);return;default:ze.warn("Unhandled Event",e.constructor.name,"Object ID",e.object.id);return}}}modifyRoomObject(e,t,i,r){if(!this._roomEngine)return!1;const n=this._roomEngine.getRoomObject(e,t,i);if(!n)return!1;let o=!0,l="";const c=n.getLocation();let u;const d=this._roomEngine.roomSessionManager.getSession(e);if(d&&d.playTestMode)return!1;if(r==at.OBJECT_ROTATE_NEGATIVE?u=this.getValidRoomObjectDirection(n,!1):u=this.getValidRoomObjectDirection(n,!0),i===Q.WALL){const _=this._roomEngine.getLegacyWallGeometry(e);_&&(l=_.getOldLocationString(c,u))}switch(r){case at.OBJECT_ROTATE_POSITIVE:case at.OBJECT_ROTATE_NEGATIVE:if(this._roomEngine.connection){const _=n.getLocation().x,m=n.getLocation().y;if(this.isValidLocation(n,new Y(u),this._roomEngine.getFurnitureStackingHeightMap(e)))if(u=Math.trunc(u/45),n.type===Ft.MONSTER_PLANT){const f=this._roomEngine.roomSessionManager.getSession(e);if(f){const E=f.userDataManager.getUserDataByIndex(t);E&&this._roomEngine.connection.send(new Ox(E.webID,Math.trunc(_),Math.trunc(m),u))}}else this._roomEngine.connection.send(new Ud(t,_,m,tn()==-1?u:tn())),Cr.addUndo(It.FURNITURE_FLOOR_UPDATE,[t,n.getLocation().x,n.getLocation().y,tn()==-1?u:tn(),_,m,tn()==-1?u:tn()])}break;case at.OBJECT_EJECT:case at.OBJECT_PICKUP:this._roomEngine.connection&&(this._roomEngine.connection.send(new pT(i,t)),Cr.addUndo(It.FURNITURE_PICKUP,[t,i,l,n.getLocation().x,n.getLocation().y,n.direction.x,!1]));break;case at.OBJECT_PICKUP_PET:if(this._roomEngine.connection){const _=this._roomEngine.roomSessionManager.getSession(e);if(_){const m=_.userDataManager.getUserDataByIndex(t);_.pickupPet(m.webID)}}break;case at.OBJECT_PICKUP_BOT:if(this._roomEngine.connection){const _=this._roomEngine.roomSessionManager.getSession(e);if(_){const m=_.userDataManager.getUserDataByIndex(t);_.pickupBot(m.webID)}}break;case at.OBJECT_MOVE:o=!1,this.setFurnitureAlphaMultiplier(n,.5),this.setSelectedRoomObjectData(e,n.id,i,n.getLocation(),n.getDirection(),r),this._roomEngine.setObjectMoverIconSprite(n.id,i,!0),this._roomEngine.setObjectMoverIconSpriteVisible(!1);break;case at.OBJECT_MOVE_TO:{const _=this.getSelectedRoomObjectData(e),m=_.loc.x,f=_.loc.y;if(this.updateSelectedObjectData(e,_.id,_.category,_.loc,_.dir,at.OBJECT_MOVE_TO,_.typeId,_.instanceData,_.stuffData,_.state,_.animFrame,_.posture),this.setFurnitureAlphaMultiplier(n,1),this._roomEngine.removeObjectMoverIconSprite(),this._roomEngine.connection){if(i===Q.FLOOR){const E=n.getDirection().x%360,I=n.getLocation(),p=E/45;this._roomEngine.connection.send(new Ud(t,I.x,I.y,tn()==-1?p:tn())),Cr.addUndo(It.FURNITURE_FLOOR_UPDATE,[t,m,f,tn()==-1?p:tn(),I.x,I.y,tn()==-1?p:tn()])}else if(i===Q.WALL){const E=n.getDirection().x%360,I=this._roomEngine.getLegacyWallGeometry(e);if(I){const p=I.getOldLocationString(n.getLocation(),E);p&&(this._roomEngine.connection.send(new fm(t,p)),Cr.addUndo(It.FURNITURE_WALL_UPDATE,[t,l,p]))}}else if(i===Q.UNIT){const E=n.getDirection().x%360,I=n.getLocation(),p=E/45;parseInt(n.model.getValue(D.RACE));const S=this._roomEngine.roomSessionManager.getSession(e);if(S){const R=S.userDataManager.getUserDataByIndex(t);R&&this._roomEngine.connection.send(new Ox(R.webID,I.x,I.y,p))}}}break}}return o&&this.resetSelectedObjectData(e),!0}modifyRoomObjectDataWithMap(e,t,i,r,n){if(!this._roomEngine||!this._roomEngine.getRoomObject(e,t,i))return!1;const l=this._roomEngine.roomSessionManager.getSession(e);if(l&&l.playTestMode)return!1;switch(r){case at.OBJECT_SAVE_STUFF_DATA:this._roomEngine.connection&&this._roomEngine.connection.send(new aN(t,n));break}return!0}modifyWallItemData(e,t,i,r){if(!this._roomEngine||!this._roomEngine.connection)return!1;const n=this._roomEngine.roomSessionManager.getSession(e);return n&&n.playTestMode?!1:(this._roomEngine.connection.send(new nw(t,i,r)),!0)}deleteWallItem(e,t){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new iw(t)),!0)}getValidRoomObjectDirection(e,t){if(!e||!e.model)return 0;let i=0,r=0,n=[];e.type===Ft.MONSTER_PLANT?n=e.model.getValue(D.PET_ALLOWED_DIRECTIONS):n=e.model.getValue(D.FURNITURE_ALLOWED_DIRECTIONS);let o=e.getDirection().x;if(n&&n.length){if(i=n.indexOf(o),i<0){for(i=0,r=0;r<n.length&&!(o<=n[r]);)i++,r++;i=i%n.length}t?i=(i+1)%n.length:i=(i-1+n.length)%n.length,o=n[i]}return o}setSelectedObject(e,t,i,r=!0){if(!this._roomEngine)return;const n=this._roomEngine.events;if(n)switch(i){case Q.UNIT:case Q.FLOOR:case Q.WALL:if(i===Q.UNIT)this.deselectObject(e),this.setSelectedAvatar(e,t,!0);else if(this.setSelectedAvatar(e,0,!1),t!==this._selectedObjectId){this.deselectObject(e);const o=this._roomEngine.getRoomObject(e,t,i);o&&o.logic&&(o.logic.processUpdateMessage(new Jg(!0)),this._selectedObjectId=t,this._selectedObjectCategory=i)}n.dispatchEvent(new ke(ke.SELECTED,e,t,i,r));return}}setSelectedAvatar(e,t,i){if(!this._roomEngine)return;const r=Q.UNIT,n=this._roomEngine.getRoomObject(e,this._selectedAvatarId,r);n&&n.logic&&(n.logic.processUpdateMessage(new Np(!1)),this._selectedAvatarId=-1);let o=!1;if(i){const c=this._roomEngine.getRoomObject(e,t,r);if(c&&c.logic){c.logic.processUpdateMessage(new Np(!0)),o=!0,this._selectedAvatarId=t;const u=c.getLocation();u&&!this._roomEngine.hasClickUserWired()&&this._roomEngine.connection.send(new Vw(~~u.x,~~u.y))}}const l=this._roomEngine.getRoomObjectSelectionArrow(e);l&&l.logic&&(o&&!this._roomEngine.isPlayingGame()?l.logic.processUpdateMessage(new Ol(Ol.ENABLED)):l.logic.processUpdateMessage(new Ol(Ol.DISABLED)))}cancelRoomObjectPlacement(e){return this.resetSelectedObjectData(e),!0}onRoomEngineObjectEvent(e){let t=this.getSelectedRoomObjectData(e.roomId);if(t&&t.operation===at.OBJECT_PLACE&&t.id===e.objectId){const i=this._roomEngine.getRoomObject(e.roomId,t.id,t.category);if(i&&i.model&&t.category===Q.FLOOR){const r=i.model.getValue(D.FURNITURE_ALLOWED_DIRECTIONS);if(r&&r.length){const n=new Y(r[0]);if(i.setDirection(n),this.updateSelectedObjectData(e.roomId,t.id,t.category,t.loc,n,t.operation,t.typeId,t.instanceData,t.stuffData,t.state,t.animFrame,t.posture),t=this.getSelectedRoomObjectData(e.roomId),!t)return}}this.setFurnitureAlphaMultiplier(i,.5)}}getMouseEventId(e,t){const i=this._eventIds.get(e);return i&&i.get(t)||null}setMouseEventId(e,t,i){let r=this._eventIds.get(e);r||(r=new Map,this._eventIds.set(e,r)),r.delete(t),r.set(t,i)}handleRoomObjectMouseEvent(e,t,i){if(!(!e||!e.type)){if(e instanceof Ta){const r=e;this._roomEngine.areaSelectionManager.handleTileMouseEvent(r)}switch(e.type){case rt.CLICK:case rt.MOUSE_UP:this.handleRoomObjectMouseMoveEvent(e,t),this.handleRoomObjectMouseClickEvent(e,t,i);return;case rt.DOUBLE_CLICK:this.handleRoomObjectMouseDoubleClickEvent(e,t);return;case rt.MOUSE_MOVE:this.handleRoomObjectMouseMoveEvent(e,t);return;case rt.MOUSE_DOWN:this.handleRoomObjectMouseDownEvent(e,t);return;case rt.MOUSE_DOWN_LONG:this.handleRoomObjectMouseDownLongEvent(e,t);return;case rt.MOUSE_ENTER:this.handleRoomObjectMouseEnterEvent(e,t);return;case rt.MOUSE_LEAVE:this.handleRoomObjectMouseLeaveEvent(e,t);return}}}handleRoomObjectMouseClickEvent(e,t,i){if(!e)return;let r=at.OBJECT_UNDEFINED;const n=this.getSelectedRoomObjectData(t);n&&(r=n.operation);let o=!1,l=!1;this.isWhereYouClickWhereYouGo()&&(!r||r===at.OBJECT_UNDEFINED)&&(o=this.handleMoveTargetFurni(t,e));const c=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(r){case at.OBJECT_MOVE:c===Q.ROOM?n&&this.modifyRoomObject(t,n.id,n.category,at.OBJECT_MOVE_TO):c===Q.UNIT&&(n&&e.objectType===Ft.MONSTER_PLANT&&this.modifyRoomObject(t,n.id,n.category,at.OBJECT_MOVE_TO),e.eventId&&this.setMouseEventId(Q.ROOM,Re.MOUSE_CLICK,e.eventId),this.placeObjectOnUser(t,e.objectId,c)),l=!0,e.objectId!==-1&&this.setSelectedObject(t,e.objectId,c);break;case at.OBJECT_PLACE:if(c===Q.ROOM)this.placeObject(e,t,e instanceof Ta,e instanceof ph);else if(c===Q.UNIT)switch(e.objectType){case Ft.MONSTER_PLANT:case Ft.RENTABLE_BOT:this.placeObject(e,t,e instanceof Ta,e instanceof ph);break;default:e.eventId&&this.setMouseEventId(Q.ROOM,Re.MOUSE_CLICK,e.eventId),this.placeObjectOnUser(t,e.objectId,c);break}break;case at.OBJECT_UNDEFINED:c===Q.ROOM?!o&&e instanceof Ta&&this.onRoomObjectTileMouseEvent(t,e):(!this._roomEngine.isAreaSelectionMode()||c==Q.UNIT?this.setSelectedObject(t,e.objectId,c):(this.deselectObject(t),this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ke(ke.DESELECTED,t,-1,-2))),l=!1,c===Q.UNIT?(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.objectType===Ft.RENTABLE_BOT?this.modifyRoomObject(t,e.objectId,c,at.OBJECT_PICKUP_BOT):e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.objectType===Ft.MONSTER_PLANT?this.modifyRoomObject(t,e.objectId,c,at.OBJECT_PICKUP_PET):!e.ctrlKey&&!e.altKey&&e.shiftKey&&e.objectType===Ft.MONSTER_PLANT&&this.modifyRoomObject(t,e.objectId,c,at.OBJECT_ROTATE_POSITIVE),this._roomEngine.isPlayingGame()?l=!0:o=!0):(c===Q.FLOOR||c===Q.WALL)&&(e.altKey||e.ctrlKey||e.shiftKey)&&(!e.ctrlKey&&!e.altKey&&e.shiftKey?c===Q.FLOOR&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ke(ke.REQUEST_ROTATE,t,e.objectId,c)):e.ctrlKey&&!e.altKey&&!e.shiftKey&&this.modifyRoomObject(t,e.objectId,c,at.OBJECT_PICKUP),this._roomEngine.isPlayingGame()?l=!0:o=!0),e.eventId&&(o&&this.setMouseEventId(Q.ROOM,Re.MOUSE_CLICK,e.eventId),l&&this.setMouseEventId(Q.MINIMUM,Re.MOUSE_CLICK,e.eventId)));break}if(c===Q.ROOM){const u=this.getMouseEventId(Q.MINIMUM,Re.MOUSE_CLICK),d=this.getMouseEventId(Q.UNIT,Re.MOUSE_CLICK);u!==e.eventId&&d!==e.eventId&&!l&&(this.deselectObject(t),this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ke(ke.DESELECTED,t,-1,Q.MINIMUM)),this.setSelectedAvatar(t,0,!1))}}handleRoomObjectMouseDoubleClickEvent(e,t){const i=e.objectId,r=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ke(ke.DOUBLE_CLICK,t,i,n))}handleRoomObjectMouseMoveEvent(e,t){if(!e)return;let i=at.OBJECT_UNDEFINED;const r=this.getSelectedRoomObjectData(t);r&&(i=r.operation);const n=this._roomEngine.getRoomObjectCategoryForType(e.objectType);if(this._roomEngine){const o=this._roomEngine.getRoomObjectCursor(t);if(o&&o.logic){let l=null;e instanceof Ta?l=this.handleMouseOverTile(e,t):e.object&&e.object.id!==-1?this.isWhereYouClickWhereYouGo()&&(l=this.handleMouseOverObject(n,t,e)):l=new Eh(null,0,!1,e.eventId),o.processUpdateMessage(l)}}switch(i){case at.OBJECT_MOVE:n===Q.ROOM&&this.handleObjectMove(e,t);return;case at.OBJECT_PLACE:n===Q.ROOM&&this.handleObjectPlace(e,t);return}}handleRoomObjectMouseDownEvent(e,t){if(!e||e instanceof Ta)return;let i=at.OBJECT_UNDEFINED;const r=this.getSelectedRoomObjectData(t);r&&(i=r.operation);const n=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(i){case at.OBJECT_UNDEFINED:(n===Q.FLOOR||n===Q.WALL||e.objectType===Ft.MONSTER_PLANT)&&(e.altKey&&!e.ctrlKey&&!e.shiftKey||this.decorateModeMove(e))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ke(ke.REQUEST_MOVE,t,e.objectId,n));return}}handleRoomObjectMouseDownLongEvent(e,t){if(!e)return;let i=at.OBJECT_UNDEFINED;const r=this.getSelectedRoomObjectData(t);r&&(i=r.operation);const n=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(i){case at.OBJECT_UNDEFINED:(n===Q.FLOOR||n===Q.WALL||e.objectType===Ft.MONSTER_PLANT)&&(!e.ctrlKey&&!e.shiftKey||this.decorateModeMove(e))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ke(ke.REQUEST_MANIPULATION,t,e.objectId,n));return}}handleRoomObjectMouseEnterEvent(e,t){const i=e.objectId,r=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ke(ke.MOUSE_ENTER,t,i,n))}handleRoomObjectMouseLeaveEvent(e,t){const i=e.objectId,r=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);if(n!==Q.ROOM&&n===Q.UNIT){const o=this._roomEngine.getRoomObjectCursor(t);o&&o.processUpdateMessage(new os(0,null))}this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ke(ke.MOUSE_LEAVE,t,i,n))}onRoomObjectStateChangedEvent(e,t){if(e)switch(e.type){case At.STATE_CHANGE:this.changeObjectState(t,e.object.id,e.object.type,e.state,!1);return;case At.STATE_RANDOM:this.changeObjectState(t,e.object.id,e.object.type,e.state,!0);return}}onRoomObjectDimmerStateUpdateEvent(e,t){if(e)switch(e.type){case Bu.DIMMER_STATE:this._roomEngine.events.dispatchEvent(new If(t,e.state,e.presetId,e.effectId,e.color,e.brightness));return}}handleSelectedObjectRemove(e,t){if(!(!e||!this._roomEngine))switch(e.type){case Bi.POSITION_CHANGED:{const i=e.objectId,r=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r),o=this._roomEngine.getRoomObject(t,i,n),l=this._roomEngine.getRoomObjectSelectionArrow(t);if(o&&l&&l.logic){const c=o.getLocation();l.logic.processUpdateMessage(new xi(c,null))}return}case Bi.OBJECT_REMOVED:this.setSelectedAvatar(t,0,!1);return}}handleObjectSlide(e,t){this._roomEngine&&this._roomEngine.getRoomObjectCategoryForType(e.objectType)==Q.WALL&&this._roomEngine.updateRoomObjectMask(t,e.objectId)}onRoomObjectWidgetRequestEvent(e,t){if(!e||!this._roomEngine)return;const i=e.objectId,r=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r),o=this._roomEngine.events;if(o&&!Ba.isRoomPreviewerId(t))switch(e.type){case re.OPEN_WIDGET:o.dispatchEvent(new Ie(Ie.OPEN_WIDGET,t,i,n,e.object.logic.widget));return;case re.CLOSE_WIDGET:o.dispatchEvent(new Ie(Ie.CLOSE_WIDGET,t,i,n,e.object.logic.widget));return;case re.OPEN_FURNI_CONTEXT_MENU:o.dispatchEvent(new Ie(Ie.OPEN_FURNI_CONTEXT_MENU,t,i,n,e.object.logic.contextMenu));return;case re.CLOSE_FURNI_CONTEXT_MENU:o.dispatchEvent(new Ie(Ie.CLOSE_FURNI_CONTEXT_MENU,t,i,n));return;case re.PLACEHOLDER:o.dispatchEvent(new Ie(Ie.REQUEST_PLACEHOLDER,t,i,n));return;case re.CREDITFURNI:o.dispatchEvent(new Ie(Ie.REQUEST_CREDITFURNI,t,i,n));return;case re.STACK_HEIGHT:o.dispatchEvent(new Ie(Ie.REQUEST_STACK_HEIGHT,t,i,n));return;case re.EXTERNAL_IMAGE:o.dispatchEvent(new Ie(Ie.REQUEST_EXTERNAL_IMAGE,t,i,n));return;case re.STICKIE:o.dispatchEvent(new Ie(Ie.REQUEST_STICKIE,t,i,n));return;case re.PRESENT:o.dispatchEvent(new Ie(Ie.REQUEST_PRESENT,t,i,n));return;case re.TROPHY:o.dispatchEvent(new Ie(Ie.REQUEST_TROPHY,t,i,n));return;case re.TEASER:o.dispatchEvent(new Ie(Ie.REQUEST_TEASER,t,i,n));return;case re.ECOTRONBOX:o.dispatchEvent(new Ie(Ie.REQUEST_ECOTRONBOX,t,i,n));return;case re.DIMMER:o.dispatchEvent(new Ie(Ie.REQUEST_DIMMER,t,i,n));return;case re.WIDGET_REMOVE_DIMMER:o.dispatchEvent(new Ie(Ie.REMOVE_DIMMER,t,i,n));return;case re.CLOTHING_CHANGE:o.dispatchEvent(new Ie(Ie.REQUEST_CLOTHING_CHANGE,t,i,n));return;case re.JUKEBOX_PLAYLIST_EDITOR:o.dispatchEvent(new Ie(Ie.REQUEST_PLAYLIST_EDITOR,t,i,n));return;case re.MANNEQUIN:o.dispatchEvent(new Ie(Ie.REQUEST_MANNEQUIN,t,i,n));return;case re.PET_PRODUCT_MENU:o.dispatchEvent(new vd(vd.USE_PRODUCT_FROM_ROOM,t,i,n));return;case re.GUILD_FURNI_CONTEXT_MENU:this._roomEngine.connection.send(new _w(e.objectId,e.object.model.getValue(D.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID)));return;case re.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:o.dispatchEvent(new Ie(Ie.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,t,i,n));return;case re.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:o.dispatchEvent(new Ie(Ie.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,t,i,n));return;case re.BACKGROUND_COLOR:o.dispatchEvent(new Ie(Ie.REQUEST_BACKGROUND_COLOR,t,i,n));return;case re.MYSTERYBOX_OPEN_DIALOG:o.dispatchEvent(new Ie(Ie.REQUEST_MYSTERYBOX_OPEN_DIALOG,t,i,n));return;case re.EFFECTBOX_OPEN_DIALOG:o.dispatchEvent(new Ie(Ie.REQUEST_EFFECTBOX_OPEN_DIALOG,t,i,n));return;case re.MYSTERYTROPHY_OPEN_DIALOG:o.dispatchEvent(new Ie(Ie.REQUEST_MYSTERYTROPHY_OPEN_DIALOG,t,i,n));return;case re.ACHIEVEMENT_RESOLUTION_OPEN:this._roomEngine.connection.send(new VP(e.objectId,0));return;case re.ACHIEVEMENT_RESOLUTION_ENGRAVING:o.dispatchEvent(new Ie(Ie.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING,t,i,n));return;case re.ACHIEVEMENT_RESOLUTION_FAILED:o.dispatchEvent(new Ie(Ie.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,t,i,n));return;case re.FRIEND_FURNITURE_CONFIRM:o.dispatchEvent(new Ie(Ie.REQUEST_FRIEND_FURNITURE_CONFIRM,t,i,n));return;case re.FRIEND_FURNITURE_ENGRAVING:o.dispatchEvent(new Ie(Ie.REQUEST_FRIEND_FURNITURE_ENGRAVING,t,i,n));return;case re.BADGE_DISPLAY_ENGRAVING:o.dispatchEvent(new Ie(Ie.REQUEST_BADGE_DISPLAY_ENGRAVING,t,i,n));return;case re.HIGH_SCORE_DISPLAY:o.dispatchEvent(new Ie(Ie.REQUEST_HIGH_SCORE_DISPLAY,t,i,n));return;case re.HIDE_HIGH_SCORE_DISPLAY:o.dispatchEvent(new Ie(Ie.REQUEST_HIDE_HIGH_SCORE_DISPLAY,t,i,n));return;case re.INERNAL_LINK:o.dispatchEvent(new Ie(Ie.REQUEST_INTERNAL_LINK,t,i,n));return;case re.ROOM_LINK:o.dispatchEvent(new Ie(Ie.REQUEST_ROOM_LINK,t,i,n));return;case re.YOUTUBE:o.dispatchEvent(new Ie(Ie.REQUEST_YOUTUBE,t,i,n));return;case re.HIDE_AREA:o.dispatchEvent(new Ie(Ie.REQUEST_HIDE_AREA,t,i,n));return;case re.RENTABLE_SPACE:o.dispatchEvent(new Ie(Ie.REQUEST_RENTABLE_SPACE,t,i,n));return}}onRoomObjectFurnitureActionEvent(e,t){e&&this.useObject(t,e.object.id,e.object.type,e.type)}handleObjectSoundMachineEvent(e,t){if(!e)return;const i=this._roomEngine.getRoomObjectCategoryForType(e.objectType),r=this.getSelectedRoomObjectData(t);if(!(r&&r.category===i&&r.id===e.objectId&&r.operation===at.OBJECT_PLACE))switch(e.type){case Ae.SOUND_MACHINE_INIT:this._roomEngine.events.dispatchEvent(new Hs(Hs.SOUND_MACHINE_INIT,t,e.objectId,i));return;case Ae.SOUND_MACHINE_START:this._roomEngine.events.dispatchEvent(new Hs(Hs.SOUND_MACHINE_SWITCHED_ON,t,e.objectId,i));return;case Ae.SOUND_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new Hs(Hs.SOUND_MACHINE_SWITCHED_OFF,t,e.objectId,i));return;case Ae.SOUND_MACHINE_DISPOSE:this._roomEngine.events.dispatchEvent(new Hs(Hs.SOUND_MACHINE_DISPOSE,t,e.objectId,i));return}}handleObjectJukeboxEvent(e,t){if(!e)return;const i=this._roomEngine.getRoomObjectCategoryForType(e.objectType),r=this.getSelectedRoomObjectData(t);if(!(r&&r.category===i&&r.id===e.objectId&&r.operation===at.OBJECT_PLACE))switch(e.type){case Ae.JUKEBOX_INIT:this._roomEngine.events.dispatchEvent(new Hs(Hs.JUKEBOX_INIT,t,e.objectId,i));return;case Ae.JUKEBOX_START:this._roomEngine.events.dispatchEvent(new Hs(Hs.JUKEBOX_SWITCHED_ON,t,e.objectId,i));return;case Ae.JUKEBOX_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new Hs(Hs.JUKEBOX_SWITCHED_OFF,t,e.objectId,i));return;case Ae.JUKEBOX_DISPOSE:this._roomEngine.events.dispatchEvent(new Hs(Hs.JUKEBOX_DISPOSE,t,e.objectId,i));return}}onRoomObjectFloorHoleEvent(e,t){if(e)switch(e.type){case Rr.ADD_HOLE:this._roomEngine.addRoomInstanceFloorHole(t,e.objectId);return;case Rr.REMOVE_HOLE:this._roomEngine.removeRoomInstanceFloorHole(t,e.objectId);return}}onRoomObjectRoomAdEvent(e,t){if(!e)return;let i=null;switch(e.type){case vs.ROOM_AD_FURNI_CLICK:this._roomEngine.events.dispatchEvent(e),e.clickUrl&&e.clickUrl.length>0&&De.instance.createLinkEvent(e.clickUrl),i=Mo.FURNI_CLICK;break;case vs.ROOM_AD_FURNI_DOUBLE_CLICK:if(e.clickUrl&&e.clickUrl.length>0){const r="CATALOG_PAGE";e.clickUrl.indexOf(r)===0&&De.instance.createLinkEvent(e.clickUrl.substr(r.length))}i=Mo.FURNI_DOUBLE_CLICK;break;case vs.ROOM_AD_TOOLTIP_SHOW:i=Mo.TOOLTIP_SHOW;break;case vs.ROOM_AD_TOOLTIP_HIDE:i=Mo.TOOLTIP_HIDE;break}i&&this._roomEngine.events.dispatchEvent(new ke(i,t,e.objectId,this._roomEngine.getRoomObjectCategoryForType(e.objectType)))}onRoomObjectBadgeAssetEvent(e,t){if(!(!e||!this._roomEngine))switch(e.type){case Wa.LOAD_BADGE:{const i=e.objectId,r=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);this._roomEngine.loadRoomObjectBadgeImage(t,i,n,e.badgeId,e.groupBadge);return}}}handleMousePointer(e,t){e&&this._roomEngine.updateMousePointer(e.type,e.objectId,e.objectType)}handleRoomObjectPlaySoundEvent(e,t){const i=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(e.type){case Tl.PLAY_SOUND:this._roomEngine.events.dispatchEvent(new Ih(Ih.PLAY_SOUND,t,e.objectId,i,e.soundId,e.pitch));return;case Tl.PLAY_SOUND_AT_PITCH:this._roomEngine.events.dispatchEvent(new Ih(Ih.PLAY_SOUND_AT_PITCH,t,e.objectId,i,e.soundId,e.pitch));return}}handleRoomObjectSamplePlaybackEvent(e,t){if(!e)return;const i=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(e.type){case Ii.ROOM_OBJECT_INITIALIZED:this._roomEngine.events.dispatchEvent(new Un(Un.ROOM_OBJECT_INITIALIZED,t,e.objectId,i,e.sampleId,e.pitch));break;case Ii.ROOM_OBJECT_DISPOSED:this._roomEngine.events.dispatchEvent(new Un(Un.ROOM_OBJECT_DISPOSED,t,e.objectId,i,e.sampleId,e.pitch));break;case Ii.PLAY_SAMPLE:this._roomEngine.events.dispatchEvent(new Un(Un.PLAY_SAMPLE,t,e.objectId,i,e.sampleId,e.pitch));break;case Ii.CHANGE_PITCH:this._roomEngine.events.dispatchEvent(new Un(Un.CHANGE_PITCH,t,e.objectId,i,e.sampleId,e.pitch));break}}onHSLColorEnableEvent(e,t){if(!(!e||!this._roomEngine))switch(e.type){case El.ROOM_BACKGROUND_COLOR:this._roomEngine.events.dispatchEvent(new yg(yg.ROOM_BACKGROUND_COLOR,t,e.enable,e.hue,e.saturation,e.lightness));return}}onRoomObjectDataRequestEvent(e,t){if(!(!e||!this._roomEngine||!e.object))switch(e.type){case da.RODRE_CURRENT_USER_ID:e.object.model.setValue(D.SESSION_CURRENT_USER_ID,this._roomEngine.sessionDataManager.userId);return;case da.RODRE_URL_PREFIX:e.object.model.setValue(D.SESSION_URL_PREFIX,st.getValue("url.prefix"));return}}onRoomObjectTileMouseEvent(e,t){if(!this._roomEngine||this._roomEngine.isDecorating||!this._roomEngine.roomSessionManager)return;const i=this._roomEngine.roomSessionManager.getSession(e);!i||i.isSpectator||this._roomEngine.isMoveBlocked()||Cb()||this.sendWalkUpdate(t.tileXAsInt,t.tileYAsInt)}handleObjectMove(e,t){if(!e||!this._roomEngine||!this._roomEngine.events)return;const r=this.getSelectedRoomObjectData(t);if(!r)return;const n=this._roomEngine.getRoomObject(t,r.id,r.category);if(!n)return;let o=!0;if(r.category===Q.FLOOR||r.category===Q.UNIT){const l=this._roomEngine.getFurnitureStackingHeightMap(t);Nb()&&n.setState(Ab()),e instanceof Ta&&this.handleFurnitureMove(n,r,Math.trunc(e.tileX+.5),Math.trunc(e.tileY+.5),l)||(this.handleFurnitureMove(n,r,r.loc.x,r.loc.y,l),o=!1)}else if(r.category===Q.WALL){if(o=!1,e instanceof ph){const l=e.wallLocation,c=e.wallWidth,u=e.wallHeight,d=e.x,_=e.y,m=e.direction;this.handleWallItemMove(n,r,l,c,u,d,_,m)&&(o=!0)}o||(n.setLocation(r.loc),n.setDirection(r.dir)),this._roomEngine.updateRoomObjectMask(t,r.id,o)}o?(this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!1)):(this.setFurnitureAlphaMultiplier(n,0),this._roomEngine.setObjectMoverIconSpriteVisible(!0))}handleObjectPlace(e,t){if(!e||!this._roomEngine||!this._roomEngine.events)return;let r=this.getSelectedRoomObjectData(t);if(!r)return;let n=this._roomEngine.getRoomObject(t,r.id,r.category);if(!n){if(e instanceof Ta){if(r.category===Q.FLOOR)this._roomEngine.addFurnitureFloor(t,r.id,r.typeId,r.loc,r.dir,Nb()?Ab():0,r.stuffData,parseFloat(r.instanceData),-1,0,0,"",!1);else if(r.category===Q.UNIT){this._roomEngine.addRoomObjectUser(t,r.id,new Y,new Y(180),180,r.typeId,r.instanceData);const o=this._roomEngine.getRoomObject(t,r.id,r.category);o&&r.posture&&o.model.setValue(D.FIGURE_POSTURE,r.posture)}}else e instanceof ph&&r.category===Q.WALL&&this._roomEngine.addFurnitureWall(t,r.id,r.typeId,r.loc,r.dir,0,r.instanceData,0);if(n=this._roomEngine.getRoomObject(t,r.id,r.category),n&&r.category===Q.FLOOR){const o=n.model.getValue(D.FURNITURE_ALLOWED_DIRECTIONS);if(o&&o.length){const l=new Y(o[0]);if(n.setDirection(l),this.updateSelectedObjectData(t,r.id,r.category,r.loc,l,r.operation,r.typeId,r.instanceData,r.stuffData,r.state,r.animFrame,r.posture),r=this.getSelectedRoomObjectData(t),!r)return}}this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!0)}if(n){let o=!0;const l=this._roomEngine.getFurnitureStackingHeightMap(t);if(r.category===Q.FLOOR)e instanceof Ta&&this.handleFurnitureMove(n,r,Math.trunc(e.tileX+.5),Math.trunc(e.tileY+.5),l)||(this._roomEngine.removeRoomObjectFloor(t,r.id),o=!1);else if(r.category===Q.WALL){if(o=!1,e instanceof ph){const c=e.wallLocation,u=e.wallWidth,d=e.wallHeight,_=e.x,m=e.y,f=e.direction;this.handleWallItemMove(n,r,c,u,d,_,m,f)&&(o=!0)}o||this._roomEngine.removeRoomObjectWall(t,r.id),this._roomEngine.updateRoomObjectMask(t,r.id,o)}else r.category===Q.UNIT&&(e instanceof Ta&&this.handleUserPlace(n,Math.trunc(e.tileX+.5),Math.trunc(e.tileY+.5),this._roomEngine.getLegacyWallGeometry(t))||(this._roomEngine.removeRoomObjectUser(t,r.id),o=!1));this._roomEngine.setObjectMoverIconSpriteVisible(!o)}}handleFurnitureMove(e,t,i,r,n){if(!e||!t)return!1;const o=new Y;o.assign(e.getDirection()),e.setDirection(tn()===-1?t.dir:new Y(45*tn()));const l=new Y(i,r,0),c=new Y;c.assign(e.getDirection());let u=this.validateFurnitureLocation(e,l,t.loc,t.dir,n);return u||(c.x=this.getValidRoomObjectDirection(e,!0),e.setDirection(c),u=this.validateFurnitureLocation(e,l,t.loc,t.dir,n)),u?(e.setLocation(u),c&&e.setDirection(c),!0):(e.setDirection(o),!1)}handleWallItemMove(e,t,i,r,n,o,l,c){if(!e||!t)return!1;const u=new Y(c),d=this.validateWallItemLocation(e,i,r,n,o,l,t);return d?(e.setLocation(d),e.setDirection(u),!0):!1}validateFurnitureLocation(e,t,i,r,n){if(!e||!e.model||!t)return null;let o=null;const l=e.getDirection();if(!l||!i||!r)return null;if(t.x===i.x&&t.y===i.y&&l.x===r.x)return o=new Y,o.assign(i),bb()&&(o.z=i.z),gc()&&(o.z=fp()),o;let c=e.model.getValue(D.FURNITURE_SIZE_X),u=e.model.getValue(D.FURNITURE_SIZE_Y);c<1&&(c=1),u<1&&(u=1);const d=i.x,_=i.y;let m=c,f=u,E=0,I=Math.trunc(Math.trunc(l.x+45)%360/90);if((I===1||I===3)&&(E=c,c=u,u=E),I=Math.trunc(Math.trunc(r.x+45)%360/90),(I===1||I===3)&&(E=m,m=f,f=E),n&&t){const p=e.model.getValue(D.FURNITURE_ALWAYS_STACKABLE)===1||gc();return n.validateLocation(t.x,t.y,c,u,d,_,m,f,p)?gc()?new Y(t.x,t.y,fp()):bb()?new Y(t.x,t.y,i.z):new Y(t.x,t.y,n.getTileHeight(t.x,t.y)):null}return null}validateWallItemLocation(e,t,i,r,n,o,l){if(e==null||e.model==null||t==null||i==null||r==null||l==null)return null;const c=e.model.getValue(D.FURNITURE_SIZE_X),u=e.model.getValue(D.FURNITURE_SIZE_Z),d=e.model.getValue(D.FURNITURE_CENTER_Z);if((n<c/2||n>i.length-c/2||o<d||o>r.length-(u-d))&&(n<c/2&&n<=i.length-c/2?n=c/2:n>=c/2&&n>i.length-c/2&&(n=i.length-c/2),o<d&&o<=r.length-(u-d)?o=d:o>=d&&o>r.length-(u-d)&&(o=r.length-(u-d))),n<c/2||n>i.length-c/2||o<d||o>r.length-(u-d))return null;let _=Y.sum(Y.product(i,n/i.length),Y.product(r,o/r.length));return _=Y.sum(t,_),_}changeObjectState(e,t,i,r,n){const o=this._roomEngine.getRoomObjectCategoryForType(i);this.changeRoomObjectState(e,t,o,r,n)}useObject(e,t,i,r){if(!(!this._roomEngine||!this._roomEngine.connection))switch(r){case Ae.DICE_ACTIVATE:this._roomEngine.connection.send(new mw(t));return;case Ae.DICE_OFF:this._roomEngine.connection.send(new fw(t));return;case Ae.USE_HABBOWHEEL:this._roomEngine.connection.send(new gw(t));return;case Ae.STICKIE:this._roomEngine.connection.send(new Z1(t));return;case Ae.ENTER_ONEWAYDOOR:this._roomEngine.connection.send(new Ew(t));return}}changeRoomObjectState(e,t,i,r,n){if(!this._roomEngine||!this._roomEngine.connection)return!0;const o=this._roomEngine.roomSessionManager.getSession(e);if(o&&o.playTestMode){const l=this._roomEngine.getRoomObject(e,t,i);if(Number(l.model.getValue("furniture_usage_policy"))<2)return!1}return i===Q.FLOOR?n?(this._roomEngine.connection.send(new Iw(t,r)),Cr.addUndo(It.FURNITURE_SET_STATE,[t,r])):(this._roomEngine.connection.send(new ko(t,r)),Cr.addUndo(It.FURNITURE_SET_STATE,[t,r])):i===Q.WALL&&(this._roomEngine.connection.send(new oN(t,r)),Cr.addUndo(It.FURNITURE_WALL_SET_STATE,[t,r])),!0}sendWalkUpdate(e,t){!this._roomEngine||!this._roomEngine.connection||this._roomEngine.connection.send(new Yw(e,t))}handleMouseOverObject(e,t,i){if(e!==Q.FLOOR)return null;const r=this._roomEngine.getRoomObject(t,i.objectId,Q.FLOOR);if(!r)return null;const n=this.getActiveSurfaceLocation(r,i);if(!n||!this._roomEngine.getFurnitureStackingHeightMap(t))return null;const l=n.x,c=n.y,u=n.z;return new Eh(new Y(l,c,r.getLocation().z),u,!0,i.eventId)}handleMoveTargetFurni(e,t){if(t.objectType===Ft.USER||t.objectType===Ft.PET||t.objectType===Ft.BOT||t.objectType===Ft.RENTABLE_BOT||t.objectType===Ft.MONSTER_PLANT)return;const i=this._roomEngine.getRoomObject(e,t.objectId,Q.FLOOR),r=this.getActiveSurfaceLocation(i,t);return r&&!this._roomEngine.isMoveBlocked()&&!Cb()?(this.sendWalkUpdate(r.x,r.y),!0):!1}getActiveSurfaceLocation(e,t){if(!e||!t)return null;const i=this._roomEngine.sessionDataManager.getFloorItemDataByName(e.type);if(!i||!i.canStandOn&&!i.canSitOn&&!i.canLayOn)return null;const r=e.model;if(!r)return null;const n=e.getLocation(),o=e.getDirection();let l=r.getValue(D.FURNITURE_SIZE_X),c=r.getValue(D.FURNITURE_SIZE_Y);const u=r.getValue(D.FURNITURE_SIZE_Z);(o.x===90||o.x===270)&&([l,c]=[c,l]),l<1&&(l=1),c<1&&(c=1);const d=this._roomEngine.getActiveRoomInstanceRenderingCanvas();if(!d)return null;const _=d.geometry.scale,m=i.canSitOn?.5:0,f=(_/2+t.spriteOffsetX+t.localX)/(_/4),E=(t.spriteOffsetY+t.localY+(u-m)*_/2)/(_/4),I=(f+2*E)/4,p=(f-2*E)/4,S=Math.floor(n.x+I),R=Math.floor(n.y-p+1);let O=!1;(S<n.x||S>=n.x+l||R<n.y||R>=n.y+c)&&(O=!0);const C=i.canSitOn?u-.5:u;return O?null:new Y(S,R,C)}handleMouseOverTile(e,t){if(this.isWhereYouClickWhereYouGo())return new Eh(new Y(e.tileXAsInt,e.tileYAsInt,e.tileZAsInt),0,!0,e.eventId);const i=this._roomEngine.getRoomObjectCursor(t);if(i&&i.visualization){const r=e.tileXAsInt,n=e.tileYAsInt,o=e.tileZAsInt;if(this._roomEngine.getRoomInstance(t)){const c=this._roomEngine.getRoomTileObjectMap(t);if(c){const u=c.getObjectIntTile(r,n),d=this._roomEngine.getFurnitureStackingHeightMap(t);if(d){if(u&&u.model&&u.model.getValue(D.FURNITURE_IS_VARIABLE_HEIGHT)>0){const _=d.getTileHeight(r,n),m=this._roomEngine.getLegacyWallGeometry(t).getHeight(r,n);return new Eh(new Y(r,n,o),_-m,!0,e.eventId)}return new Eh(new Y(r,n,o),0,!0,e.eventId)}}}}return null}placeObject(e,t,i,r){const n=this.getSelectedRoomObjectData(t);if(!n)return;let o=null,l=n.id;const c=n.category;n.typeId;let u=0,d=0,_=0,m=0,f="";if(this._roomEngine&&this._roomEngine.connection&&(o=this._roomEngine.getRoomObject(t,l,c),o)){const E=o.getLocation();if(m=o.getDirection().x,c===Q.FLOOR||c===Q.UNIT)u=E.x,d=E.y,_=E.z;else if(c===Q.WALL){u=E.x,d=E.y,_=E.z;const I=this._roomEngine.getLegacyWallGeometry(t);I&&(f=I.getOldLocationString(E,m))}m=(m/45%8+8)%8,l<0&&c===Q.UNIT&&(l=l*-1),this._objectPlacementSource!==zn.CATALOG&&this._objectPlacementSource!==zn.INFO_STAND&&(c===Q.UNIT?n.typeId===Xt.PET?this._roomEngine.connection.send(new tw(l,Math.trunc(u),Math.trunc(d))):n.typeId===Xt.RENTABLE_BOT&&this._roomEngine.connection.send(new $1(l,Math.trunc(u),Math.trunc(d))):o.model.getValue(D.FURNITURE_IS_STICKIE)!==void 0?(this._roomEngine.connection.send(new ET(l,f)),Cr.addUndo(It.FURNITURE_PLACE,[l,c,f,Math.trunc(u),Math.trunc(d),m,!0])):(this._roomEngine.connection.send(new mm(l,c,f,Math.trunc(u),Math.trunc(d),m)),Cr.addUndo(It.FURNITURE_PLACE,[l,c,f,Math.trunc(u),Math.trunc(d),m,!1])))}if(this._roomEngine.setPlacedRoomObjectData(t,new QT(n.id,n.category,null,n.dir,null)),this.resetSelectedObjectData(t),this._roomEngine&&this._roomEngine.events){const E=o&&o.id===n.id;this._roomEngine.events.dispatchEvent(new Tf(ke.PLACED,t,l,c,f,u,d,_,m,E,i,r,n.instanceData,this._objectPlacementSource))}}isValidLocation(e,t,i){if(!e||!e.model||!t)return!1;const r=e.getDirection(),n=e.getLocation();if(!r||!n)return!1;if(r.x%180===t.x%180)return!0;let o=e.model.getValue(D.FURNITURE_SIZE_X),l=e.model.getValue(D.FURNITURE_SIZE_Y);o<1&&(o=1),l<1&&(l=1);let c=o,u=l,d=Math.trunc(Math.trunc(t.x+45)%360/90);if((d===1||d===3)&&([o,l]=[l,o]),d=Math.trunc(Math.trunc(r.x+45)%360/90),(d===1||d===3)&&([c,u]=[u,c]),i&&n){const _=e.model.getValue(D.FURNITURE_ALWAYS_STACKABLE)===1||gc();if(i.validateLocation(n.x,n.y,o,l,n.x,n.y,c,u,_,n.z))return!0}return!1}placeObjectOnUser(e,t,i){const r=this.getSelectedRoomObjectData(e);!r||!this._roomEngine.getRoomObject(e,t,i)||!this._roomEngine||!this._roomEngine.events||this._roomEngine.events.dispatchEvent(new u2(ke.PLACED_ON_USER,e,t,i,r.id,r.category))}deselectObject(e){if(this._selectedObjectId===-1)return;const t=this._roomEngine.getRoomObject(e,this._selectedObjectId,this._selectedObjectCategory);t&&t.logic&&(t.logic.processUpdateMessage(new Jg(!1)),this._selectedObjectId=-1,this._selectedObjectCategory=Q.MINIMUM)}resetSelectedObjectData(e){if(!this._roomEngine)return;this._roomEngine.removeObjectMoverIconSprite();const t=this.getSelectedRoomObjectData(e);if(t){if(t.operation===at.OBJECT_MOVE||t.operation===at.OBJECT_MOVE_TO){const i=this._roomEngine.getRoomObject(e,t.id,t.category);i&&t.operation!==at.OBJECT_MOVE_TO&&(i.setLocation(t.loc),i.setDirection(t.dir)),this.setFurnitureAlphaMultiplier(i,1),t.category===Q.WALL&&this._roomEngine.updateRoomObjectMask(e,t.id,!0),this.updateSelectedObjectData(e,t.id,t.category,t.loc,t.dir,at.OBJECT_MOVE,t.typeId,t.instanceData,t.stuffData,t.state,t.animFrame,t.posture)}else if(t.operation===at.OBJECT_PLACE){const i=t.id;switch(t.category){case Q.FLOOR:this._roomEngine.removeRoomObjectFloor(e,i);break;case Q.WALL:this._roomEngine.removeRoomObjectWall(e,i);break;case Q.UNIT:this._roomEngine.removeRoomObjectUser(e,i);break}}this._roomEngine.setSelectedRoomObjectData(e,null)}}getSelectedRoomObjectData(e){return this._roomEngine?this._roomEngine.getSelectedRoomObjectData(e):null}setFurnitureAlphaMultiplier(e,t){!e||!e.model||e.model.setValue(D.FURNITURE_ALPHA_MULTIPLIER,t)}decorateModeMove(e){return this._roomEngine.isDecorating&&!(e.ctrlKey||e.shiftKey)}setSelectedRoomObjectData(e,t,i,r,n,o,l=0,c=null,u=null,d=-1,_=-1,m=null){if(this.resetSelectedObjectData(e),!this._roomEngine)return;const f=new QT(t,i,o,r,n,l,c,u,d,_,m);this._roomEngine.setSelectedRoomObjectData(e,f)}updateSelectedObjectData(e,t,i,r,n,o,l=0,c=null,u=null,d=-1,_=-1,m=null){if(!this._roomEngine)return null;const f=new QT(t,i,o,r,n,l,c,u,d,_,m);this._roomEngine.setSelectedRoomObjectData(e,f)}handleUserPlace(e,t,i,r){return r.isRoomTile(t,i)?(e.setLocation(new Y(t,i,r.getHeight(t,i))),!0):!1}isWhereYouClickWhereYouGo(){return this._roomEngine.isWhereYouClickWhereYouGo()}}class Oee{constructor(){this._events=new Sn,this._cachedEvents=new Map,this._registeredEvents=new Map,this._functions=[]}get events(){return this._events}getLogic(e){const t=this.getLogicType(e);if(!t)return null;const i=new t;if(!i)return null;if(i.eventDispatcher=this._events,!this._cachedEvents.get(e)){this._cachedEvents.set(e,!0);const r=i.getEventTypes();for(const n of r)n&&this.registerEventType(n)}return i}registerEventFunction(e){if(e&&!(this._functions.indexOf(e)>=0)){this._functions.push(e);for(const t of this._registeredEvents.keys())t&&this._events.addEventListener(t,e)}}removeEventFunction(e){if(!e)return;const t=this._functions.indexOf(e);if(t!==-1){this._functions.splice(t,1);for(const i of this._registeredEvents.keys())i&&this._events.removeEventListener(i,e)}}getLogicType(e){if(!e)return null;let t=null;switch(e){case Ke.ROOM:t=fee;break;case Ke.TILE_CURSOR:t=wO;break;case Ke.SELECTION_ARROW:t=pee;break;case Ke.USER:case Ke.BOT:case Ke.RENTABLE_BOT:t=Jx;break;case Ke.PET:t=FZ;break;case Ke.FURNITURE_BASIC:t=$t;break;case Ke.FURNITURE_BADGE_DISPLAY:t=gG;break;case Ke.FURNITURE_CHANGE_STATE_WHEN_STEP_ON:t=YJ;break;case Ke.FURNITURE_COUNTER_CLOCK:t=KJ;break;case Ke.FURNITURE_CRACKABLE:t=qJ;break;case Ke.FURNITURE_CREDIT:t=$J;break;case Ke.FURNITURE_CUSTOM_STACK_HEIGHT:t=JJ;break;case Ke.FURNITURE_DICE:t=ZJ;break;case Ke.FURNITURE_EDITABLE_INTERNAL_LINK:t=tZ;break;case Ke.FURNITURE_EDITABLE_ROOM_LINK:t=sZ;break;case Ke.FURNITURE_EXTERNAL_IMAGE_WALLITEM:t=rZ;break;case Ke.FURNITURE_FIREWORKS:t=nZ;break;case Ke.FURNITURE_FLOOR_HOLE:t=eO;break;case Ke.FURNITURE_GUILD_CUSTOMIZED:t=vp;break;case Ke.FURNITURE_HIGH_SCORE:t=tO;break;case Ke.FURNITURE_HOCKEY_SCORE:t=lZ;break;case Ke.FURNITURE_ES:t=uZ;break;case Ke.FURNITURE_MANNEQUIN:t=sO;break;case Ke.FURNITURE_MULTIHEIGHT:t=gZ;break;case Ke.FURNITURE_MULTISTATE:t=ii;break;case Ke.FURNITURE_ONE_WAY_DOOR:t=pZ;break;case Ke.FURNITURE_PET_CUSTOMIZATION:t=EZ;break;case Ke.FURNITURE_PRESENT:t=iO;break;case Ke.FURNITURE_PURCHASABLE_CLOTHING:t=SZ;break;case Ke.FURNITURE_PUSHABLE:t=rO;break;case Ke.FURNITURE_BACKGROUND_COLOR:t=CZ;break;case Ke.FURNITURE_BG:t=NZ;break;case Ke.FURNITURE_BB:t=AZ;break;case Ke.FURNITURE_ROOMDIMMER:t=bZ;break;case Ke.FURNITURE_SCORE:t=nO;break;case Ke.FURNITURE_SOUNDBLOCK:t=aO;break;case Ke.FURNITURE_STICKIE:t=oO;break;case Ke.FURNITURE_TROPHY:t=DZ;break;case Ke.FURNITURE_VOTE_COUNTER:t=lO;break;case Ke.FURNITURE_VOTE_MAJORITY:t=MZ;break;case Ke.FURNITURE_WINDOW:t=LZ;break;case Ke.FURNITURE_LOVELOCK:t=Vb;break;case Ke.FURNITURE_YOUTUBE:t=PZ;break;case Ke.FURNITURE_CRAFTING_GIZMO:t=XJ;break;case Ke.FURNITURE_RENTABLE_SPACE:t=OZ;break;case Ke.FURNITURE_EFFECTBOX:t=iZ;break;case Ke.FURNITURE_MONSTERPLANT_SEED:t=_Z;break;case Ke.FURNITURE_MYSTERYBOX:t=mZ;break;case Ke.FURNITURE_MYSTERYTROPHY:t=fZ;break;case Ke.FURNITURE_RANDOM_TELEPORT:t=xZ;break;case Ke.FURNITURE_CLOTHING_CHANGE:t=zJ;break;case Ke.FURNITURE_CUCKOO_CLOCK:t=QJ;break;case Ke.FURNITURE_ECOTRON_BOX:t=eZ;break;case Ke.FURNITURE_GROUP_FORUM_TERMINAL:t=aZ;break;case Ke.FURNITURE_WILDWEST_WANTED:t=wZ;break;case Ke.FURNITURE_INFINITY_LOVE:t=Vb;break;case Ke.FURNITURE_HWEEN_LOVELOCK:t=cZ;break;case Ke.FURNITURE_INTERNAL_LINK:t=hZ;break;case Ke.FURNITURE_JUKEBOX:t=dZ;break;case Ke.FURNITURE_PLACEHOLDER:t=IZ;break;case Ke.FURNITURE_PLANET_SYSTEM:t=TZ;break;case Ke.FURNITURE_RANDOMSTATE:t=RZ;break;case Ke.FURNITURE_SONG_DISK:t=vZ;break;case Ke.FURNITURE_SOUND_MACHINE:t=yZ;break;case Ke.FURNITURE_WELCOME_GIFT:t=jZ;break;case Ke.FURNITURE_ACHIEVEMENT_RESOLUTION:t=Zx;break;case Ke.FURNITURE_HABBOWHEEL:t=oZ;break;case Ke.FURNITURE_AREA_HIDE:t=UZ;break;default:t=$t;break}return t||(ze.warn("Unknown Logic",e),null)}registerEventType(e){if(!this._registeredEvents.get(e)){this._registeredEvents.set(e,!0);for(const t of this._functions)t&&this._events.addEventListener(e,t)}}}class Cee extends Qr{constructor(e){super(),this._hasClickUserWired=!1,this._events=e}setConnection(e){this._connection=e,this._connection.addMessageEvent(new uL(this.onWiredEnvironmentEvent.bind(this))),this._connection.addMessageEvent(new cL(this.onWiredClickUserResponseEvent.bind(this)))}onWiredClickUserResponseEvent(e){const t=e.getParser();t&&this._events.dispatchEvent(new jg(jg.WIRED_USER_CLICK_HANDLED,t.index,t.openMenu))}onWiredEnvironmentEvent(e){const t=e.getParser();t&&(this._hasClickUserWired=t.hasClickUserWired)}get hasClickUserWired(){return this._hasClickUserWired}onDispose(){super.onDispose(),this._connection=null,this._hasClickUserWired=!1}}const Mt=class Mt extends Wo{constructor(e){super(),this._isMobile=!1,this.zoomInterval=null,this._communication=e,this._sessionDataManager=null,this._roomSessionManager=null,this._roomManager=null,this._roomObjectEventHandler=new xee(this),this._roomMessageHandler=new Ree(this),this._roomContentLoader=new Id,this._ready=!1,this._roomContentLoaderReady=!1,this._activeRoomId=-1,this._activeRoomActiveCanvas=-1,this._roomInstanceDatas=new Map,this._roomDatas=new Map,this._roomRendererFactory=new L2,this._visualizationFactory=new FO,this._logicFactory=new Oee,this._wiredEnvironment=new Cee(this.events),this._activeRoomActiveCanvasMouseX=0,this._activeRoomActiveCanvasMouseY=0,this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=0,this._activeRoomDragStartY=0,this._activeRoomDragX=0,this._activeRoomDragY=0,this._skipFurnitureCreationForNextFrame=!1,this._mouseCursorUpdate=!1,this._imageObjectIdBank=null,this._imageCallbacks=new Map,this._thumbnailCallbacks=new Map,this._roomDraggingAlwaysCenters=!1,this._roomAllowsDragging=!0,this._badgeListenerObjects=new Map,this._whereYouClickWhereYouGo=!1,this._moveBlocked=!1,this.runVisibilityUpdate=this.runVisibilityUpdate.bind(this),this.processRoomObjectEvent=this.processRoomObjectEvent.bind(this),this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this),this.onRoomContentLoaderReadyEvent=this.onRoomContentLoaderReadyEvent.bind(this),this.onBadgeImageReadyEvent=this.onBadgeImageReadyEvent.bind(this)}get roomRendererFactory(){return this._roomRendererFactory}get roomManager(){return this._roomManager}set roomManager(e){this._roomManager=e}get visualizationFactory(){return this._visualizationFactory}get sessionDataManager(){return this._sessionDataManager}set sessionDataManager(e){this._sessionDataManager=e}get roomSessionManager(){return this._roomSessionManager}set roomSessionManager(e){this._roomSessionManager=e}get roomContentLoader(){return this._roomContentLoader}get ready(){return this._ready}get activeRoomId(){return this._activeRoomId}get logicFactory(){return this._logicFactory}get areaSelectionManager(){return this._areaSelectionManager}get connection(){return this._communication.connection}get objectEventHandler(){return this._roomObjectEventHandler}get isDecorating(){if(!this._roomSessionManager)return!1;const e=this._roomSessionManager.getSession(this._activeRoomId);return e&&e.isDecorating||!1}get isMobile(){return this._isMobile}get selectedAvatarId(){return this._roomObjectEventHandler?this._roomObjectEventHandler.selectedAvatarId:-1}get cameraFollowDuration(){return 1e3}get useOffsetScrolling(){return!0}onInit(){this._ready||(this._imageObjectIdBank=new ob(1e3),this._thumbnailObjectIdBank=new ob(1e3),this._logicFactory.registerEventFunction(this.processRoomObjectEvent),this._roomManager&&(this._roomManager.setContentLoader(this._roomContentLoader),this._roomManager.addUpdateCategory(Q.FLOOR),this._roomManager.addUpdateCategory(Q.WALL),this._roomManager.addUpdateCategory(Q.UNIT),this._roomManager.addUpdateCategory(Q.CURSOR),this._roomManager.addUpdateCategory(Q.ROOM)),this._roomMessageHandler.setConnection(this._communication.connection),this._roomContentLoader.initialize(this.events),this._roomContentLoader.setSessionDataManager(this._sessionDataManager),this._roomContentLoader.setIconListener(this),this._wiredEnvironment.setConnection(this._communication.connection),this._roomSessionManager&&(this._roomSessionManager.events.addEventListener(Ve.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.addEventListener(Ve.ENDED,this.onRoomSessionEvent)),this.events.addEventListener(Id.LOADER_READY,this.onRoomContentLoaderReadyEvent),this._areaSelectionManager=new Cd(this),this._isMobile=(()=>{const e=navigator.userAgent,t="ontouchstart"in window||navigator.maxTouchPoints>0,i=window.matchMedia&&window.matchMedia("(max-width: 768px)").matches;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)&&t&&i})(),Gi().add(this.update,this),document.addEventListener("visibilitychange",this.runVisibilityUpdate),window.addEventListener("keydown",this.onKeyPress.bind(this)))}onKeyPress(e){e.key==="Escape"&&(this.cancelRoomObjectPlacement(),bc(-1),Nc(!1))}onDispose(){if(this._ready){for(const[e,t]of this._roomInstanceDatas)this.removeRoomInstance(e);document.removeEventListener("visibilitychange",this.runVisibilityUpdate),window.removeEventListener("keypress",this.onKeyPress.bind(this)),Gi().remove(this.update,this),this._roomObjectEventHandler&&this._roomObjectEventHandler.dispose(),this._roomMessageHandler&&this._roomMessageHandler.dispose(),this._roomContentLoader&&this._roomContentLoader.dispose(),this._wiredEnvironment&&this._wiredEnvironment.dispose(),this.events.removeEventListener(Id.LOADER_READY,this.onRoomContentLoaderReadyEvent),this._roomSessionManager&&(this._roomSessionManager.events.removeEventListener(Ve.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.removeEventListener(Ve.ENDED,this.onRoomSessionEvent)),super.onDispose(),Cr.clearHistory(),Fd.clearHistory()}}setActiveRoomId(e){this._activeRoomId=e}destroyRoom(e){this.removeRoomInstance(e)}getRoomInstance(e){return this._roomManager&&this._roomManager.getRoomInstance(this.getRoomId(e))||null}removeRoomInstance(e){this.getRoomInstance(e)&&this._roomManager&&this._roomManager.removeRoomInstance(this.getRoomId(e));const i=this._roomInstanceDatas.get(e);i&&(this._roomInstanceDatas.delete(i.roomId),i.dispose()),this.events.dispatchEvent(new Ot(Ot.DISPOSED,e))}createRoomInstance(e,t){let i="111",r="201",n="1";if(!this._ready){let c=this._roomDatas.get(e);c&&(this._roomDatas.delete(e),i=c.floorType,r=c.wallType,n=c.landscapeType),c=new qb(e,t),c.floorType=i,c.wallType=r,c.landscapeType=n,this._roomDatas.set(e,c),ze.warn("Room Engine not initilized yet, can not create room. Room data stored for later initialization.");return}if(!t){ze.warn("Room property messages");return}const o=this._roomDatas.get(e);o&&(this._roomDatas.delete(e),o.floorType&&(i=o.floorType),o.wallType&&(r=o.wallType),o.landscapeType&&(n=o.landscapeType)),this.setupRoomInstance(e,t,i,r,n,this.getRoomInstanceModelName(e))&&(this._roomAllowsDragging=!t.restrictsDragging,this.events.dispatchEvent(new Ot(Ot.INITIALIZED,e)))}getRoomInstanceDisplay(e,t,i,r,n){const o=this.getRoomInstance(e);if(!o)return null;let l=o.renderer;if(!l&&(l=this._roomRendererFactory.createRenderer(),!l))return null;l.roomObjectVariableAccurateZ=D.OBJECT_ACCURATE_Z_VALUE,o.setRenderer(l);const c=l.createCanvas(t,i,r,n);if(!c)return null;if(o.model.getValue(Vs.RESTRICTS_SCALING)){let d=o.model.getValue(Vs.RESTRICTED_SCALE);d||(d=1),c.setScale(d),c.restrictsScaling=!0}else c.restrictsScaling=!1;if(c.setMouseListener(this._roomObjectEventHandler),c.geometry){c.geometry.z_scale=o.model.getValue(Vs.ROOM_Z_SCALE);const d=o.model.getValue(D.ROOM_DOOR_X),_=o.model.getValue(D.ROOM_DOOR_Y),m=o.model.getValue(D.ROOM_DOOR_Z),f=o.model.getValue(D.ROOM_DOOR_DIR),E=new Y(d,_,m);let I=null;f===90&&(I=new Y(-2e3,0,0)),f===180&&(I=new Y(0,-2e3,0)),c.geometry.setDisplacement(E,I);const p=c.master;if(p){const S=new Is(Qs.EMPTY);S.name=Mt.OVERLAY,S.interactive=!1,p.addChild(S)}}return c.master}setRoomInstanceRenderingCanvasMask(e,t,i){const r=this.getRoomInstanceRenderingCanvas(e,t);r&&r.setMask(i)}setRoomInstanceRenderingCanvasScale(e,t,i,r=null,n=null,o=!1,l=!1){const c=this.getRoomInstanceRenderingCanvas(e,t);if(c){if(c.restrictsScaling&&!o)return;c.setScale(i,r,n,o,l),this.events.dispatchEvent(new Ot(Ot.ROOM_ZOOMED,e))}}getRoomInstanceRenderingCanvas(e,t=-1){const i=this.getRoomInstance(e);if(!i)return null;const r=i.renderer;if(!r)return null;t===-1&&(t=this._activeRoomActiveCanvas);const n=r.getCanvas(t);return n||null}getActiveRoomInstanceRenderingCanvas(){return this.getRoomInstanceRenderingCanvas(this._activeRoomId,this._activeRoomActiveCanvas)}getRoomInstanceRenderingCanvasOffset(e,t=-1){t===-1&&(t=this._activeRoomActiveCanvas);const i=this.getRoomInstanceRenderingCanvas(e,t);return i?new ot(i.screenOffsetX,i.screenOffsetY):null}setRoomInstanceRenderingCanvasOffset(e,t,i){const r=this.getRoomInstanceRenderingCanvas(e,t);if(!r||!i)return!1;const n=~~i.x,o=~~i.y;if(!(r.screenOffsetX===n&&r.screenOffsetY===o))return this.events.dispatchEvent(new Ef(e,-(r.screenOffsetX-n),-(r.screenOffsetY-o))),r.screenOffsetX=n,r.screenOffsetY=o,!0}getRoomInstanceRenderingCanvasScale(e=-1e3,t=-1){e===-1e3&&(e=this._activeRoomId),t===-1&&(t=this._activeRoomActiveCanvas);const i=this.getRoomInstanceRenderingCanvas(e,t);return i?i.scale:1}initializeRoomInstanceRenderingCanvas(e,t,i,r){const n=this.getRoomInstanceRenderingCanvas(e,t);n&&n.initialize(i,r)}getRoomInstanceGeometry(e,t=-1){const i=this.getRoomInstance(e);if(!i)return null;const r=i.renderer;if(!r)return null;t===-1&&(t=this._activeRoomActiveCanvas);const n=r.getCanvas(t);return n?n.geometry:null}getRoomInstanceVariable(e,t){const i=this.getRoomInstance(e);return i&&i.model&&i.model.getValue(t)||null}updateRoomInstancePlaneVisibility(e,t,i=!0){const r=this.getRoomOwnObject(e);return r?(r.processUpdateMessage(new xl(xl.WALL_VISIBILITY,t)),r.processUpdateMessage(new xl(xl.FLOOR_VISIBILITY,i)),!0):!1}updateRoomInstancePlaneThickness(e,t,i){const r=this.getRoomOwnObject(e);return r?(r.processUpdateMessage(new Rl(Rl.WALL_THICKNESS,t)),r.processUpdateMessage(new Rl(Rl.FLOOR_THICKNESS,i)),!0):!1}updateRoomInstancePlaneFilter(e,t){return this.applyEffect(t),!0}updateRoomInstancePlaneType(e,t=null,i=null,r=null,n=!1){const o=this.getRoomOwnObject(e),l=this.getRoomInstance(e);if(!o){let c=this._roomDatas.get(e);return c||(c=new qb(e,null),this._roomDatas.set(e,c)),t&&(c.floorType=t),i&&(c.wallType=i),r&&(c.landscapeType=r),!0}return t&&(l&&!n&&l.model.setValue(D.ROOM_FLOOR_TYPE,t),o.processUpdateMessage(new Xi(Xi.ROOM_FLOOR_UPDATE,t))),i&&(l&&!n&&l.model.setValue(D.ROOM_WALL_TYPE,i),o.processUpdateMessage(new Xi(Xi.ROOM_WALL_UPDATE,i))),r&&(l&&!n&&l.model.setValue(D.ROOM_LANDSCAPE_TYPE,r),o.processUpdateMessage(new Xi(Xi.ROOM_LANDSCAPE_UPDATE,r))),!0}updateObjectRoomColor(e,t,i,r){const n=this.getRoomOwnObject(e);if(!n||!n.logic)return!1;const o=new Qg(Qg.BACKGROUND_COLOR,t,i,r);return n.logic.processUpdateMessage(o),this.events.dispatchEvent(new pf(e,t,i,r)),!0}addRoomInstanceFloorHole(e,t){if(t<0)return;const i=this.getRoomOwnObject(e),r=this.getRoomObjectFloor(e,t);if(i&&i.logic&&r&&r.model){const n=r.getLocation(),o=r.model.getValue(D.FURNITURE_SIZE_X),l=r.model.getValue(D.FURNITURE_SIZE_Y);i.processUpdateMessage(new wn(wn.ADD,t,n.x,n.y,o,l))}}removeRoomInstanceFloorHole(e,t){if(t<0)return;const i=this.getRoomOwnObject(e);i&&i.processUpdateMessage(new wn(wn.REMOVE,t))}setRoomEngineGameMode(e,t){const i=this.getRoomInstance(e);if(!i)return;const r=t?1:0;i.model.setValue(Vs.IS_PLAYING_GAME,r),r===0?this.events.dispatchEvent(new Ot(Ot.NORMAL_MODE,e)):this.events.dispatchEvent(new Ot(Ot.GAME_MODE,e))}isRoomIdPlayingGame(e){const t=this.getRoomInstance(e);return t?t.model.getValue(Vs.IS_PLAYING_GAME)>0:!1}isPlayingGame(){return this.isRoomIdPlayingGame(this._activeRoomId)}disableUpdate(e){e?Gi().remove(this.update,this):(Gi().remove(this.update,this),Gi().add(this.update,this))}runUpdate(){this.update(1)}runVisibilityUpdate(){document.hidden||this.update(1,!0)}update(e,t=!1){this._roomManager&&(e=nt(),Bn.turnVisualizationOn(),this.processPendingFurniture(),this._roomManager.update(e,t),this.updateRoomCameras(e),this._mouseCursorUpdate&&this.setPointer(),Bn.turnVisualizationOff())}onRoomEngineInitalized(e){if(e){this._ready=!0,this.events.dispatchEvent(new Ot(Ot.ENGINE_INITIALIZED,0));for(const t of this._roomDatas.values())t&&this.createRoomInstance(t.roomId,t.data)}}setRoomSessionOwnUser(e,t){if(!this._roomSessionManager)return;const i=this._roomSessionManager.getSession(e);i&&i.setOwnRoomIndex(t);const r=this.getRoomCamera(e);r&&(r.targetId=t,r.targetCategory=Q.UNIT,r.activateFollowing(this.cameraFollowDuration))}getRoomGeometry(e){const t=this.getRoomInstanceRenderingCanvas(e,1);return t?t.geometry:null}getRoomObjectBoundingRectangle(e,t,i,r){const n=this.getRoomInstanceGeometry(e,r);if(!n)return null;const o=this.getRoomObject(e,t,i);if(!o)return null;const l=o.visualization;if(!l)return null;const c=l.getBoundingRectangle(),u=this.getRoomInstanceRenderingCanvas(e,r),d=u?u.scale:1,_=n.getScreenPoint(o.getLocation());return!_||(_.x=Math.round(_.x),_.y=Math.round(_.y),c.x=c.x*d,c.y=c.y*d,c.width=c.width*d,c.height=c.height*d,_.x=_.x*d,_.y=_.y*d,c.x+=_.x,c.y+=_.y,!u)?null:(c.x+=Math.round(u.width/2)+u.screenOffsetX,c.y+=Math.round(u.height/2)+u.screenOffsetY,c)}getCanvasBoundingRectangle(e){return this.getRoomObjectBoundingRectangle(this._activeRoomId,Mt.ROOM_OBJECT_ID,Q.ROOM,e)}getFurnitureFloorName(e){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorNameForTypeId(e):null}getFurnitureWallName(e,t=null){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallNameForTypeId(e,t):null}getFurnitureFloorColorIndex(e){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorColorIndex(e):null}getFurnitureWallColorIndex(e){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallColorIndex(e):null}getRoomInstanceModelName(e){const t=this.getRoomInstanceData(e);return t?t.modelName:null}setRoomInstanceModelName(e,t){const i=this.getRoomInstanceData(e);i&&i.setModelName(t)}getRoomTileObjectMap(e){const t=this.getRoomInstanceData(e);return t?t.tileObjectMap:null}getSelectedRoomObjectData(e){const t=this.getRoomInstanceData(e);return t?t.selectedObject:null}setSelectedRoomObjectData(e,t){const i=this.getRoomInstanceData(e);if(!i)return null;i.setSelectedObject(t),t&&i.setPlacedObject(null)}getPlacedRoomObjectData(e){const t=this.getRoomInstanceData(e);return t?t.placedObject:null}setPlacedRoomObjectData(e,t){const i=this.getRoomInstanceData(e);if(!i)return null;i.setPlacedObject(t)}cancelRoomObjectPlacement(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectPlacement(this._activeRoomId)}useFurnitureAlphaMultiplier(e,t,i=!1){!e||!e.model||this._roomObjectEventHandler.useFurnitureAlphaMultiplier(e,t,i)}getFurnitureStackingHeightMap(e){const t=this.getRoomInstanceData(e);return t?t.furnitureStackingHeightMap:null}setFurnitureStackingHeightMap(e,t){const i=this.getRoomInstanceData(e);if(!i)return null;i.setFurnitureStackingHeightMap(t)}getLegacyWallGeometry(e){const t=this.getRoomInstanceData(e);return t?t.legacyGeometry:null}getTotalObjectsForManager(e,t){const i=this.getRoomInstance(e);return i?i.getTotalObjectsForManager(t):0}getRoomObject(e,t,i){if(!this._ready)return null;let r=this.getRoomId(e);return e===0&&(r=Mt.TEMPORARY_ROOM),this.getObject(r,t,i)}getObject(e,t,i){let r=null;if(this._roomManager&&(r=this._roomManager.getRoomInstance(e)),!r)return null;let n=r.getRoomObject(t,i);if(!n)switch(i){case Q.FLOOR:this.processPendingFurnitureFloor(this.getRoomIdFromString(e),t,null),n=r.getRoomObject(t,i);break;case Q.WALL:this.processPendingFurnitureWall(this.getRoomIdFromString(e),t,null),n=r.getRoomObject(t,i);break}return n}getRoomObjectByIndex(e,t,i){const r=this.getRoomInstance(e);return r?r.getRoomObjectByIndex(t,i):null}getRoomObjectCategoryForType(e){return!e||!this._roomContentLoader?Q.MINIMUM:this._roomContentLoader.getCategoryForType(e)}getRoomObjectCursor(e){return this.getObject(this.getRoomId(e),Mt.CURSOR_OBJECT_ID,Q.CURSOR)}getRoomObjectSelectionArrow(e){return this.getObject(this.getRoomId(e),Mt.ARROW_OBJECT_ID,Q.CURSOR)}getRoomOwnObject(e){return this.getObject(this.getRoomId(e),Mt.ROOM_OBJECT_ID,Q.ROOM)}getRoomObjectUser(e,t){return this.getObject(this.getRoomId(e),t,Q.UNIT)}removeRoomObjectUser(e,t){return this.removeRoomObject(e,t,Q.UNIT)}createRoomObjectUser(e,t,i){return this.createRoomObjectAndInitialize(e,t,i,Q.UNIT)}getRoomObjectFloor(e,t){return this.getObject(this.getRoomId(e),t,Q.FLOOR)}createRoomObjectFloor(e,t,i){return this.createRoomObjectAndInitialize(e,t,i,Q.FLOOR)}removeRoomObjectFloor(e,t,i=-1,r=!1){const n=this.getRoomInstanceData(e);if(n&&n.removePendingFunitureFloor(t),this._sessionDataManager&&i===this._sessionDataManager.userId&&!Fp.isBuilderClubId(t)){const o=this.getRoomObject(e,t,Q.FLOOR);if(o){const l=this.getRoomObjectScreenLocation(e,t,Q.FLOOR,this._activeRoomActiveCanvas);if(l&&!(o.model.getValue(D.FURNITURE_DISABLE_PICKING_ANIMATION)===1)){const u=o.model.getValue(D.FURNITURE_TYPE_ID),d=o.model.getValue(D.FURNITURE_EXTRAS),_=o.model.getValue(D.FURNITURE_DATA_FORMAT),m=ka.getData(_),f=this.getFurnitureFloorIcon(u,null,d,m).data;if(f){const E=Vt.generateImage(f);if(this.events){const I=new vg(E,l.x,l.y);I.iconName=hf.INVENTORY,this.events.dispatchEvent(I)}}}}}this.removeRoomObject(e,t,Q.FLOOR),this.setMouseDefault(e,Q.FLOOR,t),r&&this.refreshTileObjectMap(e,"RoomEngine.disposeObjectFurniture()")}getRoomObjectWall(e,t){return this.getObject(this.getRoomId(e),t,Q.WALL)}removeRoomObjectWall(e,t,i=-1){if(this._sessionDataManager&&i===this._sessionDataManager.userId&&!Fp.isBuilderClubId(t)){const r=this.getRoomObject(e,t,Q.WALL);if(r&&r.type.indexOf("post_it")===-1&&r.type.indexOf("external_image_wallitem")===-1){const n=this.getRoomObjectScreenLocation(e,t,Q.WALL,this._activeRoomActiveCanvas);if(n){const o=r.model.getValue(D.FURNITURE_TYPE_ID),l=r.model.getValue(D.FURNITURE_DATA),c=this.getFurnitureWallIcon(o,null,l).data;if(c){const u=Vt.generateImage(c);if(this.events){const d=new vg(u,n.x,n.y);d.iconName=hf.INVENTORY,this.events.dispatchEvent(d)}}}}}this.removeRoomObject(e,t,Q.WALL),this.updateRoomObjectMask(e,t,!1),this.setMouseDefault(e,Q.WALL,t)}createRoomObjectWall(e,t,i){return this.createRoomObjectAndInitialize(e,t,i,Q.WALL)}addFurnitureFloor(e,t,i,r,n,o,l,c=NaN,u=-1,d=0,_=0,m="",f=!0,E=!0,I=-1,p=10,S=!0){const R=this.getRoomInstanceData(e);if(!R)return!1;const O=new $T(t,i,null,r,n,o,l,c,u,d,_,m,f,E,I,p,S);return R.addPendingFurnitureFloor(O),!0}addFurnitureFloorByTypeName(e,t,i,r,n,o,l,c=NaN,u=-1,d=0,_=0,m="",f=!0,E=!0,I=-1,p=10,S=!0){const R=this.getRoomInstanceData(e);if(!R)return!1;const O=new $T(t,0,i,r,n,o,l,c,u,d,_,m,f,E,I,p,S);return R.addPendingFurnitureFloor(O),!0}addFurnitureWall(e,t,i,r,n,o,l,c=-1,u=0,d=0,_="",m=!0){const f=this.getRoomInstanceData(e);if(!f)return!1;const E=new Xr;E.setString(l);const I=new $T(t,i,null,r,n,o,E,NaN,c,u,d,_,!0,m);return f.addPendingFurnitureWall(I),!0}updateRoomObjectFloor(e,t,i,r,n,o,l=null){const c=this.getRoomObjectFloor(e,t);return c?(c.processUpdateMessage(new xi(i,r)),c.processUpdateMessage(new os(n,o,l)),!0):!1}updateRoomObjectWall(e,t,i,r,n,o=null){const l=this.getRoomObjectWall(e,t);if(!l||!l.logic)return!1;const c=new xi(i,r),u=new Xr,d=new os(n,u);return u.setString(o),l.logic.processUpdateMessage(c),l.logic.processUpdateMessage(d),this.updateRoomObjectMask(e,t),!0}updateRoomObjectWallItemData(e,t,i){const r=this.getRoomObjectWall(e,t);return!r||!r.logic?!1:(r.logic.processUpdateMessage(new bN(i)),!0)}updateRoomObjectFloorHeight(e,t,i){const r=this.getRoomObjectFloor(e,t);return r?(r.processUpdateMessage(new hG(null,null,i)),!0):!1}updateRoomObjectFloorExpiration(e,t,i){const r=this.getRoomObjectFloor(e,t);return r?(r.model.setValue(D.FURNITURE_EXPIRY_TIME,i),r.model.setValue(D.FURNITURE_EXPIRTY_TIMESTAMP,nt()),!0):!1}updateRoomObjectWallExpiration(e,t,i){const r=this.getRoomObjectWall(e,t);return r?(r.model.setValue(D.FURNITURE_EXPIRY_TIME,i),r.model.setValue(D.FURNITURE_EXPIRTY_TIMESTAMP,nt()),!0):!1}updateRoomObjectMask(e,t,i=!0){const r=Q.WALL+"_"+t,n=this.getRoomObjectWall(e,t);let o=null;if(n&&n.model){if(n.model.getValue(D.FURNITURE_USES_PLANE_MASK)>0){const c=n.model.getValue(D.FURNITURE_PLANE_MASK_TYPE),u=n.getLocation();i?o=new xr(xr.ADD_MASK,r,c,u):o=new xr(xr.REMOVE_MASK,r)}}else o=new xr(xr.REMOVE_MASK,r);const l=this.getRoomOwnObject(e);l&&l.logic&&o&&l.logic.processUpdateMessage(o)}rollRoomObjectFloor(e,t,i,r,n,o=NaN){const l=this.getRoomObjectFloor(e,t);l&&l.processUpdateMessage(new Al(i,n,r,o,n!=null))}updateRoomObjectWallLocation(e,t,i,r=null,n=NaN){const o=this.getRoomObjectWall(e,t);return o?(o.logic&&o.logic.processUpdateMessage(new Al(i,r,null,n,r!=null)),this.updateRoomObjectMask(e,t),!0):!1}addRoomObjectUser(e,t,i,r,n,o,l){if(this.getRoomObjectUser(e,t))return!1;let u=Ft.getTypeString(o);u===Ft.PET&&(u=this.getPetType(l));const d=this.createRoomObjectUser(e,t,u);return d?(d.processUpdateMessage(new Ap(this.fixedUserLocation(e,i),null,r,n,!1,0)),l&&d.processUpdateMessage(new Cp(l)),this.events&&this.events.dispatchEvent(new ke(ke.ADDED,e,t,Q.UNIT)),!0):!1}updateRoomObjectUserLocation(e,t,i,r,n=!1,o=0,l=null,c=NaN,u=NaN,d=!1){const _=this.getRoomObjectUser(e,t);if(!_)return!1;i||(i=_.getLocation()),l||(l=_.getDirection()),isNaN(c)&&(c=_.model.getValue(D.HEAD_DIRECTION)),_.processUpdateMessage(new Ap(this.fixedUserLocation(e,i),this.fixedUserLocation(e,r),l,c,n,o,u,d));const m=this._roomSessionManager&&this._roomSessionManager.getSession(e)||null;return m&&m.ownRoomIndex===t&&this._logicFactory.events.dispatchEvent(new yd(yd.ROAME_MOVE_TO,r)),!0}updateRoomObjectUserDir(e,t,i,r){const n=this.getRoomObjectUser(e,t);return n?(n.processUpdateMessage(new _G(null,i,r)),!0):!1}updateRoomObjectUserAction(e,t,i,r,n=null){const o=this.getRoomObjectUser(e,t);if(!o)return!1;let l=null;switch(i){case D.FIGURE_TALK:l=new CN(r);break;case D.FIGURE_SLEEP:l=new AN(r===1);break;case D.FIGURE_IS_TYPING:l=new cG(r===1);break;case D.FIGURE_IS_MUTED:l=new iG(r===1);break;case D.FIGURE_CARRY_OBJECT:l=new $k(r,n);break;case D.FIGURE_USE_OBJECT:l=new uG(r);break;case D.FIGURE_DANCE:l=new Qk(r);break;case D.FIGURE_GAINED_EXPERIENCE:l=new Zk(r);break;case D.FIGURE_NUMBER_VALUE:l=new aG(r);break;case D.FIGURE_SIGN:l=new lG(r);break;case D.FIGURE_EXPRESSION:l=new eG(r);break;case D.FIGURE_IS_PLAYING_GAME:l=new oG(r===1);break;case D.FIGURE_GUIDE_STATUS:l=new WJ(r);break}return l?(o.processUpdateMessage(l),!0):!1}updateRoomObjectUserFigure(e,t,i,r=null,n=null,o=!1){const l=this.getRoomObjectUser(e,t);return l?(l.processUpdateMessage(new Cp(i,r,n,o)),!0):!1}updateRoomObjectUserFlatControl(e,t,i){const r=this.getRoomObjectUser(e,t);return r?(r.processUpdateMessage(new tG(parseInt(i))),!0):!1}updateRoomObjectUserEffect(e,t,i,r=0){const n=this.getRoomObjectUser(e,t);return n?(n.processUpdateMessage(new Jk(i,r)),!0):!1}updateRoomObjectUserGesture(e,t,i){const r=this.getRoomObjectUser(e,t);return r?(r.processUpdateMessage(new sG(i)),!0):!1}updateRoomObjectUserPetGesture(e,t,i){const r=this.getRoomObjectUser(e,t);return r?(r.processUpdateMessage(new nG(i)),!0):!1}updateRoomObjectUserPosture(e,t,i,r=null){const n=this.getRoomObjectUser(e,t);return n?(n.processUpdateMessage(new NN(i,r)),!0):!1}updateRoomObjectUserOwn(e,t){const i=this.getRoomObjectUser(e,t);i&&i.processUpdateMessage(new rG)}useRoomObject(e,t){const i=this.getRoomObject(this._activeRoomId,e,t);if(i){const r=this.roomSessionManager.getSession(this._activeRoomId);if(r&&r.playTestMode&&Number(i.model.getValue("furniture_usage_policy"))<2)return!1;const n=i.logic;if(n)return n.useObject(),!0}return!1}objectInitialized(e,t,i){const r=this.getRoomIdFromString(e);i===Q.WALL&&this.updateRoomObjectMask(r,t);const n=this.getRoomObject(r,t,i);if(n&&n.model&&n.logic){const o=n.model.getValue(D.FURNITURE_DATA_FORMAT);if(!isNaN(o)){const l=ka.getData(o);l.initializeFromRoomObjectModel(n.model),n.processUpdateMessage(new os(n.getState(0),l))}this.events.dispatchEvent(new ke(ke.CONTENT_UPDATED,r,t,i))}e!==Mt.TEMPORARY_ROOM&&this.addObjectToTileMap(r,n)}changeObjectModelData(e,t,i,r,n){const o=this.getObject(this.getRoomId(e),t,i);if(!o||!o.logic)return!1;const l=new dG(r,n);return o.processUpdateMessage(l),!0}changeObjectState(e,t,i){const r=this.getObject(this.getRoomId(e),t,i);if(!r||!r.model)return;let n=r.model.getValue(D.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(n)?n=1:n=n+1,r.model.setValue(D.FURNITURE_AUTOMATIC_STATE_INDEX,n);const o=r.model.getValue(D.FURNITURE_DATA_FORMAT),l=ka.getData(o);l.initializeFromRoomObjectModel(r.model),r.logic&&r.logic.processUpdateMessage(new os(n,l))}loadRoomObjectBadgeImage(e,t,i,r,n=!0){if(!this._sessionDataManager)return;let o=null;if(e===0){const c=this._roomManager.getRoomInstance(Mt.TEMPORARY_ROOM);c&&(o=c.getRoomObject(t,i))}else o=this.getRoomObjectFloor(e,t);if(!o||!o.logic)return;let l=n?this._sessionDataManager.loadGroupBadgeImage(r):this._sessionDataManager.loadBadgeImage(r);if(l)this.putBadgeInObjectAssets(o,r,n);else{l="loading_icon",this._badgeListenerObjects||(this._badgeListenerObjects=new Map),this._badgeListenerObjects.size||this._sessionDataManager.events.addEventListener(Nl.IMAGE_READY,this.onBadgeImageReadyEvent);let c=this._badgeListenerObjects.get(r);c||(c=[]),c.push(new See(o,n)),this._badgeListenerObjects.set(r,c)}o.logic.processUpdateMessage(new Qu(r,l))}dispatchMouseEvent(e,t,i,r,n,o,l,c,u){const d=this.getRoomInstanceRenderingCanvas(this._activeRoomId,e);if(!d)return;const _=this.getRenderingCanvasOverlay(d),m=this.getOverlayIconSprite(_,Mt.OBJECT_ICON_SPRITE);if(m){const f=m.getLocalBounds();m.x=t-f.width/2,m.y=i-f.height/2}if(r===Re.MOUSE_CLICK&&this._areaSelectionManager.finishSelecting())this._areaSelectionManager.finishSelecting();else if(!this.handleRoomDragging(d,t,i,r,n,o,l)&&!d.handleMouseEvent(t,i,r,n,o,l,c)){let f=null;r===Re.MOUSE_CLICK?(this.events&&this.events.dispatchEvent(new ke(ke.DESELECTED,this._activeRoomId,-1,Q.MINIMUM)),f=rt.CLICK):r===Re.MOUSE_MOVE?f=rt.MOUSE_MOVE:r===Re.MOUSE_DOWN?f=rt.MOUSE_DOWN:r===Re.MOUSE_DOWN_LONG?f=rt.MOUSE_DOWN_LONG:r===Re.MOUSE_UP&&(f=rt.MOUSE_UP),this._roomObjectEventHandler.handleRoomObjectEvent(new rt(f,this.getRoomObject(this._activeRoomId,Mt.ROOM_OBJECT_ID,Q.ROOM),null,n),this._activeRoomId,u)}this._activeRoomActiveCanvas=e,this._activeRoomActiveCanvasMouseX=t,this._activeRoomActiveCanvasMouseY=i}dispatchRollEvent(e,t,i=!1){if($e()&&$e().roomZoomActive){if(this.zoomInterval)return;let r=ce().getRoomInstanceRenderingCanvasScale(this.activeRoomId,e),n;n=t==="down"?r-.5:r+.5,n=Math.max(1,Math.min(i?10:5,n));let o=0;const l=6,c=(n-r)/l;this.zoomInterval=setInterval(()=>{r+=c,ce().setRoomInstanceRenderingCanvasScale(this.activeRoomId,e,r),o++,o>=l&&(clearInterval(this.zoomInterval),this.zoomInterval=null)},30)}}updateMousePointer(e,t,i){const r=this.getRoomObjectCategoryForType(i);switch(e){case Ae.MOUSE_BUTTON:this.setMouseButton(this._activeRoomId,r,t);return;default:this.setMouseDefault(this._activeRoomId,r,t);return}}processRoomObjectOperation(e,t,i){if(!this._roomObjectEventHandler)return!1;this._roomObjectEventHandler.modifyRoomObject(this._activeRoomId,e,t,i)}modifyRoomObjectDataWithMap(e,t,i,r){if(!this._roomObjectEventHandler)return!1;t===Q.FLOOR&&this._roomObjectEventHandler.modifyRoomObjectDataWithMap(this._activeRoomId,e,t,i,r)}modifyRoomObjectData(e,t,i,r){if(!this._roomObjectEventHandler)return!1;t===Q.WALL&&this._roomObjectEventHandler.modifyWallItemData(this._activeRoomId,e,i,r)}processRoomObjectPlacement(e,t,i,r,n=null,o=null,l=-1,c=-1,u=null){const d=this.getRoomInstance(this._activeRoomId);if(!d||d.model.getValue(Vs.ROOM_IS_PUBLIC)!==0||!this._roomObjectEventHandler)return!1;const _=this.roomSessionManager.getSession(this.activeRoomId);return _&&_.playTestMode?!1:this._roomObjectEventHandler.processRoomObjectPlacement(e,this._activeRoomId,t,i,r,n,o,l,c,u)}getRoomObjectScreenLocation(e,t,i,r=-1){r==-1&&(r=this._activeRoomActiveCanvas);const n=this.getRoomInstanceGeometry(e,r);if(!n)return null;const o=this.getRoomObject(e,t,i);if(!o)return null;const l=n.getScreenPoint(o.getLocation());if(!l)return null;const c=this.getRoomInstanceRenderingCanvas(e,r);return c?(l.x=l.x*c.scale,l.y=l.y*c.scale,l.x+=c.width/2+c.screenOffsetX,l.y+=c.height/2+c.screenOffsetY,l.x=Math.round(l.x),l.y=Math.round(l.y),l):null}selectRoomObject(e,t,i,r=!0){this._roomObjectEventHandler&&this._roomObjectEventHandler.setSelectedObject(e,t,i,r)}deselectRoomObject(e){this._roomObjectEventHandler&&this._roomObjectEventHandler.deselectObject(e)}setSelectedAvatar(e,t){this._roomObjectEventHandler||this._roomObjectEventHandler.setSelectedAvatar(e,t,!0)}cancelRoomObjectInsert(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectInsert(this._activeRoomId)}onRoomContentLoaded(e,t,i){if(!this._roomContentLoader||e===-1)return;this._thumbnailObjectIdBank.freeNumber(e-1);const r=this._thumbnailCallbacks.get(t);if(r){this._thumbnailCallbacks.delete(t);const n=this._roomContentLoader.getImage(t);if(n)for(const o of r)o&&o.imageReady(e,null,n)}}setObjectMoverIconSprite(e,t,i,r=null,n=null,o=-1,l=-1,c=null){let u=null,d=0,_=null;const m=1;if(i)_=this.getRoomObjectImage(this._activeRoomId,e,t,new Y,1,null);else if(this._roomContentLoader)if(t===Q.FLOOR?(u=this._roomContentLoader.getFurnitureFloorNameForTypeId(e),d=this._roomContentLoader.getFurnitureFloorColorIndex(e)):t===Q.WALL&&(u=this._roomContentLoader.getFurnitureWallNameForTypeId(e,r),d=this._roomContentLoader.getFurnitureWallColorIndex(e)),t===Q.UNIT)if(u=Ft.getTypeString(e),u==="pet"){u=this.getPetType(r);const p=new Vo(r);_=this.getRoomObjectPetImage(p.typeId,p.paletteId,p.color,new Y(180),64,null,!0,0,p.customParts,c)}else _=this.getGenericRoomObjectImage(u,r,new Y(180),64,null,0,null,n,o,l,c);else _=this.getGenericRoomObjectImage(u,d.toString(),new Y,1,null,0,r,n,o,l,c);if(!_||!_.data)return;const f=this.getActiveRoomInstanceRenderingCanvas();if(!f)return;const E=this.getRenderingCanvasOverlay(f);this.removeOverlayIconSprite(E,Mt.OBJECT_ICON_SPRITE);const I=this.addOverlayIconSprite(E,Mt.OBJECT_ICON_SPRITE,_.data,m);I&&(I.x=this._activeRoomActiveCanvasMouseX-_.data.width/2,I.y=this._activeRoomActiveCanvasMouseY-_.data.height/2)}getRoomObjectImage(e,t,i,r,n,o,l=0){if(!this._roomManager)return null;let c=-1,u=null,d=null,_="",m=null;const f=this.getRoomId(e),E=this._roomManager.getRoomInstance(f);if(E){const I=E.getRoomObject(t,i);if(I&&I.model)switch(c=I.id,u=I.type,i){case Q.FLOOR:case Q.WALL:{_=I.model.getValue(D.FURNITURE_COLOR).toString(),m=I.model.getValue(D.FURNITURE_EXTRAS);const p=I.model.getValue(D.FURNITURE_DATA_FORMAT);p!==Xr.FORMAT_KEY&&(d=ka.getData(p),d.initializeFromRoomObjectModel(I.model));break}case Q.UNIT:_=I.model.getValue(D.FIGURE);break}}return this.getGenericRoomObjectImage(u,_,r,n,o,l,m,d,-1,-1,null,c)}getFurnitureFloorIconUrl(e){let t=null,i="";return this._roomContentLoader?(t=this._roomContentLoader.getFurnitureFloorNameForTypeId(e),i=this._roomContentLoader.getFurnitureFloorColorIndex(e).toString(),this._roomContentLoader.getAssetIconUrl(t,i)):null}getFurnitureFloorIcon(e,t,i=null,r=null){return this.getFurnitureFloorImage(e,new Y,1,t,0,i,-1,-1,r)}getFurnitureWallIconUrl(e,t=null){let i=null,r="";return this._roomContentLoader?(i=this._roomContentLoader.getFurnitureWallNameForTypeId(e,t),r=this._roomContentLoader.getFurnitureWallColorIndex(e).toString(),this._roomContentLoader.getAssetIconUrl(i,r)):null}getFurnitureWallIcon(e,t,i=null){return this.getFurnitureWallImage(e,new Y,1,t,0,i)}getFurnitureFloorImage(e,t,i,r,n=0,o=null,l=-1,c=-1,u=null){let d=null,_="";return this._roomContentLoader&&(d=this._roomContentLoader.getFurnitureFloorNameForTypeId(e),_=this._roomContentLoader.getFurnitureFloorColorIndex(e).toString()),i===1&&r?this.getGenericRoomObjectThumbnail(d,_,r,o,u):this.getGenericRoomObjectImage(d,_,t,i,r,n,o,u,l,c)}getFurnitureWallImage(e,t,i,r,n=0,o=null,l=-1,c=-1){let u=null,d="";return this._roomContentLoader&&(u=this._roomContentLoader.getFurnitureWallNameForTypeId(e),d=this._roomContentLoader.getFurnitureWallColorIndex(e).toString()),i===1&&r?this.getGenericRoomObjectThumbnail(u,d,r,o,null):this.getGenericRoomObjectImage(u,d,t,i,r,n,o,null,l,c)}getRoomObjectPetImage(e,t,i,r,n,o,l=!1,c=0,u=null,d=null){let _=null,m=e+" "+t+" "+i.toString(16);if(l&&(m=m+" head"),u){m=m+(" "+u.length);for(const f of u)m=m+(" "+f.layerId+" "+f.partId+" "+f.paletteId)}return this._roomContentLoader&&(_=this._roomContentLoader.getPetNameForType(e)),this.getGenericRoomObjectImage(_,m,r,n,o,c,null,null,-1,-1,d)}getGenericRoomObjectImage(e,t,i,r,n,o=0,l=null,c=null,u=-1,d=-1,_=null,m=-1){if(!this._roomManager)return null;const f=new Bb;if(f.id=-1,!this._ready||!e)return f;let E=this._roomManager.getRoomInstance(Mt.TEMPORARY_ROOM);if(!E&&(E=this._roomManager.createRoomInstance(Mt.TEMPORARY_ROOM),!E))return f;let I=this._imageObjectIdBank.reserveNumber();const p=this.getRoomObjectCategoryForType(e);if(I<0)return f;I++;const S=E.createRoomObjectAndInitalize(I,e,p);if(!S||!S.model||!S.logic)return f;const R=S.model;switch(p){case Q.FLOOR:case Q.WALL:R.setValue(D.FURNITURE_COLOR,parseInt(t)),R.setValue(D.FURNITURE_EXTRAS,l);break;case Q.UNIT:if(e===Ft.USER||e===Ft.BOT||e===Ft.RENTABLE_BOT||e===Ft.PET)R.setValue(D.FIGURE,t);else{const b=new Vo(t);R.setValue(D.PET_PALETTE_INDEX,b.paletteId),R.setValue(D.PET_COLOR,b.color),b.headOnly&&R.setValue(D.PET_HEAD_ONLY,1),b.hasCustomParts&&(R.setValue(D.PET_CUSTOM_LAYER_IDS,b.customLayerIds),R.setValue(D.PET_CUSTOM_PARTS_IDS,b.customPartIds),R.setValue(D.PET_CUSTOM_PALETTE_IDS,b.customPaletteIds)),_&&R.setValue(D.FIGURE_POSTURE,_)}break}S.setDirection(i);const O=S.visualization;if(!O)return E.removeRoomObject(I,p),f;(u>-1||c)&&(c&&c.getLegacyString()!==""?S.logic.processUpdateMessage(new os(parseInt(c.getLegacyString()),c)):S.logic.processUpdateMessage(new os(u,c)));const C=new Cc(r,new Y(-135,30,0),new Y(11,11,5));if(O.update(C,0,!0,!1),d>0){let b=0;for(;b<d;)O.update(C,0,!0,!1),b++}const A=O.getImage(o,m);if(f.data=A,f.id=I,!this.isRoomContentTypeLoaded(e)&&n){let b=this._imageCallbacks.get(I.toString());b||(b=[],this._imageCallbacks.set(I.toString(),b)),b.push(n),R.setValue(D.IMAGE_QUERY_SCALE,r)}else E.removeRoomObject(I,p),this._imageObjectIdBank.freeNumber(I-1),f.id=0;return C.dispose(),f}getGenericRoomObjectThumbnail(e,t,i,r=null,n=null){if(!this._roomManager)return null;const o=new Bb;if(o.id=-1,!this._ready||!e)return o;let l=this._roomManager.getRoomInstance(Mt.TEMPORARY_ROOM);if(!l&&(l=this._roomManager.createRoomInstance(Mt.TEMPORARY_ROOM),!l))return o;let c=this._thumbnailObjectIdBank.reserveNumber();if(this.getRoomObjectCategoryForType(e),c<0)return o;c++,o.id=c,o.data=null,o.image=null;const u=[e,t].join("_"),d=this._roomContentLoader.getImage(u);if(!d&&i){let _=this._thumbnailCallbacks.get(u);_||(_=[],this._thumbnailCallbacks.set(u,_),this._roomContentLoader.downloadImage(c,e,t,null)),_.push(i)}else d&&(o.image=d),this._thumbnailObjectIdBank.freeNumber(c-1),o.id=0;return o}initalizeTemporaryObjectsByType(e,t){const i=this._roomManager.getRoomInstance(Mt.TEMPORARY_ROOM);if(!i||!this._roomContentLoader)return;const r=this._roomContentLoader.getCategoryForType(e),n=i.getManager(r);let o=null,l=0;if(n&&n.objects.length){for(const c of n.objects.getValues())if(c&&c.model&&c.type===e){const u=c.id,d=c.visualization;let _=null;if(d){const f=c.model.getValue(D.IMAGE_QUERY_SCALE);o&&l!==f&&(o.dispose(),o=null),o||(l=f,o=new Cc(f,new Y(-135,30,0),new Y(11,11,5))),d.update(o,0,!0,!1),_=d.image}i.removeRoomObject(u,r),this._imageObjectIdBank.freeNumber(u-1);const m=this._imageCallbacks.get(u.toString());if(m){this._imageCallbacks.delete(u.toString());for(const f of m)f&&(_?f.imageReady(u,_):f.imageFailed(u))}}}o&&o.dispose()}setObjectMoverIconSpriteVisible(e){const t=this.getActiveRoomInstanceRenderingCanvas();if(!t)return;const i=this.getRenderingCanvasOverlay(t),r=this.getOverlayIconSprite(i,Mt.OBJECT_ICON_SPRITE);r&&(r.visible=e)}removeObjectMoverIconSprite(){const e=this.getActiveRoomInstanceRenderingCanvas();if(!e)return;const t=this.getRenderingCanvasOverlay(e);this.removeOverlayIconSprite(t,Mt.OBJECT_ICON_SPRITE)}getRoomObjects(e,t){if(this._ready){const i=this.getRoomId(e),r=this._roomManager.getRoomInstance(i);if(r)return r.getRoomObjectsForCategory(t)}return[]}refreshTileObjectMap(e,t){const i=this.getRoomInstanceData(e).tileObjectMap;i&&i.populate(this.getRoomObjects(e,Q.FLOOR))}getRenderRoomMessage(e,t,i=!1,r=!0,n=!1,o=-1){let l=null;if(o>-1?l=this.getRoomInstanceRenderingCanvas(this._activeRoomId,o):l=this.getActiveRoomInstanceRenderingCanvas(),!l)return null;n&&l.skipSpriteVisibilityChecking();let c=-1;!r&&this._roomSessionManager.getSession(this._activeRoomId)!=null&&(c=this._roomSessionManager.getSession(this._activeRoomId).ownRoomIndex);const u=new GO,d=u.getFurniData(e,l,this,c),_=u.getRoomRenderingModifiers(this),m=u.getRoomPlanes(e,l,this,t);return n&&l.resumeSpriteVisibilityChecking(),ze.log(d,_,m),null}createTextureFromRoom(e,t=-1,i=null){let r=null;t>-1?r=this.getRoomInstanceRenderingCanvas(this._activeRoomId,t):r=this.getActiveRoomInstanceRenderingCanvas();let n=null;return i?n=Vt.generateTexture(r.master,i):n=r.getDisplayAsTexture(),n}saveTextureAsScreenshot(e,t=!1){let i=null;t?i=new lx:i=new Bg,i.assignBitmap(e),this._communication.connection.send(i)}saveBase64AsScreenshot(e,t=!1){let i=null;t?i=new lx:i=new Bg,i.assignBase64(e),this._communication.connection.send(i)}objectsInitialized(e){const t=this.getRoomIdFromString(e);this.events.dispatchEvent(new Ot(Ot.OBJECTS_INITIALIZED,t))}getRoomId(e){return e.toString()}getPetTypeId(e){let t=-1;if(e){const i=e.split(" ");i.length>1&&(t=parseInt(i[0]))}return t}isRoomContentTypeLoaded(e){return this._roomContentLoader?this._roomContentLoader.getCollection(e)!==null:!1}getPetColorResult(e,t){return this._roomContentLoader?this._roomContentLoader.getPetColorResult(e,t):null}getPetColorResultsForTag(e,t){return this._roomContentLoader?this._roomContentLoader.getPetColorResultsForTag(e,t):null}deleteRoomObject(e,t){return!this._roomObjectEventHandler||t!==Q.WALL?!1:this._roomObjectEventHandler.deleteWallItem(this._activeRoomId,e)}getRoomObjectCount(e,t){return this._roomManager==null?0:this._roomManager.getRoomInstance(e.toString()).getRoomObjectsForCategory(t).length}isWhereYouClickWhereYouGo(){return this._whereYouClickWhereYouGo&&!this.isAreaSelectionMode()}isAreaSelectionMode(){return this._areaSelectionManager.areaSelectionState!=Cd.NOT_ACTIVE}setMoveBlocked(e){this._moveBlocked=e}isMoveBlocked(){return this._moveBlocked}updateAreaHide(e,t,i,r,n,o,l,c){const u=this.getRoomOwnObject(e);return this.events&&this.events.dispatchEvent(new im(e,t,10,i)),u&&u.logic&&(i?u.processUpdateMessage(new wn(wn.ADD,t,r,n,o,l,c)):u.processUpdateMessage(new wn(wn.REMOVE,t))),!0}addObjectToTileMap(e,t){const i=this.getRoomInstanceData(e).tileObjectMap;i&&i.addRoomObject(t)}onRoomSessionEvent(e){if(e instanceof Ve)switch(e.type){case Ve.STARTED:this._roomMessageHandler&&this._roomMessageHandler.setRoomId(e.session.roomId);return;case Ve.ENDED:this._roomMessageHandler&&(this._roomMessageHandler.clearRoomId(),this.removeRoomInstance(e.session.roomId));return}}onRoomContentLoaderReadyEvent(e){this._roomContentLoaderReady=!0,this._roomManager.init()}setupRoomInstance(e,t,i,r,n,o){if(!this._ready||!this._roomManager)return;const l=this._roomManager.createRoomInstance(this.getRoomId(e));if(!l)return null;const c=Q.ROOM,u=l.createRoomObjectAndInitalize(Mt.ROOM_OBJECT_ID,Mt.ROOM_OBJECT_TYPE,c);if(l.model.setValue(Vs.ROOM_IS_PUBLIC,0),l.model.setValue(Vs.ROOM_Z_SCALE,1),t&&(l.model.setValue(Vs.RESTRICTS_DRAGGING,t.restrictsDragging),l.model.setValue(Vs.RESTRICTS_SCALING,t.restrictsScaling),l.model.setValue(Vs.RESTRICTED_SCALE,t.restrictedScale),t.dimensions)){const m=t.dimensions.minX,f=t.dimensions.maxX,E=t.dimensions.minY,I=t.dimensions.maxY;l.model.setValue(Vs.ROOM_MIN_X,m),l.model.setValue(Vs.ROOM_MAX_X,f),l.model.setValue(Vs.ROOM_MIN_Y,E),l.model.setValue(Vs.ROOM_MAX_Y,I);const p=Math.trunc(m*423+f*671+E*913+I*7509);u&&u.model&&u.model.setValue(D.ROOM_RANDOM_SEED,p)}const d=u&&u.logic||null;if(d&&(d.initialize(t),i&&(d.processUpdateMessage(new Xi(Xi.ROOM_FLOOR_UPDATE,i)),l.model.setValue(D.ROOM_FLOOR_TYPE,i)),r&&(d.processUpdateMessage(new Xi(Xi.ROOM_WALL_UPDATE,r)),l.model.setValue(D.ROOM_WALL_TYPE,r)),n&&(d.processUpdateMessage(new Xi(Xi.ROOM_LANDSCAPE_UPDATE,n)),l.model.setValue(D.ROOM_LANDSCAPE_TYPE,n))),t&&t.doors.length){let _=0;for(;_<t.doors.length;){const m=t.doors[_];if(m){const f=m.x,E=m.y,I=m.z,p=m.dir,S=xr.DOOR,R="door_"+_,O=new Y(f,E,I);d.processUpdateMessage(new xr(xr.ADD_MASK,R,S,O,xr.HOLE)),(p===90||p===180)&&(p===90&&(l.model.setValue(D.ROOM_DOOR_X,f-.5),l.model.setValue(D.ROOM_DOOR_Y,E)),p===180&&(l.model.setValue(D.ROOM_DOOR_X,f),l.model.setValue(D.ROOM_DOOR_Y,E-.5)),l.model.setValue(D.ROOM_DOOR_Z,I),l.model.setValue(D.ROOM_DOOR_DIR,p))}_++}}return l.createRoomObjectAndInitalize(Mt.CURSOR_OBJECT_ID,Mt.CURSOR_OBJECT_TYPE,Q.CURSOR),st.getValue("enable.avatar.arrow",!1)&&l.createRoomObjectAndInitalize(Mt.ARROW_OBJECT_ID,Mt.ARROW_OBJECT_TYPE,Q.CURSOR),l}setPointer(){this._mouseCursorUpdate=!1;const e=this.getRoomInstanceData(this._activeRoomId);e&&e.hasButtonMouseCursorOwners()?document.body.style.cursor="pointer":document.body.style.cursor="auto"}processPendingFurniture(){if(this._skipFurnitureCreationForNextFrame){this._skipFurnitureCreationForNextFrame=!1;return}const e=new Date().valueOf(),t=5;for(const i of this._roomInstanceDatas.values()){if(!i)continue;let r=null,n=0,o=!1;for(;r=i.getNextPendingFurnitureFloor();)if(o=this.processPendingFurnitureFloor(i.roomId,r.id,r),!(++n%t)&&new Date().valueOf()-e>=40){this._skipFurnitureCreationForNextFrame=!0;break}for(;!this._skipFurnitureCreationForNextFrame&&(r=i.getNextPendingFurnitureWall());)if(o=this.processPendingFurnitureWall(i.roomId,r.id,r),!(++n%t)&&new Date().valueOf()-e>=40){this._skipFurnitureCreationForNextFrame=!0;break}if(o&&this._roomManager&&(this._roomManager.getRoomInstance(this.getRoomId(i.roomId)).hasUninitializedObjects()||this.objectsInitialized(i.roomId.toString())),this._skipFurnitureCreationForNextFrame)return}}processPendingFurnitureFloor(e,t,i){if(!i){const c=this.getRoomInstanceData(e);if(c&&(i=c.getPendingFurnitureFloor(t)),!i)return!1}let r=i.type;r||(r=this.getFurnitureFloorName(i.typeId));const n=this.createRoomObjectFloor(e,t,r);if(!n)return!1;const o=n.model;if(o&&(o.setValue(D.FURNITURE_COLOR,this.getFurnitureFloorColorIndex(i.typeId)),o.setValue(D.FURNITURE_TYPE_ID,i.typeId),o.setValue(D.FURNITURE_AD_URL,this.getRoomObjectAdUrl(i.type)),o.setValue(D.FURNITURE_REAL_ROOM_OBJECT,i.realRoomObject?1:0),o.setValue(D.FURNITURE_EXPIRY_TIME,i.expiryTime),o.setValue(D.FURNITURE_EXPIRTY_TIMESTAMP,nt()),o.setValue(D.FURNITURE_USAGE_POLICY,i.usagePolicy),o.setValue(D.FURNITURE_OWNER_ID,i.ownerId),o.setValue(D.FURNITURE_OWNER_NAME,i.ownerName),this._roomObjectEventHandler.useFurnitureAlphaMultiplier(n,i.opacity/10,i.clickable)),!this.updateRoomObjectFloor(e,t,i.location,i.direction,i.state,i.data,i.extra)||i.sizeZ>=0&&!this.updateRoomObjectFloorHeight(e,t,i.sizeZ))return!1;this.events&&this.events.dispatchEvent(new ke(ke.ADDED,e,t,Q.FLOOR));const l=this.getPlacedRoomObjectData(e);return l&&l.id===t&&l.category===Q.FLOOR&&this.selectRoomObject(e,t,Q.FLOOR),n.isReady&&i.synchronized&&this.addObjectToTileMap(e,n),!0}processPendingFurnitureWall(e,t,i){if(!i){const u=this.getRoomInstanceData(e);if(u&&(i=u.getPendingFurnitureWall(t)),!i)return!1}let r="";i.data&&(r=i.data.getLegacyString());let n=this.getFurnitureWallName(i.typeId,r);n||(n="");const o=this.createRoomObjectWall(e,t,n);if(!o)return!1;const l=o.model;if(l&&(l.setValue(D.FURNITURE_COLOR,this.getFurnitureWallColorIndex(i.typeId)),l.setValue(D.FURNITURE_TYPE_ID,i.typeId),l.setValue(D.FURNITURE_AD_URL,this.getRoomObjectAdUrl(i.type)),l.setValue(D.FURNITURE_REAL_ROOM_OBJECT,i.realRoomObject?1:0),l.setValue(D.OBJECT_ACCURATE_Z_VALUE,1),l.setValue(D.FURNITURE_EXPIRY_TIME,i.expiryTime),l.setValue(D.FURNITURE_EXPIRTY_TIMESTAMP,nt()),l.setValue(D.FURNITURE_USAGE_POLICY,i.usagePolicy),l.setValue(D.FURNITURE_OWNER_ID,i.ownerId),l.setValue(D.FURNITURE_OWNER_NAME,i.ownerName)),!this.updateRoomObjectWall(e,t,i.location,i.direction,i.state,r))return!1;this.events&&this.events.dispatchEvent(new ke(ke.ADDED,e,t,Q.WALL));const c=this.getPlacedRoomObjectData(e);return c&&Math.abs(c.id)===t&&c.category===Q.WALL&&this.selectRoomObject(e,t,Q.WALL),!0}updateRoomCameras(e){for(const t of this._roomInstanceDatas.values()){if(!t)continue;const i=t.roomCamera;if(!i)continue;let r=null;const n=this.getRoomObject(t.roomId,i.targetId,i.targetCategory);n&&(r=n.getLocation()),r&&(t.roomId!==this._activeRoomId||!this._activeRoomIsDragged)&&this.updateRoomCamera(t.roomId,1,r,e)}if(this._activeRoomWasDragged){const t=this.getRoomInstanceRenderingCanvas(this._activeRoomId,1);t&&this.setRoomInstanceRenderingCanvasOffset(this._activeRoomId,1,new ot(t.screenOffsetX+this._activeRoomDragX,t.screenOffsetY+this._activeRoomDragY)),this._activeRoomDragX=0,this._activeRoomDragY=0}}updateRoomCamera(e,t,i,r){const n=this.getRoomInstanceRenderingCanvas(e,t),o=this.getRoomInstanceData(e);if(!n||!o||n.scale!==1)return;const l=n.geometry,c=o.roomCamera,u=this.getRoomInstance(e);if(!l||!c||!u)return;const d=this.getRoomCanvasRectangle(e,t);if(!d)return;let _=Math.floor(i.z)+1;const m=Math.round(d.width),f=Math.round(d.height),E=this.getCanvasBoundingRectangle(t);if(E&&(E.right<0||E.bottom<0||E.left>=m||E.top>=f)&&c.reset(),c.screenWd!==m||c.screenHt!==f||c.scale!==l.scale||c.geometryUpdateId!==l.updateId||!Y.isEqual(i,c.targetObjectLoc)||c.isMoving){c.targetObjectLoc=i;const I=new Y;I.assign(i),I.x=Math.round(I.x),I.y=Math.round(I.y);const p=u.model.getValue(Vs.ROOM_MIN_X)-.5,S=u.model.getValue(Vs.ROOM_MIN_Y)-.5,R=u.model.getValue(Vs.ROOM_MAX_X)+.5,O=u.model.getValue(Vs.ROOM_MAX_Y)+.5,C=Math.round((p+R)/2),A=Math.round((S+O)/2),b=2;let y=new ot(I.x-C,I.y-A);const M=l.scale/Math.sqrt(2),U=M/2,G=new qr;G.rotate(-(l.direction.x+90)/180*Math.PI),y=G.apply(y),y.y=y.y*(U/M);const F=d.width/2/M-1,H=d.height/2/U-1;let v=0,B=0,z=0,$=0,W=l.getScreenPoint(new Y(C,A,b));if(!W)return;if(W.x=W.x+Math.round(d.width/2),W.y=W.y+Math.round(d.height/2),E)if(E.x+=-n.screenOffsetX,E.y+=-n.screenOffsetY,E.width>1&&E.height>1)v=(E.left-W.x-l.scale*.25)/M,z=(E.right-W.x+l.scale*.25)/M,B=(E.top-W.y-l.scale*.5)/U,$=(E.bottom-W.y+l.scale*.5)/U;else{l.adjustLocation(new Y(-30,-30),25);return}else{l.adjustLocation(new Y(0,0),25);return}let V=!1,se=!1,ee=!1,ie=!1;Math.round((z-v)*M)<d.width?(_=2,y.x=(z+v)/2,ee=!0):(y.x>z-F&&(y.x=z-F,V=!0),y.x<v+F&&(y.x=v+F,V=!0)),Math.round(($-B)*U)<d.height?(_=2,y.y=($+B)/2,ie=!0):(y.y>$-H&&(y.y=$-H,se=!0),y.y<B+H&&(y.y=B+H,se=!0),se&&(y.y=y.y/(U/M))),G.invert(),y=G.apply(y),y.x=y.x+C,y.y=y.y+A;let _e=.35,de=.2,me=.2;const fe=10,ae=10;if(me*m>100&&(me=100/m),_e*f>150&&(_e=150/f),de*f>150&&(de=150/f),c.limitedLocationX&&c.screenWd==m&&c.screenHt==f&&(me=0),c.limitedLocationY&&c.screenWd==m&&c.screenHt==f&&(_e=0,de=0),d.width=d.width*(1-me*2),d.height=d.height*(1-(_e+de)),d.width<fe&&(d.width=fe),d.height<ae&&(d.height=ae),_e+de>0?(d.x+=-d.width/2,d.y+=-d.height*(de/(_e+de))):(d.x+=-d.width/2,d.y+=-d.height/2),W=l.getScreenPoint(I),!W)return;if(W){W.x=W.x+n.screenOffsetX,W.y=W.y+n.screenOffsetY,I.z=_,I.x=Math.round(y.x*2)/2,I.y=Math.round(y.y*2)/2,c.location||(l.location=I,this.useOffsetScrolling?c.initializeLocation(new Y(0,0,0)):c.initializeLocation(I));const Te=l.getScreenPoint(I),Se=new Y(0,0,0);Te&&(Se.x=Te.x,Se.y=Te.y),(W.x<d.left||W.x>d.right)&&!c.centeredLocX||(W.y<d.top||W.y>d.bottom)&&!c.centeredLocY||ee&&!c.centeredLocX&&c.screenWd!=m||ie&&!c.centeredLocY&&c.screenHt!=f||c.roomWd!=E.width||c.roomHt!=E.height||c.screenWd!=m||c.screenHt!=f?(c.limitedLocationX=V,c.limitedLocationY=se,this.useOffsetScrolling?c.target=Se:c.target=I):(V||(c.limitedLocationX=!1),se||(c.limitedLocationY=!1))}if(c.centeredLocX=ee,c.centeredLocY=ie,c.screenWd=m,c.screenHt=f,c.scale=l.scale,c.geometryUpdateId=l.updateId,c.roomWd=E.width,c.roomHt=E.height,this._sessionDataManager.isCameraFollowDisabled)return;this.useOffsetScrolling?c.update(r,8):c.update(r,.5),this.useOffsetScrolling?this.setRoomInstanceRenderingCanvasOffset(this.activeRoomId,1,new ot(-c.location.x,-c.location.y)):l.adjustLocation(c.location,25)}else c.limitedLocationX=!1,c.limitedLocationY=!1,c.centeredLocX=!1,c.centeredLocY=!1}getRoomCanvasRectangle(e,t){const i=this.getRoomInstanceRenderingCanvas(e,t);return i?new En(0,0,i.width,i.height):null}getRoomInstanceData(e){const t=this._roomInstanceDatas.get(e);if(t)return t;const i=new Tee(e);return this._roomInstanceDatas.set(i.roomId,i),i}getCurrentRoomCamera(){return this.getRoomCamera(this._activeRoomId)}getRoomCamera(e){const t=this.getRoomInstanceData(e);return t?t.roomCamera:null}createRoomObjectAndInitialize(e,t,i,r){const n=this.getRoomInstance(e);return n?n.createRoomObjectAndInitalize(t,i,r):null}removeRoomObject(e,t,i){const r=this.getRoomInstance(e);if(!r)return null;r.removeRoomObject(t,i),this.events&&this.events.dispatchEvent(new ke(ke.REMOVED,e,t,i))}fixedUserLocation(e,t){if(!t)return null;const i=this.getFurnitureStackingHeightMap(e),r=this.getLegacyWallGeometry(e);if(!i||!r)return t;let n=t.z;const o=i.getTileHeight(t.x,t.y),l=r.getHeight(t.x,t.y);return Math.abs(n-o)<.02&&Math.abs(o-l)<.02&&(n=r.getFloorAltitude(t.x,t.y)),new Y(t.x,t.y,n)}onBadgeImageReadyEvent(e){if(!this._sessionDataManager)return;const t=this._badgeListenerObjects&&this._badgeListenerObjects.get(e.badgeId);if(t){for(const i of t){if(!i)continue;this.putBadgeInObjectAssets(i.object,e.badgeId,i.groupBadge);const r=i.groupBadge?this._sessionDataManager.loadGroupBadgeImage(e.badgeId):this._sessionDataManager.loadBadgeImage(e.badgeId);i.object&&i.object.logic&&i.object.logic.processUpdateMessage(new Qu(e.badgeId,r))}this._badgeListenerObjects.delete(e.badgeId),this._badgeListenerObjects.size||this._sessionDataManager.events.removeEventListener(Nl.IMAGE_READY,this.onBadgeImageReadyEvent)}}putBadgeInObjectAssets(e,t,i=!1){if(!this._roomContentLoader||!this._sessionDataManager)return;const r=i?this._sessionDataManager.loadGroupBadgeImage(t):this._sessionDataManager.loadBadgeImage(t),n=i?this._sessionDataManager.getGroupBadgeImage(t):this._sessionDataManager.getBadgeImage(t);n&&this._roomContentLoader.addAssetToCollection(e.type,r,n,!1)}handleRoomDragging(e,t,i,r,n,o,l){if(this._areaSelectionManager.areaSelectionState==Cd.SELECTING)return this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,!1;let c=t-this._activeRoomActiveCanvasMouseX,u=i-this._activeRoomActiveCanvasMouseY;if(r===Re.MOUSE_DOWN)!n&&!o&&!l&&!this.isDecorating&&this._roomAllowsDragging&&(this._activeRoomIsDragged=!0,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=this._activeRoomActiveCanvasMouseX,this._activeRoomDragStartY=this._activeRoomActiveCanvasMouseY);else if(r===Re.MOUSE_UP){if(this._activeRoomIsDragged&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged)){const d=this.getRoomInstanceData(this._activeRoomId);if(d){const _=d.roomCamera;_&&(this.useOffsetScrolling&&(_.isMoving||(_.centeredLocX=!1,_.centeredLocY=!1),_.resetLocation(new Y(-e.screenOffsetX,-e.screenOffsetY))),this._roomDraggingAlwaysCenters&&_.reset())}}}else if(r===Re.MOUSE_MOVE)this._activeRoomIsDragged&&(this._activeRoomWasDragged||(c=t-this._activeRoomDragStartX,u=i-this._activeRoomDragStartY,(c<=-Mt.DRAG_THRESHOLD||c>=Mt.DRAG_THRESHOLD||u<=-Mt.DRAG_THRESHOLD||u>=Mt.DRAG_THRESHOLD)&&(this._activeRoomWasDragged=!0),c=0,u=0),(c!=0||u!=0)&&(this._activeRoomDragX+=c,this._activeRoomDragY+=u,this._activeRoomWasDragged=!0));else if((r===Re.MOUSE_CLICK||r===Re.DOUBLE_CLICK)&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged))return this._activeRoomWasDragged=!1,!0;return!1}setMouseButton(e,t,i){if(!this._roomSessionManager)return;const r=this._roomSessionManager.getSession(e);if(r&&(t!==Q.FLOOR&&t!==Q.WALL||r.controllerLevel>=pt.USER_WITH_RIGHTS)){const n=this.getRoomInstanceData(e);n&&n.addButtonMouseCursorOwner(t+"_"+i)&&(this._mouseCursorUpdate=!0)}}setMouseDefault(e,t,i){if(!this._roomSessionManager)return;const r=this.getRoomInstanceData(e);r&&r.removeButtonMouseCursorOwner(t+"_"+i)&&(this._mouseCursorUpdate=!0)}processRoomObjectEvent(e,t){if(!this._roomObjectEventHandler)return;const i=this.getRoomObjectRoomId(e.object);if(!i)return;const r=this.getRoomIdFromString(i);this._roomObjectEventHandler.handleRoomObjectEvent(e,r,t)}addOverlayIconSprite(e,t,i,r=1){if(!e||!i)return;let n=this.getOverlayIconSprite(e,t);return n?null:(n=new Is(i),n.name=t,n.scale.set(r),e.addChild(n),n)}getRenderingCanvasOverlay(e){if(!e)return null;const t=e.master;return t&&t.getChildByName(Mt.OVERLAY)||null}removeOverlayIconSprite(e,t){if(!e)return!1;let i=e.children.length-1;for(;i>=0;){const r=e.getChildAt(i);if(r&&r.name===t){if(e.removeChildAt(i),r.children.length){const n=r.getChildAt(0);n.parent.removeChild(n),n.destroy()}return!0}i--}return!1}getOverlayIconSprite(e,t){if(!e)return null;let i=e.children.length-1;for(;i>=0;){const r=e.getChildAt(i);if(r&&r.name===t)return r;i--}return null}getRoomIdFromString(e){if(!e)return-1;const t=e.split("_");return t.length<=0?-1:parseInt(t[0])||0}getRoomObjectRoomId(e){return!e||!e.model?null:e.model.getValue(D.OBJECT_ROOM_ID)}getRoomObjectAdUrl(e){return this._roomContentLoader.getRoomObjectAdUrl(e)}getPetType(e){if(!e)return null;const t=e.split(" ");if(t.length>1){const i=parseInt(t[0]);return this._roomContentLoader?this._roomContentLoader.getPetNameForType(i):"pet"}return null}applyEffect(e=0,t=null){var r,n;if(t||(t=(r=this.getActiveRoomInstanceRenderingCanvas())==null?void 0:r.display),t||(t=(n=this.getRoomInstanceRenderingCanvas(this._activeRoomId,1))==null?void 0:n.display),!t)return;const i=new Gu;switch(e){default:case 0:t.filters=[];break;case 1:i.blackAndWhite(!0),t.filters=[i];break;case 2:i.sepia(!0),t.filters=[i];break;case 3:i.browni(!0),t.filters=[i];break;case 4:i.vintage(!0),t.filters=[i];break;case 5:i.kodachrome(!0),t.filters=[i];break;case 6:i.lsd(!0),t.filters=[i];break;case 7:i.polaroid(!0),t.filters=[i];break;case 8:i.technicolor(!0),t.filters=[i];break}}hasClickUserWired(){return this._wiredEnvironment.hasClickUserWired}};Mt.ROOM_OBJECT_ID=-1,Mt.ROOM_OBJECT_TYPE="room",Mt.CURSOR_OBJECT_ID=-2,Mt.CURSOR_OBJECT_TYPE="tile_cursor",Mt.ARROW_OBJECT_ID=-3,Mt.ARROW_OBJECT_TYPE="selection_arrow",Mt.OVERLAY="overlay",Mt.OBJECT_ICON_SPRITE="object_icon_sprite",Mt.DRAG_THRESHOLD=15,Mt.TEMPORARY_ROOM="temporary_room";let rm=Mt;const ye=class ye{constructor(e,t=1){this._previewRoomId=1,this._currentPreviewObjectType=0,this._currentPreviewObjectCategory=0,this._currentPreviewObjectData="",this._currentPreviewRectangle=null,this._currentPreviewCanvasWidth=0,this._currentPreviewCanvasHeight=0,this._currentPreviewScale=64,this._backgroundColor=305148561,this._backgroundSprite=null,this._disableUpdate=!1,this._roomEngine=e,this._planeParser=new vi,this._previewRoomId=Ba.makeRoomPreviewerId(t),this._addViewOffset=new ot(0,0),this.onRoomObjectAdded=this.onRoomObjectAdded.bind(this),this.onRoomInitializedonRoomInitialized=this.onRoomInitializedonRoomInitialized.bind(this),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.addEventListener(ke.ADDED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(ke.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(Ot.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this.createRoomForPreview()}dispose(){this.reset(!0),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.removeEventListener(ke.ADDED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(ke.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(Ot.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this._backgroundSprite&&(this._backgroundSprite.destroy(),this._backgroundSprite=null),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}createRoomForPreview(){if(this.isRoomEngineReady){const t=new vi;t.initializeTileMap(9,9);let i=1;for(;i<8;){let r=1;for(;r<8;)t.setTileHeight(r,i,0),r++;i++}t.initializeFromTileData(),this._roomEngine.createRoomInstance(this._previewRoomId,t.getMapData()),t.dispose()}}reset(e){this.isRoomEngineReady&&(this._roomEngine.removeRoomObjectFloor(this._previewRoomId,ye.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectWall(this._previewRoomId,ye.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectUser(this._previewRoomId,ye.PREVIEW_OBJECT_ID),e||this.updatePreviewRoomView()),this._currentPreviewObjectCategory=Q.MINIMUM}updatePreviewModel(e,t,i=!0){const r=new Vf;r.flush(),r.parseModel(e,t,i);const n=this._roomEngine.getLegacyWallGeometry(this._previewRoomId);if(!n)return;this._planeParser.reset();const o=r.width,l=r.height;this._planeParser.initializeTileMap(o,l);const c=null;let u=-1,d=-1,_=0,m=0,f=0;for(;f<l;){let S=0;for(;S<o;){const R=r.getHeight(S,f);(f>0&&f<l-1||S>0&&S<o-1)&&R!=vi.TILE_BLOCKED&&c==null&&(r.getHeight(S,f-1)==vi.TILE_BLOCKED&&r.getHeight(S-1,f)==vi.TILE_BLOCKED&&r.getHeight(S,f+1)==vi.TILE_BLOCKED&&(u=S+.5,d=f,_=R,m=90),r.getHeight(S,f-1)==vi.TILE_BLOCKED&&r.getHeight(S-1,f)==vi.TILE_BLOCKED&&r.getHeight(S+1,f)==vi.TILE_BLOCKED&&(u=S,d=f+.5,_=R,m=180)),this._planeParser.setTileHeight(S,f,R),S++}f++}this._planeParser.setTileHeight(Math.floor(u),Math.floor(d),_),this._planeParser.initializeFromTileData(r.wallHeight),this._planeParser.setTileHeight(Math.floor(u),Math.floor(d),_+this._planeParser.wallHeight),n.scale=sm.DEFAULT_SCALE,n.initialize(o,l,this._planeParser.floorHeight);let E=r.height-1;for(;E>=0;){let S=r.width-1;for(;S>=0;)n.setHeight(S,E,this._planeParser.getTileHeight(S,E)),S--;E--}const I=this._planeParser.getMapData();I.doors.push({x:u,y:d,z:_,dir:m});const p=this.getRoomPreviewOwnRoomObject();p&&p.processUpdateMessage(new bp(I))}addFurnitureIntoRoom(e,t,i=null,r=null){if(i||(i=new Xr),this.isRoomEngineReady&&(this.reset(!1),this._currentPreviewObjectType=e,this._currentPreviewObjectCategory=Q.FLOOR,this._currentPreviewObjectData="",this._roomEngine.addFurnitureFloor(this._previewRoomId,ye.PREVIEW_OBJECT_ID,e,new Y(ye.PREVIEW_OBJECT_LOCATION_X,ye.PREVIEW_OBJECT_LOCATION_Y,0),t,0,i,NaN,-1,0,-1,"",!0,!1))){this._previousAutomaticStateChangeTime=nt(),this._automaticStateChange=!0;const n=this._roomEngine.getRoomObject(this._previewRoomId,ye.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);return n&&r&&n.model.setValue(D.FURNITURE_EXTRAS,r),this.updatePreviewRoomView(),ye.PREVIEW_OBJECT_ID}return-1}addWallItemIntoRoom(e,t,i){if(this.isRoomEngineReady){if(this._currentPreviewObjectCategory===Q.WALL&&this._currentPreviewObjectType===e&&this._currentPreviewObjectData===i)return ye.PREVIEW_OBJECT_ID;if(this.reset(!1),this._currentPreviewObjectType=e,this._currentPreviewObjectCategory=Q.WALL,this._currentPreviewObjectData=i,this._roomEngine.addFurnitureWall(this._previewRoomId,ye.PREVIEW_OBJECT_ID,e,new Y(.5,2.3,1.8),t,0,i,0,0,-1,"",!1))return this._previousAutomaticStateChangeTime=nt(),this._automaticStateChange=!0,this.updatePreviewRoomView(),ye.PREVIEW_OBJECT_ID}return-1}addAvatarIntoRoom(e,t){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=Q.UNIT,this._currentPreviewObjectData=e,this._roomEngine.addRoomObjectUser(this._previewRoomId,ye.PREVIEW_OBJECT_ID,new Y(ye.PREVIEW_OBJECT_LOCATION_X,ye.PREVIEW_OBJECT_LOCATION_Y,0),new Y(90,0,0),135,Ft.getTypeNumber(Ft.USER),e)&&(this._previousAutomaticStateChangeTime=nt(),this._automaticStateChange=!0,this.updateUserGesture(1),this.updateUserEffect(t),this.updateUserPosture("std")),this.updatePreviewRoomView(),ye.PREVIEW_OBJECT_ID):-1}addPetIntoRoom(e){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=Q.UNIT,this._currentPreviewObjectData=e,this._roomEngine.addRoomObjectUser(this._previewRoomId,ye.PREVIEW_OBJECT_ID,new Y(ye.PREVIEW_OBJECT_LOCATION_X,ye.PREVIEW_OBJECT_LOCATION_Y,0),new Y(90,0,0),90,Ft.getTypeNumber(Ft.PET),e)&&(this._previousAutomaticStateChangeTime=nt(),this._automaticStateChange=!1,this.updateUserGesture(1),this.updateUserPosture("std")),this.updatePreviewRoomView(),ye.PREVIEW_OBJECT_ID):-1}updateUserPosture(e,t=""){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserPosture(this._previewRoomId,ye.PREVIEW_OBJECT_ID,e,t)}updateUserGesture(e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserGesture(this._previewRoomId,ye.PREVIEW_OBJECT_ID,e)}updateUserEffect(e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserEffect(this._previewRoomId,ye.PREVIEW_OBJECT_ID,e)}updateObjectUserFigure(e,t=null,i=null,r=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomObjectUserFigure(this._previewRoomId,ye.PREVIEW_OBJECT_ID,e,t,i,r):!1}updateObjectUserAction(e,t,i=null){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserAction(this._previewRoomId,ye.PREVIEW_OBJECT_ID,e,t,i)}updateObjectStuffData(e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectFloor(this._previewRoomId,ye.PREVIEW_OBJECT_ID,null,null,e.state,e)}changeRoomObjectState(){this.isRoomEngineReady&&(this._automaticStateChange=!1,this._currentPreviewObjectCategory!==Q.UNIT&&this._roomEngine.changeObjectState(this._previewRoomId,ye.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}changeRoomObjectDirection(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,ye.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(!e)return;const t=this._roomEngine.objectEventHandler.getValidRoomObjectDirection(e,!0);switch(this._currentPreviewObjectCategory){case Q.FLOOR:{const i=new Y(ye.PREVIEW_OBJECT_LOCATION_X,ye.PREVIEW_OBJECT_LOCATION_Y),r=new Y(t,t,t);this._roomEngine.updateRoomObjectFloor(this._previewRoomId,ye.PREVIEW_OBJECT_ID,i,r,null,null);return}case Q.WALL:return}}}checkAutomaticRoomObjectStateChange(){if(this._automaticStateChange){const e=nt();e>this._previousAutomaticStateChangeTime+ye.AUTOMATIC_STATE_CHANGE_INTERVAL&&(this._previousAutomaticStateChangeTime=e,this.isRoomEngineReady&&this._roomEngine.changeObjectState(this._previewRoomId,ye.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}}getRoomCanvas(e,t){if(this.isRoomEngineReady){const i=this._roomEngine.getRoomInstanceDisplay(this._previewRoomId,ye.PREVIEW_CANVAS_ID,e,t,this._currentPreviewScale);if(i&&this._backgroundColor!==null){let n=this._backgroundSprite;n||(n=new Is(Qs.WHITE),i.addChildAt(n,0)),n.width=e,n.height=t,n.tint=this._backgroundColor}this._roomEngine.setRoomInstanceRenderingCanvasMask(this._previewRoomId,ye.PREVIEW_CANVAS_ID,!0);const r=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,ye.PREVIEW_CANVAS_ID);return r&&r.adjustLocation(new Y(ye.PREVIEW_OBJECT_LOCATION_X,ye.PREVIEW_OBJECT_LOCATION_Y,0),30),this._currentPreviewCanvasWidth=e,this._currentPreviewCanvasHeight=t,i}return null}modifyRoomCanvas(e,t){this.isRoomEngineReady&&(this._currentPreviewCanvasWidth=e,this._currentPreviewCanvasHeight=t,this._backgroundSprite&&(this._backgroundSprite.width=e,this._backgroundSprite.height=t),this._roomEngine.initializeRoomInstanceRenderingCanvas(this._previewRoomId,ye.PREVIEW_CANVAS_ID,e,t))}set addViewOffset(e){this._addViewOffset=e}get addViewOffset(){return this._addViewOffset}updatePreviewObjectBoundingRectangle(e){const t=this._roomEngine.getRoomObjectBoundingRectangle(this._previewRoomId,ye.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,ye.PREVIEW_CANVAS_ID);if(t&&e)if(t.x+=-(this._currentPreviewCanvasWidth>>1),t.y+=-(this._currentPreviewCanvasHeight>>1),t.x+=-e.x,t.y+=-e.y,!this._currentPreviewRectangle)this._currentPreviewRectangle=t;else{const i=this._currentPreviewRectangle.clone().enlarge(t);(i.width-this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth-this._currentPreviewRectangle.width>>1||i.height-this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1||this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)&&(this._currentPreviewRectangle=i)}}validatePreviewSize(e){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return e;if(this.isRoomEngineReady){const t=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,ye.PREVIEW_CANVAS_ID);this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth*(1+ye.ALLOWED_IMAGE_CUT)||this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight*(1+ye.ALLOWED_IMAGE_CUT)?ye.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,ye.PREVIEW_CANVAS_ID)!==.5&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,ye.PREVIEW_CANVAS_ID,.5,null,null),this._currentPreviewScale=ye.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0,e.x=e.x>>1,e.y=e.y>>1,this._currentPreviewRectangle.x=this._currentPreviewRectangle.x>>2,this._currentPreviewRectangle.y=this._currentPreviewRectangle.y>>2,this._currentPreviewRectangle.width=this._currentPreviewRectangle.width>>2,this._currentPreviewRectangle.height=this._currentPreviewRectangle.height>>2):t.isZoomedIn()&&(t.performZoomOut(),this._currentPreviewScale=ye.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0):this._currentPreviewNeedsZoomOut||(ye.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,ye.PREVIEW_CANVAS_ID)!==1&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,ye.PREVIEW_CANVAS_ID,1,null,null),this._currentPreviewScale=ye.SCALE_NORMAL):t.isZoomedIn()||(t.performZoomIn(),this._currentPreviewScale=ye.SCALE_NORMAL))}return e}zoomIn(){this.isRoomEngineReady&&(ye.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,ye.PREVIEW_CANVAS_ID,1):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,ye.PREVIEW_CANVAS_ID).performZoomIn()),this._currentPreviewScale=ye.SCALE_NORMAL}zoomOut(){this.isRoomEngineReady&&(ye.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,ye.PREVIEW_CANVAS_ID,.5):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,ye.PREVIEW_CANVAS_ID).performZoomOut()),this._currentPreviewScale=ye.SCALE_SMALL}updateAvatarDirection(e,t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserLocation(this._previewRoomId,ye.PREVIEW_OBJECT_ID,new Y(ye.PREVIEW_OBJECT_LOCATION_X,ye.PREVIEW_OBJECT_LOCATION_Y,0),new Y(ye.PREVIEW_OBJECT_LOCATION_X,ye.PREVIEW_OBJECT_LOCATION_Y,0),!1,0,new Y(e*45,0,0),t*45)}updateObjectRoom(e=null,t=null,i=null,r=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,e,t,i,r):!1}updateRoomWallsAndFloorVisibility(e,t=!0){this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneVisibility(this._previewRoomId,e,t)}getCanvasOffset(e){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return e;let t=-(this._currentPreviewRectangle.left+this._currentPreviewRectangle.right)>>1,i=-(this._currentPreviewRectangle.top+this._currentPreviewRectangle.bottom)>>1;const r=this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1;r>10?i=i+Math.min(15,r-10):this._currentPreviewObjectCategory!==Q.UNIT?i=i+(5-Math.max(0,r/2)):i=i-(5-Math.min(0,r/2)),i=i+this._addViewOffset.y,t=t+this._addViewOffset.x;const n=t-e.x,o=i-e.y;if(n!==0||o!==0){const l=Math.sqrt(n*n+o*o);return l>10&&(t=e.x+n*10/l,i=e.y+o*10/l),new ot(t,i)}return null}updatePreviewRoomView(e=!1){if(!(this._disableUpdate&&!e)&&(this.checkAutomaticRoomObjectStateChange(),this.isRoomEngineReady)){let t=this._roomEngine.getRoomInstanceRenderingCanvasOffset(this._previewRoomId,ye.PREVIEW_CANVAS_ID);if(t&&(this.updatePreviewObjectBoundingRectangle(t),this._currentPreviewRectangle)){const i=this._currentPreviewScale;t=this.validatePreviewSize(t);const r=this.getCanvasOffset(t);r&&this._roomEngine.setRoomInstanceRenderingCanvasOffset(this._previewRoomId,ye.PREVIEW_CANVAS_ID,r),this._currentPreviewScale!==i&&(this._currentPreviewRectangle=null)}}}set disableUpdate(e){this._disableUpdate=e}set disableRoomEngineUpdate(e){this.isRoomEngineReady&&this._roomEngine.disableUpdate(e)}onRoomInitializedonRoomInitialized(e){if(e)switch(e.type){case Ot.INITIALIZED:e.roomId===this._previewRoomId&&this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,"110","99999");return}}onRoomObjectAdded(e){if(e.roomId===this._previewRoomId&&e.objectId===ye.PREVIEW_OBJECT_ID&&e.category===this._currentPreviewObjectCategory){this._currentPreviewRectangle=null,this._currentPreviewNeedsZoomOut=!1;const t=this._roomEngine.getRoomObject(e.roomId,e.objectId,e.category);if(t&&t.model&&e.category===Q.WALL){const i=t.model.getValue(D.FURNITURE_SIZE_Z),r=t.model.getValue(D.FURNITURE_CENTER_Z);(i!==null||r!==null)&&this._roomEngine.updateRoomObjectWallLocation(e.roomId,e.objectId,new Y(.5,2.3,(3.6-i)/2+r))}}}updateRoomEngine(){this.isRoomEngineReady&&this._roomEngine.runUpdate()}getRenderingCanvas(){const e=this._roomEngine.getRoomInstanceRenderingCanvas(this._previewRoomId,ye.PREVIEW_CANVAS_ID);return e||null}getGenericRoomObjectImage(e,t,i,r,n,o=0,l=null,c=null,u=-1,d=-1,_=null){return this.isRoomEngineReady?this._roomEngine.getGenericRoomObjectImage(e,t,i,r,n,o,l,c,u,d,_):null}getRoomObjectImage(e,t,i,r=0){return this.isRoomEngineReady?this._roomEngine.getRoomObjectImage(this._previewRoomId,ye.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,e,t,i,r):null}getRoomObjectCurrentImage(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,ye.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(e&&e.visualization)return e.visualization.getImage(16777215,-1)}return null}getRoomPreviewObject(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,ye.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(e)return e}return null}getRoomPreviewOwnRoomObject(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,rm.ROOM_OBJECT_ID,Q.ROOM);if(e)return e}return null}get isRoomEngineReady(){return this._roomEngine&&this._roomEngine.ready}get roomId(){return this._previewRoomId}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){this._backgroundColor=e}get width(){return this._currentPreviewCanvasWidth}get height(){return this._currentPreviewCanvasHeight}};ye.SCALE_NORMAL=64,ye.SCALE_SMALL=32,ye.PREVIEW_COUNTER=0,ye.PREVIEW_CANVAS_ID=1,ye.PREVIEW_OBJECT_ID=1,ye.PREVIEW_OBJECT_LOCATION_X=2,ye.PREVIEW_OBJECT_LOCATION_Y=2,ye.ALLOWED_IMAGE_CUT=.25,ye.AUTOMATIC_STATE_CHANGE_INTERVAL=2500,ye.ZOOM_ENABLED=!0;let kd=ye;class Xb{constructor(e,t){this._image=e,this._placeHolder=t}get image(){return this._image}get placeHolder(){return this._placeHolder}}class Nee{constructor(e){this._code=e,this._parts=[]}get code(){return this._code}get parts(){return this._parts}}const Zs=class Zs{constructor(e,t=0,i=0,r=0){this.type=e,this.key=t,this.color=i,this.position=r}get code(){return this.key===0?null:Zs.getCode(this.type,this.key,this.color,this.position)}static getCode(e,t,i,r){return(e===Zs.BASE?e:t>=100?Zs.SYMBOL_ALT:Zs.SYMBOL)+(t<10?"0":"")+(e===Zs.BASE?t:t>=100?t-100:t)+(i<10?"0":"")+i+r}calculatePosition(e){const t=this.calculateGridPos(this.position);let i=Zs.CELL_WIDTH*t.x+Zs.CELL_WIDTH/2-e.width/2,r=Zs.CELL_HEIGHT*t.y+Zs.CELL_HEIGHT/2-e.height/2;return i<0&&(i=0),i+e.width>Zs.IMAGE_WIDTH&&(i=Zs.IMAGE_WIDTH-e.width),r<0&&(r=0),r+e.height>Zs.IMAGE_HEIGHT&&(r=Zs.IMAGE_HEIGHT-e.height),new ei(Math.floor(i),Math.floor(r))}calculateGridPos(e){const t=new ei;return t.x=Math.floor(e%3),t.y=Math.floor(e/3),t}};Zs.BASE="b",Zs.SYMBOL="s",Zs.SYMBOL_ALT="t",Zs.BASE_PART=0,Zs.LAYER_PART=1,Zs.IMAGE_WIDTH=39,Zs.IMAGE_HEIGHT=39,Zs.CELL_WIDTH=13,Zs.CELL_HEIGHT=13;let xc=Zs;const oa=class oa{constructor(e,t){this._assets=e,this._sessionDataManager=t,this._groupBases=new Map,this._groupSymbols=new Map,this._groupPartColors=new Map,this._requestedBadges=new Map,this._groupBadgesQueue=new Map,this._readyToGenerateGroupBadges=!1}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new SC(this.onGroupBadgePartsEvent.bind(this))];for(const e of this._messages)this._sessionDataManager.communication.registerMessageEvent(e)}}dispose(){if(this._messages&&this._messages.length){for(const e of this._messages)this._sessionDataManager.communication.removeMessageEvent(e);this._messages=null}this._sessionDataManager=null}getBadgeImage(e,t=oa.NORMAL_BADGE,i=!0){let r=this.getBadgeTexture(e,t);return!r&&i&&(r=this.getBadgePlaceholder()),r}getBadgeInfo(e){const t=this.getBadgeTexture(e);return t?new Xb(t,!1):new Xb(this.getBadgePlaceholder(),!0)}loadBadgeImage(e,t=oa.NORMAL_BADGE){return this._assets.getTexture(this.getBadgeUrl(e,t))?e:(this.getBadgeTexture(e,t),null)}getBadgeTexture(e,t=oa.NORMAL_BADGE){const i=this.getBadgeUrl(e,t);if(!i||!i.length)return null;const r=this._assets.getTexture(i);if(r)return r.clone();if(t===oa.NORMAL_BADGE){if(this._requestedBadges.get(e))return null;this._requestedBadges.set(e,!0),this._assets.downloadAsset(i).then(n=>{if(!n)return;this._requestedBadges.delete(e);const o=this._assets.getTexture(i);o&&this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new Nl(e,o.clone()))}).catch(n=>{})}else if(t===oa.GROUP_BADGE){if(this._groupBadgesQueue.get(e))return;this._groupBadgesQueue.set(e,!0),this._readyToGenerateGroupBadges&&this.loadGroupBadge(e)}return null}getBadgePlaceholder(){const e=st.getValue("images.url")+"/loading_icon.png",t=this._assets.getTexture(e);return t?t.clone():null}getBadgeUrl(e,t=oa.NORMAL_BADGE){let i=null;switch(t){case oa.NORMAL_BADGE:i=st.getValue("badge.asset.url").replace("%badgename%",e);break;case oa.GROUP_BADGE:i=e;break}return i}loadGroupBadge(e){const t=new Nee(e),i=[...e.matchAll(/[b|s][0-9]{4,6}/g)];for(const r of i){const n=r[0],o=n.length===6,l=n[0],c=parseInt(n.slice(1,o?3:4)),u=parseInt(n.slice(o?3:4,o?5:6)),d=n.length<6?0:parseInt(n.slice(o?5:6,o?6:7)),_=new xc(l,c,u,d);t.parts.push(_)}this.renderGroupBadge(t)}renderGroupBadge(e){const t=new kn,i=new Is(sC.EMPTY);i.width=xc.IMAGE_WIDTH,i.height=xc.IMAGE_HEIGHT,t.addChild(i);for(const n of e.parts){let o=!0;const l=n.type==="b"?this._groupBases.get(n.key):this._groupSymbols.get(n.key);if(l)for(const c of l){if(!c||!c.length)continue;const u=this._assets.getTexture(`badgepart_${c}`);if(!u)continue;const{x:d,y:_}=n.calculatePosition(u),m=new Is(u);m.position.set(d,_),o&&(m.tint=parseInt(this._groupPartColors.get(n.color),16)),o=!1,t.addChild(m)}}this._requestedBadges.delete(e.code),this._groupBadgesQueue.delete(e.code);const r=Vt.generateTexture(t);this._assets.setTexture(e.code,r),this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new Nl(e.code,r))}onGroupBadgePartsEvent(e){if(!e)return;const t=e.getParser();if(t){t.bases.forEach((i,r)=>this._groupBases.set(r,i.map(n=>n.replace(".png","").replace(".gif","")))),t.symbols.forEach((i,r)=>this._groupSymbols.set(r,i.map(n=>n.replace(".png","").replace(".gif","")))),this._groupPartColors=t.partColors,this._readyToGenerateGroupBadges=!0;for(const i of this._groupBadgesQueue.keys())this.loadGroupBadge(i)}}get disposed(){return!!this._sessionDataManager}};oa.GROUP_BADGE="group_badge",oa.NORMAL_BADGE="normal_badge";let Nh=oa;class $b{constructor(e,t,i,r,n,o,l,c,u,d,_,m,f,E,I,p,S,R,O,C,A,b,y,M,U,G,F,H,v){this._type=e,this._id=t,this._fullName=i,this._className=r,this._category=n,this._revision=c,this._tileSizeX=u,this._tileSizeY=d,this._tileSizeZ=_,this._colors=m,this._hasIndexedColor=f,this._colourIndex=E,this._localizedName=o,this._description=l,this._adUrl=I,this._purchaseOfferId=p,this._purchaseCouldBeUsedForBuyout=S,this._rentOfferId=R,this._rentCouldBeUsedForBuyout=O,this._customParams=A,this._specialType=b,this._availableForBuildersClub=C,this._canStandOn=y,this._canSitOn=M,this._canLayOn=U,this._excludedFromDynamic=G,this._furniLine=F,this._environment=H,this._rare=v}get type(){return this._type}get id(){return this._id}get className(){return this._className}set className(e){this._className=e}get fullName(){return this._fullName}get category(){return this._category}get hasIndexedColor(){return this._hasIndexedColor}get colorIndex(){return this._colourIndex}get revision(){return this._revision}get tileSizeX(){return this._tileSizeX}get tileSizeY(){return this._tileSizeY}get tileSizeZ(){return this._tileSizeZ}get colors(){return this._colors}get name(){return this._localizedName}get description(){return this._description}get adUrl(){return this._adUrl}get purchaseOfferId(){return this._purchaseOfferId}get customParams(){return this._customParams}get specialType(){return this._specialType}get rentOfferId(){return this._rentOfferId}get purchaseCouldBeUsedForBuyout(){return this._purchaseCouldBeUsedForBuyout}get rentCouldBeUsedForBuyout(){return this._rentCouldBeUsedForBuyout}get availableForBuildersClub(){return this._availableForBuildersClub}get canStandOn(){return this._canStandOn}get canSitOn(){return this._canSitOn}get canLayOn(){return this._canLayOn}get isExternalImage(){return this._className.indexOf("external_image")!==-1}get excludeDynamic(){return this._excludedFromDynamic}get furniLine(){return this._furniLine}get environment(){return this._environment}get rare(){return this._rare}}const hd=class hd extends Sn{constructor(e,t,i){super(),this._floorItems=e,this._wallItems=t,this._localization=i}loadFurnitureData(e){e&&fetch(e).then(t=>t.json()).then(t=>this.onFurnitureDataLoaded(t)).catch(t=>this.onFurnitureDataError(t))}onFurnitureDataLoaded(e){e&&((typeof e.roomitemtypes>"u"||typeof e.wallitemtypes>"u")&&ze.warn("Could not find `roomitemtypes` or `wallitemtypes` in furnidata."),e.roomitemtypes&&this.parseFloorItems(e.roomitemtypes),e.wallitemtypes&&this.parseWallItems(e.wallitemtypes),this.dispatchEvent(new _t(hd.FURNITURE_DATA_READY)))}onFurnitureDataError(e){e&&(ze.error(e),this.dispatchEvent(new _t(hd.FURNITURE_DATA_ERROR)))}parseFloorItems(e){if(!(!e||!e.furnitype))for(const t of e.furnitype){if(!t)continue;const i=[];if(t.partcolors)for(const u of t.partcolors.color){let d=u;d.charAt(0)==="#"&&(d=d.replace("#","")),i.push(parseInt(d,16))}const r=t.classname.split("*"),n=r[0],o=r.length>1?parseInt(r[1]):0,l=r.length>1,c=new $b(Du.FLOOR,t.id,t.classname,n,t.category,t.name,t.description,t.revision,t.xdim,t.ydim,0,i,l,o,t.adurl,t.offerid,t.buyout,t.rentofferid,t.rentbuyout,t.bc,t.customparams,t.specialtype,t.canstandon,t.cansiton,t.canlayon,t.excludeddynamic,t.furniline,t.environment,t.rare);this._floorItems.set(c.id,c),this.updateLocalizations(c)}}parseWallItems(e){if(!(!e||!e.furnitype))for(const t of e.furnitype){if(!t)continue;const i=new $b(Du.WALL,t.id,t.classname,t.classname,t.category,t.name,t.description,t.revision,0,0,0,null,!1,0,t.adurl,t.offerid,t.buyout,t.rentofferid,t.rentbuyout,t.bc,null,t.specialtype,!1,!1,!1,t.excludeddynamic,t.furniline,t.environment,t.rare);this._wallItems.set(i.id,i),this.updateLocalizations(i)}}updateLocalizations(e){if(this._localization)switch(e.type){case Du.FLOOR:this._localization.setValue("roomItem.name."+e.id,e.name),this._localization.setValue("roomItem.desc."+e.id,e.description);return;case Du.WALL:this._localization.setValue("wallItem.name."+e.id,e.name),this._localization.setValue("wallItem.desc."+e.id,e.description);return}}};hd.FURNITURE_DATA_READY="FDP_FURNITURE_DATA_READY",hd.FURNITURE_DATA_ERROR="FDP_FURNITURE_DATA_ERROR";let g_=hd;class Aee{constructor(e){this._sessionDataManager=e,this._groupBadges=new Map}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new jd(this.onRoomReadyMessageEvent.bind(this)),new UL(this.onGroupBadgesEvent.bind(this))];for(const e of this._messages)this._sessionDataManager.communication.registerMessageEvent(e)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const e of this._messages)this._sessionDataManager.communication.removeMessageEvent(e);this._messages=null}this._groupBadges=null,this._sessionDataManager=null}}onRoomReadyMessageEvent(e){this._sessionDataManager.send(new pF)}onGroupBadgesEvent(e){const t=e.getParser();for(const[i,r]of t.badges.entries())this._groupBadges.set(i,r)}getGroupBadge(e){return this._groupBadges.get(e)}get disposed(){return!!this._sessionDataManager}}const Eg=class Eg{};Eg.NO_CLUB=0,Eg.CLUB=1,Eg.VIP=2;let rr=Eg;class pa extends Qr{constructor(e,t){super(),this._connection=e,this._listener=t,this._roomId=0}onDispose(){this._connection=null,this._listener=null}setRoomId(e){this._roomId=e}get connection(){return this._connection}get listener(){return this._listener}get roomId(){return this._roomId}}class bee extends pa{constructor(e,t){super(e,t),e.addMessageEvent(new Kf(this.onRoomGenericError.bind(this)))}onRoomGenericError(e){if(!(e instanceof Kf))return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);if(!i)return;let r=null;switch(t.errorCode){case US.KICKED_OUT_OF_ROOM:r=Pt.RSEME_KICKED;break;default:return}!r||r.length==0||this.listener.events.dispatchEvent(new Pt(r,i))}}class vee extends pa{constructor(e,t){super(e,t),e.addMessageEvent(new cj(this.onOpenPetPackageRequested.bind(this))),e.addMessageEvent(new uj(this.onOpenPetPackageResult.bind(this)))}onOpenPetPackageRequested(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new dc(dc.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,i,t.objectId,t.figureData,0,null))}onOpenPetPackageResult(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new dc(dc.RSOPPE_OPEN_PET_PACKAGE_RESULT,i,t.objectId,null,t.nameValidationStatus,t.nameValidationInfo))}}class yee extends pa{constructor(e,t){super(e,t),e.addMessageEvent(new gj(this.onPollContentsEvent.bind(this))),e.addMessageEvent(new fj(this.onPollOfferEvent.bind(this))),e.addMessageEvent(new mj(this.onPollErrorEvent.bind(this))),e.addMessageEvent(new Sj(this.onStartRoomPollEvent.bind(this))),e.addMessageEvent(new Tj(this.onRoomPollResultEvent.bind(this)))}onPollContentsEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();if(!i)return;const r=new La(La.CONTENT,t,i.id);r.startMessage=i.startMessage,r.endMessage=i.endMessage,r.numQuestions=i.numQuestions,r.questionArray=i.questionArray,r.npsPoll=i.npsPoll,this.listener.events.dispatchEvent(r)}onPollOfferEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();if(!i)return;const r=new La(La.OFFER,t,i.id);r.headline=i.headline,r.summary=i.summary,this.listener.events.dispatchEvent(r)}onPollErrorEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t||!e.getParser())return;const r=new La(La.ERROR,t,-1);r.headline="???",r.summary="???",this.listener.events.dispatchEvent(r)}onStartRoomPollEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();if(!i)return;const r=new Th(Th.VOTE_QUESTION,t,i.question,i.choices);this.listener.events.dispatchEvent(r)}onRoomPollResultEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();if(!i)return;const r=new Th(Th.VOTE_RESULT,t,i.question,i.choices,i.SafeStr_7651,i.SafeStr_7654);this.listener.events.dispatchEvent(r)}}class Dee extends pa{constructor(e,t){super(e,t),e.addMessageEvent(new jC(this.onRoomUnitChatEvent.bind(this))),e.addMessageEvent(new ip(this.onRoomUnitChatEvent.bind(this))),e.addMessageEvent(new rp(this.onRoomUnitChatEvent.bind(this))),e.addMessageEvent(new tL(this.onRoomUnitHandItemReceivedEvent.bind(this))),e.addMessageEvent(new VC(this.onRespectReceivedEvent.bind(this))),e.addMessageEvent(new BC(this.onKissReceivedEvent.bind(this))),e.addMessageEvent(new HL(this.onPetRespectNoficationEvent.bind(this))),e.addMessageEvent(new WL(this.onPetSupplementedNotificationEvent.bind(this))),e.addMessageEvent(new Zj(this.onFloodControlEvent.bind(this))),e.addMessageEvent(new eL(this.onRemainingMuteEvent.bind(this)))}onRoomUnitChatEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();if(!i)return;let r=wt.CHAT_TYPE_SPEAK;e instanceof ip?r=wt.CHAT_TYPE_SHOUT:e instanceof rp&&(r=wt.CHAT_TYPE_WHISPER);const n=new wt(wt.CHAT_EVENT,t,i.roomIndex,i.message,r,i.bubble,null,-1,i.isMention,i.messageContent);this.listener.events.dispatchEvent(n)}onRoomUnitHandItemReceivedEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();i&&this.listener.events.dispatchEvent(new wt(wt.CHAT_EVENT,t,i.giverUserId,"",wt.CHAT_TYPE_HAND_ITEM_RECEIVED,uc.GENERIC,null,i.handItemType))}onRespectReceivedEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();if(!i)return;const r=t.userDataManager.getUserData(i.userId);r&&this.listener.events.dispatchEvent(new wt(wt.CHAT_EVENT,t,r.roomIndex,"",wt.CHAT_TYPE_RESPECT,uc.RESPECT))}onKissReceivedEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();!i||t.userDataManager.getUserData(i.userId)}onPetRespectNoficationEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();if(!i)return;const r=t.userDataManager.getPetData(i.petData.id);if(!r)return;let n=wt.CHAT_TYPE_PETRESPECT;i.isTreat&&(n=wt.CHAT_TYPE_PETTREAT),this.listener.events.dispatchEvent(new wt(wt.CHAT_EVENT,t,r.roomIndex,"",n,uc.GENERIC))}onPetSupplementedNotificationEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();if(!i)return;const r=t.userDataManager.getPetData(i.petId);if(!r)return;let n=-1;const o=t.userDataManager.getUserData(i.userId);o&&(n=o.roomIndex);let l=wt.CHAT_TYPE_PETREVIVE;switch(i.supplementType){case h_.REVIVE:l=wt.CHAT_TYPE_PETREVIVE;break;case h_.REBREED_FERTILIZER:l=wt.CHAT_TYPE_PET_REBREED_FERTILIZE;break;case h_.SPEED_FERTILIZER:l=wt.CHAT_TYPE_PET_SPEED_FERTILIZE;break}this.listener.events.dispatchEvent(new wt(wt.CHAT_EVENT,t,r.roomIndex,"",l,uc.GENERIC,null,n))}onFloodControlEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();if(!i)return;const r=i.seconds;this.listener.events.dispatchEvent(new wt(wt.FLOOD_EVENT,t,-1,r.toString(),0,0))}onRemainingMuteEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();i&&this.listener.events.dispatchEvent(new wt(wt.CHAT_EVENT,t,t.ownRoomIndex,"",wt.CHAT_TYPE_MUTE_REMAINING,uc.GENERIC,null,i.seconds))}}class Mee extends pa{constructor(e,t){super(e,t),e.addMessageEvent(new bl(this.onGetGuestRoomResultEvent.bind(this)))}onGetGuestRoomResultEvent(e){if(!(e instanceof bl))return;const t=e.getParser();if(!t||t.roomForward)return;const i=this.listener.getSession(this.roomId);if(!i)return;const r=t.data;i.tradeMode=r.tradeMode,i.isGuildRoom=r.habboGroupId!==0,i.doorMode=r.doorMode,i.allowPets=r.allowPets,i.moderationSettings=t.moderation,this.listener.events.dispatchEvent(new Af(Af.RSDUE_ALLOW_PETS,i)),this.listener.events.dispatchEvent(new Ve(Ve.ROOM_DATA,i))}}class jee extends pa{constructor(e,t){super(e,t),e.addMessageEvent(new Bj(this.onRoomDimmerPresets.bind(this)))}onRoomDimmerPresets(e){if(!e)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);if(!i)return;const r=new Dg(Dg.ROOM_DIMMER_PRESETS,i);r.selectedPresetId=t.selectedPresetId;let n=0;for(;n<t.presetCount;){const o=t.getPreset(n);o&&r.storePreset(o.id,o.type,o.color,o.brightness),n++}this.listener&&this.listener.events.dispatchEvent(r)}}class Lee extends pa{constructor(e,t){super(e,t),e.addMessageEvent(new Qf(this.onRoomRightsEvent.bind(this))),e.addMessageEvent(new MR(this.onRoomRightsClearEvent.bind(this))),e.addMessageEvent(new jR(this.onRoomRightsOwnerEvent.bind(this)))}onRoomRightsEvent(e){if(!(e instanceof Qf))return;const t=this.listener.getSession(this.roomId);t&&(t.setControllerLevel(e.getParser().controllerLevel),t.setCanEditAds(e.getParser().canEditAds))}onRoomRightsClearEvent(e){if(!(e instanceof MR))return;const t=this.listener.getSession(this.roomId);t&&t.setControllerLevel(pt.NONE)}onRoomRightsOwnerEvent(e){if(!(e instanceof jR))return;const t=this.listener.getSession(this.roomId);t&&t.setRoomOwner()}}class Pee extends pa{constructor(e,t){super(e,t),e&&e.addMessageEvent(new QM(this.onFurnitureGiftOpenedEvent.bind(this)))}onFurnitureGiftOpenedEvent(e){if(!e)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&this.listener&&this.listener.events&&this.listener.events.dispatchEvent(new Mg(Mg.RSPE_PRESENT_OPENED,i,t.classId,t.itemType,t.productCode,t.placedItemId,t.placedItemType,t.placedInRoom,t.petFigureString))}}const fl=class fl extends pa{constructor(e,t){super(e,t),e.addMessageEvent(new Jf(this.onRoomEnterEvent.bind(this))),e.addMessageEvent(new jd(this.onRoomReadyMessageEvent.bind(this))),e.addMessageEvent(new Gg(this.onDesktopViewEvent.bind(this))),e.addMessageEvent(new $f(this.onRoomDoorbellAcceptedEvent.bind(this))),e.addMessageEvent(new Xf(this.onRoomDoorbellRejectedEvent.bind(this))),e.addMessageEvent(new Jj(this.onYouAreSpectatorMessageEvent.bind(this)))}onRoomEnterEvent(e){e instanceof Jf&&this.listener&&this.listener.sessionUpdate(this.roomId,fl.RS_CONNECTED)}onRoomReadyMessageEvent(e){if(!(e instanceof jd))return;const t=this.roomId,i=e.getParser().roomId;this.listener&&(this.listener.sessionReinitialize(t,i),this.listener.sessionUpdate(this.roomId,fl.RS_READY)),Px(0),jx(!1)}onDesktopViewEvent(e){e instanceof Gg&&this.listener&&this.listener.sessionUpdate(this.roomId,fl.RS_DISCONNECTED)}onRoomDoorbellAcceptedEvent(e){if(!(e instanceof $f)||!this.listener)return;const t=e.getParser();if(!t)return;const i=t.userName;if(!i||!i.length)this.connection.send(new jw(this.roomId));else if(this.listener.events){const r=this.listener.getSession(this.roomId);if(!r)return;this.listener.events.dispatchEvent(new Ga(Ga.RSDE_ACCEPTED,r,i))}}onRoomDoorbellRejectedEvent(e){if(!(e instanceof Xf)||!this.listener)return;const t=e.getParser();if(!t)return;const i=t.userName;if(!i||!i.length)this.listener.sessionUpdate(this.roomId,fl.RS_DISCONNECTED);else if(this.listener.events){const r=this.listener.getSession(this.roomId);if(!r)return;this.listener.events.dispatchEvent(new Ga(Ga.RSDE_REJECTED,r,i))}}onYouAreSpectatorMessageEvent(e){if(this.listener){const t=this.listener.getSession(this.roomId);if(!t)return;t.isSpectator=!0,this.listener.events.dispatchEvent(new bf(bf.SPECTATOR_MODE,t))}}};fl.RS_CONNECTED="RS_CONNECTED",fl.RS_READY="RS_READY",fl.RS_DISCONNECTED="RS_DISCONNECTED";let Ah=fl;class Uee{constructor(){this._adultLevel=7}get id(){return this._id}set id(e){this._id=e}get level(){return this._level}set level(e){this._level=e}get maximumLevel(){return this._maximumLevel}set maximumLevel(e){this._maximumLevel=e}get experience(){return this._experience}set experience(e){this._experience=e}get levelExperienceGoal(){return this._levelExperienceGoal}set levelExperienceGoal(e){this._levelExperienceGoal=e}get energy(){return this._energy}set energy(e){this._energy=e}get maximumEnergy(){return this._maximumEnergy}set maximumEnergy(e){this._maximumEnergy=e}get happyness(){return this._happyness}set happyness(e){this._happyness=e}get maximumHappyness(){return this._maximumHappyness}set maximumHappyness(e){this._maximumHappyness=e}get ownerId(){return this._ownerId}set ownerId(e){this._ownerId=e}get ownerName(){return this._ownerName}set ownerName(e){this._ownerName=e}get respect(){return this._respect}set respect(e){this._respect=e}get age(){return this._age}set age(e){this._age=e}get unknownRarity(){return this._unknownRarity}set unknownRarity(e){this._unknownRarity=e}get saddle(){return this._saddle}set saddle(e){this._saddle=e}get rider(){return this._rider}set rider(e){this._rider=e}get skillTresholds(){return this._skillThresholds}set skillTresholds(e){this._skillThresholds=e}get publiclyRideable(){return this._publiclyRideable}set publiclyRideable(e){this._publiclyRideable=e}get breedable(){return this._breedable}set breedable(e){this._breedable=e}get fullyGrown(){return this._fullyGrown}set fullyGrown(e){this._fullyGrown=e}get dead(){return this._dead}set dead(e){this._dead=e}get rarityLevel(){return this._rarityLevel}set rarityLevel(e){this._rarityLevel=e}get maximumTimeToLive(){return this._maximumTimeToLive}set maximumTimeToLive(e){this._maximumTimeToLive=e}get remainingTimeToLive(){return this._remainingTimeToLive}set remainingTimeToLive(e){this._remainingTimeToLive=e}get remainingGrowTime(){return this._remainingGrowTime}set remainingGrowTime(e){this._remainingGrowTime=e}get publiclyBreedable(){return this._publiclyBreedable}set publiclyBreedable(e){this._publiclyBreedable=e}get adultLevel(){return this._adultLevel}}class NG{constructor(e){this._roomIndex=-1,this._name="",this._nick="",this._coloredName="",this._type=0,this._sex="",this._figure="",this._custom="",this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._ownerId=0,this._ownerName="",this._petLevel=0,this._rarityLevel=0,this._roomIndex=e}get roomIndex(){return this._roomIndex}get activityPoints(){return this._activityPoints}set activityPoints(e){this._activityPoints=e}get name(){return this._name}set name(e){this._name=e}get nick(){return this._nick}set nick(e){this._nick=e}get coloredName(){return this._coloredName}set coloredName(e){this._coloredName=e}get type(){return this._type}set type(e){this._type=e}get sex(){return this._sex}set sex(e){this._sex=e}get figure(){return this._figure}set figure(e){this._figure=e}get custom(){return this._custom}set custom(e){this._custom=e}get webID(){return this._webID}set webID(e){this._webID=e}get groupId(){return this._groupID}set groupId(e){this._groupID=e}get groupName(){return this._groupName}set groupName(e){this._groupName=e}get groupStatus(){return this._groupStatus}set groupStatus(e){this._groupStatus=e}get ownerId(){return this._ownerId}set ownerId(e){this._ownerId=e}get ownerName(){return this._ownerName}set ownerName(e){this._ownerName=e}get rarityLevel(){return this._rarityLevel}set rarityLevel(e){this._rarityLevel=e}get hasSaddle(){return this._hasSaddle}set hasSaddle(e){this._hasSaddle=e}get isRiding(){return this._isRiding}set isRiding(e){this._isRiding=e}get canBreed(){return this._canBreed}set canBreed(e){this._canBreed=e}get canHarvest(){return this._canHarvest}set canHarvest(e){this._canHarvest=e}get canRevive(){return this._canRevive}set canRevive(e){this._canRevive=e}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(e){this._hasBreedingPermission=e}get petLevel(){return this._petLevel}set petLevel(e){this._petLevel=e}get botSkills(){return this._botSkills}set botSkills(e){this._botSkills=e}get isModerator(){return this._isModerator}set isModerator(e){this._isModerator=e}}class wee extends pa{constructor(e,t){super(e,t),e.addMessageEvent(new ap(this.onRoomUnitEvent.bind(this))),e.addMessageEvent(new op(this.onRoomUnitInfoEvent.bind(this))),e.addMessageEvent(new lp(this.onRoomUnitRemoveEvent.bind(this))),e.addMessageEvent(new np(this.onRoomUnitDanceEvent.bind(this))),e.addMessageEvent(new wC(this.onUserCurrentBadgesEvent.bind(this))),e.addMessageEvent(new bC(this.onRoomDoorbellEvent.bind(this))),e.addMessageEvent(new cT(this.onUserNameChangeMessageEvent.bind(this))),e.addMessageEvent(new EC(this.onNewFriendRequestEvent.bind(this))),e.addMessageEvent(new Xj(this.onPetInfoEvent.bind(this))),e.addMessageEvent(new $j(this.onPetStatusUpdateEvent.bind(this))),e.addMessageEvent(new R9(this.onPetBreedingMessageEvent.bind(this))),e.addMessageEvent(new hj(this.onPetLevelUpdateMessageEvent.bind(this))),e.addMessageEvent(new qq(this.onConfirmBreedingResultEvent.bind(this))),e.addMessageEvent(new Xq(this.onNestBreedingSuccessEvent.bind(this))),e.addMessageEvent(new Kq(this.onConfirmBreedingRequestEvent.bind(this))),e.addMessageEvent(new sp(this.onPetFigureUpdateEvent.bind(this))),e.addMessageEvent(new Kj(this.onPetBreedingResultEvent.bind(this))),e.addMessageEvent(new nj(this.onPetPlacingError.bind(this))),e.addMessageEvent(new J0(this.onBotError.bind(this))),e.addMessageEvent(new Mj(this.onFavoriteMembershipUpdateMessageEvent.bind(this)))}onRoomUnitEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser().users,r=[];if(i&&i.length)for(const n of i){if(!n)continue;const o=new NG(n.roomIndex);o.name=n.name,o.nick=n.nick,o.coloredName=n.coloredName,o.custom=n.custom,o.activityPoints=n.activityPoints,o.figure=n.figure,o.type=n.userType,o.webID=n.webID,o.groupId=n.groupID,o.groupName=n.groupName,o.groupStatus=n.groupStatus,o.sex=n.sex,o.ownerId=n.ownerId,o.ownerName=n.ownerName,o.rarityLevel=n.rarityLevel,o.hasSaddle=n.hasSaddle,o.isRiding=n.isRiding,o.canBreed=n.canBreed,o.canHarvest=n.canHarvest,o.canRevive=n.canRevive,o.hasBreedingPermission=n.hasBreedingPermission,o.petLevel=n.petLevel,o.botSkills=n.botSkills,o.isModerator=n.isModerator,t.userDataManager.getUserData(n.roomIndex)||r.push(o),t.userDataManager.updateUserData(o)}this.listener.events.dispatchEvent(new yf(t,r))}onRoomUnitInfoEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();i&&(t.userDataManager.updateFigure(i.unitId,i.figure,i.gender,!1,!1),t.userDataManager.updateMotto(i.unitId,i.motto),t.userDataManager.updateAchievementScore(i.unitId,i.achievementScore),this.listener.events.dispatchEvent(new Df(t,i.unitId,i.figure,i.gender,i.motto,i.achievementScore)))}onRoomUnitRemoveEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);t&&t.userDataManager.removeUserData(e.getParser().unitId)}onRoomUnitDanceEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new xf(i,t.unitId,t.danceId))}onUserCurrentBadgesEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&(i.userDataManager.setUserBadges(t.userId,t.badges),this.listener.events.dispatchEvent(new vf(i,t.userId,t.badges)))}onRoomDoorbellEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=t.userName;if(!i||!i.length)return;const r=this.listener.getSession(this.roomId);r&&this.listener.events.dispatchEvent(new Ga(Ga.DOORBELL,r,i))}onUserNameChangeMessageEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&i.userDataManager.updateName(t.id,t.newName,t.nickname,t.coloredName)}onNewFriendRequestEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);if(!i)return;const r=t.request;this.listener.events.dispatchEvent(new VS(i,r.requestId,r.requesterUserId,r.requesterName))}onPetInfoEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);if(!i)return;const r=new Uee;r.id=t.id,r.level=t.level,r.maximumLevel=t.maximumLevel,r.experience=t.experience,r.levelExperienceGoal=t.levelExperienceGoal,r.energy=t.energy,r.maximumEnergy=t.maximumEnergy,r.happyness=t.happyness,r.maximumHappyness=t.maximumHappyness,r.ownerId=t.ownerId,r.ownerName=t.ownerName,r.respect=t.respect,r.age=t.age,r.unknownRarity=t.unknownRarity,r.saddle=t.saddle,r.rider=t.rider,r.breedable=t.breedable,r.fullyGrown=t.fullyGrown,r.rarityLevel=t.rarityLevel,r.dead=t.dead,r.skillTresholds=t.skillTresholds,r.publiclyRideable=t.publiclyRideable,r.maximumTimeToLive=t.maximumTimeToLive,r.remainingTimeToLive=t.remainingTimeToLive,r.remainingGrowTime=t.remainingGrowTime,r.publiclyBreedable=t.publiclyBreedable,this.listener.events.dispatchEvent(new Cf(i,r))}onPetStatusUpdateEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&(i.userDataManager.updatePetBreedingStatus(t.roomIndex,t.canBreed,t.canHarvest,t.canRevive,t.hasBreedingPermission),this.listener.events.dispatchEvent(new Nf(i,t.petId,t.canBreed,t.canHarvest,t.canRevive,t.hasBreedingPermission)))}onPetBreedingMessageEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new WS(i,t.state,t.ownPetId,t.otherPetId))}onPetLevelUpdateMessageEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&(i.userDataManager.updatePetLevel(t.roomIndex,t.level),this.listener.events.dispatchEvent(new KS(i,t.petId,t.level)))}onConfirmBreedingResultEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new BS(i,t.breedingNestStuffId,t.result))}onNestBreedingSuccessEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new HS(i,t.petId,t.rarityCategory))}onConfirmBreedingRequestEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new GS(i,t.nestId,t.pet1,t.pet2,t.rarityCategories,t.resultPetType))}onPetFigureUpdateEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);if(!i)return;const r=t.figureData.figuredata;i.userDataManager.updateFigure(t.roomIndex,r,"",t.hasSaddle,t.isRiding),this.listener.events.dispatchEvent(new zS(i,t.petId,r))}onPetBreedingResultEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new YS(i,t.resultData,t.otherResultData))}onPetPlacingError(e){if(!e||!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);if(!i)return;let r=null;switch(t.errorCode){case 0:r=Pt.RSEME_PETS_FORBIDDEN_IN_HOTEL;break;case 1:r=Pt.RSEME_PETS_FORBIDDEN_IN_FLAT;break;case 2:r=Pt.RSEME_MAX_PETS;break;case 3:r=Pt.RSEME_NO_FREE_TILES_FOR_PET;break;case 4:r=Pt.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET;break;case 5:r=Pt.RSEME_MAX_NUMBER_OF_OWN_PETS;break}!r||r.length==0||this.listener.events.dispatchEvent(new Pt(r,i))}onBotError(e){if(!e||!this.listener)return;const t=e.getParser();if(!t)return;const i=this.listener.getSession(this.roomId);if(!i)return;let r=null;switch(t.errorCode){case 0:r=Pt.RSEME_BOTS_FORBIDDEN_IN_HOTEL;break;case 1:r=Pt.RSEME_BOTS_FORBIDDEN_IN_FLAT;break;case 2:r=Pt.RSEME_BOT_LIMIT_REACHED;break;case 3:r=Pt.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT;break;case 4:r=Pt.RSEME_BOT_NAME_NOT_ACCEPTED;break}!r||r.length==0||this.listener.events.dispatchEvent(new Pt(r,i))}onFavoriteMembershipUpdateMessageEvent(e){if(!this.listener)return;const t=e.getParser(),i=this.listener.getSession(this.roomId);if(!i)return;const r=i.userDataManager.getUserDataByIndex(t.roomIndex);r&&(r.groupId=t.groupId,r.groupName=t.groupName,this.listener.events.dispatchEvent(new Of(i,t.roomIndex,t.groupId,t.status,t.groupName)))}}class Fee extends pa{constructor(e,t){super(e,t),e.addMessageEvent(new Ej(this.onQuestionEvent.bind(this))),e.addMessageEvent(new pj(this.onQuestionAnsweredEvent.bind(this))),e.addMessageEvent(new Ij(this.onQuestionFinishedEvent.bind(this)))}onQuestionEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();if(!i)return;const r=new Pa(Pa.QUESTION,t,i.pollId);r.question=i.question,r.duration=i.duration,r.pollType=i.pollType,r.questionId=i.questionId,r.pollId=i.pollId,this.listener.events.dispatchEvent(r)}onQuestionAnsweredEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();if(!i)return;const r=new Pa(Pa.ANSWERED,t,i.userId);r.value=i.value,r.userId=i.userId,r.answerCounts=i.answerCounts,this.listener.events.dispatchEvent(r)}onQuestionFinishedEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const i=e.getParser();if(!i)return;const r=new Pa(Pa.FINISHED,t);r.questionId=i.questionId,r.answerCounts=i.answerCounts,this.listener.events.dispatchEvent(r)}}class kee extends pa{constructor(e,t){super(e,t),e.addMessageEvent(new NL(this.onPlaySoundEffect.bind(this))),e.addMessageEvent(new CL(this.onPlayMusic.bind(this))),e.addMessageEvent(new bL(this.onStopAllWiredSounds.bind(this)))}onPlaySoundEffect(e){if(!e)return;const t=e.getParser();t&&De.instance.events.dispatchEvent(new Ws(Ws.PLAY_SOUND_EFFECT,t.soundName,t.volume/100))}onPlayMusic(e){if(!e)return;const t=e.getParser();t&&De.instance.events.dispatchEvent(new Ws(Ws.PLAY_MUSIC,t.soundName,t.volume/100,t.loop))}onStopAllWiredSounds(e){e&&De.instance.events.dispatchEvent(new Ws(Ws.STOP_ALL_WIRED_SOUNDS,null,0,!1))}}class Gee{constructor(e){this._sessionDataManager=e,this._ignoredUsers=[]}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new FL(this.onIgnoredUsersEvent.bind(this)),new GC(this.onIgnoreResultEvent.bind(this))];for(const e of this._messages)this._sessionDataManager.communication.registerMessageEvent(e)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const e of this._messages)this._sessionDataManager.communication.removeMessageEvent(e);this._messages=null}this._sessionDataManager=null}}requestIgnoredUsers(){this._sessionDataManager.send(new RF(this._sessionDataManager.userName))}onIgnoredUsersEvent(e){if(!e)return;const t=e.getParser();t&&(this._ignoredUsers=t.ignoredUsers)}onIgnoreResultEvent(e){if(!e)return;const t=e.getParser();if(t)for(const i of t.ids)switch(t.result){case 0:break;case 1:this.addUserToIgnoreList(i.toString());break;case 2:this.addUserToIgnoreList(i.toString()),this._ignoredUsers.shift();break;case 3:this.removeUserFromIgnoreList(i.toString());break}}addUserToIgnoreList(e){this._ignoredUsers.includes(e)||this._ignoredUsers.push(e)}removeUserFromIgnoreList(e){const t=this._ignoredUsers.indexOf(e);t>=0&&this._ignoredUsers.splice(t,1)}ignoreUserId(e){this._sessionDataManager.send(new OF(e))}ignoreUser(e){this._sessionDataManager.send(new xF(e))}unignoreUser(e){this._sessionDataManager.send(new CF(e))}isIgnored(e){return this._ignoredUsers.indexOf(e.toString())>=0}get disposed(){return!!this._sessionDataManager}}class Bee{constructor(e,t,i){this._type=e,this._name=t,this._description=i}get type(){return this._type}get name(){return this._name}get description(){return this._description}}const dd=class dd extends Sn{constructor(e){super(),this._products=e}dispose(){this._products=null}loadProductData(e){e&&fetch(e).then(t=>t.json()).then(t=>this.onProductDataLoadedEvent(t)).catch(t=>this.onProductDataError(t))}onProductDataLoadedEvent(e){e&&(this.parseProducts(e.productdata),this.dispatchEvent(new _t(dd.PDP_PRODUCT_DATA_READY)))}onProductDataError(e){e&&this.dispatchEvent(new _t(dd.PDP_PRODUCT_DATA_FAILED))}parseProducts(e){if(e)for(const t of e.product)t&&this._products.set(t.code,new Bee(t.code,t.name,t.description))}};dd.PDP_PRODUCT_DATA_READY="PDP_PRODUCT_DATA_READY",dd.PDP_PRODUCT_DATA_FAILED="PDP_PRODUCT_DATA_FAILED";let m_=dd;const So=class So extends Qr{constructor(){super(),this._connection=null,this._userDataByType=new Map,this._userDataByRoomIndex=new Map,this._userBadges=new Map}onDispose(){this._connection=null}setConnection(e){this._connection=e}getUserData(e){return this.getDataByType(e,So.TYPE_USER)}getPetData(e){return this.getDataByType(e,So.TYPE_PET)}getBotData(e){return this.getDataByType(e,So.TYPE_BOT)}getRentableBotData(e){return this.getDataByType(e,So.TYPE_RENTABLE_BOT)}getDataByType(e,t){const i=this._userDataByType.get(t);if(!i)return null;const r=i.get(e);return r||null}getUserDataByIndex(e){const t=this._userDataByRoomIndex.get(e);return t||null}getUserDataByName(e){for(const t of this._userDataByRoomIndex.values())if(!(!t||t.name!==e))return t;return null}updateUserData(e){if(!e)return;this.removeUserData(e.roomIndex);let t=this._userDataByType.get(e.type);t||(t=new Map,this._userDataByType.set(e.type,t)),t.set(e.webID,e),this._userDataByRoomIndex.set(e.roomIndex,e)}removeUserData(e){const t=this.getUserDataByIndex(e);if(!t)return;this._userDataByRoomIndex.delete(e);const i=this._userDataByType.get(t.type);i&&i.delete(t.webID)}getUserBadges(e){this._connection&&this._connection.send(new _N(e));const t=this._userBadges.get(e);return t||[]}setUserBadges(e,t){this._userBadges.set(e,t)}updateFigure(e,t,i,r,n){const o=this.getUserDataByIndex(e);o&&(o.figure=t,o.sex=i,o.hasSaddle=r,o.isRiding=n)}updateName(e,t,i,r){const n=this.getUserDataByIndex(e);n&&(n.name=t,n.nick=i,n.coloredName=r)}updateMotto(e,t){const i=this.getUserDataByIndex(e);i&&(i.custom=t)}updateAchievementScore(e,t){const i=this.getUserDataByIndex(e);i&&(i.activityPoints=t)}updatePetLevel(e,t){const i=this.getUserDataByIndex(e);i&&(i.petLevel=t)}updatePetBreedingStatus(e,t,i,r,n){const o=this.getUserDataByIndex(e);o&&(o.canBreed=t,o.canHarvest=i,o.canRevive=r,o.hasBreedingPermission=n)}requestPetInfo(e){!this._connection||!this.getPetData(e)||this._connection.send(new N1(e))}get connection(){return this._connection}};So.TYPE_USER=1,So.TYPE_PET=2,So.TYPE_BOT=3,So.TYPE_RENTABLE_BOT=4;let BO=So;class Vee extends Qr{constructor(){super(),this._roomZoomActive=Kg(tr.ROOM_ZOOM)??!0,this._connection=null,this._userData=new BO,this._roomId=0,this._password=null,this._state=Ve.CREATED,this._tradeMode=pd.NO_TRADING,this._doorMode=0,this._controllerLevel=pt.NONE,this._ownRoomIndex=-1,this._isGuildRoom=!1,this._isRoomOwner=!1,this._isDecorating=!1,this._isSpectator=!1,this._canEditAds=!1,this._bellMode=1,this._moderationSettings=null}onDispose(){this._userData&&(this._userData.dispose(),this._userData=null),this._connection=null}setConnection(e){this._connection||!e||(this._connection=e,this._userData&&this._userData.setConnection(e))}setControllerLevel(e){if(e>=pt.NONE&&e<=pt.MODERATOR){this._controllerLevel=e;return}this._controllerLevel=pt.NONE}setCanEditAds(e){this._canEditAds=e}setOwnRoomIndex(e){this._ownRoomIndex=e}setRoomOwner(){this._isRoomOwner=!0}start(){return this._state!==Ve.CREATED||!this._connection?!1:(this._state=Ve.STARTED,this.enterRoom())}enterRoom(){return this._connection?(this._connection.send(new gT(this._roomId,this._password,this._bellMode)),!0):!1}reset(e){e!==this._roomId&&(this._roomId=e)}sendChatMessage(e,t){this._connection.send(new uN(e,t))}sendShoutMessage(e,t){this._connection.send(new Lw(e,t))}sendWhisperMessage(e,t,i){this._connection.send(new Uw(e,t,i))}sendChatTypingMessage(e){e?this._connection.send(new ww):this._connection.send(new Fw)}sendMottoMessage(e){this._connection.send(new NF(e))}sendDanceMessage(e){this._connection.send(new Gw(e))}sendExpressionMessage(e){this._connection.send(new kw(e))}sendSignMessage(e){e<0||e>17||this._connection.send(new Ww(e))}sendPostureMessage(e){this._connection.send(new Hw(e))}sendDoorbellApprovalMessage(e,t){this._connection.send(new F1(e,t))}sendAmbassadorAlertMessage(e){this._connection.send(new G1(e))}sendKickMessage(e){this._connection.send(new H1(e))}sendMuteMessage(e,t){this._connection.send(new W1(e,t,this._roomId))}sendBanMessage(e,t){this._connection.send(new B1(e,this._roomId,t))}sendGiveRightsMessage(e){this._connection.send(new rN(e))}sendTakeRightsMessage(e){this._connection.send(new nN(e))}sendTakeOwnRights(e){this._connection.send(new sN(e))}sendPollStartMessage(e){this._connection.send(new M1(e))}sendPollRejectMessage(e){this._connection.send(new D1(e))}sendPollAnswerMessage(e,t,i){this._connection.send(new y1(e,t,i))}sendPeerUsersClassificationMessage(e){this._connection.send(new kF(e))}sendOpenPetPackageMessage(e,t){this._connection.send(new lN(e,t))}sendRoomUsersClassificationMessage(e){this._connection.send(new GF(e))}updateMoodlightData(e,t,i,r,n){let o="000000"+i.toString(16).toUpperCase();o="#"+o.substring(o.length-6),this.connection.send(new lw(e,t,o,r,n))}toggleMoodlightState(){this.connection.send(new cw)}pickupPet(e){this._connection&&this._connection.send(new sw(e))}pickupBot(e){this._connection&&this._connection.send(new fT(e))}requestMoodlightSettings(){this._connection&&this._connection.send(new ow)}openGift(e){this._connection.send(new xw(e))}mountPet(e){this._connection.send(new xx(e,!0))}requestBreedPet(e){if(!(this._roomId>0)||!(e>0))return;ce().events.dispatchEvent(new Ie(Ie.REQUEST_MONSTERPLANT_SELECT_REPRODUCE,this._roomId,e,Q.UNIT))}getBreedMenuForPets(e,t,i,r,n){const o=ce();var l=null,c=0,u=null,d=[],_=[],m=o.getRoomObjectCount(e,Q.UNIT);for(c=0;c<m;)l=o.getRoomObjectByIndex(e,c,Q.UNIT),(u=this.userDataManager.getUserDataByIndex(l.id))==null||u.type!=Xt.PET||(l.logic.useObject(),u.canBreed&&(!u.hasBreedingPermission&&u.ownerId!=n||this.userDataManager.getUserData(u.ownerId)!=null&&parseInt((d=u.figure.split(" ")).length>0?d[0]:-1)==i&&u.roomIndex!=r&&_.push(new jk(u.roomIndex,Q.UNIT,u.name,r,l.id,-1,!1)))),c++;return _}dismountPet(e){this._connection.send(new xx(e,!1))}usePetProduct(e,t){this._connection.send(new v1(e,t))}removePetSaddle(e){this._connection.send(new C1(e))}togglePetBreeding(e){this._connection.send(new A1(e))}togglePetRiding(e){this._connection.send(new b1(e))}useMultistateItem(e){this._connection.send(new ko(e))}harvestPet(e){this._connection.send(new ew(e))}compostPlant(e){this._connection.send(new J1(e))}requestPetCommands(e){this._connection.send(new O1(e))}sendScriptProceed(){this._connection.send(new x1)}sendUpdateClothingChangeFurniture(e,t,i){this._connection.send(new rw(e,t,i))}changeQueue(e){this._connection.send(new Mw(e))}votePoll(e){this._connection.send(new j1(e))}get connection(){return this._connection}get userDataManager(){return this._userData}get roomId(){return this._roomId}set roomId(e){this._roomId=e}get password(){return this._password}set password(e){this._password=e}get bellMode(){return this._bellMode}set bellMode(e){this._bellMode=e}get state(){return this._state}get isPrivateRoom(){return!0}get tradeMode(){return this._tradeMode}set tradeMode(e){this._tradeMode=e}get doorMode(){return this._doorMode}set doorMode(e){this._doorMode=e}get allowPets(){return this._allowPets}set allowPets(e){this._allowPets=e}get controllerLevel(){return this._controllerLevel}get canEditAds(){return this._canEditAds}get roomZoomActive(){return this._roomZoomActive}set roomZoomActive(e){this._roomZoomActive=e}get playTestMode(){return this._playTestMode}set playTestMode(e){this._playTestMode=e}get ownRoomIndex(){return this._ownRoomIndex}get isGuildRoom(){return this._isGuildRoom}set isGuildRoom(e){this._isGuildRoom=e}get isRoomOwner(){return this._isRoomOwner}get isDecorating(){return this._isDecorating}set isDecorating(e){this._isDecorating=e}get isSpectator(){return this._isSpectator}set isSpectator(e){this._isSpectator=e}get moderationSettings(){return this._moderationSettings}set moderationSettings(e){this._moderationSettings=e}}class Hee extends Wo{constructor(e,t){super(),this._communication=e,this._roomEngine=t,this._handlers=[],this._sessions=new Map,this._pendingSession=null,this._sessionStarting=!1,this._viewerSession=null,this.onRoomEngineEvent=this.onRoomEngineEvent.bind(this)}onInit(){this.createHandlers(),this.processPendingSession(),this._roomEngine.events.addEventListener(Ot.ENGINE_INITIALIZED,this.onRoomEngineEvent)}onDispose(){this._roomEngine.events.removeEventListener(Ot.ENGINE_INITIALIZED,this.onRoomEngineEvent),super.onDispose()}createHandlers(){const e=this._communication&&this._communication.connection;e&&this._handlers.push(new Dee(e,this),new Mee(e,this),new jee(e,this),new Lee(e,this),new Ah(e,this),new wee(e,this),new Pee(e,this),new bee(e,this),new Fee(e,this),new yee(e,this),new vee(e,this),new kee(e,this))}setHandlers(e){if(!(!this._handlers||!this._handlers.length))for(const t of this._handlers)t&&t.setRoomId(e.roomId)}onRoomEngineEvent(e){this.processPendingSession()}processPendingSession(){!this._pendingSession||!this._roomEngine.ready||(this.addSession(this._pendingSession),this._pendingSession=null)}getSession(e){const t=this._sessions.get(this.getRoomId(e));return t||null}createSession(e,t=null,i=1){const r=new Vee;return r.roomId=e,r.password=t,r.bellMode=i,this.addSession(r)}addSession(e){return this._roomEngine.ready?(this._sessionStarting=!0,this._sessions.get(this.getRoomId(e.roomId))&&this.removeSession(e.roomId,!1),e.setConnection(this._communication.connection),this._sessions.set(this.getRoomId(e.roomId),e),this.events.dispatchEvent(new Ve(Ve.CREATED,e)),this._viewerSession=e,this.startSession(this._viewerSession),!0):(this._pendingSession=e,!1)}startSession(e){return e.state===Ve.STARTED?!1:(this._sessionStarting=!1,e.start()?(this.events.dispatchEvent(new Ve(Ve.STARTED,e)),this.setHandlers(e),!0):(console.log("Remove session from startSession()"),this.removeSession(e.roomId),!1))}removeSession(e,t=!0){const i=this.getSession(e);i&&(this._sessions.delete(this.getRoomId(e)),this.events.dispatchEvent(new Ve(Ve.ENDED,i,t)),i.dispose())}sessionUpdate(e,t){if(this.getSession(e))switch(t){case Ah.RS_CONNECTED:return;case Ah.RS_READY:return;case Ah.RS_DISCONNECTED:this.removeSession(e);return}}sessionReinitialize(e,t){const i=this.getSession(e);i&&(this._sessions.delete(this.getRoomId(e)),i.reset(t),this._sessions.set(this.getRoomId(t),i),this.setHandlers(i))}getRoomId(e){return"hard_coded_room_id"}get communication(){return this._communication}get roomEngine(){return this._roomEngine}get viewerSession(){return this._viewerSession}}const _d=class _d{static logEventLog(e){try{Me.available&&Me.call("logEventLog",e)}catch{ze.log("External interface not working, failed to log event log.")}}static openPage(e){try{Me.available&&Me.call("openPage",e)}catch{ze.log("Failed to open web page",e)}}static openWebPage(e){window.open(e)}static sendHeartBeat(){try{Me.available&&Me.call("heartBeat")}catch{ze.log("Failed to send heartbeat")}}static openWebPageAndMinimizeClient(e){try{Me.available&&_d.openPage(e)}catch{ze.log("Failed to open web page",e)}}static closeWebPageAndRestoreClient(){try{Me.available&&Me.call("closeWebPageAndRestoreClient")}catch{ze.log("Failed to close web page and restore client!")}}static openHabblet(e,t=null){try{Me.available&&Me.call("openHabblet",e,t)}catch{ze.log("Failed to open Habblet",e)}}static closeHabblet(e,t=null){try{Me.available&&Me.call("closeHabblet",e,t)}catch{ze.log("Failed to close Habblet",e)}}static send(e,t){try{Me.available&&Me.call("disconnect",e,t)}catch{ze.log("Failed to close send ")}}static showGame(e){try{Me.available&&Me.callGame("showGame",e)}catch(t){ze.log("Failed to open game",t)}}static hideGame(){try{Me.available&&Me.callGame("hideGame")}catch{ze.log("Failed to hide game")}}static open(e){try{Me.available&&Me.call("openExternalLink",escape(e))}catch{ze.log("External interface not working. Could not request to open: "+e)}}static roomVisited(e){try{Me.available&&Me.call("roomVisited",e)}catch{ze.log("External interface not working. Could not store last room visit.")}}static openMinimail(e){try{Me.available&&Me.call("openMinimail",e)}catch{ze.log("External interface not working. Could not open minimail.")}}static openNews(){try{Me.available&&Me.call("openNews")}catch{ze.log("External interface not working. Could not open news.")}}static closeNews(){try{Me.available&&Me.call("closeNews")}catch{ze.log("External interface not working. Could not close news.")}}static openAvatars(){try{Me.available&&Me.call("openAvatars")}catch{ze.log("External interface not working. Could not open avatars.")}}static openRoomEnterAd(){try{Me.available&&Me.call("openRoomEnterAd")}catch{ze.log("External interface not working. Could not open roomenterad.")}}static updateFigure(e){try{Me.available&&Me.call("updateFigure",e)}catch{ze.log("External interface not working. Could not update figure.")}}};_d.ADVERTISEMENT="advertisement",_d.OPENLINK="openlink",_d.OPENROOM="openroom";let Xa=_d;class Wee extends Wo{constructor(e){super(),this._communication=e,this.resetUserInfo(),this._ignoredUsersManager=new Gee(this),this._groupInformationManager=new Aee(this),this._clubLevel=0,this._securityLevel=0,this._canModTools=!1,this._isAmbassador=!1,this._noobnessLevel=-1,this._isEmailVerified=!1,this._systemOpen=!1,this._systemShutdown=!1,this._isAuthenticHabbo=!1,this._isRoomCameraFollowDisabled=!1,this._uiFlags=0,this._floorItems=new Map,this._wallItems=new Map,this._products=new Map,this._furnitureData=null,this._furnitureReady=!1,this._productsReady=!1,this._furnitureListenersNotified=!1,this._pendingFurnitureListeners=[],this._pendingProductListeners=[],this._tags=[],this._badgeImageManager=null,this.onFurnitureDataReadyEvent=this.onFurnitureDataReadyEvent.bind(this),this.onProductDataReadyEvent=this.onProductDataReadyEvent.bind(this),this.onNitroSettingsEvent=this.onNitroSettingsEvent.bind(this)}get communication(){return this._communication}get userId(){return this._userId}get figure(){return this._figure}get gender(){return this._gender}get realName(){return this._realName}get respectsReceived(){return this._respectsReceived}get respectsLeft(){return this._respectsLeft}get kissesReceived(){return this._kissesReceived}get kissesLeft(){return this._kissesLeft}get respectsPetLeft(){return this._respectsPetLeft}get canChangeName(){return this._canChangeName}get ignoredUsersManager(){return this._ignoredUsersManager}get groupInformationManager(){return this._groupInformationManager}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}get canModTools(){return this._canModTools}get isEmailVerified(){return this._isEmailVerified}get isAuthenticHabbo(){return this._isAuthenticHabbo}get uiFlags(){return this._uiFlags}get tags(){return this._tags}get isDoubleClick(){return this._isDoubleClick}get userName(){return this._name}get isNoob(){return this._noobnessLevel!==u_.OLD_IDENTITY}get isRealNoob(){return this._noobnessLevel===u_.REAL_NOOB}get isSystemOpen(){return this._systemOpen}get isSystemShutdown(){return this._systemShutdown}get isModerator(){return this._securityLevel>=zu.MODERATOR}get isCameraFollowDisabled(){return this._isRoomCameraFollowDisabled}setDoubleClickEnabled(e){this._isDoubleClick=e}hasProductData(e){return this._productsReady?!0:(e&&this._pendingProductListeners.indexOf(e)===-1&&this._pendingProductListeners.push(e),!1)}getAllFurnitureData(e){if(!this._furnitureReady)return this._pendingFurnitureListeners.indexOf(e)===-1&&this._pendingFurnitureListeners.push(e),null;const t=[];for(const i of this._floorItems.values())i&&t.push(i);for(const i of this._wallItems.values())i&&t.push(i);return t}removePendingFurniDataListener(e){if(!this._pendingFurnitureListeners)return;const t=this._pendingFurnitureListeners.indexOf(e);t!==-1&&this._pendingFurnitureListeners.splice(t,1)}getFloorItemData(e){const t=this._floorItems.get(e);return t||null}getFloorItemDataByName(e){if(!e||!this._floorItems||!this._floorItems.size)return null;for(const t of this._floorItems.values())if(!(!t||t.className!==e))return t}getWallItemData(e){const t=this._wallItems.get(e);return t||null}getWallItemDataByName(e){if(!e||!this._wallItems||!this._wallItems.size)return null;for(const t of this._wallItems.values())if(!(!t||t.className!==e))return t}getProductData(e){return this._productsReady||this.loadProductData(),this._products.get(e)}getBadgeUrl(e){return this._badgeImageManager.getBadgeUrl(e)}getGroupBadgeUrl(e){return this._badgeImageManager.getBadgeUrl(e,Nh.GROUP_BADGE)}getBadgeImage(e){return this._badgeImageManager.getBadgeImage(e)}getGroupBadgeImage(e){return this._badgeImageManager.getBadgeImage(e,Nh.GROUP_BADGE)}getUserTags(e){e<0||this.send(new dN(e))}loadBadgeImage(e){return this._badgeImageManager.loadBadgeImage(e)}loadGroupBadgeImage(e){return this._badgeImageManager.loadBadgeImage(e,Nh.GROUP_BADGE)}hasSecurity(e){return this._securityLevel>=e}giveRespect(e){e<0||this._respectsLeft<=0||(this.send(new SF(e)),this._respectsLeft--)}giveKiss(e){e<0||this._kissesLeft<=0||this.send(new TF(e))}giveStarGem(e){e<0||this.send(new EF(e))}setKissesLeft(e){e<0||(this._kissesLeft=e)}givePetRespect(e){e<0||this._respectsPetLeft<=0||(this.send(new gm(e)),this._respectsPetLeft--)}sendSpecialCommandMessage(e,t=0){this.send(new uN(e))}ignoreUser(e){this._ignoredUsersManager&&this._ignoredUsersManager.ignoreUser(e)}unignoreUser(e){this._ignoredUsersManager&&this._ignoredUsersManager.unignoreUser(e)}isUserIgnored(e){return this._ignoredUsersManager&&this._ignoredUsersManager.isIgnored(e)}getGroupBadge(e){return this._groupInformationManager&&this._groupInformationManager.getGroupBadge(e)}isHcMember(){return this._clubLevel>1}send(e){this._communication.connection.send(e)}onInit(){this.loadFurnitureData(),this.loadProductData(),this.loadBadgeImageManager(),this._ignoredUsersManager&&this._ignoredUsersManager.init(),this._groupInformationManager&&this._groupInformationManager.init(),this._communication.registerMessageEvent(new mC(this.onUserFigureEvent.bind(this))),this._communication.registerMessageEvent(new Ld(this.onUserInfoEvent.bind(this))),this._communication.registerMessageEvent(new PC(this.onUserPermissionsEvent.bind(this))),this._communication.registerMessageEvent(new gD(this.onAvailabilityStatusMessageEvent.bind(this))),this._communication.registerMessageEvent(new dj(this.onPetRespectFailed.bind(this))),this._communication.registerMessageEvent(new kg(this.onChangeNameUpdateEvent.bind(this))),this._communication.registerMessageEvent(new cT(this.onUserNameChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new FC(this.onUserTags.bind(this))),this._communication.registerMessageEvent(new jd(this.onRoomModelNameEvent.bind(this))),this._communication.registerMessageEvent(new kL(this.onInClientLinkEvent.bind(this))),this._communication.registerMessageEvent(new w0(this.onMysteryBoxKeysEvent.bind(this))),this._communication.registerMessageEvent(new vM(this.onNoobnessLevelMessageEvent.bind(this))),this._communication.registerMessageEvent(new yL(this.onAccountSafetyLockStatusChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new LL(this.onEmailStatus.bind(this))),this._communication.registerMessageEvent(new HC(this.onSetKissesLeft.bind(this))),De.instance.events.addEventListener(Ic.SETTINGS_UPDATED,this.onNitroSettingsEvent)}onDispose(){this.destroyFurnitureData(),this._ignoredUsersManager&&(this._ignoredUsersManager.dispose(),this._ignoredUsersManager=null),this._groupInformationManager&&(this._groupInformationManager.dispose(),this._groupInformationManager=null),De.instance.events.removeEventListener(Ic.SETTINGS_UPDATED,this.onNitroSettingsEvent),super.onDispose()}resetUserInfo(){this._userId=0,this._name=null,this._figure=null,this._gender=null,this._realName=null,this._canChangeName=!1,this._safetyLocked=!1}loadFurnitureData(){this.destroyFurnitureData(),this._furnitureData=new g_(this._floorItems,this._wallItems,De.instance.localization),this._furnitureData.addEventListener(g_.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureData.loadFurnitureData(st.getValue("furnidata.url"))}loadProductData(){this.destroyProductData(),this._productData=new m_(this._products),this._productData.addEventListener(m_.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productData.loadProductData(st.getValue("productdata.url"))}loadBadgeImageManager(){this._badgeImageManager||(this._badgeImageManager=new Nh(vr(),this),this._badgeImageManager.init())}onUserFigureEvent(e){!e||!e.connection||(this._figure=e.getParser().figure,this._gender=e.getParser().gender,Xa.updateFigure(this._figure))}onUserInfoEvent(e){if(!e||!e.connection)return;this.resetUserInfo();const t=e.getParser().userInfo;t&&(this._userId=t.userId,this._name=t.username,this._figure=t.figure,this._gender=t.gender,this._realName=t.realName,this._respectsReceived=t.respectsReceived,this._respectsLeft=t.respectsRemaining,this._kissesReceived=t.kissesReceived,this._kissesLeft=t.kissesRemaining,this._respectsPetLeft=t.respectsPetRemaining,this._canChangeName=t.canChangeName,this._safetyLocked=t.safetyLocked,this._ignoredUsersManager&&this._ignoredUsersManager.requestIgnoredUsers())}onUserPermissionsEvent(e){!e||!e.connection||(this._clubLevel=e.getParser().clubLevel,this._securityLevel=e.getParser().securityLevel,this._isAmbassador=e.getParser().isAmbassador,this._canModTools=e.getParser().canModTools)}onAvailabilityStatusMessageEvent(e){if(!e||!e.connection)return;const t=e.getParser();t&&(this._systemOpen=t.isOpen,this._systemShutdown=t.onShutdown,this._isAuthenticHabbo=t.isAuthenticUser)}onPetRespectFailed(e){!e||!e.connection||this._respectsPetLeft++}onChangeNameUpdateEvent(e){if(!e||!e.connection)return;const t=e.getParser();t&&t.resultCode===kg.NAME_OK&&(this._canChangeName=!1,this.events.dispatchEvent(new Mf(t.name)))}onUserNameChangeMessageEvent(e){if(!e||!e.connection)return;const t=e.getParser();t&&t.webId===this.userId&&(this._name=t.newName,this._nickname=t.nickname,this._coloredName=t.coloredName,this._canChangeName=!1,this.events.dispatchEvent(new Mf(this._name)))}onUserTags(e){if(!e||!e.connection)return;const t=e.getParser();t&&(this._tags=t.tags)}onRoomModelNameEvent(e){if(!e)return;const t=e.getParser();t&&Xa.roomVisited(t.roomId)}onFurnitureDataReadyEvent(e){if(this._furnitureData.removeEventListener(g_.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureReady=!0,!this._furnitureListenersNotified&&(this._furnitureListenersNotified=!0,this._pendingFurnitureListeners&&this._pendingFurnitureListeners.length))for(const t of this._pendingFurnitureListeners)t&&t.loadFurnitureData();this._pendingProductListeners=[]}onProductDataReadyEvent(e){this._productData.removeEventListener(m_.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productsReady=!0;for(const t of this._pendingProductListeners)t&&t.loadProductData();this._pendingProductListeners=[]}onInClientLinkEvent(e){if(!e)return;const t=e.getParser();t&&De.instance.createLinkEvent(t.link)}onMysteryBoxKeysEvent(e){if(!e)return;const t=e.getParser();t&&this.events.dispatchEvent(new Rf(t.boxColor,t.keyColor))}onNoobnessLevelMessageEvent(e){this._noobnessLevel=e.getParser().noobnessLevel,this._noobnessLevel!==u_.OLD_IDENTITY&&st.setValue("new.identity",1)}onAccountSafetyLockStatusChangeMessageEvent(e){if(!e)return;const t=e.getParser();t&&(this._safetyLocked=t.status==Ff.SAFETY_LOCK_STATUS_LOCKED)}onEmailStatus(e){if(!e)return;const t=e.getParser();t&&(this._isEmailVerified=t.isVerified)}onSetKissesLeft(e){!e||e.getParser()}onNitroSettingsEvent(e){this._isRoomCameraFollowDisabled=e.cameraFollow,this._uiFlags=e.flags,this.events.dispatchEvent(new qS(this._uiFlags))}destroyFurnitureData(){this._furnitureData&&(this._furnitureData.dispose(),this._furnitureData=null)}destroyProductData(){this._productData&&(this._productData.dispose(),this._productData=null)}}class AG extends lT{constructor(e,t,i,r,n=""){super(e,t,i,r),this._jukeboxDiskId=-1,this._songData=n}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get songData(){return this._songData}set songData(e){this._songData=e}get diskId(){return this._jukeboxDiskId}set diskId(e){this._jukeboxDiskId=e}}class Yee{constructor(e,t,i,r,n){this._songId=e,this._startPos=t,this._playLength=i,this._fadeInSeconds=r,this._fadeOutSeconds=n,this._playRequestTime=Date.now()}get songId(){return this._songId}get startPos(){return this._startPos<0?0:this._startPos+(Date.now()-this._playRequestTime)/1e3}get playLength(){return this._playLength}get playRequestTime(){return this._playRequestTime}get fadeInSeconds(){return this._fadeInSeconds}get fadeOutSeconds(){return this._fadeOutSeconds}}const GI=class GI extends _t{constructor(e,t){super(GI.NOTIFY_PLAYED_SONG),this._name=e,this._creator=t}get name(){return this._name}get creator(){return this._creator}};GI.NOTIFY_PLAYED_SONG="UIEW_NOTIFY_PLAYED_SONG";let wp=GI;const Ig=class Ig extends _t{constructor(e,t,i,r){super(e),this._id=i,this._position=r,this._priority=t}get id(){return this._id}get position(){return this._position}get priority(){return this._priority}};Ig.NPE_USER_PLAY_SONG="NPE_USER_PLAY_SONG",Ig.NPW_USER_STOP_SONG="NPW_USER_STOP_SONG",Ig.NPE_SONG_CHANGED="NPE_SONG_CHANGED";let Po=Ig;const BI=class BI extends _t{constructor(e){super(e)}};BI.PLUE_PLAY_LIST_UPDATED="PLUE_PLAY_LIST_UPDATED",BI.PLUE_PLAY_LIST_FULL="PLUE_PLAY_LIST_FULL";let Ao=BI;const vA=class vA extends _t{constructor(e){super(e)}};vA.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT="SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT";let ku=vA;const yA=class yA extends _t{constructor(e,t){super(e),this._id=t}get id(){return this._id}};yA.SIR_TRAX_SONG_INFO_RECEIVED="SIR_TRAX_SONG_INFO_RECEIVED";let sh=yA;const DA=class DA extends _t{constructor(e,t){super(e),this._id=t}get id(){return this._id}};DA.TRAX_SONG_COMPLETE="SME_TRAX_SONG_COMPLETE";let Gd=DA;const Cu=class Cu{};Cu.PRIORITY_ROOM_PLAYLIST=0,Cu.PRIORITY_USER_PLAYLIST=1,Cu.PRIORITY_SONG_PLAY=2,Cu.PRIORITY_PURCHASE_PREVIEW=3,Cu.PRIORITY_COUNT=4;let Ji=Cu;class zee{constructor(){this._isPlaying=!1,this._disposed=!1,this._entries=[],this._missingSongInfo=[],this._messageEvents=[new SL(this.onNowPlayingMessageEvent.bind(this)),new TL(this.onJukeboxSongDisksMessageEvent.bind(this)),new IL(this.onJukeboxPlayListFullMessageEvent.bind(this))],this.onSongInfoReceivedEvent=this.onSongInfoReceivedEvent.bind(this)}init(){this._messageEvents.forEach(e=>De.instance.communication.connection.addMessageEvent(e)),De.instance.soundManager.events.addEventListener(sh.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent)}get priority(){return Ji.PRIORITY_ROOM_PLAYLIST}onNowPlayingMessageEvent(e){const t=e.getParser();this._isPlaying=t.currentSongId!==-1,t.currentSongId>=0?(De.instance.soundManager.musicController.playSong(t.currentSongId,Ji.PRIORITY_ROOM_PLAYLIST,t.syncCount/1e3,0,1,1),this._currentEntryId=t.currentSongId):this.stopPlaying(),t.nextSongId>=0&&De.instance.soundManager.musicController.addSongInfoRequest(t.nextSongId),this._playPosition=t.currentPosition,De.instance.soundManager.events.dispatchEvent(new Po(Po.NPE_SONG_CHANGED,Ji.PRIORITY_ROOM_PLAYLIST,t.currentSongId,t.currentPosition))}onJukeboxSongDisksMessageEvent(e){const t=e.getParser();this._entries=[];for(let i=0;i<t.songDisks.length;i++){const r=t.songDisks.getWithIndex(i),n=t.songDisks.getKey(i);let o=De.instance.soundManager.musicController.getSongInfo(r);o==null&&(o=new AG(r,-1,null,null,null),this._missingSongInfo.indexOf(r)<0&&(this._missingSongInfo.push(r),De.instance.soundManager.musicController.requestSongInfoWithoutSamples(r))),o.diskId=n,this._entries.push(o)}this._missingSongInfo.length==0&&De.instance.soundManager.events.dispatchEvent(new Ao(Ao.PLUE_PLAY_LIST_UPDATED))}onJukeboxPlayListFullMessageEvent(e){De.instance.soundManager.events.dispatchEvent(new Ao(Ao.PLUE_PLAY_LIST_FULL))}onSongInfoReceivedEvent(e){for(let i=0;i<this.length;i++){const r=this._entries[i];if(r.id===e.id){const n=r.diskId,o=De.instance.soundManager.musicController.getSongInfo(e.id);o!=null&&(o.diskId=n,this._entries[i]=o);break}}const t=this._missingSongInfo.indexOf(e.id);t>=0&&this._missingSongInfo.splice(t,1),this._missingSongInfo.length==0&&De.instance.soundManager.events.dispatchEvent(new Ao(Ao.PLUE_PLAY_LIST_UPDATED))}stopPlaying(){De.instance.soundManager.musicController.stop(this.priority),this._currentEntryId=-1,this._playPosition=-1,this._isPlaying=!1}get length(){return this._entries?this._entries.length:0}get playPosition(){return this._playPosition}get nowPlayingSongId(){return this._currentEntryId}get isPlaying(){return this._isPlaying}get entries(){return this._entries}getEntry(e){return e<0||e>=this._entries.length?null:this._entries[e]}requestPlayList(){De.instance.communication.connection.send(new lF)}dispose(){this._disposed||(this._disposed=!0,this.stopPlaying(),De.instance.soundManager.events&&De.instance.soundManager.events.removeEventListener(sh.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent),this._messageEvents.forEach(e=>De.instance.communication.connection.removeMessageEvent(e)),this._messageEvents=null)}}class Kee{constructor(e){this._id=e,this._items=[]}addChannelItem(e){this._items.push(e)}get items(){return this._items}}class qee{constructor(e,t){this._id=e,this._length=t}get id(){return this._id}get length(){return this._length}}class VO{constructor(e){this._channels=[],this._metaData=new Map;let t=[];const i=e.split(":"),r=i[i.length-1];if(r.indexOf("meta")>-1){const n=r.split(";");for(const o of n){const l=o.split(",");this._metaData.set(l[0],l[1])}t=i.slice(0,i.length-1)}else t=i;for(let n=0;n<t.length/2;n++)if(t[n*2].length>0){const o=parseInt(t[n*2]),l=t[n*2+1].split(";"),c=new Kee(o);for(const u of l){const d=u.split(",");if(d.length!==2)return;c.addChannelItem(new qee(parseInt(d[0]),parseInt(d[1])))}this._channels.push(c)}}get channels(){return this._channels}getSampleIds(){const e=[];for(const t of this._channels)for(const i of t.items)e.indexOf(i.id)===-1&&e.push(i.id);return e}get hasMetaData(){return this._metaData.has("meta")}get metaCutMode(){return this._metaData.has("c")}get metaTempo(){const e=this._metaData.get("t");return e?parseInt(e):null}}class Xee{constructor(e){this._sampleUrl=e,this._isPlaying=!1,this._startPos=0,this._currentPos=0,this._playLength=0,this._sequence=[],this._cache=new Map}async play(e,t,i=0,r=-1){this.reset(),this._currentSong=new VO(e),this._startPos=Math.trunc(i),this._playLength=r,this._currentPos=this._startPos,this._currentSongId=t,await this.preload(),this._isPlaying=!0,this.tick(),this._tickerInterval=window.setInterval(()=>this.tick(),1e3)}reset(){this._isPlaying=!1,window.clearInterval(this._tickerInterval),hh.Howler.stop(),this._currentSongId=-1,this._currentSong=void 0,this._tickerInterval=void 0,this._startPos=0,this._playLength=0,this._sequence=[],this._currentPos=0}pause(){this._isPlaying=!1,hh.Howler.stop()}resume(){this._isPlaying=!0}stop(){const e=this._currentSongId;this.reset(),De.instance.soundManager.events.dispatchEvent(new Gd(Gd.TRAX_SONG_COMPLETE,e))}setVolume(e){hh.Howler.volume(e)}getVolume(){return hh.Howler.volume()}async getSample(e){let t=this._cache.get(e);return t||(t=await this.loadSong(e)),Promise.resolve(t)}async preload(){if(this._sequence=[],!!this._currentSong){for(const e of this._currentSong.channels){const t=[];for(const i of e.items){const r=await this.getSample(i.id),n=Math.ceil(i.length*2/Math.ceil(r.duration()));for(let o=0;o<n;o++)for(let l=0;l<Math.ceil(r.duration());l++)t.push({sampleId:i.id,offset:l})}this._sequence.push(t)}this._playLength<=0&&(this._playLength=Math.max(...this._sequence.map(e=>e.length)))}}async preloadSamplesForSong(e){const t=new VO(e);await Promise.all(t.getSampleIds().map(i=>this.getSample(i)))}async loadSong(e){return new Promise((t,i)=>{const r=new hh.Howl({src:[this._sampleUrl.replace("%sample%",e.toString())],preload:!0});r.once("load",()=>{this._cache.set(e,r),t(r)}),r.once("loaderror",()=>{ze.error("failed to load sample "+e),i("failed to load sample "+e)})})}tick(){this._currentPos>this._playLength-1&&this.stop(),this._isPlaying&&(this._currentSong&&this.playPosition(this._currentPos),this._currentPos++)}playPosition(e){if(!(!this._currentSong||!this._sequence)&&hh.Howler._audioUnlocked)for(const t of this._sequence){const i=t[e];if(!i||i.sampleId===-1||i.sampleId===0)continue;const r=this._cache.get(i.sampleId);r&&(i.offset===0?r.play():r.playing()||(r.seek(i.offset),r.play()))}}}const Nu=class Nu{constructor(){this._priorityPlaying=-1,this._requestNumberPlaying=-1,this._previousNotificationTime=-1,this._timerInstance=-1,this._songRequestList=[],this._requestedSongs=new Map,this._availableSongs=new Map,this._songDiskInventory=new Ms,this._songRequestsPerPriority=[],this._songRequestCountsPerPriority=[],this._diskInventoryMissingData=[],this._songIdPlaying=-1,this._previousNotifiedSongId=-1,this._messageEvents=[new xL(this.onTraxSongInfoMessageEvent.bind(this)),new OL(this.onSongDiskInventoryMessage.bind(this))],this.onJukeboxInit=this.onJukeboxInit.bind(this),this.onJukeboxDispose=this.onJukeboxDispose.bind(this),this.onSoundMachineInit=this.onSoundMachineInit.bind(this),this.onSoundMachineDispose=this.onSoundMachineDispose.bind(this),this.onTraxSongComplete=this.onTraxSongComplete.bind(this)}init(){this._timerInstance=window.setInterval(this.onTick.bind(this),1e3),this._musicPlayer=new Xee(De.instance.getConfiguration("external.samples.url")),this._messageEvents.forEach(e=>De.instance.communication.connection.addMessageEvent(e)),De.instance.roomEngine.events.addEventListener(Hs.JUKEBOX_INIT,this.onJukeboxInit),De.instance.roomEngine.events.addEventListener(Hs.JUKEBOX_DISPOSE,this.onJukeboxDispose),De.instance.roomEngine.events.addEventListener(Hs.SOUND_MACHINE_INIT,this.onSoundMachineInit),De.instance.roomEngine.events.addEventListener(Hs.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),De.instance.soundManager.events.addEventListener(Gd.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}getRoomItemPlaylist(e){return this._roomItemPlaylist}get songDiskInventory(){return this._songDiskInventory}getSongDiskInventorySize(){return this._songDiskInventory.length}getSongDiskInventoryDiskId(e){return e>=0&&e<this._songDiskInventory.length?this._songDiskInventory.getKey(e):-1}getSongDiskInventorySongId(e){return e>=0&&e<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(e):-1}getSongInfo(e){const t=this.getSongDataEntry(e);return t||this.requestSongInfoWithoutSamples(e),t}getSongIdPlayingAtPriority(e){return e!==this._priorityPlaying?-1:this._songIdPlaying}stop(e){const t=e===this._priorityPlaying,i=this.getTopRequestPriority()===e;t?(this.resetSongStartRequest(e),this.stopSongAtPriority(e)):(this.resetSongStartRequest(e),i&&this.reRequestSongAtPriority(this._priorityPlaying))}addSongInfoRequest(e){this.requestSong(e,!0)}requestSongInfoWithoutSamples(e){this.requestSong(e,!1)}requestUserSongDisks(){De.instance.communication.connection.send(new dF)}updateVolume(e){this._musicPlayer.setVolume(e)}dispose(){this._timerInstance&&(clearInterval(this._timerInstance),this._timerInstance=void 0),this._messageEvents.forEach(e=>De.instance.communication.connection.removeMessageEvent(e)),De.instance.roomEngine.events.removeEventListener(Hs.JUKEBOX_INIT,this.onJukeboxInit),De.instance.roomEngine.events.removeEventListener(Hs.JUKEBOX_DISPOSE,this.onJukeboxDispose),De.instance.roomEngine.events.removeEventListener(Hs.SOUND_MACHINE_INIT,this.onSoundMachineInit),De.instance.roomEngine.events.removeEventListener(Hs.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),De.instance.soundManager.events.removeEventListener(Gd.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}get samplesIdsInUse(){let e,t,i=[];for(let r=0;r<this._songRequestsPerPriority.length;r++)if(this._songRequestsPerPriority[r]&&(e=this._songRequestsPerPriority[r],t=this._availableSongs.get(e.songId),t)){const n=t.songData;if(n.length>0){const o=new VO(n);i=i.concat(o.getSampleIds())}}return i}onSongLoaded(e){const t=this.getTopRequestPriority();if(t>=0){const i=this.getSongIdRequestedAtPriority(t);e===i&&this.playSongObject(t,e)}}samplesUnloaded(e){throw new Error("Method not implemented.")}onTraxSongComplete(e){if(this.getSongIdPlayingAtPriority(this._priorityPlaying)===e.id){this.getTopRequestPriority()===this._priorityPlaying&&this.getSongRequestCountAtPriority(this._priorityPlaying)==this._requestNumberPlaying&&this.resetSongStartRequest(this._priorityPlaying);const t=this._priorityPlaying;this.playSongWithHighestPriority(),t>=Ji.PRIORITY_SONG_PLAY&&De.instance.soundManager.events.dispatchEvent(new Po(Po.NPW_USER_STOP_SONG,t,e.id,-1))}}onTraxSongInfoMessageEvent(e){const t=e.getParser();for(const i of t.songs){const r=!!this.getSongDataEntry(i.id);if(this.areSamplesRequested(i.id),!r){const n=new AG(i.id,i.length,i.name,i.creator,i.data);this._availableSongs.set(i.id,n);const o=this.getTopRequestPriority(),l=this.getSongIdRequestedAtPriority(o);for(i.id===l&&this.playSongObject(o,l),De.instance.soundManager.events.dispatchEvent(new sh(sh.SIR_TRAX_SONG_INFO_RECEIVED,i.id));this._diskInventoryMissingData.indexOf(i.id)!=-1;)this._diskInventoryMissingData.splice(this._diskInventoryMissingData.indexOf(i.id),1),this._diskInventoryMissingData.length===0&&De.instance.soundManager.events.dispatchEvent(new ku(ku.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}}}onSongDiskInventoryMessage(e){const t=e.getParser();this._songDiskInventory.reset();for(let i=0;i<t.songDiskCount;i++){const r=t.getDiskId(i),n=t.getSongId(i);this._songDiskInventory.add(r,n),this._availableSongs.get(n)||(this._diskInventoryMissingData.push(n),this.requestSongInfoWithoutSamples(n))}this._diskInventoryMissingData.length===0&&De.instance.soundManager.events.dispatchEvent(new ku(ku.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}onTick(){this._songRequestList.length!==0&&(De.instance.communication.connection.send(new hF(...this._songRequestList)),this._songRequestList=[])}requestSong(e,t){this._requestedSongs.get(e)===void 0&&(this._requestedSongs.set(e,t),this._songRequestList.push(e))}areSamplesRequested(e){return this._requestedSongs.get(e)?this._requestedSongs.get(e):!1}processSongEntryForPlaying(e,t=!0){return this.getSongDataEntry(e)?!0:(this.addSongInfoRequest(e),!1)}playSong(e,t,i=0,r=0,n=.5,o=.5){return!this.addSongStartRequest(t,e,i,r,n,o)||!this.processSongEntryForPlaying(e)?!1:(t>=this._priorityPlaying&&this.playSongObject(t,e),!0)}playSongObject(e,t){if(t===-1||e<0||e>=Ji.PRIORITY_COUNT)return!1;let i=!1;this.stopSongAtPriority(this._priorityPlaying)&&(i=!0);const r=this.getSongDataEntry(t);if(!r)return!1;if(i)return!0;this._musicPlayer.setVolume(De.instance.soundManager.traxVolume);let n=Nu.SKIP_POSITION_SET,o=0;const l=this.getSongStartRequest(e);return l&&(n=l.startPos,o=l.playLength,l.fadeInSeconds,l.fadeOutSeconds),n>=r.length/1e3?!1:(n<=Nu.SKIP_POSITION_SET&&(n=0),n=Math.trunc(n),this._priorityPlaying=e,this._requestNumberPlaying=this.getSongRequestCountAtPriority(e),this._songIdPlaying=t,this._priorityPlaying<=Nu.MAXIMUM_NOTIFY_PRIORITY&&this.notifySongPlaying(r),this._musicPlayer.preloadSamplesForSong(r.songData).then(()=>this._musicPlayer.play(r.songData,r.id,n,o)),e>Ji.PRIORITY_ROOM_PLAYLIST&&De.instance.soundManager.events.dispatchEvent(new Po(Po.NPE_USER_PLAY_SONG,e,r.id,-1)),!0)}notifySongPlaying(e){const i=Date.now();e.length>=8e3&&(this._previousNotifiedSongId!=e.id||i>this._previousNotificationTime+8e3)&&(De.instance.soundManager.events.dispatchEvent(new wp(e.name,e.creator)),this._previousNotifiedSongId=e.id,this._previousNotificationTime=i)}addSongStartRequest(e,t,i,r,n,o){if(e<0||e>=Ji.PRIORITY_COUNT)return!1;const l=new Yee(t,i,r,n,o);return this._songRequestsPerPriority[e]=l,this._songRequestCountsPerPriority[e]=this._songRequestCountsPerPriority[e]+1,!0}getSongDataEntry(e){let t;return this._availableSongs&&(t=this._availableSongs.get(e)),t}getSongStartRequest(e){return this._songRequestsPerPriority[e]}getTopRequestPriority(){return this._songRequestsPerPriority.length-1}getSongIdRequestedAtPriority(e){return e<0||e>=Ji.PRIORITY_COUNT||!this._songRequestsPerPriority[e]?-1:this._songRequestsPerPriority[e].songId}getSongRequestCountAtPriority(e){return e<0||e>=Ji.PRIORITY_COUNT?-1:this._songRequestCountsPerPriority[e]}playSongWithHighestPriority(){let e;this._priorityPlaying=-1,this._songIdPlaying=-1,this._requestNumberPlaying=-1;let i=this.getTopRequestPriority();for(;i>=0;){if(e=this.getSongIdRequestedAtPriority(i),e>=0&&this.playSongObject(i,e))return;i--}}resetSongStartRequest(e){e>=0&&e<Ji.PRIORITY_COUNT&&(this._songRequestsPerPriority[e]=void 0)}reRequestSongAtPriority(e){this._songRequestCountsPerPriority[e]=this._songRequestCountsPerPriority[e]+1}stopSongAtPriority(e){if(e===this._priorityPlaying&&this._priorityPlaying>=0){const t=this.getSongIdPlayingAtPriority(e);if(t>=0)return this.getSongDataEntry(t),this._musicPlayer.stop(),!0}return!1}onSoundMachineInit(e){this.disposeRoomPlaylist()}onSoundMachineDispose(e){this.disposeRoomPlaylist()}onJukeboxInit(e){this.disposeRoomPlaylist(),this._roomItemPlaylist=new zee,this._roomItemPlaylist.init(),De.instance.communication.connection.send(new cF)}onJukeboxDispose(e){this.disposeRoomPlaylist()}disposeRoomPlaylist(){this._roomItemPlaylist&&(this._roomItemPlaylist.dispose(),this._roomItemPlaylist=void 0)}};Nu.SKIP_POSITION_SET=-1,Nu.MAXIMUM_NOTIFY_PRIORITY=Ji.PRIORITY_ROOM_PLAYLIST;let HO=Nu;class $ee extends Wo{constructor(){super(),this._volumeSystem=.5,this._volumeFurni=.5,this._volumeTrax=.5,this._volumeSoundEffect=.5,this._internalSamples=new Ms,this._furniSamples=new Ms,this._furnitureBeingPlayed=new Ms,this._internalMusicSamples=new Ms,this._internalSoundEffectSamples=new Ms,this._musicController=new HO,this._musicQueue=[],this._currentMusic=null,this.onEvent=this.onEvent.bind(this)}onInit(){this._musicController.init(),De.instance.roomEngine.events.addEventListener(Un.PLAY_SAMPLE,this.onEvent),De.instance.roomEngine.events.addEventListener(ke.REMOVED,this.onEvent),De.instance.roomEngine.events.addEventListener(Ot.DISPOSED,this.onEvent),De.instance.events.addEventListener(Ic.SETTINGS_UPDATED,this.onEvent),De.instance.events.addEventListener(Ws.PLAY_SOUND,this.onEvent),De.instance.events.addEventListener(Ws.PLAY_SOUND_EFFECT,this.onEvent),De.instance.events.addEventListener(Ws.PLAY_MUSIC,this.onEvent),De.instance.events.addEventListener(Ws.STOP_ALL_WIRED_SOUNDS,this.onEvent)}onDispose(){this._musicController&&(this._musicController.dispose(),this._musicController=null),this._internalMusicSamples&&(this._internalMusicSamples.dispose(),this._internalMusicSamples=null),this.stopAllMusic(),De.instance.roomEngine.events.removeEventListener(Un.PLAY_SAMPLE,this.onEvent),De.instance.roomEngine.events.removeEventListener(ke.REMOVED,this.onEvent),De.instance.roomEngine.events.removeEventListener(Ot.DISPOSED,this.onEvent),De.instance.events.removeEventListener(Ic.SETTINGS_UPDATED,this.onEvent),De.instance.events.removeEventListener(Ws.PLAY_SOUND,this.onEvent),De.instance.events.removeEventListener(Ws.PLAY_SOUND_EFFECT,this.onEvent),De.instance.events.removeEventListener(Ws.PLAY_MUSIC,this.onEvent),De.instance.events.removeEventListener(Ws.STOP_ALL_WIRED_SOUNDS,this.onEvent)}onEvent(e){var t;switch(e.type){case Un.PLAY_SAMPLE:{const i=e;this.playFurniSample(i.objectId,i.sampleId,i.pitch);return}case ke.REMOVED:{const i=e;this.stopFurniSample(i.objectId);return}case Ot.DISPOSED:{this._furnitureBeingPlayed.getKeys().forEach(i=>{this.stopFurniSample(i)}),this.stopAllMusic();return}case Ic.SETTINGS_UPDATED:{const i=e,r=i.volumeFurni!==this._volumeFurni,n=i.volumeTrax!==this._volumeTrax;this._volumeSystem=i.volumeSystem/100,this._volumeFurni=i.volumeFurni/100,this._volumeTrax=i.volumeTrax/100,r&&this.updateFurniSamplesVolume(this._volumeFurni),n&&((t=this._musicController)==null||t.updateVolume(this._volumeTrax)),this._currentMusic&&(this._currentMusic.volume=this._volumeTrax);return}case Ws.PLAY_SOUND:{const i=e;this.playInternalSample(i.sampleCode);return}case Ws.PLAY_SOUND_EFFECT:{const i=e;this.playSoundEffect(i.sampleCode,i.volume);return}case Ws.PLAY_MUSIC:{const i=e;this.playMusic(i.sampleCode,i.volume,i.loop);return}case Ws.STOP_ALL_WIRED_SOUNDS:{this.stopAllMusic();return}}}playSample(e,t,i=1){e.volume=Math.max(0,Math.min(1,t)),e.playbackRate=i,e.currentTime=0,e.preservesPitch=!1;try{e.play()}catch(r){ze.error(r)}}playInternalSample(e){let t=this._internalSamples.getValue(e);if(!t){const i=st.getValue("sounds.url");t=new Audio(i.replace("%sample%",e)),this._internalSamples.add(e,t)}this.playSample(t,this._volumeSystem)}playSoundEffect(e,t){if(!e||!e.length)return;let i=this._internalSoundEffectSamples.getValue(e);if(!i){const r="https://cdn.hubbe.biz/audioswired/%sample%.ogg";i=new Audio(r.replace("%sample%",e)),this._internalSoundEffectSamples.add(e,i)}this.playSample(i,this._volumeSoundEffect!=.5?this._volumeSoundEffect:t)}playMusic(e,t,i){if(!e||!e.length||this._musicQueue.length>=10)return;const r="https://cdn.hubbe.biz/audioswired/%sample%.ogg",n=new Audio(r.replace("%sample%",e));this._internalMusicSamples.add(e,n),this._musicQueue.push(new Ws(Ws.PLAY_MUSIC,e,t,i)),!this._currentMusic&&this.playNextMusic(t,i)}playNextMusic(e,t){if(this._musicQueue.length===0)return;const i=this._musicQueue.shift(),r=this._internalMusicSamples.getValue(i.sampleCode);if(r){this._currentMusic=r,this._currentMusic.loop=t,this._currentMusic.volume=this._volumeTrax!=.5?this._volumeTrax:e,this._currentMusic.currentTime=0,this._currentMusic.onended=()=>{this._currentMusic=null,this.playNextMusic(e,t)};try{this._currentMusic.play()}catch(n){ze.error(n),this.playNextMusic(e,t)}}}stopAllMusic(){if(this._currentMusic){try{this._currentMusic.pause()}catch(e){ze.error(e)}this._currentMusic=null}this._musicQueue=[]}playFurniSample(e,t,i){let r=this._furniSamples.getValue(t);if(!r){const n=st.getValue("external.samples.url");r=new Audio(n.replace("%sample%",t.toString())),this._furniSamples.add(t,r)}this._furnitureBeingPlayed.hasKey(e)||this._furnitureBeingPlayed.add(e,t),r.onended=n=>{this.stopFurniSample(e)},r.onpause=n=>{this.stopFurniSample(e)},r.onerror=n=>{this.stopFurniSample(e)},this.playSample(r,this._volumeFurni,i)}stopInternalSample(e){const t=this._internalSamples.getValue(e);if(t)try{t.pause()}catch(i){ze.error(i)}}stopFurniSample(e){const t=this._furnitureBeingPlayed.getValue(e);if(!t)return;const i=this._furniSamples.getValue(t);if(this._furnitureBeingPlayed.remove(e),!!i)try{i.pause()}catch(r){ze.error(r)}}updateInternalSamplesVolume(e){this._internalSamples.getValues().forEach(t=>{t.volume=e})}updateFurniSamplesVolume(e){this._furniSamples.getValues().forEach(t=>{t.volume=e})}get traxVolume(){return this._volumeTrax}get musicController(){return this._musicController}get musicPlaylist(){return this._internalMusicSamples.getKeys()}get volumeSystem(){return this._volumeSystem}}Me.available;ZI.SCALE_MODE=window.devicePixelRatio%1?AS.LINEAR:AS.NEAREST;ZI.ROUND_PIXELS=!0;ZI.GC_MAX_IDLE=120;const Dn=class Dn{constructor(e,t){Dn.INSTANCE||(Dn.INSTANCE=this),this._application=new di(t),this._core=e,this._events=new Sn,this._communication=new BJ(e.communication),this._localization=new HJ(this._communication),this._avatar=new YO,this._roomEngine=new rm(this._communication),this._sessionDataManager=new Wee(this._communication),this._roomSessionManager=new Hee(this._communication,this._roomEngine),this._roomManager=new sR(this._roomEngine,this._roomEngine.visualizationFactory,this._roomEngine.logicFactory),this._cameraManager=new F2,this._soundManager=new $ee,this._latencyTracker=new dte(this._communication),this._linkTrackers=[],this._isReady=!1,this._isDisposed=!1,this._core.configuration.events.addEventListener(ha.LOADED,this.onConfigurationLoadedEvent.bind(this)),this._roomEngine.events.addEventListener(Ot.ENGINE_INITIALIZED,this.onRoomEngineReady.bind(this))}static bootstrap(){Dn.INSTANCE&&(Dn.INSTANCE.dispose(),Dn.INSTANCE=null);const e=document.createElement("canvas"),t=Dn.isLowEndDevice(),i=new this(new Ste,{resolution:window.devicePixelRatio,antialias:!t,useContextAlpha:!t,autoDensity:!1,width:window.innerWidth,height:window.innerHeight,view:e,powerPreference:t?"low-power":"default"});e.addEventListener("webglcontextlost",()=>i.events.dispatchEvent(new _t(Dn.WEBGL_CONTEXT_LOST)))}init(){if(!(this._isReady||this._isDisposed)){if(this._avatar&&this._avatar.init(),this._soundManager&&this._soundManager.init(),this._roomEngine&&(this._roomEngine.sessionDataManager=this._sessionDataManager,this._roomEngine.roomSessionManager=this._roomSessionManager,this._roomEngine.roomManager=this._roomManager,this._sessionDataManager&&this._sessionDataManager.init(),this._roomSessionManager&&this._roomSessionManager.init(),this._roomEngine.init()),!this._communication.connection)throw new Error("No connection found");this._latencyTracker&&this._latencyTracker.init(),new VJ(this._communication.connection),this._isReady=!0}}dispose(){this._isDisposed||(this._roomManager&&(this._roomManager.dispose(),this._roomManager=null),this._roomSessionManager&&(this._roomSessionManager.dispose(),this._roomSessionManager=null),this._sessionDataManager&&(this._sessionDataManager.dispose(),this._sessionDataManager=null),this._roomEngine&&(this._roomEngine.dispose(),this._roomEngine=null),this._avatar&&(this._avatar.dispose(),this._avatar=null),this._soundManager&&(this._soundManager.dispose(),this._soundManager=null),this._communication&&(this._communication.dispose(),this._communication=null),this._application&&(this._application.destroy(),this._application=null),this._isDisposed=!0,this._isReady=!1)}onConfigurationLoadedEvent(e){Gi().maxFPS=st.getValue("system.fps.max",24),ze.LOG_DEBUG=st.getValue("system.log.debug",!0),ze.LOG_WARN=st.getValue("system.log.warn",!1),ze.LOG_ERROR=st.getValue("system.log.error",!1),ze.LOG_EVENTS=st.getValue("system.log.events",!1),ze.LOG_PACKETS=st.getValue("system.log.packets",!1),Up.LANDSCAPES_ENABLED=st.getValue("room.landscapes.enabled",!0)}onRoomEngineReady(e){this.startSendingHeartBeat()}getConfiguration(e,t=null){return st.getValue(e,t)}getLocalization(e){return this._localization.getValue(e)}getLocalizationOrDefault(e,t){return this._localization.hasValue(e)?this._localization.getValue(e):t}getLocalizationWithParameter(e,t,i){return this._localization.getValueWithParameter(e,t,i)}getLocalizationWithParameters(e,t,i){return this._localization.getValueWithParameters(e,t,i)}addLinkEventTracker(e){this._linkTrackers.indexOf(e)>=0||this._linkTrackers.push(e)}removeLinkEventTracker(e){const t=this._linkTrackers.indexOf(e);t!==-1&&this._linkTrackers.splice(t,1)}createLinkEvent(e){if(!(!e||e===""))for(const t of this._linkTrackers){if(!t)continue;const i=t.eventUrlPrefix;i.length>0?e.substr(0,i.length)===i&&t.linkReceived(e):t.linkReceived(e)}}startSendingHeartBeat(){this.sendHeartBeat(),setInterval(this.sendHeartBeat,1e4)}sendHeartBeat(){Xa.sendHeartBeat()}get application(){return this._application}get core(){return this._core}get events(){return this._events}get localization(){return this._localization}get communication(){return this._communication}get avatar(){return this._avatar}get roomEngine(){return this._roomEngine}get sessionDataManager(){return this._sessionDataManager}get roomSessionManager(){return this._roomSessionManager}get roomManager(){return this._roomManager}get cameraManager(){return this._cameraManager}get soundManager(){return this._soundManager}get latencyTracker(){return this._latencyTracker}get width(){return this._application.renderer.width}get height(){return this._application.renderer.height}get isReady(){return this._isReady}get isDisposed(){return this._isDisposed}static get instance(){return this.INSTANCE||null}static isLowEndDevice(){const t=(navigator.deviceMemory||4)<=2,i=navigator.hardwareConcurrency<=2;return t||i}};Dn.WEBGL_CONTEXT_LOST="NE_WEBGL_CONTEXT_LOST",Dn.WEBGL_UNAVAILABLE="NE_WEBGL_UNAVAILABLE",Dn.READY="NE_READY!",Dn.INSTANCE=null;let De=Dn;const Nt=class Nt{static format(e,t="",i=3){return e>i*Nt.YEAR?Nt.getLocalization("friendlytime.years"+t,Math.round(e/Nt.YEAR)):e>i*Nt.MONTH?Nt.getLocalization("friendlytime.months"+t,Math.round(e/Nt.MONTH)):e>i*Nt.DAY?Nt.getLocalization("friendlytime.days"+t,Math.round(e/Nt.DAY)):e>i*Nt.HOUR?Nt.getLocalization("friendlytime.hours"+t,Math.round(e/Nt.HOUR)):e>i*Nt.MINUTE?Nt.getLocalization("friendlytime.minutes"+t,Math.round(e/Nt.MINUTE)):Nt.getLocalization("friendlytime.seconds"+t,Math.round(e))}static shortFormat(e,t="",i=3){return e>i*Nt.YEAR?Nt.getLocalization("friendlytime.years.short"+t,Math.round(e/Nt.YEAR)):e>i*Nt.MONTH?Nt.getLocalization("friendlytime.months.short"+t,Math.round(e/Nt.MONTH)):e>i*Nt.DAY?Nt.getLocalization("friendlytime.days.short"+t,Math.round(e/Nt.DAY)):e>i*Nt.HOUR?Nt.getLocalization("friendlytime.hours.short"+t,Math.round(e/Nt.HOUR)):e>i*Nt.MINUTE?Nt.getLocalization("friendlytime.minutes.short"+t,Math.round(e/Nt.MINUTE)):Nt.getLocalization("friendlytime.seconds.short"+t,Math.round(e))}static getLocalization(e,t){return De.instance.getLocalizationWithParameter(e,"amount",t.toString())}};Nt.MINUTE=60,Nt.HOUR=60*Nt.MINUTE,Nt.DAY=24*Nt.HOUR,Nt.WEEK=7*Nt.DAY,Nt.MONTH=30*Nt.DAY,Nt.YEAR=365*Nt.DAY;let Mr=Nt;const VI=class VI{static isBuilderClubId(e){return e>=VI.BUILDER_CLUB_FURNI_ID_BASE}};VI.BUILDER_CLUB_FURNI_ID_BASE=2147418112;let Fp=VI;const Qee=a=>a>>>0,bG=a=>{const e=Qee(a);return e>=Math.pow(2,31)?e-Math.pow(2,32):e};class DN{constructor(e){if(this._id=e.id,this._isMain=e.main||!1,this._avatarSets=new Map,this._bodyParts=[],this._allBodyParts=[],e.avatarSets&&e.avatarSets.length>0)for(const i of e.avatarSets){if(!i)continue;const r=new DN(i);this._avatarSets.set(r.id,r)}if(e.bodyParts&&e.bodyParts.length>0)for(const i of e.bodyParts)i&&this._bodyParts.push(i.id);let t=this._bodyParts.concat();for(const i of this._avatarSets.values())i&&(t=t.concat(i.getBodyParts()));this._allBodyParts=t}findAvatarSet(e){if(e===this._id)return this;for(const t of this._avatarSets.values())if(t&&t.findAvatarSet(e))return t;return null}getBodyParts(){return this._allBodyParts.concat()}get id(){return this._id}get isMain(){if(this._isMain)return!0;for(const e of this._avatarSets.values())if(e&&e.isMain)return!0;return!1}}class Yn{constructor(e=0,t=0,i=0){this._x=e,this._y=t,this._z=i}static dot(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}static cross(e,t){const i=new Yn;return i.x=e.y*t.z-e.z*t.y,i.y=e.z*t.x-e.x*t.z,i.z=e.x*t.y-e.y*t.x,i}static subtract(e,t){return new Yn(e.x-t.x,e.y-t.y,e.z-t.z)}dot(e){return this._x*e.x+this._y*e.y+this._z*e.z}cross(e){const t=new Yn;return t.x=this._y*e.z-this._z*e.y,t.y=this._z*e.x-this._x*e.z,t.z=this._x*e.y-this._y*e.x,t}subtract(e){this._x=this._x-e.x,this._y=this._y-e.y,this._z=this._z-e.z}add(e){this._x=this._x+e.x,this._y=this._y+e.y,this._z=this._z+e.z}normalize(){const e=1/this.length();this._x=this._x*e,this._y=this._y*e,this._z=this._z*e}scaleBy(e){this._x*=e,this._y*=e,this._z*=e}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)}toString(){return"Vector3D: ("+this._x+","+this._y+","+this._z+")"}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get z(){return this._z}set z(e){this._z=e}}class vG{constructor(e,t,i){this._location=new Yn(e,t,i),this._transformedLocation=new Yn,this._needsTransformation=!1,(e!=0||t!=0||i!=0)&&(this._needsTransformation=!0)}get location(){return this._location}get transformedLocation(){return this._transformedLocation}applyTransform(e){this._needsTransformation&&(this._transformedLocation=e.vectorMultiplication(this._location))}}class Qb extends vG{constructor(e,t=!1){super(parseFloat(e.x),parseFloat(e.y),parseFloat(e.z)),this._id=e.id,this._radius=parseFloat(e.radius),this._normal=new Yn(parseFloat(e.nx),parseFloat(e.ny),parseFloat(e.nz)),this._isDoubleSided=e.double||!1,this._isDynamic=t}getDistance(e){const t=Math.abs(e.z-this.transformedLocation.z-this._radius),i=Math.abs(e.z-this.transformedLocation.z+this._radius);return Math.min(t,i)}get id(){return this._id}get normal(){return this._normal}get isDoubleSided(){return this._isDoubleSided}toString(){return this._id+": "+this.location+" - "+this.transformedLocation}get isDynamic(){return this._isDynamic}}class Jee extends vG{constructor(e){if(super(parseFloat(e.x),parseFloat(e.y),parseFloat(e.z)),this._id=e.id,this._radius=parseFloat(e.radius),this._parts=new Map,this._dynamicParts=new Map,e.items&&e.items.length>0)for(const t of e.items){if(!t)continue;const i=new Qb(t);this._parts.set(i.id,i)}}getDynamicParts(e){const t=this._dynamicParts.get(e),i=[];if(t)for(const r in t){const n=t[r];n&&i.push(n)}return i}getPartIds(e){const t=[];for(const i of this._parts.values())i&&t.push(i.id);if(e){const i=this._dynamicParts.get(e);if(i)for(const r in i){const n=i[r];n&&t.push(n.id)}}return t}removeDynamicParts(e){return this._dynamicParts.delete(e),!0}addPart(e,t){if(this.hasPart(e.id,t))return!1;let i=this._dynamicParts.get(t);return i||(i={},this._dynamicParts.set(t,i)),i[e.id]=new Qb(e,!0),!0}hasPart(e,t){let i=this._parts.get(e)||null;return!i&&this._dynamicParts.get(t)!==void 0&&(i=this._dynamicParts.get(t)[e]||null),i!==null}getParts(e,t,i,r){const n=[];for(const c of this._parts.values())c&&(c.applyTransform(e),n.push([c.getDistance(t),c]));const o=this._dynamicParts.get(r);if(o)for(const c in o){const u=o[c];u&&(u.applyTransform(e),n.push([u.getDistance(t),u]))}n.sort((c,u)=>{const d=c[0],_=u[0];return d<_?-1:d>_?1:0});const l=[];for(const c of n)c&&l.push(c[1].id);return l}getDistance(e){const t=Math.abs(e.z-this.transformedLocation.z-this._radius),i=Math.abs(e.z-this.transformedLocation.z+this._radius);return Math.min(t,i)}get id(){return this._id}get radius(){return this._radius}}const Mn=class Mn{constructor(e=0,t=0,i=0,r=0,n=0,o=0,l=0,c=0,u=0){this._data=[e,t,i,r,n,o,l,c,u]}static getXRotationMatrix(e){const t=e*Math.PI/180,i=Math.cos(t),r=Math.sin(t);return new Mn(1,0,0,0,i,-r,0,r,i)}static getYRotationMatrix(e){const t=e*Math.PI/180,i=Math.cos(t),r=Math.sin(t);return new Mn(i,0,r,0,1,0,-r,0,i)}static getZRotationMatrix(e){const t=e*Math.PI/180,i=Math.cos(t),r=Math.sin(t);return new Mn(i,-r,0,r,i,0,0,0,1)}identity(){return this._data=[1,0,0,0,1,0,0,0,1],this}vectorMultiplication(e){const t=e.x*this._data[0]+e.y*this._data[3]+e.z*this._data[6],i=e.x*this._data[1]+e.y*this._data[4]+e.z*this._data[7],r=e.x*this._data[2]+e.y*this._data[5]+e.z*this._data[8];return new Yn(t,i,r)}multiply(e){const t=this._data[0]*e.data[0]+this._data[1]*e.data[3]+this._data[2]*e.data[6],i=this._data[0]*e.data[1]+this._data[1]*e.data[4]+this._data[2]*e.data[7],r=this._data[0]*e.data[2]+this._data[1]*e.data[5]+this._data[2]*e.data[8],n=this._data[3]*e.data[0]+this._data[4]*e.data[3]+this._data[5]*e.data[6],o=this._data[3]*e.data[1]+this._data[4]*e.data[4]+this._data[5]*e.data[7],l=this._data[3]*e.data[2]+this._data[4]*e.data[5]+this._data[5]*e.data[8],c=this._data[6]*e.data[0]+this._data[7]*e.data[3]+this._data[8]*e.data[6],u=this._data[6]*e.data[1]+this._data[7]*e.data[4]+this._data[8]*e.data[7],d=this._data[6]*e.data[2]+this._data[7]*e.data[5]+this._data[8]*e.data[8];return new Mn(t,i,r,n,o,l,c,u,d)}scalarMultiply(e){let t=0;for(;t<this._data.length;)this._data[t]=this._data[t]*e,t++}rotateX(e){const t=e*Math.PI/180,i=Math.cos(t),r=Math.sin(t);return new Mn(1,0,0,0,i,-r,0,r,i).multiply(this)}rotateY(e){const t=e*Math.PI/180,i=Math.cos(t),r=Math.sin(t);return new Mn(i,0,r,0,1,0,-r,0,i).multiply(this)}rotateZ(e){const t=e*Math.PI/180,i=Math.cos(t),r=Math.sin(t);return new Mn(i,-r,0,r,i,0,0,0,1).multiply(this)}skew(){}transpose(){return new Mn(this._data[0],this._data[3],this._data[6],this._data[1],this._data[4],this._data[7],this._data[2],this._data[5],this._data[8])}equals(e){return!1}get data(){return this._data}};Mn.IDENTITY=new Mn(1,0,0,0,1,0,0,0,1),Mn.TOLERANS=1e-18;let f_=Mn;class Zee{constructor(e){this._camera=new Yn(0,0,10),this._avatarSet=new DN(e.avatarSets[0]),this._geometryTypes=new Map,this._itemIdToBodyPartMap=new Map,this._transformation=new f_,this._canvases=new Map;const t=e.camera;if(t&&(this._camera.x=parseFloat(t.x),this._camera.y=parseFloat(t.y),this._camera.z=parseFloat(t.z)),e.canvases&&e.canvases.length>0)for(const i of e.canvases){if(!i)continue;const r=i.scale,n=new Map;if(i.geometries&&i.geometries.length>0)for(const o of i.geometries){if(!o)continue;const l=new I2(o,r);n.set(l.id,l)}this._canvases.set(r,n)}if(e.types&&e.types.length>0)for(const i of e.types){if(!i)continue;const r=new Map,n=new Map;if(i.bodyParts&&i.bodyParts.length>0)for(const o of i.bodyParts){if(!o)continue;const l=new Jee(o);r.set(l.id,l);for(const c of l.getPartIds(null))n.set(c,l)}this._geometryTypes.set(i.id,r),this._itemIdToBodyPartMap.set(i.id,n)}}removeDynamicItems(e){for(const t of this._geometryTypes.values())if(t)for(const i of t.values())i&&i.removeDynamicParts(e)}getBodyPartIdsInAvatarSet(e){const t=this._avatarSet.findAvatarSet(e);return t?t.getBodyParts():[]}isMainAvatarSet(e){const t=this._avatarSet.findAvatarSet(e);return t?t.isMain:!1}getCanvas(e,t){const i=this._canvases.get(e);return i&&i.get(t)||null}typeExists(e){return!!this._geometryTypes.get(e)}hasBodyPart(e,t){if(this.typeExists(e)){const i=this._geometryTypes.get(e);if(i&&i.get(t))return!0}return!1}getBodyPartIDs(e){const t=this.getBodyPartsOfType(e),i=[];if(t)for(const r of t.values())r&&i.push(r.id);return i}getBodyPartsOfType(e){return this.typeExists(e)?this._geometryTypes.get(e):new Map}getBodyPart(e,t){return this.getBodyPartsOfType(e).get(t)||null}getBodyPartOfItem(e,t,i){const r=this._itemIdToBodyPartMap.get(e);if(r){const n=r.get(t);if(n)return n;const o=this.getBodyPartsOfType(e);if(o){for(const l of o.values())if(l&&l.hasPart(t,i))return l}}return null}getBodyPartsInAvatarSet(e,t){const i=this.getBodyPartIdsInAvatarSet(t),r=[];for(const n of i){if(!n)continue;const o=e.get(n);o&&r.push(o)}return r}getBodyPartsAtAngle(e,t,i){if(!i)return[];const r=this.getBodyPartsOfType(i),n=this.getBodyPartsInAvatarSet(r,e),o=[],l=[];this._transformation=f_.getYRotationMatrix(t);for(const c of n.values())c&&(c.applyTransform(this._transformation),o.push([c.getDistance(this._camera),c]));o.sort((c,u)=>{const d=c[0],_=u[0];return d<_?-1:d>_?1:0});for(const c of o)c&&l.push(c[1].id);return l}getParts(e,t,i,r,n){if(this.hasBodyPart(e,t)){const o=this.getBodyPartsOfType(e).get(t);return this._transformation=f_.getYRotationMatrix(i),o.getParts(this._transformation,this._camera,r,n)}return[]}}class ete extends Sn{constructor(e){super(),this._renderManager=e,this._geometry=null,this._figureData=new x2,this._partSetsData=new O2,this._animationData=new E2,this._animationManager=new c2,this._mandatorySetTypeIds={},this._actionManager=null,this._defaultAction=null}init(){}dispose(){this.disposed||(super.dispose(),this._renderManager=null,this._figureData=null,this._partSetsData=null,this._animationData=null,this._mandatorySetTypeIds=null)}initGeometry(e){e&&(this._geometry=new Zee(e))}initActions(e,t){t&&(this._actionManager=new s2(e,t),this._defaultAction=this._actionManager.getDefaultAction())}updateActions(e){this._actionManager.updateActions(e),this._defaultAction=this._actionManager.getDefaultAction()}initPartSets(e){return e&&this._partSetsData.parse(e)?(this._partSetsData.getPartDefinition("ri").appendToFigure=!0,this._partSetsData.getPartDefinition("li").appendToFigure=!0,!0):!1}initAnimation(e){return e?this._animationData.parse(e):!1}initFigureData(e){return e?this._figureData.parse(e):!1}injectFigureData(e){this._figureData.injectJSON(e)}registerAnimations(e,t="fx",i=200){let r=0;for(;r<i;){const n=e.getCollection(t+r);if(n){const o=n.data;this._animationManager.registerAnimation(this,o.animations)}r++}}registerAnimation(e){this._animationManager.registerAnimation(this,e)}getPartColor(e,t,i=0){const r=e.getPartColorIds(t);if(!r||r.length<i)return null;const n=this._figureData.getSetType(t);if(n==null)return null;const o=this._figureData.getPalette(n.paletteID);return o?o.getColor(r[i]):null}getBodyPartData(e,t,i){return this._animationManager.getLayerData(e,t,i)}getAnimation(e){return this._animationManager.getAnimation(e)}getActionDefinition(e){return this._actionManager.getActionDefinition(e)}getActionDefinitionWithState(e){return this._actionManager.getActionDefinitionWithState(e)}isMainAvatarSet(e){return this._geometry.isMainAvatarSet(e)}sortActions(e){return this._actionManager.sortActions(e)}maxFrames(e){let t=0;for(const i of e)t=Math.max(t,this._animationData.getFrameCount(i.definition));return t}getMandatorySetTypeIds(e,t){return this._mandatorySetTypeIds[e]||(this._mandatorySetTypeIds[e]=[]),this._mandatorySetTypeIds[e][t]?this._mandatorySetTypeIds[e][t]:(this._mandatorySetTypeIds[e][t]=this._figureData.getMandatorySetTypeIds(e,t),this._mandatorySetTypeIds[e][t])}getDefaultPartSet(e,t){return this._figureData.getDefaultPartSet(e,t)}getCanvasOffsets(e,t,i){return this._actionManager.getCanvasOffsets(e,t,i)}getCanvas(e,t){return this._geometry.getCanvas(e,t)}removeDynamicItems(e){this._geometry.removeDynamicItems(e)}getActiveBodyPartIds(e,t){let i=[];const r=[],n=e.definition.geometryType;if(e.definition.isAnimation){const o=e.definition.state+"."+e.actionParameter,l=this._animationManager.getAnimation(o);if(l&&(i=l.getAnimatedBodyPartIds(0,e.overridingAction),l.hasAddData())){const c={id:"",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:1},u={setType:""};for(const d of l.addData){const _=this._geometry.getBodyPart(n,d.align);if(_){c.id=d.id,_.addPart(c,t),u.setType=d.id;const m=this._partSetsData.addPartDefinition(u);m.appendToFigure=!0,d.base===""&&(m.staticId=1),r.indexOf(_.id)===-1&&r.push(_.id)}}}for(const c of i){const u=this._geometry.getBodyPart(n,c);u&&r.indexOf(u.id)===-1&&r.push(u.id)}}else{i=this._partSetsData.getActiveParts(e.definition);for(const o of i){const l=this._geometry.getBodyPartOfItem(n,o,t);l&&r.indexOf(l.id)===-1&&r.push(l.id)}}return r}getBodyPartsUnordered(e){return this._geometry.getBodyPartIdsInAvatarSet(e)}getBodyParts(e,t,i){const r=yr.DIRECTION_TO_ANGLE[i];return this._geometry.getBodyPartsAtAngle(e,r,t)}getFrameBodyPartOffset(e,t,i,r){const n=this._animationData.getAction(e.definition);return n?n.getFrameBodyPartOffset(t,i,r):Lg.DEFAULT_OFFSET}getParts(e,t,i,r,n,o,l,c=null){let u=null,d=[],_=null;if(!i==null)return[];const m=this._partSetsData.getActiveParts(i.definition),f=[];let E=[0];const I=this._animationData.getAction(i.definition);if(i.definition.isAnimation){const O=i.definition.state+"."+i.actionParameter,C=this._animationManager.getAnimation(O);if(C){E=this.getPopulatedArray(C.frameCount(i.overridingAction));for(const A of C.getAnimatedBodyPartIds(0,i.overridingAction))if(A===e){const b=this._geometry.getBodyPart(r,A);if(b)for(const y of b.getDynamicParts(l))m.push(y.id)}}}const p=this._geometry.getParts(r,e,n,m,l),S=t.getPartTypeIds();for(const O of S){if(c&&c.get(O))continue;const C=t.getPartSetId(O),A=t.getPartColorIds(O),b=this._figureData.getSetType(O);if(b){const y=this._figureData.getPalette(b.paletteID);if(y){const M=b.getPartSet(C);if(M){o=o.concat(M.hiddenLayers);for(const U of M.parts)if(p.indexOf(U.type)>-1){if(I){const B=I.getPart(U.type);B?d=B.frames:d=E}else d=E;u=i.definition,m.indexOf(U.type)===-1&&(u=this._defaultAction);const G=this._partSetsData.getPartDefinition(U.type);let F=G?G.flippedSetType:U.type;(!F||F==="")&&(F=U.type),A&&A.length>U.colorLayerIndex-1&&(_=y.getColor(A[U.colorLayerIndex-1]));const H=U.colorLayerIndex>0,v=new WT(e,U.type,U.id.toString(),_,d,u,H,U.paletteMap,F);f.push(v)}}}}}const R=[];for(const O of p){let C=null,A=!1;const b=c&&c.get(O);for(const y of f)y.partType===O&&(b?C=y.color:(A=!0,o.indexOf(O)===-1&&R.push(y)));if(!A){if(b){const y=c.get(O);let M=0,U=0;for(;U<y.length;)M=M+y.charCodeAt(U),U++;if(I){const F=I.getPart(O);F?d=F.frames:d=E}else d=E;const G=new WT(e,O,y,C,d,i.definition,C!=null,-1,O,!1,1);R.push(G)}else if(m.indexOf(O)>-1){const y=this._geometry.getBodyPartOfItem(r,O,l);if(e===y.id){const M=this._partSetsData.getPartDefinition(O);let U=!1,G=1;if(M.appendToFigure){let F="1";if(i.actionParameter!==""&&(F=i.actionParameter),M.hasStaticId()&&(F=M.staticId.toString()),I){const v=I.getPart(O);v?d=v.frames:d=E}else d=E;const H=new WT(e,O,F,null,d,i.definition,!1,-1,O,U,G);R.push(H)}}}}}return R}getPopulatedArray(e){const t=[];let i=0;for(;i<e;)t.push(i),i++;return t}getItemIds(){if(this._actionManager){const e=this._actionManager.getActionDefinition("CarryItem").params,t=[];for(const i of e.values())t.push(i);return t}return[]}get renderManager(){return this._renderManager}get figureData(){return this._figureData}get partData(){return this._partSetsData}get animationManager(){return this._animationManager}}const tte={animations:[{id:"Move",parts:[{setType:"bd",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"bds",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ss",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lg",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"sh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]}]},{id:"Wave",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"},{number:2,assetPartDefinition:"wav"},{number:3,assetPartDefinition:"wav"}]}]},{id:"Talk",parts:[{setType:"hd",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fa",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]}]},{id:"Sign",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"li",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"}]}]},{id:"Respect",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"respect",repeats:15},{number:1,assetPartDefinition:"respect",repeats:15}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]}]},{id:"Blow",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw",repeats:10},{number:1,assetPartDefinition:"blw",repeats:10}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"eyb",repeats:10}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"blw",repeats:10}]}]},{id:"Laugh",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:2}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"sml"}]}],offsets:{frames:[{id:0,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:1}]},{id:1,bodyParts:[{id:"head",dx:0,dy:1}]},{id:2,bodyParts:[{id:"head",dx:0,dy:1}]},{id:3,bodyParts:[{id:"head",dx:0,dy:1}]},{id:4,bodyParts:[{id:"head",dx:0,dy:1}]},{id:5,bodyParts:[{id:"head",dx:0,dy:1}]},{id:6,bodyParts:[{id:"head",dx:0,dy:1}]},{id:7,bodyParts:[{id:"head",dx:0,dy:1}]}]},{id:1,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:0}]},{id:1,bodyParts:[{id:"head",dx:0,dy:0}]},{id:2,bodyParts:[{id:"head",dx:0,dy:0}]},{id:3,bodyParts:[{id:"head",dx:0,dy:0}]},{id:4,bodyParts:[{id:"head",dx:0,dy:0}]},{id:5,bodyParts:[{id:"head",dx:0,dy:0}]},{id:6,bodyParts:[{id:"head",dx:0,dy:0}]},{id:7,bodyParts:[{id:"head",dx:0,dy:0}]}]}]}}]},ste={geometry:{direction:0,camera:{x:0,y:0,z:10},canvases:[{scale:"h",geometries:[{id:"vertical",width:90,height:130,dx:0,dy:0},{id:"sitting",width:90,height:130,dx:0,dy:0},{id:"horizontal",width:128,height:80,dx:30,dy:0},{id:"swhorizontal",width:192,height:120,dx:0,dy:-40}]},{scale:"sh",geometries:[{id:"vertical",width:45,height:72,dx:0,dy:0},{id:"sitting",width:45,height:72,dx:0,dy:0},{id:"horizontal",width:64,height:50,dx:15,dy:-10},{id:"swhorizontal",width:96,height:70,dx:0,dy:-20},{id:"swim",width:64,height:70,dx:25,dy:10}]}],avatarSets:[{id:"full",avatarSets:[{id:"body",main:!0,bodyParts:[{id:"top"},{id:"bottom"},{id:"behind"},{id:"torso"},{id:"leftitem"},{id:"rightitem"},{id:"leftarm"},{id:"rightarm"}]},{id:"head",bodyParts:[{id:"head"}]}]}],types:[{id:"vertical",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"sitting",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"horizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swhorizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swim",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]}]}},ite={partSets:{partSet:[{setType:"ri",flippedSetType:"ri"},{setType:"ri",flippedSetType:"ri"},{setType:"rh",flippedSetType:"lh"},{setType:"rhs",flippedSetType:"lhs"},{setType:"rs",swim:"0",flippedSetType:"ls"},{setType:"rc",flippedSetType:"lc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb",removeSetType:"hr"},{setType:"li",flippedSetType:"li"},{setType:"lh",flippedSetType:"rh"},{setType:"lhs",flippedSetType:"rhs"},{setType:"ls",flippedSetType:"rs"},{setType:"lc",flippedSetType:"rc"},{setType:"wa"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}],activePartSets:[{id:"figure",activeParts:[{setType:"rh"},{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"wa"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"head",activeParts:[{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"ea"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"speak",activeParts:[{setType:"hd"},{setType:"hr"},{setType:"hrb"},{setType:"fc"},{setType:"fa"},{setType:"ha"}]},{id:"gesture",activeParts:[{setType:"ey"},{setType:"fc"}]},{id:"eye",activeParts:[{setType:"ey"}]},{id:"handRight",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"}]},{id:"handRightAndHead",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"},{setType:"ey"},{setType:"fc"},{setType:"hd"}]},{id:"handLeft",activeParts:[{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"li"}]},{id:"walk",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"lh"},{setType:"lhs"},{setType:"rh"},{setType:"rhs"},{setType:"ls"},{setType:"lc"},{setType:"rs"},{setType:"rc"},{setType:"sh"}]},{id:"sit",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"sh"},{setType:"cc"}]},{id:"itemRight",activeParts:[{setType:"ri"}]}]}},dn=class dn extends Sn{constructor(e,t,i,r){super(),this._state=dn.NOT_LOADED,this._libraryName=e,this._revision=t,this._downloadUrl=r,this._assets=i,this._animation=null,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=dn.LOADED)}async downloadAsset(){if(!this._assets||this._state===dn.LOADING||this._state===dn.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=dn.LOADED,this.dispatchEvent(new Mu(Mu.DOWNLOAD_COMPLETE,this));return}if(this._state=dn.LOADING,!await this._assets.downloadAsset(this._downloadUrl))return;this._state=dn.LOADED;const i=this._assets.getCollection(this._libraryName);i&&(this._animation=i.data.animations),this.dispatchEvent(new Mu(Mu.DOWNLOAD_COMPLETE,this))}get libraryName(){return this._libraryName}get animation(){return this._animation}get isLoaded(){return this._state===dn.LOADED}};dn.DOWNLOAD_COMPLETE="EADL_DOWNLOAD_COMPLETE",dn.NOT_LOADED=0,dn.LOADING=1,dn.LOADED=2;let WO=dn;const Au=class Au extends Sn{constructor(e,t){super(),this._assets=e,this._structure=t,this._missingMandatoryLibs=st.getValue("avatar.mandatory.effect.libraries"),this._effectMap=new Map,this._effectListeners=new Map,this._incompleteEffects=new Map,this._initDownloadBuffer=[],this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadEffectMap(),this._structure.renderManager.events.addEventListener(Ag.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadEffectMap(){const e=new XMLHttpRequest;try{e.open("GET",st.getValue("avatar.effectmap.url")),e.send(),e.onloadend=t=>{if(e.responseText){const i=JSON.parse(e.responseText);this.processEffectMap(i.effects),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new _t(Au.DOWNLOADER_READY))}},e.onerror=t=>{throw new Error("invalid_avatar_effect_map")}}catch(t){ze.error(t)}}processEffectMap(e){if(e)for(const t of e){if(!t)continue;const i=t.id,r=t.lib,n=t.revision||"";if(this._libraryNames.indexOf(r)>=0)continue;this._libraryNames.push(r);const o=new WO(r,n,this._assets,st.getValue("avatar.asset.effect.url"));o.addEventListener(Mu.DOWNLOAD_COMPLETE,this.onLibraryLoaded);let l=this._effectMap.get(i);l||(l=[]),l.push(o),this._effectMap.set(i,l)}}downloadAvatarEffect(e,t){if(!this._isReady||!this._structure.renderManager.isReady){this._initDownloadBuffer.push([e,t]);return}const i=this.getAvatarEffectPendingLibraries(e);if(i&&i.length){if(t&&!t.disposed){let r=this._effectListeners.get(e.toString());r||(r=[]),r.push(t),this._effectListeners.set(e.toString(),r)}this._incompleteEffects.set(e.toString(),i);for(const r of i)r&&this.downloadLibrary(r)}else t&&!t.disposed&&t.resetEffect(e)}onAvatarRenderReady(e){if(e){for(const[t,i]of this._initDownloadBuffer)this.downloadAvatarEffect(t,i);this._initDownloadBuffer=[]}}onLibraryLoaded(e){if(!e||!e.library)return;const t=[];this._structure.registerAnimation(e.library.animation);for(const[r,n]of this._incompleteEffects.entries()){let o=!0;for(const l of n)if(!(!l||l.isLoaded)){o=!1;break}if(o){t.push(r);const l=this._effectListeners.get(r);for(const c of l)!c||c.disposed||c.resetEffect(parseInt(r));this._effectListeners.delete(r),this.dispatchEvent(new _t(Au.LIBRARY_LOADED))}}for(const r of t)this._incompleteEffects.delete(r);let i=0;for(;i<this._currentDownloads.length;){const r=this._currentDownloads[i];r&&r.libraryName===e.library.libraryName&&this._currentDownloads.splice(i,1),i++}}processMissingLibraries(){const e=this._missingMandatoryLibs.slice();for(const t of e){if(!t)continue;const i=this._effectMap.get(t);if(i)for(const r of i)r&&this.downloadLibrary(r)}}isAvatarEffectReady(e){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarEffectPendingLibraries(e).length}getAvatarEffectPendingLibraries(e){const t=[];if(!this._structure)return t;const i=this._effectMap.get(e.toString());if(i)for(const r of i)!r||r.isLoaded||t.indexOf(r)===-1&&t.push(r);return t}downloadLibrary(e){!e||e.isLoaded||this._pendingDownloadQueue.indexOf(e)>=0||this._currentDownloads.indexOf(e)>=0||(this._pendingDownloadQueue.push(e),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}get effectMap(){return this._effectMap}};Au.DOWNLOADER_READY="EADM_DOWNLOADER_READY",Au.LIBRARY_LOADED="EADM_LIBRARY_LOADED",Au.MAX_DOWNLOADS=2;let Jc=Au;class rte extends jf{constructor(e,t,i,r,n){super(e,t,i,r,n,null)}isPlaceholder(){return!0}}const HI=class HI extends Wo{constructor(){super(),this._structure=null,this._avatarAssetDownloadManager=null,this._placeHolderFigure=null,this._figureMapReady=!1,this._effectMapReady=!1,this._actionsReady=!1,this._geometryReady=!1,this._partSetsReady=!1,this._animationsReady=!1,this._isReady=!1,this.onAvatarAssetDownloaderReady=this.onAvatarAssetDownloaderReady.bind(this),this.onAvatarAssetDownloaded=this.onAvatarAssetDownloaded.bind(this),this.onEffectAssetDownloaderReady=this.onEffectAssetDownloaderReady.bind(this),this.onEffectAssetDownloaded=this.onEffectAssetDownloaded.bind(this),this.onAvatarStructureDownloadDone=this.onAvatarStructureDownloadDone.bind(this)}onInit(){this._structure=new ete(this),this.loadGeometry(),this.loadPartSets(),this.loadActions(),this.loadAnimations(),this.loadFigureData(),this._aliasCollection=new r2(this,vr()),this._aliasCollection.init(),this._avatarAssetDownloadManager||(this._avatarAssetDownloadManager=new zc(vr(),this._structure),this._avatarAssetDownloadManager.addEventListener(zc.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.addEventListener(zc.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager||(this._effectAssetDownloadManager=new Jc(vr(),this._structure),this._effectAssetDownloadManager.addEventListener(Jc.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.addEventListener(Jc.LIBRARY_LOADED,this.onEffectAssetDownloaded)),this.checkReady()}onDispose(){this._avatarAssetDownloadManager&&(this._avatarAssetDownloadManager.removeEventListener(zc.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.removeEventListener(zc.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager&&(this._effectAssetDownloadManager.removeEventListener(Jc.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.removeEventListener(Jc.LIBRARY_LOADED,this.onEffectAssetDownloaded))}loadGeometry(){this._structure&&(this._structure.initGeometry(ste.geometry),this._geometryReady=!0,this.checkReady())}loadPartSets(){this._structure&&(this._structure.initPartSets(ite.partSets),this._partSetsReady=!0,this.checkReady())}loadActions(){const e=st.getValue("avatar.default.actions");e&&this._structure.initActions(vr(),e);const t=new XMLHttpRequest;try{t.open("GET",st.getValue("avatar.actions.url")),t.send(),t.onloadend=i=>{this._structure&&(this._structure.updateActions(JSON.parse(t.responseText)),this._actionsReady=!0,this.checkReady())},t.onerror=i=>{throw new Error("invalid_avatar_actions")}}catch(i){ze.error(i)}}loadAnimations(){this._structure&&(this._structure.initAnimation(tte.animations),this._animationsReady=!0,this.checkReady())}loadFigureData(){const e=st.getValue("avatar.default.figuredata");if(!e||typeof e=="string"){ze.error("XML figuredata is no longer supported");return}this._structure&&this._structure.initFigureData(e),new Lf(st.getValue("avatar.figuredata.url"),this._structure.figureData).addEventListener(Lf.AVATAR_STRUCTURE_DONE,this.onAvatarStructureDownloadDone)}onAvatarStructureDownloadDone(e){this._structureReady=!0,this._structure.init(),this.checkReady()}onAvatarAssetDownloaderReady(e){e&&(this._figureMapReady=!0,this.checkReady())}onAvatarAssetDownloaded(e){e&&this._aliasCollection.reset()}onEffectAssetDownloaderReady(e){e&&(this._effectMapReady=!0,this.checkReady())}onEffectAssetDownloaded(e){e&&this._aliasCollection.reset()}checkReady(){this._isReady||!this._geometryReady||!this._partSetsReady||!this._actionsReady||!this._animationsReady||!this._figureMapReady||!this._effectMapReady||!this._structureReady||(this._isReady=!0,this.events&&this.events.dispatchEvent(new _t(Ag.AVATAR_RENDER_READY)))}createFigureContainer(e){return new Ed(e)}isFigureContainerReady(e){return this._avatarAssetDownloadManager?this._avatarAssetDownloadManager.isAvatarFigureContainerReady(e):!1}createAvatarImage(e,t,i,r=null,n=null){if(!this._structure||!this._avatarAssetDownloadManager)return null;const o=new Ed(e);return i&&this.validateAvatarFigure(o,i),this._avatarAssetDownloadManager.isAvatarFigureContainerReady(o)?new jf(this._structure,this._aliasCollection,o,t,this._effectAssetDownloadManager,n):(this._placeHolderFigure||(this._placeHolderFigure=new Ed(HI.DEFAULT_FIGURE)),this._avatarAssetDownloadManager.downloadAvatarFigure(o,r),new rte(this._structure,this._aliasCollection,this._placeHolderFigure,t,this._effectAssetDownloadManager))}downloadAvatarFigure(e,t){this._avatarAssetDownloadManager&&this._avatarAssetDownloadManager.downloadAvatarFigure(e,t)}validateAvatarFigure(e,t){let i=!1;const r=this._structure.getMandatorySetTypeIds(t,2);if(r){const n=this._structure.figureData;for(const o of r)if(e.hasPartType(o)){const l=n.getSetType(o);if(l&&!l.getPartSet(e.getPartSetId(o))){const u=this._structure.getDefaultPartSet(o,t);u&&(e.updatePart(o,u.id,[0]),i=!0)}}else{const l=this._structure.getDefaultPartSet(o,t);l&&(e.updatePart(o,l.id,[0]),i=!0)}}return!i}getFigureClubLevel(e,t,i=null){if(!this._structure)return 0;const r=this._structure.figureData,n=Array.from(e.getPartTypeIds());let o=0;for(const l of n){const c=r.getSetType(l);if(!c)continue;const u=e.getPartSetId(l),d=c.getPartSet(u);if(d){o=Math.max(d.clubLevel,o);const _=r.getPalette(c.paletteID),m=e.getPartColorIds(l);for(const f of m){const E=_.getColor(f);E&&(o=Math.max(E.clubLevel,o))}}}i||(i=this._structure.getBodyPartsUnordered(ki.FULL));for(const l of i){const c=r.getSetType(l);c&&n.indexOf(l)===-1&&(o=Math.max(c.optionalFromClubLevel(t),o))}return o}isValidFigureSetForGender(e,t){const r=this.structureData.getFigurePartSet(e);return!!(r&&(r.gender.toUpperCase()==="U"||r.gender.toUpperCase()===t.toUpperCase()))}getFigureStringWithFigureIds(e,t,i){const r=new Sl;r.loadAvatarData(e,t);const n=this.resolveFigureSets(i);for(const o of n)r.savePartData(o.type,o.id,r.getColourIds(o.type));return r.getFigureString()}resolveFigureSets(e){const t=this.structureData,i=[];for(const r of e){const n=t.getFigurePartSet(r);n&&i.push(n)}return i}getMandatoryAvatarPartSetIds(e,t){return this._structure?this._structure.getMandatorySetTypeIds(e,t):null}getAssetByName(e){return this._aliasCollection.getAsset(e)}get assets(){return vr()}get isReady(){return this._isReady}get structure(){return this._structure}get structureData(){return this._structure?this._structure.figureData:null}get downloadManager(){return this._avatarAssetDownloadManager}get effectDownloadManager(){return this._effectAssetDownloadManager}};HI.DEFAULT_FIGURE="hd-99999-99999";let YO=HI;class nf{constructor(e,t,i){this._layerId=e,this._partId=t,this._paletteId=i}get layerId(){return this._layerId}set layerId(e){this._layerId=e}get partId(){return this._partId}set partId(e){this._partId=e}get paletteId(){return this._paletteId}set paletteId(e){this._paletteId=e}}class Vo{constructor(e){this._typeId=this.getTypeId(e),this._paletteId=this.getPaletteId(e),this._color=this.getColor(e),this._headOnly=this.getHeadOnly(e);const t=this.getCustomData(e);this._customLayerIds=this.getCustomLayerIds(t),this._customPartIds=this.getCustomPartIds(t),this._customPaletteIds=this.getCustomPaletteIds(t),this._customParts=[];let i=0;for(;i<this._customLayerIds.length;)this._customParts.push(new nf(this._customLayerIds[i],this._customPartIds[i],this._customPaletteIds[i])),i++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get customLayerIds(){return this._customLayerIds}get customPartIds(){return this._customPartIds}get customPaletteIds(){return this._customPaletteIds}get customParts(){return this._customParts}getCustomPart(e){if(this._customParts){for(const t of this._customParts)if(t.layerId===e)return t}return null}get hasCustomParts(){return this._customLayerIds!=null&&this._customLayerIds.length>0}get headOnly(){return this._headOnly}get figureString(){let e=this.typeId+" "+this.paletteId+" "+this.color.toString(16);e=e+(" "+this.customParts.length);for(const t of this.customParts)e=e+(" "+t.layerId+" "+t.partId+" "+t.paletteId);return e}getCustomData(e){let t=[];if(e){const i=e.split(" "),r=this._headOnly?1:0,n=4+r;if(i.length>n){const o=3+r,l=parseInt(i[o]);t=i.slice(n,n+l*3)}}return t}getCustomLayerIds(e){const t=[];let i=0;for(;i<e.length;)t.push(parseInt(e[i+0])),i=i+3;return t}getCustomPartIds(e){const t=[];let i=0;for(;i<e.length;)t.push(parseInt(e[i+1])),i=i+3;return t}getCustomPaletteIds(e){const t=[];let i=0;for(;i<e.length;)t.push(parseInt(e[i+2])),i=i+3;return t}getTypeId(e){if(e){const t=e.split(" ");if(t.length>=1)return parseInt(t[0])}return 0}getPaletteId(e){if(e){const t=e.split(" ");if(t.length>=2)return parseInt(t[1])}return 0}getColor(e){if(e){const t=e.split(" ");if(t.length>=3)return parseInt(t[2],16)}return 16777215}getHeadOnly(e){if(e){const t=e.split(" ");if(t.length>=4)return t[3]==="head"}return!1}}class RT{constructor(e){this._complete=!0,this._target=e}get running(){return this._running&&!!this._target}get complete(){return this._complete}set target(e){this._target=e}get target(){return this._target}set tag(e){this._tag=e}get tag(){return this._tag}start(){this._running=!0}update(e){}stop(){this._target=null,this._running=!1}tick(e){}}class nte extends RT{constructor(e){super(e)}tick(e){super.tick(e),this.target&&(this.target.remove(),this.target=null)}}class MN extends RT{constructor(e,t){super(e),this._complete=!1,this._duration=t}get duration(){return this._duration}start(){super.start(),this._complete=!1,this._startTimeMs=nt()}tick(e){super.tick(e);const t=(e-this._startTimeMs)/this._duration;t<1?this.update(t):(this.update(1),this._complete=!0)}}class ate extends MN{constructor(e,t,i){super(e,t),this._height=i}start(){super.start(),this._offset=0,this.target.style.top=this._offset-this._height+"px"}update(e){super.update(e),this.target.style.top=this._offset-this._height+this.getBounceOffset(e)*this._height+"px"}getBounceOffset(e){return e<.364?7.5625*e*e:e<.727?(e=e-.545,7.5625*e*e+.75):e<.909?(e=e-.9091,7.5625*e*e+.9375):(e=e-.955,7.5625*e*e+.984375)}stop(){this.target.style.top=this._offset+"px",super.stop()}}class ote extends MN{constructor(e){super(e.target,e.duration),this._interval=e}start(){super.start(),this._interval.start()}update(e){super.update(e),this._interval.update(e)}stop(){super.stop(),this._interval.stop()}}class lte extends ote{constructor(e,t){super(e),this._rate=t}}class cte extends lte{constructor(e,t){super(e,t)}update(e){this._interval.update(Math.pow(e,1/this._rate))}}class ute extends MN{constructor(e,t,i,r,n,o){super(e,t),this._deltaX=i,this._deltaY=r,this._height=-n,this._numJumps=o}start(){super.start(),this._startX=this.target.offsetLeft,this._startY=this.target.offsetTop}update(e){super.update(e),this.target.style.left=this._startX+this._deltaX*e+"px",this.target.style.top=this._startY+this._height*Math.abs(Math.sin(e*Math.PI*this._numJumps))+this._deltaY*e+"px"}}const ft=class ft{static get TIMER_TIME(){return 1e3/vS()}static runMotion(e){return ft._RUNNING_MOTIONS.indexOf(e)===-1&&ft._QUEUED_MOTIONS.indexOf(e)===-1&&(ft._IS_UPDATING?ft._QUEUED_MOTIONS.push(e):(ft._RUNNING_MOTIONS.push(e),e.start()),ft.startTimer()),e}static removeMotion(e){let t=ft._RUNNING_MOTIONS.indexOf(e);t>-1?ft._IS_UPDATING?(t=ft._REMOVED_MOTIONS.indexOf(e),t==-1&&ft._REMOVED_MOTIONS.push(e)):(ft._RUNNING_MOTIONS.splice(t,1),e.running&&e.stop(),ft._RUNNING_MOTIONS.length||ft.stopTimer()):(t=ft._QUEUED_MOTIONS.indexOf(e),t>-1&&ft._QUEUED_MOTIONS.splice(t,1))}static getMotionByTag(e){for(const t of ft._RUNNING_MOTIONS)if(t.tag==e)return t;for(const t of ft._QUEUED_MOTIONS)if(t.tag==e)return t;return null}static getMotionByTarget(e){for(const t of ft._RUNNING_MOTIONS)if(t.target==e)return t;for(const t of ft._QUEUED_MOTIONS)if(t.target==e)return t;return null}static getMotionByTagAndTarget(e,t){for(const i of ft._RUNNING_MOTIONS)if(i.tag==e&&i.target==t)return i;for(const i of ft._QUEUED_MOTIONS)if(i.tag==e&&i.target==t)return i;return null}static get isRunning(){return!!ft._TIMER}static get isUpdating(){return ft._IS_UPDATING}static onTick(){ft._IS_UPDATING=!0;const e=nt();let t=null;for(;t=ft._QUEUED_MOTIONS.pop();)ft._RUNNING_MOTIONS.push(t);for(;t=ft._REMOVED_MOTIONS.pop();)ft._RUNNING_MOTIONS.splice(ft._RUNNING_MOTIONS.indexOf(t),1),t.running&&t.stop();for(t of ft._RUNNING_MOTIONS)t.running?(t.tick(e),t.complete&&ft.removeMotion(t)):ft.removeMotion(t);ft._RUNNING_MOTIONS.length||ft.stopTimer(),ft._IS_UPDATING=!1}static startTimer(){ft._TIMER||(ft._TIMER=setInterval(ft.onTick,ft.TIMER_TIME))}static stopTimer(){ft._TIMER&&(clearInterval(ft._TIMER),ft._TIMER=null)}getNumRunningMotions(e){let t=0;for(const i of ft._RUNNING_MOTIONS)i.target===e&&t++;return t}};ft._QUEUED_MOTIONS=[],ft._RUNNING_MOTIONS=[],ft._REMOVED_MOTIONS=[],ft._TIMER=null,ft._IS_UPDATING=!1;let p_=ft;class Jb extends RT{constructor(...e){super(e?e[0].target:null),this._queue=[];for(const t of e)this._queue.push(t);this._motion=e[0],this._complete=!this._motion}get running(){return this._running&&this._motion?this._motion.running:!1}start(){super.start(),this._motion.start()}update(e){super.update(e),this._motion.running&&this._motion.update(e)}stop(){super.stop(),this._motion.stop()}tick(e){if(super.tick(e),this._motion.tick(e),this._motion.complete){this._motion.stop();const t=this._queue.indexOf(this._motion);t<this._queue.length-1?(this._motion=this._queue[t+1],this._target=this._motion.target,this._motion.start()):this._complete=!0}}}class hte extends RT{constructor(e){super(null),this._waitTimeMs=e}get running(){return this._running}start(){super.start(),this._complete=!1,this._startTimeMs=nt()}tick(e){super.tick(e),this._complete=e-this._startTimeMs>=this._waitTimeMs,this._complete&&this.stop()}}class dte{constructor(e){this._isTracking=!1,this._requestId=0,this._interval=0,this._reportIndex=0,this._reportDelta=0,this._lastTestTime=0,this._lastAverageLatency=0,this._latencies=[],this._latencyMap=new Map,this._trackingService=e}dispose(){this.disposed||(this._isTracking=!1,this._latencyMap.clear(),this._latencies=[],this._trackingService=null)}init(){this._interval=2e3,this._reportIndex=100,this._reportDelta=3,!(this._interval<1)&&(this._trackingService.registerMessageEvent(new eM(this.onPingResponse.bind(this))),this._isTracking=!0)}update(e,t){this._isTracking&&e-this._lastTestTime>this._interval&&this.testLatency(t)}testLatency(e){this._lastTestTime=Date.now(),this._latencyMap.set(this._requestId,{latency:this._lastTestTime,type:e}),this._trackingService.connection.send(new gU(this._requestId)),this._requestId++}onPingResponse(e){const t=e.getParser();if(!t)return;const i=this._latencyMap.get(t.requestId);if(i===void 0)return;const r=i.latency,n=i.type;this._latencyMap.delete(t.requestId);const o=Date.now()-r;this._trackingService.connection.send(new mU(o,0,0,n))}get disposed(){return this._trackingService===null}}class _te{constructor(e){this._value=e}get value(){return this._value}}class gte{constructor(e,t){this._header=e,this._buffer=t}readBytes(e){return this._buffer?this._buffer.readBytes(e):null}readByte(){return this._buffer?this._buffer.readByte():-1}readBoolean(){return this.readByte()===1}readShort(){return this._buffer?this._buffer.readShort():-1}readInt(){return this._buffer?this._buffer.readInt():-1}readFloat(){return this._buffer?this._buffer.readFloat():-1}readDouble(){return this._buffer?this._buffer.readDouble():-1}readString(){const e=this.readShort();return this._buffer.readBytes(e).toString("utf8")}readLargeString(){const e=this.readInt();return this._buffer.readBytes(e).toString("utf8")}get header(){return this._header}get bytesAvailable(){return this._buffer&&this._buffer.remaining()>0}}class mte{constructor(e){this._value=e}get value(){return this._value}}class fte{encode(e,t){const i=new YA;i.writeShort(e);for(const n of t){let o=typeof n;switch(o==="object"&&(n===null?o="null":n instanceof _te?o="byte":n instanceof mte?o="short":n instanceof ArrayBuffer?o="arraybuffer":n instanceof aC&&(o="largestring")),o){case"undefined":case"null":i.writeShort(0);break;case"byte":i.writeByte(n.value);break;case"short":i.writeShort(n.value);break;case"number":i.writeInt(n);break;case"boolean":i.writeByte(n?1:0);break;case"string":n?i.writeString(n,!0):i.writeShort(0);break;case"largestring":n?i.writeLargeString(n.value,!0):i.writeInt(0);break;case"arraybuffer":i.writeBytes(n);break}}const r=i.getBuffer();return r?new YA().writeInt(r.byteLength).writeBytes(r):null}decode(e){if(!e||!e.dataBuffer||!e.dataBuffer.byteLength)return null;const t=[];for(;e.dataBuffer.byteLength&&!(e.dataBuffer.byteLength<4);){const i=new sT(e.dataBuffer),r=i.readInt();if(r>e.dataBuffer.byteLength-4)break;const n=i.readBytes(r);t.push(new gte(n.readShort(),n)),e.dataBuffer=e.dataBuffer.slice(r+4)}return t}}class pte{constructor(){this._messageIdByEvent=new Map,this._messageIdByComposer=new Map,this._messageInstancesById=new Map}dispose(){this._messageIdByEvent.clear(),this._messageIdByComposer.clear(),this._messageInstancesById.clear()}registerMessages(e){for(const[t,i]of e.events)this.registerMessageEventClass(t,i);for(const[t,i]of e.composers)this.registerMessageComposerClass(t,i)}registerMessageEventClass(e,t){!e||!t||this._messageIdByEvent.set(t,e)}registerMessageComposerClass(e,t){!e||!t||this._messageIdByComposer.set(t,e)}registerMessageEvent(e){if(!e)return;const t=this.getEventId(e);if(!t)return;let i=this._messageInstancesById.get(t);(!i||!i.length)&&(i=[],this._messageInstancesById.set(t,i)),i.push(e)}removeMessageEvent(e){if(!e)return;const t=this.getEventId(e);if(!t)return;const i=this._messageInstancesById.get(t);if(i){for(const[r,n]of i.entries())if(n&&n===e){i.splice(r,1),i.length===0&&this._messageInstancesById.delete(t),n.dispose();return}}}getEvents(e){if(!e)return;const t=this._messageInstancesById.get(e);if(t)return t}getEventId(e){if(!e)return-1;const t=e instanceof w?e.constructor:e,i=this._messageIdByEvent.get(t);return i||-1}getComposerId(e){if(!e)return-1;const t=this._messageIdByComposer.get(e.constructor);return t||-1}}class Ete extends Sn{constructor(e,t){super(),this._communicationManager=e,this._stateListener=t,this._socket=null,this._messages=new pte,this._codec=new fte,this._dataBuffer=null,this._isReady=!1,this._pendingClientMessages=[],this._pendingServerMessages=[],this._isAuthenticated=!1,this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onError=this.onError.bind(this),this.onMessage=this.onMessage.bind(this)}init(e){this._stateListener&&this._stateListener.connectionInit(e),this.createSocket(e)}onDispose(){super.onDispose(),this.destroySocket(),this._communicationManager=null,this._stateListener=null,this._messages=null,this._codec=null,this._dataBuffer=null}onReady(){this._isReady||(this._isReady=!0,this._pendingServerMessages&&this._pendingServerMessages.length&&this.processWrappers(...this._pendingServerMessages),this._pendingClientMessages&&this._pendingClientMessages.length&&this.send(...this._pendingClientMessages),this._pendingServerMessages=[],this._pendingClientMessages=[])}createSocket(e){e&&(this.destroySocket(),this._dataBuffer=new ArrayBuffer(0),this._socket=new WebSocket(e),this._socket.addEventListener(to.CONNECTION_OPENED,this.onOpen),this._socket.addEventListener(to.CONNECTION_CLOSED,this.onClose),this._socket.addEventListener(to.CONNECTION_ERROR,this.onError),this._socket.addEventListener(to.CONNECTION_MESSAGE,this.onMessage))}destroySocket(){this._socket&&(this._socket.removeEventListener(to.CONNECTION_OPENED,this.onOpen),this._socket.removeEventListener(to.CONNECTION_CLOSED,this.onClose),this._socket.removeEventListener(to.CONNECTION_ERROR,this.onError),this._socket.removeEventListener(to.CONNECTION_MESSAGE,this.onMessage),this._socket.readyState===WebSocket.OPEN&&this._socket.close(),this._socket=null)}onOpen(e){this.dispatchConnectionEvent(er.CONNECTION_OPENED,e)}onClose(e){this.dispatchConnectionEvent(er.CONNECTION_CLOSED,e)}onError(e){this.dispatchConnectionEvent(er.CONNECTION_ERROR,e)}onMessage(e){if(!e)return;const t=new FileReader;t.readAsArrayBuffer(e.data),t.onloadend=()=>{this._dataBuffer=this.concatArrayBuffers(this._dataBuffer,t.result),this.processReceivedData()}}dispatchConnectionEvent(e,t){this.dispatchEvent(new er(e,this,t))}authenticated(){this._isAuthenticated=!0}send(...e){if(this.disposed||!e)return!1;if(e=[...e],this._isAuthenticated&&!this._isReady)return this._pendingClientMessages||(this._pendingClientMessages=[]),this._pendingClientMessages.push(...e),!1;for(const t of e){if(!t)continue;const i=this._messages.getComposerId(t);if(i===-1){ze.packets("Unknown Composer",t.constructor.name);continue}const r=t.getMessageArray(),n=this._codec.encode(i,r);if(!n){ze.packets("Encoding Failed",t.constructor.name);continue}ze.packets("OutgoingComposer",i,t.constructor.name,r),this.write(n.getBuffer())}return!0}write(e){this._socket.readyState===WebSocket.OPEN&&this._socket.send(e)}processReceivedData(){try{this.processData()}catch(e){ze.error(e)}}processData(){const e=this.splitReceivedMessages();if(!(!e||!e.length)){if(this._isAuthenticated&&!this._isReady){this._pendingServerMessages||(this._pendingServerMessages=[]),this._pendingServerMessages.push(...e);return}this.processWrappers(...e)}}processWrappers(...e){if(!(!e||!e.length))for(const t of e){if(!t)continue;const i=this.getMessagesForWrapper(t);!i||!i.length||(ze.packets("IncomingMessage",t.header,i[0].constructor.name,i[0].parser),this.handleMessages(...i))}}splitReceivedMessages(){return!this._dataBuffer||!this._dataBuffer.byteLength?null:this._codec.decode(this)}concatArrayBuffers(e,t){const i=new Uint8Array(e.byteLength+t.byteLength);return i.set(new Uint8Array(e),0),i.set(new Uint8Array(t),e.byteLength),i.buffer}getMessagesForWrapper(e){if(!e)return null;const t=this._messages.getEvents(e.header);if(!t||!t.length){ze.packets("IncomingMessage",e.header,"UNREGISTERED",e);return}try{const i=new t[0].parserClass;if(!i||!i.flush()||!i.parse(e))return null;for(const r of t)r.parser=i}catch(i){return ze.error("Error parsing message",i,t[0].constructor.name),null}return t}handleMessages(...e){e=[...e];for(const t of e)t&&(t.connection=this,t.callBack&&t.callBack(t))}registerMessages(e){e&&this._messages.registerMessages(e)}addMessageEvent(e){!e||!this._messages||this._messages.registerMessageEvent(e)}removeMessageEvent(e){!e||!this._messages||this._messages.removeMessageEvent(e)}get isAuthenticated(){return this._isAuthenticated}get dataBuffer(){return this._dataBuffer}set dataBuffer(e){this._dataBuffer=e}}class Ite extends Qr{constructor(){super(),this._connections=[]}onDispose(){if(!(!this._connections||!this._connections.length))for(const e of this._connections.values())e&&e.dispose()}createConnection(e=null){const t=new Ete(this,e);if(t)return this._connections.push(t),t}update(e){let t=0;for(;t<this._connections.length;){const i=this._connections[t];if(i.processReceivedData(),this.disposed)return;i.disposed?this._connections.splice(t,1):t++}}}const WI=class WI extends _t{constructor(e){super(e)}};WI.LOADED="NCE_LOADED",WI.FAILED="NCE_FAILED";let ha=WI;class Tte extends Wo{constructor(){super(),this._definitions=new Map,this._config=[],this._pendingUrls=[],this._missingKeys=[],this.onConfigurationLoaded=this.onConfigurationLoaded.bind(this)}onInit(){st.parseConfiguration(this.getDefaultConfig(),!0),this._pendingUrls=st.getValue("config.urls").slice(),this.loadNextConfiguration()}loadNextConfiguration(){if(!this._pendingUrls.length){this.dispatchConfigurationEvent(ha.LOADED);return}this.loadConfigurationFromUrl(this._pendingUrls[0])}loadConfigurationFromUrl(e){if(!e||e===""){this.dispatchConfigurationEvent(ha.FAILED);return}fetch(e).then(t=>t.json()).then(t=>this.onConfigurationLoaded(t,e)).catch(t=>this.onConfigurationFailed(t))}onConfigurationLoaded(e,t){if(e){if(st.parseConfiguration(e)){const i=this._pendingUrls.indexOf(t);i>=0&&this._pendingUrls.splice(i,1),this.loadNextConfiguration();return}this.dispatchConfigurationEvent(ha.FAILED)}}onConfigurationFailed(e){this.dispatchConfigurationEvent(ha.FAILED)}dispatchConfigurationEvent(e){this.events&&this.events.dispatchEvent(new ha(e))}getDefaultConfig(){return NitroConfig}}const ac=class ac{static sayHello(){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){const e=[`
 %c %c %c Nitro ${ac.UI_VERSION} - Renderer ${ac.RENDERER_VERSION} %c %c %c https://discord.nitrodev.co %c %c 

`,"background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","color: #ffffff; background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;"];self.console.log(...e)}else self.console&&self.console.log(`Nitro ${ac.UI_VERSION} - Renderer ${ac.RENDERER_VERSION} `)}};ac.RENDERER_VERSION="1.6.6",ac.UI_VERSION="";let Bd=ac;class Ste extends Qr{constructor(){super(),Bd.sayHello(),this._configuration=new Tte,this._communication=new Ite}onDispose(){this._communication&&(this._communication.dispose(),this._communication=null)}get configuration(){return this._configuration}get communication(){return this._communication}}const q=a=>{const{ref:e=null,innerRef:t=null,display:i=null,fit:r=!1,fitV:n=!1,grow:o=!1,shrink:l=!1,fullWidth:c=!1,fullHeight:u=!1,overflow:d=null,position:_=null,float:m=null,pointer:f=!1,visible:E=null,textColor:I=null,classNames:p=[],className:S="",style:R={},children:O=null,...C}=a,A=h.useMemo(()=>{const M=[];return i&&i.length&&M.push("d-"+i),(r||c)&&M.push("w-100"),(r||u)&&M.push("h-100"),n&&M.push("vw-100","vh-100"),o&&M.push("flex-grow-1"),l&&M.push("flex-shrink-0"),d&&M.push("overflow-"+d),_&&M.push("position-"+_),m&&M.push("float-"+m),f&&M.push("cursor-pointer"),E!==null&&M.push(E?"visible":"invisible"),I&&M.push("text-"+I),p.length&&M.push(...p),M},[i,r,n,o,l,c,u,d,_,m,f,E,I,p]),b=h.useMemo(()=>{let M=A.join(" ");return S.length&&(M+=" "+S),M.trim()},[A,S]),y=h.useMemo(()=>{let M={};return Object.keys(R).length&&(M={...M,...R}),M},[R]);return s.jsx("div",{ref:t,className:b,style:y,...C,children:O})},yG=h.createContext({isCssGrid:!1}),Rte=a=>s.jsx(yG.Provider,{value:a.value,children:a.children}),xte=()=>h.useContext(yG),zO=h.forwardRef((a,e)=>s.jsx(Ye,{...a,innerRef:e}));zO.displayName="GridWithRef";const Ye=a=>{const{inline:e=!1,gap:t=2,maxContent:i=!1,columnCount:r=0,center:n=!1,alignSelf:o=null,alignItems:l=null,justifyContent:c=null,fullHeight:u=!0,classNames:d=[],style:_={},...m}=a,f=h.useMemo(()=>{const I=[];return e?I.push("inline-grid"):I.push("grid"),t?I.push("gap-"+t):t===0&&I.push("gap-0"),i&&I.push("flex-basis-max-content"),o&&I.push("align-self-"+o),l&&I.push("align-items-"+l),c&&I.push("justify-content-"+c),!l&&!c&&n&&I.push("align-items-center","justify-content-center"),d.length&&I.push(...d),I},[e,t,i,o,l,c,n,d]),E=h.useMemo(()=>{let I={};return r&&(I["--bs-columns"]=r.toString()),Object.keys(_).length&&(I={...I,..._}),I},[r,_]);return s.jsx(Rte,{value:{isCssGrid:!0},children:s.jsx(q,{fullHeight:u,classNames:f,style:E,...m})})},Os=a=>{const{columnMinWidth:e=40,columnMinHeight:t=40,columnCount:i=0,fullHeight:r=!1,maxContent:n=!0,overflow:o="auto",style:l={},...c}=a,u=h.useMemo(()=>{let d={};return d["--nitro-grid-column-min-height"]=t+"px",i>1&&(d.gridTemplateColumns=`repeat(auto-fill, minmax(${e}px, 1fr))`),Object.keys(l).length&&(d={...d,...l}),d},[e,t,i,l]);return s.jsx(Ye,{columnCount:i,fullHeight:r,overflow:o,style:u,...c})},x=a=>{const{display:e="flex",column:t=void 0,reverse:i=!1,gap:r=null,center:n=!1,alignSelf:o=null,alignItems:l=null,justifyContent:c=null,classNames:u=[],...d}=a,_=h.useMemo(()=>{const m=[];return t?i?m.push("flex-column-reverse"):m.push("flex-column"):i&&m.push("flex-row-reverse"),r&&m.push("gap-"+r),o&&m.push("align-self-"+o),l&&m.push("align-items-"+l),c&&m.push("justify-content-"+c),!l&&!c&&n&&m.push("align-items-center","justify-content-center"),u.length&&m.push(...u),m},[t,i,r,n,o,l,c,u]);return s.jsx(q,{display:e,classNames:_,...d})},X=a=>{const{variant:e="primary",size:t="sm",active:i=!1,disabled:r=!1,classNames:n=[],...o}=a,l=h.useMemo(()=>{const c=["btn"];return e&&c.push("btn-"+e),t&&c.push("btn-"+t),i&&c.push("active"),r&&c.push("disabled"),n.length&&c.push(...n),c},[e,t,i,r,n]);return s.jsx(x,{center:!0,classNames:l,...o})},Ya=a=>{const{classNames:e=[],...t}=a,i=h.useMemo(()=>{const r=["btn-group"];return e.length&&r.push(...e),r},[e]);return s.jsx(q,{classNames:i,...t})},Ote=h.createContext({closers:null,setClosers:null,closeAll:null}),Cte=a=>s.jsx(Ote.Provider,{...a}),jN=a=>{const{alignItems:e="center",gap:t=1,children:i=null,...r}=a;return s.jsx(x,{alignItems:e,gap:t,...r,children:i})},Nte=a=>{const{...e}=a,[t,i]=h.useState([]),r=h.useCallback(()=>{for(const n of t)n()},[t]);return s.jsx(Cte,{value:{closers:t,setClosers:i,closeAll:r},children:s.jsx(N,{gap:0,...e})})},be=a=>{const{overflow:e="auto",classNames:t=[],...i}=a,r=h.useMemo(()=>{const n=["container-fluid","content-area"];return t.length&&n.push(...t),n},[t]);return s.jsx(N,{classNames:r,overflow:e,...i})},Ate=h.createContext({theme:null}),bte=a=>s.jsx(Ate.Provider,{value:a.value,children:a.children}),je=a=>{const{headerText:e=null,isGalleryPhoto:t=!1,noCloseButton:i=!1,onReportPhoto:r=null,onCloseClick:n=null,justifyContent:o="center",alignItems:l="center",classNames:c=[],children:u=null,...d}=a,_=h.useMemo(()=>{const f=["drag-handler","container-fluid","nitro-card-header"];return c.length&&f.push(...c),f},[c]),m=f=>{f.stopPropagation(),f.nativeEvent.stopImmediatePropagation()};return s.jsx(N,{center:!0,position:"relative",classNames:_,...d,children:s.jsxs(x,{fullWidth:!0,center:!0,children:[s.jsx("span",{className:"nitro-card-header-text",children:e}),t&&s.jsx(q,{position:"absolute",className:"end-4 nitro-card-header-report-camera d-flex justify-content-center align-items-center",onClick:r,style:{marginRight:"8px"},children:s.jsx(oV,{className:"fa-icon"})}),u,s.jsx(x,{center:!0,position:"absolute",className:"end-2 nitro-card-header-close",onMouseDownCapture:m,onClick:n,children:s.jsx(pr,{className:"fa-icon w-12 h-12"})})]})})},DG=a=>{const{justifyContent:e="center",classNames:t=[],variant:i="muted",...r}=a,n=h.useMemo(()=>{const o=["container-fluid","p-1"];return t.length&&o.push(...t),o.push("bg-"+i),o},[t,i]);return s.jsx(x,{justifyContent:e,classNames:n,...r})},gd=class gd{};gd.CENTER="DWP_CENTER",gd.TOP_CENTER="DWP_TOP_CENTER",gd.TOP_LEFT="DWP_TOP_LEFT",gd.NOTHING="DWP_NOTHING";let Vi=gd;const Ko=[],Zb=0,ev=0,jc=a=>{const{uniqueKey:e=null,handleSelector:t=".drag-handler",windowPosition:i=Vi.CENTER,disableDrag:r=!1,dragStyle:n={},children:o=null,offsetLeft:l=0,offsetTop:c=0,dragClass:u=""}=a,[d,_]=h.useState(null),[m,f]=h.useState(null),[E,I]=h.useState({x:0,y:0}),[p,S]=h.useState(!1),[R,O]=h.useState(null),C=h.useRef(),A=h.useCallback(()=>{let W=400;for(const V of Ko)W+=1,V.style.zIndex=W.toString()},[]),b=h.useCallback(()=>{const W=Ko.indexOf(C.current);if(W===-1)Ko.push(C.current);else{if(W===Ko.length-1)return;W>=0&&(Ko.splice(W,1),Ko.push(C.current))}A()},[A]),y=h.useCallback(W=>{b()},[b]),M=h.useCallback(W=>{b()},[b]),U=h.useCallback((W,V)=>{I({x:W,y:V}),S(!0)},[]),G=h.useCallback(W=>{U(W.clientX,W.clientY)},[U]),F=h.useCallback(W=>{const V=W.touches[0];U(V.clientX,V.clientY)},[U]),H=h.useCallback(W=>{_({x:W.clientX-E.x,y:W.clientY-E.y})},[E]),v=h.useCallback(W=>{const V=W.touches[0];_({x:V.clientX-E.x,y:V.clientY-E.y})},[E]),B=h.useCallback(()=>{if(!C.current||!R)return;let W=m.x+d.x,V=m.y+d.y;const se=C.current.offsetLeft+W,ee=C.current.offsetTop+V;if(ee<Zb?V=-C.current.offsetTop:ee+R.offsetHeight>=document.body.offsetHeight-Zb&&(V=document.body.offsetHeight-C.current.offsetHeight-C.current.offsetTop),se+C.current.offsetWidth<ev?W=-C.current.offsetLeft:se>=document.body.offsetWidth-ev&&(W=document.body.offsetWidth-C.current.offsetWidth-C.current.offsetLeft),_({x:0,y:0}),f({x:W,y:V}),S(!1),e!==null){const ie={...Kg(`nitro.windows.${e}`)};ie.offset={x:W,y:V},bk(`nitro.windows.${e}`,ie)}},[R,d,m,e]),z=h.useCallback(W=>{B()},[B]),$=h.useCallback(W=>{B()},[B]);return h.useEffect(()=>{const W=C.current;if(!W)return;if(Ko.push(W),A(),r)O(null);else{const ee=W.querySelector(t);ee&&O(ee)}let V=0,se=0;switch(i){case Vi.TOP_CENTER:W.style.top=50+c+"px",W.style.left=`calc(50vw - ${W.offsetWidth/2+l}px)`;break;case Vi.CENTER:W.style.top=`calc(50vh - ${W.offsetHeight/2+c}px)`,W.style.left=`calc(50vw - ${W.offsetWidth/2+l}px)`;break;case Vi.TOP_LEFT:W.style.top=50+c+"px",W.style.left=50+l+"px";break}return _({x:0,y:0}),f({x:V,y:se}),()=>{const ee=Ko.indexOf(W);ee>=0&&Ko.splice(ee,1)}},[t,i,e,r,l,c,A]),h.useEffect(()=>{if(!m&&!d)return;const W=C.current;W&&(W.style.transform=`translate(${m.x+d.x}px, ${m.y+d.y}px)`,W.style.visibility="visible")},[m,d]),h.useEffect(()=>{if(R)return R.addEventListener(Re.MOUSE_DOWN,G),R.addEventListener(Kr.TOUCH_START,F),()=>{R.removeEventListener(Re.MOUSE_DOWN,G),R.removeEventListener(Kr.TOUCH_START,F)}},[R,G,F]),h.useEffect(()=>{if(p)return document.addEventListener(Re.MOUSE_UP,z),document.addEventListener(Kr.TOUCH_END,$),document.addEventListener(Re.MOUSE_MOVE,H),document.addEventListener(Kr.TOUCH_MOVE,v),()=>{document.removeEventListener(Re.MOUSE_UP,z),document.removeEventListener(Kr.TOUCH_END,$),document.removeEventListener(Re.MOUSE_MOVE,H),document.removeEventListener(Kr.TOUCH_MOVE,v)}},[p,z,H,$,v]),h.useEffect(()=>{if(!e)return;const W=Kg(`nitro.windows.${e}`);!W||!W.offset||(_({x:0,y:0}),W.offset&&f(W.offset))},[e]),tC.createPortal(s.jsx(q,{position:"absolute",innerRef:C,className:`draggable-window ${u}`,onMouseDownCapture:y,onTouchStartCapture:M,style:n,children:o}),document.getElementById("draggable-windows-container"))},ve=a=>{const{theme:e="primary",uniqueKey:t=null,handleSelector:i=".drag-handler",windowPosition:r=Vi.CENTER,disableDrag:n=!1,overflow:o="hidden",position:l="relative",gap:c=0,classNames:u=[],...d}=a,_=h.useRef(),m=h.useMemo(()=>{const f=["nitro-card","rounded","shadow"];return f.push(`theme-${e||"primary"}`),u.length&&f.push(...u),f},[e,u]);return s.jsx(bte,{value:{theme:e},children:s.jsx(jc,{uniqueKey:t,handleSelector:i,windowPosition:r,disableDrag:n,children:s.jsx(N,{innerRef:_,overflow:o,position:l,gap:c,classNames:m,...d})})})},ls=a=>{const{figure:e="",gender:t="M",headOnly:i=!1,direction:r=0,scale:n=1,classNames:o=[],style:l={},...c}=a,[u,d]=h.useState(null),[_,m]=h.useState(-1),f=h.useRef(!1),E=h.useMemo(()=>{const p=["avatar-image"];return o.length&&p.push(...o),p},[o]),I=h.useMemo(()=>{let p={};return u&&u.length&&(p.backgroundImage=`url('${u}')`),n!==1&&(p.transform=`scale(${n})`,n%1||(p.imageRendering="pixelated")),Object.keys(l).length&&(p={...p,...l}),p},[u,n,l]);return h.useEffect(()=>{const p=qt().createAvatarImage(e,Hn.LARGE,t,{resetFigure:O=>{f.current||m(Math.random())},dispose:()=>{},disposed:!1},null);if(!p)return;let S=ki.FULL;i&&(S=ki.HEAD),p.setDirection(S,r);const R=p.getCroppedImage(S);R&&d(R.src),p.dispose()},[e,t,r,i,_]),h.useEffect(()=>(f.current=!1,()=>{f.current=!0}),[]),s.jsx(q,{classNames:E,style:I,...c})},MG=a=>{const{imageUrl:e=null,fit:t=!0,style:i=null,...r}=a,n=h.useMemo(()=>{const o={...i};return e&&(o.background=`url(${e}) center no-repeat`),o},[i,e]);return s.jsx(q,{fit:t,style:n,...r})},as=a=>{const{badgeCode:e=null,isGroup:t=!1,showInfo:i=!1,customTitle:r=null,isGrayscale:n=!1,scale:o=1,classNames:l=[],style:c={},children:u=null,...d}=a,[_,m]=h.useState(null),f=h.useMemo(()=>{const I=["badge-image"];return t&&I.push("group-badge"),n&&I.push("grayscale"),l.length&&I.push(...l),I},[l,t,n]),E=h.useMemo(()=>{let I={};return _&&(I.backgroundImage=`url(${t?_.src:xe("badge.asset.url").replace("%badgename%",e.toString())})`,I.width=_.width,I.height=_.height,o!==1&&(I.transform=`scale(${o})`,o%1||(I.imageRendering="pixelated"),I.width=_.width*o,I.height=_.height*o)),Object.keys(c).length&&(I={...I,...c}),I},[_,o,c]);return h.useEffect(()=>{if(!e||!e.length)return;let I=!1;const p=R=>{if(R.badgeId!==e)return;const O=Vt.generateImage(new Is(R.image));O.onload=()=>m(O),I=!0,te().events.removeEventListener(Nl.IMAGE_READY,p)};te().events.addEventListener(Nl.IMAGE_READY,p);const S=t?te().getGroupBadgeImage(e):te().getBadgeImage(e);if(S&&!I){const R=Vt.generateImage(new Is(S));R.onload=()=>m(R)}return()=>te().events.removeEventListener(Nl.IMAGE_READY,p)},[e,t]),s.jsxs(q,{classNames:f,style:E,...d,children:[i&&xe("badge.descriptions.enabled",!0)&&s.jsxs(q,{className:"badge-information text-black py-1 px-2 small",children:[s.jsx("div",{className:"fw-bold mb-1",children:t?r:$d(e)}),s.jsx("div",{children:t?g("group.badgepopup.body"):Em(e)})]}),u]})},vte=a=>{const{day:e="00",hour:t="00",minutes:i="00",seconds:r="00",classNames:n=[],children:o=null,...l}=a,c=h.useMemo(()=>{const u=["nitro-counter-time"];return n.length&&u.push(...n),u},[n]);return s.jsxs(x,{gap:1,children:[s.jsx(q,{classNames:c,...l,children:s.jsxs("div",{children:[e!="00"?e:t,e!="00"?g("countdown_clock_unit_days"):g("countdown_clock_unit_hours")]})}),s.jsx(q,{style:{marginTop:"3px"},children:":"}),s.jsx(q,{classNames:c,...l,children:s.jsxs("div",{children:[i,g("countdown_clock_unit_minutes")]})}),s.jsx(q,{style:{marginTop:"3px"},children:":"}),s.jsx(q,{classNames:c,...l,children:s.jsxs("div",{children:[r,g("countdown_clock_unit_seconds")]})}),o]})},gs=a=>{const{type:e="",classNames:t=[],style:i={},...r}=a,n=h.useMemo(()=>{const c=["nitro-currency-icon"];return t.length&&c.push(...t),c},[t]),o=h.useMemo(()=>{let c=xe("currency.asset.icon.url","");return c=c.replace("%type%",e.toString()),`url(${c})`},[e]),l=h.useMemo(()=>{let c={};return c.backgroundImage=o,Object.keys(i).length&&(c={...c,...i}),c},[i,o]);return s.jsx(q,{classNames:n,style:l,...r})},xT=a=>{const{productType:e="s",productClassId:t=-1,direction:i=2,extraData:r="",scale:n=1,style:o={},...l}=a,[c,u]=h.useState(null),d=h.useMemo(()=>{var m;let _={};return(m=c==null?void 0:c.src)!=null&&m.length&&(_.backgroundImage=`url('${c.src}')`,_.width=c.width,_.height=c.height),n!==1&&(_.transform=`scale(${n})`,n%1||(_.imageRendering="pixelated")),Object.keys(o).length&&(_={..._,...o}),_},[c,n,o]);return h.useEffect(()=>{let _=null;const m={imageReady:(f,E,I)=>{!I&&E&&(I=Vt.generateImage(E)),I.onload=()=>u(I)},imageFailed:null};switch(e.toLocaleLowerCase()){case dt.FLOOR:_=ce().getFurnitureFloorImage(t,new Y(i),64,m,0,r);break;case dt.WALL:_=ce().getFurnitureWallImage(t,new Y(i),64,m,0,r);break}if(_){const f=_.getImage();f.onload=()=>u(f)}},[e,t,i,r]),c?s.jsx(q,{classNames:["furni-image"],style:d,...l}):null},jG=a=>{const{figure:e=null,userName:t=null,message:i=null,editable:r=!1,onChange:n=null}=a;return s.jsxs(x,{overflow:"hidden",className:"nitro-gift-card text-black",children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-center gift-face flex-shrink-0",children:[!t&&s.jsx("div",{className:"gift-incognito"}),e&&s.jsx("div",{className:"gift-avatar",children:s.jsx(ls,{figure:e,direction:2,headOnly:!0})})]}),s.jsx(x,{overflow:"hidden",className:"w-100 pt-4 pb-4 pe-4 ps-3",children:s.jsxs(N,{grow:!0,overflow:"auto",justifyContent:"between",children:[!r&&s.jsx(T,{textBreak:!0,className:"gift-message",children:i}),r&&n!==null&&s.jsx("textarea",{className:"gift-message h-100",maxLength:140,value:i,onChange:o=>n(o.target.value),placeholder:g("catalog.gift_wrapping_new.message_hint")}),t&&s.jsx(T,{italics:!0,textEnd:!0,className:"pe-1",children:g("catalog.gift_wrapping_new.message_from",["name"],[t])})]})})]})},N=a=>{const{size:e=0,itemActive:t=!1,offset:i=0,column:r=!0,gap:n=2,classNames:o=[],...l}=a,{isCssGrid:c=!1}=xte(),u=h.useMemo(()=>{const d=[];if(e){let _=`col-${e}`;c&&(_=`g-${_}`),d.push(_)}if(t&&d.push("active"),i){let _=`offset-${i}`;c&&(_=`g-start-${i}`),d.push(_)}return o.length&&d.push(...o),d},[e,t,i,c,o]);return s.jsx(x,{classNames:u,column:r,gap:n,...l})},wo=a=>{const{count:e=0,position:t="absolute",classNames:i=[],children:r=null,...n}=a,o=h.useMemo(()=>{const l=["fw-bold","nitro-item-count"];return i.length&&l.push(...i),l},[i]);return s.jsxs(q,{position:"absolute",classNames:o,...n,children:[e,r]})},Vd=a=>{const{value:e=0}=a,t=e.toString().split("");return s.jsx(s.Fragment,{children:t.map((i,r)=>s.jsx("i",{className:"limited-edition-number n-"+i},r))})},LG=a=>{const{uniqueNumber:e=0,uniqueSeries:t=0,classNames:i=[],children:r=null,...n}=a,o=h.useMemo(()=>{const l=["unique-compact-plate","z-index-1"];return i.length&&l.push(...i),l},[i]);return s.jsxs(q,{classNames:o,...n,children:[s.jsx("div",{children:s.jsx(Vd,{value:e})}),s.jsx("div",{children:s.jsx(Vd,{value:t})}),r]})},yte=a=>{const{uniqueLimitedItemsLeft:e=0,uniqueLimitedSeriesSize:t=0,classNames:i=[],...r}=a,n=h.useMemo(()=>{const o=["unique-complete-plate"];return i.length&&o.push(...i),o},[i]);return s.jsx(q,{classNames:n,...r,children:s.jsxs(N,{className:"plate-container",gap:0,children:[s.jsxs(x,{justifyContent:"between",alignItems:"center",children:[g("unique.items.left"),s.jsx("div",{children:s.jsx(Vd,{value:e})})]}),s.jsxs(x,{justifyContent:"between",alignItems:"center",children:[g("unique.items.number.sold"),s.jsx("div",{children:s.jsx(Vd,{value:t})})]})]})})},ct=a=>{const{itemImage:e=void 0,itemColor:t=void 0,itemActive:i=!1,itemCount:r=1,itemCountMinimum:n=1,itemUniqueSoldout:o=!1,itemUniqueNumber:l=-2,itemUnseen:c=!1,itemHighlight:u=!1,disabled:d=!1,center:_=!0,column:m=!0,style:f={},classNames:E=[],position:I="relative",overflow:p="hidden",children:S=null,...R}=a,O=h.useMemo(()=>{const A=["layout-grid-item","border","border-2","border-muted","rounded"];return i&&A.push("active"),(o||l>0)&&A.push("unique-item"),o&&A.push("sold-out"),c&&A.push("unseen"),u&&A.push("has-highlight"),d&&A.push("disabled"),e===null&&A.push("icon","loading-icon"),E.length&&A.push(...E),A},[i,o,l,c,u,d,e,E]),C=h.useMemo(()=>{let A={...f};return e&&!(o||l>0)&&(A.backgroundImage=`url(${e})`),t&&(A.backgroundColor=t),Object.keys(f).length&&(A={...A,...f}),A},[f,e,t,o,l]);return s.jsxs(N,{center:_,pointer:!0,position:I,overflow:p,column:m,classNames:O,style:C,...R,children:[r>n&&s.jsx(wo,{count:r}),l>0&&s.jsxs(s.Fragment,{children:[s.jsx(q,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),s.jsx("div",{className:"position-absolute bottom-0 unique-item-counter",children:s.jsx(Vd,{value:l})})]}),S]})},Lc=a=>{const{imageUrl:e=null,className:t="",...i}=a;return s.jsx("img",{src:e,className:"no-select "+t,alt:"",...i})},LN=a=>{const{...e}=a;return s.jsxs(q,{classNames:["spinner-container"],...e,children:[s.jsx(q,{className:"spinner"}),s.jsx(q,{className:"spinner"}),s.jsx(q,{className:"spinner"})]})},Dte=a=>{const{roomId:e=-1,textureReceiver:t=null,onClose:i=null}=a,r=h.useRef(),n=()=>{if(!r||!r.current)return null;const l=r.current.getBoundingClientRect();return new Zy(Math.floor(l.x),Math.floor(l.y),Math.floor(l.width),Math.floor(l.height))},o=()=>{yl(Bo.CAMERA_SHUTTER),t(ce().createTextureFromRoom(e,1,n()))};return s.jsx(jc,{handleSelector:".nitro-room-thumbnail-camera",children:s.jsxs("div",{className:"nitro-room-thumbnail-camera px-2",children:[s.jsx("div",{ref:r,className:"camera-frame"}),s.jsxs("div",{className:"d-flex align-items-end h-100 pb-2",children:[s.jsx("button",{className:"btn btn-sm btn-danger w-100 mb-1 me-2",onClick:i,children:g("cancel")}),s.jsx("button",{className:"btn btn-sm btn-success w-100 mb-1",onClick:o,children:g("navigator.thumbeditor.save")})]})]})})},Jd=a=>{const{title:e="",onClose:t=null,classNames:i=[],children:r=null,type:n=lt.DEFAULT,...o}=a,l=h.useMemo(()=>{const c=["nitro-alert"];return c.push("nitro-alert-"+n),i.length&&c.push(...i),c},[i,n]);return s.jsxs(ve,{classNames:l,theme:"primary-slim",...o,children:[s.jsx(je,{headerText:e,onCloseClick:t}),s.jsx(be,{grow:!0,justifyContent:"between",overflow:"hidden",className:"text-black",gap:0,children:r})]})},Ro=class Ro{};Ro.BOUNCE="bounce",Ro.SLIDE_LEFT="slideLeft",Ro.SLIDE_RIGHT="slideRight",Ro.FLIP_X="flipX",Ro.FADE_IN="fadeIn",Ro.FADE_DOWN="fadeDown",Ro.FADE_UP="fadeUp",Ro.HEAD_SHAKE="headShake";let Nr=Ro;function Mte(a,e,t=300){switch(a){case Nr.BOUNCE:switch(e){default:return{};case Ul:return{animationName:"bounceIn",animationDuration:`${t}ms`};case Gc:return{animationName:"bounceOut",animationDuration:`${t}ms`}}case Nr.SLIDE_LEFT:switch(e){default:return{};case Ul:return{animationName:"slideInLeft",animationDuration:`${t}ms`};case Gc:return{animationName:"slideOutLeft",animationDuration:`${t}ms`}}case Nr.SLIDE_RIGHT:switch(e){default:return{};case Ul:return{animationName:"slideInRight",animationDuration:`${t}ms`};case Gc:return{animationName:"slideOutRight",animationDuration:`${t}ms`}}case Nr.FLIP_X:switch(e){default:return{};case Ul:return{animationName:"flipInX",animationDuration:`${t}ms`};case Gc:return{animationName:"flipOutX",animationDuration:`${t}ms`}}case Nr.FADE_UP:switch(e){default:return{};case Ul:return{animationName:"fadeInUp",animationDuration:`${t}ms`};case Gc:return{animationName:"fadeOutDown",animationDuration:`${t}ms`}}case Nr.FADE_IN:switch(e){default:return{};case Ul:return{animationName:"fadeIn",animationDuration:`${t}ms`};case Gc:return{animationName:"fadeOut",animationDuration:`${t}ms`}}case Nr.FADE_DOWN:switch(e){default:return{};case Ul:return{animationName:"fadeInDown",animationDuration:`${t}ms`};case Gc:return{animationName:"fadeOutUp",animationDuration:`${t}ms`}}case Nr.HEAD_SHAKE:switch(e){default:return{};case Ul:return{animationName:"headShake",animationDuration:`${t}ms`}}}return null}const Hd=a=>{const{type:e=null,inProp:t=!1,timeout:i=300,className:r=null,children:n=null}=a,[o,l]=h.useState(!1),c=h.useRef(null);return h.useEffect(()=>{let u=null;return t?l(!0):u=setTimeout(()=>{l(!1),clearTimeout(i)},i),()=>{u&&clearTimeout(u)}},[t,i]),s.jsx(lV,{in:t,timeout:i,nodeRef:c,children:u=>s.jsx("div",{ref:c,className:(r??"")+" animate__animated",style:{...Mte(e,u,i)},children:o&&n})})},PN=a=>{const{fadesOut:e=!0,timeoutMs:t=8e3,onClose:i=null,overflow:r="hidden",classNames:n=[],...o}=a,[l,c]=h.useState(!1),u=h.useMemo(()=>{const d=["nitro-notification-bubble","rounded"];return n.length&&d.push(...n),d},[n]);return h.useEffect(()=>(c(!0),()=>c(!1)),[]),h.useEffect(()=>{if(!e)return;const d=setTimeout(()=>{c(!1),setTimeout(()=>i(),300)},t);return()=>clearTimeout(d)},[e,t,i]),s.jsx(Hd,{type:Nr.FADE_IN,inProp:l,timeout:300,children:s.jsx(x,{overflow:r,classNames:u,onClick:i,...o})})},Fn=a=>{const{figure:e="",typeId:t=-1,paletteId:i=-1,petColor:r=16777215,customParts:n=[],posture:o="std",headOnly:l=!1,direction:c=0,scale:u=1,style:d={},..._}=a,[m,f]=h.useState(null),[E,I]=h.useState(0),[p,S]=h.useState(0),R=h.useRef(!1),O=h.useMemo(()=>{let C={};return m&&m.length&&(C.backgroundImage=`url(${m})`),u!==1&&(C.transform=`scale(${u})`,u%1||(C.imageRendering="pixelated")),C.width=E,C.height=p,Object.keys(d).length&&(C={...C,...d}),C},[m,u,d,E,p]);return h.useEffect(()=>{let C=t,A=i,b=r,y=n,M=l;if(e&&e.length){const G=new Vo(e);C=G.typeId,A=G.paletteId,b=G.color,y=G.customParts}C===16&&(M=!1);const U=ce().getRoomObjectPetImage(C,A,b,new Y(c*45),64,{imageReady:(G,F,H)=>{R.current||(H?(f(H.src),I(H.width),S(H.height)):F&&(f(Vt.generateImageUrl(F)),I(F.width),S(F.height)))},imageFailed:G=>{}},M,0,y,o);if(U){const G=U.getImage();G&&(f(G.src),I(G.width),S(G.height))}},[e,t,i,r,n,o,l,c]),h.useEffect(()=>(R.current=!1,()=>{R.current=!0}),[]),s.jsx(q,{classNames:["pet-image"],style:O,..._})},OT=a=>{const{text:e="",progress:t=0,maxProgress:i=100,position:r="relative",justifyContent:n="center",classNames:o=[],children:l=null,...c}=a,u=h.useMemo(()=>{const d=["nitro-progress-bar","text-white"];return o.length&&d.push(...o),d},[o]);return s.jsxs(N,{position:r,justifyContent:n,classNames:u,...c,children:[e&&e.length>0&&s.jsx(x,{fit:!0,center:!0,position:"absolute",className:"nitro-progress-bar-text small",children:e}),s.jsx(q,{className:"nitro-progress-bar-inner",style:{width:~~((t-0)*100/(i-0)+0)+"%"}}),l]})},UN=a=>{const{level:e=0,classNames:t=[],children:i=null,...r}=a,n=h.useMemo(()=>{const o=["nitro-rarity-level"];return t.length&&o.push(...t),o},[t]);return s.jsxs(q,{classNames:n,...r,children:[s.jsx("div",{children:e}),i]})},CT=a=>{const{roomPreviewer:e=null,height:t=0,children:i=null}=a,[r,n]=h.useState(null),o=h.useRef(),l=c=>{e&&(c.shiftKey?e.changeRoomObjectDirection():e.changeRoomObjectState())};return h.useEffect(()=>{if(!e)return;const c=d=>{!e||!r||!o.current||(e.updatePreviewRoomView(),r.canvasUpdated&&(o.current.style.backgroundImage=`url(${Vt.generateImageUrl(r.master)})`))};if(!r&&o.current&&e){let _=document.defaultView.getComputedStyle(o.current,null).backgroundColor;_=Ri.rgbStringToHex(_),_=_.replace("#","0x"),e.backgroundColor=parseInt(_,16);const m=o.current.parentElement.clientWidth;e.getRoomCanvas(m,t);const f=e.getRenderingCanvas();n(f),f.canvasUpdated=!0,c()}Gi().add(c);const u=new ResizeObserver(()=>{if(!e||!o.current)return;const d=o.current.parentElement.offsetWidth;e.modifyRoomCanvas(d,t),c()});return u.observe(o.current),()=>{u.disconnect(),Gi().remove(c)}},[r,e,o,t]),s.jsxs("div",{className:"room-preview-container",children:[s.jsx("div",{ref:o,className:"room-preview-image",style:{height:t},onClick:l}),i]})},NT=a=>{const{roomId:e=-1,customUrl:t=null,shrink:i=!0,overflow:r="hidden",classNames:n=[],children:o=null,...l}=a,c=h.useMemo(()=>{const d=["room-thumbnail","rounded","border"];return n.length&&d.push(...n),d},[n]),u=h.useMemo(()=>t&&t.length?xe("thumbnails.url")+t:xe("thumbnails.url").replace("%thumbnail%",e.toString()),[t,e]);return s.jsxs(q,{shrink:i,overflow:r,classNames:c,...l,children:[u&&s.jsx("img",{alt:"",src:u}),o]})},PG=a=>{const{color:e="",message:t="",date:i="",senderName:r="",customTitle:n=null,onCloseClick:o=null}=a;return s.jsx(jc,{handleSelector:".drag-handler",children:s.jsxs(N,{gap:0,alignItems:"center",className:`nitro-layout-trophy trophy-${e}`,children:[s.jsxs(x,{center:!0,fullWidth:!0,position:"relative",className:"trophy-header drag-handler",children:[s.jsx(q,{position:"absolute",pointer:!0,className:"trophy-close",onClick:o}),s.jsx(T,{bold:!0,children:g("widget.furni.trophy.title")})]}),s.jsxs(N,{className:"trophy-content py-1",gap:1,children:[n&&s.jsx(T,{bold:!0,children:n}),t]}),s.jsxs(x,{alignItems:"center",justifyContent:"between",className:"trophy-footer mt-1",children:[s.jsx(T,{bold:!0,children:i}),s.jsx(T,{bold:!0,children:r})]})]})})},Xn=a=>{const{userId:e=0,userName:t=null,classNames:i=[],pointer:r=!0,children:n=null,...o}=a,l=h.useMemo(()=>{const c=["nitro-friends-spritesheet","icon-profile-sm"];return i.length&&c.push(...i),c},[i]);return s.jsx(q,{classNames:l,pointer:r,onClick:c=>ir(e),...o,children:n})},In=a=>{const{isActive:e=!1,count:t=0,overflow:i="hidden",position:r="relative",pointer:n=!0,classNames:o=[],children:l=null,...c}=a,u=h.useMemo(()=>{const d=["nav-item","rounded-top","border"];return e&&d.push("active"),o.length&&d.push(...o),d},[e,o]);return s.jsxs(x,{overflow:i,pointer:n,position:r,classNames:u,...c,children:[s.jsx(x,{shrink:!0,center:!0,children:l}),t>0&&s.jsx(wo,{count:t})]})},$n=a=>{const{justifyContent:e="center",gap:t=1,classNames:i=[],children:r=null,...n}=a,o=h.useMemo(()=>{const l=["container-fluid","nitro-card-tabs","pt-1"];return i.length&&l.push(...i),l},[i]);return s.jsx(x,{justifyContent:e,gap:t,classNames:o,...n,children:r})},za=(...a)=>a.filter(Boolean).join(" "),jte=a=>{const{classNames:e=[],...t}=a,i=h.useMemo(()=>{const r=["form-group"];return e.length&&r.push(...e),r},[e]);return s.jsx(x,{classNames:i,...t})},Lte=a=>{const{variant:e="black",height:t=1,classNames:i=[],style:r={},...n}=a,o=h.useMemo(()=>{const c=[];return e&&c.push("bg-"+e),i.length&&c.push(...i),c},[e,i]),l=h.useMemo(()=>{let c={display:"list-item"};return t>0&&(c.height=t),Object.keys(r).length&&(c={...c,...r}),c},[t,r]);return s.jsx(q,{classNames:o,style:l,...n})},Wd=a=>{var f;const{rows:e=[],overscan:t=5,scrollToBottom:i=!0,rowRender:r=null,placement:n="top",scrollToIndex:o=null}=a,l=h.useRef(null),c=h.useRef(!1),[u,d]=h.useState(!1),_=Gy({count:e.length,overscan:t,getScrollElement:()=>l.current,estimateSize:()=>45});h.useEffect(()=>{const E=l.current;if(!E)return;const I=()=>{const{scrollTop:p,scrollHeight:S,clientHeight:R}=E;d(p+R<S-10)};return E.addEventListener("scroll",I),()=>E.removeEventListener("scroll",I)},[]),h.useEffect(()=>{e.length===0||c.current||(n==="top"?_.scrollToIndex(0,{align:"start"}):n==="bottom"&&_.scrollToIndex(e.length-1,{align:"end"}),c.current=!0)},[e.length,_]),h.useEffect(()=>{!i||u||e.length===0||(n==="top"?_.scrollToIndex(0,{align:"start"}):n==="bottom"&&_.scrollToIndex(e.length-1,{align:"end"}))},[i,e.length,_]),h.useEffect(()=>{o===null||o<0||o>=e.length||_.scrollToIndex(o,{align:"start"})},[e,o,_]);const m=_.getVirtualItems();return s.jsx(q,{fit:!0,innerRef:l,position:"relative",overflow:"auto",children:s.jsx("div",{style:{height:_.getTotalSize(),width:"100%",position:"relative"},children:s.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${((f=m[0])==null?void 0:f.start)??0}px)`},children:m.map(E=>s.jsx("div",{"data-index":E.index,ref:_.measureElement,children:r(e[E.index],_.measureElement,E.index)},E.key))})})})},Yo=(a,e,t,i=!0)=>{h.useEffect(()=>{if(i)return Array.isArray(a)?a.map(r=>e.addEventListener(r,t)):e.addEventListener(a,t),()=>{Array.isArray(a)?a.map(r=>e.removeEventListener(r,t)):e.removeEventListener(a,t)}},[a,e,i,t])},tv=(a,e)=>Yo(a,mQ().events,e),Pte=(a,e)=>Yo(a,Oe().cameraManager.events,e),Ute=(a,e)=>Yo(a,Oe().localization.events,e),Vc=(a,e)=>Yo(a,Oe().events,e),ut=(a,e)=>Yo(a,ce().events,e),ms=(a,e)=>Yo(a,jl().events,e),wte=(a,e)=>Yo(a,te().events,e),Zc=(a,e,t=!0)=>Yo(a,Oe().soundManager.events,e,t),Fte=(a,e)=>Yo(a,ce().events,e),J=(a,e)=>{h.useEffect(()=>{const t=new a(e);return Hg().registerMessageEvent(t),()=>Hg().removeMessageEvent(t)},[a,e])},Js=(a,e,t=!0)=>Yo(a,Go,e,t),kte=()=>{const[a,e]=h.useState(!0),[t,i]=h.useState([]),[r,n]=h.useState(null),[o,l]=h.useState(-1),[c,u]=h.useState(0),d=h.useMemo(()=>{let S=0;return t.forEach(R=>S+=pn.getAchievementCategoryTotalUnseen(R)),S},[t]),_=h.useMemo(()=>{let S=0;return t.forEach(R=>S+=R.getProgress()),S},[t]),m=h.useMemo(()=>{let S=0;return t.forEach(R=>S+=R.getMaxProgress()),S},[t]),f=h.useMemo(()=>~~((_-0)*100/(m-0)+0),[_,m]),E=h.useMemo(()=>r===null?null:t.find(S=>S.code===r),[t,r]),I=h.useMemo(()=>o===-1||!E?null:E.achievements.find(S=>S.achievementId===o),[E,o]),p=h.useCallback((S,R)=>{i(O=>{const C=[...O];for(const A of C)if(A.code===S)for(const b of A.achievements)b.achievementId===R&&(b.unseen=0);return C})},[]);return J(HM,S=>{const O=S.getParser().achievement;i(C=>{const A=[...C],b=A.findIndex(y=>y.code===O.category);if(b===-1){const y=new Tb(O.category);y.achievements.push(O),A.push(y)}else{const y=Dr(A[b]),M=[...y.achievements],U=M.findIndex(F=>F.achievementId===O.achievementId);let G=null;U===-1?M.push(O):(G=M[U],M[U]=O),pn.getAchievementIsIgnored(O)||(O.unseen++,G&&(O.unseen+=G.unseen)),y.achievements=M,A[b]=y}return A})}),J(WM,S=>{const R=S.getParser(),O=[];for(const C of R.achievements){const A=C.category;let b=O.find(y=>y.code===A);b||(b=new Tb(A),O.push(b)),b.achievements.push(C)}i(O)}),J(YM,S=>{const R=S.getParser();u(R.score)}),h.useEffect(()=>{a&&(K(new ZL),e(!1))},[a]),h.useEffect(()=>{!r||o===-1||p(r,o)},[r,o,p]),{achievementCategories:t,selectedCategoryCode:r,setSelectedCategoryCode:n,selectedAchievementId:o,setSelectedAchievementId:l,achievementScore:c,getTotalUnseen:d,getProgress:_,getMaxProgress:m,scaledProgressPercent:f,selectedCategory:E,selectedAchievement:I,setAchievementSeen:p}},AT=()=>Ht(kte),Gte=()=>{const[a,e]=h.useState([]),[t,i]=h.useState([]),[r,n]=h.useState(-1),[o,l]=h.useState(10),[c,u]=h.useState(null);return Pte(bg.INITIALIZED,d=>{e(Array.from(__().effects.values()))}),J(vD,d=>{const _=d.getParser();u({credits:_.creditPrice,duckets:_.ducketPrice,publishDucketPrice:_.publishDucketPrice})}),h.useEffect(()=>{if(!__().isLoaded){__().init(),K(new sP);return}},[]),{availableEffects:a,cameraRoll:t,setCameraRoll:i,selectedPictureIndex:r,setSelectedPictureIndex:n,myLevel:o,price:c}},UG=()=>Ht(Gte),Da=class Da extends _t{};Da.SHOW_CATALOG="CE_SHOW_CATALOG",Da.HIDE_CATALOG="CE_HIDE_CATALOG",Da.TOGGLE_CATALOG="CE_TOGGLE_CATALOG",Da.SOLD_OUT="CE_SOLD_OUT",Da.APPROVE_NAME_RESULT="CE_APPROVE_NAME_RESULT",Da.PURCHASE_APPROVED="CE_PURCHASE_APPROVED",Da.INIT_GIFT="CE_INIT_GIFT",Da.CATALOG_RESET="CE_RESET",Da.CATALOG_INVISIBLE_PAGE_VISITED="CE_CATALOG_INVISIBLE_PAGE_VISITED";let ih=Da;class Bte extends ih{constructor(e,t,i){super(ih.INIT_GIFT),this._pageId=e,this._offerId=t,this._extraData=i}get pageId(){return this._pageId}get offerId(){return this._offerId}get extraData(){return this._extraData}}const YI=class YI extends ih{constructor(e){super(YI.POST_MARKETPLACE),this._item=e}get item(){return this._item}};YI.POST_MARKETPLACE="CE_POST_MARKETPLACE";let kp=YI;const zI=class zI extends _t{constructor(e){super(zI.PURCHASE_SUCCESS),this._purchase=e}get purchase(){return this._purchase}};zI.PURCHASE_SUCCESS="CPE_PURCHASE_SUCCESS";let Ho=zI;const KI=class KI extends _t{constructor(e){super(KI.PURCHASE_FAILED),this._code=e}get code(){return this._code}};KI.PURCHASE_FAILED="CPFE_PURCHASE_FAILED";let yc=KI;const qI=class qI extends _t{constructor(e){super(qI.NOT_ALLOWED),this._code=e}get code(){return this._code}};qI.NOT_ALLOWED="CPNAE_NOT_ALLOWED";let nm=qI;const li=class li extends _t{};li.WIDGETS_INITIALIZED="CWE_CWE_WIDGETS_INITIALIZED",li.SELECT_PRODUCT="CWE_SELECT_PRODUCT",li.SET_EXTRA_PARM="CWE_CWE_SET_EXTRA_PARM",li.PURCHASE="CWE_PURCHASE",li.COLOUR_ARRAY="CWE_COLOUR_ARRAY",li.MULTI_COLOUR_ARRAY="CWE_MULTI_COLOUR_ARRAY",li.COLOUR_INDEX="CWE_COLOUR_INDEX",li.TEXT_INPUT="CWE_TEXT_INPUT",li.DROPMENU_SELECT="CWE_CWE_DROPMENU_SELECT",li.PURCHASE_OVERRIDE="CWE_PURCHASE_OVERRIDE",li.SELLABLE_PET_PALETTES="CWE_SELLABLE_PET_PALETTES",li.UPDATE_ROOM_PREVIEW="CWE_UPDATE_ROOM_PREVIEW",li.GUILD_SELECTED="CWE_GUILD_SELECTED",li.TOTAL_PRICE_WIDGET_INITIALIZED="CWE_TOTAL_PRICE_WIDGET_INITIALIZED",li.PRODUCT_OFFER_UPDATED="CWE_CWE_PRODUCT_OFFER_UPDATED",li.SET_PREVIEWER_STUFFDATA="CWE_CWE_SET_PREVIEWER_STUFFDATA",li.EXTRA_PARAM_REQUIRED_FOR_BUY="CWE_CWE_EXTRA_PARAM_REQUIRED_FOR_BUY",li.TOGGLE="CWE_CWE_TOGGLE",li.BUILDER_SUBSCRIPTION_UPDATED="CWE_CWE_BUILDER_SUBSCRIPTION_UPDATED",li.ROOM_CHANGED="CWE_CWE_ROOM_CHANGED",li.SHOW_WARNING_TEXT="CWE_CWE_SHOW_WARNING_TEXT";let sv=li;const XI=class XI extends _t{constructor(){super(XI.SOLD_OUT)}};XI.SOLD_OUT="CPSOE_SOLD_OUT";let am=XI;const $I=class $I extends _t{constructor(e,t){super($I.UPDATE_STUFF_DATA),this._offer=e,this._stuffData=t}get offer(){return this._offer}get stuffData(){return this._stuffData}};$I.UPDATE_STUFF_DATA="SRPSA_UPDATE_STUFF_DATA";let iv=$I;const bu=class bu extends _t{};bu.SHOW_GUIDE_TOOL="GTE_SHOW_GUIDE_TOOL",bu.HIDE_GUIDE_TOOL="GTE_HIDE_GUIDE_TOOL",bu.TOGGLE_GUIDE_TOOL="GTE_TOGGLE_GUIDE_TOOL",bu.CREATE_HELP_REQUEST="GTE_CREATE_HELP_REQUEST",bu.CREATE_BULLY_REQUEST="GTE_CREATE_BULLY_REQUEST";let mn=bu;const MA=class MA extends _t{};MA.INIT="HC_NAME_CHANGE_INIT";let om=MA;const QI=class QI extends _t{constructor(e,t,i){super(QI.FURNI_ADDED),this.id=e,this.spriteId=t,this.category=i}};QI.FURNI_ADDED="IFAE_FURNI_ADDED";let lm=QI;const Tg=class Tg extends _t{};Tg.SHOW_THUMBNAIL="NE_SHOW_THUMBNAIL",Tg.HIDE_THUMBNAIL="NE_HIDE_THUMBNAIL",Tg.TOGGLE_THUMBNAIL="NE_TOGGLE_THUMBNAIL";let bo=Tg;const rv=a=>a&&a.length?a.replace(/\\r/g,"\r"):"",nv=a=>{const e="0"+a;return e.substr(e.length-2,e.length)};let n_=null;const Vte=()=>{const[a,e]=h.useState([]),[t,i]=h.useState([]),[r,n]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState([]),[d,_]=h.useState(!1),[m,f]=h.useState(!1),E=()=>xe("notification",{}),I=W=>{const V=E();return V?V[W]:null},p=(W,V,se,ee)=>{if(W.has(se))return W.get(se);const ie=["notification",V,se].join(".");return Oe().localization.hasValue(ie)||ee?g(ie,Array.from(W.keys()),Array.from(W.values())):null},S=(W,V)=>{let se=W.get("image");return se||(se=xe("image.library.notifications.url","").replace("%image%",V.replace(/\./g,"_"))),g(se)},R=h.useCallback((W,V=null,se=null,ee=null,ie=null,Z=null)=>{(!ie||!ie.length)&&(ie=g("notifications.broadcast.title")),(!V||!V.length)&&(V=lt.DEFAULT);const ne=new Ip([rv(W)],V,se,ee,ie,Z);e(_e=>[ne,..._e])},[]),O=h.useCallback(()=>R(null,lt.NITRO),[R]),C=h.useCallback((W,V,se=null,ee=null)=>{if(d)return;const ie=new Vx(W,V,se,ee);i(Z=>[ie,...Z])},[d]),A=(W,V=null)=>{V||(V=new Map);const se=I("notification."+W);if(se)for(const de in se)V.set(de,se[de]);W==="floorplan_editor.error"&&V.set("message",V.get("message").replace(/[^a-zA-Z._ ]/g,""));const ee=p(V,W,"title",!0),ie=p(V,W,"message",!0).replace(/\\r/g,"\r"),Z=p(V,W,"linkTitle",!1),ne=p(V,W,"linkUrl",!1),_e=S(V,W);V.get("display")==="BUBBLE"?C(g(ie),bi.INFO,_e,ne):R(g(ie),W,ne,Z,ee,_e),V.get("sound")&&yl(V.get("sound"))},b=h.useCallback((W,V,se,ee=null,ie=null,Z=null,ne=null)=>{(!ee||!ee.length)&&(ee=g("generic.confirm")),(!ie||!ie.length)&&(ie=g("generic.cancel")),(!Z||!Z.length)&&(Z=g("notifications.broadcast.title"));const _e=new Hx(ne,W,V,se,ee,ie,Z);n(de=>[_e,...de])},[]),y=h.useCallback((W,V,se,ee)=>{const ie=g("notifications.broadcast.title"),Z=g("generic.confirm"),ne=g("generic.cancel"),_e=new Wx(lt.MARKET_PLACE,V,se,ee,Z,ne,ie,W);l(de=>[_e,...de])},[]),M=h.useCallback((W,V,se,ee,ie,Z)=>{const ne=g("notifications.broadcast.deletable.title"),_e=g("generic.confirm"),de=g("generic.cancel"),me=new Yx(W,V,se,ee,ie,Z,_e,de,ne);u(fe=>[me,...fe])},[]),U=(W,V=null,se=!0)=>{R(W,lt.DEFAULT,V,g("mod.alert.link"),g("mod.alert.title"))},G=h.useCallback((W,V="")=>{switch(W){case zr.ALERT_SCAM:R(g("inventory.trading.warning.other_not_offering"),null,null,null,g("inventory.trading.notification.title"));return;case zr.HOTEL_TRADING_DISABLED:case zr.YOU_NOT_ALLOWED:case zr.THEY_NOT_ALLOWED:case zr.ROOM_DISABLED:case zr.YOU_OPEN:case zr.THEY_OPEN:R(g(`inventory.trading.openfail.${W}`,["otherusername"],[V]),null,null,null,g("inventory.trading.openfail.title"));return;case zr.ERROR_WHILE_COMMIT:R(`${g("inventory.trading.notification.caption")}, ${g("inventory.trading.notification.commiterror.info")}`,null,null,null,g("inventory.trading.notification.title"));return;case zr.THEY_CANCELLED:R(g("inventory.trading.info.closed"),null,null,null,g("inventory.trading.notification.title"));return}},[R]),F=h.useCallback(W=>{e(V=>{const se=[...V],ee=se.findIndex(ie=>W===ie);return ee>=0&&se.splice(ee,1),se})},[]),H=h.useCallback(W=>{i(V=>{const se=[...V],ee=se.findIndex(ie=>W===ie);return ee>=0&&se.splice(ee,1),se})},[]),v=h.useCallback(W=>{n(V=>{const se=[...V],ee=se.findIndex(ie=>W===ie);return ee>=0&&se.splice(ee,1),se})},[]),B=h.useCallback(W=>{l(V=>{const se=[...V],ee=se.findIndex(ie=>W===ie);return ee>=0&&se.splice(ee,1),se})},[]),z=h.useCallback(W=>{u(V=>{const se=[...V],ee=se.findIndex(ie=>W===ie);return ee>=0&&se.splice(ee,1),se})},[]);J(VC,W=>{const V=W.getParser();if(V.userId!==te().userId)return;const se=g("notifications.text.respect.2",["count"],[V.respectsReceived.toString()]);C(se,bi.RESPECT,S(new Map,"respect"))}),J(BC,W=>{const V=W.getParser();if(V.userId!==te().userId)return;const se=g("notifications.text.kiss.2",["count"],[V.kissesReceived.toString()]);C(se,bi.KISS,S(new Map,"kiss"))}),J(tj,W=>{const V=W.getParser();R(V.message.replace(/\\r/g,"\r"),null,null,g("notifications.broadcast.title"))}),J(lj,W=>{const V=W.getParser();if(V.type===Tp.MARRIED_COMMAND){const se=()=>{te().sendSpecialCommandMessage(`:marry ${V.customData} sim`)},ee=()=>{te().sendSpecialCommandMessage(`:marry ${V.customData} nao`)};b(V.message.replace(/\\r/g,"\r"),se,ee)}else if(V.type===Tp.SEX_COMMAND){const se=()=>{te().sendSpecialCommandMessage(`:sex ${V.customData} sim`)},ee=()=>{te().sendSpecialCommandMessage(`:sex ${V.customData} nao`)};b(V.message.replace(/\\r/g,"\r"),se,ee)}}),J(Q0,W=>{const V=W.getParser(),se=g("achievements.levelup.desc"),ee=$d(V.data.badgeCode),ie=te().getBadgeUrl(V.data.badgeCode),Z="questengine/achievements/"+V.data.category;C(se+" "+ee,bi.ACHIEVEMENT,ie,Z)}),J(Z0,W=>{const V=W.getParser();V.numGifts<=0||C(V.numGifts.toString(),bi.CLUBGIFT,null,"catalog/open/"+xe("catalog.links")["hc.hc_gifts"])}),J(A0,W=>{const V=W.getParser();U(V.message,V.url,!1)}),J(vC,W=>{const V=W.getParser();if(V.amountChanged<=0||V.type!==5)return;const se=xe("currency.asset.icon.url","").replace("%type%",V.type.toString());C(g("notifications.text.loyalty.received",["AMOUNT"],[V.amountChanged.toString()]),bi.INFO,se)}),J(j0,W=>{const V=W.getParser();U(V.message)}),J(fD,W=>{const V=W.getParser();R(g("opening.hours."+(V.userThrowOutAtClose?"disconnected":"closed"),["h","m"],[nv(V.openHour),nv(V.openMinute)]),lt.DEFAULT,null,null,g("opening.hours.title"))}),J(e0,W=>{const V=W.getParser(),se=g("notifications.text."+(V.boughtAsGift?"petbought":"petreceived"));let ee=null;const ie=ce().getRoomObjectPetImage(V.pet.typeId,V.pet.paletteId,parseInt(V.pet.color,16),new Y(45*3),64,null,!0);ie&&(ee=ie.getImage().src),C(se,bi.PETLEVEL,ee)}),J(ij,W=>{const se=W.getParser().messages.map(ie=>rv(ie)),ee=new Ip(se,lt.MOTD,null,null,g("notifications.motd.title"));e(ie=>[ee,...ie])}),J(rj,W=>{const V=W.getParser();let se=null;const ee=ce().getRoomObjectPetImage(V.figureData.typeId,V.figureData.paletteId,parseInt(V.figureData.color,16),new Y(45*3),64,null,!0);ee&&(se=ee.getImage().src),C(g("notifications.text.petlevel",["pet_name","level"],[V.petName,V.level.toString()]),bi.PETLEVEL,se)}),J(sj,W=>{const V=W.getParser();_(!V.enabled)}),J(kD,W=>{const V=W.getParser();if(!V.products||!V.products.length)return;const se=V.products[0];se&&C(g("notifications.text.club_gift.selected"),bi.INFO,rf.getProductImageUrl(se.productType,se.furniClassId,se.extraParam))}),J(ED,W=>{const V=W.getParser();R(g("maintenance.shutdown",["m","d"],[V.minutesUntilMaintenance.toString(),V.duration.toString()]),lt.DEFAULT,null,null,g("opening.hours.title"))}),J(C0,W=>{const V=W.getParser();U(V.message,V.url)}),J(yC,W=>{const V=W.getParser();A(V.type,V.parameters)}),J(pD,W=>{const V=W.getParser();R(g("opening.hours.shutdown",["m"],[V.openMinute.toString()]),lt.DEFAULT,null,null,g("opening.hours.title"))}),J(mD,W=>{const V=W.getParser();R(g("opening.hours.disconnected",["h","m"],[V.openHour.toString(),V.openMinute.toString()]),lt.DEFAULT,null,null,g("opening.hours.title"))}),J(ej,W=>{const V=W.getParser();switch(V.errorCode){default:case 0:R(g("connection.server.error.desc",["errorCode"],[V.errorCode.toString()]),lt.ALERT,null,null,g("connection.server.error.title"));break;case 1001:case 1002:case 1003:case 1004:case 1005:case 1006:case 1007:case 1008:case 1009:case 1010:case 1011:case 1012:case 1013:case 1014:case 1015:case 1016:case 1017:case 1018:case 1019:W.connection.dispose();break;case 4013:R(g("connection.room.maintenance.desc"),lt.ALERT,null,null,g("connection.room.maintenance.title"));break}}),J(aj,W=>{const V=W.getParser();R(g(V.alertMessage),lt.DEFAULT,null,null,g(V.titleMessage?V.titleMessage:"notifications.broadcast.title"))});const $=h.useCallback(()=>{if(!m)if(Bn.isRunning()){if(n_)return;n_=setTimeout(()=>{$()},Bn.totalRunningTime+5e3)}else n_&&(clearTimeout(n_),n_=null),C(g("mod.chatdisclaimer"),bi.INFO),f(!0)},[m,C]);return J(Jf,$),{alerts:a,bubbleAlerts:t,confirms:r,marketplaces:o,deletables:c,setDeletables:u,simpleAlert:R,showNitroAlert:O,showTradeAlert:G,showConfirm:b,showSingleBubble:C,closeAlert:F,closeBubbleAlert:H,closeConfirm:v,closeMarketplace:B,closeDeletableItem:z,getNotificationImageUrl:S,showMarketPlaceAlert:y,showDeletableItemAlert:M}},kt=()=>Ht(Vte),Hte=(a,e)=>{const[t,i]=h.useState(()=>{if(typeof window>"u")return e;try{return Kg(a)??e}catch{return e}});return[t,n=>{try{const o=n instanceof Function?n(t):n;i(o),typeof window<"u"&&bk(a,o)}catch(o){ze.error(o)}}]},br=Hte,Wte=()=>br(tr.CATALOG_PLACE_MULTIPLE_OBJECTS,!1),wG=()=>Ht(Wte),Yte=()=>br(tr.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1),FG=()=>Ht(Yte),Xo=["navigator.wiredcreatortools.tab.monitor","navigator.wiredcreatortools.tab.variable_overview","navigator.wiredcreatortools.tab.variable_inspection","navigator.wiredcreatortools.tab.settings"],zte=()=>{const[a,e]=h.useState(Xo[0]),[t,i]=h.useState({read:!1,write:!1}),[r,n]=h.useState(!1),[o,l]=h.useState(!1),[c,u]=h.useState(!1),[d,_]=h.useState(!1),[m,f]=h.useState(0),[E,I]=h.useState(!1),[p,S]=h.useState(""),[R,O]=h.useState(!1),[C,A]=h.useState(!1),[b,y]=h.useState(0),{showSingleBubble:M,getNotificationImageUrl:U}=kt(),G=()=>{const $=$e(),W=te();return($==null?void 0:$.isRoomOwner)||(W==null?void 0:W.isModerator)};J(Kk,$=>{const W=$.getParser();W&&i({read:W.canRead,write:W.canModify})}),J(uT,$=>{const W=$.getParser();W&&(n(W.wiredMenuButton),l(W.wiredInspectButton),z(W.playTestMode),f(W.variableSyntaxMode),_(W.whisperingToWired))}),J(Qf,$=>{c&&M(g("wiredmenu.settings.preferences.notification.playtest"),bi.INFO,U(new Map,"wired"),"wiredmenu/open/settings")});const F=()=>G()||t.read,H=()=>G()||t.write,v=()=>!0,B=()=>{K(new nF(r,r,c,m===1))},z=($,W=!1,V=!1)=>{u($);const se=$e();if(se){if(se.playTestMode=$,V){const ie=g(`wiredmenu.settings.preferences.notification.playtest.${$?"enabled":"disabled"}`);M(ie,bi.INFO,U(new Map,"wired"),"wiredmenu/open/settings")}W&&B()}};return ms([Ve.CREATED,Ve.STARTED,Ve.ENDED],$=>{if($.type!==Ve.STARTED)return;const W=$e();W&&(W.playTestMode=c)}),{hasReadPermission:F,hasWritePermission:H,isRoomOwnerOrStaff:G,isEnabled:v,playTestMode:c,switchPlayTestMode:z,variableSyntaxMode:m,setVariableSyntaxMode:f,sendPreferences:B,currentTab:a,setCurrentTab:e,permissions:t,wiredMenuButton:r,setWiredMenuButton:n,wiredInspectButton:o,setWiredInspectButton:l,wiredWhisperDisabled:d,setWiredWhisperDisabled:_,jumpToVariableByName:E,setJumpToVariableByName:I,jumpingVariableName:p,setJumpingVariableName:S,jumpToInspectUser:R,setJumpToInspectUser:O,jumpToInspectFurni:C,setJumpToInspectFurni:A,jumpingToInspectId:b,setJumpingToInspectId:y}},Tn=()=>Ht(zte),Kte=-12345678,qte=()=>{const[a,e]=h.useState(!1),[t,i]=h.useState(!1),[r,n]=h.useState(-1),[o,l]=h.useState(-1),[c,u]=h.useState(la.NORMAL),[d,_]=h.useState(null),[m,f]=h.useState(null),[E,I]=h.useState(null),[p,S]=h.useState(null),[R,O]=h.useState([]),[C,A]=h.useState(null),[b,y]=h.useState([]),[M,U]=h.useState(null),[G,F]=h.useState(!1),[H,v]=h.useState({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null}),[B,z]=h.useState({}),[$,W]=h.useState(!1),[V,se]=wG();FG();const[ee,ie]=h.useState(null),[Z,ne]=h.useState(null),[_e,de]=h.useState(0),[me,fe]=h.useState(0),[ae,Te]=h.useState(0),[Se,Le]=h.useState(0),[Et,ri]=h.useState(0),[ni,gt]=h.useState(0),{simpleAlert:yt=null}=kt(),ws=h.useRef(new qc),{playTestMode:Jn}=Tn(),Uc=h.useCallback(()=>{n(-1),l(-1),_(null),f(null),I(null),S(null),O([]),A(null),y([]),e(!1)},[]),yi=h.useCallback(he=>{if(!he)return Qo.MISSING_OFFER;if(_e<0||_e>=me)return Qo.FURNI_LIMIT_REACHED;const pe=$e();if(!pe)return Qo.NOT_IN_ROOM;if(!pe.isRoomOwner)return Qo.NOT_ROOM_OWNER;if(Se<=0){const Ne=ce();let Xe=Ne.getRoomObjectCount(pe.roomId,Q.UNIT);for(;Xe>0;){const xt=Ne.getRoomObjectByIndex(pe.roomId,Xe,Q.UNIT),cs=pe.userDataManager.getUserDataByIndex(xt.id);if(cs&&cs.type===Xt.USER&&cs.roomIndex!==pe.ownRoomIndex&&!cs.isModerator)return Qo.VISITORS_IN_ROOM;Xe--}}return Qo.OKAY},[_e,me,Se]),Ze=h.useCallback(he=>{if(Jn)return!1;const pe=$e();return(pe&&!he.badgeCode&&he.priceType==="price_type_none"&&he.pricingModel==="pricing_model_single"&&he.bundlePurchaseAllowed&&he.page&&he.page.layoutCode!=="sold_ltd_items"&&c===la.NORMAL&&(pe.isRoomOwner||pe.controllerLevel>=pt.USER_WITH_RIGHTS)||c===la.BUILDER&&yi(he)===Qo.OKAY)&&he.pricingModel!==Zi.PRICING_MODEL_BUNDLE&&he.product.productType!==dt.EFFECT&&he.product.productType!==dt.HABBO_CLUB},[c,yi,Jn]),ht=h.useCallback(he=>{if(!Ze(he))return;const pe=he.product;if(!pe)return;let Ne=0;switch(pe.productType){case dt.FLOOR:Ne=Q.FLOOR;break;case dt.WALL:Ne=Q.WALL;break}ce().processRoomObjectPlacement(zn.CATALOG,-he.offerId,Ne,pe.productClassId,pe.extraParam)&&(ie(he),W(!0),e(!1))},[Ze]),Wi=h.useCallback((he,pe)=>{const Ne=ce();let Xe=Ne.getRoomInstanceVariable(Ne.activeRoomId,D.ROOM_WALL_TYPE),xt=Ne.getRoomInstanceVariable(Ne.activeRoomId,D.ROOM_FLOOR_TYPE),cs=Ne.getRoomInstanceVariable(Ne.activeRoomId,D.ROOM_LANDSCAPE_TYPE);switch(Xe=Xe&&Xe.length?Xe:"101",xt=xt&&xt.length?xt:"101",cs=cs&&cs.length?cs:"1.1",he){case"floor":Ne.updateRoomInstancePlaneType(Ne.activeRoomId,pe,Xe,cs,!0);return;case"wallpaper":Ne.updateRoomInstancePlaneType(Ne.activeRoomId,xt,pe,cs,!0);return;case"landscape":Ne.updateRoomInstancePlaneType(Ne.activeRoomId,xt,Xe,pe,!0);return;default:Ne.updateRoomInstancePlaneType(Ne.activeRoomId,xt,Xe,cs,!0);return}},[]),Cs=h.useCallback(()=>{ee&&(ce().cancelRoomObjectInsert(),W(!1),ie(null))},[ee]),js=h.useCallback((he=!0)=>{W(pe=>(pe&&he&&Ce("catalog/open"),!1))},[]),Ll=h.useCallback((he=!1)=>{he||js(),ne(pe=>{if(pe)switch(pe.category){case Q.FLOOR:ce().removeRoomObjectFloor(pe.roomId,pe.objectId);break;case Q.WALL:{switch(pe.furniData.className){case"floor":case"wallpaper":case"landscape":Wi("reset","");break;default:ce().removeRoomObjectWall(pe.roomId,pe.objectId);break}break}default:ce().deleteRoomObject(pe.objectId,pe.category);break}return null})},[js,Wi]),Pl=h.useCallback((he,pe)=>{if(pe.pageId===he&&pe!==d)return pe;for(const Ne of pe.children){const Xe=Pl(he,Ne);if(Xe)return Xe}return null},[d]),zo=h.useCallback((he,pe)=>{if(pe.pageName===he&&pe!==d)return pe;for(const Ne of pe.children){const Xe=zo(he,Ne);if(Xe)return Xe}return null},[d]),s_=h.useCallback((he,pe=!1)=>{if(!m||!m.size)return null;if(pe){const Ne=[],Xe=m.get(he);if(Xe&&Xe.length)for(const xt of Xe)xt.isVisible&&Ne.push(xt);if(Ne.length)return Ne}return m.get(he)},[m]),Cm=h.useCallback((he,pe)=>{he<0||(i(!0),n(he),he>-1&&K(new mP(he,pe,c)))},[c]),Nm=h.useCallback((he,pe,Ne,Xe,xt,cs)=>{const ai=new dp(he,pe,Ne,Xe,cs);if(I(ai),l(Tt=>he!==-1?he:Tt),F(!1),xt>-1&&ai.offers.length){for(const Tt of ai.offers)if(Tt.offerId===xt){S(Tt);break}}},[]),Pi=h.useCallback((he,pe=-1)=>{if(Cs(),he.parent.pageName==="root"&&he.children.length){for(const xt of he.children)if(xt.isVisible){he=xt;break}}const Ne=[];let Xe=he;for(;Xe&&Xe.pageName!=="root";)Ne.push(Xe),Xe=Xe.parent;Ne.reverse(),O(xt=>{const cs=xt.indexOf(he)>=0,ai=he.isOpen;for(const Tt of xt)Tt.deactivate(),Ne.indexOf(Tt)===-1&&Tt.close();for(const Tt of Ne)Tt.activate(),Tt.parent&&Tt.open(),Tt===he.parent&&Tt.children.length&&Tt.open();return cs&&ai?he.close():he.open(),Ne}),he.pageId>-1&&Cm(he.pageId,pe)},[O,Cm,Cs]),wc=h.useCallback(he=>{if(he!==-1&&A(null),!a)ws.current.requestById=he,e(!0);else{const pe=Pl(he,d);pe&&Pi(pe)}},[a,d,Pl,Pi]),Fc=h.useCallback(he=>{if(A(null),!a)ws.current.requestByName=he,e(!0);else{const pe=zo(he,d);pe&&Pi(pe)}},[a,d,zo,Pi]),Pe=h.useCallback(he=>{if(A(null),!a)ws.current.requestedByOfferId=he,e(!0);else{const pe=s_(he);if(!pe||!pe.length)return;Pi(pe[0],he)}},[a,s_,Pi]),Dt=h.useCallback(()=>{},[]);return J(wD,he=>{const pe=he.getParser(),Ne=new Map,Xe=(xt,cs,ai)=>{const Tt=new pQ(xt,cs,ai);for(const Lr of Tt.offerIds)Ne.has(Lr)?Ne.get(Lr).push(Tt):Ne.set(Lr,[Tt]);cs++;for(const Lr of xt.children)Tt.addChild(Xe(Lr,cs,Tt));return Tt};_(Xe(pe.root,0,null)),f(Ne)}),J(UD,he=>{const pe=he.getParser();if(pe.catalogType!==c)return;const Ne=[];for(const Xe of pe.offers){const xt=[],cs=Rd(Xe.localizationId);for(const Tt of Xe.products){const Lr=vx(Tt.furniClassId,Tt.productType);xt.push(new Sc(Tt.productType,Tt.furniClassId,Tt.extraParam,Tt.productCount,cs,Lr,Tt.uniqueLimitedItem,Tt.uniqueLimitedSeriesSize,Tt.uniqueLimitedItemsLeft))}if(!xt.length)continue;const ai=new Zi(Xe.offerId,Xe.localizationId,Xe.rent,Xe.priceCredits,Xe.priceActivityPoints,Xe.priceActivityPointsType,Xe.giftable,Xe.clubLevel,xt,Xe.bundlePurchaseAllowed);(c===la.NORMAL||ai.pricingModel!==Zi.PRICING_MODEL_BUNDLE&&ai.pricingModel!==Zi.PRICING_MODEL_MULTI)&&Ne.push(ai)}pe.frontPageItems&&pe.frontPageItems.length&&y(pe.frontPageItems),i(!1),r===pe.pageId&&Nm(pe.pageId,pe.layoutCode,new ik(pe.localization.images.concat(),pe.localization.texts.concat()),Ne,pe.offerId,pe.acceptSeasonCurrencyAsCredits)}),J(KD,he=>{const pe=he.getParser();_i(new Ho(pe.offer))}),J(YD,he=>{const pe=he.getParser();_i(new yc(pe.code))}),J(zD,he=>{const pe=he.getParser();_i(new nm(pe.code))}),J(HD,he=>{he.getParser(),_i(new am)}),J(WD,he=>{const Ne=he.getParser().offer;if(!Ne||!Ne.products.length)return;Ne.products[0].uniqueLimitedItem;const xt=[],cs=Rd(Ne.localizationId);for(const Tt of Ne.products){const Lr=vx(Tt.furniClassId,Tt.productType);xt.push(new Sc(Tt.productType,Tt.furniClassId,Tt.extraParam,Tt.productCount,cs,Lr,Tt.uniqueLimitedItem,Tt.uniqueLimitedSeriesSize,Tt.uniqueLimitedItemsLeft))}const ai=new Zi(Ne.offerId,Ne.localizationId,Ne.rent,Ne.priceCredits,Ne.priceActivityPoints,Ne.priceActivityPointsType,Ne.giftable,Ne.clubLevel,xt,Ne.bundlePurchaseAllowed);(c===la.NORMAL||ai.pricingModel!==Zi.PRICING_MODEL_BUNDLE&&ai.pricingModel!==Zi.PRICING_MODEL_MULTI)&&(ai.page=E,S(ai),ai.product&&ai.product.productType===dt.WALL&&v(Tt=>{const Lr={...Tt};return Lr.extraData=ai.product.extraParam||null,Lr}))}),J(XD,he=>{const pe=he.getParser(),Ne=new EQ(pe.productCode,pe.palettes.slice());z(Xe=>{const xt=[];Xe.petPalettes&&xt.push(...Xe.petPalettes);for(let cs=0;cs<xt.length;cs++)if(xt[cs].breed===Ne.breed){xt.splice(cs,1);break}return xt.push(Ne),{...Xe,petPalettes:xt}})}),J(VD,he=>{const pe=he.getParser();z(Ne=>{const Xe=pe.offers;return{...Ne,clubOffers:Xe}})}),J(kC,he=>{const pe=he.getParser();z(Ne=>{const Xe=pe.groups;return{...Ne,groups:Xe}})}),J(BD,he=>{const pe=he.getParser();z(Ne=>{const Xe=new OQ(pe);return{...Ne,giftConfiguration:Xe}})}),J(p0,he=>{const pe=he.getParser();if(!pe)return;let Ne="";pe.result===1?Ne=g("inventory.marketplace.result.title.success"):Ne=g("inventory.marketplace.result.title.failure");const Xe=g(`inventory.marketplace.result.${pe.result}`);yt(Xe,lt.DEFAULT,null,null,Ne)}),J(fC,he=>{const pe=he.getParser();z(Ne=>({...Ne,clubGifts:pe}))}),J(FD,he=>{const pe=a;Uc(),pe&&yt(g("catalog.alert.published.description"),lt.ALERT,null,null,g("catalog.alert.published.title"))}),J(LD,he=>{const pe=he.getParser();de(pe.furniCount),Dt()}),J(PD,he=>{const pe=he.getParser();fe(pe.furniLimit),Te(pe.maxFurniLimit),Le(pe.secondsLeft),ri(nt()),gt(pe.secondsLeftWithGrace),Dt()}),Js(Ho.PURCHASE_SUCCESS,he=>yl(Bo.CREDITS)),ut(Tf.PLACED,he=>{if(!$||he.type!==Tf.PLACED)return;if(Ll(!0),!ee){js();return}let pe=!1;const Ne=ee.product;if(he.category===Q.WALL)switch(Ne.furnitureData.className){case"floor":case"wallpaper":case"landscape":pe=he.placedOnFloor||he.placedOnWall;break;default:pe=he.placedInRoom;break}else pe=he.placedInRoom;if(!pe){js();return}const Xe=new CQ(he.roomId,he.objectId,he.category,he.wallLocation,he.x,he.y,he.direction,ee);switch(ne(Xe),c){case la.NORMAL:case la.BUILDER:{let xt=ee.page.pageId;switch(xt===Kte&&(xt=-1),he.category){case Q.FLOOR:K(new YC(xt,Xe.productClassId,Ne.extraParam,he.x,he.y,he.direction));break;case Q.WALL:K(new zC(xt,Xe.productClassId,Ne.extraParam,he.wallLocation));break}V&&ht(ee);break}}}),Js(lm.FURNI_ADDED,he=>{const pe=ce();if(!(!Z||Z.productClassId!==he.spriteId||Z.roomId!==pe.activeRoomId)){switch(he.category){case Je.FLOOR:{const Ne=pe.getRoomInstanceVariable(pe.activeRoomId,D.ROOM_FLOOR_TYPE);Z.extraParam!==Ne&&K(new Sd(he.id));break}case Je.WALL_PAPER:{const Ne=pe.getRoomInstanceVariable(pe.activeRoomId,D.ROOM_WALL_TYPE);Z.extraParam!==Ne&&K(new Sd(he.id));break}case Je.LANDSCAPE:{const Ne=pe.getRoomInstanceVariable(pe.activeRoomId,D.ROOM_LANDSCAPE_TYPE);Z.extraParam!==Ne&&K(new Sd(he.id));break}default:K(new mm(he.id,Z.category,Z.wallLocation,Z.x,Z.y,Z.direction)),Cr.addUndo(It.FURNITURE_PLACE,[he.id,Z.category,Z.wallLocation,Z.x,Z.y,Z.direction]);break}V||Ll()}}),h.useEffect(()=>()=>S(null),[E]),h.useEffect(()=>{if(!(!a||!d||!m||!ws.current))switch(ws.current.requestType){case qc.REQUEST_TYPE_NONE:if(E)return;if(d.isBranch){for(const he of d.children)if(he&&he.isVisible){Pi(he);return}}return;case qc.REQUEST_TYPE_ID:wc(ws.current.requestById),ws.current.resetRequest();return;case qc.REQUEST_TYPE_OFFER:Pe(ws.current.requestedByOfferId),ws.current.resetRequest();return;case qc.REQUEST_TYPE_NAME:Fc(ws.current.requestByName),ws.current.resetRequest();return}},[a,d,m,E,Pi,wc,Pe,Fc]),h.useEffect(()=>{!C&&E&&E.pageId===-1&&wc(o)},[C,E,o,wc]),h.useEffect(()=>{p&&v({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null})},[p]),h.useEffect(()=>{!a||d||(K(new pP),K(new KC),K(new gP(c)),K(new dP))},[a,d,c]),h.useEffect(()=>(U(new kd(ce(),++kd.PREVIEW_COUNTER)),()=>{U(he=>(he.dispose(),null))}),[]),{isVisible:a,setIsVisible:e,isBusy:t,pageId:r,previousPageId:o,currentType:c,rootNode:d,offersToNodes:m,currentPage:E,setCurrentPage:I,currentOffer:p,setCurrentOffer:S,activeNodes:R,searchResult:C,setSearchResult:A,frontPageItems:b,roomPreviewer:M,navigationHidden:G,setNavigationHidden:F,purchaseOptions:H,setPurchaseOptions:v,catalogOptions:B,setCatalogOptions:z,getNodeById:Pl,getNodeByName:zo,activateNode:Pi,openPageById:wc,openPageByName:Fc,openPageByOfferId:Pe,requestOfferToMover:ht,isDraggable:Ze}},es=()=>Ht(qte),Xte=1e3,$te=10,Qte=1e3;let Jte=0,Zte=0;const ese=()=>{const[a,e]=h.useState([]),[t,i]=h.useState([]),[r,n]=h.useState([]),[o,l]=h.useState(!1),c=_=>{_.id=Jte++,e(m=>{const f=[...m];return f.push(_),f.length>Xte&&f.shift(),f})},u=_=>{i(m=>{const f=[...m];return f.push(_),f.length>$te&&f.shift(),f})},d=_=>{_.id=Zte++,n(m=>{const f=[...m];return f.push(_),f.length>Qte&&f.shift(),f})};return ms(Ve.STARTED,_=>l(!0)),J(bl,_=>{if(!o)return;const m=_.getParser();t.length&&t[t.length-1].id===m.data.roomId||(c({id:-1,webId:-1,entityId:-1,name:m.data.roomName,timestamp:pp(),type:Ar.TYPE_ROOM_INFO,roomId:m.data.roomId}),u({id:m.data.roomId,name:m.data.roomName}),l(!1))}),J(pC,_=>{const m=_.getParser();d({id:-1,webId:m.senderId,entityId:-1,name:"",message:m.messageText,roomId:-1,timestamp:jb(m.secondsSinceSent),type:Ar.TYPE_IM})}),J(IC,_=>{const m=_.getParser();d({id:-1,webId:m.senderId,entityId:-1,name:"",message:m.messageText,roomId:-1,timestamp:jb(),type:Ar.TYPE_IM})}),{addChatEntry:c,chatHistory:a,roomHistory:t,messengerHistory:r}},bT=()=>Ht(ese),tse=()=>{const[a,e]=h.useState([]),[t,i]=h.useState([]),[r,n]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState(null),d=h.useMemo(()=>{const R=a.filter(O=>O.online);return R.sort((O,C)=>O.name.toLowerCase().localeCompare(C.name.toLowerCase())),R},[a]),_=h.useMemo(()=>{const R=a.filter(O=>!O.online);return R.sort((O,C)=>O.name.toLowerCase().localeCompare(C.name.toLowerCase())),R},[a]),m=R=>K(new dT(R.id)),f=(R,O)=>O!==R.relationshipStatus&&K(new Kc(R.id,O)),E=R=>{for(const O of a)if(O.id===R)return O;return null},I=R=>!(R===te().userId||E(R)||t.find(O=>O.requesterUserId===R)||r.indexOf(R)>=0),p=(R,O)=>{if(!I(R))return!1;n(C=>{const A=[...C];return A.push(R),A}),K(new XC(O))},S=h.useCallback((R,O)=>{if(R===-1&&!O)K(new dx(!0)),i([]);else if(R===-1&&O){for(const C of t)K(new hx(C.id));i([])}else i(C=>{const A=[...C],b=A.findIndex(y=>y.id===R);return b===-1?C:(K(O?new hx(A[b].id):new dx(!1,A[b].id)),A.splice(b,1),A)})},[t]);return J(cM,R=>{const O=R.getParser();u(new aJ(O.userFriendLimit,O.normalFriendLimit,O.extendedFriendLimit,O.categories)),K(new MP)}),J(nM,R=>{const O=R.getParser();e(C=>{const A=[...C];for(const b of O.fragment){const y=A.findIndex(U=>U.id===b.id),M=new $i;M.populate(b),y>-1?A[y]=M:A.push(M)}return A})}),J(aM,R=>{const O=R.getParser();e(C=>{const A=[...C],b=y=>{const M=A.findIndex(U=>U.id===y.id);if(M===-1){const U=new $i;U.populate(y),A.unshift(U)}else A[M].populate(y)};for(const y of O.addedFriends)b(y);for(const y of O.updatedFriends)b(y);for(const y of O.removedFriendIds){const M=A.findIndex(U=>U.id===y);M>-1&&A.splice(M,1)}return A})}),J(oM,R=>{const O=R.getParser();i(C=>{const A=[...C];for(const b of O.requests){const y=A.findIndex(M=>M.requesterUserId===b.requesterUserId);if(y>0)A[y]=Dr(A[y]),A[y].populate(b);else{const M=new Lb;M.populate(b),A.push(M)}}return A})}),J(EC,R=>{const C=R.getParser().request;i(A=>{const b=[...A];if(b.findIndex(M=>M.requesterUserId===C.requesterUserId)===-1){const M=new Lb;M.populate(C),b.push(M)}return b})}),h.useEffect(()=>{K(new LP);const R=setInterval(()=>K(new DP),12e4);return()=>{clearInterval(R)}},[]),{friends:a,requests:t,sentRequests:r,dismissedRequestIds:o,setDismissedRequestIds:l,settings:c,onlineFriends:d,offlineFriends:_,getFriend:E,canRequestFriend:I,requestFriend:p,requestResponse:S,followFriend:m,updateRelationship:f}},Jr=()=>Ht(tse),sse=()=>{const[a,e]=h.useState([]),[t,i]=h.useState(-1),[r,n]=h.useState([]),[o,l]=h.useState(jo.HIDDEN),{getFriend:c=null}=Jr(),{simpleAlert:u=null}=kt(),d=h.useMemo(()=>a.filter(I=>r.indexOf(I.threadId)===-1),[a,r]),_=h.useMemo(()=>t>0&&d.find(I=>I.threadId===t||null),[t,d]),m=I=>{let p=a.find(S=>S.participant&&S.participant.id===I);if(p){const S=r.indexOf(p.threadId);S>=0&&n(R=>{const O=[...R];return O.splice(S,1),O})}else{const S=c(I);if(!S)return null;p=new Bx(S),p.addMessage(null,g("messenger.moderationinfo"),0,null,ua.SECURITY_NOTIFICATION),p.setRead(),e(R=>{const O=[...R];return O.push(p),O})}return p},f=I=>{n(p=>{const S=[...p];return S.indexOf(I)>=0?p:(S.push(I),S)}),t===I&&i(-1)},E=(I,p,S,R=0,O=null,C=ua.CHAT)=>{if(!I||!S||!S.length)return;const A=p===te().userId;A&&S.length<=255&&K(new UP(I.participant.id,S)),e(b=>{const y=[...b],M=y.findIndex(U=>U.threadId===I.threadId);return M===-1?b:(I=Dr(y[M]),A&&I.groups.length===1&&yl(Bo.MESSENGER_NEW_THREAD),I.addMessage(C===ua.ROOM_INVITE?null:p,S,R,O,C),t===I.threadId&&I.setRead(),y[M]=I,!A&&I.unread&&I.participant.name!=="Log Chat"&&yl(Bo.MESSENGER_MESSAGE_RECEIVED),y)}),!I.participant.online&&!I.participant.hasSendOfflineMessage&&(I.participant.hasSendOfflineMessage=!0,I.addMessage(null,De.instance.getLocalizationOrDefault("messenger.friendoffline","%s está offline, mas receberá as mensagens ao entrar.").replace("%s",I.participant.name),0,null,ua.STATUS_NOTIFICATION))};return J(pC,I=>{const p=I.getParser(),S=m(p.senderId);S&&E(S,p.senderId,p.messageText,p.secondsSinceSent,p.extraData)}),J(IC,I=>{const p=I.getParser(),S=m(p.senderId);S&&E(S,p.senderId,p.messageText,0,null,ua.ROOM_INVITE)}),J(uM,I=>{const p=I.getParser();u(`Received room invite error: ${p.errorCode},recipients: ${p.failedRecipients}`,lt.DEFAULT,null,null,g("friendlist.alert.title"))}),h.useEffect(()=>{t<=0||e(I=>{const p=[...I],S=p.findIndex(R=>R.threadId===t);return S>=0&&(p[S]=Dr(p[S]),p[S].setRead()),p})},[t]),h.useEffect(()=>{l(I=>{if(!d.length)return jo.HIDDEN;let p=!1;for(const S of d)if(S.unreadCount>0){p=!0;break}return p?jo.UNREAD:jo.SHOW})},[d]),{messageThreads:a,activeThread:_,iconState:o,visibleThreads:d,getMessageThread:m,setActiveThreadId:i,closeThread:f,sendMessage:E}},kG=()=>Ht(sse),ise=()=>{const[a,e]=h.useState(!1),[t,i]=h.useState(null),[r,n]=h.useState(null),[o,l]=h.useState(null),[c,u]=h.useState(!1),[d,_]=h.useState(null);return J(dM,m=>{let f=m.getParser();!f||f&&!f.games.length||(n(f.games[0]),i(f.games))}),J(hM,m=>{let f=m.getParser();f&&l(f)}),J(_M,m=>{let f=m.getParser();f&&u(f.isInMaintenance)}),J(TC,m=>{let f=m.getParser();if(f)switch(f.gameTypeId){case 2:return console.log("snowwar");default:return _(f.url)}}),h.useEffect(()=>{a&&K(new GP)},[a]),{isVisible:a,setIsVisible:e,games:t,accountStatus:o,selectedGame:r,setSelectedGame:n,gameOffline:c,gameURL:d,setGameURL:_}},vT=()=>Ht(ise),rse=()=>{const[a,e]=h.useState(null);return J(SC,t=>{const i=t.getParser(),r={badgeBases:[],badgeSymbols:[],badgePartColors:[],groupColorsA:[],groupColorsB:[]};i.bases.forEach((o,l)=>r.badgeBases.push({id:l,images:o})),i.symbols.forEach((o,l)=>r.badgeSymbols.push({id:l,images:o})),i.partColors.forEach((o,l)=>r.badgePartColors.push({id:l,color:o})),i.colorsA.forEach((o,l)=>r.groupColorsA.push({id:l,color:o})),i.colorsB.forEach((o,l)=>r.groupColorsB.push({id:l,color:o}));const n=(o,l)=>o.id<l.id?-1:o.id>l.id?1:0;r.badgeBases.sort(n),r.badgeSymbols.sort(n),r.badgePartColors.sort(n),r.groupColorsA.sort(n),r.groupColorsB.sort(n),e(r)}),h.useEffect(()=>{K(new zP)},[]),{groupCustomize:a}},Tm=()=>Ht(rse),jA=class jA{constructor(e,t,i){this._totalThreads=e,this._startIndex=t,this._threads=i,this._threadsById=new Map;for(let r=0;r<i.length;r++){const n=i[r];this._threadsById.set(n.threadId,n)}}get _Str_18760(){return this._totalThreads}get startIndex(){return this._startIndex}get threads(){return this._threads}get threadsById(){return this._threadsById}get size(){return this._threads.length}update(e){this.threadsById[e.threadId]=e;for(let t=0;t<this.threads.length;t++)if(this.threads[t].threadId==e.threadId)return this.threads[t]=e,!0;return!1}};jA.PAGE_SIZE=20;let KO=jA;class nse{constructor(e){this._listCode=e.listCode,this._totalAmount=e.totalAmount,this._startIndex=e.startIndex,this._forums=e.forums}get listCode(){return this._listCode}get totalAmount(){return this._totalAmount}get startIndex(){return this._startIndex}get forums(){return this._forums}get unreadMessages(){let e,t=0;for(let i=0;i<this._forums.length;i++)e=this._forums[i],e.unreadMessages>0&&t++;return t}getForumData(e){for(const t of this._forums)if(t.groupId==e)return t;return null}updateFrom(e,t){const i=this.getForumData(e.groupId);i!=null&&(i.updateFrom(e),i.lastReadMessageId=t)}}const ase=()=>{const[e,t]=h.useState(!1),[i,r]=h.useState(null),[n,o]=h.useState(null),[l,c]=h.useState(-1),[u,d]=h.useState(-1),[_,m]=h.useState(-1);h.useState(-1),h.useState(-1);const[f,E]=h.useState(-1),[I,p]=h.useState(new Map),S=h.useCallback((b=!1)=>{if(i){if(b||f>i.lastReadMessageId){const y=[];b?y.push(new _b(i.groupId,Math.max(i.totalMessages,f),f==0)):y.push(new _b(i.groupId,f,!1)),K(new cU(...y))}E(0),p(new Map)}},[i,f]),R=h.useCallback(b=>{S(),c(-1),d(b),E(0),K(new oU(b))},[S]),O=(b,y)=>{K(new lU(b,y,KO.PAGE_SIZE))},C=h.useCallback(b=>{R(b),O(b,0),t(!0)},[R]),A=b=>{_!=b&&m(b)};return J(TM,b=>{const M=b.getParser().extendedForumData;if(u==M.groupId){if(!M.hasReadPermissionError){r(null),d(0);return}r(M),E(M.lastReadMessageId)}}),J(SM,b=>{const y=b.getParser(),M=new nse(y);i!=null&&f>0&&M.updateFrom(i,f),M.listCode==2&&A(M.unreadMessages),l==M.listCode&&o(M)}),J(RM,b=>{}),J(bM,b=>{}),J(AM,b=>{}),J(CM,b=>{}),J(xM,b=>{}),J(OM,b=>{}),J(NM,b=>{}),{isVisible:e,setIsVisible:t,openGroupForum:C,requestThreadList:O,initForum:R,forumData:i,forumsListData:n}},wN=()=>Ht(ase),ose=()=>{const[a,e]=h.useState(null),[t,i]=h.useState(null),{simpleAlert:r=null,showConfirm:n=null}=kt(),o=(l,c)=>{const u={reportType:l,reportedUserId:-1,reportedChats:[],cfhCategory:-1,cfhTopic:-1,roomId:-1,roomName:"",messageId:-1,threadId:-1,groupId:-1,extraData:"",roomObjectId:-1,message:"",currentStep:0};switch(l){case xs.BULLY:case xs.EMERGENCY:case xs.IM:u.reportedUserId=c.reportedUserId,u.currentStep=fr.SELECT_CHATS;break;case xs.ROOM:u.roomId=c.roomId,u.roomName=c.roomName,u.currentStep=fr.SELECT_TOPICS;break;case xs.THREAD:u.groupId=c.groupId,u.threadId=c.threadId,u.currentStep=fr.SELECT_TOPICS;break;case xs.MESSAGE:u.groupId=c.groupId,u.threadId=c.threadId,u.messageId=c.messageId,u.currentStep=fr.SELECT_TOPICS;break;case xs.PHOTO:u.extraData=c.extraData,u.roomId=c.roomId,u.reportedUserId=c.reportedUserId,u.roomObjectId=c.roomObjectId,u.currentStep=fr.SELECT_TOPICS;break}e(u)};return J(LM,l=>{const c=l.getParser();let u=c.messageText;switch(c.resultType){case Ep.TOO_MANY_PENDING_CALLS_CODE:K(new xU),r(g("help.cfh.error.pending"),lt.MODERATION,null,null,g("help.cfh.error.title"));break;case Ep.HAS_ABUSIVE_CALL_CODE:r(g("help.cfh.error.abusive"),lt.MODERATION,null,null,g("help.cfh.error.title"));break;default:u.trim().length===0&&(u=g("help.cfh.sent.text")),r(u,lt.MODERATION,null,null,g("help.cfh.sent.title"))}}),J(VM,l=>{const c=l.getParser(),u=c.messageText.length===0?g("help.cfh.closed."+_J(c.closeReason)):c.messageText;r(u,lt.MODERATION,null,null,g("mod.alert.title"))}),J(MM,l=>{const c=l.getParser();c.count>0&&n(g("help.emergency.pending.title")+`
`+c.pendingCalls[0].message,()=>{K(new SU)},null,g("help.emergency.pending.button.discard"),g("help.emergency.pending.button.keep"),g("help.emergency.pending.message.subtitle"))}),J(DM,l=>{r("Your pending calls were deleted",lt.MODERATION,null,null,g("mod.alert.title"))}),J(jM,l=>{const c=l.getParser();r(c.message,lt.MODERATION,null,null,g("help.cfh.reply.title"))}),J(yM,l=>{const c=l.getParser();r(g("help.emergency.global_mute.message"),lt.MODERATION,c.infoUrl,g("help.emergency.global_mute.link"),g("help.emergency.global_mute.subtitle"))}),J(CD,l=>{const c=l.getParser();i(c)}),{activeReport:a,setActiveReport:e,sanctionInfo:t,setSanctionInfo:i,report:o}},Rn=()=>Ht(ose),yT=()=>{const[a,e]=h.useState([]),t=h.useMemo(()=>!!a.length,[a]),i=h.useCallback(()=>{let n=-1;return e(o=>{const l=[...o];return n=l.length?l[l.length-1]+1:0,l.push(n),l}),n},[]),r=h.useCallback(n=>{e(o=>{const l=[...o],c=l.indexOf(n);return c===-1?o:(l.splice(c,1),l)})},[]);return{isVisible:t,activate:i,deactivate:r}},lse=a=>K(new HU(a)),cse=(a,e)=>K(new WU(a,...e)),use=()=>{const[a,e]=h.useState(new Map),t=h.useCallback(c=>{var u;return((u=a.get(c))==null?void 0:u.length)||0},[a]),i=h.useMemo(()=>{let c=0;for(const u of a.keys())c+=t(u);return c},[a,t]),r=h.useCallback(c=>{let u=!0;return e(d=>{if(!d.has(c))return u=!1,d;const _=new Map(d);return _.delete(c),lse(c),_}),u},[]),n=h.useCallback((c,u)=>{let d=!0;return e(_=>{if(!_.has(c))return d=!1,_;const m=new Map(_),f=m.get(c);if(f)for(const E of u)f.splice(f.indexOf(E),1);return cse(c,u),m}),d},[]),o=h.useCallback((c,u)=>a.has(c)?a.get(c).indexOf(u)>=0:!1,[a]),l=h.useCallback((c,u)=>{e(d=>{if(!d.has(c))return d;const _=new Map(d),m=_.get(c),f=m.indexOf(u);return f>=0&&m.splice(f,1),_})},[]);return J(oj,c=>{const u=c.getParser();e(d=>{const _=new Map(d);for(const m of u.categories){let f=_.get(m);f||(f=[],_.set(m,f));const E=u.getItemsByCategory(m);for(const I of E)f.indexOf(I)===-1&&f.push(I)}return _})}),{getCount:t,getFullCount:i,resetCategory:r,resetItems:n,isUnseen:o,removeUnseen:l}},Qn=()=>Ht(use),hse=()=>{const[a,e]=h.useState(!0),[t,i]=h.useState([]),[r,n]=h.useState(new Map),[o,l]=h.useState([]),[c,u]=h.useState([]),[d,_]=h.useState(null),{isVisible:m=!1,activate:f=null,deactivate:E=null}=yT(),{isUnseen:I=null,resetCategory:p=null}=Qn(),[S,R]=h.useState(!1),O=xe("user.badges.max.slots",5)+1,C=G=>o.indexOf(G)>=0,A=G=>c.indexOf(G)>=0,b=()=>o.length<O,y=G=>{l(F=>{const H=[...F],v=H.indexOf(G);if(v===-1){if(!b())return F;H.push(G)}else H.splice(v,1);const B=new cp;for(let z=0;z<O;z++)B.addActivatedBadge(H[z]??"");return K(B),H})},M=G=>{u(F=>{const H=[...F],v=H.indexOf(G);return v===-1?(H.push(G),K(new jU(G))):(H.splice(v,1),K(new LU(G))),H})},U=G=>t.indexOf(G)===-1?0:r.get(G)??0;return J(KM,G=>{const F=G.getParser(),H=[];n(v=>{const B=new Map;return F.getAllBadgeCodes().forEach(z=>{const $=t.indexOf(z)>=0,W=F.getBadgeId(z);B.set(z,W),!$&&H.push(z)}),B}),l(F.getActiveBadgeCodes()),u(F.getHiddenBadgeCodes()),i(v=>[...v.filter(B=>F.getAllBadgeCodes().includes(B)),...H])}),J(zM,G=>{const F=G.getParser(),H=I(Ps.BADGE,F.badgeId);i(v=>{const B=[...v];return H?B.unshift(F.badgeCode):B.push(F.badgeCode),B}),n(v=>{const B=new Map(v);return B.set(F.badgeCode,F.badgeId),B})}),h.useEffect(()=>{!t||!t.length||_(G=>{let F=G;return F&&t.indexOf(F)===-1&&(F=null),F||(F=t[0]),F})},[t]),h.useEffect(()=>{if(m)return()=>{p(Ps.BADGE)}},[m,p]),h.useEffect(()=>{!m||!a||(K(new MU),e(!1))},[m,a]),{badgeCodes:t,activeBadgeCodes:o,selectedBadgeCode:d,maxBadgeCount:O,setSelectedBadgeCode:_,setActiveBadgeCodes:l,isWearingBadge:C,isHiddenBadge:A,seeHiddenBadges:S,setSeeHiddenBadges:R,canWearBadges:b,toggleBadge:y,toggleHideBadge:M,getBadgeId:U,activate:f,deactivate:E}},Yd=()=>Ht(hse),dse=()=>{const[a,e]=h.useState(!0),[t,i]=h.useState([]),[r,n]=h.useState(null),{isVisible:o=!1,activate:l=null,deactivate:c=null}=yT(),{isUnseen:u=null,resetCategory:d=null}=Qn();return J(SD,_=>{const m=_.getParser();i(f=>{const E=[...f],I=E.map(S=>S.botData.id),p=[];for(const S of m.items.values())I.indexOf(S.id)===-1&&p.push(S);for(const S of I){let R=!0;for(const A of m.items.values())if(A.id===S){R=!1;break}if(!R)continue;const O=E.findIndex(A=>A.botData.id===S),C=E[O];O===-1||!C||(Ac()===C.botData.id&&(Xg(),Ce("inventory/open")),E.splice(O,1))}for(const S of p){const R={botData:S};u(Ps.BOT,S.id)?E.unshift(R):E.push(R)}return E})}),J(TD,_=>{const m=_.getParser();i(f=>{const E=[...f];if(E.findIndex(R=>R.botData.id===m.item.id)>=0)return f;const p={botData:m.item};return u(Ps.BOT,p.botData.id)?E.unshift(p):E.push(p),E})}),J(RD,_=>{const m=_.getParser();i(f=>{const E=[...f],I=E.findIndex(p=>p.botData.id===m.itemId);return I===-1?f:(E.splice(I,1),Ac()===m.itemId&&(Xg(),Ce("inventory/show")),E)})}),h.useEffect(()=>{!t||!t.length||n(_=>{let m=_;return m&&t.indexOf(m)===-1&&(m=null),m||(m=t[0]),m})},[t]),h.useEffect(()=>{if(o)return()=>{d(Ps.BOT)}},[o,d]),h.useEffect(()=>{!o||!a||(K(new px),e(!1))},[o,a]),{botItems:t,selectedBot:r,setSelectedBot:n,activate:l,deactivate:c}},GG=()=>Ht(dse);let Pm=null;const _se=()=>{const[a,e]=br(tr.SAVED_SELECT_RESULT,null),[t,i]=br(tr.SAVED_INVENTORY_PAGE,0),[r,n]=h.useState(!0),[o,l]=h.useState([]),[c,u]=h.useState(null),[d,_]=h.useState(null),[m,f]=h.useState(null),{isVisible:E=!1,activate:I=null,deactivate:p=null}=yT(),{isUnseen:S=null,resetCategory:R=null}=Qn(),[O,C]=h.useState(0);h.useEffect(()=>{a&&f(a)},[]),h.useEffect(()=>{e(m)},[m,e]),h.useEffect(()=>{C(t)},[]),h.useEffect(()=>{i(O)},[O,i]);const A=M=>{if(!(!o||!o.length))return o.filter(U=>U.type===M)},b=M=>{if(!(!o||!o.length)){for(const U of o){const G=U.getItemById(M);if(G&&G.isWallItem)return U}return null}},y=M=>{if(!(!o||!o.length)){for(const U of o){const G=U.getItemById(M);if(G&&!G.isWallItem)return U}return null}};return J(NC,M=>{const U=M.getParser();l(G=>{const F=[...G];for(const H of U.items){let v=0,B=null;for(;v<F.length;){const z=F[v];let $=0;for(;$<z.items.length;){const W=z.items[$];if(W.id===H.itemId){W.update(H);const V=[...z.items];V[$]=W,z.items=V,B=z;break}$++}if(B)break;v++}if(B)B.hasUnseenItems=!0,F[v]=Dr(B);else{const z=new qg(H);Rb(F,z,S(Ps.FURNI,H.itemId)),_i(new lm(z.id,z.type,z.category))}}return F})}),J(qf,M=>{const U=M.getParser();Pm||(Pm=new Array(U.totalFragments));const G=HQ(U.fragment,U.totalFragments,U.fragmentNumber,Pm);G&&(l(F=>{const H=[...F],v=WQ(H);for(const B of v){if(G.get(B))continue;let z=0;for(;z<H.length;){const $=H[z],W=$.remove(B);if(!W){z++;continue}Ac()===W.ref&&(Xg(),wd($)||Ce("inventory/show")),$.getTotalCount()<=0&&(H.splice(z,1),$.dispose());break}}for(const B of G.keys()){if(v.indexOf(B)>=0)continue;const z=G.get(B);if(!z)continue;const $=new qg(z);Rb(H,$,S(Ps.FURNI,B)),_i(new lm($.id,$.type,$.category))}return H}),Pm=null)}),J(XM,M=>{n(!0)}),J(AC,M=>{const U=M.getParser();l(G=>{const F=[...G];let H=0;for(;H<F.length;){const v=F[H],B=v.remove(U.itemId);if(!B){H++;continue}Ac()===B.ref&&(Xg(),wd(v)||Ce("inventory/show")),v.getTotalCount()<=0&&(F.splice(H,1),v.dispose());break}return F})}),J($M,M=>{}),h.useEffect(()=>{!o||!o.length||u(M=>{let U=M;return U&&o.indexOf(U)===-1&&(U=null),U||(U=o[0]),U})},[o]),h.useEffect(()=>{if(E)return()=>{R(Ps.FURNI)&&l(M=>{const U=[...M];for(const G of U)G.hasUnseenItems=!1;return U})}},[E,R]),h.useEffect(()=>{!E||!r||(K(new $C),n(!1))},[E,r]),{isVisible:E,needsUpdate:r,setNeedsUpdate:n,groupItems:o,setGroupItems:l,selectedItem:c,setSelectedItem:u,activate:I,deactivate:p,getWallItemById:b,getFloorItemById:y,getItemsByType:A,searchResult:d,setSearchResult:_,selectResult:m,setSelectResult:f,currentPage:O,setCurrentPage:C}},$a=()=>Ht(_se);let Um=null;const gse=()=>{const[a,e]=h.useState(!0),[t,i]=h.useState([]),[r,n]=h.useState(null),{isVisible:o=!1,activate:l=null,deactivate:c=null}=yT(),{isUnseen:u=null,resetCategory:d=null}=Qn();return J(ZM,_=>{const m=_.getParser();Um||(Um=new Array(m.totalFragments));const f=eJ(m.fragment,m.totalFragments,m.fragmentNumber,Um);f&&(i(E=>{const I=[...E];return ZQ(I,f,u),I}),Um=null)}),J(JM,_=>{const m=_.getParser();i(f=>{const E=[...f];return Ck(m.pet,E,u(Ps.PET,m.pet.id)),E})}),J(t0,_=>{const m=_.getParser();i(f=>{const E=[...f];return Nk(m.petId,E),E})}),h.useEffect(()=>{!t||!t.length||n(_=>{let m=_;return m&&t.indexOf(m)===-1&&(m=null),m||(m=t[0]),m})},[t]),h.useEffect(()=>{if(o)return()=>{d(Ps.PET)}},[o,d]),h.useEffect(()=>{!o||!a||(K(new Ix),e(!1))},[o,a]),{petItems:t,selectedPet:r,setSelectedPet:n,activate:l,deactivate:c}},BG=()=>Ht(gse),mse=()=>{const[a,e]=h.useState(null),[t,i]=h.useState(null),[r,n]=h.useState(Ti.TRADING_STATE_READY),{groupItems:o=[],setGroupItems:l=null,activate:c=null,deactivate:u=null}=$a(),{simpleAlert:d=null,showTradeAlert:_=null}=kt(),m=r>=Ti.TRADING_STATE_RUNNING,f=()=>{switch(r){case Ti.TRADING_STATE_RUNNING:!t.itemCount&&!a.accepts&&d(g("inventory.trading.warning.other_not_offering"),null,null,null),a.accepts?K(new VU):K(new PU);return;case Ti.TRADING_STATE_CONFIRMING:K(new FU),n(Ti.TRADING_STATE_CONFIRMED);return}},E=p=>{const S=p.getLastItem();S&&K(new GU(S.id))},I=()=>{if(m)switch(r){case Ti.TRADING_STATE_RUNNING:K(new wU);return;default:K(new UU);return}};return J(s0,p=>{const S=p.getParser();!a||!t||(a.userId===S.userID?e(R=>{const O=Dr(R);return O.accepts=S.userAccepts,O}):t.userId===S.userID&&i(R=>{const O=Dr(R);return O.accepts=S.userAccepts,O}))}),J(i0,p=>{const S=p.getParser();S.reason===Wf.ERROR_WHILE_COMMIT?_(zr.ERROR_WHILE_COMMIT):a&&S.userID!==a.userId&&_(zr.THEY_CANCELLED),e(null),i(null),n(Ti.TRADING_STATE_READY)}),J(r0,p=>{p.getParser(),e(null),i(null),n(Ti.TRADING_STATE_READY)}),J(n0,p=>{p.getParser(),n(Ti.TRADING_STATE_COUNTDOWN)}),J(a0,p=>{const S=p.getParser(),R=Db(S.firstUserItemArray),O=Db(S.secondUserItemArray);e(C=>{const A=Dr(C);A.userId===S.firstUserID?(A.creditsCount=S.firstUserNumCredits,A.itemCount=S.firstUserNumItems,A.userItems=R):(A.creditsCount=S.secondUserNumCredits,A.itemCount=S.secondUserNumItems,A.userItems=O);const b=[];for(const y of A.userItems.getValues()){let M=0;for(;M<y.getTotalCount();){const U=y.getItemByIndex(M);U&&b.push(U.ref),M++}}return l(y=>{const M=[...y];for(const U of M)U.lockItemIds(b);return M}),A}),i(C=>{const A=Dr(C);return A.userId===S.firstUserID?(A.creditsCount=S.firstUserNumCredits,A.itemCount=S.firstUserNumItems,A.userItems=R):(A.creditsCount=S.secondUserNumCredits,A.itemCount=S.secondUserNumItems,A.userItems=O),A})}),J(o0,p=>{p.getParser()}),J(l0,p=>{const S=p.getParser(),R=new vb,O=$e().userDataManager.getUserData(S.userID);R.userItems=new Ms;const C=new vb,A=$e().userDataManager.getUserData(S.otherUserID);C.userItems=new Ms,O.webID===te().userId?(R.userId=O.webID,R.userName=O.name,R.canTrade=S.userCanTrade,C.userId=A.webID,C.userName=A.name,C.canTrade=S.otherUserCanTrade):A.webID===te().userId&&(R.userId=A.webID,R.userName=A.name,R.canTrade=S.otherUserCanTrade,C.userId=O.webID,C.userName=O.name,C.canTrade=S.userCanTrade),e(R),i(C),n(Ti.TRADING_STATE_RUNNING)}),J(c0,p=>{const S=p.getParser();_(S.reason,S.otherUserName)}),J(u0,p=>{p.getParser(),_(zr.THEY_NOT_ALLOWED)}),J(h0,p=>{p.getParser(),_(zr.YOU_NOT_ALLOWED)}),h.useEffect(()=>{if(r===Ti.TRADING_STATE_READY)return;const p=c();return()=>u(p)},[r,c,u]),{ownUser:a,otherUser:t,tradeState:r,setTradeState:n,isTrading:m,groupItems:o,progressTrade:f,removeItem:E,stopTrading:I}},VG=()=>Ht(mse),fse=()=>br(tr.INVENTORY_SKIP_DELETE_ITEM_CONFIRMATION,!1),HG=()=>Ht(fse),pse=()=>br(tr.WIRED_SKIP_OWNER_CONFIRMATION,!1),WG=()=>Ht(pse),Ese=()=>{const[a,e]=h.useState(null),[t,i]=h.useState([]),[r,n]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState([]),[d,_]=h.useState([]),[m,f]=h.useState([]),{simpleAlert:E=null}=kt(),I=F=>{t.indexOf(F)>=0||i(H=>[...H,F])},p=F=>{i(H=>{const v=[...H],B=v.indexOf(F);return B>=0&&v.splice(B),v})},S=F=>{t.indexOf(F)>=0?p(F):I(F)},R=F=>{r.indexOf(F)>=0||n(H=>[...H,F])},O=F=>{n(H=>{const v=[...H],B=v.indexOf(F);return B>=0&&v.splice(B),v})},C=F=>{r.indexOf(F)>=0?O(F):R(F)},A=F=>{o.indexOf(F)>=0||l(H=>[...H,F])},b=F=>{l(H=>{const v=[...H],B=v.indexOf(F);return B>=0&&v.splice(B),v})},y=F=>{o.indexOf(F)>=0?b(F):A(F)},M=F=>{c.indexOf(F)>=0||u(H=>[...H,F])},U=F=>{u(H=>{const v=[...H],B=v.indexOf(F);return B>=0&&v.splice(B),v})},G=F=>{r.indexOf(F)>=0?U(F):M(F)};return J(N0,F=>{const v=F.getParser().data;e(v),_(v.issues)}),J(R0,F=>{const H=F.getParser();_(v=>{const B=[...v],z=B.findIndex($=>$.issueId===H.issueData.issueId);return z>=0?B[z]=H.issueData:(B.push(H.issueData),yl(Bo.MODTOOLS_NEW_TICKET)),B})}),J(v0,F=>{F.getParser()}),J(x0,F=>{F.getParser()&&E("Failed to pick issue",lt.DEFAULT,null,null,"Error")}),J(S0,F=>{const H=F.getParser();_(v=>{const B=[...v],z=B.findIndex($=>$.issueId===H.issueId);return z>=0&&B.splice(z,1),B})}),J(O0,F=>{F.getParser().success?E("Moderation action was successfull",lt.MODERATION,null,null,"Success"):E("There was a problem applying tht moderation action",lt.MODERATION,null,null,"Error")}),J(OD,F=>{const H=F.getParser();f(H.callForHelpCategories)}),J(xD,F=>{F.getParser()}),{settings:a,openRooms:t,openRoomChatlogs:r,openUserChatlogs:c,openUserInfos:o,cfhCategories:m,tickets:d,openRoomInfo:I,closeRoomInfo:p,toggleRoomInfo:S,openRoomChatlog:R,closeRoomChatlog:O,toggleRoomChatlog:C,openUserInfo:A,closeUserInfo:b,toggleUserInfo:y,openUserChatlog:M,closeUserChatlog:U,toggleUserChatlog:G}},Zd=()=>Ht(Ese),Ise=()=>{const[a,e]=h.useState(null),[t,i]=h.useState(null),[r,n]=h.useState(null),[o,l]=h.useState(null),[c,u]=h.useState({roomInfo:null,state:Wt.NONE}),[d,_]=h.useState(null),[m,f]=h.useState({settingsReceived:!1,homeRoomId:0,enteredGuestRoom:null,currentRoomOwner:!1,currentRoomId:0,currentRoomIsStaffPick:!1,createdFlatId:0,avatarId:0,roomPicker:!1,eventMod:!1,currentRoomRating:0,canRate:!0,favouriteRooms:[]}),{simpleAlert:E=null}=kt();return J(q0,I=>{const p=I.getParser();K(new Vg(p.roomId,!1,!1))}),J(k0,I=>{const p=I.getParser();p.canCreate||E(g(`navigator.cannotcreateevent.error.${p.errorCode}`),null,null,null,g("navigator.cannotcreateevent.title"))}),J(Ld,I=>{K(new p1),K(new tN)}),J(PC,I=>{const p=I.getParser();f(S=>{const R={...S};return R.eventMod=p.securityLevel>=zu.MODERATOR,R.roomPicker=p.securityLevel>=zu.COMMUNITY,R})}),J(bj,I=>{const p=I.getParser();qn(p.roomId)}),J(MC,I=>{const p=I.getParser();f(S=>{const R={...S};return R.enteredGuestRoom=null,R.currentRoomOwner=p.isOwner,R.currentRoomId=p.roomId,R}),K(new Vg(p.roomId,!0,!1)),Me.available&&Me.call("legacyTrack","navigator","private",[p.roomId])}),J(bl,I=>{const p=I.getParser();if(p.roomEnter)u({roomInfo:null,state:Wt.NONE}),f(S=>{const R={...S};return R.enteredGuestRoom=p.data,R.currentRoomIsStaffPick=p.staffPick,!(R.createdFlatId===p.data.roomId)&&p.data.displayRoomEntryAd&&xe("roomenterad.habblet.enabled",!1)&&Xa.openRoomEnterAd(),R.createdFlatId=0,R.enteredGuestRoom&&R.enteredGuestRoom.habboGroupId>0,R});else if(p.roomForward){if(p.data.ownerName!==te().userName&&!p.isGroupMember)switch(p.data.doorMode){case is.DOORBELL_STATE:u(S=>{const R={...S};return R.roomInfo=p.data,R.state=Wt.START_DOORBELL,R});return;case is.PASSWORD_STATE:u(S=>{const R={...S};return R.roomInfo=p.data,R.state=Wt.START_PASSWORD,R});return;case is.INVISIBLE_STATE:if(!te().isModerator)break;u(S=>{const R={...S};return R.roomInfo=p.data,R.state=Wt.START_INVISIBLE,R});return}if(p.data.doorMode===is.NOOB_STATE&&!te().isAmbassador&&!te().isRealNoob&&!te().isModerator)return;_c(p.data.roomId)}else f(S=>{const R={...S};return R.enteredGuestRoom=p.data,R.currentRoomIsStaffPick=p.staffPick,R})}),J(Dj,I=>{const p=I.getParser();f(S=>{const R={...S};return R.currentRoomRating=p.totalLikes,R.canRate=p.canLike,R})}),J(bC,I=>{const p=I.getParser();(!p.userName||p.userName.length===0)&&u(S=>{const R={...S};return R.state=Wt.STATE_WAITING,R})}),J($f,I=>{const p=I.getParser();(!p.userName||p.userName.length===0)&&u(S=>{const R={...S};return R.state=Wt.STATE_ACCEPTED,R})}),J(Xf,I=>{const p=I.getParser();(!p.userName||p.userName.length===0)&&u(S=>{const R={...S};return R.state=Wt.STATE_NO_ANSWER,R})}),J(Kf,I=>{switch(I.getParser().errorCode){case-100002:u(S=>{const R={...S};return R.state=Wt.STATE_WRONG_PASSWORD,R});return;case 4009:E(g("navigator.alert.need.to.be.vip"),lt.DEFAULT,null,null,g("generic.alert.title"));return;case 4010:E(g("navigator.alert.invalid_room_name"),lt.DEFAULT,null,null,g("generic.alert.title"));return;case 4011:E(g("navigator.alert.cannot_perm_ban"),lt.DEFAULT,null,null,g("generic.alert.title"));return;case 4013:E(g("navigator.alert.room_in_maintenance"),lt.DEFAULT,null,null,g("generic.alert.title"));return}}),J(H0,I=>{const p=I.getParser();l(p.topLevelContexts),n(p.topLevelContexts.length?p.topLevelContexts[0]:null)}),J(Y0,I=>{const p=I.getParser();n(S=>{let R=S;if(R||(R=o&&o.length&&o[0]||null),!R)return null;if(p.result.code!==R.code&&o&&o.length)for(const O of o)O.code===p.result.code&&(R=O);for(const O of o)O.code===p.result.code&&(R=O);return R}),_(p.result)}),J($0,I=>{const p=I.getParser();e(p.categories)}),J(X0,I=>{const p=I.getParser();i(p.categories)}),J(B0,I=>{const p=I.getParser();_c(p.roomId)}),J(G0,I=>{const p=I.getParser(),S=p.limit,R=p.favoriteRoomIds.slice(0,S);f(O=>{const C={...O};return C.favouriteRooms=R,C})}),J(V0,I=>{const p=I.getParser();let S=!1;if(f(C=>{S=C.settingsReceived;const A={...C};return A.homeRoomId=p.homeRoomId,A.settingsReceived=!0,A}),S)return;let R=-1,O=-1;xe("friend.id")!==void 0&&parseInt(xe("friend.id"))>0&&(R=0,K(new dT(parseInt(xe("friend.id"))))),xe("forward.type")!==void 0&&xe("forward.id")!==void 0&&(R=parseInt(xe("forward.type")),O=parseInt(xe("forward.id"))),R===2?qn(O):R===-1&&p.roomIdToEnter>0&&(Ce("navigator/close"),p.roomIdToEnter!==p.homeRoomId?_c(p.roomIdToEnter):_c(p.homeRoomId))}),J(Aj,I=>{const p=I.getParser();switch(p.reason){case Td.REASON_FULL:E(g("navigator.guestroomfull.text"),lt.DEFAULT,null,null,g("navigator.guestroomfull.title"));break;case Td.REASON_QUEUE_ERROR:E(g(`room.queue.error.${p.parameter}`),lt.DEFAULT,null,null,g("room.queue.error.title"));break;case Td.REASON_BANNED:E(g("navigator.banned.text"),lt.DEFAULT,null,null,g("navigator.banned.title"));break;default:E(g("room.queue.error.title"),lt.DEFAULT,null,null,g("room.queue.error.title"));break}rk()}),J(W0,I=>Ce("navigator/show")),{categories:a,doorData:c,setDoorData:u,topLevelContext:r,topLevelContexts:o,searchResult:d,navigatorData:m}},Ir=()=>Ht(Ise),Tse=()=>{const[a,e]=h.useState(new ON),t=h.useMemo(()=>xe("hc.disabled",!1),[]),i=[{type:Qt.SYSTEM,parameters:"",name:[":shake",":rotate"],description:Oe().getLocalizationOrDefault("commands.shake.description","Faça o quarto balançar.")},{type:Qt.SYSTEM,parameters:"",name:[":d",";d"],description:Oe().getLocalizationOrDefault("commands.laugh.description","Dê uma risada!")},{type:Qt.SYSTEM,parameters:"",name:["o/","_o/"],description:Oe().getLocalizationOrDefault("commands.wave.description","Acenar para outros usuários.")},{type:Qt.SYSTEM,parameters:"",name:[":kiss"],description:Oe().getLocalizationOrDefault("commands.kiss.description","Mande um beijo para todos do quarto.")},{type:Qt.SYSTEM,parameters:"",name:[":jump"],description:Oe().getLocalizationOrDefault("commands.jump.description","Pular (apenas para HCs)")},{type:Qt.SYSTEM,parameters:"",name:[":idle"],description:Oe().getLocalizationOrDefault("commands.idle.description","Faz o boneco entrar em ZzZz.")},{type:Qt.SYSTEM,parameters:"",name:["_b"],description:Oe().getLocalizationOrDefault("commands.respect.description","Mande um joia para o quarto.")},{type:Qt.SYSTEM,parameters:"%signal%",name:[":sign"],description:Oe().getLocalizationOrDefault("commands.sign.description","Mande um sinal para todos.")},{type:Qt.SYSTEM,parameters:"%zoom%",name:[":zoom"],description:Oe().getLocalizationOrDefault("commands.zoom.description","Dê zoom no quarto.")},{type:Qt.SYSTEM,parameters:"",name:[":screenshot"],description:Oe().getLocalizationOrDefault("commands.screenshot.description","Tirar uma foto do quarto.")},{type:Qt.SYSTEM,parameters:"",name:[":pickall"],description:Oe().getLocalizationOrDefault("commands.pickall.description","Recolher todos os móveis (apenas com direitos)")},{type:Qt.SYSTEM,parameters:"",name:[":ejectall"],description:Oe().getLocalizationOrDefault("commands.ejectall.description","Expulsar todos os usuários (apenas com direitos).")},{type:Qt.SYSTEM,parameters:"",name:[":pickallwired"],description:Oe().getLocalizationOrDefault("commands.pickallwired.description","Recolher todos os wireds (apenas com direitos).")},{type:Qt.SYSTEM,parameters:"",name:[":pickallrares",":pickrares",":pickraros"],description:Oe().getLocalizationOrDefault("commands.pickrares.description","Recolher todos os móveis raros (apenas com direitos).")},{type:Qt.SYSTEM,parameters:"",name:[":furni"],description:Oe().getLocalizationOrDefault("commands.furni.description","Abrir seletor de mobilias.")},{type:Qt.SYSTEM,parameters:"",name:[":chooser"],description:Oe().getLocalizationOrDefault("commands.chooser.description","Abrir seletor de usuários.")},{type:Qt.SYSTEM,parameters:"",name:[":tags"],description:Oe().getLocalizationOrDefault("commands.tags.description","Mostrar editor de tags.")},{type:Qt.SYSTEM,parameters:"",name:[":floor",":bcfloor"],description:Oe().getLocalizationOrDefault("commands.floor.description","Abrir editor de piso (apenas com direitos).")},{type:Qt.SYSTEM,parameters:"",name:[":wall",":bcwall"],description:Oe().getLocalizationOrDefault("commands.wall.description","Abrir editor de parede (apenas com direitos).")},{type:Qt.SYSTEM,parameters:"",name:[":togglefps"],description:Oe().getLocalizationOrDefault("commands.togglefps.description","Alternar limite de FPS. Quando desligado o limite, o FPS é ilimitado.")},{type:Qt.SYSTEM,parameters:"%limit%",name:[":fps"],description:Oe().getLocalizationOrDefault("commands.fps.description","Definir limite de FPS.")},{type:Qt.SYSTEM,parameters:"%state%",name:[":state"],description:Oe().getLocalizationOrDefault("commands.state.description","Forçar estado em mobilias.")},{type:Qt.SYSTEM,parameters:"",name:[":stateoff"],description:Oe().getLocalizationOrDefault("commands.stateoff.description","Desativar estado forçado em mobilias.")},{type:Qt.SYSTEM,parameters:"%direction%",name:[":pin"],description:Oe().getLocalizationOrDefault("commands.pin.description","Forçar direção em mobilias.")},{type:Qt.SYSTEM,parameters:"",name:[":pinoff"],description:Oe().getLocalizationOrDefault("commands.pinoff.description","Desativar direção forçada em mobilias.")},{type:Qt.SYSTEM,parameters:"",name:[":ping"],description:Oe().getLocalizationOrDefault("commands.ping.description","Mostra o ping. (Apenas para você)")},{type:Qt.SYSTEM,parameters:"",name:[":pingsay"],description:Oe().getLocalizationOrDefault("commands.pingsay.description","Mostra o ping para todos do quarto.")},{type:Qt.SYSTEM,parameters:"",name:[":doubleclick",":dbclick"],description:Oe().getLocalizationOrDefault("commands.doubleclick.description","Alternar duplo clique.")},{type:Qt.SYSTEM,parameters:"",name:[":settings"],description:Oe().getLocalizationOrDefault("commands.settings.description","Abrir configurações do quarto (apenas com direitos).")},{type:Qt.SYSTEM,parameters:"",name:[":mention"],description:Oe().getLocalizationOrDefault("commands.mention.description","Mostrar histórico de menções.")},{type:Qt.BASIC,parameters:"",name:[":wf",":wiredtools",":wiredtool"],description:Oe().getLocalizationOrDefault("commands.wiredtools.description","Abrir ferramentas de wired.")},{type:Qt.BASIC,parameters:"",name:[":var",":variables",":variaveis"],description:Oe().getLocalizationOrDefault("commands.variables.description","Abrir ferramenta de wired na aba de variáveis.")},{type:Qt.BASIC,parameters:"",name:[":inspect",":inspection",":inspecionar"],description:Oe().getLocalizationOrDefault("commands.inspect.description","Abrir ferramenta de wired na aba de inspeção.")},{type:Qt.BASIC,parameters:"",name:[":playtest"],description:Oe().getLocalizationOrDefault("commands.playtest.description","Ativa o modo de jogar sem direitos no quarto.")},{type:Qt.BASIC,parameters:"",name:[":hidechat"],description:Oe().getLocalizationOrDefault("commands.hidechat.description","Ative ou desative o chat no quarto.")}],[r,n]=h.useState(i),o=h.useMemo(()=>t||a.clubDays>0?vo.ACTIVE:a.pastVipDays>0||a.pastVipDays>0?vo.EXPIRED:vo.NONE,[a,t]),l=c=>{if(c===-1)return a.credits;for(const[u,d]of a.activityPoints.entries())if(u===c)return d;return 0};return J(GL,c=>{const u=c.getParser();e(d=>{const _=Dr(d);return _.credits=parseFloat(u.credits),d.credits!==_.credits&&yl(Bo.CREDITS),_})}),J(BL,c=>{const u=c.getParser();e(d=>{const _=Dr(d);return _.activityPoints=u.currencies,Me.call("setCurrencies",_.activityPoints),_})}),J(vC,c=>{const u=c.getParser();e(d=>{const _=Dr(d);return _.activityPoints=new Map(_.activityPoints),_.activityPoints.set(u.type,u.amount),u.type===0&&yl(Bo.DUCKETS),Me.call("setCurrencies",_.activityPoints),_})}),J(VL,c=>{const u=c.getParser(),d=u.productName;d!=="club_habbo"&&d!=="habbo_club"||e(_=>{const m=Dr(_);return m.clubDays=Math.max(0,u.daysToPeriodEnd),m.clubPeriods=Math.max(0,u.periodsSubscribedAhead),m.isVip=u.isVip,m.pastClubDays=u.pastClubDays,m.pastVipDays=u.pastVipDays,m.isExpiring=u.responseType===kf.RESPONSE_TYPE_DISCOUNT_AVAILABLE,m.minutesUntilExpiration=u.minutesUntilExpiration,m.minutesSinceLastModified=u.minutesSinceLastModified,m})}),J(wL,c=>{const u=c.getParser().commands,d=[...i,...u].map(_=>{const m=/(%\w+%|<\w+>)/g,f=_.parameters?_.parameters.match(m)||[]:[];return{..._,name:[`${_.name.join(" / ")} ${f.map(E=>`(${E.slice(1,-1)})`).join(" ")}`],description:_.description.replace(m,"").trim()}}).sort((_,m)=>_.name[0].localeCompare(m.name[0]));n(d)}),h.useEffect(()=>{if(t)return;K(new bx("habbo_club"));const c=setInterval(()=>K(new bx("habbo_club")),5e4);return()=>clearInterval(c)},[t]),h.useEffect(()=>{K(new vF)},[]),{purse:a,hcDisabled:t,commandsList:r,clubStatus:o,getCurrencyAmount:l}},Qa=()=>Ht(Tse),Sse=(a,e)=>{h.useEffect(()=>{if(!a)return;const t=i=>e(i);return Go.addEventListener(hs.FURNI_ADDED,t),()=>{Go.removeEventListener(hs.FURNI_ADDED,t)}},[a,e])},Zr=(a,e)=>{h.useEffect(()=>{if(!a)return;const t=i=>e(i);return Go.addEventListener(hs.FURNI_REMOVED,t),()=>{Go.removeEventListener(hs.FURNI_REMOVED,t)}},[a,e])},YG=a=>{Js(hs.OBJECT_DESELECTED,a)},Rse=a=>{Js(hs.OBJECT_ROLL_OUT,a)},xse=a=>{Js(hs.OBJECT_ROLL_OVER,a)},Sm=a=>{Js(hs.OBJECT_SELECTED,a)},zG=(a,e)=>{h.useEffect(()=>{if(!a)return;const t=i=>e(i);return Go.addEventListener(hs.USER_ADDED,t),()=>{Go.removeEventListener(hs.USER_ADDED,t)}},[a,e])},KG=(a,e)=>{h.useEffect(()=>{if(!a)return;const t=i=>e(i);return Go.addEventListener(hs.USER_REMOVED,t),()=>{Go.removeEventListener(hs.USER_REMOVED,t)}},[a,e])},Ose=()=>{const[a,e]=h.useState(null),[t,i]=h.useState(!1);return J(z0,r=>{const n=r.getParser();n&&e(n)}),{promoteInformation:a,isExtended:t,setPromoteInformation:e,setIsExtended:i}},DT=()=>Ht(Ose),Cse=()=>{const[a,e]=h.useState(null),[t,i]=h.useState(null),[r,n]=h.useState(null),[o,l]=h.useState(0),[c,u]=h.useState([]);J(XL,m=>{const f=m.getParser();if(!f)return;const E=f.username;if(!E){u([]);return}u(I=>I.includes(E)?I.filter(p=>p!==E):[...I,E])});const d=(m,f,E,I=!1)=>{if(!t)return;const p=Ri.hslToRGB(((m&255)<<16)+((f&255)<<8)+(E&255));I&&l(p),!m&&!f&&!E?t.tint=0:t.tint=p},_=m=>{if(!r)return;const f=m>>16&255,E=m>>8&255,I=m&255;r.red=f/255,r.green=E/255,r.blue=I/255};return Js(fc.PREVIEW,m=>d(m.hue,m.saturation,m.lightness)),Js(fc.CLEAR_PREVIEW,m=>{t&&(t.tint=o)}),ut(yg.ROOM_BACKGROUND_COLOR,m=>{Ba.isRoomPreviewerId(m.roomId)||(m.enable?d(m.hue,m.saturation,m.lightness,!0):d(0,0,0,!0))}),ut(pf.ROOM_COLOR,m=>{if(Ba.isRoomPreviewerId(m.roomId))return;let f=0,E=255;m.bgOnly||(f=m.color,E=m.brightness),_(Ri.hslToRGB((Ri.rgbToHSL(f)&16776960)+E))}),ut([Ot.INITIALIZED,Ot.DISPOSED],m=>{var E,I;if(Ba.isRoomPreviewerId(m.roomId))return;const f=$e();if(f)switch(m.type){case Ot.INITIALIZED:Eb(m.roomId),e(f),(E=ce())==null||E.getCurrentRoomCamera().reset();return;case Ot.DISPOSED:e(null),(I=ce())==null||I.getCurrentRoomCamera().reset();return}}),ms([Ve.CREATED,Ve.ENDED,Ve.RESTARTED],m=>{switch(m.type){case Ve.CREATED:DQ(m.session);return;case Ve.ENDED:e(null);return;case Ve.RESTARTED:return}}),ut([ke.SELECTED,ke.DESELECTED,ke.ADDED,ke.REMOVED,ke.PLACED,ke.REQUEST_MOVE,ke.REQUEST_ROTATE,ke.MOUSE_ENTER,ke.MOUSE_LEAVE,ke.DOUBLE_CLICK],m=>{if(Ba.isRoomPreviewerId(m.roomId))return;let f=null;switch(m.type){case ke.SELECTED:jQ(m)||(f=new hs(hs.OBJECT_SELECTED,m.objectId,m.category,m.roomId,m.sendClickPacket));break;case ke.DESELECTED:f=new hs(hs.OBJECT_DESELECTED,m.objectId,m.category,m.roomId);break;case ke.ADDED:{let E=null;switch(m.category){case Q.FLOOR:case Q.WALL:E=hs.FURNI_ADDED;break;case Q.UNIT:E=hs.USER_ADDED;break}E&&(f=new hs(E,m.objectId,m.category,m.roomId));break}case ke.REMOVED:{let E=null;switch(m.category){case Q.FLOOR:case Q.WALL:E=hs.FURNI_REMOVED;break;case Q.UNIT:E=hs.USER_REMOVED;break}E&&(f=new hs(E,m.objectId,m.category,m.roomId));break}case ke.REQUEST_MOVE:Wg(a,m.objectId,m.category)&&Xc(m.objectId,m.category,at.OBJECT_MOVE);break;case ke.REQUEST_ROTATE:Wg(a,m.objectId,m.category)&&Xc(m.objectId,m.category,at.OBJECT_ROTATE_POSITIVE);break;case ke.MOUSE_ENTER:f=new hs(hs.OBJECT_ROLL_OVER,m.objectId,m.category,m.roomId);break;case ke.MOUSE_LEAVE:f=new hs(hs.OBJECT_ROLL_OUT,m.objectId,m.category,m.roomId);break;case ke.DOUBLE_CLICK:f=new hs(hs.OBJECT_DOUBLE_CLICKED,m.objectId,m.category,m.roomId);break}f&&_i(f)}),h.useEffect(()=>{if(!a)return;const m=Oe(),f=ce(),E=a.roomId,I=1,p=Math.floor(window.innerWidth),S=Math.floor(window.innerHeight),R=m.application.renderer;R&&(R.view.style.width=`${p}px`,R.view.style.height=`${S}px`,R.resolution=window.devicePixelRatio,R.resize(p,S));const O=f.getRoomInstanceDisplay(E,I,p,S,Cc.SCALE_ZOOMED_IN),C=ce().getRoomInstanceRenderingCanvas(E,I);if(!O||!C)return;const A=new Is(sC.WHITE),b=new $y,y=C.master;A.tint=0,A.width=p,A.height=S,y.addChildAt(A,0),y.filters=[b],i(A),n(b);const M=f.getRoomInstanceGeometry(E,I);if(M){const F=f.getRoomInstanceVariable(E,Vs.ROOM_MIN_X)||0,H=f.getRoomInstanceVariable(E,Vs.ROOM_MAX_X)||0,v=f.getRoomInstanceVariable(E,Vs.ROOM_MIN_Y)||0,B=f.getRoomInstanceVariable(E,Vs.ROOM_MAX_Y)||0;let z=(F+H)/2,$=(v+B)/2;const W=20;z=z+(W-1),$=$+(W-1);const V=Math.sqrt(W*W+W*W)*Math.tan(30/180*Math.PI);M.location=new Y(z,$,V)}const U=m.application.stage;if(!U)return;U.addChild(O),Eb(a.roomId);const G=F=>{const H=Math.floor(window.innerWidth),v=Math.floor(window.innerHeight);R.view.style.width=`${H}px`,R.view.style.height=`${v}px`,R.resolution=window.devicePixelRatio,R.resize(H,v),A.width=H,A.height=v,MQ(H,v,1),m.application.render()};return window.addEventListener("resize",G),()=>{i(null),n(null),l(0),window.removeEventListener("resize",G)}},[a]),{roomSession:a,groupWhisper:c,setGroupWhisper:u}},vt=()=>Ht(Cse),Nse=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState(0),{roomSession:o=null}=vt(),l=()=>{const d=Ri.rgbToHSL(r),[_,m,f,E]=sr.int_to_8BitVals(d);K(new Nw(a,m,f,E))},c=()=>o.useMultistateItem(a),u=()=>{_i(new fc(fc.CLEAR_PREVIEW)),e(-1),i(-1),n(0)};return ut(Ie.REQUEST_BACKGROUND_COLOR,d=>{if(!Wg(o,d.objectId,d.category))return;const m=ce().getRoomObject(d.roomId,d.objectId,d.category).model;e(d.objectId),i(d.category);const f=parseInt(m.getValue(D.FURNITURE_ROOM_BACKGROUND_COLOR_HUE)),E=parseInt(m.getValue(D.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION)),I=parseInt(m.getValue(D.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS)),p=sr.eight_bitVals_to_int(0,f,E,I),S=Ri.hslToRGB(p);n(S)}),Zr(a!==-1&&t!==-1,d=>{d.id!==a||d.category!==t||u()}),h.useEffect(()=>{if(a===-1||t===-1)return;const d=Ri.rgbToHSL(r),[_,m,f,E]=sr.int_to_8BitVals(d);_i(new fc(fc.PREVIEW,m,f,E))},[a,t,r]),{objectId:a,color:r,setColor:n,applyToner:l,toggleToner:c,onClose:u}},Ase=Nse,bse=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState("1"),[o,l]=h.useState(""),[c,u]=h.useState(""),[d,_]=h.useState(""),[m,f]=h.useState(""),{simpleAlert:E=null}=kt(),I=()=>{e(-1),i(-1),n("1"),l(""),u(""),_(""),f("")};return ut([Ie.REQUEST_BADGE_DISPLAY_ENGRAVING,Ie.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING],p=>{const S=ce().getRoomObject(p.roomId,p.objectId,p.category);if(!S)return;const R=new qa;R.initializeFromRoomObjectModel(S.model),e(p.objectId),i(p.category),n("1"),l($d(R.getValue(1))),u(Em(R.getValue(1))),_(R.getValue(2)),f(R.getValue(3))}),ut(Ie.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,p=>{const S=ce().getRoomObject(p.roomId,p.objectId,p.category);!S||S.model.getValue(D.FURNITURE_OWNER_ID)!==te().userId||E(`${g("resolution.failed.subtitle")} ${g("resolution.failed.text")}`,null,null,null,g("resolution.failed.title"))}),Zr(a!==-1&&t!==-1,p=>{p.id!==a||p.category!==t||I()}),{objectId:a,category:t,color:r,badgeName:o,badgeDesc:c,date:d,senderName:m,onClose:I}},vse=bse,qO="MONSTERPLANT_SEED_CONFIRMATION",XO="PURCHASABLE_CLOTHING_CONFIRMATION",qG="GROUP_FURNITURE",XG="EFFECTBOX_OPEN",$O="MYSTERYTROPHY_OPEN_DIALOG",yse=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(null),[r,n]=h.useState(null),[o,l]=h.useState(-1),[c,u]=h.useState(null),[d,_]=h.useState(!1),[m,f]=h.useState(-1),{roomSession:E=null}=vt(),I=()=>{e(-1),u(null),_(!1),i(null)},p=()=>{n(null),l(-1)},S=R=>{if(R)switch(R){case"use_friend_furni":E.useMultistateItem(a);break;case"use_monsterplant_seed":n(qO),l(a);break;case"use_random_teleport":ce().useRoomObject(a,Q.FLOOR);break;case"use_purchaseable_clothing":n(XO),l(a);break;case"use_mystery_box":E.useMultistateItem(a);break;case"use_mystery_trophy":n($O),l(a);break;case"join_group":xN(c.guildId),_(!0);return;case"go_to_group_homeroom":c&&qn(c.guildHomeRoomId);break;case"use_random_teleport_sync":K(new wF(a));break}I()};return ut([Ie.OPEN_FURNI_CONTEXT_MENU,Ie.CLOSE_FURNI_CONTEXT_MENU,Ie.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,Ie.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,Ie.REQUEST_EFFECTBOX_OPEN_DIALOG,Ie.REQUEST_MYSTERYBOX_OPEN_DIALOG,Ie.REQUEST_MYSTERYTROPHY_OPEN_DIALOG],R=>{const O=ce().getRoomObject(E.roomId,R.objectId,R.category);if(O)switch(f(O.model.getValue(D.FURNITURE_OWNER_ID)),R.type){case Ie.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:if(!gr(O))return;l(O.id),n(qO),I();return;case Ie.REQUEST_EFFECTBOX_OPEN_DIALOG:if(!gr(O))return;l(O.id),n(XG),I();return;case Ie.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:if(!gr(O))return;l(O.id),n(XO),I();return;case Ie.REQUEST_MYSTERYBOX_OPEN_DIALOG:E.useMultistateItem(O.id),I();return;case Ie.REQUEST_MYSTERYTROPHY_OPEN_DIALOG:if(!gr(O))return;l(O.id),n($O),I();return;case Ie.OPEN_FURNI_CONTEXT_MENU:switch(e(O.id),R.contextMenu){case ys.FRIEND_FURNITURE:i(ys.FRIEND_FURNITURE);return;case ys.MONSTERPLANT_SEED:gr(O)&&i(ys.MONSTERPLANT_SEED);return;case ys.MYSTERY_BOX:i(ys.MYSTERY_BOX);return;case ys.MYSTERY_TROPHY:gr(O)&&i(ys.MYSTERY_TROPHY);return;case ys.RANDOM_TELEPORT:i(ys.RANDOM_TELEPORT);return;case ys.PURCHASABLE_CLOTHING:gr(O)&&i(ys.PURCHASABLE_CLOTHING);return}return;case Ie.CLOSE_FURNI_CONTEXT_MENU:O.id===a&&I();return}}),J(Pj,R=>{const O=R.getParser();e(O.objectId),u(O),_(O.userIsMember),i(qG)}),{objectId:a,mode:t,confirmMode:r,confirmingObjectId:o,groupData:c,isGroupMember:d,objectOwnerId:m,closeConfirm:p,processAction:S,onClose:I}},Dse=yse,Mse=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState([]),[r,n]=h.useState(null),[o,l]=h.useState([]),[c,u]=h.useState(null),[d,_]=h.useState(new Map),[m,f]=h.useState(!1),{groupItems:E=[],getItemsByType:I=null,activate:p=null,deactivate:S=null}=$a(),{simpleAlert:R=null}=kt(),O=r&&d.get(r.name)||null,C=()=>{i([]),n(null),l([]),_(new Map)},A=()=>{e(-1),C()},b=()=>{f(!0),K(new NP(a,r.name))},y=M=>{n(M),d.get(M.name)||K(new bP(M.name))};return ut(Ie.OPEN_WIDGET,M=>{M.widget===Ng.CRAFTING&&(e(M.objectId),C(),K(new AP(M.objectId)))}),J(tM,M=>{const U=M.getParser();if(!U.isActive()){e(-1);return}i(G=>{const F=[];for(const H of U.recipes){const v=ce().roomContentLoader._activeObjectTypeIds.get(H.itemName),B=ce().getFurnitureFloorIconUrl(v);F.push({name:H.recipeName,localizedName:g("roomItem.name."+v),iconUrl:B})}return F}),u(U.ingredients)}),J(sM,M=>{const U=M.getParser();_(G=>{const F=new Map(G);return F.set(r.name,U.ingredients),F})}),J(rM,M=>{n(null),f(!1),M.getParser().result&&R(g("crafting.info.result.ok"))}),J(iM,M=>{}),h.useEffect(()=>{!c||!c.length||l(M=>{const U=[];for(const G of c){const F=ce().roomContentLoader._activeObjectTypeIds.get(G),H=ce().getFurnitureFloorIconUrl(F),v=I(F);let B=0;if(v)for(const z of v)B+=z.items.length;U.push({name:G,iconUrl:H,count:B})}return U})},[E,c,I]),h.useEffect(()=>{if(a===-1)return;const M=p();return()=>S(M)},[a,p,S]),{objectId:a,recipes:t,ingredients:o,selectedRecipe:r,requiredIngredients:O,isCrafting:m,selectRecipe:y,craft:b,onClose:A}},jse=Mse,Lse=()=>{const[a,e]=h.useState([]),[t,i]=h.useState(0),[r,n]=h.useState(0),[o,l]=h.useState(0),[c,u]=h.useState(0),[d,_]=h.useState(16777215),[m,f]=h.useState(255),[E,I]=h.useState(0),[p,S]=h.useState(0),[R,O]=h.useState(0),{roomSession:C=null}=vt(),A=()=>C.isRoomOwner||C.controllerLevel>=pt.USER_WITH_RIGHTS||te().isModerator,b=M=>{const U=a[M-1];U&&(i(U.id),I(U.type),S(U.color),O(U.light))},y=()=>{if(r===0)return;const M=t-1;if(t<1||t>a.length)return;const U=a[M];!U||E===U.type&&p===U.color&&R===U.light||(e(G=>{const F=[...G];return F[M]=new kb(U.id,E,p,R),F}),No.savePreset(U.id,E,p,R,!0))};return ut(Ie.REQUEST_DIMMER,M=>{A()&&C.requestMoodlightSettings()}),ms(Dg.ROOM_DIMMER_PRESETS,M=>{const U=[];let G=0;for(;G<M.presetCount;){const F=M.getPreset(G);F&&U.push(new kb(F.id,F.type,F.color,F.brightness)),G++}e(U),i(M.selectedPresetId)}),ut(If.ROOM_COLOR,M=>{Ba.isRoomPreviewerId(M.roomId)||(l(r),n(M.state),i(M.presetId),u(M.effectId),I(M.effectId),_(M.color),S(M.color),f(M.brightness),O(M.brightness))}),h.useEffect(()=>{r===0&&o===0||No.previewDimmer(p,R,E===2)},[r,o,p,R,E]),{presets:a,selectedPresetId:t,dimmerState:r,lastDimmerState:o,effectId:c,color:d,brightness:m,selectedEffectId:E,setSelectedEffectId:I,selectedColor:p,setSelectedColor:S,selectedBrightness:R,setSelectedBrightness:O,selectPresetId:b,applyChanges:y}},Pse=Lse,Use=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState(0),o=()=>{e(-1),i(-1),n(0)},l=()=>{$e().connection.send(new pw(a)),o()};return ut(Ie.REQUEST_CREDITFURNI,c=>{const u=ce().getRoomObject(c.roomId,c.objectId,c.category);!u||!gr(u)||(e(c.objectId),i(c.category),n(u.model.getValue(D.FURNITURE_CREDIT_VALUE)||0))}),Zr(a!==-1&&t!==-1,c=>{c.id!==a||c.category!==t||o()}),{objectId:a,value:r,redeem:l,onClose:o}},wse=Use,Fse=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState(-1),[o,l]=h.useState([]),{roomSession:c=null}=vt(),u=()=>{e(-1),i(-1),n(-1),l([])};return ut(Ie.REQUEST_EXTERNAL_IMAGE,d=>{const _=ce().getRoomObject(d.roomId,d.objectId,d.category),m=ce().getRoomObjects(c==null?void 0:c.roomId,Q.WALL);if(!_)return;const f=[];m.forEach(I=>{if(I.type!=="external_image_wallitem_poster_small")return null;const p=I.model.getValue(D.FURNITURE_DATA),S=JSON.parse(p);f.push(S)}),e(d.objectId),i(d.category),l(f);const E=JSON.parse(_.model.getValue(D.FURNITURE_DATA));n(I=>{let p=0;return E&&(p=f.findIndex(S=>S.u===E.u)),p<0&&(p=0),p})}),Zr(a!==-1&&t!==-1,d=>{d.id!==a||d.category!==t||u()}),{objectId:a,currentPhotoIndex:r,currentPhotos:o,onClose:u}},kse=Fse,Gse=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState(0),[o,l]=h.useState([]),[c,u]=h.useState([]),[d,_]=h.useState(null),[m,f]=h.useState(0),E=()=>{e(-1),i(-1),n(0),l([]),u([]),_(null)},I=p=>{$e().connection.send(new yP(a,p)),E()};return J(Fj,p=>{const S=p.getParser();e(S.furniId),f(S.start?1:2)}),J(Uj,p=>E()),J(wj,p=>E()),ut(Ie.REQUEST_FRIEND_FURNITURE_ENGRAVING,p=>{const S=ce().getRoomObject(p.roomId,p.objectId,p.category);if(!S)return;const R=S.model.getValue(D.FURNITURE_DATA),O=S.model.getValue(D.FURNITURE_EXTRAS);R[0]!=="1"||R.length!==6||(e(p.objectId),i(p.category),n(O),l([R[1],R[2]]),u([R[3],R[4]]),_(R[5]),f(0))}),Zr(a!==-1&&t!==-1,p=>{p.id!==a||p.category!==t||E()}),{objectId:a,type:r,usernames:o,figures:c,date:d,stage:m,onClose:E,respond:I}},Bse=Gse,Vse=["perteam","mostwins","classic","fastesttime","longesttime"],Hse=["alltime","daily","weekly","monthly"],Wse=()=>{const[a,e]=h.useState(new Map),{roomSession:t=null}=vt(),i=o=>Vse[o],r=o=>Hse[o],n=(o,l)=>{const c=[60,60,24];if(l<1||l>c.length)return o.toString();let u="",d=0;for(;d<l;){let _;d===l-1?_=o.toString():(_=(o%c[d]).toString(),o=Math.floor(o/c[d])),_.length<2&&d<2&&(_="0"+_),u=_+":"+u,d++}return u.slice(0,-1)};return ut(Ie.REQUEST_HIGH_SCORE_DISPLAY,o=>{const l=ce().getRoomObject(o.roomId,o.objectId,o.category);if(!l)return;const c=l.model.getValue(D.FURNITURE_DATA_FORMAT);if(c!=Kn.HIGHSCORE_KEY)return;const u=ka.getData(c);u.initializeFromRoomObjectModel(l.model),e(d=>{const _=new Map(d);return _.set(l.id,u),_})}),ut(Ie.REQUEST_HIDE_HIGH_SCORE_DISPLAY,o=>{o.roomId===t.roomId&&e(l=>{const c=new Map(l);return c.delete(o.objectId),c})}),{stuffDatas:a,getScoreType:i,getClearType:r,scoreToTime:n}},Yse=Wse,zse="internalLink",Kse=()=>(ut(Ie.REQUEST_INTERNAL_LINK,a=>{const e=ce().getRoomObject(a.roomId,a.objectId,a.category);if(!e)return;let i=e.model.getValue(D.FURNITURE_DATA)[zse];(!i||!i.length)&&(i=e.model.getValue(D.FURNITURE_INTERNAL_LINK)),i&&i.length&&Ce(i)}),{}),qse=Kse,Xse=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState(null),[o,l]=h.useState(null),[c,u]=h.useState(rr.NO_CLUB),[d,_]=h.useState(null),m=()=>{e(-1),i(-1),n(null),l(null),_(null)},f=()=>{a!==-1&&(K(new Tw(a)),m())},E=()=>{a!==-1&&(K(new ko(a)),m())},I=()=>{a!==-1&&K(new Sw(a,d))};return ut(Ie.REQUEST_MANNEQUIN,p=>{const S=ce().getRoomObject(p.roomId,p.objectId,p.category);if(!S)return;const R=S.model,O=R.getValue(D.FURNITURE_MANNEQUIN_FIGURE)||null,C=R.getValue(D.FURNITURE_MANNEQUIN_GENDER)||null,A=qt().createFigureContainer(O),b=qt().getFigureClubLevel(A,C,xd.MANNEQUIN_CLOTHING_PART_TYPES);e(p.objectId),i(p.category),n(O),l(C),u(b),_(R.getValue(D.FURNITURE_MANNEQUIN_NAME)||null)}),Zr(a!==-1&&t!==-1,p=>{p.id!==a||p.category!==t||m()}),{objectId:a,figure:r,gender:o,clubLevel:c,name:d,setName:_,saveFigure:f,wearFigure:E,saveName:I,onClose:m}},$se=Xse,Qse=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState(-1),[o,l]=h.useState(new Ms),[c,u]=h.useState([]),{roomSession:d=null}=vt(),{showSingleBubble:_=null,simpleAlert:m=null}=kt(),f=()=>{e(-1),i(-1)},E=h.useCallback((R,O)=>K(new oF(R,O)),[]),I=h.useCallback(R=>K(new _F(R)),[]),p=h.useCallback((R,O)=>K(new ko(R,O)),[]);ut(Ie.REQUEST_PLAYLIST_EDITOR,R=>{var C,A,b;const O=ce().getRoomObject(R.roomId,R.objectId,R.category);if(O){if(gr(O)){e(R.objectId),i(R.category),(C=Oe().soundManager.musicController)==null||C.requestUserSongDisks(),(b=(A=Oe().soundManager.musicController)==null?void 0:A.getRoomItemPlaylist())==null||b.requestPlayList();return}(d.isRoomOwner||d.controllerLevel>=pt.USER_WITH_RIGHTS||te().isModerator)&&K(new ko(R.objectId,-2))}}),Zr(a!==-1&&t!==-1,R=>{R.id!==a||R.category!==t||f()}),Zc(Po.NPE_SONG_CHANGED,R=>{n(R.position)}),Zc(wp.NOTIFY_PLAYED_SONG,R=>{_(g("soundmachine.notification.playing",["songname","songauthor"],[R.name,R.creator]),bi.SOUNDMACHINE)}),Zc(ku.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT,R=>{var O;l((O=Oe().soundManager.musicController)==null?void 0:O.songDiskInventory.clone())}),Zc(Ao.PLUE_PLAY_LIST_UPDATED,R=>{var O,C;u((C=(O=Oe().soundManager.musicController)==null?void 0:O.getRoomItemPlaylist())==null?void 0:C.entries.concat())}),Zc(Ao.PLUE_PLAY_LIST_FULL,R=>{m(g("playlist.editor.alert.playlist.full"),lt.ALERT,"","",g("playlist.editor.alert.playlist.full.title"))});const S=R=>{var O,C;a!==-1&&(R instanceof qf?R.getParser().fragmentNumber===0&&((O=Oe().soundManager.musicController)==null||O.requestUserSongDisks()):(C=Oe().soundManager.musicController)==null||C.requestUserSongDisks())};return J(qf,S),J(AC,S),J(NC,S),{objectId:a,diskInventory:o,playlist:c,currentPlayingIndex:r,onClose:f,addToPlaylist:E,removeFromPlaylist:I,togglePlayPause:p}},Jse=Qse,av="floor",Zse="wallpaper",ov="landscape",eie="poster",tie=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState(null),[o,l]=h.useState(null),[c,u]=h.useState(!1),[d,_]=h.useState(null),[m,f]=h.useState(null),[E,I]=h.useState(-1),[p,S]=h.useState(null),[R,O]=h.useState(!1),[C,A]=h.useState(null),{roomSession:b=null}=vt(),y=()=>{e(-1),i(-1),n(null),l(null),u(!1),_(null),f(null),I(-1),S(null),O(!1),A(null)},M=()=>{a!==-1&&(b.openGift(a),ce().changeObjectModelData(ce().activeRoomId,a,Q.FLOOR,D.FURNITURE_DISABLE_PICKING_ANIMATION,1))},U=h.useMemo(()=>({imageReady:(G,F,H)=>{!H&&F&&(H=Vt.generateImage(F)),A(H.src)},imageFailed:null}),[]);return ms(Mg.RSPE_PRESENT_OPENED,G=>{let F=null;G.itemType===dt.FLOOR?F=te().getFloorItemData(G.classId):G.itemType===dt.WALL&&(F=te().getWallItemData(G.classId));let H=!1;if(G.placedInRoom){const v=ce().getRoomObject(b.roomId,G.placedItemId,Q.FLOOR);v&&(H=gr(v))}switch(G.itemType){case dt.WALL:{if(F)switch(F.className){case av:case ov:case Zse:let v=null;F.className===av?v=g("inventory.furni.item.floor.name"):F.className===ov?v=g("inventory.furni.item.landscape.name"):v=g("inventory.furni.item.wallpaper.name"),l(v);break;case eie:{const B=G.productCode;let z=null;B.indexOf("poster")===0&&(z=B.replace("poster",""));const $=te().getProductData(B);let W=null;$?W=$.name:F&&(W=F.name),l(W),A(ce().getFurnitureWallIconUrl(G.classId,z));break}default:{l(F.name||null),A(ce().getFurnitureWallIconUrl(G.classId));break}}break}case dt.HABBO_CLUB:l(g("widget.furni.present.hc"));break;default:{if(G.placedItemType===dt.PET){const B=G.petFigureString;if(B&&B.length){const z=new Vo(B),$=ce().getRoomObjectPetImage(z.typeId,z.paletteId,z.color,new Y(90),64,U,!0,0,z.customParts);$&&A($.getImage().src)}}else{const B=ce().getFurnitureFloorImage(G.classId,new Y(90),64,U);B&&A(B.getImage().src)}const v=te().getProductData(G.productCode);l(v&&v.name||F.name);break}}e(0),i(G.classId),n(G.itemType),u(H),I(G.placedItemId),S(G.placedItemType),O(G.placedInRoom)}),ut(Ie.REQUEST_PRESENT,G=>{const F=ce().getRoomObject(G.roomId,G.objectId,G.category);if(!F)return null;y(),e(G.objectId),i(-1),l(F.model.getValue(D.FURNITURE_DATA)||""),u(gr(F)),_(F.model.getValue(D.FURNITURE_PURCHASER_NAME)||null),f(F.model.getValue(D.FURNITURE_PURCHASER_FIGURE)||null)}),Zr(a!==-1,G=>{G.id===a&&y(),G.id===E&&R&&O(!1)}),{objectId:a,classId:t,itemType:r,text:o,isOwnerOfFurniture:c,senderName:d,senderFigure:m,placedItemId:E,placedItemType:p,placedInRoom:R,imageUrl:C,openPresent:M,onClose:y}},sie=tie,iie="internalLink",rie=()=>{const[a,e]=h.useState(0);return ut(Ie.REQUEST_ROOM_LINK,t=>{const i=ce().getRoomObject(t.roomId,t.objectId,t.category);if(!i)return;let n=i.model.getValue(D.FURNITURE_DATA)[iie];(!n||!n.length)&&(n=i.model.getValue(D.FURNITURE_INTERNAL_LINK)),!(!n||!n.length)&&(n=parseInt(n,10),!isNaN(n)&&(e(n),K(new Vg(n,!1,!1))))}),J(bl,t=>{!a||t.getParser().data.roomId!==a||e(0)}),{}},nie=rie,aie=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState(""),[o,l]=h.useState(""),[c,u]=h.useState("0"),[d,_]=h.useState(""),[m,f]=h.useState(!1),{getWallItemById:E=null}=$a(),I=()=>{K(new aw(a,o,c,d)),e(-1),i(-1),n(""),l(""),u("0"),_(""),f(!1)};return J(Gj,p=>{const S=p.getParser();e(S.itemId),i(Q.WALL);const R=E(S.itemId);let O="post_it";if(R){const C=ce().getFurnitureWallName(R.type);C.match("post_it_")&&(O=C)}n(O),l(S.location),u("FFFF33"),_(""),f(!0)}),{objectId:a,color:c,setColor:u,text:d,setText:_,canModify:m,onClose:I}},oie=aie,JT=40,lie=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState(0),[o,l]=h.useState(-1),c=()=>{e(-1),i(-1),n(0),l(-1)},u=(d,_=!1)=>{d||(d=0),d=Math.abs(d),_||d>JT&&(d=JT),n(parseFloat(d.toFixed(2))),_||l(d*100)};return J(Lj,d=>{const _=d.getParser();a===_.furniId&&u(_.height,!0)}),ut(Ie.REQUEST_STACK_HEIGHT,d=>{if(!Wg($e(),d.objectId,d.category))return;const _=ce().getRoomObject(d.roomId,d.objectId,d.category);_&&(e(d.objectId),i(d.category),n(_.getLocation().z),l(-1))}),Zr(a!==-1&&t!==-1,d=>{d.id!==a||d.category!==t||c()}),h.useEffect(()=>{if(a===-1||o===-1)return;const d=setTimeout(()=>K(new up(a,~~o)),10);return()=>clearTimeout(d)},[a,o]),{objectId:a,height:r,maxHeight:JT,onClose:c,updateHeight:u}},cie=lie,uie=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState("0"),[o,l]=h.useState(""),[c,u]=h.useState(""),[d,_]=h.useState(!1),m=()=>{e(-1),i(-1),n("0"),l(""),u(""),_(!1)},f=p=>{p!==r&&(n(p),ce().modifyRoomObjectData(a,t,p,o))},E=p=>{l(p),ce().modifyRoomObjectData(a,t,r,p)},I=()=>ce().deleteRoomObject(a,t);return ut(Ie.REQUEST_STICKIE,p=>{const S=ce().getRoomObject(p.roomId,p.objectId,p.category);if(!S)return;const R=S.model.getValue(D.FURNITURE_ITEMDATA);if(R.length<6)return;let O=null,C=null;R.indexOf(" ")>0?(O=R.slice(0,R.indexOf(" ")),C=R.slice(R.indexOf(" ")+1,R.length)):O=R,e(p.objectId),i(p.category),n(O||"0"),l(C||""),u(S.type||"post_it"),_($e().isRoomOwner||te().isModerator||gr(S))}),Zr(a!==-1&&t!==-1,p=>{p.id!==a||p.category!==t||m()}),{objectId:a,color:r,text:o,type:c,canModify:d,updateColor:f,updateText:E,trash:I,onClose:m}},hie=uie,die=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState("1"),[o,l]=h.useState(""),[c,u]=h.useState(""),[d,_]=h.useState(""),m=()=>{e(-1),i(-1),n("1"),l(""),u(""),_("")};return ut(Ie.REQUEST_TROPHY,f=>{const E=ce().getRoomObject(f.roomId,f.objectId,f.category);if(!E)return;let I=E.model.getValue(D.FURNITURE_DATA);E.model.getValue(D.FURNITURE_EXTRAS),e(f.objectId),i(f.category),n(E.model.getValue(D.FURNITURE_COLOR)||"1");const p=I.substring(0,I.indexOf("	"));I=I.substring(p.length+1,I.length);const S=I.substring(0,I.indexOf("	")),R=I.substr(S.length+1,I.length);l(p),u(S),_(R)}),Zr(a!==-1&&t!==-1,f=>{f.id!==a||f.category!==t||m()}),{objectId:a,color:r,senderName:o,date:c,message:d,onClose:m}},_ie=die,gie=0,mie=1,fie=2,pie=3,Eie=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState(null),[o,l]=h.useState(null),[c,u]=h.useState(null),[d,_]=h.useState(-1),[m,f]=h.useState(null),[E,I]=h.useState(null),[p,S]=h.useState(!1),R=()=>{e(-1),i(-1),n(null),l(null),u(null),_(-1),f(null),I(null),S(!1)},O=()=>K(new o_(a,gie)),C=()=>K(new o_(a,mie)),A=()=>p&&r&&r.length&&K(new o_(a,fie)),b=()=>p&&r&&r.length&&K(new o_(a,pie)),y=M=>{if(m===M){f(null),K(new Cx(a,""));return}f(M),K(new Cx(a,M))};return ut(Ie.REQUEST_YOUTUBE,M=>{if(Ba.isRoomPreviewerId(M.roomId))return;const U=ce().getRoomObject(M.roomId,M.objectId,M.category);U&&(e(M.objectId),i(M.category),S(te().hasSecurity(zu.EMPLOYEE)||gr(U)),K(new Aw(M.objectId)))}),J(Wj,M=>{const U=M.getParser();a===-1||a!==U.furniId||(n(U.videoId),l(U.startAtSeconds),u(U.endAtSeconds),_(U.state))}),J(Hj,M=>{const U=M.getParser();a===-1||a!==U.furniId||(I(U.playlists),f(U.selectedPlaylistId),n(null),_(-1),u(null),l(null))}),J(Vj,M=>{const U=M.getParser();if(!(a===-1||a!==U.furniId))switch(U.commandId){case 1:_(pc.PLAYING);break;case 2:_(pc.PAUSED);break}}),Zr(a!==-1&&t!==-1,M=>{M.id!==a||M.category!==t||R()}),{objectId:a,videoId:r,videoStart:o,videoEnd:c,currentVideoState:d,selectedVideo:m,playlists:E,onClose:R,previous:O,next:C,pause:A,play:b,selectVideo:y}},Iie=Eie,Tie=()=>{var f;const[a,e]=h.useState(null),[t,i]=h.useState(-1),[r,n]=h.useState(-1),{navigatorData:o=null}=Ir(),{simpleAlert:l}=kt(),c=te().userName===((f=o.enteredGuestRoom)==null?void 0:f.ownerName),u=()=>{i(-1),n(-1),e(null)},d=()=>{t&&K(new Cw(t))},_=()=>{t&&(K(new Ow(t)),u())},m=E=>{let I="";switch(E){case Ln.SPACE_ALREADY_RENTED:I=g("rentablespace.widget.error_reason_already_rented");break;case Ln.SPACE_EXTEND_NOT_RENTED:I=g("rentablespace.widget.error_reason_not_rented");break;case Ln.SPACE_EXTEND_NOT_RENTED_BY_YOU:I=g("rentablespace.widget.error_reason_not_rented_by_you");break;case Ln.CAN_RENT_ONLY_ONE_SPACE:I=g("rentablespace.widget.error_reason_can_rent_only_one_space");break;case Ln.NOT_ENOUGH_CREDITS:I=g("rentablespace.widget.error_reason_not_enough_credits");break;case Ln.NOT_ENOUGH_PIXELS:I=g("rentablespace.widget.error_reason_not_enough_duckets");break;case Ln.CANT_RENT_NO_PERMISSION:I=g("rentablespace.widget.error_reason_no_permission");break;case Ln.CANT_RENT_NO_HABBO_CLUB:I=g("rentablespace.widget.error_reason_no_habboclub");break;case Ln.CANT_RENT:I=g("rentablespace.widget.error_reason_disabled");break;case Ln.CANT_RENT_GENERIC:I=g("rentablespace.widget.error_reason_generic");break}return u(),l(I)};return ut(Ie.REQUEST_RENTABLE_SPACE,E=>{const I=ce().getRoomObject(E.roomId,E.objectId,E.category);I&&(i(I.id),n(E.category))}),Zr(t!==-1&&r!==-1,E=>{E.id!==t||E.category!==r||_()}),J(kj,E=>{const I=E.getParser();if(I){if(I.canRentErrorCode!==0&&(!c||!te().isModerator)||I.renterName===""&&I.canRentErrorCode!==0)return m(I.canRentErrorCode);i(I.renterSpaceId),e(I)}}),{renter:a,isRoomOwner:c,onRent:d,onCancelRent:_,onClose:u}},Sie=Tie,Rie="hr-100.hd-180-7.ch-215-66.lg-270-79.sh-305-62.ha-1002-70.wa-2007",xie="hr-515-33.hd-600-1.ch-635-70.lg-716-66-62.sh-735-68",Oie=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState(!1),[o,l]=h.useState(!1),[c,u]=h.useState(null),[d,_]=h.useState(null),[m,f]=h.useState({}),[E,I]=h.useState({}),[p,S]=h.useState(Ee.MALE),R=h.useCallback((F,H)=>{const v=$=>{const W=$.split(".");if(!W||!W.length)return;const V={},se={};for(const ee of W){const ie=ee.split("-");if(!ie.length)continue;const Z=ie[0],ne=parseInt(ie[1]),_e=[];let de=2;for(;de<ie.length;)_e.push(parseInt(ie[de])),de++;_e.length||_e.push(0),ne>=0&&(V[Z]=ne),_e.length&&(se[Z]=_e)}return{partSets:V,colorSets:se}},{partSets:B,colorSets:z}=v(F);f(B),I(z),S(H)},[]),O=h.useCallback((F,H)=>{!F||!F.length||f(v=>{const B={...v};return H===-1?delete B[F]:B[F]=H,B})},[]),C=h.useCallback((F,H,v)=>{!F||!F.length||I(B=>{const z={...B};return z[F]||(z[F]=[]),z[F][H]||(z[F][H]=0),z[F][H]=v,z})},[]),A=h.useMemo(()=>{let F="";const H=[],v=Object.keys(m);for(const B of v){const z=m[B];if(!z)continue;let $=`${B}-${z}`;if(E[B]&&E[B].length){let W=0;for(;W<E[B].length;)$+=`-${E[B][W]}`,W++}H.push($)}for(const B of H)F+=B,H.indexOf(B)<H.length-1&&(F+=".");return F},[m,E]),b=h.useCallback((F,H=!0)=>[Ee.HEAD].map(B=>{let z=B===Ee.HEAD&&H?F:m[B];const $=E[B]||[];let W=`${B}-${z}`;return z>=0&&(W+=$.map(V=>`-${V}`).join("")),W}).join("."),[m,E]),y=()=>{S(Ee.MALE),n(!1),l(!0),R(d,Ee.MALE)},M=()=>{S(Ee.FEMALE),n(!1),l(!0),R(c,Ee.FEMALE)},U=()=>{n(!1),l(!1)};return ut(Ie.REQUEST_CLOTHING_CHANGE,F=>{e(F.objectId),n(!0),l(!1);const H=ce().getRoomObject($e().roomId,F.objectId,Q.FLOOR);if(!H)return;const v=H.model;_(v.getValue(D.FURNITURE_CLOTHING_BOY)||Rie),u(v.getValue(D.FURNITURE_CLOTHING_GIRL)||xie),i(v.getValue(D.FURNITURE_OWNER_ID))}),{visible:r,objectId:a,isEditorVisible:o,femaleFigure:c,maleFigure:d,ownerId:t,close:U,openMaleEditor:y,openFemaleEditor:M,save:F=>{if(!$e())return;$e().sendUpdateClothingChangeFurniture(a,p,F);const H=ce().getRoomObject($e().roomId,a,Q.FLOOR);p===Ee.MALE?(_(F),H&&H.model.setValue(D.FURNITURE_CLOTHING_BOY,F)):(u(F),H&&H.model.setValue(D.FURNITURE_CLOTHING_GIRL,F)),U()},selectedParts:m,selectedColors:E,gender:p,setGender:S,setIsEditorVisible:l,loadAvatarData:R,selectPart:O,selectColor:C,getFigureString:A,getFigureStringWithFace:b}},MT=()=>Ht(Oie),Cie=()=>{const[a,e]=h.useState(null),[t,i]=h.useState(new Map),{roomSession:r=null}=vt(),n=(c,u)=>{const d=[60,60,24];if(u<1||u>d.length)return c.toString();let _="",m=0;for(;m<u;){let f;m===u-1?f=c.toString():(f=(c%d[m]).toString(),c=Math.floor(c/d[m])),f.length<2&&m<2&&(f="0"+f),_=f+":"+_,m++}return _.slice(0,-1)};ut(Ie.REQUEST_HIGH_SCORE_DISPLAY,c=>{const u=ce().getRoomObject(c.roomId,c.objectId,c.category);if(!u)return;const d=u.model.getValue(D.FURNITURE_DATA_FORMAT);if(d!=Kn.HIGHSCORE_VARIABLE_KEY)return;const _=ka.getData(d);_.initializeFromRoomObjectModel(u.model),i(m=>{const f=new Map(m);return f.set(u.id,_),f})}),ut(Ie.REQUEST_HIDE_HIGH_SCORE_DISPLAY,c=>{c.roomId===r.roomId&&i(u=>{const d=new Map(u);return d.delete(c.objectId),d})}),J(Yj,c=>{const u=c.getParser();u&&e(u)});const o=h.useCallback((c,u,d,_,m,f,E,I,p,S)=>{K(new bw(a.virtualId,c,u,d,_,m,f,E,I,p,S))},[a]);return{stuffDatas:t,scoreToTime:n,highscoreData:a,save:o,close:()=>{e(null)}}},Nie=Cie,vu=class vu{};vu.STATUS_IDLE=0,vu.STATUS_AWAIT_HASH=1,vu.STATUS_AWAIT_DIFFS=2,vu.REQUEST_OFFSET=800,vu.INVALIDATE_REQUEST_OFFSET=4e3;let sn=vu;const pl=class pl{};pl.USER_IN_ROOM=0,pl.ROOM_ACTIVE=1,pl.PERMANENT=10,pl.PERMANENT_SHARED=11,pl.REFERENCE=20,pl.INTERNAL=100,pl.SMART=21;let Ls=pl;function Aie(a,e){let t=a.variableName.toLowerCase(),i=e.variableName.toLowerCase();return t<i?-1:t>i?1:0}function bie(a,e){return a.variableId<e.variableId?1:a.variableId>e.variableId?-1:0}const vie=()=>{const a=h.useRef(sn.STATUS_IDLE),e=h.useRef(-1),t=h.useRef(0),i=h.useRef(new Map),r=h.useRef(new Map),n=h.useRef([]),[o,l]=h.useState(new Map),[c,u]=h.useState(!1);J(Hk,C=>{d(C.getParser().allVariablesHash)});const d=C=>{a.current===sn.STATUS_AWAIT_HASH&&(e.current=performance.now(),C===t.current?(O(),a.current=sn.STATUS_IDLE):(t.current=C,a.current=sn.STATUS_AWAIT_DIFFS,K(new Jw(r.current))))};J(oL,C=>{if(a.current!==sn.STATUS_AWAIT_DIFFS)return;e.current=performance.now();const A=C.getParser();t.current=A.allVariablesHash,i||(i.current=new Map,r.current=new Map),_(A.removedVariables),m(A.addedOrUpdated),A.isLastChunk&&(O(),a.current=sn.STATUS_IDLE)});const _=C=>{for(let A of C)i.current.delete(A),r.current.delete(A)},m=C=>{for(let A of C){let b=A[0],y=A[1];i.current.set(b.variableId,b),r.current.set(b.variableId,y)}},f=(C,A=!0,b=0)=>(a.current!==sn.STATUS_IDLE&&e.current<performance.now()-sn.INVALIDATE_REQUEST_OFFSET&&(a.current=sn.STATUS_IDLE),a.current!==sn.STATUS_IDLE?(S(C),!1):e.current>performance.now()-sn.REQUEST_OFFSET||!A&&i.current?(C(I()),!0):(e.current=performance.now(),a.current=sn.STATUS_AWAIT_HASH,S(C),b!==0?d(b):K(new Zw),!1)),E=(C,A)=>{const b=C.availabilityType==Ls.INTERNAL,y=A.availabilityType==Ls.INTERNAL;return b&&!y?1:y&&!b?-1:b?Number(C.variableId)>Number(A.variableId)?-1:Number(C.variableId)==Number(A.variableId)?0:1:C.variableName.localeCompare(A.variableName)},I=()=>{if(!i.current)return[];const C=[],A=[];for(let b of i.current){let y=b[1];y.availabilityType===Ls.INTERNAL?C.push(y):A.push(y)}return A.sort(Aie),C.sort(bie),A.concat(C)},p=C=>C.sort(E),S=C=>{n.current.indexOf(C)==-1&&n.current.push(C)},R=C=>{let A=n.current.indexOf(C);A!=-1&&n.current.splice(A,1)},O=()=>{for(let C of n.current)C(I());n.current.splice(0,n.current.length)};return{getAllVariables:f,removeListener:R,updateListeners:O,addListener:S,objectsIdAndValue:o,setObjectsIdAndValue:l,setIsFurniHolders:u,isFurniHolders:c,sortVariables:p}},jT=()=>Ht(vie),yie=()=>{const[a,e]=h.useState(null),[t,i]=h.useState([]),[r,n]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState(""),[d,_]=h.useState([]),[m,f]=h.useState([]),[E,I]=h.useState([]),[p,S]=h.useState([]),[R,O]=h.useState(0),[C,A]=h.useState(0),[b,y]=h.useState(0),[M,U]=h.useState(0),[G,F]=h.useState(!1),H=h.useRef(null),[v,B]=h.useState([]),[z,$]=h.useState(null),[W,V]=br(tr.WIRED_ALWAYS_OPEN_ADVANCED_OPTIONS,!1),[se,ee]=h.useState(new Map),[ie,Z]=h.useState(new Map),[ne,_e]=h.useState(null),[de,me]=h.useState(!1),[fe,ae]=h.useState(1),{roomSession:Te}=vt(),[Se]=WG(),Le=h.useRef(),{showConfirm:Et=null}=kt(),{getAllVariables:ri,removeListener:ni,updateListeners:gt}=jT();h.useEffect(()=>{e(null)},[Te]);const yt=()=>{const Ze=ht=>{ht&&(ht instanceof dC?K(new qw(ht.id,r,o,c,d,m,R,E,p)):ht instanceof hC?K(new $w(ht.id,r,o,c,d,m,E,p)):ht instanceof _m?K(new Xw(ht.id,r,o,c,d,m,C,E,p)):ht instanceof gC?K(new kk(ht.id,r,o,c,d,m,E,p)):ht instanceof _C?K(new Gk(ht.id,r,o,c,d,m,b,M,E,p)):ht instanceof LC&&K(new Qw(ht.id,r,o,c,d,m,E,p)))};!vQ(a.id)&&!Se?Et(g("wiredfurni.nonowner.change.confirm.body"),()=>{Ze(a)},null,null,null,g("wiredfurni.nonowner.change.confirm.title")):Ze(a)},ws=(Ze,ht)=>{!a||!G||Ze<=0||(fe!==2?_(Wi=>{const Cs=[...Wi],js=Wi.indexOf(Ze);return js>=0?(Cs.splice(js,1),Ai.hide(Ze,de,fe)):Cs.length<a.maximumItemSelectionCount&&(Cs.push(Ze),Ai.show(Ze,de,fe)),Cs}):f(Wi=>{const Cs=[...Wi],js=Wi.indexOf(Ze);return js>=0?(Cs.splice(js,1),Ai.hide(Ze,de,fe)):Cs.length<a.maximumItemSelectionCount&&(Cs.push(Ze),Ai.show(Ze,de,fe)),Cs}))},Jn=(Ze,ht=!1,Wi=1)=>{if(!(!a||!G)&&!(Ze<=0)){if(ht){Wi===1?_(Cs=>{const js=[...Cs];return Cs.indexOf(Ze)>=0||js.length<a.maximumItemSelectionCount&&(js.push(Ze),Ai.show(Ze,ht,Wi)),js}):Wi===2&&f(Cs=>{const js=[...Cs];return Cs.indexOf(Ze)>=0||js.length<a.maximumItemSelectionCount&&(js.push(Ze),Ai.show(Ze,ht,Wi)),js});return}_(Cs=>{const js=[...Cs];return Cs.indexOf(Ze)>=0||js.length<a.maximumItemSelectionCount&&(js.push(Ze),Ai.show(Ze,ht,Wi)),js})}},Uc=Ze=>{const ht=Ze.wiredContext.roomVariablesList;return ht&&ht.needsSynchronize?(H.current!=null&&ni(H.current),H.current=Wi=>{H.current=null,Ze.wiredContext.roomVariablesList.synchronize(Wi),yi(Ze)},ri(H.current,!0,ht.hash),!0):!1};J(nL,Ze=>{Ze.getParser(),Ai.unhighlightActiveWired(a.id),e(null)}),J(sL,Ze=>{const ht=Ze.getParser();yi(ht.def)}),J(iL,Ze=>{const ht=Ze.getParser();yi(ht.def)}),J(rL,Ze=>{const ht=Ze.getParser();yi(ht.def)}),J(Pk,Ze=>{const ht=Ze.getParser();yi(ht.def)}),J(Uk,Ze=>{const ht=Ze.getParser();yi(ht.def)}),J(lL,Ze=>{const ht=Ze.getParser();yi(ht.def)});const yi=Ze=>{Uc(Ze)||e(Ze)};return J(kC,Ze=>{const ht=Ze.getParser();i(ht.groups)}),J(vL,Ze=>{const ht=Ze.getParser();ht&&Z(ht.categories)}),J(AL,Ze=>{const ht=Ze.getParser();ht&&ee(ht.categories)}),h.useEffect(()=>{if(a)return me(a.inputSourcesConf.isDualFurniPickingMode()),ae(1),Ai.highlightActiveWired(a.id),()=>{Ai.unhighlightActiveWired(a.id),n([]),u(""),O(0),y(0),U(0),A(0),I([]),S([]),me(!1),ae(1),_(Ze=>(Ze&&Ze.length&&Ai.hideAll(Ze),[])),f(Ze=>(Ze&&Ze.length&&Ai.hideAll(Ze),[])),F(!1)}},[a]),h.useEffect(()=>{a&&(a.stuffTypeSelectionCode===Fe.PLAY_MUSIC&&!ie.size?K(new gF):a.stuffTypeSelectionCode===Fe.PLAY_SOUND_EFFECT&&!se.size&&K(new mF))},[a,ie,se]),{trigger:a,setTrigger:e,groups:t,setGroups:i,intParams:r,setIntParams:n,variableIds:o,setVariableIds:l,stringParam:c,setStringParam:u,furniIds:d,setFurniIds:_,furniIds2:m,setFurniIds2:f,actionDelay:R,setActionDelay:O,quantifier:C,setQuantifier:A,filter:b,setFilter:y,inverse:M,setInverse:U,furniSources:E,setFurniSources:I,userSources:p,setUserSources:S,allowsFurni:G,setAllowsFurni:F,saveWired:yt,selectObjectForWired:ws,setSourceForWired:Jn,furnisSelectedCopy:v,setFurnisSelectedCopy:B,selectorNeighborhoodCopy:z,setSelectorNeighborhoodCopy:$,wiredAlwaysOpenAdvancedOptions:W,setWiredAlwaysOpenAdvancedOptions:V,wiredSoundEffectsCategories:se,setWiredSoundEffectsCategories:ee,wiredMusicsCategories:ie,setWiredMusicsCategories:Z,variablesCallback:H,neighborhood:Le,selectedSource:ne,setSelectedSource:_e,isDual:de,setIsDual:me,dualType:fe,setDualType:ae}},le=()=>Ht(yie),Die=()=>{const[a,e]=h.useState(null),[t,i]=h.useState(null),[r,n]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState(null),[d,_]=h.useState(-1),[m,f]=h.useState(-1),[E,I]=h.useState(!1),{friends:p=[]}=Jr(),{selectObjectForWired:S=null}=le(),{roomSession:R=null}=vt(),[O,C]=h.useState(!0),A=v=>{n(B=>{const z=[...B];return z.splice(v,1),z})},b=v=>{l(v)},y=v=>{l(B=>{const z=[...B],$=z.splice(v,1)[0];return c===$&&u(null),z})},M=v=>{u(v),l([])},U=(v,B)=>{const z=Co.getObjectName(v,B);z&&(i(z),B!==Q.UNIT&&l([]))},G=(v,B,z=!0)=>{let $=null;switch(B){case Q.FLOOR:case Q.WALL:$=Co.getFurniInfo(v,B),$&&(S(v,B),z&&K(new uw($.id)));break;case Q.UNIT:{const W=R.userDataManager.getUserDataByIndex(v);if(!W)break;switch(W.type){case Xt.PET:R.userDataManager.requestPetInfo(W.webID),_(W.webID);break;case Xt.USER:$=Co.getUserInfo(B,W),K(new hw(W.webID,R.ownRoomIndex));break;case Xt.BOT:$=Co.getBotInfo(B,W),K(new Xx(W.webID,R.ownRoomIndex));break;case Xt.RENTABLE_BOT:$=Co.getRentableBotInfo(B,W),K(new Xx(W.webID,R.ownRoomIndex));break}}}if($){if(a&&($.type===$s.PEER||$.type===$s.OWN_USER||$.type===$s.BOT)&&$.type===a.type&&($==null?void 0:$.name)===(a==null?void 0:a.name)){e(null);return}e($)}},F=v=>{},H=()=>{};return ms(yf.USER_DATA_UPDATED,v=>{if(!v.addedUsers.length)return;let B=[];v.addedUsers.forEach(z=>{z.webID!==te().userId&&p.find($=>$.id===z.webID)&&B.push(new Dk(z.roomIndex,Q.UNIT,z.webID,z.name,z.nick,z.coloredName,z.type,!0))}),B.length&&n(z=>{const $=[...z];return B.forEach(W=>{const V=$.findIndex(se=>se.id===W.id);V>-1&&$.splice(V,1),$.push(W)}),$})}),ms(Cf.PET_INFO,v=>{const B=v.petInfo;if(!B||B.id!==d)return;const z=Co.getPetInfo(B);z&&(e(z),_(-1))}),ms(Nf.PET_STATUS_UPDATE,v=>{}),ut(vd.USE_PRODUCT_FROM_INVENTORY,v=>{}),Fte(jg.WIRED_USER_CLICK_HANDLED,v=>{v.index===R.ownRoomIndex&&C(v.openMenu)}),ut(Ie.REQUEST_MONSTERPLANT_SELECT_REPRODUCE,v=>{const B=v.objectId,z=v.roomId;if(!(z>0)||!(B>0))return;const $=R.userDataManager.getDataByType(B,Xt.PET);if(!$)return;const W=$.figure.split(" "),V=W.length>0?W[0]:-1,ee=ce().sessionDataManager.userId,ie=R.getBreedMenuForPets(z,B,parseInt(V.toString()),$.roomIndex,ee);ie.length&&l(ie)}),ut(vd.USE_PRODUCT_FROM_ROOM,v=>{const B=ce().getRoomObject(R.roomId,v.objectId,Q.FLOOR);if(!B||!gr(B))return;const z=B.model.getValue(D.FURNITURE_OWNER_ID),$=B.model.getValue(D.FURNITURE_TYPE_ID),W=te().getFloorItemData($),V=W.customParams.split(" "),se=V.length?parseInt(V[0]):-1;if(se===-1)return;const ee=[],ie=ce().getRoomObjects(R.roomId,Q.UNIT);for(const Z of ie){const ne=R.userDataManager.getUserDataByIndex(Z.id);let _e=!1;if(!(!ne||ne.type!==Xt.PET)){if(ne.ownerId===z){ne.hasSaddle&&W.specialType===Je.PET_SADDLE&&(_e=!0);const de=ne.figure.split(" ");if((de.length?parseInt(de[0]):-1)===se&&(W.specialType===Je.MONSTERPLANT_REVIVAL&&!ne.canRevive||W.specialType===Je.MONSTERPLANT_REBREED&&(ne.petLevel<7||ne.canRevive||ne.canBreed)||W.specialType===Je.MONSTERPLANT_FERTILIZE&&(ne.petLevel>=7||ne.canRevive)))continue;ee.push(new jk(ne.roomIndex,Q.UNIT,ne.name,v.objectId,Z.id,-1,_e))}}}u(null),ee.length&&l(ee)}),ut(ke.REQUEST_MANIPULATION,v=>{Wg(R,v.objectId,v.category)&&I(!0)}),Sm(v=>{G(v.id,v.category,v.sendClickPacket)}),YG(v=>{e(null),l([])}),xse(v=>{v.category!==Q.UNIT||a&&a.type!==Vn.FURNI&&v.category===Q.UNIT||U(v.id,v.category)}),Rse(v=>{!t||v.category!==Q.UNIT||t.roomIndex!==v.id||i(null)}),Js([hs.FURNI_REMOVED,hs.USER_REMOVED],v=>{if(t&&t.category===v.category&&t.roomIndex===v.id&&i(null),v.category===Q.UNIT){let B=r.findIndex(z=>z.roomIndex===v.id);B>-1&&n(z=>z.filter($=>$.roomIndex===v.id)),B=o.findIndex(z=>z.id===v.id),B>-1&&l(z=>z.filter($=>$.id!==v.id))}else v.category===Q.FLOOR&&o.findIndex(z=>z.id===v.id)>-1&&l(z=>z.filter($=>$.requestRoomObjectId!==v.id));a&&(a instanceof Vn?a.id===v.id&&e(null):(a instanceof $s||a instanceof $u||a instanceof Xu)&&a.roomIndex===v.id&&e(null))}),h.useEffect(()=>{a&&(i(null),n([]),l([]))},[a]),h.useEffect(()=>{t&&n([])},[t]),h.useEffect(()=>{R&&(R.isDecorating=E)},[R,E]),{avatarInfo:a,activeNameBubble:t,nameBubbles:r,productBubbles:o,confirmingProduct:c,isDecorating:E,monsterPlantBreed:m,openMenu:O,setOpenMenu:C,setAvatarInfo:e,setActiveNameBubble:i,setMonsterPlantBreed:f,setIsDecorating:I,removeNameBubble:A,removeProductBubble:y,setProductsBubbles:b,updateConfirmingProduct:M,getObjectName:U,getObjectInfo:G,processUsableRoomObject:F,refreshPetInfo:H}},FN=()=>Ht(Die),Mie=()=>{const[a,e]=br(tr.FONT_SIZE,"1"),[t,i]=br(tr.SHOW_GIFS,!0),[r,n]=br(tr.SHOW_FPS,!1),[o,l]=br(tr.GROUP_REPEATED_MESSAGES,!0),[c,u]=br(tr.ROOM_ZOOM,!0),[d,_]=br(tr.ACTIVE_CHAT,!0);return{settingFontSize:a,setSettingFontSize:e,showGifs:t,setShowGifs:i,showFps:r,setShowFps:n,groupRepeatedMessages:o,setGroupRepeatedMessages:l,roomZoomActive:c,setRoomZoomActive:u,activeChat:d,setActiveChat:_}},Ea=()=>Ht(Mie),jie=()=>{const[a,e]=h.useState(""),[t,i]=h.useState(!1),[r,n]=h.useState(!1),[o,l]=h.useState(!1),[c,u]=h.useState(!1),[d,_]=h.useState(0),{showNitroAlert:m=null,showConfirm:f=null,showSingleBubble:E=null,getNotificationImageUrl:I=null}=kt(),{roomSession:p=null}=vt(),{setActiveChat:S,activeChat:R}=Ea(),{isEnabled:O,hasReadPermission:C,hasWritePermission:A,switchPlayTestMode:b,playTestMode:y}=Tn();function M(G){return!isNaN(parseFloat(G))&&isFinite(G)}const U=(G,F,H="",v=0)=>{if(G==="")return null;const B=G.split(" "),z=ce().selectedAvatarId;let $=p.userDataManager.getUserDataByIndex(z);if(B.length>0){const W=B[0];let V="";switch(B.length>1&&(V=B[1]),W.charAt(0)===":"&&V==="x"&&$&&(V=$.name,G=G.replace(" x"," "+$.name)),W.charAt(0)===":"&&V==="@x"&&$&&(V=$.name,G=G.replace(": @x","@"+$.name)),W===":@x"&&$&&(V=$.name,G=G.replace(":@x","@"+$.name)),G.includes(": x")&&$&&(G=G.replace(": x"," "+$.name)),W.toLowerCase()){case":shake":case":rotate":return Md.init(2500,5e3),Md.turnVisualizationOn(),null;case":d":case";d":p.sendExpressionMessage(ca.LAUGH.ordinal);break;case"o/":case"_o/":return p.sendExpressionMessage(ca.WAVE.ordinal),null;case":kiss":return p.sendExpressionMessage(ca.BLOW.ordinal),null;case":jump":if(ti()===rr.VIP)return p.sendExpressionMessage(ca.JUMP.ordinal),null;break;case":idle":return p.sendExpressionMessage(ca.IDLE.ordinal),null;case"_b":return p.sendExpressionMessage(ca.RESPECT.ordinal),null;case":sign":return p.sendSignMessage(parseInt(V)),null;case":roomid":case":gotoroom":return M(V)&&K(new gT(parseInt(V),null,te().isModerator?0:1)),null;case":zoom":return parseFloat(V)<0||ce().events.dispatchEvent(new Sf(p.roomId,parseFloat(V),!1)),null;case":screenshot":const se=ce().createTextureFromRoom(p.roomId,1),ee=new Image;return ee.src=Vt.generateImageUrl(se),window.open("").document.write(ee.outerHTML),null;case":pickall":return(p.isRoomOwner||te().isModerator||p.controllerLevel>=pt.USER_WITH_RIGHTS)&&f(g("room.confirm.pick_all"),()=>{te().sendSpecialCommandMessage(":pickall")},null,null,null,g("generic.alert.title")),null;case":ejectall":return(p.isRoomOwner||te().isModerator||p.controllerLevel>=pt.USER_WITH_RIGHTS)&&f(g("room.confirm.eject_all"),()=>{te().sendSpecialCommandMessage(":ejectall")},null,null,null,g("generic.alert.title")),null;case":pickallwired":return(p.isRoomOwner||te().isModerator||p.controllerLevel>=pt.USER_WITH_RIGHTS)&&f(g("room.confirm.pick_all_wired"),()=>{te().sendSpecialCommandMessage(":pickallwired")},null,null,null,g("generic.alert.title")),null;case":pickallrares":case":pickrares":case":pickraros":return(p.isRoomOwner||te().isModerator||p.controllerLevel>=pt.USER_WITH_RIGHTS)&&f(g("room.confirm.pick_all_rares"),()=>{te().sendSpecialCommandMessage(":pickallrares")},null,null,null,g("generic.alert.title")),null;case":ignore":return V&&($=p.userDataManager.getUserDataByName(V),$&&te().ignoreUser($.webID+"")),null;case":unignore":return V&&($=p.userDataManager.getUserDataByName(V),$&&te().unignoreUser($.webID+"")),null;case":empty":return f(g("room.confirm.empty"),()=>{te().sendSpecialCommandMessage(":empty confirmar")},null,null,null,g("generic.alert.title")),null;case":furni":return(p.isRoomOwner||te().isModerator||p.controllerLevel>=pt.USER_WITH_RIGHTS)&&Ce("furni-chooser/"),null;case":chooser":return(p.isRoomOwner||te().isModerator||p.controllerLevel>=pt.USER_WITH_RIGHTS)&&Ce("user-chooser/"),null;case":tags":return Ce("user-tags/toggle"),null;case":carteira":return Ce("user-transactions/toggle"),null;case":floor":case":bcfloor":return p.controllerLevel>=pt.ROOM_OWNER&&Ce("floor-editor/show"),null;case":wall":case":bcwall":return p.controllerLevel>=pt.ROOM_OWNER&&Ce("wall-editor/show"),null;case":togglefps":return Gi().maxFPS>0?Gi().maxFPS=0:Gi().maxFPS=xe("system.animation.fps"),null;case":fps":return M(V)&&(Gi().maxFPS=parseInt(V)),null;case":state":return M(V)&&(Lx(!0),Ux(parseInt(V)),K(new Op(gc(),fp()+"",!0,parseInt(V),!1,!1,!1,!1,!1,!1))),null;case":stateoff":return Lx(!1),Ux(0),K(new Op(gc(),fp()+"",!1,0,!1,!1,!1,!1,!1,!1)),null;case":pin":return M(V)&&Mx(parseInt(V)),null;case":pinoff":return Mx(-1),null;case":ping":return Oe().latencyTracker&&Oe().latencyTracker.update(Date.now(),1),null;case":pingsay":return Oe().latencyTracker&&Oe().latencyTracker.update(Date.now(),2),null;case":wf":case":wiredtools":case":wiredtool":return O()&&(C()||A())&&Ce("wiredmenu/open"),null;case":var":case":variables":case":variaveis":return Ce("wiredmenu/open/variable_overview"),null;case":inspect":case":inspection":return Ce("wiredmenu/open/variable_inspection"),null;case":playtest":return b(!y,!0,!0),null;case":doubleclick":case":dbclick":return te().setDoubleClickEnabled(!te().isDoubleClick),E(`Double click ${te().isDoubleClick?"enabled":"disabled "}`,bi.INFO,I(new Map,"generic")),null;case":settings":return(p.isRoomOwner||te().isModerator)&&K(new mT(p.roomId)),null;case":mention":return Ce("mention-history/show"),null;case":hidechat":return S(!R),E(`Chat ${R?"disabled ":"enabled"}`,bi.INFO,I(new Map,"generic")),null}}switch(F){case yo.CHAT_DEFAULT:p.sendChatMessage(G,v);break;case yo.CHAT_SHOUT:p.sendShoutMessage(G,v);break;case yo.CHAT_WHISPER:p.sendWhisperMessage(H,G,v);break}};return ms(wt.FLOOD_EVENT,G=>{u(!0),_(parseFloat(G.message))}),Sm(G=>{if(G.category!==Q.UNIT)return;const F=p.userDataManager.getUserDataByIndex(G.id);F&&e(F.name)}),ut(ke.DESELECTED,G=>e("")),h.useEffect(()=>{if(!c)return;let G=0;const F=setInterval(()=>{_(H=>(G=Math.max(0,(H||0)-1),G)),G<=0&&(clearInterval(F),u(!1))},1e3);return()=>clearInterval(F)},[c]),h.useEffect(()=>{if(!o)return;let G=null;return o&&(G=setTimeout(()=>{l(!1),i(!1)},1e4)),()=>clearTimeout(G)},[o]),h.useEffect(()=>{t?r||(n(!0),p.sendChatTypingMessage(t)):r&&(n(!1),p.sendChatTypingMessage(t))},[p,t,r]),{selectedUsername:a,floodBlocked:c,floodBlockedSeconds:d,setIsTyping:i,setIsIdle:l,sendChat:U}},Lie=jie,Pie=1e3;let Uie=0;const wie=()=>{const[a,e]=h.useState([]),t=i=>{i.id=Uie++,e(r=>{const n=[...r];return n.push(i),n.length>Pie&&n.shift(),n})};return J(yC,i=>{const r=i.getParser();if(r.type!=="notification_mention")return;const n=r.parameters,o=n.get("image"),l=n.get("username"),c=n.get("linkUrl");let u=Ak(n.get("message").replace(/\\r/g,"\r")).replace(`${l} te mencionou:

`,"");t({id:-1,name:l,image:o,style:0,chatType:0,message:u,timestamp:pp(),linkUrl:c})}),{addMentionEntry:t,chatHistory:a}},$G=()=>Ht(wie),lv=new Map,cv=new Map,uv=new Map,Fie=()=>{const[a,e]=h.useState([]),[t,i]=h.useState({mode:Ds.CHAT_MODE_FREE_FLOW,weight:Ds.CHAT_BUBBLE_WIDTH_NORMAL,speed:Ds.CHAT_SCROLL_SPEED_NORMAL,distance:50,protection:Ds.FLOOD_FILTER_NORMAL}),{roomSession:r=null}=vt(),{addChatEntry:n}=bT(),{addMentionEntry:o}=$G(),l=h.useRef(!1),{groupRepeatedMessages:c}=Ea(),u=h.useMemo(()=>{if(!t)return 6e3;switch(t.speed){case Ds.CHAT_SCROLL_SPEED_FAST:return 3e3;case Ds.CHAT_SCROLL_SPEED_NORMAL:return 6e3;case Ds.CHAT_SCROLL_SPEED_SLOW:return 12e3}},[t]),d=E=>{const I=qt().createAvatarImage(E,Hn.LARGE,null,{resetFigure:R=>{l.current||d(R)},dispose:()=>{},disposed:!1});if(!I)return;const p=I.getCroppedImage(ki.HEAD),S=I.getPartColor(Ee.CHEST);return lv.set(E,S&&S.rgb||16777215),I.dispose(),cv.set(E,p.src),p.src},_=E=>{let I=cv.get(E);return I||(I=d(E)),I},m=(E,I,p,S=64,R=null)=>{let O=uv.get(E+R);if(O)return O;const C=new Vo(E),A=C.typeId,b=ce().getRoomObjectPetImage(A,C.paletteId,C.color,new Y(I*45),S,null,!1,0,C.customParts,R);return b&&(O=Vt.generateImageUrl(b.data),uv.set(E+R,O)),O},f=(E,I)=>{if(!I)return E.map(R=>(R.repeatCount=1,R));let p=[],S=null;return E.forEach(R=>{S&&S.senderId===R.senderId&&S.formattedText===R.formattedText&&S.type===R.type&&S.color===R.color&&S.styleId===R.styleId?S.repeatCount+=1:(S=R,p.push(S))}),p};return ms(wt.CHAT_EVENT,E=>{const I=ce().getRoomObject(r.roomId,E.objectId,Q.UNIT),p=I?nk(r.roomId,I==null?void 0:I.id,Q.UNIT):new ei,S=I?r.userDataManager.getUserDataByIndex(E.objectId):new NG(-1);let R="",O=0,C=null,A=E.chatType,b=E.style,y=0,M=E.message;E.isMention;let U=E.messageContent,G="",F=!1;if(S){y=S.type;const z=S.figure;switch(y){case Xt.PET:C=m(z,2,!0,64,I.model.getValue(D.FIGURE_POSTURE)),new Vo(z).typeId;break;case Xt.USER:C=_(z);break;case Xt.RENTABLE_BOT:case Xt.BOT:b=uc.BOT;break}O=lv.get(z),F=S.nick.length>0&&S.nick!=S.name,R=F&&S.nick.length>0?S.nick:S.name,G=S.name}switch(A){case wt.CHAT_TYPE_RESPECT:M=g("widgets.chatbubble.respect",["username"],[G]);break;case wt.CHAT_TYPE_PETREVIVE:case wt.CHAT_TYPE_PET_REBREED_FERTILIZE:case wt.CHAT_TYPE_PET_SPEED_FERTILIZE:{let z="widget.chatbubble.petrevived";A===wt.CHAT_TYPE_PET_REBREED_FERTILIZE?z="widget.chatbubble.petrefertilized;":A===wt.CHAT_TYPE_PET_SPEED_FERTILIZE&&(z="widget.chatbubble.petspeedfertilized");let $=null;if(ce().getRoomObject(r.roomId,E.extraParam,Q.UNIT)){const V=r.userDataManager.getUserDataByIndex(I.id);V&&($=V.name)}M=g(z,["petName","userName"],[R,$]);break}case wt.CHAT_TYPE_PETRESPECT:M=g("widget.chatbubble.petrespect",["petname"],[R]);break;case wt.CHAT_TYPE_PETTREAT:M=g("widget.chatbubble.pettreat",["petname"],[R]);break;case wt.CHAT_TYPE_HAND_ITEM_RECEIVED:M=g("widget.chatbubble.handitem",["uniqueName","handitem"],[R,g("handitem"+E.extraParam)]);break;case wt.CHAT_TYPE_MUTE_REMAINING:{const z=(E.extraParam>0?Math.floor(E.extraParam/3600):0).toString(),$=(E.extraParam>0?Math.floor(E.extraParam%3600/60):0).toString(),W=(E.extraParam%60).toString();M=g("widget.chatbubble.mutetime",["hours","minutes","seconds"],[z,$,W]);break}}const H=Ak(M),v=O&&("#"+O.toString(16).padStart(6,"0")||null),B=new zx(S.roomIndex,Q.UNIT,r.roomId,M,H,R,new ei(p.x,p.y),A,b,C,v,U,G,F);if(e(z=>f([...z,B],c)),H.startsWith("@")){const z=H.replace("@","").split(" ");if(z.length==0)return;const $=z[0];$===te().userName&&o({id:-1,name:G,image:C,style:0,chatType:0,message:H.replace(`@${$}`,""),timestamp:pp(),linkUrl:`event:navigator/goto/${r.roomId}`})}n({id:-1,webId:S.webID,entityId:S.roomIndex,name:G,imageUrl:C,style:b,chatType:A,entityType:S.type,message:H,timestamp:pp(),type:Ar.TYPE_CHAT,roomId:r.roomId,color:v,messageContent:U})}),ut(Ef.ROOM_DRAG,E=>{if(!a.length||E.roomId!==r.roomId)return;const I=E.offsetX;a.forEach(p=>p.elementRef&&(p.left+=I))}),J(bl,E=>{const I=E.getParser();I.roomEnter&&i(I.chat)}),J(yj,E=>{const I=E.getParser();i(I.chat)}),h.useEffect(()=>(l.current=!1,()=>{l.current=!0}),[]),{chatMessages:a,setChatMessages:e,chatSettings:t,getScrollSpeed:u,getUserImage:_,getPetImage:m,updateRepeatedMessages:f}},kie=Fie,Gie=()=>{const[a,e]=h.useState([]),t=n=>{a.indexOf(n)>=0||e([...a,n])},i=n=>{const o=a.indexOf(n);if(o===-1)return;const l=[...a];l.splice(o,1),e(l)},r=(n,o)=>{$e().sendDoorbellApprovalMessage(n,o),i(n)};return ms(Ga.DOORBELL,n=>t(n.userName)),ms(Ga.RSDE_REJECTED,n=>i(n.userName)),ms(Ga.RSDE_ACCEPTED,n=>i(n.userName)),{users:a,addUser:t,removeUser:i,answer:r}},Bie=Gie,Vie=()=>{const[a,e]=h.useState(null),[t,i]=h.useState(!1),r=()=>i(!1);return J(K0,n=>{const o=n.getParser();i(!0),e(o.words)}),{wordsFilter:a,isVisible:t,setWordsFilter:e,onClose:r}},Hie=Vie,Wie=()=>{const[a,e]=h.useState([]),{requests:t=[],dismissedRequestIds:i=[],setDismissedRequestIds:r=null}=Jr(),n=h.useMemo(()=>a.filter(l=>i.indexOf(l.request.requesterUserId)===-1),[a,i]),o=l=>{r(c=>{if(c.indexOf(l)>=0)return c;const u=[...c];return u.push(l),u})};return zG(!0,l=>{if(l.category!==Q.UNIT)return;const c=$e().userDataManager.getUserDataByIndex(l.id);if(!c||c.type!==Ft.getTypeNumber(Ft.USER))return;const u=t.find(_=>_.requesterUserId===c.webID);if(!u||a.find(_=>_.request.requesterUserId===c.webID))return;const d=[...a];d.push({roomIndex:c.roomIndex,request:u}),e(d)}),KG(!0,l=>{if(l.category!==Q.UNIT)return;const c=a.findIndex(d=>d.roomIndex===l.id);if(c===-1)return;const u=[...a];u.splice(c,1),e(u)}),h.useEffect(()=>{const l=[];for(const c of t){const u=$e().userDataManager.getUserData(c.requesterUserId);u&&l.push({roomIndex:u.roomIndex,request:c})}e(l)},[t]),{displayedRequests:n,hideFriendRequest:o}},Yie=Wie,zie=()=>{const[a,e]=h.useState(null),{roomSession:t=null}=vt(),{trigger:i=null}=le(),r=()=>{e(null)},n=c=>{if(c){if(ce().selectRoomObject($e().roomId,c.id,c.category),i)return;Ai.show(c.id),setTimeout(()=>{Ai.hide(c.id)},500)}},o=()=>{ce().deselectRoomObject($e().roomId)},l=()=>{const c=te(),u=ce().getRoomObjects(t.roomId,Q.WALL),d=ce().getRoomObjects(t.roomId,Q.FLOOR),_=u.map(f=>{if(f.id<0)return null;let E=f.type;if(E.startsWith("poster"))E=g(`poster_${E.replace("poster","")}_name`);else{const I=f.model.getValue(D.FURNITURE_TYPE_ID),p=c.getWallItemData(I);p&&p.name.length&&(E=p.name)}return new wu(f.id,Q.WALL,E,f.model.getValue(D.FURNITURE_OWNER_NAME),f.model.getValue(D.FURNITURE_UNIQUE_SERIAL_NUMBER),f.model.getValue(D.FURNITURE_UNIQUE_SERIAL_NUMBER))}),m=d.map(f=>{if(f.id<0)return null;let E=f.type;const I=f.model.getValue(D.FURNITURE_TYPE_ID),p=c.getFloorItemData(I);return p&&p.name.length&&(E=p.name),new wu(f.id,Q.FLOOR,E,f.model.getValue(D.FURNITURE_OWNER_NAME),f.model.getValue(D.FURNITURE_UNIQUE_SERIAL_NUMBER),f.model.getValue(D.FURNITURE_UNIQUE_SERIAL_NUMBER))});e([..._,...m].sort((f,E)=>f.name<E.name?-1:1))};return Sse(!!a,c=>{if(c.id<0)return;const u=ce().getRoomObject($e().roomId,c.id,c.category);if(!u)return;let d=null;switch(c.category){case Q.WALL:{let _=u.type;if(_.startsWith("poster"))_=g(`poster_${_.replace("poster","")}_name`);else{const m=u.model.getValue(D.FURNITURE_TYPE_ID),f=te().getWallItemData(m);f&&f.name.length&&(_=f.name)}d=new wu(u.id,Q.WALL,_,u.model.getValue(D.FURNITURE_OWNER_NAME),u.model.getValue(D.FURNITURE_UNIQUE_SERIAL_NUMBER),u.model.getValue(D.FURNITURE_UNIQUE_SERIAL_NUMBER));break}case Q.FLOOR:{let _=u.type;const m=u.model.getValue(D.FURNITURE_TYPE_ID),f=te().getFloorItemData(m);f&&f.name.length&&(_=f.name),d=new wu(u.id,Q.FLOOR,_,u.model.getValue(D.FURNITURE_OWNER_NAME),u.model.getValue(D.FURNITURE_UNIQUE_SERIAL_NUMBER),u.model.getValue(D.FURNITURE_UNIQUE_SERIAL_NUMBER))}}e(_=>[..._,d].sort((m,f)=>m.name<f.name?-1:1))}),Zr(!!a,c=>{c.id<0||e(u=>{const d=[...u];for(let _=0;_<d.length;_++){const m=d[_];if(!(m.id!==c.id||m.category!==c.category)){d.splice(_,1);break}}return d})}),{items:a,onClose:r,selectItem:n,deselectItem:o,populateChooser:l}},Kie=zie,qie=()=>{const[a,e]=h.useState(!1),[t,i]=h.useState(-1),[r,n]=h.useState(""),[o,l]=h.useState(""),[c,u]=h.useState(""),d=()=>{u(""),l(""),n(""),i(-1),e(!1)},_=()=>{K(new lN(t,o))},m=E=>{l(E),c.length>0&&u("")},f=E=>{if(!(!E||E===0))switch(E){case 1:return g("catalog.alert.petname.long");case 2:return g("catalog.alert.petname.short");case 3:return g("catalog.alert.petname.chars");case 4:default:return g("catalog.alert.petname.bobba")}};return ms(dc.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,E=>{if(!E)return;const I=ce().getRoomObject(E.session.roomId,E.objectId,Q.FLOOR);i(E.objectId),n(I.type),e(!0)}),ms(dc.RSOPPE_OPEN_PET_PACKAGE_RESULT,E=>{E&&(E.nameValidationStatus===0&&d(),E.nameValidationStatus!==0&&u(f(E.nameValidationStatus)))}),{isVisible:a,errorResult:c,petName:o,objectType:r,onChangePetName:m,onConfirm:_,onClose:d}},Xie=qie,$ie=()=>{const{roomSession:a=null}=vt(),e=r=>a.sendPollStartMessage(r),t=r=>a.sendPollRejectMessage(r),i=(r,n,o)=>a.sendPollAnswerMessage(r,n,o);return ms(La.OFFER,r=>{const n=new kl(kl.OFFER,r.id);n.summary=r.summary,n.headline=r.headline,_i(n)}),ms(La.ERROR,r=>{const n=new kl(kl.ERROR,r.id);n.summary=r.summary,n.headline=r.headline,_i(n)}),ms(La.CONTENT,r=>{const n=new kl(kl.CONTENT,r.id);n.startMessage=r.startMessage,n.endMessage=r.endMessage,n.numQuestions=r.numQuestions,n.questionArray=r.questionArray,n.npsPoll=r.npsPoll,_i(n)}),{startPoll:e,rejectPoll:t,answerPoll:i}},Qie=$ie,Jie=()=>{const[a,e]=h.useState(null);vt();const t=()=>e(null),i=n=>n&&ce().selectRoomObject($e().roomId,n.id,n.category),r=()=>{const n=$e(),o=ce().getRoomObjects(n.roomId,Q.UNIT);e(o.map(l=>{if(l.id<0)return null;const c=n.userDataManager.getUserDataByIndex(l.id);return c?new wu(c.roomIndex,Q.UNIT,c.name,"",0,0,c.type):null}).sort((l,c)=>l.name<c.name?-1:1))};return zG(!!a,n=>{if(n.id<0)return;const o=$e().userDataManager.getUserDataByIndex(n.id);o&&e(l=>{const c=[...l];return c.push(new wu(o.roomIndex,Q.UNIT,o.name,"",0,0,o.type)),c.sort((u,d)=>u.name<d.name?-1:1),c})}),KG(!!a,n=>{n.id<0||e(o=>{const l=[...o];for(let c=0;c<l.length;c++){const u=l[c];if(!(u.id!==n.id||u.category!==n.category)){l.splice(c,1);break}}return l})}),{items:a,onClose:t,selectItem:i,populateChooser:r}},en=Jie,hv=4e3,Zie=3,ere=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(null),[r,n]=h.useState(!1),[o,l]=h.useState(null),[c,u]=h.useState(new Map),[d,_]=h.useState(new Map),{answerPoll:m=null}=Qie(),{roomSession:f=null}=vt(),E=()=>{e(-1),i(null)},I=p=>{r||!t||(m(a,t.id,[p]),n(!0))};return ms(Pa.ANSWERED,p=>{const S=f.userDataManager.getUserData(p.userId);S&&(u(p.answerCounts),_(R=>{if(!R.has(S.roomIndex)){const O=new Map(d);return O.set(S.roomIndex,{value:p.value,secondsLeft:Zie}),O}return R}),ce().updateRoomObjectUserGesture(f.roomId,S.roomIndex,We.getGestureId(p.value==="0"?We.GESTURE_SAD:We.GESTURE_SMILE)))}),ms(Pa.FINISHED,p=>{t&&t.id===p.questionId&&(u(p.answerCounts),n(!0),l(S=>(S&&clearTimeout(S),setTimeout(()=>E(),hv)))),_(new Map)}),ms(Pa.QUESTION,p=>{e(p.id),i(p.question),n(!1),u(new Map),_(new Map),l(S=>{if(S&&clearTimeout(S),p.duration>0){const R=p.duration<1e3?hv:p.duration;return setTimeout(()=>E(),R)}return null})}),h.useEffect(()=>{const p=()=>{_(R=>{const O=[];if(R.forEach((A,b)=>{A.secondsLeft--,A.secondsLeft<=0&&O.push(b)}),O.length===0)return R;const C=new Map(R);return O.forEach(A=>C.delete(A)),C})},S=setInterval(()=>p(),1e3);return()=>clearInterval(S)},[]),h.useEffect(()=>()=>{l(p=>(p&&clearTimeout(p),null))},[]),{question:t,answerSent:r,answerCounts:c,userAnswers:d,vote:I}},tre=ere,sre=()=>{const[a,e]=h.useState(null),[t,i]=h.useState(null),[r,n]=h.useState(0),[o,l]=h.useState(1),[c,u]=h.useState(0),[d,_]=h.useState(0),[m,f]=h.useState(0),[E,I]=br("nitro.screensize",{width:window.innerWidth,height:window.innerHeight}),p=b=>{n(b),K(new Pw(b))},S=b=>{l(b)},R=b=>{te().giveRespect(b),u(te().respectsLeft)},O=b=>{te().giveKiss(b)},C=b=>{te().giveStarGem(b)},A=b=>{te().givePetRespect(b),f(te().respectsPetLeft)};return J(HC,b=>{const y=b.getParser();te().setKissesLeft(y.kissesLeft),_(te().kissesLeft)}),J(Ld,b=>{const y=b.getParser();e(y.userInfo),i(y.userInfo.figure),u(y.userInfo.respectsRemaining),_(y.userInfo.kissesRemaining),f(y.userInfo.respectsPetRemaining)}),J(mC,b=>{const y=b.getParser();i(y.figure)}),J(uT,b=>{const y=b.getParser();n(y.chatType)}),h.useEffect(()=>{const b=Kg("nitro.screensize");if(b&&(b.width!==window.innerWidth||b.height!==window.innerHeight)){let M=window.localStorage.length;for(;M>0;){const U=window.localStorage.key(M);U&&U.startsWith("nitro.window")&&window.localStorage.removeItem(U),M--}}const y=M=>I({width:window.innerWidth,height:window.innerHeight});return window.addEventListener("resize",y),()=>{window.removeEventListener("resize",y)}},[I]),{userInfo:a,userFigure:t,chatStyleId:r,audioSpeed:o,userRespectRemaining:c,userKissRemaining:d,petRespectRemaining:m,updateAudioSpeed:S,respectUser:R,kissUser:O,starGem:C,respectPet:A,updateChatStyleId:p,screenSize:E}},Ja=()=>Ht(sre),ire=a=>h.useEffect(a,[]),QG=a=>ire(()=>a()),rre=()=>{const[a,e]=h.useState([]),[t,i]=h.useState(null),[r,n]=h.useState(!1);return J(Nj,c=>{const u=c.getParser();u&&e(u.quests.sort((d,_)=>d.sortOrder-_.sortOrder))}),J(Cj,c=>{const u=c.getParser();u&&u.quest.accepted&&i(u.quest)}),J(Oj,c=>{const u=c.getParser();u&&i(u.questData)}),J(xj,c=>{i(null)}),h.useEffect(()=>{if(!r){e([]);return}return K(new U1),()=>e([])},[r]),{quests:a,setQuests:e,acceptedQuest:t,visible:r,setVisible:n,acceptQuest:c=>{K(new L1(c))},cancelQuest:()=>{K(new w1)}}},kN=()=>Ht(rre),nre=()=>{const[a,e]=h.useState({}),[t,i]=h.useState({}),[r,n]=h.useState([]),[o,l]=h.useState(Ee.MALE),c=h.useCallback((I,p)=>{const S=C=>{const A=C.split(".");if(!A||!A.length)return;const b={},y={};for(const M of A){const U=M.split("-");if(!U.length)continue;const G=U[0],F=parseInt(U[1]),H=[];let v=2;for(;v<U.length;)H.push(parseInt(U[v])),v++;H.length||H.push(0),F>=0&&(b[G]=F),H.length&&(y[G]=H)}return{partSets:b,colorSets:y}},{partSets:R,colorSets:O}=S(I);e(R),i(O),l(p),n([])},[]),u=h.useCallback((I,p)=>{!I||!I.length||e(S=>{const R={...S};return p===-1?delete R[I]:R[I]=p,R})},[]),d=h.useCallback((I,p,S)=>{!I||!I.length||i(R=>{const O={...R};return O[I]||(O[I]=[]),O[I][p]||(O[I][p]=0),O[I][p]=S,O})},[]),_=h.useCallback(()=>{n([])},[]),m=h.useCallback((I,p,S)=>{if(!p||!p.length)return;const R=Ri.hexToColorId(p);n(O=>{const C=[...O];return S>=C.length?C.push(p):C[S]=p,C}),i(O=>{const C={...O};return C[I]||(C[I]=[]),C[I][S]||(C[I][S]=0),C[I][S]=R,C})},[]),f=h.useMemo(()=>{const I=[],p=Object.keys(a);for(const S of p){const R=a[S];if(!R)continue;let O=`${S}-${R}`;if(t[S]&&t[S].length){let C=0;for(;C<t[S].length;)O+=`-${t[S][C]}`,C++}I.push(O)}return I.join(".")},[a,t]),E=h.useCallback((I,p=!0)=>[Ee.HEAD].map(R=>{let O=R===Ee.HEAD&&p?I:a[R];const C=t[R]||[];let A=`${R}-${O}`;return O>=0&&(A+=C.map(b=>`-${b}`).join("")),A}).join("."),[a,t]);return{selectedParts:a,selectedColors:t,gender:o,setGender:l,loadAvatarData:c,selectPart:u,selectColor:d,selectCustomColor:m,clearCustomColor:_,customColors:r,getFigureString:f,getFigureStringWithFace:E}},are=nre,JG=a=>(e,t)=>{var n,o,l,c;e.partSet&&e.partSet.clubLevel,t.partSet&&t.partSet.clubLevel;const i=e.partSet?e.partSet.isSellable:!1,r=t.partSet?t.partSet.isSellable:!1;return i&&!r?1:r&&!i?-1:((n=e.partSet)==null?void 0:n.id)<((o=t.partSet)==null?void 0:o.id)?1:((l=e.partSet)==null?void 0:l.id)>((c=t.partSet)==null?void 0:c.id)?-1:0},ZG=(a,e)=>{const t=a?a.clubLevel:-1,i=e?e.clubLevel:-1;return t<i?-1:t>i?1:a.index<e.index?-1:a.index>e.index?1:0},jn=class jn{static clearCache(){this.THUMBNAIL_CACHE.clear()}static async build(e,t,i,r,n=!1){if(!e||!e.length||!t||!t.partSet||!t.partSet.parts||!t.partSet.parts.length)return null;const o=this.getThumbnailKey(e,t),l=this.THUMBNAIL_CACHE.get(o);if(l)return l;const c=(u,d,_,m=!1)=>{const f=new kn,E=u.partSet.parts.concat().sort(this.sortByDrawOrder);for(const I of E){if(!I)continue;let p=null,S=0,R=!1;for(;!R&&S<jn.THUMB_DIRECTIONS.length;){const b=`${Ee.SCALE}_${Ee.STD}_${I.type}_${I.id}_${jn.THUMB_DIRECTIONS[S]}_${Ee.DEFAULT_FRAME}`;p=vr().getAsset(b),p&&p.texture?R=!0:S++}if(!R)continue;const O=p.offsetX,C=p.offsetY,A=new Is(p.texture);if(A.position.set(O,C),d&&I.colorLayerIndex>0&&_&&_.length){const b=_[I.colorLayerIndex-1];b&&(A.tint=b.rgb)}m&&(f.filters=[jn.ALPHA_FILTER]),f.addChild(A)}return f};return new Promise(async(u,d)=>{const _=async f=>{const E=c(t,i,r,n),I=await Vt.generateImageUrl(E);jn.THUMBNAIL_CACHE.set(o,I),u(I)},m=qt().createFigureContainer(`${e}-${t.partSet.id}`);qt().isFigureContainerReady(m)?_():qt().downloadAvatarFigure(m,{resetFigure:_,dispose:null,disposed:!1})})}static async buildForFace(e,t=!1){if(!e||!e.length)return null;const i=e,r=this.THUMBNAIL_CACHE.get(i);return r||new Promise(async(n,o)=>{const l=async c=>{const u=qt().createAvatarImage(c,Hn.LARGE,null,{resetFigure:l,dispose:null,disposed:!1});if(u.isPlaceholder())return;let d=ki.HEAD;const _=u.getCroppedImage(d);u.dispose(),jn.THUMBNAIL_CACHE.set(i,_.src),n(_.src)};l(e)})}static getThumbnailKey(e,t){return`${e}-${t.partSet.id}`}static sortByDrawOrder(e,t){const i=jn.DRAW_ORDER.indexOf(e.type),r=jn.DRAW_ORDER.indexOf(t.type);return i<r?-1:i>r?1:e.index<t.index?-1:e.index>t.index?1:0}};jn.THUMBNAIL_CACHE=new Map,jn.THUMB_DIRECTIONS=[2,6,0,4,3,1],jn.ALPHA_FILTER=new Qy(.2),jn.DRAW_ORDER=[Ee.LEFT_HAND_ITEM,Ee.LEFT_HAND,Ee.LEFT_SLEEVE,Ee.LEFT_COAT_SLEEVE,Ee.BODY,Ee.SHOES,Ee.LEGS,Ee.CHEST,Ee.CHEST_ACCESSORY,Ee.COAT_CHEST,Ee.CHEST_PRINT,Ee.WAIST_ACCESSORY,Ee.RIGHT_HAND,Ee.RIGHT_SLEEVE,Ee.RIGHT_COAT_SLEEVE,Ee.HEAD,Ee.FACE,Ee.EYES,Ee.HAIR,Ee.HAIR_BIG,Ee.FACE_ACCESSORY,Ee.EYE_ACCESSORY,Ee.HEAD_ACCESSORY,Ee.HEAD_ACCESSORY_EXTRA,Ee.RIGHT_HAND_ITEM];let Dc=jn;const ZT=2,ore=()=>{const[a,e]=h.useState(!1),[t,i]=h.useState({}),[r,n]=h.useState(""),[o,l]=h.useState(1),[c,u]=h.useState([]),[d,_]=h.useState([]),[m,f]=h.useState(null),[E,I]=h.useState(!1),p=100,{selectedColors:S,gender:R,setGender:O,loadAvatarData:C,selectPart:A,selectColor:b,selectCustomColor:y,clearCustomColor:M,getFigureString:U,getFigureStringWithFace:G,selectedParts:F,customColors:H}=are(),v=h.useMemo(()=>t[r]??null,[r,t]),B=h.useMemo(()=>{var ie,Z;const ee={};for(const ne of Object.keys(S)){if(!S[ne])continue;const _e=[];for(const de of Object.keys(S[ne])){const me=(Z=(ie=v.find(fe=>fe.setType===ne))==null?void 0:ie.colorItems[de])==null?void 0:Z.find(fe=>fe.id===S[ne][de]);me&&_e.push(me)}ee[ne]=_e}return ee},[v,S]),z=h.useCallback((ee,ie)=>{if(!ee||!ee.length)return;const Z=v.find(_e=>_e.setType===ee);if(!Z||!Z.partItems||!Z.partItems.length)return;const ne=Z.partItems.find(_e=>_e.id===ie);if(ne){if(ne.isClear){A(ee,-1);return}ti()<ne.partSet.clubLevel||(l(ne.maxPaletteCount||1),A(ee,ie))}},[v,A]),$=h.useCallback((ee,ie,Z)=>{if(!ee||!ee.length)return;const ne=v.find(me=>me.setType===ee);if(!ne||!ne.colorItems||!ne.colorItems.length)return;const _e=ne.colorItems[ie];if(!_e||!_e.length)return;const de=_e.find(me=>me.id===Z);de&&(ti()<de.clubLevel||b(ee,ie,Z))},[v,b]),W=h.useCallback((ee,ie,Z)=>{y(ee,ie,Z)},[y]),V=h.useCallback(ee=>{const ie=qt().structureData.getSetType(ee);if(!ee)return-1;const Z=qt().structureData.getPalette(ie.paletteID);if(!Z)return-1;for(const ne of Z.colors.getValues())if(!(!ne.isSelectable||ti()<ne.clubLevel))return ne.id;return-1},[]),se=h.useCallback((ee=[])=>{const ie=qt().structure,Z=new Ed(""),_e=((fe,ae)=>(ae=ae.filter(Te=>fe.indexOf(Te)===-1),[...fe,...mc.getRandomElements(ae,mc.getRandomNumber(ae.length)+1)]))(ie.getMandatorySetTypeIds(R,ti()),Ee.FIGURE_SETS),de=(fe,ae,Te,Se)=>{const Le=fe.partSets.getValues().filter(Et=>!Et.isSelectable||Et.gender!=="U"&&Et.gender!==ae||Et.clubLevel>Te||Et.isSellable&&Se.indexOf(Et.id)===-1?null:Et);return!Le||!Le.length?null:mc.getRandomElement(Le)},me=(fe,ae,Te)=>{const Se=fe.colors.getValues().filter(Et=>!Et.isSelectable||Et.clubLevel>Te?null:Et);if(!Se||!Se.length)return null;const Le=Et=>{const ri=Et.parts;let ni=0;for(const gt of ri)ni=Math.max(ni,gt.colorLayerIndex);return ni};return mc.getRandomElements(Se,Le(ae))};for(const fe of ee){const ae=F[fe],Te=S[fe];Z.updatePart(fe,ae,Te)}for(const fe of _e){if(Z.hasPartType(fe))continue;const ae=ie.figureData.getSetType(fe),Te=de(ae,R,ti(),c);if(!Te)continue;let Se=[];Te.isColorable&&(Se=me(ie.figureData.getPalette(ae.paletteID),Te,ti()).map(Le=>Le.id)),Z.updatePart(ae.type,Te.id,Se)}C(Z.getFigureString(),R)},[c,R,C,S,F]);return J(qM,ee=>{const ie=ee.getParser();u(ie.figureSetIds),_(ie.boundsFurnitureNames)}),J(KL,ee=>{const ie=ee.getParser(),Z=[];let ne=0;for(;ne<xe("avatar.wardrobe.max.slots",10);)Z.push([null,null]),ne++;for(let[_e,[de,me]]of ie.looks.entries()){const fe=qt().createFigureContainer(de);Z[_e-1]=[fe,me]}f(Z)}),J(qL,ee=>{const ie=ee.getParser(),Z=[];let ne=0;for(;ne<p;)Z.push([null,null]),ne++;for(let[_e,[de,me]]of ie.looks.entries()){const fe=qt().createFigureContainer(de);Z[_e-1]=[fe,me]}f(Z)}),h.useEffect(()=>{Dc.clearCache()},[B]),h.useEffect(()=>{if(!a)return;const ee={},ie=Z=>{const ne=[],_e=[];for(let Le=0;Le<ZT;Le++)_e.push([]);const de=qt().structureData.getSetType(Z),me=qt().structureData.getPalette(de.paletteID);if(!de||!me)return null;for(const Le of me.colors.getValues())if(!(!Le||!Le.isSelectable))for(let Et=0;Et<ZT;Et++)_e[Et].push(Le);qt().getMandatoryAvatarPartSetIds(R,ti()).indexOf(Z)===-1&&ne.push({id:-1,isClear:!0});const Te=Z!==Ee.HEAD,Se=de.partSets;for(let Le=Se.length;Le>=0;Le--){const Et=Se.getWithIndex(Le);if(!Et||!Et.isSelectable||Et.gender!==R&&Et.gender!==Ee.UNISEX||Et.isSellable&&c.indexOf(Et.id)===-1)continue;let ri=0;for(const ni of Et.parts)ri=Math.max(ri,ni.colorLayerIndex);ne.push({id:Et.id,partSet:Et,usesColor:Te,maxPaletteCount:ri})}ne.sort(JG());for(let Le=0;Le<ZT;Le++)_e[Le].sort(ZG);return{setType:Z,partItems:ne,colorItems:_e}};ee[ji.GENERIC]=[Ee.HEAD].map(Z=>ie(Z)),ee[ji.HEAD]=[Ee.HAIR,Ee.HEAD_ACCESSORY,Ee.HEAD_ACCESSORY_EXTRA,Ee.EYE_ACCESSORY,Ee.FACE_ACCESSORY].map(Z=>ie(Z)),ee[ji.TORSO]=[Ee.CHEST,Ee.CHEST_PRINT,Ee.COAT_CHEST,Ee.CHEST_ACCESSORY].map(Z=>ie(Z)),ee[ji.LEGS]=[Ee.LEGS,Ee.SHOES,Ee.WAIST_ACCESSORY].map(Z=>ie(Z)),ee[ji.WARDROBE]=[],i(ee),n(ji.GENERIC)},[a,R,c]),h.useEffect(()=>{a&&C(te().figure,te().gender)},[a,C]),h.useEffect(()=>{a&&(f(new Array(p)),K(new oP))},[a]),{isVisible:a,setIsVisible:e,avatarModels:t,activeModelKey:r,setActiveModelKey:n,maxPaletteCount:o,selectedColorParts:B,selectEditorColor:$,selectEditorPart:z,loadAvatarData:C,getFigureString:U,getFigureStringWithFace:G,selectedParts:F,gender:R,setGender:O,figureSetIds:c,randomizeCurrentFigure:se,savedFigures:m,setSavedFigures:f,getFirstSelectableColor:V,selectEditorCustomColor:W,customColorsEnabled:E,setCustomColorsEnabled:I,customColors:H}},lh=()=>Ht(ore),eS=2,lre=()=>{const[a,e]=h.useState(!1),[t,i]=h.useState({}),[r,n]=h.useState(""),[o,l]=h.useState(1),[c,u]=h.useState([]),[d,_]=h.useState(null),[m,f]=h.useState(1),{selectedColors:E,gender:I,setGender:p,loadAvatarData:S,selectPart:R,selectColor:O,getFigureString:C,getFigureStringWithFace:A,selectedParts:b}=MT(),y=h.useMemo(()=>t[r]??null,[r,t]),M=h.useMemo(()=>{var B,z;const v={};for(const $ of Object.keys(E)){if(!E[$])continue;const W=[];for(const V of Object.keys(E[$])){const se=(z=(B=y.find(ee=>ee.setType===$))==null?void 0:B.colorItems[V])==null?void 0:z.find(ee=>ee.id===E[$][V]);se&&W.push(se)}v[$]=W}return v},[y,E]),U=h.useCallback((v,B)=>{if(!v||!v.length)return;const z=y.find(W=>W.setType===v);if(!z||!z.partItems||!z.partItems.length)return;const $=z.partItems.find(W=>W.id===B);if($){if($.isClear){R(v,-1);return}ti()<$.partSet.clubLevel||(l($.maxPaletteCount||1),R(v,B))}},[y,R]),G=h.useCallback((v,B,z)=>{if(!v||!v.length)return;const $=y.find(se=>se.setType===v);if(!$||!$.colorItems||!$.colorItems.length)return;const W=$.colorItems[B];if(!W||!W.length)return;const V=W.find(se=>se.id===z);V&&(ti()<V.clubLevel||O(v,B,z))},[y,O]),F=h.useCallback(v=>{const B=qt().structureData.getSetType(v);if(!v)return-1;const z=qt().structureData.getPalette(B.paletteID);if(!z)return-1;for(const $ of z.colors.getValues())if(!(!$.isSelectable||ti()<$.clubLevel))return $.id;return-1},[]),H=h.useCallback((v=[])=>{const B=qt().structure,z=new Ed(""),W=((ee,ie)=>(ie=ie.filter(Z=>ee.indexOf(Z)===-1),[...ee,...mc.getRandomElements(ie,mc.getRandomNumber(ie.length)+1)]))(B.getMandatorySetTypeIds(I,ti()),Ee.FIGURE_SETS),V=(ee,ie,Z,ne)=>{const _e=ee.partSets.getValues().filter(de=>!de.isSelectable||de.gender!=="U"&&de.gender!==ie||de.clubLevel>Z||de.isSellable&&ne.indexOf(de.id)===-1?null:de);return!_e||!_e.length?null:mc.getRandomElement(_e)},se=(ee,ie,Z)=>{const ne=ee.colors.getValues().filter(de=>!de.isSelectable||de.clubLevel>Z?null:de);if(!ne||!ne.length)return null;const _e=de=>{const me=de.parts;let fe=0;for(const ae of me)fe=Math.max(fe,ae.colorLayerIndex);return fe};return mc.getRandomElements(ne,_e(ie))};for(const ee of v){const ie=b[ee],Z=E[ee];z.updatePart(ee,ie,Z)}for(const ee of W){if(z.hasPartType(ee))continue;const ie=B.figureData.getSetType(ee),Z=V(ie,I,ti(),c);if(!Z)continue;let ne=[];Z.isColorable&&(ne=se(B.figureData.getPalette(ie.paletteID),Z,ti()).map(_e=>_e.id)),z.updatePart(ie.type,Z.id,ne)}S(z.getFigureString(),I)},[c,I,S,E,b]);return h.useEffect(()=>{Dc.clearCache()},[M]),h.useEffect(()=>{if(!a)return;const v={},B=z=>{const $=[],W=[];for(let _e=0;_e<eS;_e++)W.push([]);const V=qt().structureData.getSetType(z),se=qt().structureData.getPalette(V.paletteID);if(!V||!se)return null;for(const _e of se.colors.getValues())if(!(!_e||!_e.isSelectable))for(let de=0;de<eS;de++)W[de].push(_e);qt().getMandatoryAvatarPartSetIds(I,ti()).indexOf(z)===-1&&$.push({id:-1,isClear:!0});const Z=z!==Ee.HEAD,ne=V.partSets;for(let _e=ne.length;_e>=0;_e--){const de=ne.getWithIndex(_e);if(!de||!de.isSelectable||de.gender!==I&&de.gender!==Ee.UNISEX||de.isSellable&&c.indexOf(de.id)===-1)continue;let me=0;for(const fe of de.parts)me=Math.max(me,fe.colorLayerIndex);$.push({id:de.id,partSet:de,usesColor:Z,maxPaletteCount:me})}$.sort(JG());for(let _e=0;_e<eS;_e++)W[_e].sort(ZG);return{setType:z,partItems:$,colorItems:W}};v[ji.GENERIC]=[Ee.HEAD].map(z=>B(z)),v[ji.HEAD]=[Ee.HAIR,Ee.HEAD_ACCESSORY,Ee.HEAD_ACCESSORY_EXTRA,Ee.EYE_ACCESSORY,Ee.FACE_ACCESSORY].map(z=>B(z)),v[ji.TORSO]=[Ee.CHEST,Ee.CHEST_PRINT,Ee.COAT_CHEST,Ee.CHEST_ACCESSORY].map(z=>B(z)),v[ji.LEGS]=[Ee.LEGS,Ee.SHOES,Ee.WAIST_ACCESSORY].map(z=>B(z)),v[ji.WARDROBE]=[],i(v),n(ji.HEAD)},[a,I,c]),h.useEffect(()=>{a&&C&&S(C,I)},[C,I,a,S]),{isVisible:a,setIsVisible:e,avatarModels:t,activeModelKey:r,setActiveModelKey:n,maxPaletteCount:o,selectedColorParts:M,selectEditorColor:G,selectEditorPart:U,loadAvatarData:S,getFigureString:C,getFigureStringWithFace:A,selectedParts:b,gender:I,setGender:p,figureSetIds:c,randomizeCurrentFigure:H,savedFigures:d,setSavedFigures:_,getFirstSelectableColor:F,page:m,setPage:f}},Rm=()=>Ht(lre),cre=()=>{const[a,e]=h.useState([]);h.useState(1);const[t,i]=h.useState(!1),[r,n]=h.useState(!1),[o,l]=h.useState(!1),c=()=>{l(!1)};return h.useEffect(()=>{const u={linkReceived:d=>{const _=d.split("/");if(!(_.length<2))switch(_[1]){case"show":l(!0);break;case"hide":l(!1);break;case"toggle":l(!o);break}},eventUrlPrefix:"user-transactions/"};return fs(u),()=>ps(u)},[]),h.useEffect(()=>{!o||r||(n(!0),K(new FF(1)))},[o,r]),J($L,u=>{const d=u.getParser().userTransactionsData;d&&(e(_=>{const m=d.filter(f=>!_.some(E=>E.created_at===f.created_at));return[..._,...m].sort((f,E)=>E.created_at-f.created_at)}),i(d.length===5))}),{showMore:t,transactions:a,visible:o,setVisible:l,close:c}},ure=()=>Ht(cre),T=a=>{const{variant:e="black",disabled:t=!1,fontWeight:i=null,fontSize:r=0,align:n=null,bold:o=!1,underline:l=!1,italics:c=!1,truncate:u=!1,center:d=!1,textEnd:_=!1,small:m=!1,wrap:f=!1,noWrap:E=!1,textBreak:I=!1,...p}=a,{settingFontSize:S}=Ea(),R=h.useMemo(()=>{const O=["d-inline","nitro-text"];return e&&O.push("text-"+e),o&&O.push("fw-bold"),i&&O.push("fw-"+i),r&&O.push("fs-"+r),n&&O.push("text-"+n),l&&O.push("text-decoration-underline"),c&&O.push("fst-italic"),u&&O.push("text-truncate"),d&&O.push("text-center"),_&&O.push("text-end"),m&&O.push("small"),f&&O.push("text-wrap"),E&&O.push("text-nowrap"),I&&O.push("text-break"),t&&O.push("text-muted"),O},[e,o,i,r,n,l,c,u,d,_,m,f,E,I,t]);return s.jsx(q,{classNames:R,...p,style:{...p.style,fontSize:r==0?`${S}em`:"inherit"}})},hre=a=>{const{isError:e=!1,message:t="",percent:i=0}=a;return s.jsx(N,{fullHeight:!0,position:"relative",className:"nitro-loading",children:s.jsx(q,{fullHeight:!0,className:"container h-100",children:s.jsxs(N,{fullHeight:!0,alignItems:"center",justifyContent:"end",children:[s.jsx(q,{className:"connecting-duck"}),s.jsx("div",{className:"fundoGradient"}),s.jsx("div",{className:"loading-box",children:e&&t&&t.length?s.jsx(q,{className:"fs-4 text-shadow",children:t}):s.jsxs(s.Fragment,{children:[s.jsxs(T,{fontSize:4,variant:"white",className:"text-shadow",children:[i.toFixed(),"%"]}),s.jsx(OT,{progress:i,className:"mt-2 large"})]})})]})})})},eB=a=>{const{achievement:e=null,scale:t=1,...i}=a;return e?s.jsx(as,{badgeCode:pn.getAchievementBadgeCode(e),isGrayscale:!pn.getAchievementHasStarted(e),scale:t,...i}):null},dre=a=>{const{achievement:e=null}=a,{selectedAchievement:t=null,setSelectedAchievementId:i=null}=AT();return e?s.jsx(ct,{itemActive:t===e,itemUnseen:e.unseen>0,onClick:r=>i(e.achievementId),children:s.jsx(eB,{achievement:e})}):null},_re=a=>{const{achievements:e=null}=a;return s.jsx(Os,{columnCount:6,columnMinWidth:50,columnMinHeight:50,children:e&&e.length>0&&e.map((t,i)=>s.jsx(dre,{achievement:t},i))})},gre=a=>{const{achievement:e=null}=a;return e?s.jsxs(x,{shrink:!0,className:"bg-muted rounded p-2 text-black",gap:2,overflow:"hidden",children:[s.jsxs(N,{center:!0,gap:1,children:[s.jsx(eB,{className:"nitro-achievements-badge-image",achievement:e,scale:2}),s.jsx(T,{fontWeight:"bold",children:g("achievements.details.level",["level","limit"],[pn.getAchievementLevel(e).toString(),e.levelCount.toString()])})]}),s.jsxs(N,{fullWidth:!0,justifyContent:"center",overflow:"hidden",children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{fontWeight:"bold",truncate:!0,children:$d(pn.getAchievementBadgeCode(e))}),s.jsx(T,{textBreak:!0,children:Em(pn.getAchievementBadgeCode(e))})]}),(e.levelRewardPoints>0||e.scoreLimit>0)&&s.jsxs(N,{gap:1,children:[e.levelRewardPoints>0&&s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{truncate:!0,className:"small",children:g("achievements.details.reward")}),s.jsxs(x,{center:!0,className:"fw-bold small",gap:1,children:[e.levelRewardPoints>0&&s.jsxs(s.Fragment,{children:[e.levelRewardPoints,s.jsx(gs,{type:0})]}),e.rewardVipPoints>0&&s.jsxs(s.Fragment,{children:[e.rewardVipPoints,s.jsx(gs,{type:5})]}),e.rewardAchievement>0&&s.jsxs(s.Fragment,{children:[e.rewardAchievement,s.jsx(gs,{type:6})]})]})]}),e.scoreLimit>0&&s.jsx(OT,{text:g("achievements.details.progress",["progress","limit"],[(e.currentPoints+e.scoreAtStartOfLevel).toString(),(e.scoreLimit+e.scoreAtStartOfLevel).toString()]),progress:e.currentPoints+e.scoreAtStartOfLevel,maxProgress:e.scoreLimit+e.scoreAtStartOfLevel})]})]})]}):null},mre=a=>{const{category:e=null}=a,{selectedAchievement:t=null,setSelectedAchievementId:i=null}=AT();return h.useEffect(()=>{var r,n;e&&(t||i((n=(r=e==null?void 0:e.achievements)==null?void 0:r[0])==null?void 0:n.achievementId))},[e,t,i]),e?s.jsxs(N,{fullHeight:!0,justifyContent:"between",children:[s.jsx(_re,{achievements:e.achievements}),!!t&&s.jsx(gre,{achievement:t})]}):null},fre=a=>{const{category:e=null,selectedCategoryCode:t=null,setSelectedCategoryCode:i=null}=a;if(!e)return null;const r=pn.getAchievementCategoryProgress(e),n=pn.getAchievementCategoryMaxProgress(e),o=pn.getAchievementCategoryImageUrl(e,r),l=pn.getAchievementCategoryTotalUnseen(e);return s.jsxs(ct,{itemActive:t===e.code,itemCount:l,itemCountMinimum:0,gap:1,onClick:c=>i(e.code),children:[s.jsx(T,{fullWidth:!0,center:!0,small:!0,className:"pt-1",children:g(`quests.${e.code}.name`)}),s.jsx(MG,{position:"relative",imageUrl:o,children:s.jsxs(T,{fullWidth:!0,center:!0,position:"absolute",variant:"white",style:{fontSize:12,bottom:9},children:[r," / ",n]})})]})},pre=a=>{const{categories:e=null,selectedCategoryCode:t=null,setSelectedCategoryCode:i=null}=a;return s.jsx(Os,{columnCount:3,columnMinWidth:90,columnMinHeight:100,children:e&&e.length>0&&e.map((r,n)=>s.jsx(fre,{category:r,selectedCategoryCode:t,setSelectedCategoryCode:i},n))})},Ere=a=>{const[e,t]=h.useState(!1),{achievementCategories:i=[],selectedCategoryCode:r=null,setSelectedCategoryCode:n=null,achievementScore:o=0,getProgress:l=0,getMaxProgress:c=0,selectedCategory:u=null}=AT();return h.useEffect(()=>{const d={linkReceived:_=>{const m=_.split("/");if(!(m.length<2))switch(m[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(f=>!f);return}},eventUrlPrefix:"achievements/"};return fs(d),()=>ps(d)},[]),e?s.jsxs(ve,{uniqueKey:"achievements",className:"nitro-achievements",theme:"primary-slim",children:[s.jsx(je,{headerText:g("inventory.achievements"),onCloseClick:d=>t(!1)}),u&&s.jsxs(DG,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",gap:3,children:[s.jsx(q,{onClick:d=>n(null),className:"nitro-achievements-back-arrow"}),s.jsxs(N,{grow:!0,gap:0,children:[s.jsx(T,{fontSize:4,fontWeight:"bold",className:"text-small",children:g(`quests.${u.code}.name`)}),s.jsx(T,{children:g("achievements.details.categoryprogress",["progress","limit"],[u.getProgress().toString(),u.getMaxProgress().toString()])})]}),s.jsx(Lc,{imageUrl:pn.getAchievementCategoryImageUrl(u,null,!0)})]}),s.jsxs(be,{gap:1,children:[!u&&s.jsxs(s.Fragment,{children:[s.jsx(pre,{categories:i,selectedCategoryCode:r,setSelectedCategoryCode:n}),s.jsxs(N,{grow:!0,justifyContent:"end",gap:1,children:[s.jsx(T,{small:!0,center:!0,children:g("achievements.categories.score",["score"],[o.toString()])}),s.jsx(OT,{text:g("achievements.categories.totalprogress",["progress","limit"],[l.toString(),c.toString()]),progress:l,maxProgress:c})]})]}),u&&s.jsx(mre,{category:u})]})]}):null},jr=a=>{const{icon:e=null,selected:t=!1,classNames:i=[],children:r=null,...n}=a,o=h.useMemo(()=>{const l=["nitro-avatar-editor-spritesheet"];return e&&e.length&&l.push(e+"-icon"),t&&l.push("selected"),i.length&&l.push(...i),l},[e,t,i]);return s.jsx(q,{classNames:o,...n})},Ire=a=>{var d;const{setType:e=null,partItem:t=null,isSelected:i=!1,...r}=a,[n,o]=h.useState(""),{selectedColorParts:l=null,getFigureStringWithFace:c=null}=lh(),u=!xe("hc.disabled",!1)&&(((d=t.partSet)==null?void 0:d.clubLevel)??0)>0;return h.useEffect(()=>{if(!e||!e.length||!t)return;(async()=>{var E;const m=!xe("hc.disabled",!1)&&(((E=t.partSet)==null?void 0:E.clubLevel)??0)>0;let f=null;e===Ee.HEAD?f=await Dc.buildForFace(c(t.id),m):f=await Dc.build(e,t,t.usesColor,l[e]??null,m),f&&f.length&&o(f)})()},[e,t,l,c]),t?s.jsxs(ct,{itemImage:t.isClear?void 0:n,itemActive:i,style:{backgroundPosition:e===Ee.HEAD?"center -35px":"center"},...r,children:[!t.isClear&&u&&s.jsx(gs,{className:"position-absolute end-1 bottom-1",type:"hc"}),t.isClear&&s.jsx(jr,{icon:"clear"}),!t.isClear&&t.partSet.isSellable&&s.jsx(jr,{icon:"sellable",position:"absolute",className:"end-1 bottom-1"})]}):null},ch=a=>{var d;const{rows:e=[],columnCount:t=4,overscan:i=5,estimateSize:r=45,itemRender:n=null,preserveScroll:o=!1}=a,l=h.useRef(null),c=Gy({count:Math.ceil(e.length/t),overscan:i,getScrollElement:()=>l.current,estimateSize:()=>r});h.useEffect(()=>{!e||!e.length||o||c.scrollToIndex(0)},[e,c,o]);const u=c.getVirtualItems();return s.jsx(q,{innerRef:l,fit:!0,position:"relative",style:{overflowY:"auto"},children:s.jsx("div",{style:{height:c.getTotalSize(),width:"100%",position:"relative"},children:s.jsx(x,{column:!0,gap:1,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${((d=u[0])==null?void 0:d.start)??0}px)`},children:u.map(_=>s.jsx("div",{"data-index":_.index,ref:c.measureElement,style:{display:"grid",gap:"0.25rem",minHeight:_.index===0?r:_.size,gridTemplateColumns:`repeat(${t}, 1fr)`},children:Array.from(Array(t)).map((m,f)=>{const E=e[f+_.index*t];return E?s.jsx(h.Fragment,{children:n(E,_.index*t+f)},f):s.jsx(h.Fragment,{},_.index+f+"b")})},_.key+"a"))})})})},Tre=a=>{const{category:e=null}=a,{selectedParts:t=null,selectEditorPart:i}=lh(),r=o=>!e||!e.setType||!t?!1:t[e.setType]?t[e.setType]===o.id:!!o.isClear,n=h.useMemo(()=>{const o=[],l=new Set;for(const c of e.partItems){if(!c||l.has(c.id))continue;if(!c.partSet){o.push(c);continue}const u=e.partItems.filter(d=>d.id!==c.id&&!l.has(d.id)&&d.partSet&&d.partSet.parts.length===c.partSet.parts.length&&d.partSet.parts.every((_,m)=>{var f;return((f=c.partSet.parts[m])==null?void 0:f.id)===_.id})&&d.usesColor===c.usesColor&&d.isClear===c.isClear&&d.partSet.clubLevel===c.partSet.clubLevel&&d.partSet.isSellable===c.partSet.isSellable&&d.partSet.isSelectable===c.partSet.isSelectable&&d.partSet.gender===c.partSet.gender);u.length&&u.forEach(d=>l.add(d.id)),o.push(c)}return o},[e]);return s.jsx(ch,{rows:n,columnCount:6,overscan:5,itemRender:o=>o?s.jsx(Ire,{setType:e.setType,partItem:o,isSelected:r(o),onClick:l=>{var c;i(e.setType,((c=o.partSet)==null?void 0:c.id)??-1)}},o.id+""):null})},Sre=a=>{const{setType:e=null,partColor:t=null,isSelected:i=!1,...r}=a;if(!t)return null;const n=!xe("hc.disabled",!1)&&t.clubLevel>0;return s.jsx(ct,{itemHighlight:!0,itemColor:Ri.int2rgb(t.rgb),itemActive:i,className:"clear-bg item-flex-grid-color-gen",...r,children:n&&s.jsx(gs,{className:"position-absolute end-1 bottom-1",type:"hc"})})},dv=a=>{const{category:e=null,paletteIndex:t=-1,columnCount:i=17}=a,{selectedColorParts:r=null,selectEditorColor:n=null,selectEditorCustomColor:o=null,customColorsEnabled:l=null,customColors:c=null}=lh(),[u,d]=h.useState(100),[_,m]=h.useState(0),[f,E]=h.useState(0),[I,p]=h.useState("none"),S=h.useCallback((b,y,M)=>{y/=100,M/=100;const U=H=>(H+b/30)%12,G=y*Math.min(M,1-M),F=H=>Math.round(255*(M-G*Math.max(-1,Math.min(U(H)-3,Math.min(9-U(H),1)))));return`#${F(0).toString(16).padStart(2,"0")}${F(8).toString(16).padStart(2,"0")}${F(4).toString(16).padStart(2,"0")}`},[]),R=b=>!e||!e.setType||!r||!r[e.setType]||!r[e.setType][t]?!1:r[e.setType][t].id===b.id,O=h.useMemo(()=>S(_,u,f),[S,_,u,f]),C=h.useRef(null),A=h.useRef(null);if(l){const b=(v,B)=>{var ie;const z=(ie=B.current)==null?void 0:ie.getBoundingClientRect();if(!z)return{x:0,y:0,width:0,height:0};const $=v.touches?v.touches[0]:null,W=$?$.clientX:v.clientX,V=$?$.clientY:v.clientY,se=Math.max(0,Math.min(z.width,W-z.left)),ee=Math.max(0,Math.min(z.height,V-z.top));return{x:se,y:ee,width:z.width,height:z.height}},y=v=>{const{x:B,y:z,width:$,height:W}=b(v,C),V=Math.min(100,Math.max(0,B/Math.max($,1)*100)),se=100-Math.min(100,Math.max(0,z/Math.max(W,1)*100));d(V),E(se)},M=v=>{const{x:B,width:z}=b(v,A),$=Math.min(360,Math.max(0,B/Math.max(z,1)*360));m($)},U=v=>{p("saturation"),y(v)},G=v=>{p("hue"),M(v)},F=v=>{I==="saturation"?y(v):I==="hue"&&M(v)},H=()=>{p("none"),o(e.setType,S(_,u,f),t)};return s.jsxs(N,{fullWidth:!0,gap:0,style:{height:"300px"},children:[s.jsxs(q,{position:"relative",children:[s.jsx(q,{className:"rcp-interactive",children:s.jsx("div",{className:"rcp-saturation",ref:C,style:{height:"119px",backgroundColor:`hsl(${_}, 100%, 50%)`},onMouseDown:U,onMouseMove:F,onMouseUp:H,onMouseLeave:H,onTouchStart:U,onTouchMove:F,onTouchEnd:H,onTouchCancel:H,children:s.jsx(q,{className:"rcp-saturation-cursor",style:{left:`${u}%`,top:`${100-f}%`,width:"10px",height:"10px",borderRadius:"50%",border:"2px solid white",background:O}})})}),s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 512 512",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:"8px",right:"8px",cursor:"pointer"},children:s.jsx("path",{d:"M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"})})]}),s.jsx(q,{fullWidth:!0,children:s.jsx(q,{className:"rcp-interactive",children:s.jsx("div",{className:"rcp-hue",ref:A,onMouseDown:G,onMouseMove:F,onMouseUp:H,onMouseLeave:H,onTouchStart:G,onTouchMove:F,onTouchEnd:H,onTouchCancel:H,children:s.jsx(q,{className:"rcp-hue-cursor",style:{left:`${_/360*100}%`,background:`hsl(${_}, 100%, 50%)`}})})})})]})}return s.jsx(ch,{rows:e.colorItems[t],columnCount:i,overscan:5,estimateSize:30,itemRender:b=>b?s.jsx(Sre,{setType:e.setType,partColor:b,isSelected:R(b),onClick:y=>n(e.setType,t,b.id)},b.id+""):null})};function Ia(){const[a,e]=h.useState(!1),[t,i]=h.useState(!1);return h.useEffect(()=>{function r(){const n=window.innerWidth;e(n<=768),i(n>768&&n<=1024)}return r(),window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}},[]),{isMobile:a,isTablet:t}}const Rre=a=>{const{categories:e=[],name:t=""}=a,[i,r]=h.useState(!1),[n,o]=h.useState(""),{maxPaletteCount:l=1,gender:c=null,setGender:u=null,selectedColorParts:d=null,getFirstSelectableColor:_=null,selectEditorColor:m=null,setCustomColorsEnabled:f,customColorsEnabled:E}=lh(),{isMobile:I}=Ia(),p=h.useMemo(()=>e.find(R=>R.setType===n)??null,[e,n]),S=h.useCallback(R=>{const O=d[R];(!O||!O.length)&&m(R,0,_(R)),o(R)},[_,m,d]);return h.useEffect(()=>{var R;!e||!e.length||!i||(S((R=e[0])==null?void 0:R.setType),r(!1))},[e,i,S]),h.useEffect(()=>{r(!0)},[e]),p?s.jsxs(N,{fullHeight:!0,gap:2,children:[s.jsxs(N,{gap:2,justifyContent:"center",style:{flex:"1 1 0%"},children:[t===ji.GENERIC&&s.jsxs(x,{fullHeight:!0,alignItems:"center",justifyContent:"center",gap:2,children:[s.jsx(x,{center:!0,pointer:!0,className:`category-item header-item-look-gen ${c===Sl.MALE?"active":""}`,onClick:R=>u(Ee.MALE),children:s.jsx(jr,{icon:"male",selected:c===Sl.MALE})}),s.jsx(x,{center:!0,pointer:!0,className:`category-item header-item-look-gen ${c===Sl.FEMALE?"active":""}`,onClick:R=>u(Ee.FEMALE),children:s.jsx(jr,{icon:"female",selected:c===Sl.FEMALE})})]}),t!==ji.GENERIC&&e.length>0&&s.jsx(x,{fullHeight:!0,alignItems:"center",justifyContent:"center",gap:2,children:e.map(R=>s.jsx(x,{center:!0,pointer:!0,className:`category-item header-item-look-gen ${n===R.setType?"active":""}`,onClick:O=>S(R.setType),children:s.jsx(jr,{icon:R.setType,selected:n===R.setType})},R.setType))})]}),s.jsx(N,{gap:2,size:5,overflow:"hidden",className:"clothes-gen-items",fullHeight:!0,children:s.jsx(Tre,{category:p})}),s.jsx(N,{size:6,overflow:"hidden",className:"clothes-gen",children:s.jsxs(x,{fullHeight:!0,gap:2,children:[l>=1&&s.jsx(dv,{category:p,paletteIndex:0,columnCount:l===2?I?4:8:I?8:17}),l===2&&s.jsx(dv,{category:p,paletteIndex:1,columnCount:I?4:8})]})})]}):null},xre=a=>{const{purse:e=null}=Qa(),t=10,i=6,r=te().clubLevel>=rr.VIP,{showConfirm:n}=kt(),{savedFigures:o=[],setSavedFigures:l=null,loadAvatarData:c=null,getFigureString:u=null,gender:d=null}=lh(),_=xe("hc.disabled",!1),{isMobile:m}=Ia(),f=h.useCallback(R=>!r&&Math.floor(R/t)+1>i,[r,t,i]),E=h.useCallback(R=>{if(R>=o.length||R<0||f(R))return;const[O,C]=o[R];c(O.getFigureString(),C)},[o,f,c]),I=h.useCallback(R=>{n(g("avatar.editor.wardrobe.delete.confirmation"),()=>{if(R>=o.length||R<0||f(R))return;const O=Math.floor(R/t)+1,C=R%t;l(A=>{const b=[...A];return b[R]=[null,null],b}),K(new cx(O,C+1,"",""))},null)},[f,o.length,l,n]),p=h.useCallback(R=>{const O=()=>{if(R>=o.length||R<0||f(R))return;const C=Math.floor(R/t)+1,A=R%t,b=u;l(y=>{const M=[...y];return M[R]=[qt().createFigureContainer(b),d],M}),K(new cx(C,A+1,b,d))};if(o[R]&&o[R][0]){if(o[R][0].getFigureString()===u)return;n(g("avatar.editor.wardrobe.save.confirmation"),O,null);return}O()},[o,f,u,l,d,n]),S=(R,O,C)=>!r&&f(C)?s.jsx(X,{variant:"link",fullWidth:!0,onClick:()=>Me.call("openLoja",{moedaEscolhida:wx(),diamantes:dr(e.activityPoints.get(105)),hubbeCoins:dr(e.activityPoints.get(107)),vipEndDate:Fx(),playerId:te().userId,promoCoins:dr(e.activityPoints.get(108))}),children:"Exclusivo HC"}):s.jsxs(s.Fragment,{children:[s.jsx(X,{variant:"primary",fullWidth:!0,onClick:A=>p(C),children:s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 448 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"})})}),R&&s.jsx(X,{variant:"success",fullWidth:!0,onClick:A=>E(C),disabled:O>ti(),children:s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 640 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M631.2 96.5L436.5 0C416.4 27.8 371.9 47.2 320 47.2S223.6 27.8 203.5 0L8.8 96.5c-7.9 4-11.1 13.6-7.2 21.5l57.2 114.5c4 7.9 13.6 11.1 21.5 7.2l56.6-27.7c10.6-5.2 23 2.5 23 14.4V480c0 17.7 14.3 32 32 32h256c17.7 0 32-14.3 32-32V226.3c0-11.8 12.4-19.6 23-14.4l56.6 27.7c7.9 4 17.5.8 21.5-7.2L638.3 118c4-7.9.8-17.6-7.1-21.5z"})})}),R&&s.jsx(X,{variant:"danger",fullWidth:!0,onClick:A=>I(C),disabled:O>ti(),children:s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 448 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"})})})]});return s.jsx(s.Fragment,{children:s.jsx(ch,{rows:o,columnCount:m?2:4,overscan:m?2:4,estimateSize:160,preserveScroll:!0,itemRender:(R,O)=>{const[C,A]=R;let b=0;return C&&(b=qt().getFigureClubLevel(C,A)),s.jsxs(ct,{position:"relative",overflow:"hidden",className:"nitro-avatar-editor-wardrobe-figure-preview",children:[C&&s.jsx(ls,{figure:C.getFigureString(),gender:A,direction:2,children:f(O)&&s.jsx("i",{className:"icon avatar-locked "})}),s.jsx(q,{className:"avatar-shadow"}),!_&&b>0&&s.jsx(gs,{className:"position-absolute top-1 start-1",type:"hc"}),s.jsx(x,{gap:1,className:"button-container",children:S(C,b,O)})]},O)}})})},Ore=4,Cre=a=>{const[e,t]=h.useState(Ore),{getFigureString:i=null}=lh(),r=n=>{e<yr.MIN_DIRECTION&&(n=yr.MAX_DIRECTION+(e+1)),e>yr.MAX_DIRECTION&&(n=e-(yr.MAX_DIRECTION+1)),t(n)};return s.jsxs(N,{className:"figure-preview-container",overflow:"hidden",position:"relative",children:[s.jsx(ls,{figure:i,direction:e,scale:2}),s.jsx(jr,{className:"avatar-spotlight",icon:"spotlight"}),s.jsx(q,{className:"avatar-shadow"}),s.jsxs(q,{className:"arrow-container",children:[s.jsx(jr,{pointer:!0,icon:"arrow-left",onClick:n=>r(e+1)}),s.jsx(jr,{pointer:!0,icon:"arrow-right",onClick:n=>r(e-1)})]})]})},Nre=a=>{const[e,t]=h.useState(!1),{setIsVisible:i,avatarModels:r,activeModelKey:n,setActiveModelKey:o,loadAvatarData:l,getFigureStringWithFace:c,gender:u,randomizeCurrentFigure:d=null,getFigureString:_=null}=lh(),m=f=>{switch(f){case Qi.ACTION_RESET:l(te().figure,te().gender);return;case Qi.ACTION_CLEAR:l(c(0,!1),u);return;case Qi.ACTION_RANDOMIZE:d();return;case Qi.ACTION_SAVE:K(new gN(u,_)),t(!1);return}};return h.useEffect(()=>{const f={linkReceived:E=>{const I=E.split("/");if(!(I.length<2))switch(I[1]){case"show":t(!0);break;case"hide":t(!1);break;case"toggle":t(p=>!p);break}},eventUrlPrefix:"avatar-editor/"};return fs(f),()=>ps(f)},[]),h.useEffect(()=>{i(e)},[e,o,i]),e?s.jsxs(ve,{uniqueKey:"avatar-editor",className:"nitro-avatar-editor",children:[s.jsx(je,{headerText:g("avatareditor.title"),onCloseClick:f=>t(!1)}),s.jsx($n,{children:Object.keys(r).map(f=>{const E=n===f;return s.jsx(In,{isActive:E,onClick:I=>o(f),children:g(`avatareditor.category.${f}`)},f)})}),s.jsx(be,{children:s.jsxs(Ye,{children:[s.jsxs(N,{gap:2,size:9,overflow:"hidden",children:[n.length>0&&n!==ji.WARDROBE&&s.jsx(Rre,{name:n,categories:r[n]}),n===ji.WARDROBE&&s.jsx(xre,{})]}),s.jsxs(N,{size:3,overflow:"hidden",children:[s.jsx(Cre,{}),s.jsxs(N,{grow:!0,gap:1,children:[s.jsxs(Ya,{children:[s.jsx(X,{variant:"secondary",onClick:f=>m(Qi.ACTION_RESET),children:s.jsx(By,{className:"fa-icon"})}),s.jsx(X,{variant:"secondary",onClick:f=>m(Qi.ACTION_CLEAR),children:s.jsx(eT,{className:"fa-icon"})}),s.jsx(X,{variant:"secondary",onClick:f=>m(Qi.ACTION_RANDOMIZE),children:s.jsx(Vy,{className:"fa-icon"})})]}),s.jsx(X,{className:"w-100",variant:"success",onClick:f=>m(Qi.ACTION_SAVE),children:g("avatareditor.save")})]})]})]})})]}):null},Are=5,bre=a=>{const{onClose:e=null,onEdit:t=null,onDelete:i=null}=a,{cameraRoll:r=null,setCameraRoll:n=null,selectedPictureIndex:o=-1,setSelectedPictureIndex:l=null}=UG(),{simpleAlert:c=null}=kt(),u=h.useRef(),d=o>-1?r[o]:null,_=()=>{if(!u||!u.current)return null;const f=u.current.getBoundingClientRect();return new Zy(Math.floor(f.x),Math.floor(f.y),Math.floor(f.width),Math.floor(f.height))},m=()=>{if(o>-1){l(-1);return}const f=ce().createTextureFromRoom($e().roomId,1,_()),E=[...r];E.length>=Are&&(c(g("camera.full.body")),E.pop()),yl(Bo.CAMERA_SHUTTER),E.push(new rJ(f,Vt.generateImageUrl(f))),n(E)};return s.jsx(jc,{uniqueKey:"nitro-camera-capture",children:s.jsxs(N,{center:!0,className:"nitro-camera-capture",gap:0,children:[d&&s.jsx("img",{alt:"",className:"camera-area",src:d.imageUrl}),s.jsxs("div",{className:"camera-canvas drag-handler",children:[s.jsx("div",{className:"position-absolute header-close",onClick:e,children:s.jsx(pr,{className:"fa-icon"})}),!d&&s.jsx("div",{ref:u,className:"camera-area camera-view-finder"}),d&&s.jsx("div",{className:"camera-area camera-frame",children:s.jsxs("div",{className:"camera-frame-preview-actions w-100 position-absolute bottom-0 py-2 text-center",children:[s.jsx("button",{className:"btn btn-success me-3",title:g("camera.editor.button.tooltip"),onClick:t,children:g("camera.editor.button.text")}),s.jsx("button",{className:"btn btn-danger",onClick:i,children:g("camera.delete.button.text")})]})}),s.jsx("div",{className:"d-flex justify-content-center",children:s.jsx("div",{className:"camera-button",title:g("camera.take.photo.button.tooltip"),onClick:m})})]}),r.length>0&&s.jsx(x,{gap:2,justifyContent:"center",className:"camera-roll d-flex justify-content-center py-2",children:r.map((f,E)=>s.jsx("img",{alt:"",src:f.imageUrl,onClick:I=>l(E)},E))})]})})},vre=a=>{const{base64Url:e=null,onCloseClick:t=null,onCancelClick:i=null,price:r=null}=a,[n,o]=h.useState(null),[l,c]=h.useState(null),[u,d]=h.useState(0),[_,m]=h.useState(!1),[f,E]=h.useState(!1),[I,p]=h.useState(0),[S,R]=h.useState(null),O=h.useMemo(()=>xe("camera.publish.disabled",!1),[]);J(AD,A=>{d(b=>b+1),E(!1)}),J(ND,A=>{const b=A.getParser();c(b.extraDataId),p(b.secondsToWait),m(b.ok),E(!1)}),J(bD,A=>{const b=A.getParser();o(xe("camera.url")+"/"+b.url)});const C=(A,b=null)=>{switch(A){case"close":t();return;case"buy":if(f)return;E(!0),K(new tP("",S));return;case"publish":if(f)return;E(!0),K(new eP(S));return;case"cancel":i();return}};return h.useEffect(()=>{e&&ce().saveBase64AsScreenshot(e)},[e]),r?s.jsxs(ve,{className:"nitro-camera-checkout",theme:"primary-slim",children:[s.jsx(je,{headerText:g("camera.confirm_phase.title"),onCloseClick:A=>C("close")}),s.jsxs(be,{children:[s.jsxs(x,{center:!0,children:[n&&n.length&&s.jsx(Lc,{className:"picture-preview border",imageUrl:n}),(!n||!n.length)&&s.jsx(x,{center:!0,className:"picture-preview border",children:s.jsx(T,{bold:!0,children:g("camera.loading")})})]}),s.jsx(x,{fullWidth:!0,children:s.jsxs(N,{fullWidth:!0,size:6,gap:1,className:"bg-muted rounded p-2",children:[s.jsx(T,{bold:!0,children:Oe().getLocalizationOrDefault("camera.caption.header","Legenda")}),s.jsx("input",{value:S,type:"text",className:"form-control form-control-sm",placeholder:Oe().getLocalizationOrDefault("camera.caption_placeholder","O dia está lindo!"),maxLength:64,onChange:A=>R(A.target.value)})]})}),s.jsxs(x,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[s.jsxs(N,{size:O?10:6,gap:1,children:[s.jsx(T,{bold:!0,children:g("camera.purchase.header")}),(r.credits>0||r.duckets>0)&&s.jsxs(x,{gap:1,children:[s.jsx(T,{children:g("catalog.purchase.confirmation.dialog.cost")}),r.credits>0&&s.jsxs(x,{gap:1,children:[s.jsx(T,{bold:!0,children:r.credits}),s.jsx(gs,{type:-1})]}),r.duckets>0&&s.jsxs(x,{gap:1,children:[s.jsx(T,{bold:!0,children:r.duckets}),s.jsx(gs,{type:0})]})]}),u>0&&s.jsxs(T,{children:[s.jsx(T,{bold:!0,children:g("camera.purchase.count.info")})," ",u,s.jsx("u",{className:"ms-1 cursor-pointer",onClick:()=>Ce("inventory/toggle"),children:g("camera.open.inventory")})]})]}),s.jsx(x,{alignItems:"center",children:s.jsx(X,{variant:"success",disabled:f,onClick:A=>C("buy"),children:g(u?"camera.buy.another.button.text":"buy")})})]}),!O&&s.jsxs(x,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g(_?"camera.publish.successful":"camera.publish.explanation")}),s.jsx(T,{children:g(_?"camera.publish.success.short.info":"camera.publish.detailed.explanation")}),_&&s.jsx("a",{href:l,rel:"noreferrer",target:"_blank",children:g("camera.link.to.published")}),!_&&r.publishDucketPrice>0&&s.jsxs(x,{gap:1,children:[s.jsx(T,{children:g("catalog.purchase.confirmation.dialog.cost")}),s.jsxs(x,{gap:1,children:[s.jsx(T,{bold:!0,children:r.publishDucketPrice}),s.jsx(gs,{type:0})]})]}),I>0&&s.jsx("div",{className:"mt-1 text-center fw-bold",children:g("camera.publish.wait",["minutes"],[Math.ceil(I/60).toString()])})]}),!_&&s.jsx(x,{className:"d-flex align-items-end",children:s.jsx(X,{variant:"success",disabled:f||I>0,onClick:A=>C("publish"),children:g("camera.publish.button.text")})})]}),s.jsx(T,{center:!0,children:g("camera.warning.disclaimer")}),s.jsx(x,{justifyContent:"end",children:s.jsx(X,{onClick:A=>C("cancel"),children:g("generic.cancel")})})]})]}):null},yre=a=>{const{effect:e=null,thumbnailUrl:t=null,isActive:i=!1,isLocked:r=!1,selectEffect:n=null,removeEffect:o=null}=a;return s.jsxs(ct,{title:g(r?`camera.effect.required.level ${e.minLevel}`:`camera.effect.name.${e.name}`),itemActive:i,onClick:l=>!i&&n(),children:[i&&s.jsx(X,{variant:"danger",className:"rounded-circle remove-effect",onClick:o,children:s.jsx(pr,{className:"fa-icon"})}),!r&&t&&t.length>0&&s.jsx("div",{className:"effect-thumbnail-image border",children:s.jsx("img",{alt:"",src:t})}),r&&s.jsxs(T,{center:!0,bold:!0,children:[s.jsx("div",{children:s.jsx(Hy,{className:"fa-icon"})}),e.minLevel]})]})},Dre=a=>{const{myLevel:e=0,selectedEffects:t=[],effects:i=[],thumbnails:r=[],processAction:n=null}=a;return s.jsx(Ye,{columnCount:3,overflow:"auto",children:i&&i.length>0&&i.map((o,l)=>{const c=r.find(d=>d.effectName===o.name),u=t.findIndex(d=>d.effect.name===o.name)>-1;return s.jsx(yre,{effect:o,thumbnailUrl:c&&c.thumbnailUrl||null,isActive:u,isLocked:o.minLevel>e,selectEffect:()=>n("select_effect",o.name),removeEffect:()=>n("remove_effect",o.name)},l)})})},_v=[$g.COLORMATRIX,$g.COMPOSITE],Mre=a=>{const{picture:e=null,availableEffects:t=null,myLevel:i=1,onClose:r=null,onCancel:n=null,onCheckout:o=null}=a,[l,c]=h.useState(_v[0]),[u,d]=h.useState(null),[_,m]=h.useState([]),[f,E]=h.useState([]),[I,p]=h.useState(!1),S=h.useMemo(()=>t.filter(G=>G.colorMatrix),[t]),R=h.useMemo(()=>t.filter(G=>G.texture),[t]),O=h.useCallback(()=>l===$g.COLORMATRIX?S:R,[l,S,R]),C=h.useCallback(G=>!G||!G.length||!_||!_.length?-1:_.findIndex(F=>F.effect.name===G),[_]),A=h.useMemo(()=>C(u),[u,C]),b=h.useMemo(()=>u&&_[A]||null,[u,A,_]),y=h.useCallback(G=>{const F=A;F!==-1&&m(H=>{const v=[...H],B=v[F];return v[A]=new YT(B.effect,G),v})},[A,m]),M=h.useMemo(()=>__().applyEffects(e.texture,_,I).src,[e,_,I]),U=h.useCallback((G,F=null)=>{switch(G){case"close":r();return;case"cancel":n();return;case"checkout":o(M);return;case"change_tab":c(String(F));return;case"select_effect":{if(C(F)>=0)return;const v=t.find(B=>B.name===F);if(!v)return;m(B=>[...B,new YT(v,1)]),d(v.name);return}case"remove_effect":{let H=C(F);if(H===-1)return;m(v=>{const B=[...v];return B.splice(H,1),B}),u===F&&d(null);return}case"clear_effects":d(null),m([]);return;case"download":{const H=new Image;H.src=M,window.open("").document.write(H.outerHTML);return}case"zoom":p(!I);return}},[I,t,u,M,C,n,o,r,p,m]);return h.useEffect(()=>{const G=[];for(const F of t)G.push(new nJ(F.name,__().applyEffects(e.texture,[new YT(F,1)],!1).src));E(G)},[e,t]),s.jsxs(ve,{className:"nitro-camera-editor",children:[s.jsx(je,{headerText:g("camera.editor.button.text"),onCloseClick:G=>U("close")}),s.jsx($n,{children:_v.map(G=>s.jsx(In,{isActive:l===G,onClick:F=>U("change_tab",G),children:s.jsx("i",{className:"icon icon-camera-"+G})},G))}),s.jsx(be,{children:s.jsxs(Ye,{children:[s.jsx(N,{size:5,overflow:"hidden",children:s.jsx(Dre,{myLevel:i,selectedEffects:_,effects:O(),thumbnails:f,processAction:U})}),s.jsxs(N,{size:7,justifyContent:"between",overflow:"hidden",children:[s.jsxs(N,{center:!0,children:[s.jsx(Lc,{imageUrl:M,className:"picture-preview"}),u&&s.jsxs(N,{center:!0,fullWidth:!0,gap:1,children:[s.jsx(T,{children:g("camera.effect.name."+u)}),s.jsx(cm,{className:"nitro-slider",min:0,max:1,step:.01,value:b.alpha,onChange:G=>y(G),renderThumb:(G,F)=>s.jsx("div",{...G,children:F.valueNow})})]})]}),s.jsxs(x,{justifyContent:"between",children:[s.jsxs(Ya,{children:[s.jsx(X,{onClick:G=>U("clear_effects"),children:s.jsx(eT,{className:"fa-icon"})}),s.jsx(X,{onClick:G=>U("download"),children:s.jsx(cV,{className:"fa-icon"})}),s.jsxs(X,{onClick:G=>U("zoom"),children:[I&&s.jsx(uV,{className:"fa-icon"}),!I&&s.jsx(hV,{className:"fa-icon"})]})]}),s.jsxs(x,{gap:1,children:[s.jsx(X,{onClick:G=>U("cancel"),children:g("generic.cancel")}),s.jsx(X,{onClick:G=>U("checkout"),children:g("camera.preview.button.text")})]})]})]})]})})]})},_h=0,wm=1,gv=2,mv=3,jre=a=>{const[e,t]=h.useState(_h),[i,r]=h.useState(null),{availableEffects:n=[],selectedPictureIndex:o=-1,cameraRoll:l=[],setCameraRoll:c=null,myLevel:u=0,price:d={credits:0,duckets:0,publishDucketPrice:0}}=UG(),_=f=>{switch(f){case"close":t(_h);return;case"edit":t(gv);return;case"delete":c(E=>{const I=[...E];return I.splice(o,1),I});return;case"editor_cancel":t(wm);return}},m=f=>{r(f),t(mv)};return ms(Ve.ENDED,f=>t(_h)),h.useEffect(()=>{const f={linkReceived:E=>{const I=E.split("/");if(!(I.length<2))switch(I[1]){case"show":t(wm);return;case"hide":t(_h);return;case"toggle":t(p=>p?_h:wm);return}},eventUrlPrefix:"camera/"};return fs(f),()=>ps(f)},[]),e===_h?null:s.jsxs(s.Fragment,{children:[e===wm&&s.jsx(bre,{onClose:()=>_("close"),onEdit:()=>_("edit"),onDelete:()=>_("delete")}),e===gv&&s.jsx(Mre,{picture:l[o],myLevel:u,onClose:()=>_("close"),onCancel:()=>_("editor_cancel"),onCheckout:m,availableEffects:n}),e===mv&&s.jsx(vre,{base64Url:i,onCloseClick:()=>_("close"),onCancelClick:()=>_("editor_cancel"),price:d})]})},fv=a=>{const{itemId:e=-1,state:t=null,product:i=null,active:r=!1,onClick:n=null,isVip:o=!1}=a,l=c=>{let u=te().getFloorItemDataByName(c),d=null;return u?d=ce().getFurnitureFloorIconUrl(u.id):(u=te().getWallItemDataByName(c),u&&(d=ce().getFurnitureWallIconUrl(u.id))),d};return s.jsxs(N,{fullWidth:!0,center:!0,pointer:!0,className:`campaign-spritesheet campaign-day-generic-bg rounded calendar-item ${r?"active":""}`,onClick:()=>n(e),children:[t===Ei.STATE_UNLOCKED&&s.jsx(x,{center:!0,className:"campaign-spritesheet unlocked-bg",children:s.jsx(x,{center:!0,className:"campaign-spritesheet campaign-opened",children:i&&s.jsx(Lc,{style:{marginBottom:"60px"},imageUrl:i.customImage?xe("image.library.url")+i.customImage:l(i.productName)})})}),t!==Ei.STATE_UNLOCKED&&s.jsxs(x,{center:!0,className:"campaign-spritesheet locked-bg",children:[t===Ei.STATE_LOCKED_AVAILABLE&&s.jsx(q,{className:"campaign-spritesheet available"}),t===Ei.STATE_LOCKED_EXPIRED&&s.jsx(q,{className:"campaign-spritesheet locked"}),t===Ei.STATE_LOCKED_FUTURE&&s.jsx(q,{className:"campaign-spritesheet unavailable"})]}),o&&s.jsx("i",{className:"icon icon-vip2"})]})},gh=5,Lre=a=>{const e=h.useMemo(()=>{let B=new Date;return new Date(B.getFullYear(),B.getMonth()+1,0).getDate()},[]),{onClose:t=null,campaignName:i=null,currentDay:r=null,numDays:n=null,missedDays:o=null,openedDays:l=null,missedVipDays:c=null,openedVipDays:u=null,openPackage:d=null,openVipPackage:_=null,receivedProducts:m=null,receivedProductsVip:f=null,daysUnlocked:E=null}=a,[I,p]=h.useState(r),[S,R]=h.useState(r),[O,C]=h.useState(new Date().getDate()-1),A=B=>l.includes(B)?Ei.STATE_UNLOCKED:E.includes(B)?Ei.STATE_LOCKED_AVAILABLE:B>r?Ei.STATE_LOCKED_FUTURE:o.includes(B)&&r>=7?Ei.STATE_LOCKED_EXPIRED:Ei.STATE_LOCKED_AVAILABLE,b=B=>u.includes(B)?Ei.STATE_UNLOCKED:E.includes(B)?Ei.STATE_LOCKED_AVAILABLE:B>r?Ei.STATE_LOCKED_FUTURE:c.includes(B)&&r>=7?Ei.STATE_LOCKED_EXPIRED:Ei.STATE_LOCKED_AVAILABLE,y=B=>{switch(A(B)){case Ei.STATE_UNLOCKED:return g("campaign.calendar.info.unlocked");case Ei.STATE_LOCKED_FUTURE:return g("campaign.calendar.info.future");case Ei.STATE_LOCKED_EXPIRED:return g("campaign.calendar.info.expired");default:return g("campaign.calendar.info.available.desktop")}},M=()=>{const B=I+1;B>=e||(p(B),O+gh<B+1&&C(O+1))},U=()=>{const B=I-1;B<0||(p(B),O>B&&C(O-1))},G=B=>{if(!(B+1>n)){if(I===B){A(B)===Ei.STATE_LOCKED_AVAILABLE&&d(B,!1);return}p(B)}},F=()=>{const B=S+1;B>=e||(R(B),O+gh<B+1&&C(O+1))},H=()=>{const B=S-1;B<0||(R(B),O>B&&C(O-1))},v=B=>{if(!(te().clubLevel<rr.VIP)&&!(B+1>n)){if(S===B){b(B)===Ei.STATE_LOCKED_AVAILABLE&&_(B,!1);return}R(B)}};return s.jsxs(ve,{className:"nitro-campaign-calendar",theme:"primary-slim",children:[s.jsx(je,{headerText:g(`campaign.calendar.${i}.title`),onCloseClick:t}),s.jsxs(be,{children:[s.jsxs(Ye,{fullHeight:!1,justifyContent:"between",alignItems:"center",children:[s.jsx(N,{size:1}),s.jsx(N,{size:10,children:s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("i",{className:"icon icon-gift-calendar"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{fontSize:3,children:g("campaign.calendar.heading.day",["number"],[(I+1).toString()])}),s.jsx(T,{children:y(I)})]}),s.jsx("div",{})]})}),s.jsx(N,{size:1})]}),s.jsxs(x,{fullHeight:!0,gap:2,children:[s.jsx(x,{center:!0,children:s.jsx(q,{pointer:!0,className:"campaign-spritesheet prev",onClick:U})}),s.jsx(N,{center:!0,fullWidth:!0,children:s.jsx(Ye,{fit:!0,columnCount:gh,gap:1,children:[...Array(gh)].map((B,z)=>{const $=O+z;if(!($>=e))return s.jsx(N,{overflow:"hidden",children:s.jsx(fv,{itemId:$,state:A($),active:I===$,product:m.has($)?m.get($):null,onClick:G})},z)})})}),s.jsx(x,{center:!0,children:s.jsx(q,{pointer:!0,className:"campaign-spritesheet next",onClick:M})})]}),s.jsxs(x,{fullHeight:!0,gap:2,children:[s.jsx(x,{center:!0,children:s.jsx(q,{pointer:!0,className:"campaign-spritesheet prev",onClick:H})}),s.jsx(N,{center:!0,fullWidth:!0,children:s.jsx(Ye,{fit:!0,columnCount:gh,gap:1,children:[...Array(gh)].map((B,z)=>{const $=O+z;if(!($>=e))return s.jsx(N,{overflow:"hidden",children:s.jsx(fv,{itemId:$,state:b($),isVip:!0,active:S===$,product:f.has($)?f.get($):null,onClick:v})},z)})})}),s.jsx(x,{center:!0,children:s.jsx(q,{pointer:!0,className:"campaign-spritesheet next",onClick:F})})]})]})]})},Pre=a=>{const[e,t]=h.useState(null),[i,r]=h.useState(null),[n,o]=h.useState(-1),[l,c]=h.useState(new Map),[u,d]=h.useState(new Map),[_,m]=h.useState(!1),[f,E]=h.useState([]),I=(S,R=!1)=>{e&&(o(S),K(R?new lP(e.campaignName,S):new cP(e.campaignName,S)))},p=(S,R=!1)=>{i&&(o(S),K(R?new uP(i.campaignName,S):new hP(i.campaignName,S)))};return J(yD,S=>{const R=S.getParser();R&&(t(R.calendarData),r(R.vipCalendarData))}),J(DD,S=>{const R=S.getParser();if(!R)return;const O=R.day-1;R.doorOpened&&(R.vip?(r(C=>{const A=C.clone();return A.openedDays.push(n),A}),d(C=>{const A=new Map(C);return A.set(O,new Mb(R.productName,R.customImage,R.furnitureClassName)),A})):(t(C=>{const A=C.clone();return A.openedDays.push(n),A}),c(C=>{const A=new Map(C);return A.set(O,new Mb(R.productName,R.customImage,R.furnitureClassName)),A}))),o(-1)}),J(MD,S=>{const R=S.getParser();R&&E(O=>{const C=[...O];return C.includes(R.day-1)||C.push(R.day-1),C})}),h.useEffect(()=>{const S={linkReceived:R=>{const O=R.split("/");if(!(O.length<2))switch(O[1]){case"calendar":m(!0);break}},eventUrlPrefix:"openView/"};return fs(S),()=>ps(S)},[]),s.jsx(s.Fragment,{children:e&&i&&_&&s.jsx(Lre,{onClose:()=>m(!1),campaignName:e.campaignName,currentDay:e.currentDay-1,daysUnlocked:f,numDays:e.campaignDays,openedDays:e.openedDays,missedDays:e.missedDays,openedVipDays:i.openedDays,missedVipDays:i.missedDays,openPackage:I,openVipPackage:p,receivedProducts:l,receivedProductsVip:u})})},GN=a=>{const{icon:e=0}=a,t=h.useMemo(()=>xe("catalog.asset.icon.url").replace("%name%",e.toString()),[e]);return s.jsx(Lc,{className:"catalog-icon",imageUrl:t,style:{width:20,height:20}})},Ure=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(0),[n,o]=h.useState(0),[l,c]=h.useState(""),[u,d]=h.useState(""),[_,m]=h.useState(!0),[f,E]=h.useState(""),[I,p]=h.useState([]),[S,R]=h.useState(0),[O,C]=h.useState(0),[A,b]=h.useState(0),[y,M]=h.useState(0),[U,G]=h.useState(0),[F,H]=h.useState(!1),{catalogOptions:v=null}=es(),{friends:B}=Jr(),{giftConfiguration:z=null}=v,[$,W]=h.useState([]),[V,se]=h.useState([]),[ee,ie]=h.useState(!0),Z=h.useCallback(()=>{t(!1),r(0),o(0),c(""),d(""),m(!0),E(""),R(0),C(0),ie(!1),se([]),I.length&&b(I[0].id)},[I]),ne=h.useMemo(()=>z?z.defaultStuffTypes.findIndex(gt=>gt===$[S])>-1:!1,[$,z,S]),_e=h.useMemo(()=>z?($[S]*1e3+z.ribbonTypes[O]).toString():"",[z,S,O,$]),de=h.useMemo(()=>{if(!z||ne)return!1;const gt=$[S];return!(gt===8||gt>=3&&gt<=6)},[z,S,ne,$]),me=h.useMemo(()=>ne?$[S]:A,[ne,$,S,A]),fe=B.filter(gt=>gt.id!==-1),ae=gt=>{const yt=gt.target.value;let ws=[];yt.length>0&&(ws=fe.sort().filter(Jn=>Jn.name.includes(yt))),d(yt),ie(!0),se(ws)},Te=gt=>{d(gt),ie(!1)},Se=h.useCallback(gt=>{switch(gt){case"prev_box":R(yt=>yt===0?y:yt-1);return;case"next_box":R(yt=>yt===y?0:yt+1);return;case"prev_ribbon":C(yt=>yt===0?U:yt-1);return;case"next_ribbon":C(yt=>yt===U?0:yt+1);return;case"buy":if(!u||u.length===0){H(!0);return}K(new SP(i,n,l,u,f,me,S,O,_));return}},[me,l,y,U,f,n,i,u,S,O,_]);J(GD,gt=>H(!0)),Js([Ho.PURCHASE_SUCCESS,ih.INIT_GIFT],gt=>{switch(gt.type){case Ho.PURCHASE_SUCCESS:Z();return;case ih.INIT_GIFT:const yt=gt;Z(),r(yt.pageId),o(yt.offerId),c(yt.extraData),t(!0);return}}),h.useEffect(()=>{H(!1)},[u]);const Le=h.useCallback(()=>{z&&W(gt=>{let yt=[...z.boxTypes];return yt.push(z.defaultStuffTypes[Math.floor(Math.random()*(z.defaultStuffTypes.length-1))]),M(yt.length-1),G(yt.length-1),yt})},[z]);if(h.useEffect(()=>{if(!z)return;const gt=[];for(const yt of z.stuffTypes){const ws=te().getFloorItemData(yt);ws&&ws.colors&&ws.colors.length>0&&gt.push({id:yt,color:sr.makeColorNumberHex(ws.colors[0])})}Le(),gt.length&&(b(gt[0].id),p(gt))},[z,Le]),h.useEffect(()=>{e&&Le()},[Le,e]),!z||!z.isEnabled||!e)return null;const Et="catalog.gift_wrapping_new.box."+(ne?"default":$[S]),ri=`catalog.gift_wrapping_new.ribbon.${O}`,ni="catalog.gift_wrapping_new."+(ne?"freeprice":"price");return s.jsxs(ve,{uniqueKey:"catalog-gift",className:"nitro-catalog-gift",theme:"primary-slim",children:[s.jsx(je,{headerText:g("catalog.gift_wrapping.title"),onCloseClick:Z}),s.jsxs(be,{className:"text-black",children:[s.jsxs(jte,{column:!0,children:[s.jsx(T,{children:g("catalog.gift_wrapping.receiver")}),s.jsx("input",{type:"text",className:za("form-control form-control-sm",F&&"is-invalid"),value:u,onChange:gt=>ae(gt)}),V.length>0&&ee&&s.jsx(N,{className:"autocomplete-gift-container",children:V.map(gt=>s.jsx(q,{className:"autocomplete-gift-item",onClick:yt=>Te(gt.name),children:gt.name},gt.id))}),F&&s.jsx(q,{className:"invalid-feedback",children:g("catalog.gift_wrapping.receiver_not_found.title")})]}),s.jsx(jG,{figure:te().figure,userName:te().userName,message:f,editable:!0,onChange:gt=>E(gt)}),s.jsxs(q,{className:"form-check",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",name:"showMyFace",checked:_,onChange:gt=>m(yt=>!yt)}),s.jsx("label",{className:"form-check-label",children:g("catalog.gift_wrapping.show_face.title")})]}),s.jsxs(x,{alignItems:"center",gap:2,children:[A&&s.jsx(q,{className:"gift-preview",children:s.jsx(xT,{productType:dt.FLOOR,productClassId:me,extraData:_e})}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{gap:2,children:[s.jsxs(Ya,{children:[s.jsx(X,{variant:"primary",onClick:()=>Se("prev_box"),children:s.jsx(ds,{className:"fa-icon"})}),s.jsx(X,{variant:"primary",onClick:()=>Se("next_box"),children:s.jsx(_s,{className:"fa-icon"})})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{fontWeight:"bold",children:g(Et)}),s.jsxs(x,{alignItems:"center",gap:1,children:[g(ni,["price"],[z.price.toString()]),s.jsx(gs,{type:-1})]})]})]}),s.jsxs(x,{alignItems:"center",gap:2,className:de?"":"opacity-50 pointer-events-none",children:[s.jsxs(Ya,{children:[s.jsx(X,{variant:"primary",onClick:()=>Se("prev_ribbon"),children:s.jsx(ds,{className:"fa-icon"})}),s.jsx(X,{variant:"primary",onClick:()=>Se("next_ribbon"),children:s.jsx(_s,{className:"fa-icon"})})]}),s.jsx(T,{fontWeight:"bold",children:g(ri)})]})]})]}),s.jsxs(N,{gap:1,className:de?"":"opacity-50 pointer-events-none",children:[s.jsx(T,{fontWeight:"bold",children:g("catalog.gift_wrapping.pick_color")}),s.jsx(Ya,{fullWidth:!0,children:I.map(gt=>s.jsx(X,{variant:"dark",active:gt.id===A,disabled:!de,style:{backgroundColor:gt.color},onClick:()=>b(gt.id)},gt.id))})]}),s.jsxs(x,{justifyContent:"between",alignItems:"center",children:[s.jsx(X,{variant:"link",onClick:Z,className:"text-black",children:g("cancel")}),s.jsx(X,{variant:"success",onClick:()=>Se("buy"),children:g("catalog.gift_wrapping.give_gift")})]})]})]})},wre=a=>{const[e,t]=h.useState(""),{currentType:i=null,rootNode:r=null,offersToNodes:n=null,searchResult:o=null,setSearchResult:l=null,setCurrentPage:c=null}=es();return h.useEffect(()=>{let u=e==null?void 0:e.toLocaleLowerCase().replace(" ","");if(!u||!u.length){l(null);return}const d=setTimeout(()=>{const _=te().getAllFurnitureData({loadFurnitureData:null});if(!_||!_.length)return;const m=[],f=[];for(const p of _){if(i===la.BUILDER&&!p.availableForBuildersClub||i===la.NORMAL&&p.excludeDynamic)continue;const S=[p.className,p.name,p.description].join(" ").replace(/ /gi,"").toLowerCase();if(i===la.BUILDER&&p.purchaseOfferId===-1&&p.rentOfferId===-1)p.furniLine!==""&&f.indexOf(p.furniLine)<0&&S.indexOf(u)>=0&&f.push(p.furniLine);else if([...pb(n,p.purchaseOfferId),...pb(n,p.rentOfferId)].length&&(S.indexOf(u)>=0&&m.push(p),m.length===250))break}const E=[];for(const p of m)E.push(new xQ(p));let I=[];sk(u,f,r,I),l(new NQ(u,E,I.filter(p=>p.isVisible))),c(new dp(-1,"default_3x3",new ik([],[]),E,!1,1))},300);return()=>clearTimeout(d)},[n,i,r,e,c,l]),s.jsxs(x,{gap:1,children:[s.jsx(x,{fullWidth:!0,alignItems:"center",position:"relative",children:s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("generic.search"),value:e,onChange:u=>t(u.target.value)})}),(!e||!e.length)&&s.jsx(X,{variant:"primary",className:"catalog-search-button",children:s.jsx(tT,{className:"fa-icon"})}),e&&!!e.length&&s.jsx(X,{variant:"primary",className:"catalog-search-button",onClick:u=>t(""),children:s.jsx(pr,{className:"fa-icon"})})]})},tB=a=>{const{node:e=null,child:t=!1}=a;return s.jsx(s.Fragment,{children:e&&e.children.length>0&&e.children.map((i,r)=>i.isVisible?s.jsx(sB,{node:i,child:t},r):null)})},sB=a=>{const{node:e=null,child:t=!1}=a,{activateNode:i=null}=es();return s.jsxs(s.Fragment,{children:[s.jsxs(ct,{style:{marginLeft:`${(e.depth-2)*10}px`},gap:1,column:!1,itemActive:e.isActive,onClick:r=>i(e),children:[s.jsx(GN,{icon:e.iconId}),s.jsx(T,{bold:!0,variant:"muted",grow:!0,truncate:!0,children:e.localization}),e.isBranch&&s.jsxs(s.Fragment,{children:[e.isOpen&&s.jsx(Wy,{className:"fa-icon"}),!e.isOpen&&s.jsx(xg,{className:"fa-icon",style:{color:"#989898"}})]})]}),e.isOpen&&e.isBranch&&s.jsx(tB,{node:e,child:!0})]})},Fre=a=>{const{node:e=null}=a,{searchResult:t=null}=es();return s.jsxs(s.Fragment,{children:[s.jsx(wre,{}),s.jsx(N,{fullHeight:!0,className:"nitro-catalog-navigation-grid-container grid-bg w-100 p-1",overflow:"hidden",children:s.jsxs(Os,{id:"nitro-catalog-main-navigation",gap:1,columnCount:1,children:[t&&t.filteredNodes.length>0&&t.filteredNodes.map((i,r)=>s.jsx(sB,{node:i},r)),!t&&s.jsx(tB,{node:e})]})})]})},Pc=a=>{const{...e}=a,{currentOffer:t=null}=es();return!t||!t.badgeCode||!t.badgeCode.length?null:s.jsx(as,{badgeCode:t.badgeCode,...e})},kre=[],Gre=a=>{const{columnCount:e=5,...t}=a,[i,r]=h.useState(!1),[n,o]=h.useState(null),{currentOffer:l=null,setPurchaseOptions:c=null}=es(),{badgeCodes:u=[],activate:d=null,deactivate:_=null}=Yd(),[m,f]=h.useState(""),E=h.useMemo(()=>{if(!n)return null;const p=new qa;return p.setValue(["0",n,"",""]),p},[n]);h.useEffect(()=>{l&&c(p=>{const S={...p};return S.extraParamRequired=!0,S.extraData=E&&E.getValue(1)||null,S.previewStuffData=E,S})},[l,E,c]),h.useEffect(()=>{if(!i)return;const p=d();return()=>_(p)},[i,d,_]),h.useEffect(()=>(r(!0),()=>r(!1)),[]);const I=h.useMemo(()=>!u||!u.length?[]:u.filter(p=>kre.includes(p)?!1:m?p.toLowerCase().includes(m.toLowerCase()):!0),[u,m]);return s.jsxs(N,{fullWidth:!0,children:[s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:"Pesquisar...",value:m,onChange:p=>f(p.target.value)}),s.jsx(Os,{columnCount:e,...t,className:"p-1",overflow:"auto",children:I&&I.length>0&&I.map((p,S)=>s.jsx(ct,{overflow:"hidden",itemActive:n===p,onClick:R=>o(p),children:s.jsx(as,{overflow:"hidden",badgeCode:p})},S))})]})},LT=a=>{const{currentPage:e=null,setCurrentOffer:t=null}=es();return h.useEffect(()=>{!e||!e.offers.length||t(e.offers[0])},[e,t]),null},Bre=a=>{const{itemImage:e=void 0,itemColor:t=void 0,itemActive:i=!1,itemCount:r=1,itemCountMinimum:n=1,itemUniqueSoldout:o=!1,itemUniqueNumber:l=-2,itemUnseen:c=!1,itemHighlight:u=!1,disabled:d=!1,center:_=!0,column:m=!0,style:f={},classNames:E=[],position:I="relative",overflow:p="hidden",children:S=null,...R}=a,O=h.useMemo(()=>{const A=["layout-catalog-grid-item","justify-content-end"];return i&&A.push("active"),(o||l>0)&&A.push("unique-item"),o&&A.push("sold-out"),c&&A.push("unseen"),u&&A.push("has-highlight"),d&&A.push("disabled"),e===null&&A.push("icon","loading-icon"),E.length&&A.push(...E),A},[i,o,l,c,u,d,e,E]),C=h.useMemo(()=>{let A={...f};return e&&(A.backgroundImage=`url(${e})`),t&&(A.backgroundColor=t),Object.keys(f).length&&(A={...A,...f}),A},[f,e,t]);return s.jsxs(N,{pointer:!0,position:I,overflow:p,column:m,classNames:O,style:C,...R,children:[r>n&&s.jsx(wo,{count:r}),l>0&&s.jsxs(s.Fragment,{children:[s.jsx(q,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),s.jsx("div",{className:"position-absolute unique-item-counter",children:s.jsx(Vd,{value:l})})]}),S]})},Vre=a=>{const{offer:e=null,separator:t=!1}=a,{purchaseOptions:i=null}=es(),{quantity:r=1}=i;return e?s.jsxs(s.Fragment,{children:[t&&e.priceInCredits>0&&e.priceInActivityPoints>0&&s.jsx(zd,{className:"fa-icon"}),e.priceInActivityPoints>0&&s.jsxs(x,{alignItems:"end",justifyContent:"end",gap:1,className:"grid-price-view",children:[s.jsx(T,{bold:!0,children:e.priceInActivityPoints*r}),s.jsx(gs,{type:e.activityPointType})]})]}):null},BN=a=>{const{offer:e=null,selectOffer:t=null,itemActive:i=!1,...r}=a,[n,o]=h.useState(!1),{requestOfferToMover:l=null}=es();$a();const c=h.useMemo(()=>e.pricingModel===Zi.PRICING_MODEL_BUNDLE?null:e.product.getIconUrl(e),[e]),u=_=>{switch(_.type){case Re.MOUSE_DOWN:t(e),o(!0);return;case Re.MOUSE_UP:o(!1);return;case Re.ROLL_OUT:if(!n)return;l(e),o(!1);return}},d=e.product;return d?s.jsxs(N,{className:"catalog-grid-active cursor-pointer",gap:0,itemActive:i,onMouseDown:u,onMouseUp:u,onMouseOut:u,children:[s.jsx(Bre,{itemImage:c,itemCount:e.pricingModel===Zi.PRICING_MODEL_MULTI?d.productCount:1,itemUniqueSoldout:d.uniqueLimitedItemSeriesSize&&!d.uniqueLimitedItemsLeft,itemUniqueNumber:d.uniqueLimitedItemSeriesSize,...r,children:e.product.productType===dt.ROBOT&&s.jsx(ls,{figure:e.product.extraParam,headOnly:!0,direction:3})}),s.jsx(x,{alignItems:"end",justifyContent:"end",fullWidth:!0,gap:0,children:s.jsx(N,{gap:0,children:s.jsx(Vre,{offer:e})})})]}):null},xm=a=>{const{columnCount:e=5,children:t=null,...i}=a,{currentOffer:r=null,setCurrentOffer:n=null,currentPage:o=null,setPurchaseOptions:l=null}=es(),c=h.useRef();if(h.useEffect(()=>{c&&c.current&&(c.current.scrollTop=0)},[o]),!o)return null;const u=d=>{d.activate(),!d.isLazy&&(n(d),d.product&&d.product.productType===dt.WALL&&l(_=>{const m={..._};return m.extraData=d.product.extraParam||null,m}))};return s.jsxs(Os,{innerRef:c,columnCount:e,...i,children:[o.offers&&o.offers.length>0&&o.offers.map((d,_)=>s.jsx(BN,{itemActive:r&&r.offerId===d.offerId,offer:d,selectOffer:u},_)),t]})},PT=a=>{const{children:e=null,...t}=a,{currentOffer:i=null}=es();return!i||i.pricingModel!==Zi.PRICING_MODEL_SINGLE||!i.product.isUniqueLimitedItem?null:s.jsxs(q,{...t,children:[s.jsx(yte,{uniqueLimitedItemsLeft:i.product.uniqueLimitedItemsLeft,uniqueLimitedSeriesSize:i.product.uniqueLimitedItemSeriesSize}),e]})},Za=a=>{const{noGiftOption:e=!1,purchaseCallback:t=null}=a;h.useState(!1);const[i,r]=h.useState(bs.NONE),[n,o]=br(tr.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1),{currentOffer:l=null,currentPage:c=null,purchaseOptions:u=null,setPurchaseOptions:d=null}=es(),{getCurrencyAmount:_=null}=Qa(),m=h.useCallback(p=>{switch(p.type){case Ho.PURCHASE_SUCCESS:r(bs.NONE);return;case yc.PURCHASE_FAILED:r(bs.FAILED);return;case nm.NOT_ALLOWED:r(bs.FAILED);return;case am.SOLD_OUT:r(bs.SOLD_OUT);return}},[]);Js(Ho.PURCHASE_SUCCESS,m),Js(yc.PURCHASE_FAILED,m),Js(nm.NOT_ALLOWED,m),Js(am.SOLD_OUT,m);const f=h.useMemo(()=>{if(!l||u.extraParamRequired&&(!u.extraData||!u.extraData.length))return!1;if(l.pricingModel===Zi.PRICING_MODEL_SINGLE){const p=l.product;if(p&&p.isUniqueLimitedItem)return!p.uniqueLimitedItemsLeft}return!1},[l,u]),E=(p=!1)=>{if(!l)return;if(ti()<l.clubLevel){Ce("habboUI/open/hccenter");return}if(p){_i(new Bte(l.page.pageId,l.offerId,u.extraData));return}if(r(bs.PURCHASE),t){t();return}let S=l.page.pageId;K(new hT(S,l.offerId,u.extraData,u.quantity))};if(h.useEffect(()=>{l&&r(bs.NONE)},[l,d]),h.useEffect(()=>{let p=null;return(i===bs.CONFIRM||i===bs.FAILED)&&(p=setTimeout(()=>r(bs.NONE),3e3)),()=>{p&&clearTimeout(p)}},[i]),!l)return null;const I=()=>{const p=l.priceInCredits*u.quantity,S=l.priceInActivityPoints*u.quantity;if(ti()<l.clubLevel)return s.jsx(X,{variant:"danger",disabled:!0,children:g("catalog.alert.hc.required")});if(f)return s.jsx("div",{className:"unique-sold-out-blocker",children:s.jsx("div",{children:g("catalog.alert.limited_edition_sold_out.title")})});if(p>_(-1))return s.jsx(X,{variant:"danger",disabled:!0,children:g("catalog.alert.notenough.title")});if(S>_(l.activityPointType))return s.jsx(X,{variant:"danger",disabled:!0,children:g("catalog.alert.notenough.activitypoints.title."+l.activityPointType)});switch(i){case bs.CONFIRM:return s.jsx(X,{variant:"warning",onClick:R=>E(),children:s.jsx(T,{children:g("catalog.marketplace.confirm_title")})});case bs.PURCHASE:return s.jsx(X,{disabled:!0,children:s.jsx(LN,{})});case bs.FAILED:return s.jsx(X,{variant:"danger",children:s.jsx(T,{variant:"white",children:g("generic.failed")})});case bs.SOLD_OUT:return s.jsx(X,{variant:"danger",children:s.jsx(T,{variant:"white",children:g("generic.failed")+" - "+g("catalog.alert.limited_edition_sold_out.title")})});case bs.NONE:default:return n?s.jsx(X,{disabled:u.extraParamRequired&&(!u.extraData||!u.extraData.length),onClick:R=>E(),children:s.jsx(T,{variant:"white",children:g("catalog.purchase_confirmation."+(l.isRentOffer?"rent":"buy"))})}):s.jsx(X,{variant:"success",disabled:u.extraParamRequired&&(!u.extraData||!u.extraData.length),onClick:R=>r(bs.CONFIRM),children:s.jsx(T,{variant:"white",children:g("catalog.purchase_confirmation."+(l.isRentOffer?"rent":"buy"))})})}};return s.jsxs(s.Fragment,{children:[!e&&!l.isRentOffer&&!l.product.isUniqueLimitedItem&&s.jsx(X,{disabled:u.quantity>1||!l.giftable||f||u.extraParamRequired&&(!u.extraData||!u.extraData.length),onClick:p=>E(!0),children:s.jsx(T,{variant:"white",children:g("catalog.purchase_confirmation.gift")})}),s.jsx(I,{})]})},uh=a=>{const{currentOffer:e=null,roomPreviewer:t=null,purchaseOptions:i=null}=es(),{previewStuffData:r=null}=i;return h.useEffect(()=>{if(!e||e.pricingModel===Zi.PRICING_MODEL_BUNDLE||!t)return;const n=e.product;if(n)switch(t.reset(!1),n.productType){case dt.FLOOR:{if(!n.furnitureData)return;if(n.furnitureData.specialType===Je.FIGURE_PURCHASABLE_SET){const l=te().getFloorItemData(n.furnitureData.id).customParams.split(",").map(d=>parseInt(d)),c=[];for(const d of l)qt().isValidFigureSetForGender(d,te().gender)&&c.push(d);const u=qt().getFigureStringWithFigureIds(te().figure,te().gender,c);t.addAvatarIntoRoom(u,n.productClassId)}else t.addFurnitureIntoRoom(n.productClassId,new Y(90),r,n.extraParam);return}case dt.WALL:{if(!n.furnitureData)return;switch(n.furnitureData.specialType){case Je.FLOOR:t.updateObjectRoom(n.extraParam);return;case Je.WALL_PAPER:t.updateObjectRoom(null,n.extraParam);return;case Je.LANDSCAPE:{t.updateObjectRoom(null,null,n.extraParam);const o=te().getWallItemDataByName("window_double_default");o&&t.addWallItemIntoRoom(o.id,new Y(90),o.customParams);return}default:t.updateObjectRoom("default","default","default"),t.addWallItemIntoRoom(n.productClassId,new Y(90),n.extraParam);return}}case dt.ROBOT:t.addAvatarIntoRoom(n.extraParam,0);return;case dt.EFFECT:t.addAvatarIntoRoom(te().figure,n.productClassId);return}},[e,r,t]),e?e.pricingModel===Zi.PRICING_MODEL_BUNDLE?s.jsx(N,{fit:!0,overflow:"hidden",className:"bg-muted p-2 rounded",fullWidth:!0,fullHeight:!0,children:s.jsx(Os,{fullWidth:!0,columnCount:4,className:"nitro-catalog-layout-bundle-grid",children:e.products.length>0&&e.products.map((n,o)=>s.jsx(ct,{itemImage:n.getIconUrl(e),itemCount:n.productCount},o))})}):s.jsx(CT,{roomPreviewer:t,height:200}):null},Hre=a=>{const{page:e=null}=a,{currentOffer:t=null}=es();return s.jsxs(s.Fragment,{children:[s.jsx(LT,{}),s.jsxs(N,{className:"position-relative",center:!t,overflow:"hidden",children:[s.jsxs("div",{style:{minHeight:"200px",maxHeight:"200px"},children:[!t&&s.jsx(s.Fragment,{children:!!e.localization.getImage(1)&&s.jsx("img",{className:"catalog-image-column",alt:"",src:e.localization.getImage(1)})}),t&&s.jsxs(s.Fragment,{children:[s.jsxs(q,{position:"relative",children:[s.jsx(uh,{}),s.jsx(PT,{fullWidth:!0,position:"absolute",className:"top-1"}),s.jsx(Pc,{position:"absolute",className:"bg-muted rounded top-1 end-1"})]}),s.jsx(N,{grow:!0,gap:1,children:s.jsx(T,{bold:!0,variant:"white",className:"item-title",grow:!0,truncate:!0,children:t.localizationName})})]})]}),s.jsxs(x,{gap:2,className:"grid-bg p-2",overflow:"auto",fullHeight:!0,fullWidth:!0,children:[s.jsx(xm,{fullWidth:!0}),s.jsx(Gre,{fullWidth:!0})]})]}),s.jsx(x,{gap:2,className:"purchase-buttons align-items-end",children:s.jsx(Za,{})})]})},pv=1,Ev=100,Wre=100,Om=()=>{const{currentOffer:a=null,purchaseOptions:e=null,setPurchaseOptions:t=null}=es(),{quantity:i=1}=e,r=h.useRef(null),n=u=>{t(d=>{const _=Math.max(pv,Math.min(Ev,d.quantity+u));return{...d,quantity:_}})},o=u=>{isNaN(u)&&(u=1),u=Math.max(pv,Math.min(Ev,u)),t(d=>({...d,quantity:u}))},l=u=>{n(u),r.current&&(clearInterval(r.current),r.current=null),r.current=window.setInterval(()=>{n(u)},Wre)},c=()=>{r.current&&(clearInterval(r.current),r.current=null)};return!a||!a.bundlePurchaseAllowed?null:s.jsxs(x,{className:"catalog-spinner-widget",gap:2,justifyContent:"center",alignItems:"center",children:[s.jsx(T,{center:!0,noWrap:!0,children:g("catalog.bundlewidget.spinner.select.amount")}),s.jsxs(x,{justifyContent:"between",alignItems:"center",fullWidth:!0,children:[s.jsxs(x,{center:!0,gap:1,children:[s.jsx(of,{className:"text-black cursor-pointer fa-icon",onMouseDown:()=>l(-1),onMouseUp:c,onMouseLeave:c,onTouchStart:()=>l(-1),onTouchEnd:c}),s.jsx("input",{type:"number",className:"form-control form-control-sm quantity-input text-center",value:i,onChange:u=>o(u.target.valueAsNumber)}),s.jsx(xg,{className:"text-black cursor-pointer fa-icon",onMouseDown:()=>l(1),onMouseUp:c,onMouseLeave:c,onTouchStart:()=>l(1),onTouchEnd:c})]}),s.jsx(x,{gap:1,alignItems:"center",children:(a.priceInCredits>0||a.priceInActivityPoints>0)&&s.jsxs(s.Fragment,{children:[s.jsx(T,{children:"Preço:"}),a.priceInCredits>0&&s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{bold:!0,children:a.priceInCredits*i}),s.jsx(gs,{type:-1})]}),a.priceInActivityPoints>0&&s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{bold:!0,children:a.priceInActivityPoints*i}),s.jsx(gs,{type:a.activityPointType})]})]})})]})]})},Yre=a=>{const{page:e=null}=a,[t,i]=h.useState(new Map),{currentOffer:r=null,setCurrentOffer:n=null}=es(),[o,l]=h.useState(!1),c=(f,E)=>!f.product.furnitureData.colorIndex||!E.product.furnitureData.colorIndex||f.product.furnitureData.colorIndex>E.product.furnitureData.colorIndex?1:f==E?0:-1,u=(f,E)=>f.product.furnitureData.className>E.product.furnitureData.className?1:f==E?0:-1,d=f=>{f.activate(),n(f)},_=(f,E)=>{const I=`${E}*${f}`,p=e.offers.findIndex(S=>S.product.furnitureData.fullName===I);p>-1&&d(e.offers[p])},m=h.useMemo(()=>{const f=[],E=new Map,I=new Map;return e.offers.sort(c),e.offers.forEach(p=>{if(!p.product)return;const S=p.product.furnitureData;if(!S||!S.hasIndexedColor)f.push(p);else{const R=S.className,O=S.colorIndex;I.has(R)||I.set(R,[]);let C=16777215;if(S.colors){for(let A of S.colors)A!==16777215&&(C=A);I.get(R).indexOf(C)===-1&&(I.get(R)[O]=C)}E.has(R)||(f.push(p),E.set(R,!0))}}),f.sort(u),i(I),f},[e.offers]);return s.jsxs(s.Fragment,{children:[s.jsxs(N,{className:"position-relative",center:!r,overflow:"hidden",fullHeight:!0,children:[s.jsxs("div",{style:{minHeight:"200px",maxHeight:"200px"},children:[!r&&s.jsxs(s.Fragment,{children:[!!e.localization.getImage(1)&&s.jsx("img",{alt:"",src:e.localization.getImage(1)}),s.jsx(T,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),r&&s.jsx(s.Fragment,{children:s.jsxs(q,{position:"relative",overflow:"hidden",children:[s.jsx(uh,{}),s.jsx(Pc,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),r.product.furnitureData.hasIndexedColor&&s.jsx(X,{position:"absolute",className:"bottom-1 start-1",onClick:f=>l(E=>!E),children:s.jsx(Yy,{className:"fa-icon"})})]})})]}),s.jsx(N,{className:"grid-bg p-2",size:7,overflow:"hidden",fullWidth:!0,fullHeight:!0,children:s.jsxs(Os,{columnCount:5,children:[(!o||!r||!t.has(r.product.furnitureData.className))&&m.map((f,E)=>s.jsx(BN,{itemActive:r&&(r.product.furnitureData.hasIndexedColor?r.product.furnitureData.className===f.product.furnitureData.className:r.offerId===f.offerId),offer:f,selectOffer:d},E)),o&&r&&t.has(r.product.furnitureData.className)&&t.get(r.product.furnitureData.className).map((f,E)=>s.jsx(ct,{itemHighlight:!0,itemActive:r.product.furnitureData.colorIndex===E,itemColor:Ri.int2rgb(f),className:"clear-bg",onClick:I=>_(E,r.product.furnitureData.className)},E))]})})]}),!r&&s.jsx(T,{center:!0,className:"grid-bg p-2",variant:"muted",bold:!0,fontSize:6,children:"Escolha um item!"}),r&&s.jsxs(N,{children:[r.bundlePurchaseAllowed&&s.jsx(x,{gap:1,className:"quanity-container",children:s.jsx(Om,{})}),s.jsx(x,{gap:2,className:"purchase-buttons align-items-end",children:s.jsx(Za,{})})]})]})},zre=a=>{const{page:e=null}=a,{currentOffer:t=null,currentPage:i=null}=es();return s.jsxs(s.Fragment,{children:[s.jsxs(N,{className:"position-relative",center:!t,overflow:"hidden",fullHeight:!0,children:[s.jsxs("div",{style:{minHeight:"200px",maxHeight:"200px"},children:[!t&&s.jsx(s.Fragment,{children:!!e.localization.getImage(1)&&s.jsx("img",{className:"catalog-image-column",alt:"",src:e.localization.getImage(1)})}),t&&s.jsxs(s.Fragment,{children:[s.jsxs(q,{position:"relative",children:[s.jsx(uh,{}),s.jsx(PT,{fullWidth:!0,position:"absolute",className:"top-1"}),s.jsx(Pc,{position:"absolute",className:"bg-muted rounded bottom-2 end-2"})]}),s.jsx(N,{grow:!0,gap:1,children:s.jsx(T,{bold:!0,variant:"white",className:"item-title",grow:!0,truncate:!0,children:t.localizationName})})]})]}),s.jsx(N,{className:"grid-bg p-2",overflow:"hidden",fullWidth:!0,fullHeight:!0,children:s.jsx(xm,{})})]}),!t&&s.jsx(T,{center:!0,className:"grid-bg p-2",variant:"muted",bold:!0,fontSize:6,children:"Escolha um item!"}),t&&s.jsxs(N,{children:[t.bundlePurchaseAllowed&&s.jsx(x,{gap:1,className:"quanity-container",children:s.jsx(Om,{})}),s.jsx(x,{gap:2,className:"purchase-buttons align-items-end",children:s.jsx(Za,{})})]})]})},iB=a=>{const[e,t]=h.useState(0),{currentOffer:i=null,catalogOptions:r=null,setPurchaseOptions:n=null}=es(),{groups:o=null}=r,l=h.useMemo(()=>{if(!o||!o.length)return null;const u=o[e];if(!u)return null;const d=new qa;return d.setValue(["0",u.groupId.toString(),u.badgeCode,u.colorA,u.colorB]),d},[e,o]);if(h.useEffect(()=>{i&&n(u=>{const d={...u};return d.extraParamRequired=!0,d.extraData=l&&l.getValue(1)||null,d.previewStuffData=l,d})},[i,l,n]),h.useEffect(()=>{K(new pm)},[]),!o||!o.length)return s.jsxs(q,{className:"bg-muted rounded p-1 text-black text-center",children:[g("catalog.guild_selector.members_only"),s.jsx(X,{className:"mt-1",children:g("catalog.guild_selector.find_groups")})]});const c=o[e];return s.jsxs(x,{gap:1,children:[!!c&&s.jsxs(x,{overflow:"hidden",className:"rounded border",children:[s.jsx(q,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+c.colorA}}),s.jsx(q,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+c.colorB}})]}),s.jsx("select",{className:"form-select form-select-sm",value:e,onChange:u=>t(parseInt(u.target.value)),children:o.map((u,d)=>s.jsx("option",{value:d,children:u.groupName},d))})]})},Kre=a=>{const{page:e=null}=a,{currentOffer:t=null}=es();return s.jsxs(s.Fragment,{children:[s.jsxs(N,{className:"position-relative",center:!t,size:5,overflow:"hidden",fullHeight:!0,children:[s.jsxs("div",{style:{minHeight:"200px",maxHeight:"200px"},children:[!t&&s.jsx(s.Fragment,{children:!!e.localization.getImage(1)&&s.jsx("img",{className:"catalog-image-column",alt:"",src:e.localization.getImage(1)})}),t&&s.jsxs(s.Fragment,{children:[s.jsxs(q,{position:"relative",children:[s.jsx(uh,{}),s.jsx(PT,{fullWidth:!0,position:"absolute",className:"top-1"}),s.jsx(Pc,{position:"absolute",className:"bg-muted rounded top-1 end-1"})]}),s.jsx(N,{grow:!0,gap:1,children:s.jsx(T,{bold:!0,variant:"white",className:"item-title",grow:!0,truncate:!0,children:t.localizationName})})]})]}),s.jsx(q,{grow:!0,fullWidth:!0,children:s.jsx(iB,{})}),s.jsx(N,{className:"grid-bg p-2",overflow:"hidden",fullWidth:!0,fullHeight:!0,children:s.jsx(xm,{})})]}),!t&&s.jsx(T,{center:!0,className:"grid-bg p-2",variant:"muted",bold:!0,fontSize:6,children:"Escolha um item!"}),t&&s.jsxs(N,{children:[t.bundlePurchaseAllowed&&s.jsx(x,{gap:1,className:"quanity-container",children:s.jsx(Om,{})}),s.jsx(x,{gap:2,className:"purchase-buttons align-items-end",children:s.jsx(Za,{})})]})]})},rB=a=>{const{offer:e=null,separator:t=!1}=a,{purchaseOptions:i=null}=es(),{quantity:r=1}=i;return e?s.jsxs(s.Fragment,{children:[e.priceInCredits>0&&s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{bold:!0,children:e.priceInCredits*r}),s.jsx(gs,{type:-1})]}),t&&e.priceInCredits>0&&e.priceInActivityPoints>0&&s.jsx(zd,{size:"xs",color:"black",className:"fa-icon"}),e.priceInActivityPoints>0&&s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsxs(T,{bold:!0,children:[" ",e.priceInActivityPoints*r]}),s.jsx(gs,{type:e.activityPointType})]})]}):null},VN=a=>{const{gap:e=1,...t}=a,{currentOffer:i=null}=es();return s.jsx(N,{gap:e,...t,children:s.jsx(rB,{offer:i})})},qre=a=>{const{page:e=null}=a;h.useState(0);const{currentOffer:t=null,setCurrentOffer:i=null,catalogOptions:r=null}=es();return h.useEffect(()=>{K(new pm)},[e]),s.jsxs(s.Fragment,{children:[s.jsx(LT,{}),s.jsxs(N,{children:[s.jsx(N,{className:"p-1",overflow:"hidden",children:s.jsx(T,{className:"group-forum-page",dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})}),s.jsx(N,{overflow:"hidden",gap:1,children:!!t&&s.jsx(s.Fragment,{children:s.jsxs(N,{grow:!0,gap:0,children:[s.jsx(T,{truncate:!0,children:t.localizationName}),s.jsx(q,{grow:!0,children:s.jsx(iB,{})}),s.jsx(x,{justifyContent:"end",children:s.jsx(VN,{alignItems:"end"})}),s.jsx(Za,{noGiftOption:!0})]})})})]})]})},Xre=a=>{const{page:e=null}=a;return s.jsxs(N,{children:[s.jsxs(N,{gap:4,overflow:"hidden",className:"p-3",children:[s.jsx(T,{bold:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),s.jsx(T,{overflow:"auto",dangerouslySetInnerHTML:{__html:e.localization.getText(0)}}),s.jsx(T,{dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})]}),s.jsxs(N,{center:!0,size:5,overflow:"hidden",children:[s.jsx(Lc,{imageUrl:e.localization.getImage(1)}),s.jsx(X,{onClick:()=>Ce("groups/create"),children:g("catalog.start.guild.purchase.button")})]})]})},$re=a=>{const{page:e=null}=a;return s.jsx("div",{className:"h-100 nitro-catalog-layout-info-loyalty text-black d-flex flex-row",children:s.jsx("div",{className:"overflow-auto h-100 d-flex flex-column info-loyalty-content",children:s.jsx("div",{dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})})})},nB=a=>{const{page:e=null}=a,t=e.localization.getImage(1);return s.jsxs(N,{grow:!0,className:"bg-muted rounded text-black p-2",overflow:"hidden",children:[s.jsxs(x,{alignItems:"center",gap:2,children:[t&&s.jsx("img",{alt:"",src:t}),s.jsx(q,{className:"fs-5",dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})]}),s.jsx(N,{grow:!0,alignItems:"center",overflow:"auto",children:s.jsx(q,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}})}),s.jsx(x,{alignItems:"center",children:s.jsx(q,{className:"fw-bold",dangerouslySetInnerHTML:{__html:e.localization.getText(3)}})})]})},Qre=a=>s.jsx(nB,{...a}),Jre=a=>{const{page:e=null}=a,[t,i]=h.useState(""),[r,n]=h.useState(""),[o,l]=h.useState(-1),[c,u]=h.useState([]),[d,_]=h.useState(!1),[m,f]=h.useState(1),{categories:E=null}=Ir(),{setIsVisible:I=null}=es(),{promoteInformation:p,isExtended:S,setIsExtended:R}=DT();h.useEffect(()=>{S&&(l(p.data.flatId),i(p.data.eventName),n(p.data.eventDescription),f(p.data.categoryId),_(S),R(!1))},[S,t,r,m]);const O=()=>{l(-1),i(""),n(""),f(1),R(!1),I(!1)},C=()=>{const A=e.pageId,b=e.offers.length>=1?e.offers[0].offerId:-1,y=o,M=t,U=r,G=m;K(new RP(A,b,y,M,d,U,G)),O()};return J(qD,A=>{const b=A.getParser();b&&u(b.rooms)}),h.useEffect(()=>{K(new IP),K(new tN)},[]),s.jsx("div",{style:{height:"100%"},children:s.jsxs(N,{size:12,overflow:"auto",className:"text-black",fullHeight:!0,children:[s.jsxs(N,{gap:1,alignItems:"start",children:[s.jsx(T,{bold:!0,center:!0,children:g("roomad.catalog_header")}),g("roomad.catalog_text",["duration"],["120"])]}),s.jsxs(N,{gap:0,justifyContent:"between",className:"bg-muted rounded p-2",fullHeight:!0,children:[s.jsxs(N,{gap:0,children:[s.jsxs(N,{gap:2,children:[s.jsx(T,{bold:!0,children:g("navigator.category")}),s.jsx("select",{className:"form-select form-select-sm",value:m,onChange:A=>f(parseInt(A.target.value)),disabled:d,children:E&&E.map((A,b)=>s.jsx("option",{value:A.id,children:g(A.name)},b))})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("roomad.catalog_name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:64,value:t,onChange:A=>i(A.target.value),readOnly:d})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("roomad.catalog_description")}),s.jsx("textarea",{style:{height:"100px"},className:"form-control form-control-sm",maxLength:100,value:r,onChange:A=>n(A.target.value),readOnly:d})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("roomad.catalog_roomname")}),s.jsxs("select",{className:"form-select form-select-sm",value:o,onChange:A=>l(parseInt(A.target.value)),disabled:d,children:[s.jsx("option",{value:-1,disabled:!0,children:g("roomad.catalog_roomname")}),c&&c.map((A,b)=>s.jsx("option",{value:A.roomId,children:A.roomName},b))]})]})]}),s.jsx(N,{gap:1,children:s.jsx(X,{variant:!t||!r||o===-1?"danger":"success",onClick:C,disabled:!t||!r||o===-1,children:g(d?"roomad.extend.event":"buy")})})]})]})})},aB=a=>{const{columnCount:e=5,children:t=null,...i}=a,{currentOffer:r=null}=es(),n=h.useRef();return h.useEffect(()=>{n&&n.current&&(n.current.scrollTop=0)},[r]),r?s.jsxs(Os,{innerRef:n,columnCount:5,...i,children:[r.products&&r.products.length>0&&r.products.map((o,l)=>s.jsx(ct,{itemImage:o.getIconUrl(),itemCount:o.productCount},l)),t]}):null},oB=a=>{const{gap:e=1,...t}=a,{currentOffer:i=null}=es();return s.jsx(x,{gap:e,alignItems:"center",classNames:["bg-muted","p-1","rounded"],...t,children:s.jsx(rB,{separator:!0,offer:i})})},Zre=a=>{const{page:e=null}=a;return s.jsxs(s.Fragment,{children:[s.jsx(LT,{}),s.jsxs(Ye,{children:[s.jsxs(N,{size:7,overflow:"hidden",children:[!!e.localization.getText(2)&&s.jsx(T,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),s.jsx(N,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:s.jsx(aB,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),s.jsxs(N,{size:5,overflow:"hidden",gap:1,children:[!!e.localization.getText(1)&&s.jsx(T,{center:!0,small:!0,overflow:"auto",children:e.localization.getText(1)}),s.jsxs(N,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!e.localization.getImage(1)&&s.jsx("img",{alt:"",className:"flex-grow-1",src:e.localization.getImage(1)}),s.jsx(Pc,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),s.jsx(oB,{position:"absolute",className:"bottom-0 end-0"})]}),s.jsx(N,{gap:1,children:s.jsx(Za,{})})]})]})]})},ene=a=>{const{page:e=null}=a;return s.jsxs(s.Fragment,{children:[s.jsx(LT,{}),s.jsx(N,{children:!!e.localization.getText(1)&&s.jsx(T,{center:!0,small:!0,overflow:"auto",children:e.localization.getText(1)})}),s.jsxs(Ye,{children:[s.jsxs(N,{size:5,overflow:"hidden",gap:1,children:[s.jsxs(N,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!e.localization.getImage(1)&&s.jsx("img",{alt:"",className:"flex-grow-1",src:e.localization.getImage(1)}),s.jsx(Pc,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),s.jsx(oB,{position:"absolute",className:"bottom-0 end-0"})]}),s.jsx(N,{gap:1,children:s.jsx(Za,{})})]}),s.jsxs(N,{size:7,overflow:"hidden",children:[!!e.localization.getText(2)&&s.jsx(T,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),s.jsx(N,{grow:!0,overflow:"hidden",className:"grid-bg p-2",children:s.jsx(aB,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]})]})]})},tne=a=>{const{page:e=null}=a,[t,i]=h.useState(-1),[r,n]=h.useState(""),{currentOffer:o=null,currentPage:l=null}=es(),c=u=>{var d;return(d=Oe().soundManager.musicController)==null?void 0:d.playSong(u,Ji.PRIORITY_PURCHASE_PREVIEW,15,0,0,0)};return J(RL,u=>{const d=u.getParser();d.officialSongId===r&&i(d.songId)}),h.useEffect(()=>{if(!o)return;const u=o.product;if(u){if(u.extraParam.length>0){const d=parseInt(u.extraParam);d>0?i(d):(n(u.extraParam),K(new uF(u.extraParam)))}else n(""),i(-1);return()=>{var d;return(d=Oe().soundManager.musicController)==null?void 0:d.stop(Ji.PRIORITY_PURCHASE_PREVIEW)}}},[o]),h.useEffect(()=>()=>{var u;return(u=Oe().soundManager.musicController)==null?void 0:u.stop(Ji.PRIORITY_PURCHASE_PREVIEW)},[]),s.jsxs(s.Fragment,{children:[s.jsxs(N,{className:"position-relative",center:!o,overflow:"hidden",fullHeight:!0,children:[s.jsxs("div",{style:{minHeight:"200px",maxHeight:"200px"},children:[!o&&s.jsx(s.Fragment,{children:!!e.localization.getImage(1)&&s.jsx("img",{className:"catalog-image-column",alt:"",src:e.localization.getImage(1)})}),o&&s.jsxs(s.Fragment,{children:[s.jsxs(q,{position:"relative",children:[s.jsx(uh,{}),s.jsx(PT,{fullWidth:!0,position:"absolute",className:"top-1"}),s.jsx(Pc,{position:"absolute",className:"bg-muted rounded top-1 end-1"})]}),s.jsx(N,{grow:!0,gap:1,children:s.jsx(T,{bold:!0,variant:"white",className:"item-title",grow:!0,truncate:!0,children:o.localizationName})})]})]}),s.jsx(N,{className:"grid-bg p-2",overflow:"hidden",fullWidth:!0,fullHeight:!0,children:s.jsx(xm,{})})]}),!o&&s.jsx(T,{center:!0,className:"grid-bg p-2",variant:"muted",bold:!0,fontSize:6,children:"Escolha um item!"}),o&&s.jsxs(N,{children:[t>-1&&s.jsx(X,{onClick:()=>c(t),children:g("play_preview_button")}),o.bundlePurchaseAllowed&&s.jsx(x,{gap:1,className:"quanity-container",children:s.jsx(Om,{})}),s.jsx(x,{gap:2,className:"purchase-buttons align-items-end",children:s.jsx(Za,{})})]})]})},sne=["floors","walls","views"],ine=a=>{const{columnCount:e=5,children:t=null,...i}=a,[r,n]=h.useState(null),[o,l]=h.useState(-1),[c,u]=h.useState(null),{currentPage:d=null,currentOffer:_=null,setCurrentOffer:m=null,setPurchaseOptions:f=null}=es(),E=h.useRef(),I=S=>{S&&u(R=>{const O=[...R];return O[o]=S,O})};if(h.useEffect(()=>{if(!d)return;const S=[[],[],[]];for(const R of d.offers){if(R.pricingModel!==Zi.PRICING_MODEL_SINGLE&&R.pricingModel!==Zi.PRICING_MODEL_MULTI)continue;const O=R.product;if(!O||O.productType!==dt.WALL&&O.productType!==dt.FLOOR||!O.furnitureData)continue;switch(O.furnitureData.className){case"floor":S[0].push(R);break;case"wallpaper":S[1].push(R);break;case"landscape":S[2].push(R);break}}n(S),l(0),u([S[0][0],S[1][0],S[2][0]])},[d]),h.useEffect(()=>{o===-1||!c||m(c[o])},[o,c,m]),h.useEffect(()=>{o===-1||!c||!_||f(S=>{const R={...S};return R.extraData=c[o].product.extraParam,R.extraParamRequired=!0,R})},[_,o,c,f]),h.useEffect(()=>{E&&E.current&&(E.current.scrollTop=0)},[o]),!r||o===-1)return null;const p=r[o];return s.jsxs(s.Fragment,{children:[s.jsx(Ya,{children:sne.map((S,R)=>s.jsx(X,{active:o===R,onClick:O=>l(R),children:g(`catalog.spaces.tab.${S}`)},R))}),s.jsxs(Os,{innerRef:E,columnCount:e,...i,children:[p&&p.length>0&&p.map((S,R)=>s.jsx(BN,{itemActive:_&&_===S,offer:S,selectOffer:O=>I(O)},R)),t]})]})},rne=a=>{const{page:e=null}=a,{currentOffer:t=null,roomPreviewer:i=null}=es();return h.useEffect(()=>{i.updatePreviewObjectBoundingRectangle(new ei)},[i]),s.jsxs(N,{fullHeight:!0,children:[s.jsxs(N,{center:!t,size:5,overflow:"hidden",fullHeight:!0,children:[!t&&s.jsxs(s.Fragment,{children:[!!e.localization.getImage(1)&&s.jsx("img",{alt:"",src:e.localization.getImage(1)}),s.jsx(T,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),t&&s.jsx(s.Fragment,{children:s.jsxs(q,{position:"relative",overflow:"hidden",children:[s.jsx(uh,{}),s.jsx(T,{bold:!0,variant:"white",className:"item-title",grow:!0,truncate:!0,children:t.localizationName})]})})]}),s.jsx(N,{className:"grid-bg item-picker p-2",size:7,overflow:"hidden",fullHeight:!0,style:{maxHeight:"300px"},children:s.jsx(ine,{})}),s.jsx(x,{gap:1,className:"quanity-container mt-2",children:s.jsx(Om,{})}),s.jsx(x,{gap:2,className:"purchase-buttons align-items-end mt-2",children:s.jsx(Za,{})})]})},nne=a=>{const{page:e=null}=a,[t,i]=h.useState(""),{currentOffer:r=null,setPurchaseOptions:n=null}=es();return h.useEffect(()=>{r&&n(o=>{const l={...o};return l.extraData=t,l})},[r,t,n]),s.jsxs(N,{children:[s.jsx(T,{fontSize:6,center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}}),s.jsxs(N,{overflow:"hidden",fullHeight:!0,children:[s.jsx(N,{className:"grid-bg item-picker p-2",overflow:"hidden",children:s.jsx(xm,{})}),s.jsx("textarea",{maxLength:500,className:"flex-grow-1 form-control w-100 trophy-text p-2",defaultValue:t||"",onChange:o=>i(o.target.value)}),r&&s.jsx(s.Fragment,{children:s.jsxs(N,{grow:!0,gap:1,children:[s.jsx(T,{grow:!0,center:!0,truncate:!0,children:r.localizationName}),s.jsx(x,{justifyContent:"end",children:s.jsx(VN,{alignItems:"end",className:"credits-bg py-1 px-2"})}),s.jsx(x,{gap:2,className:"purchase-buttons align-items-end mt-2",children:s.jsx(Za,{})})]})})]})]})},ane=a=>{const[e,t]=h.useState(null),[i,r]=h.useState(bs.NONE),{currentPage:n=null,catalogOptions:o=null}=es(),{purse:l=null,getCurrencyAmount:c=null}=Qa(),{clubOffers:u=null}=o,d=h.useCallback(S=>{switch(S.type){case Ho.PURCHASE_SUCCESS:r(bs.NONE);return;case yc.PURCHASE_FAILED:r(bs.FAILED);return}},[]);Js(Ho.PURCHASE_SUCCESS,d),Js(yc.PURCHASE_FAILED,d);const _=h.useCallback(S=>{let R="";return S.months>0&&(R=g("catalog.vip.item.header.months",["num_months"],[S.months.toString()])),S.extraDays>0&&(R!==""&&(R+=" "),R+=" "+g("catalog.vip.item.header.days",["num_days"],[S.extraDays.toString()])),R},[]),m=h.useCallback(()=>{if(!l)return"";const S=l.clubDays>0||l.clubPeriods>0?"extension.":"subscription.",R=e.months===0?"days":"months",O=e.months===0?e.extraDays:e.months;return g("catalog.vip.buy.confirm."+S+R).replace("%NUM_"+R.toUpperCase()+"%",O.toString())},[e,l]);h.useCallback(()=>{let S=g("catalog.vip.buy.confirm.end_date");return S=S.replace("%month%",e.month.toString()),S=S.replace("%day%",e.day.toString()),S=S.replace("%year%",e.year.toString()),S},[e]);const f=h.useMemo(()=>{const S=l.clubDays,O=l.clubPeriods*31+S;return g("catalog.vip.extend.info",["days"],[O.toString()])},[l]),E=h.useCallback(()=>{e&&(r(bs.PURCHASE),K(new hT(n.pageId,e.offerId,null,1)))},[e,n]),I=h.useCallback(S=>{r(bs.NONE),t(S)},[]),p=h.useCallback(()=>{if(!e)return null;if(e.priceCredits>c(-1))return s.jsx(X,{fullWidth:!0,variant:"danger",children:g("catalog.alert.notenough.title")});if(e.priceActivityPoints>c(e.priceActivityPointsType))return s.jsx(X,{fullWidth:!0,variant:"danger",children:g("catalog.alert.notenough.activitypoints.title."+e.priceActivityPointsType)});switch(i){case bs.CONFIRM:return s.jsx(X,{variant:"warning",onClick:E,children:g("catalog.marketplace.confirm_title")});case bs.PURCHASE:return s.jsx(X,{variant:"primary",disabled:!0,children:s.jsx(LN,{})});case bs.FAILED:return s.jsx(X,{variant:"danger",disabled:!0,children:g("generic.failed")});case bs.NONE:default:return s.jsx(X,{variant:"success",onClick:()=>r(bs.CONFIRM),children:g("buy")})}},[e,i,E,c]);return h.useEffect(()=>{u||K(new fP(1))},[u]),s.jsxs(N,{fullHeight:!0,children:[s.jsxs(x,{fullHeight:!0,center:!0,overflow:"hidden",children:[n.localization.getImage(1)&&s.jsx("img",{alt:"",src:n.localization.getImage(1)}),s.jsxs(N,{className:"px-2",children:[s.jsx(T,{bold:!0,children:g("catalog.vip.extend.title")}),s.jsx(T,{small:!0,overflow:"auto",dangerouslySetInnerHTML:{__html:f}})]})]}),s.jsxs(N,{fullHeight:!0,size:7,overflow:"hidden",justifyContent:"between",children:[s.jsx(Os,{columnCount:1,className:"nitro-catalog-layout-vip-buy-grid",children:u&&u.length>0&&u.map((S,R)=>s.jsxs(ct,{column:!1,center:!1,alignItems:"center",justifyContent:"between",itemActive:e===S,className:"p-1",onClick:()=>I(S),children:[s.jsx("i",{className:"icon-hc-banner"}),s.jsxs(N,{justifyContent:"end",gap:0,children:[s.jsx(T,{textEnd:!0,children:_(S)}),s.jsxs(x,{justifyContent:"end",gap:1,children:[S.priceCredits>0&&s.jsxs(x,{alignItems:"center",justifyContent:"end",gap:1,children:[s.jsx(T,{children:S.priceCredits}),s.jsx(gs,{type:-1})]}),S.priceActivityPoints>0&&s.jsxs(x,{alignItems:"center",justifyContent:"end",gap:1,children:[s.jsx(T,{children:S.priceActivityPoints}),s.jsx(gs,{type:S.priceActivityPointsType})]})]})]})]},R))}),s.jsx(N,{size:5,overflow:"hidden",children:e&&s.jsx(N,{fullWidth:!0,grow:!0,justifyContent:"end",children:s.jsxs(x,{alignItems:"end",children:[s.jsxs(N,{grow:!0,gap:0,children:[s.jsx(T,{fontWeight:"bold",children:m()}),s.jsxs(x,{gap:1,children:[e.priceCredits>0&&s.jsxs(x,{alignItems:"center",justifyContent:"end",gap:1,children:[s.jsx(T,{children:e.priceCredits}),s.jsx(gs,{type:-1})]}),e.priceActivityPoints>0&&s.jsxs(x,{alignItems:"center",justifyContent:"end",gap:1,children:[s.jsx(T,{children:e.priceActivityPoints}),s.jsx(gs,{type:e.priceActivityPointsType})]})]})]}),p()]})})}),s.jsx(T,{small:!0,center:!0,className:"pb-2",dangerouslySetInnerHTML:{__html:g("catalog.vip.buy.hccenter")}})]})]})},one=a=>{const{text:e=null}=a,[t,i]=h.useState(""),[r,n]=h.useState(!1),{simpleAlert:o=null}=kt(),l=()=>{!t||!t.length||r||(K(new OP(t)),n(!0))};return J(JD,c=>{const u=c.getParser();let d=g("catalog.alert.voucherredeem.ok.description");u.productName&&(d=g("catalog.alert.voucherredeem.ok.description.furni",["productName","productDescription"],[u.productName,u.productDescription])),o(d,null,null,null,g("catalog.alert.voucherredeem.ok.title")),n(!1),i("")}),J(QD,c=>{const u=c.getParser();o(g(`catalog.alert.voucherredeem.error.description.${u.errorCode}`),null,null,null,g("catalog.alert.voucherredeem.error.title")),n(!1)}),s.jsxs(x,{gap:1,children:[s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:e,value:t,onChange:c=>i(c.target.value)}),s.jsx(X,{variant:"primary",onClick:l,disabled:r,children:s.jsx(dV,{className:"fa-icon"})})]})},Fm=a=>{const{item:e=null,position:t="relative",pointer:i=!0,overflow:r="hidden",fullHeight:n=!0,classNames:o=[],children:l=null,...c}=a,u=h.useMemo(()=>{const _=["rounded","nitro-front-page-item"];return o.length&&_.push(...o),_},[o]);if(!e)return null;const d=xe("image.library.url")+e.itemPromoImage;return s.jsxs(MG,{imageUrl:d,classNames:u,position:t,fullHeight:n,pointer:i,overflow:r,...c,children:[s.jsx(T,{position:"absolute",variant:"white",className:"bg-dark rounded p-2 m-2 bottom-0",children:e.itemName}),l]})},lne=a=>{const{page:e=null,hideNavigation:t=null}=a,{frontPageItems:i=[]}=es(),r=h.useCallback(n=>{switch(n.type){case Pg.ITEM_CATALOGUE_PAGE:Ce(`catalog/open/${n.catalogPageLocation}`);return;case Pg.ITEM_PRODUCT_OFFER:Ce(`catalog/open/${n.productOfferId}`);return}},[]);return h.useEffect(()=>{t()},[e,t]),s.jsxs(Ye,{children:[s.jsx(N,{size:4,children:i[0]&&s.jsx(Fm,{item:i[0],onClick:n=>r(i[0])})}),s.jsxs(N,{size:8,children:[i[1]&&s.jsx(Fm,{item:i[1],onClick:n=>r(i[1])}),i[2]&&s.jsx(Fm,{item:i[2],onClick:n=>r(i[2])}),i[3]&&s.jsx(Fm,{item:i[3],onClick:n=>r(i[3])}),s.jsx(one,{text:e.localization.getText(1)})]})]})},QO=1,af=2,lB=a=>{const{offerData:e=null,type:t=af,onClick:i=null,onClick2:r=null}=a,{showConfirm:n=null}=kt(),o=h.useMemo(()=>e?g((e.furniType===2?"wallItem":"roomItem")+`.name.${e.furniId}`):"",[e]),l=h.useMemo(()=>e&&e.timeLeftMinutes<=0,[e]),c=h.useCallback(()=>{if(!e)return"";if(e.status===zg.SOLD)return g("catalog.marketplace.offer.sold");if(e.timeLeftMinutes<=0)return g("catalog.marketplace.offer.expired");const _=Math.max(1,e.timeLeftMinutes),m=Math.floor(_/60);let E=_-m*60+" "+g("catalog.marketplace.offer.minutes");return m>0&&(E=m+" "+g("catalog.marketplace.offer.hours")+" "+E),g("catalog.marketplace.offer.time_left",["time"],[E])},[e]),u=h.useCallback(()=>{K(new qU(0,e.furniId))},[e]),d=()=>{e&&n(g("inventory.marketplace.confirm_offer.info",["furniname","price"],[o,e.price.toString()]),()=>{K(new ZU(e.offerId))},null,null,null,g("inventory.marketplace.confirm_offer.title"))};return s.jsxs(ct,{shrink:!0,center:!1,column:!1,alignItems:"center",className:"p-1",children:[s.jsx(N,{style:{width:40,height:40},children:s.jsx(ct,{column:!1,itemImage:pN(e.furniType===qu.TYPE_FLOOR?dt.FLOOR:dt.WALL,e.furniId,e.extraData),itemUniqueNumber:e.isUniqueLimitedItem?e.stuffData.uniqueNumber:0})}),s.jsxs(N,{grow:!0,gap:0,children:[s.jsx(T,{fontWeight:"bold",children:o}),t===QO&&s.jsxs(s.Fragment,{children:[s.jsx(T,{children:g("catalog.marketplace.offer.price_own_item",["price"],[e.price.toString()])}),s.jsx(T,{children:c()})]}),t===af&&s.jsxs(s.Fragment,{children:[s.jsx(T,{children:g("catalog.marketplace.offer.price_public_item",["price","average","rarePrice"],[e.price.toString(),e.averagePrice>0?e.averagePrice.toString():"-",e.rarePrice>0?e.rarePrice.toString():"-"])}),s.jsx(T,{children:g("catalog.marketplace.offer_count",["count"],[e.offerCount.toString()])})]})]}),s.jsxs(N,{gap:1,children:[t===QO&&e.status!==zg.SOLD&&s.jsxs(s.Fragment,{children:[s.jsx(X,{variant:"secondary",onClick:()=>i(e),children:g("catalog.marketplace.offer.pick")}),l&&s.jsx(X,{variant:"secondary",onClick:d,children:g("inventory.marketplace.make_offer.repost")})]}),t===af&&s.jsxs(s.Fragment,{children:[s.jsx(X,{variant:"secondary",onClick:()=>i(e),children:g("buy")}),s.jsx(X,{variant:"secondary",onClick:()=>{u(),r()},children:g("catalog.marketplace.view_more")})]})]})]})},cne=a=>{const[e,t]=h.useState(0),[i,r]=h.useState([]),{simpleAlert:n=null}=kt();J(I0,u=>{const d=u.getParser();if(!d)return;const _=d.offers.map(m=>{const f=new qu(m.offerId,m.furniId,m.furniType,m.extraData,m.stuffData,m.price,m.status,m.averagePrice,m.offerCount,m.rarePrice);return f.timeLeftMinutes=m.timeLeftMinutes,f});t(d.creditsWaiting),r(_)}),J(g0,u=>{const d=u.getParser();if(d){if(!d.success){n(g("catalog.marketplace.cancel_failed"),lt.DEFAULT,null,null,g("catalog.marketplace.operation_failed.topic"));return}r(_=>_.filter(m=>m.offerId!==d.offerId))}});const o=h.useMemo(()=>i.filter(u=>u.status===zg.SOLD),[i]),l=h.useCallback(()=>{r(u=>{const d=o.map(_=>_.offerId);return u.filter(_=>d.indexOf(_.offerId)===-1)}),K(new JU)},[o]),c=u=>{K(new zU(u.offerId))};return h.useEffect(()=>{K(new $U)},[]),s.jsxs(N,{overflow:"hidden",children:[o.length<=0&&s.jsx(T,{center:!0,className:"bg-muted rounded p-1",children:g("catalog.marketplace.redeem.no_sold_items")}),o.length>0&&s.jsxs(N,{center:!0,gap:1,className:"bg-muted rounded p-2",children:[s.jsx(T,{children:g("catalog.marketplace.redeem.get_credits",["count","credits"],[o.length.toString(),e.toString()])}),s.jsx(X,{className:"mt-1",onClick:l,children:g("catalog.marketplace.offer.redeem")})]}),s.jsxs(N,{gap:1,overflow:"hidden",children:[s.jsx(T,{truncate:!0,shrink:!0,fontWeight:"bold",children:g("catalog.marketplace.items_found",["count"],[i.length.toString()])}),s.jsx(N,{overflow:"auto",className:"nitro-catalog-layout-marketplace-grid",children:i.length>0&&i.map(u=>s.jsx(lB,{offerData:u,type:QO,onClick:c,onClick2:null},u.offerId))})]})]})},une=a=>{const{searchType:e=null,sortTypes:t=null,onSearch:i=null}=a,[r,n]=h.useState(t?t[0]:3),[o,l]=h.useState(""),[c,u]=h.useState(0),[d,_]=h.useState(0),m=h.useCallback(E=>{n(E),(e===hr.BY_ACTIVITY||e===hr.BY_VALUE)&&i({minPrice:-1,maxPrice:-1,query:"",type:E})},[i,e]),f=h.useCallback(()=>{const E=c>0?c:-1,I=d>0?d:-1;i({minPrice:E,maxPrice:I,type:r,query:o})},[d,c,i,o,r]);return h.useEffect(()=>{if(!t||!t.length)return;const E=t[0];n(E),(e===hr.BY_ACTIVITY||hr.BY_VALUE===e)&&i({minPrice:-1,maxPrice:-1,query:"",type:E})},[i,e,t]),s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{className:"col-3",children:g("catalog.marketplace.sort_order")}),s.jsx("select",{className:"form-select form-select-sm",value:r,onChange:E=>m(parseInt(E.target.value)),children:t.map(E=>s.jsx("option",{value:E,children:g(`catalog.marketplace.sort.${E}`)},E))})]}),e===hr.ADVANCED&&s.jsxs(s.Fragment,{children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{className:"col-3",children:g("catalog.marketplace.search_name")}),s.jsx("input",{className:"form-control form-control-sm",type:"text",value:o,onChange:E=>l(E.target.value)})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{className:"col-3",children:g("catalog.marketplace.search_price")}),s.jsxs(x,{fullWidth:!0,gap:1,children:[s.jsx("input",{className:"form-control form-control-sm",type:"number",min:0,value:c,onChange:E=>u(E.target.valueAsNumber)}),s.jsx("input",{className:"form-control form-control-sm",type:"number",min:0,value:d,onChange:E=>_(E.target.valueAsNumber)})]})]}),s.jsx(X,{variant:"secondary",className:"mx-auto",onClick:f,children:g("generic.search")})]})]})},hne=a=>{const{onClick:e=null,offerData:t=null,itemStats:i=null}=a,[r,n]=h.useState(0),o=h.useMemo(()=>t?g((t.furniType===2?"wallItem":"roomItem")+`.name.${t.furniId}`):"",[t]);return s.jsxs(s.Fragment,{children:[s.jsx(X,{variant:"secondary",size:"sm",onClick:()=>e(),children:g("catalog.marketplace.iteminfo.go_back")}),s.jsxs(N,{column:!1,children:[s.jsx(x,{style:{width:60,height:60,background:"white",borderRadius:5},center:!0,children:s.jsx("div",{style:{width:30,height:30,backgroundImage:`url(${pN(t.furniType===qu.TYPE_FLOOR?dt.FLOOR:dt.WALL,t.furniId,t.extraData)})`,backgroundRepeat:"no-repeat",backgroundSize:"contain",backgroundPosition:"center"}})}),s.jsxs(x,{column:!0,children:[s.jsx(T,{bold:!0,style:{marginBottom:5},children:o}),s.jsxs(T,{children:["Número de Ofertas: ",i.offerCount," "]}),s.jsxs(x,{gap:2,alignItems:"center",style:{marginBottom:-5},children:[s.jsx(T,{children:"Preço mais baixo:"}),s.jsxs(x,{gap:1,center:!0,children:[s.jsx(T,{children:t.price}),s.jsx("i",{style:{width:15,backgroundSize:"contain",backgroundRepeat:"no-repeat"},className:"icon icon-diamante"})]})]}),s.jsxs(x,{gap:2,center:!0,children:[s.jsx(T,{children:"Preço médio nos últimos 7 dias:"}),s.jsxs(x,{gap:1,center:!0,children:[s.jsx(T,{children:i.averagePrice}),s.jsx("i",{style:{width:15,backgroundSize:"contain",backgroundRepeat:"no-repeat"},className:"icon icon-diamante"})]})]})]})]}),s.jsxs(Ya,{children:[s.jsx(X,{active:r===0,onClick:()=>n(0),children:g("catalog.marketplace.iteminfo.priceevolution")}),s.jsx(X,{active:r===1,onClick:()=>n(1),children:g("catalog.marketplace.iteminfo.tradevolume")})]}),r===0&&s.jsxs(s.Fragment,{children:[s.jsxs(T,{children:["Preço médio de vendas nos últimos ",i.historyLength," dias"]}),s.jsxs(FA,{width:340,height:240,data:i.averagePrices.map(l=>({valor:l})),children:[s.jsx(kA,{}),s.jsx(GA,{stroke:"#eee",strokeDasharray:"5 5"}),s.jsx(BA,{}),s.jsx(VA,{type:"monotone",dataKey:"valor",stroke:"#8884d8"})]})]}),r===1&&s.jsxs(s.Fragment,{children:[s.jsxs(T,{children:["Volume de negócios nos últimos ",i.historyLength," dias"]}),s.jsxs(FA,{width:340,height:240,data:i.soldAmounts.map(l=>({quantidade:l})),children:[s.jsx(kA,{}),s.jsx(GA,{stroke:"#eee",strokeDasharray:"5 5"}),s.jsx(BA,{}),s.jsx(VA,{type:"monotone",dataKey:"quantidade",stroke:"#8884d8"})]})]})]})},dne=[1,2],_ne=[3,4,5,6],gne=[1,2,3,4,5,6],mne=a=>{const[e,t]=h.useState(hr.BY_ACTIVITY),[i,r]=h.useState(0),[n,o]=h.useState(new Map),[l,c]=h.useState({minPrice:-1,maxPrice:-1,query:"",type:3}),{getCurrencyAmount:u=null}=Qa(),{simpleAlert:d=null,showConfirm:_=null,showMarketPlaceAlert:m=null}=kt(),[f,E]=h.useState(!1),[I,p]=h.useState(null),[S,R]=h.useState(null),O=h.useCallback(b=>{c(b),K(new XU(b.minPrice,b.maxPrice,b.query,b.type))},[]),C=h.useMemo(()=>{switch(e){case hr.BY_ACTIVITY:return _ne;case hr.BY_VALUE:return dne;case hr.ADVANCED:return gne}return[]},[e]),A=h.useCallback(b=>{if(b.price>u(-1)){d(g("catalog.alert.notenough.credits.description"),lt.DEFAULT,null,null,g("catalog.alert.notenough.title"));return}const y=b.offerId;m(b,g("catalog.marketplace.confirm_header"),()=>{K(new Sx(y))},null)},[u,d,m]);return J(E0,b=>{const y=b.getParser();if(!y)return;const M=new Map;y.offers.forEach(U=>{const G=new qu(U.offerId,U.furniId,U.furniType,U.extraData,U.stuffData,U.price,U.status,U.averagePrice,U.offerCount,U.rarePrice);G.timeLeftMinutes=U.timeLeftMinutes,M.set(U.offerId,G)}),r(y.totalItemsFound),o(M)}),J(f0,b=>{E(!0),p(b.getParser())}),J(_0,b=>{const y=b.getParser();if(y)switch(y.result){case 1:O(l);break;case 2:o(M=>{const U=new Map(M);return U.delete(y.requestedOfferId),U}),d(g("catalog.marketplace.not_available_header"),lt.DEFAULT,null,null,g("catalog.marketplace.not_available_title"));break;case 3:o(M=>{const U=new Map(M),G=U.get(y.requestedOfferId);return G&&(G.offerId=y.offerId,G.price=y.newPrice,G.offerCount--,U.set(G.offerId,G)),U.delete(y.requestedOfferId),U}),_(g("catalog.marketplace.confirm_higher_header")+`
`+g("catalog.marketplace.confirm_price",["price"],[y.newPrice.toString()]),()=>{K(new Sx(y.offerId))},null,null,null,g("catalog.marketplace.confirm_higher_title"));break;case 4:d(g("catalog.alert.notenough.credits.description"),lt.DEFAULT,null,null,g("catalog.alert.notenough.title"));break}}),s.jsxs(s.Fragment,{children:[f&&s.jsx(hne,{offerData:S,itemStats:I,onClick:()=>{E(!1),R(null),p(null)}}),!f&&s.jsxs(s.Fragment,{children:[s.jsxs(Ya,{children:[s.jsx(X,{active:e===hr.BY_ACTIVITY,onClick:()=>t(hr.BY_ACTIVITY),children:g("catalog.marketplace.search_by_activity")}),s.jsx(X,{active:e===hr.BY_VALUE,onClick:()=>t(hr.BY_VALUE),children:g("catalog.marketplace.search_by_value")}),s.jsx(X,{active:e===hr.ADVANCED,onClick:()=>t(hr.ADVANCED),children:g("catalog.marketplace.search_advanced")})]}),s.jsx(une,{sortTypes:C,searchType:e,onSearch:O}),s.jsxs(N,{gap:1,overflow:"hidden",children:[s.jsx(T,{truncate:!0,shrink:!0,fontWeight:"bold",children:g("catalog.marketplace.items_found",["count"],[n.size.toString()])}),s.jsx(N,{className:"nitro-catalog-layout-marketplace-grid",overflow:"auto",children:Array.from(n.values()).map((b,y)=>s.jsx(lB,{offerData:b,type:af,onClick:A,onClick2:()=>R(b)},y))})]})]})]})},fne=a=>{const{page:e=null}=a,[t,i]=h.useState(-1),[r,n]=h.useState([]),[o,l]=h.useState(-1),[c,u]=h.useState([]),[d,_]=h.useState(-1),[m,f]=h.useState(!1),[E,I]=h.useState("");h.useState(!0);const[p,S]=h.useState(-1),{currentOffer:R=null,setCurrentOffer:O=null,setPurchaseOptions:C=null,catalogOptions:A=null,roomPreviewer:b=null}=es(),{petPalettes:y=null}=A,M=h.useMemo(()=>!c.length||d===-1?16777215:c[d][0],[c,d]),U=h.useMemo(()=>t===-1||!r.length||o===-1?"":g(`pet.breed.${t}.${r[o].breedId}`),[t,r,o]),G=h.useMemo(()=>{if(!r.length||o===-1)return"";const v=r[o].paletteId;let B=16777215;if(t<=7){if(d===-1)return"";B=c[d][0]}let z=B.toString(16).toUpperCase();for(;z.length<6;)z="0"+z;return`${v}
${z}`},[r,o,t,c,d]),F=h.useMemo(()=>{let v="";switch(p){case 1:v="catalog.alert.petname.long";break;case 2:v="catalog.alert.petname.short";break;case 3:v="catalog.alert.petname.chars";break;case 4:v="catalog.alert.petname.bobba";break}return!v||!v.length?"":g(v)},[p]),H=h.useCallback(()=>{if(p===-1){K(new fF(E,1));return}if(p===0){K(new hT(e.pageId,R.offerId,`${E}
${G}`,1));return}},[e,R,E,G,p]);return J(DL,v=>{const B=v.getParser();S(B.result),B.result===0?H():_i(new yc(-1))}),h.useEffect(()=>{if(!e||!e.offers.length)return;const v=e.offers[0];O(v),i(SQ(v.localizationId)),f(!1)},[e,O]),h.useEffect(()=>{if(!R)return;const v=R.product.productData;if(v){if(y)for(const B of y){if(B.breed!==v.type)continue;const z=[];for(const $ of B.palettes)$.sellable&&z.push($);l(z.length?0:-1),n(z);return}l(-1),n([]),K(new TP(v.type))}},[R,y]),h.useEffect(()=>{if(t===-1)return;const v=RQ(t,r);_(v.length?0:-1),u(v)},[t,r]),h.useEffect(()=>{if(!b||(b.reset(!1),t===-1||!r.length||o===-1))return;let v=`${t} ${r[o].paletteId}`;t<=7&&(v+=` ${M.toString(16)}`),b.addPetIntoRoom(v)},[b,t,r,o,M]),h.useEffect(()=>{S(-1)},[E]),R?s.jsx(N,{children:s.jsxs(N,{center:!R,size:5,overflow:"hidden",children:[!R&&s.jsxs(s.Fragment,{children:[!!e.localization.getImage(1)&&s.jsx("img",{alt:"",src:e.localization.getImage(1)}),s.jsx(T,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),R&&s.jsxs(s.Fragment,{children:[s.jsxs(q,{position:"relative",overflow:"hidden",children:[s.jsx(uh,{}),s.jsx(VN,{className:"credits-default-layout credits-bg py-1 px-2 bottom-1 end-1",justifyContent:"end",alignItems:"end"}),s.jsx(Pc,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),t>-1&&t<=7&&s.jsx(X,{position:"absolute",className:"bottom-1 start-1",onClick:v=>f(!m),children:s.jsx(Yy,{className:"fa-icon"})})]}),s.jsx(N,{size:7,overflow:"hidden",children:s.jsxs(Os,{className:"grid-bg group-furni-picker p-2",columnCount:7,children:[!m&&r.length>0&&r.map((v,B)=>s.jsx(ct,{itemActive:o===B,onClick:z=>l(B),children:s.jsx(Fn,{typeId:t,paletteId:v.paletteId,direction:2,headOnly:!0})},B)),m&&c.length>0&&c.map((v,B)=>s.jsx(ct,{itemHighlight:!0,itemActive:d===B,itemColor:Ri.int2rgb(v[0]),className:"clear-bg",onClick:z=>_(B)},B))]})}),s.jsxs(N,{grow:!0,gap:1,children:[s.jsx(T,{truncate:!0,children:U}),s.jsxs(N,{grow:!0,gap:1,children:[s.jsx("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:g("widgets.petpackage.name.title"),value:E,onChange:v=>I(v.target.value)}),p>0&&s.jsx(q,{className:"invalid-feedback d-block m-0",children:F})]}),s.jsx(x,{gap:2,className:"purchase-buttons align-items-end mt-2",children:s.jsx(Za,{purchaseCallback:H})})]})]})]})}):null},pne=a=>{const{offer:e=null,isAvailable:t=!1,daysRequired:i=0,onSelect:r=null}=a,n=h.useCallback(()=>{if(!e||!e.products.length)return"";const l=e.products[0];return rf.getProductImageUrl(l.productType,l.furniClassId,l.extraParam)},[e]),o=h.useCallback(()=>{if(!e||!e.products.length)return"";const l=e.products[0],c=rf.getProductCategory(l.productType,l.furniClassId)===2?"wallItem.name."+l.furniClassId:"roomItem.name."+l.furniClassId;return g(c)},[e]);return h.useCallback(()=>{if(!e||!e.products.length)return"";const l=e.products[0],c=rf.getProductCategory(l.productType,l.furniClassId)===2?"wallItem.desc."+l.furniClassId:"roomItem.desc."+l.furniClassId;return g(c)},[e]),h.useCallback(()=>Math.floor(i/31),[i]),s.jsxs(ct,{center:!1,column:!1,alignItems:"center",className:"p-1",children:[s.jsx(Lc,{imageUrl:n()}),s.jsx(T,{grow:!0,fontWeight:"bold",children:o()}),s.jsx(X,{variant:"secondary",onClick:()=>r(e.localizationId),disabled:!t,children:g("catalog.club_gift.select")})]})},Ene=a=>{const{purse:e=null}=Qa(),{catalogOptions:t=null,setCatalogOptions:i=null}=es(),{clubGifts:r=null}=t,{showConfirm:n=null}=kt(),o=h.useCallback(()=>r?r.giftsAvailable>0?g("catalog.club_gift.available",["amount"],[r.giftsAvailable.toString()]):r.daysUntilNextGift>0?g("catalog.club_gift.days_until_next",["days"],[r.daysUntilNextGift.toString()]):e.isVip?g("catalog.club_gift.not_available"):g("catalog.club_gift.no_club"):"",[r,e]),l=h.useCallback(u=>{n(g("catalog.club_gift.confirm"),()=>{K(new CP(u)),i(d=>(d.clubGifts.giftsAvailable--,{...d}))},null)},[i,n]),c=h.useMemo(()=>r.offers.sort((d,_)=>r.getOfferExtraData(d.offerId).daysRequired-r.getOfferExtraData(_.offerId).daysRequired),[r]);return s.jsxs(s.Fragment,{children:[s.jsx(T,{truncate:!0,shrink:!0,fontWeight:"bold",children:o()}),s.jsx(Os,{columnCount:1,className:"nitro-catalog-layout-vip-gifts-grid",children:r.offers.length>0&&c.map(u=>s.jsx(pne,{offer:u,isAvailable:r.getOfferExtraData(u.offerId).isSelectable&&r.giftsAvailable>0,onSelect:l,daysRequired:r.getOfferExtraData(u.offerId).daysRequired},u.offerId))})]})},Ine=(a,e)=>{if(!a)return null;const t={page:a,hideNavigation:e};switch(a.layoutCode){case"frontpage_featured":return null;case"frontpage4":return s.jsx(lne,{...t});case"pets":return s.jsx(fne,{...t});case"pets2":return s.jsx(Qre,{...t});case"pets3":return s.jsx(nB,{...t});case"vip_buy":return s.jsx(ane,{...t});case"guild_frontpage":return s.jsx(Xre,{...t});case"guild_forum":return s.jsx(qre,{...t});case"guild_custom_furni":return s.jsx(Kre,{...t});case"club_gifts":return s.jsx(Ene,{...t});case"marketplace_own_items":return s.jsx(cne,{...t});case"marketplace":return s.jsx(mne,{...t});case"single_bundle":return s.jsx(ene,{...t});case"room_bundle":return s.jsx(Zre,{...t});case"spaces_new":return s.jsx(rne,{...t});case"trophies":return s.jsx(nne,{...t});case"info_loyalty":return s.jsx($re,{...t});case"badge_display":return s.jsx(Hre,{...t});case"roomads":return s.jsx(Jre,{...t});case"default_3x3_color_grouping":return s.jsx(Yre,{...t});case"soundmachine":return s.jsx(tne,{...t});case"bots":case"default_3x3":default:return s.jsx(zre,{...t})}},Tne=a=>{const[e,t]=h.useState(null),[i,r]=h.useState(0),[n,o]=h.useState("0"),{catalogOptions:l=null,setCatalogOptions:c=null}=es(),{marketplaceConfiguration:u=null}=l,{showConfirm:d=null}=kt(),_=p=>{o(p);const S=parseInt(p);isNaN(S)||S===i||r(parseInt(p))};if(J(m0,p=>{const S=p.getParser();c(R=>{const O={...R};return O.marketplaceConfiguration=S,O})}),Js(kp.POST_MARKETPLACE,p=>t(p.item)),h.useEffect(()=>{!e||u||K(new KU)},[e,u]),h.useEffect(()=>{if(e)return()=>r(0)},[e]),!u||!e)return null;const m=e?g(e.isWallItem?"wallItem.name."+e.type:"roomItem.name."+e.type):"",f=e?g(e.isWallItem?"wallItem.desc."+e.type:"roomItem.desc."+e.type):"",E=()=>Math.max(Math.ceil(u.commission*.01*i),1),I=()=>{!e||i<u.minimumPrice||d(g("inventory.marketplace.confirm_offer.info",["furniname","price"],[m,i.toString()]),()=>{K(new QU(i,e.isWallItem?2:1,e.id)),t(null)},()=>{t(null)},null,null,g("inventory.marketplace.confirm_offer.title"))};return s.jsxs(ve,{className:"nitro-catalog-layout-marketplace-post-offer",theme:"primary-slim",children:[s.jsx(je,{headerText:g("inventory.marketplace.make_offer.title"),onCloseClick:p=>t(null)}),s.jsx(be,{overflow:"hidden",children:s.jsxs(Ye,{fullHeight:!0,children:[s.jsx(N,{center:!0,className:"bg-muted rounded p-2",size:4,overflow:"hidden",children:s.jsx(xT,{productType:e.isWallItem?dt.WALL:dt.FLOOR,productClassId:e.type,extraData:e.extra.toString()})}),s.jsxs(N,{size:8,justifyContent:"between",overflow:"hidden",children:[s.jsxs(N,{grow:!0,gap:1,children:[s.jsx(T,{fontWeight:"bold",children:m}),s.jsx(T,{truncate:!0,shrink:!0,children:f})]}),s.jsxs(N,{overflow:"auto",children:[s.jsx(T,{italics:!0,children:g("inventory.marketplace.make_offer.expiration_info",["time"],[u.offerTime.toString()])}),s.jsxs("div",{className:"input-group has-validation",children:[s.jsx("input",{className:"form-control form-control-sm",type:"number",min:0,value:n,onChange:p=>_(p.target.value),placeholder:g("inventory.marketplace.make_offer.price_request")}),(i<u.minimumPrice||isNaN(i))&&s.jsx(q,{className:"invalid-feedback d-block",children:g("inventory.marketplace.make_offer.min_price",["minprice"],[u.minimumPrice.toString()])}),(i>u.maximumPrice||isNaN(i))&&s.jsx(q,{className:"invalid-feedback d-block",children:g("inventory.marketplace.make_offer.max_price",["maxprice"],[u.maximumPrice.toString()])}),!(i<u.minimumPrice||i>u.maximumPrice||isNaN(i))&&s.jsx(q,{className:"invalid-feedback d-block",children:g("inventory.marketplace.make_offer.final_price",["commission","finalprice"],[E().toString(),(i+E()).toString()])})]}),s.jsx(X,{disabled:i<u.minimumPrice||i>u.maximumPrice||isNaN(i),onClick:I,children:g("inventory.marketplace.make_offer.post")})]})]})]})})]})},Sne=a=>{const{currentPage:e=null,activateNode:t=null,rootNode:i=null,getNodeById:r=null}=es();return s.jsx(s.Fragment,{children:s.jsxs(x,{className:"catalog-header",children:[s.jsxs(N,{gap:0,className:"catalog-header-content",children:[e&&i&&s.jsx(GN,{icon:r(e.pageId,i).iconId}),e&&i&&s.jsx(T,{variant:"white",bold:!0,className:"catalog-header-title h-100",children:r(e.pageId,i).localization}),s.jsx(T,{variant:"white",className:"catalog-header-desc",dangerouslySetInnerHTML:{__html:e&&e.localization.getText(0)}})]}),s.jsx(x,{className:"catalog-header-image",style:{backgroundImage:`url(${e&&e.localization.getImage(0)})`}})]})})},Rne=a=>{const{isVisible:e=!1,setIsVisible:t=null,rootNode:i=null,currentPage:r=null,navigationHidden:n=!1,setNavigationHidden:o=null,activeNodes:l=[],searchResult:c=null,setSearchResult:u=null,openPageByName:d=null,openPageByOfferId:_=null,activateNode:m=null,getNodeById:f}=es();return h.useEffect(()=>{const E={linkReceived:I=>{const p=I.split("/");if(!(p.length<2))switch(p[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(S=>!S);return;case"open":if(p.length>2)if(p.length===4)switch(p[2]){case"offerId":_(parseInt(p[3]));return}else d(p[2]);else t(!0);return}},eventUrlPrefix:"catalog/"};return fs(E),()=>ps(E)},[t,_,d]),s.jsxs(s.Fragment,{children:[e&&s.jsxs(ve,{uniqueKey:"catalog",className:"nitro-catalog",style:xe("catalog.headers")?{width:710}:{},children:[s.jsx(je,{headerText:g("catalog.title"),onCloseClick:E=>t(!1)}),s.jsx($n,{children:i&&i.children.length>0&&i.children.map(E=>E.isVisible?s.jsx(In,{isActive:E.isActive,onClick:I=>{c&&u(null),m(E)},children:s.jsxs(x,{gap:xe("catalog.tab.icons")?1:0,alignItems:"center",children:[xe("catalog.tab.icons")&&s.jsx(GN,{icon:E.iconId}),E.localization]})},E.pageId):null)}),s.jsx(Sne,{node:i}),s.jsx(be,{children:s.jsxs(Ye,{children:[!n&&s.jsx(N,{size:4,overflow:"hidden",children:l&&l.length>0&&s.jsx(Fre,{node:l[0]})}),s.jsx(N,{size:n?12:8,overflow:"hidden",children:Ine(r,()=>o(!0))})]})})]}),s.jsx(Ure,{}),s.jsx(Tne,{})]})},HN=({src:a,showGifs:e})=>{const[t,i]=h.useState(!1),r=n=>{n.stopPropagation(),n.preventDefault(),i(!t)};return!e&&!t?s.jsx(x,{className:"nitro-gif",style:{display:"flex",gap:"2px",alignItems:"center"},onClick:r,children:s.jsxs(T,{bold:!0,pointer:!0,variant:"none",style:{backgroundColor:"#ffb901",paddingInline:"2px 4px",paddingBlock:"2px",borderRadius:"5px",border:"1px solid #cf9600",color:"#594614"},children:[s.jsx("img",{src:"https://i.imgur.com/Ri4zzgp.png",alt:"GIF ocultado"})," GIF ocultado. Clique para exibir."]})}):s.jsx("div",{className:"nitro-gif",children:s.jsx("img",{alt:"gif",src:a,style:{maxHeight:"125px",maxWidth:"125px",objectFit:"cover"}})})},WN=({src:a})=>{const e=h.useRef(null),t=h.useRef(null),[i,r]=h.useState(!1),[n,o]=h.useState(0),[l,c]=h.useState(0),[u,d]=h.useState(0),{audioSpeed:_=1,updateAudioSpeed:m=null}=Ja(),f=O=>{if(O.stopPropagation(),O.preventDefault(),_==2){m(1),e.current.playbackRate=1;return}m(_+.5),e.current.playbackRate=_+.5};h.useEffect(()=>{const O=e.current,C=()=>{if(O){const b=O.currentTime,y=O.duration,M=b/y*100;c(b),d(y),o(M)}},A=b=>{(O.duration===1/0||isNaN(Number(O.duration)))&&(O.currentTime=1e101,O.addEventListener("timeupdate",E))};if(O)return O.addEventListener("timeupdate",C),O.addEventListener("loadedmetadata",A),()=>{O.removeEventListener("timeupdate",C),O.removeEventListener("loadedmetadata",A)}},[a]);function E(O){O.target.currentTime=0,O.target.removeEventListener("timeupdate",E),d(O.target.duration)}const I=O=>{const C=Math.floor(O/60),A=Math.floor(O%60);return`${String(C).padStart(2,"0")}:${String(A).padStart(2,"0")}`},p=O=>{O.stopPropagation(),O.preventDefault(),e.current.playbackRate=_,i?e.current.pause():e.current.play(),r(!i)},S=()=>{r(!1),e.current.playbackRate=1,e.current.currentTime=0},R=O=>{O.stopPropagation(),O.preventDefault();const C=t.current.clientWidth,A=O.nativeEvent.offsetX,b=e.current.duration;e.current.currentTime=A/C*b};return s.jsxs(x,{justifyContent:"center",alignItems:"center",className:"nitro-audio",gap:2,children:[s.jsx("img",{src:"https://i.imgur.com/0N2c1J6.png",style:{position:"absolute",top:"-14px",right:"-14px"}}),s.jsx("audio",{ref:e,src:a,onEnded:S}),s.jsx("div",{className:"control",onClick:p,children:i?s.jsx("i",{className:"fa-solid fa-pause"}):s.jsx("i",{className:"fa-solid fa-play"})}),s.jsx("div",{className:"progress-bar",ref:t,onClick:R,children:s.jsx("div",{className:"progress",style:{width:`${n}%`}})}),s.jsx("div",{className:"current-time",children:I(i?l:u)}),s.jsxs("div",{className:"speed",onClick:f,children:[_,"x"]})]})},xne=()=>{const[a,e]=h.useState(!1),[t,i]=h.useState(!1),[r,n]=h.useState(!1),[o,l]=h.useState(!1),[c,u]=h.useState(!1),[d,_]=h.useState(!1),[m,f]=h.useState(""),{chatHistory:E=[]}=bT(),{settingFontSize:I,showGifs:p}=Ea(),[S,R]=h.useState([]),[O,C]=h.useState([]),[A,b]=h.useState(!1),y=h.useRef(null),[M,U]=h.useState(""),G=h.useMemo(()=>{const v=[...new Set(E.filter(B=>B.type===Ar.TYPE_CHAT).map(B=>B.name))];return M?v.filter(B=>B.toLowerCase().includes(M.toLowerCase())):v},[E,M]);h.useEffect(()=>{const v=B=>{y.current&&!y.current.contains(B.target)&&b(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const F=h.useMemo(()=>{C([...new Set(E.filter(B=>B.type===Ar.TYPE_CHAT).map(B=>B.name))]);let v=E;if(S.length&&(v=v.filter(B=>S.includes(B.name))),r&&(v=v.filter(B=>B.chatType===1)),o&&(v=v.filter(B=>B.type===Ar.TYPE_CHAT&&Va(B.message))),c&&(v=v.filter(B=>B.type===Ar.TYPE_CHAT&&Va(B.message,"gif"))),m.length>0){const B=m.toLowerCase();v=v.filter(z=>z.message&&z.message.toLowerCase().includes(B)||z.name&&z.name.toLowerCase().includes(B))}return v},[E,m,r,S,c,o]);h.useEffect(()=>{if(!E.length)return;const v=setTimeout(()=>{C([...new Set(E.filter(B=>B.type===Ar.TYPE_CHAT).map(B=>B.name))])},100);return()=>clearTimeout(v)},[E]);const H=v=>{R(B=>B.includes(v)?B.filter(z=>z!==v):[...B,v])};return h.useEffect(()=>{const v={linkReceived:B=>{const z=B.split("/");if(!(z.length<2))switch(z[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e($=>!$);return}},eventUrlPrefix:"chat-history/"};return fs(v),()=>ps(v)},[]),a?s.jsxs(ve,{uniqueKey:"chat-history",className:"nitro-chat-history",theme:"primary-slim",children:[s.jsx(je,{headerText:g("room.chathistory.button.text"),onCloseClick:v=>e(!1)}),s.jsxs(be,{overflow:"hidden",gap:2,children:[s.jsxs(x,{gap:2,className:"z-2>",children:[s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("generic.search"),value:m,onChange:v=>f(v.target.value)}),s.jsxs("div",{className:"position-relative",style:{minWidth:"150px"},children:[s.jsx(x,{alignItems:"center",justifyContent:"between",pointer:!0,className:"form-control form-control-sm",onClick:()=>b(!A),children:s.jsx(T,{children:S.length>0?`${S.length} usuário(s) selecionado(s)`:"Selecione usuários..."})}),A&&s.jsxs(N,{gap:0,fullWidth:!0,overflow:"auto",className:"position-absolute bg-white border border-dark rounded p-2 mt-1",style:{maxHeight:"300px",zIndex:9999},children:[s.jsx("input",{type:"text",placeholder:"Buscar usuário...",className:"form-control form-control-sm mb-2",onChange:v=>U(v.target.value)}),s.jsx(N,{gap:0,style:{maxHeight:"150px",overflowY:"auto"},children:G.map(v=>s.jsxs(x,{alignItems:"center",className:"p-1 rounded",gap:1,children:[s.jsx("input",{type:"checkbox",className:"mr-2 form-check-input",style:{width:"16px",height:"16px"},onClick:()=>H(v),checked:S.includes(v)}),s.jsx(T,{truncate:!0,dangerouslySetInnerHTML:{__html:v}})]},v))}),s.jsxs("div",{className:"d-flex justify-content-between mt-2",children:[s.jsx(X,{variant:"light",onClick:()=>R([]),children:"Limpar"}),s.jsx(X,{onClick:()=>b(!1),children:"Aplicar"})]})]})]}),s.jsx(X,{alignItems:"center",justifyContent:"center",onClick:()=>Ce("mention-history/toggle"),title:"Menções",children:s.jsx("svg",{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",className:"fa-icon",height:"1em",width:"1em",children:s.jsx("path",{d:"M256 64C150 64 64 150 64 256s86 192 192 192c17.7 0 32 14.3 32 32s-14.3 32-32 32C114.6 512 0 397.4 0 256S114.6 0 256 0S512 114.6 512 256l0 32c0 53-43 96-96 96c-29.3 0-55.6-13.2-73.2-33.9C320 371.1 289.5 384 256 384c-70.7 0-128-57.3-128-128s57.3-128 128-128c27.9 0 53.7 8.9 74.7 24.1c5.7-5 13.1-8.1 21.3-8.1c17.7 0 32 14.3 32 32l0 80 0 32c0 17.7 14.3 32 32 32s32-14.3 32-32l0-32c0-106-86-192-192-192zm64 192a64 64 0 1 0 -128 0 64 64 0 1 0 128 0z"})})}),s.jsx(X,{alignItems:"center",justifyContent:"center",onClick:()=>_(!d),title:"Configurações",children:s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 512 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"})})})]}),s.jsx(Wd,{rows:F,scrollToBottom:!t,placement:"bottom",rowRender:v=>s.jsxs(x,{alignItems:"center",className:"p-1",gap:2,children:[s.jsx(T,{variant:"muted",children:v.timestamp}),v.type===Ar.TYPE_CHAT&&s.jsxs("div",{className:"bubble-container",style:{position:"relative"},children:[v.style===0&&s.jsx("div",{className:"user-container-bg",style:{backgroundColor:v.color}}),s.jsxs("div",{className:`chat-bubble bubble-${v.style} type-${v.chatType}`,style:{maxWidth:"100%",fontSize:`${I}em`},children:[s.jsx("div",{className:"user-container",children:v.imageUrl&&v.imageUrl.length>0&&s.jsx("div",{className:"user-image",style:{backgroundImage:`url(${v.imageUrl})`}})}),s.jsxs("div",{className:"chat-content",children:[s.jsx("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${v.name}: `}}),Va(v.message)?s.jsx(WN,{src:v.message}):Va(v.message,"gif")?s.jsx(HN,{src:v.message,showGifs:p}):s.jsx("span",{className:"message",dangerouslySetInnerHTML:{__html:v.message}})]})]})]}),v.type===Ar.TYPE_ROOM_INFO&&s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"icon icon-small-room"}),s.jsx(T,{textBreak:!0,wrap:!0,grow:!0,children:v.name})]})]},v.id+"")})]}),d&&s.jsxs(ve,{uniqueKey:"chat-history-settings",className:"nitro-chat-history-settings",theme:"primary-slim",children:[s.jsx(je,{headerText:"Configurações",onCloseClick:v=>_(!1)}),s.jsx(be,{children:s.jsxs(N,{gap:2,fullHeight:!0,fullWidth:!0,children:[s.jsxs(x,{gap:1,children:[s.jsx("input",{type:"checkbox",checked:t,onChange:v=>i(v.target.checked),className:"form-check-input"}),s.jsx(T,{children:"Pausar histórico"})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{type:"checkbox",checked:r,onChange:v=>n(v.target.checked),className:"form-check-input"}),s.jsx(T,{children:"Ver apenas sussurros"})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{type:"checkbox",checked:c,onChange:v=>u(v.target.checked),className:"form-check-input"}),s.jsx(T,{children:"Ver apenas GIFs"})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{type:"checkbox",checked:o,onChange:v=>l(v.target.checked),className:"form-check-input"}),s.jsx(T,{children:"Ver apenas áudios"})]})]})})]})]}):null},fn=32,qo=100,E_="x0123456789abcdefghijklmnopq",oc=class oc{};oc.DOOR=0,oc.UP=1,oc.DOWN=2,oc.SET=3,oc.UNSET=4,oc.DROPPER=5;let Bt=oc;const One={x:"101010",0:"0065ff",1:"0091ff",2:"00bcff",3:"00e8ff",4:"00ffea",5:"00ffbf",6:"00ff93",7:"00ff68",8:"00ff3d",9:"19ff00",a:"44ff00",b:"70ff00",c:"9bff00",d:"f2ff00",e:"ffe000",f:"ffb500",g:"ff8900",h:"ff5e00",i:"ff3200",j:"ff0700",k:"ff0023",l:"ff007a",m:"ff00a5",n:"ff00d1",o:"ff00fc",p:"d600ff",q:"aa00ff"};class cB{constructor(){this._currentAction=Bt.SET,this._currentHeight=E_[1]}get currentAction(){return this._currentAction}set currentAction(e){this._currentAction=e}get currentHeight(){return this._currentHeight}set currentHeight(e){this._currentHeight=e}clear(){this._currentAction=Bt.SET,this._currentHeight=E_[1]}}class km{constructor(e,t){this._height=e,this._isBlocked=t}get height(){return this._height}set height(e){this._height=e}get isBlocked(){return this._isBlocked}set isBlocked(e){this._isBlocked=e}}const Iv=(a,e,t=0,i=0)=>{let r=a*fn/2-e*fn/2,n=a*fn/4+e*fn/4;return r=r+t,n=n+i,[r,n]},Cne=(a,e,t=0,i=0)=>{const r=a-t,n=e-i,o=(r/(fn/2)+n/(fn/4))/2,l=(n/(fn/4)-r/(fn/2))/2;return[o,l]},Gp=a=>{switch(a=parseInt(a.toString()),a){case 0:return-2;case 1:return-1;case 3:return 1;default:return 0}},Gm=a=>{switch(a){case .25:return 0;case .5:return 1;case 2:return 3;default:return 2}},uB=h.createContext({originalFloorplanSettings:null,setOriginalFloorplanSettings:null,visualizationSettings:null,setVisualizationSettings:null}),Nne=a=>s.jsx(uB.Provider,{...a}),YN=()=>h.useContext(uB),Tv=0,Bm=26,Ane=0,tS=26;let hB=a=>{},dB=a=>{};const bne=a=>{const{visualizationSettings:e=null,setVisualizationSettings:t=null}=YN(),[i,r]=h.useState(Bt.SET),[n,o]=h.useState(0),[l,c]=h.useState(!1),[u,d]=h.useState(!1);hB=C=>o(C),dB=C=>r(C);const _=C=>{r(C),Ys.instance.actionSettings.currentAction=C},m=()=>{t(C=>{const A={...C};return A.entryPointDir<7?++A.entryPointDir:A.entryPointDir=0,A})},f=C=>{(isNaN(C)||C<=0)&&(C=0),C>tS&&(C=tS),o(C),Ys.instance.actionSettings.currentHeight=C.toString(36)},E=C=>{t(A=>{const b={...A};return b.thicknessFloor=C,b})},I=C=>{t(A=>{const b={...A};return b.thicknessWall=C,b})},p=C=>{(isNaN(C)||C<=0)&&(C=Tv),C>Bm&&(C=Bm),t(A=>{const b={...A};return b.wallHeight=C,b})},S=()=>{let C=e.wallHeight+1;C>Bm&&(C=Bm),p(C)},R=()=>{let C=e.wallHeight-1;C<=0&&(C=Tv),p(C)},O=()=>window.innerWidth<768;return s.jsxs(N,{children:[s.jsxs(x,{gap:1,children:[s.jsxs(N,{size:6,gap:1,children:[s.jsxs(x,{justifyContent:"between",children:[s.jsx(T,{bold:!0,children:g("floor.plan.editor.draw.mode")}),s.jsxs(T,{bold:!0,children:["X: ",Ys.instance.getX()," / Y: ",Ys.instance.getY()]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",name:"isInverse",id:"isInverse",checked:l,onChange:C=>{Ys.instance.isInverted=C.target.checked,c(C.target.checked)}}),s.jsx(T,{bold:!0,children:"Inverter seleção"})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",name:"isHiddenFurni",id:"isHiddenFurni",checked:u,onChange:C=>{Ys.instance.hiddenTilesWithFurnis=C.target.checked,d(C.target.checked)}}),s.jsx(T,{bold:!0,children:"Esconder Mobis"})]})]}),s.jsxs(x,{gap:3,children:[s.jsxs(x,{gap:1,children:[s.jsx(ct,{itemActive:i===Bt.SET,onClick:C=>_(Bt.SET),children:s.jsx("i",{className:"icon icon-set-tile"})}),s.jsx(ct,{itemActive:i===Bt.UNSET,onClick:C=>_(Bt.UNSET),children:s.jsx("i",{className:"icon icon-unset-tile"})})]}),s.jsxs(x,{gap:1,children:[s.jsx(ct,{itemActive:i===Bt.UP,onClick:C=>_(Bt.UP),children:s.jsx("i",{className:"icon icon-increase-height"})}),s.jsx(ct,{itemActive:i===Bt.DOWN,onClick:C=>_(Bt.DOWN),children:s.jsx("i",{className:"icon icon-decrease-height"})})]}),s.jsx(x,{children:s.jsx(ct,{itemActive:i===Bt.DOOR,onClick:C=>_(Bt.DOOR),children:s.jsx("i",{className:"icon icon-set-door"})})}),s.jsx(x,{children:s.jsx(ct,{itemActive:i===Bt.DROPPER,onClick:C=>_(Bt.DROPPER),className:"px-3",children:s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 512 512",className:"fa-icon text-black",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M50.75 333.25c-12 12-18.75 28.28-18.75 45.26V424L0 480l32 32 56-32h45.49c16.97 0 33.25-6.74 45.25-18.74l126.64-126.62-128-128L50.75 333.25zM483.88 28.12c-37.47-37.5-98.28-37.5-135.75 0l-77.09 77.09-13.1-13.1c-9.44-9.44-24.65-9.31-33.94 0l-40.97 40.97c-9.37 9.37-9.37 24.57 0 33.94l161.94 161.94c9.44 9.44 24.65 9.31 33.94 0L419.88 288c9.37-9.37 9.37-24.57 0-33.94l-13.1-13.1 77.09-77.09c37.51-37.48 37.51-98.26.01-135.75z"})})})})]})]}),!O()&&s.jsxs(s.Fragment,{children:[s.jsxs(N,{alignItems:"center",size:3,children:[s.jsx(T,{bold:!0,children:g("floor.plan.editor.enter.direction")}),s.jsx("i",{className:`icon icon-door-direction-${e.entryPointDir} cursor-pointer`,onClick:m})]}),s.jsxs(N,{size:3,children:[s.jsx(T,{bold:!0,children:g("floor.editor.wall.height")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(of,{className:"cursor-pointer fa-icon",onClick:R}),s.jsx("input",{type:"number",className:"form-control form-control-sm quantity-input",value:e.wallHeight,onChange:C=>p(C.target.valueAsNumber)}),s.jsx(xg,{className:"cursor-pointer fa-icon",onClick:S})]})]})]})]}),O()&&s.jsxs(x,{gap:1,justifyContent:"center",alignItems:"center",children:[s.jsxs(N,{alignItems:"center",size:4,children:[s.jsx(T,{bold:!0,children:g("floor.plan.editor.enter.direction")}),s.jsx("i",{className:`icon icon-door-direction-${e.entryPointDir} cursor-pointer`,onClick:m})]}),s.jsxs(N,{size:3,children:[s.jsx(T,{bold:!0,children:g("floor.editor.wall.height")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(of,{className:"cursor-pointer fa-icon",onClick:R}),s.jsx("input",{type:"number",className:"form-control form-control-sm quantity-input",value:e.wallHeight,onChange:C=>p(C.target.valueAsNumber)}),s.jsx(xg,{className:"cursor-pointer fa-icon",onClick:S})]})]})]}),s.jsxs(x,{gap:1,children:[s.jsxs(N,{size:6,children:[s.jsxs(T,{bold:!0,children:[g("floor.plan.editor.tile.height"),": ",n]}),s.jsx(cm,{className:"nitro-slider",min:Ane,max:tS,step:1,value:n,onChange:C=>f(C),renderThumb:({style:C,...A},b)=>s.jsx("div",{style:{backgroundColor:`#${One[b.valueNow.toString(33)]}`,...C},...A,children:b.valueNow})})]}),s.jsxs(N,{size:6,children:[s.jsx(T,{bold:!0,children:g("floor.plan.editor.room.options")}),s.jsxs(x,{className:"align-items-center",children:[s.jsxs("select",{className:"form-control form-control-sm",value:e.thicknessWall,onChange:C=>I(parseInt(C.target.value)),children:[s.jsx("option",{value:0,children:g("navigator.roomsettings.wall_thickness.thinnest")}),s.jsx("option",{value:1,children:g("navigator.roomsettings.wall_thickness.thin")}),s.jsx("option",{value:2,children:g("navigator.roomsettings.wall_thickness.normal")}),s.jsx("option",{value:3,children:g("navigator.roomsettings.wall_thickness.thick")})]}),s.jsxs("select",{className:"form-control form-control-sm",value:e.thicknessFloor,onChange:C=>E(parseInt(C.target.value)),children:[s.jsx("option",{value:0,children:g("navigator.roomsettings.floor_thickness.thinnest")}),s.jsx("option",{value:1,children:g("navigator.roomsettings.floor_thickness.thin")}),s.jsx("option",{value:2,children:g("navigator.roomsettings.floor_thickness.normal")}),s.jsx("option",{value:3,children:g("navigator.roomsettings.floor_thickness.thick")})]})]})]})]})]})},Ma=class Ma extends di{constructor(){const e=fn*qo+(fn+qo),t=fn*qo/2+(fn+qo);super({width:e,height:t,backgroundColor:0,antialias:!0,autoDensity:!0,resolution:1,sharedLoader:!0,sharedTicker:!0}),this._offsetX=1624,this._offsetY=70,this._selectedTiles=[],this._isInverted=!1,this._isMouseDown=!1,this._hiddenTilesWithFurnis=!1,this._tilemap=[],this._doorLocation=new ei(0,0),this._width=0,this._height=0,this._isHolding=!1,this._shiftPressed=!1,this._startPoint=new ei(-1,-1),this._currentPoint=new ei(-1,-1),this._lastUsedTile=new ei(-1,-1),this._actionSettings=new cB,this._selectedTiles=[]}initialize(){if(this._isInitialized)return;const e=vr().getCollection("floor_editor");e&&(this._assetCollection=e,this._tilemapRenderer=new eD(e.baseTexture),this.registerEventListeners(),this.stage.addChild(this._tilemapRenderer),this._isInitialized=!0)}registerEventListeners(){window.addEventListener("keydown",t=>{t.key==="Shift"&&(this._shiftPressed=!0)}),window.addEventListener("keyup",t=>{t.key==="Shift"&&(this._shiftPressed=!1)});const e=new ei;this._tilemapRenderer.containsPoint=t=>(this._tilemapRenderer.worldTransform.applyInverse(t,e),this.tileHitDetection(e,!1)),this._tilemapRenderer.on("pointerout",()=>{if(this._startPoint.set(-1,-1),this._currentPoint.set(-1,-1),this._isHolding&&this._shiftPressed){if(this._isInverted&&this._actionSettings.currentAction!=Bt.DROPPER&&this._actionSettings.currentAction!=Bt.DOOR)for(let t=0;t<this._tilemap.length;t++)for(let i=0;i<this._tilemap[t].length;i++)this._selectedTiles.some(r=>r.x===i&&r.y===t)||this.onClick(i,t,!1);else this._selectedTiles.forEach(t=>{this.onClick(t.x,t.y,!1)});this._selectedTiles.length=0,this.renderTiles()}this._isHolding=!1,this._shiftPressed=!1}),this._tilemapRenderer.on("pointerdown",t=>{if(!(t.data.originalEvent instanceof PointerEvent)&&!(t.data.originalEvent instanceof TouchEvent))return;const i=t.data.originalEvent;if(i instanceof MouseEvent&&i.button===2)return;this._isMouseDown=!0;const r=t.data.global;this.tileHitDetection(r,!0)}),this._tilemapRenderer.on("pointerup",()=>{if(this._isMouseDown=!1,this._isHolding=!1,this._startPoint.set(-1,-1),this._isInverted&&this._actionSettings.currentAction!=Bt.DROPPER&&this._actionSettings.currentAction!=Bt.DOOR)for(let t=0;t<this._tilemap.length;t++)for(let i=0;i<this._tilemap[t].length;i++)this._selectedTiles.some(r=>r.x===i&&r.y===t)||this.onClick(i,t,!1);else this._selectedTiles.forEach(t=>{this.onClick(t.x,t.y,!1)});this._selectedTiles.length=0,this.renderTiles()}),this._tilemapRenderer.on("pointermove",t=>{if(this._isMouseDown){const i=t.data.global;this.tileHitDetection(i,!0)}}),this._tilemapRenderer.on("click",t=>{if(!(t.data.originalEvent instanceof PointerEvent)||t.data.originalEvent.button===2)return;const r=t.data.global;this.tileHitDetection(r,!0,!0)})}tileHitDetection(e,t,i=!1){const r=this._tilemapRenderer.pointsBuf,n=zy,o=r.length;t&&(this._isHolding=!0);for(let l=0;l<o;l+=n){const c=l+n,u=r.slice(l,c),d=fn,_=fn/2,m=Math.floor(e.x),f=Math.floor(e.y),E=u[2],I=u[3],p=E+d/2,S=I+_/2,R=Math.abs(m-p),O=Math.abs(f-S);if(R*R/(d*.5)**2+O*O/(_*.5)**2<=1){if(this._isHolding||this._isMouseDown){const[A,b]=Cne(E,I,this._offsetX,this._offsetY);if(i&&this._selectedTiles.length===0)this.onClick(A,b);else if((this._lastUsedTile.x!==A||this._lastUsedTile.y!==b)&&(this._shiftPressed||this._isMouseDown)){this._startPoint.x===-1&&this._startPoint.y===-1&&this._startPoint.set(A,b),this._currentPoint.set(A,b);const y=Math.min(this._startPoint.x,this._currentPoint.x),M=Math.max(this._startPoint.x,this._currentPoint.x),U=Math.min(this._startPoint.y,this._currentPoint.y),G=Math.max(this._startPoint.y,this._currentPoint.y);this._selectedTiles.length=0;for(let F=U;F<=G;F++)for(let H=y;H<=M;H++){const v=new ei(H,F);this._selectedTiles.push(v)}this.processTile(),this._lastUsedTile.x=A,this._lastUsedTile.y=b}else(this._lastUsedTile.x!==A||this._lastUsedTile.y!==b)&&(this._lastUsedTile.x=A,this._lastUsedTile.y=b,this.onClick(A,b))}return!0}}return!1}processTile(){this.renderTiles(),this._selectedTiles.forEach(e=>{const[t,i]=Iv(e.x,e.y,this._offsetX,this._offsetY);this._tilemapRenderer.tile(this._assetCollection.getTexture("floor_editor_q"),t,i)})}onClick(e,t,i=!0){const r=this._tilemap[t][e],n=E_.indexOf(r.height);let o=0;switch(this._actionSettings.currentAction){case Bt.DOOR:r.height!=="x"&&(this._doorLocation.x=e,this._doorLocation.y=t,this.renderTiles());return;case Bt.UP:if(r.height==="x")return;o=n+1;break;case Bt.DOWN:if(r.height==="x"||n<=1)return;o=n-1;break;case Bt.SET:o=E_.indexOf(this._actionSettings.currentHeight);break;case Bt.UNSET:o=0;break;case Bt.DROPPER:this._actionSettings.currentHeight=r.height,this._actionSettings.currentAction=Bt.SET,dB(Bt.SET),hB(parseInt(r.height));return}if(o===-1||n===o)return;o>0&&(e+1>this._width&&(this._width=e+1),t+1>this._height&&(this._height=t+1));const l=E_[o];l&&(this._tilemap[t][e].height=l,l=="x"&&this._tilemap[t][e].isBlocked&&(this._tilemap[t][e].isBlocked=!1),l=="0"&&this._blockedTiles[t]&&this._blockedTiles[t][e]&&(this._tilemap[t][e].isBlocked=!0),i&&this.renderTiles())}renderTiles(){this.tilemapRenderer.clear();for(let e=0;e<this._tilemap.length;e++)for(let t=0;t<this.tilemap[e].length;t++){const i=this.tilemap[e][t];let r=i.height;i.isBlocked&&!this._hiddenTilesWithFurnis&&(r=Ma.TILE_BLOCKED),this._doorLocation.x===t&&this._doorLocation.y===e&&(r=Ma.TILE_DOOR);const[n,o]=Iv(t,e,this._offsetX,this._offsetY);this._tilemapRenderer.tile(this._assetCollection.getTexture(`floor_editor_${r}`),n,o)}}setTilemap(e,t){this._blockedTiles=t,this._tilemap=[];const i=e.split("\r");let r=0,n=i.length;for(let o=0;o<n;o++){const l=i[o];if(l.length===0){i.splice(o,1),n=i.length,o--;continue}l.length>r&&(r=l.length)}for(let o=0;o<n;o++){this._tilemap[o]=[];const l=i[o];for(let c=0;c<r;c++){const u=t[o]&&t[o][c]||!1,d=l[c];d!=="x"&&d!=="X"&&d?this._tilemap[o][c]=new km(d,u):this._tilemap[o][c]=new km("x",!1)}for(let c=r;c<qo;c++)this.tilemap[o][c]=new km("x",!1)}for(let o=n;o<qo;o++){this.tilemap[o]||(this.tilemap[o]=[]);for(let l=0;l<qo;l++)this.tilemap[o][l]=new km("x",!1)}this._width=r,this._height=n}getCurrentTilemapString(){if(this._tilemap[this._height-1][this._width-1].height==="x"){this._width=-1,this._height=-1;for(let i=qo-1;i>=0;i--)if(this._tilemap[i])for(let r=qo-1;r>=0;r--){if(!this._tilemap[i][r])continue;this._tilemap[i][r].height!=="x"&&(r+1>this._width&&(this._width=r+1),i+1>this._height&&(this._height=i+1))}}const t=[];for(let i=0;i<this._height;i++){const r=[];for(let n=0;n<this._width;n++){const o=this._tilemap[i][n];r[n]=o.height}t[i]=r.join("")}return t.join("\r")}clear(){this._tilemapRenderer.interactive=!1,this._tilemap=[],this._doorLocation.set(-1,-1),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile.set(-1,-1),this._actionSettings.clear(),this._tilemapRenderer.clear()}get tilemapRenderer(){return this._tilemapRenderer}get tilemap(){return this._tilemap}get doorLocation(){return this._doorLocation}set doorLocation(e){this._doorLocation=e}get actionSettings(){return this._actionSettings}static get instance(){return Ma._INSTANCE||(Ma._INSTANCE=new Ma),Ma._INSTANCE}getX(){let e=0;for(let t=0;t<this._width;t++)for(let i=0;i<this._height;i++)if(this._tilemap[i][t].height!=="x"){e=t;break}return e}getY(){let e=0;for(let t=0;t<this._height;t++)for(let i=0;i<this._width;i++)if(this._tilemap[t][i].height!=="x"){e=t;break}return e}get isInverted(){return this._isInverted}set isInverted(e){this._isInverted=e}get hiddenTilesWithFurnis(){return this._hiddenTilesWithFurnis}set hiddenTilesWithFurnis(e){this._hiddenTilesWithFurnis=e,this.renderTiles()}};Ma._INSTANCE=null,Ma.TILE_BLOCKED="r_blocked",Ma.TILE_DOOR="r_door";let Ys=Ma;const vne=a=>{const{gap:e=1,children:t=null,...i}=a,[r,n]=h.useState(!1),[o,l]=h.useState(!1),{originalFloorplanSettings:c=null,setOriginalFloorplanSettings:u=null,setVisualizationSettings:d=null}=YN(),_=h.useRef(null);J(zj,E=>{const I=E.getParser();u(p=>{const S={...p};return S.reservedTiles=I.blockedTilesMap,Ys.instance.setTilemap(S.tilemap,S.reservedTiles),S}),n(!0),_.current.scrollTo(Ys.instance.view.width/3,0)}),J(ep,E=>{const I=E.getParser();u(p=>{const S={...p};return S.entryPoint=[I.x,I.y],S.entryPointDir=I.direction,S}),d(p=>{const S={...p};return S.entryPointDir=I.direction,S}),Ys.instance.doorLocation=new ei(I.x,I.y),l(!0)});const m=E=>{const I=_.current;if(I)switch(E){case"up":I.scrollBy({top:-10});break;case"down":I.scrollBy({top:10});break;case"left":I.scrollBy({left:-10});break;case"right":I.scrollBy({left:10});break}};h.useEffect(()=>()=>{Ys.instance.clear(),d(E=>({wallHeight:c.wallHeight,thicknessWall:c.thicknessWall,thicknessFloor:c.thicknessFloor,entryPointDir:E.entryPointDir}))},[c.thicknessFloor,c.thicknessWall,c.wallHeight,d]),h.useEffect(()=>{!o||!r||Ys.instance.renderTiles()},[o,r]),h.useEffect(()=>{K(new yw),K(new vw),Ys.instance.tilemapRenderer.interactive=!0,_.current&&_.current.appendChild(Ys.instance.renderer.view)},[]);const f=()=>window.innerWidth<768;return s.jsxs(N,{gap:e,...i,children:[s.jsxs(Ye,{overflow:"hidden",gap:1,children:[s.jsx(N,{center:!0,size:1,className:"d-md-none",children:s.jsx(X,{className:"d-md-none",onMouseDown:E=>m("left"),children:s.jsx(Ky,{className:"fa-icon"})})}),s.jsxs(N,{overflow:"hidden",size:f()?10:12,gap:1,children:[s.jsx(x,{justifyContent:"center",className:"d-md-none",children:s.jsx(X,{shrink:!0,onMouseDown:E=>m("up"),children:s.jsx(_V,{className:"fa-icon"})})}),s.jsx(q,{overflow:"auto",innerRef:_}),s.jsx(x,{justifyContent:"center",className:"d-md-none",children:s.jsx(X,{shrink:!0,onMouseDown:E=>m("down"),children:s.jsx(gV,{className:"fa-icon"})})})]}),s.jsx(N,{center:!0,size:1,className:"d-md-none",children:s.jsx(X,{className:"d-md-none",onMouseDown:E=>m("right"),children:s.jsx(qy,{className:"fa-icon"})})})]}),t]})},Sv=a=>a.replace(/\r\n|\r|\n/g,`
`).toLowerCase(),yne=a=>{const{onCloseClick:e=null}=a,[t,i]=h.useState(""),{originalFloorplanSettings:r=null}=YN(),n=()=>{K(new cN(t.split(`
`).join("\r"),r.entryPoint[0],r.entryPoint[1],r.entryPointDir,Gp(r.thicknessWall),Gp(r.thicknessFloor),r.wallHeight-1))};return QG(()=>{i(Sv(r.tilemap))}),s.jsxs(ve,{theme:"primary-slim",className:"floorplan-import-export",children:[s.jsx(je,{headerText:g("floor.plan.editor.import.export"),onCloseClick:e}),s.jsxs(be,{children:[s.jsx("textarea",{className:"h-100",value:t,onChange:o=>i(o.target.value)}),s.jsxs(x,{justifyContent:"between",children:[s.jsx(X,{onClick:o=>i(Sv(r.tilemap)),children:g("floor.plan.editor.revert.to.last.received.map")}),s.jsx(X,{onClick:n,children:g("floor.plan.editor.save")})]})]})]})},Dne=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(!1),[n,o]=h.useState({tilemap:"",reservedTiles:[],entryPoint:[0,0],entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),[l,c]=h.useState({entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),u=()=>{K(new cN(Ys.instance.getCurrentTilemapString(),Ys.instance.doorLocation.x,Ys.instance.doorLocation.y,l.entryPointDir,Gp(l.thicknessWall),Gp(l.thicknessFloor),l.wallHeight-1))},d=()=>{c({wallHeight:n.wallHeight,thicknessWall:n.thicknessWall,thicknessFloor:n.thicknessFloor,entryPointDir:n.entryPointDir}),Ys.instance.doorLocation=new ei(n.entryPoint[0],n.entryPoint[1]),Ys.instance.setTilemap(n.tilemap,n.reservedTiles),Ys.instance.renderTiles()};return ut(Ot.DISPOSED,_=>t(!1)),J(Zf,_=>{const m=_.getParser();o(f=>{const E={...f};return E.tilemap=m.model,E.wallHeight=m.wallHeight+1,E}),c(f=>{const E={...f};return E.wallHeight=m.wallHeight+1,E})}),J(tp,_=>{const m=_.getParser();o(f=>{const E={...f};return E.thicknessFloor=Gm(m.thicknessFloor),E.thicknessWall=Gm(m.thicknessWall),E}),c(f=>{const E={...f};return E.thicknessFloor=Gm(m.thicknessFloor),E.thicknessWall=Gm(m.thicknessWall),E})}),h.useEffect(()=>{const _={linkReceived:m=>{const f=m.split("/");if(!(f.length<2))switch(f[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(E=>!E);return}},eventUrlPrefix:"floor-editor/"};return fs(_),()=>ps(_)},[]),h.useEffect(()=>{Ys.instance.initialize()},[]),h.useEffect(()=>{Ys.instance&&(Ys.instance.isInverted=!1,Ys.instance.hiddenTilesWithFurnis&&(Ys.instance.hiddenTilesWithFurnis=!1))},[e]),s.jsxs(Nne,{value:{originalFloorplanSettings:n,setOriginalFloorplanSettings:o,visualizationSettings:l,setVisualizationSettings:c},children:[e&&s.jsxs(ve,{uniqueKey:"floorpan-editor",className:"nitro-floorplan-editor",theme:"primary-slim",children:[s.jsx(je,{headerText:g("floor.plan.editor.title"),onCloseClick:()=>t(!1)}),s.jsxs(be,{overflow:"hidden",children:[s.jsx(bne,{}),s.jsx(vne,{overflow:"hidden"}),s.jsxs(x,{justifyContent:"between",children:[s.jsx(X,{onClick:d,children:g("floor.plan.editor.reload")}),s.jsxs(Ya,{children:[s.jsx(X,{disabled:!0,children:g("floor.plan.editor.preview")}),s.jsx(X,{onClick:_=>r(!0),children:g("floor.plan.editor.import.export")}),s.jsx(X,{onClick:u,children:g("floor.plan.editor.save")})]})]})]})]}),i&&s.jsx(yne,{onCloseClick:()=>r(!1)})]})},Mne=a=>{const{friend:e=null}=a,[t,i]=h.useState(!1),{followFriend:r=null}=Jr(),n=h.useRef();return h.useEffect(()=>{const o=l=>{const c=n.current;c&&l.target!==c&&!c.contains(l.target)&&i(!1)};return document.addEventListener(Re.MOUSE_CLICK,o),()=>document.removeEventListener(Re.MOUSE_CLICK,o)},[]),e?s.jsxs("div",{ref:n,className:"btn btn-success friend-bar-item "+(t?"friend-bar-item-active":""),onClick:o=>i(l=>!l),children:[s.jsxs("div",{className:`friend-bar-item-head position-absolute ${e.id>0?"avatar":"group"}`,children:[e.id>0&&s.jsx(ls,{headOnly:!0,figure:e.figure,direction:2}),e.id<=0&&s.jsx(as,{isGroup:!0,badgeCode:e.figure})]}),s.jsx("div",{className:"text-truncate",children:e.name}),t&&s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsx(q,{className:"nitro-friends-spritesheet icon-friendbar-chat cursor-pointer",onClick:o=>TT(e.id)}),e.followingAllowed&&s.jsx(q,{className:"nitro-friends-spritesheet icon-friendbar-visit cursor-pointer",onClick:o=>r(e)}),s.jsx(q,{className:"nitro-friends-spritesheet icon-profile cursor-pointer",onClick:o=>ir(e.id)})]})]}):s.jsxs("div",{ref:n,className:"btn btn-primary friend-bar-item friend-bar-search",children:[s.jsx("div",{className:"friend-bar-item-head position-absolute"}),s.jsx("div",{className:"text-truncate",children:g("friend.bar.find.title")})]})},sS=3,jne=a=>{const{onlineFriends:e=null}=a,[t,i]=h.useState(0),r=h.useRef();return s.jsxs(x,{innerRef:r,alignItems:"center",className:"friend-bar",children:[s.jsx(X,{variant:"black",className:"friend-bar-button",disabled:t<=0,onClick:n=>i(t-1),children:s.jsx(ds,{className:"fa-icon"})}),Array.from(Array(sS),(n,o)=>s.jsx(Mne,{friend:e[t+o]||null},o)),s.jsx(X,{variant:"black",className:"friend-bar-button",disabled:!(e.length>sS&&t+sS<=e.length-1),onClick:n=>i(t+1),children:s.jsx(_s,{className:"fa-icon"})})]})},Lne=a=>{const{friend:e=null}=a,{updateRelationship:t=null}=Jr(),[i,r]=h.useState(null),[n,o]=h.useState(!1),l=(d,_)=>{d.stopPropagation(),t(e,_),o(!1)},c=d=>{let _=!1;o(m=>(_=!m,_)),_&&r(d.target)};h.useEffect(()=>{n||r(null)},[n]);const u=()=>{if(!e)return"none";switch(e.relationshipStatus){case $i.RELATIONSHIP_HEART:return"heart";case $i.RELATIONSHIP_SMILE:return"smile";case $i.RELATIONSHIP_BOBBA:return"bobba";case $i.RELATIONSHIP_POOP:return"poop";default:return"none"}};return s.jsxs(s.Fragment,{children:[s.jsx(q,{pointer:!0,className:`nitro-friends-spritesheet icon-${u()} cursor-pointer`,onClick:c}),s.jsx(Kd,{show:n,target:i,placement:"right",children:s.jsx(Oc,{className:"nitro-chat-gif-selector-container",children:s.jsx(be,{overflow:"hidden",className:"bg-transparent",children:s.jsxs(s.Fragment,{children:[s.jsx(q,{pointer:!0,className:"nitro-friends-spritesheet icon-heart",onClick:d=>l(d,$i.RELATIONSHIP_HEART)}),s.jsx(q,{pointer:!0,className:"nitro-friends-spritesheet icon-smile",onClick:d=>l(d,$i.RELATIONSHIP_SMILE)}),s.jsx(q,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba",onClick:d=>l(d,$i.RELATIONSHIP_BOBBA)}),s.jsx(q,{pointer:!0,className:"nitro-friends-spritesheet icon-poop",onClick:d=>l(d,$i.RELATIONSHIP_POOP)}),s.jsx(q,{pointer:!0,className:"nitro-friends-spritesheet icon-none",onClick:d=>l(d,$i.RELATIONSHIP_NONE)})]})})})})]})},Pne=a=>{const{friend:e=null,selected:t=!1,selectFriend:i=null}=a,[r,n]=h.useState(!1),{followFriend:o=null,updateRelationship:l=null}=Jr(),c=d=>{d.stopPropagation(),e.followingAllowed&&o(e)},u=d=>{d.stopPropagation(),TT(e.id)};return e?s.jsxs(jN,{justifyContent:"between",className:`px-1 py-1 ${t&&"selected-friends"} mb-1`,onClick:d=>i(e.id),children:[s.jsxs(x,{alignItems:"center",gap:1,children:[e.id>0&&s.jsx(x,{onClick:d=>d.stopPropagation(),children:s.jsx(Lne,{friend:e})}),s.jsx("div",{className:"fw-bold",children:e.name})]}),s.jsx(x,{alignItems:"center",gap:1,children:!r&&s.jsxs(s.Fragment,{children:[s.jsx(x,{onClick:d=>{d.stopPropagation(),ir(e.id)},justifyContent:"center",alignItems:"center",className:"button-actions shadow-button",children:s.jsx(Xn,{userId:e.id})}),s.jsx(x,{justifyContent:"center",alignItems:"center",onClick:u,className:"button-actions shadow-button",children:s.jsx(q,{pointer:!0,className:"nitro-friends-spritesheet icon-chat-new",title:g("friendlist.tip.im")})}),s.jsx(x,{onClick:c,justifyContent:"center",alignItems:"center",className:`button-actions shadow-button ${e.followingAllowed?"":"disabled"}`,children:s.jsx(q,{pointer:!0,className:"icon-follow-new",title:g("friendlist.tip.follow")})})]})})]}):null},Rv=a=>{const{list:e=null,selectedFriendsIds:t=null,selectFriend:i=null,isOpen:r=!1}=a;return!e||!e.length||!r?null:s.jsx(s.Fragment,{children:e.map((n,o)=>s.jsx(Pne,{friend:n,selected:t&&t.indexOf(n.id)>=0,selectFriend:i},o))})},Une=a=>{const{request:e=null}=a,{requestResponse:t=null}=Jr();return e?s.jsxs(jN,{justifyContent:"between",className:"px-2 py-1",children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(x,{justifyContent:"center",alignItems:"center",className:"shadow-button button-actions",children:s.jsx(Xn,{userId:e.id})}),s.jsx(T,{bold:!0,children:e.name})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(x,{justifyContent:"center",alignItems:"center",className:"shadow-button button-actions green",children:s.jsx(q,{className:"nitro-friends-spritesheet icon-accept cursor-pointer",onClick:i=>t(e.id,!0)})}),s.jsx(x,{justifyContent:"center",alignItems:"center",className:"shadow-button button-actions white",children:s.jsx(q,{className:"nitro-friends-spritesheet icon-deny cursor-pointer",onClick:i=>t(e.id,!1)})})]})]}):null},wne=a=>{const{requests:e=[],requestResponse:t=null}=Jr();return e.length?s.jsxs(N,{fullHeight:!0,justifyContent:"between",gap:1,children:[s.jsx(N,{overflow:"auto",gap:0,children:e.map((i,r)=>s.jsx(Une,{request:i},r))}),s.jsxs(x,{fullWidth:!0,justifyContent:"center",className:"px-1",children:[s.jsx(X,{fullWidth:!0,className:"border-0",onClick:i=>t(-1,!1),children:g("friendlist.requests.dismissall")}),s.jsx(X,{fullWidth:!0,className:"border-0",onClick:i=>t(-1,!0),children:g("friendbar.requests.accept")})]})]}):null},Fne=a=>{const{selectedFriendsIds:e=null,removeFriendsText:t=null,removeSelectedFriends:i=null,onCloseClick:r=null}=a;return s.jsxs(ve,{className:"nitro-friends-remove-confirmation",theme:"primary-slim",children:[s.jsx(je,{headerText:g("friendlist.removefriendconfirm.title"),onCloseClick:r}),s.jsxs(be,{className:"text-black",children:[s.jsx("div",{children:t}),s.jsxs(x,{gap:1,children:[s.jsx(X,{fullWidth:!0,variant:"danger",disabled:e.length===0,onClick:i,children:g("generic.ok")}),s.jsx(X,{fullWidth:!0,onClick:r,children:g("generic.cancel")})]})]})]})},kne=a=>{const{selectedFriendsIds:e=null,onCloseClick:t=null,sendRoomInvite:i=null}=a,[r,n]=h.useState("");return s.jsx(ve,{className:"nitro-friends-room-invite border-0",uniqueKey:"nitro-friends-room-invite",theme:"primary-slim",children:s.jsxs(be,{className:"text-black drag-handler",children:[s.jsx("textarea",{placeholder:"Insira seu texto",className:"form-control",value:r,maxLength:255,onChange:o=>n(o.target.value)}),s.jsx(T,{center:!0,className:"bg-muted rounded p-1",children:g("friendlist.invite.note")}),s.jsxs(x,{gap:1,children:[s.jsxs(X,{className:"border-0",fullWidth:!0,variant:"success",disabled:r.length===0||e.length===0,onClick:()=>i(r),children:[g("friendlist.invite.send")," (",e==null?void 0:e.length,")"]}),s.jsx(X,{className:"border-0",fullWidth:!0,variant:"danger",onClick:t,children:g("generic.cancel")})]})]})})},Gne=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(null),[n,o]=h.useState(null),{canRequestFriend:l=null,requestFriend:c=null}=Jr();return J(lM,u=>{const d=u.getParser();r(d.friends),o([...d.others,...d.friends])}),h.useEffect(()=>{if(!e||!e.length)return;const u=setTimeout(()=>{!e||!e.length||K(new jP(e))},500);return()=>clearTimeout(u)},[e]),s.jsxs("div",{children:[s.jsx("input",{type:"text",className:"form-control form-control-sm w-100 px-2",placeholder:g("generic.search"),value:e,maxLength:50,onChange:u=>t(u.target.value)}),s.jsx(N,{children:n&&s.jsxs(s.Fragment,{children:[n.length===0&&s.jsx(T,{bold:!0,small:!0,className:"py-1",children:g("friendlist.search.noothersfound")}),n.length>0&&s.jsx(N,{gap:0,children:s.jsx(N,{gap:0,children:n.map(u=>s.jsxs(jN,{justifyContent:"between",className:"py-1",children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(x,{justifyContent:"center",alignItems:"center",className:"shadow-button button-actions",children:s.jsx(Xn,{userId:u.avatarId})}),s.jsx("div",{className:"fw-bold",children:u.avatarName})]}),s.jsx(x,{className:`button-actions green shadow-button ${l(u.avatarId)?"":"disabled"}`,justifyContent:"center",alignItems:"center",gap:1,onClick:d=>c(u.avatarId,u.avatarName),children:s.jsx(q,{className:"icon-add-new cursor-pointer",title:g("friendlist.tip.addfriend")})})]},u.avatarId))})})]})})]})},Bne=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState([]),[n,o]=h.useState(!1),[l,c]=h.useState(!1),{onlineFriends:u=[],offlineFriends:d=[],requests:_=[],requestFriend:m=null}=Jr(),[f,E]=h.useState(""),[I,p]=h.useState(0),S=h.useMemo(()=>{if(!i||!i.length)return"";const A=[];for(const b of i){let y=u.find(M=>M.id===b);y||(y=d.find(M=>M.id===b)),y&&A.push(y.name)}return g("friendlist.removefriendconfirm.userlist",["user_names"],[A.join(", ")])},[d,u,i]),R=h.useCallback(A=>{A<0||r(b=>{const y=[...b],M=y.indexOf(A);return M>-1?y.splice(M,1):y.push(A),y})},[r]),O=A=>{!i.length||!A||!A.length||A.length>255||(K(new wP(A,i)),o(!1))},C=()=>{i.length!==0&&(r(A=>(K(new PP(...A)),[])),c(!1))};return h.useEffect(()=>{const A={linkReceived:b=>{const y=b.split("/");if(!(y.length<2))switch(y[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(M=>!M);return;case"request":if(y.length<4)return;m(parseInt(y[2]),y[3]);return}},eventUrlPrefix:"friends/"};return fs(A),()=>ps(A)},[m]),e?s.jsxs(s.Fragment,{children:[s.jsx(ve,{className:"nitro-friends border-0",uniqueKey:"nitro-friends",theme:"primary-slim",children:s.jsxs(be,{overflow:"hidden",gap:1,className:"text-black p-1",children:[s.jsxs(x,{gap:1,className:"header-friends-list drag-handler",fullWidth:!0,alignItems:"center",justifyContent:"between",children:[s.jsxs(x,{className:"px-2",alignItems:"center",gap:1,children:[s.jsx(q,{className:"icon-friends-group"}),s.jsx("div",{className:"fw-bold",children:g("friendlist.friends")})]}),s.jsxs(x,{gap:1,children:[s.jsx("div",{className:`friend-header-button ${I===0?"active":""}`,onClick:A=>p(0),children:g("On")}),s.jsx("div",{className:`friend-header-button ${I===1?"active":""}`,onClick:A=>p(1),children:g("Off")}),s.jsx("div",{className:`friend-header-button ${I===2?"active":""}`,onClick:A=>p(2),children:" Pedidos "}),s.jsxs(x,{className:`friend-header-button ${I===3?"active":""}`,onClick:A=>p(3),gap:1,alignItems:"center",justifyContent:"center",children:[s.jsx("div",{children:g("Buscar")}),s.jsx("i",{className:"fa-solid fa-magnifying-glass"})]})]}),s.jsx(x,{justifyContent:"center",alignItems:"center",classNames:["button-actions shadow-button white"],onClick:A=>t(!1),children:s.jsx(pr,{className:"fa-icon"})})]}),s.jsxs(Nte,{fullHeight:!0,overflow:"hidden",children:[s.jsxs(N,{overflow:"auto",gap:0,visible:I===0,children:[s.jsx("input",{type:"text",className:"form-control form-control-sm w-100 px-2",placeholder:g("generic.search"),value:f,maxLength:50,onChange:A=>E(A.target.value),style:{display:I===0?"":"none"}}),s.jsx(Rv,{list:u.filter(A=>A.id>0&&A.name.length&&A.name.toLowerCase().includes(f.toLowerCase())),selectedFriendsIds:i,selectFriend:R,isOpen:I===0})]}),s.jsxs(N,{overflow:"auto",gap:0,visible:I===1,children:[s.jsx("input",{type:"text",className:"form-control form-control-sm w-100 px-2",placeholder:g("generic.search"),value:f,maxLength:50,onChange:A=>E(A.target.value),style:{display:I===1?"":"none"}}),s.jsx(Rv,{list:d.filter(A=>A.id>0&&A.name.length&&A.name.toLowerCase().includes(f.toLowerCase())),selectedFriendsIds:i,selectFriend:R,isOpen:I===1})]}),I==2&&s.jsx(wne,{headerText:g("friendlist.tab.friendrequests")+` (${_.length})`,isExpanded:!0}),I===3&&s.jsx(N,{overflow:"auto",gap:0,children:s.jsx(Gne,{})})]}),i&&i.length>0&&I<2&&s.jsxs(x,{gap:1,className:"px-1",children:[I===0&&s.jsx(X,{classNames:["border-0"],variant:"success",fullWidth:!0,onClick:()=>o(!0),children:s.jsxs("div",{className:"text-white",children:[g("friendlist.tip.invite")," (",i.length,")"]})}),s.jsxs(X,{classNames:["border-0"],fullWidth:!0,variant:"danger",onClick:A=>c(!0),children:[g("generic.delete")," (",i.length,")"]})]}),I<2&&s.jsxs(x,{gap:1,className:"px-1",children:[i.length>0&&s.jsx(X,{classNames:["border-0"],fullWidth:!0,onClick:()=>r([]),children:g("generic.deselectall")}),i.length<u.filter(A=>A.id>0).map(A=>A.id).length&&s.jsx(X,{classNames:["border-0"],fullWidth:!0,onClick:()=>{I===0?r(u.filter(A=>A.id>0).map(A=>A.id)):I===1&&r(d.filter(A=>A.id>0).map(A=>A.id))},children:g("generic.selectall")})]})]})}),n&&s.jsx(kne,{selectedFriendsIds:i,onCloseClick:()=>o(!1),sendRoomInvite:O}),l&&s.jsx(Fne,{selectedFriendsIds:i,removeFriendsText:S,onCloseClick:()=>c(!1),removeSelectedFriends:C})]}):null},_B=a=>{const{sendChatValue:e=null}=a,[t,i]=h.useState(null),[r,n]=h.useState(!1),o=c=>{let u=!1;n(d=>(u=!d,u)),u&&i(c.target)};h.useEffect(()=>{r||i(null)},[r]);const l=c=>{e(c.preview.url,!1,!0,!1),n(!1)};return s.jsxs(s.Fragment,{children:[s.jsx(q,{pointer:!0,className:"icon chatgif-icon",onClick:o}),s.jsx(Kd,{show:r,target:t,placement:"top",children:s.jsx(Oc,{className:"nitro-chat-gif-selector-container",children:s.jsx(be,{overflow:"hidden",className:"bg-transparent",children:s.jsx(mV,{tenorApiKey:"AIzaSyCVjvkHkNlDD8t8n2ZUKkmIee6CekeL7DA",width:"220px",height:"300px",onGifClick:l})})})})]})},gB=a=>{const{setChatValue:e=null}=a,[t,i]=h.useState(!1),[r,n]=h.useState(null),{isMobile:o}=Ia(),[l,c]=h.useState(null),u=_=>{e(m=>m+_.native)},d=_=>{let m=!1;i(f=>(m=!f,m)),m&&c(_.target)};return h.useEffect(()=>{t||c(null)},[t]),h.useEffect(()=>{if(t)return;const _=["😀","😁","😂","🤣","😃","😄","😅","😆","😉","😊","😋","😎","😍","😘","😗","😙","😚","🙂","🤗","🤩","🤔","🤨","😐","😑","😶","🙄","😏","😣","😥","😮","😯","😪","😫","😴","😌","😛","😜","🤪","😝","🤑","🤭","🤫","🤥","😬","😰","😱","😨","😩","😧","😦","😵","😲","😳","🥺","🤯"],m=Math.floor(Math.random()*_.length);n(_[m])},[t,n]),s.jsxs(s.Fragment,{children:[s.jsx(q,{pointer:!0,className:"z-index-1 chatstyles text-black",onClick:d,children:r}),s.jsx(Kd,{show:t,target:l,placement:"top",children:s.jsx(Oc,{className:"emoji-chatinput-selector-component",onMouseLeave:()=>i(!1),children:s.jsx(be,{overflow:"hidden",className:"bg-transparent emoji-chatemoji-selector",children:s.jsx(fV,{theme:"light",data:ky,onEmojiSelect:u,perLine:o?5:6,previewPosition:"none",locale:"pt"})})})})]})},mB=a=>{const{sendChatValue:e=null,customClass:t=null}=a,{status:i,startRecording:r,stopRecording:n,clearBlobUrl:o,mediaBlobUrl:l}=pV.useReactMediaRecorder({audio:{echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1},blobPropertyBag:{type:"audio/mp3"}}),c=h.useRef(),u=h.useRef(),[d,_]=h.useState(null),[m,f]=h.useState(!1),E=h.useRef();h.useEffect(()=>{m||_(null)},[m]);const I=async O=>{const C=await fetch(l).then(b=>b.blob()),A=new FormData;A.append("audio",C),fetch("https://hubbe.biz/audio/upload",{method:"POST",body:A}).then(b=>b.json()).then(b=>{b.error||e(`https://cdn.hubbe.biz/audios/${b.link}.mp3`,!1,!1,!0)}),f(!1)},p=()=>{clearTimeout(E.current),n(),f(!0)},S=()=>{o(),f(!1)},R=()=>{o(),r(),E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{p()},15e3),f(!1)};return s.jsxs(s.Fragment,{children:[s.jsx(q,{pointer:!0,innerRef:c,children:s.jsxs("div",{className:t,children:[(i==="idle"||i==="paused"||i==="stopped")&&s.jsx("i",{onClick:R,className:"fa-solid fa-microphone button-mic-input",style:{color:"white",fontSize:"16px"}}),(i==="recording"||i==="acquiring_media")&&s.jsx("i",{onClick:p,className:"fa-solid fa-stop button-mic-input",style:{color:"red",fontSize:"17px"}})]})}),s.jsx(Kd,{show:m,target:c.current,placement:"top",children:s.jsx(Oc,{className:"nitro-chat-gif-selector-container",children:s.jsxs("div",{className:"bg-transparent p-2",children:[s.jsx("i",{onClick:()=>{u.current&&u.current.play()},style:{color:"black",fontSize:"16px"},className:"fa-solid fa-play button-mic-input"}),s.jsx("i",{onClick:S,className:"fa-solid fa-trash button-mic-input",style:{color:"red",fontSize:"16px",marginLeft:"5px"}}),s.jsx("i",{onClick:I,className:"fa-solid fa-paper-plane button-mic-input",style:{color:"#0088CC",fontSize:"16px",marginLeft:"5px"}}),s.jsx("audio",{ref:u,src:l})]})})})]})},Vne=a=>{const{thread:e=null,group:t=null}=a,{showGifs:i}=Ea(),{showConfirm:r=null}=kt(),n=h.useMemo(()=>t.type===Hu.GROUP_CHAT&&vk(t.chats[0].extraData),[t]),o=h.useMemo(()=>!e||!t?!1:!!(t.type===Hu.PRIVATE_CHAT&&t.userId===te().userId||n&&t.chats.length&&n.userId===te().userId),[e,t,n]),l=u=>{r(g("messenger.openlink.confirm.body",["url"],[u]),()=>{window.open(u,"_blank")},null,null,null,g("messenger.openlink.confirm.title"),"centered")},c=({attributes:u,content:d})=>{const{href:_,...m}=u;return s.jsx("div",{style:{color:"#00aeff",textDecoration:"underline"},onClick:()=>l(d),...m,children:d})};return!e||!t?null:t.userId?s.jsxs(x,{fullWidth:!0,justifyContent:o?"end":"start",children:[s.jsxs(q,{shrink:!0,className:"message-avatar",children:[t.type===Hu.PRIVATE_CHAT&&!o&&s.jsx(ls,{figure:e.participant.figure,headOnly:!0,direction:3}),n&&!o&&s.jsx(ls,{figure:n.figure,headOnly:!0,direction:3})]}),s.jsxs(q,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-1 messages-group-"+(o?"right":"left"),children:[s.jsxs(q,{className:"fw-bold",children:[o&&"Você",!o&&(n?n.username:e.participant.name)]}),t.chats.map((u,d)=>Va(u.message)?s.jsx(WN,{src:u.message},d):Va(u.message,"gif")?s.jsx(HN,{src:u.message,showGifs:i},d):s.jsx(q,{className:"text-break text-message",children:s.jsx(EV,{options:{render:c},children:u.message})},d))]}),o&&s.jsx(q,{shrink:!0,className:"message-avatar",children:s.jsx(ls,{figure:te().figure,headOnly:!0,direction:3})})]}):s.jsx(s.Fragment,{children:t.chats.map((u,d)=>s.jsx(x,{fullWidth:!0,gap:2,justifyContent:"start",children:s.jsxs(q,{className:"w-100 text-break",children:[u.type===ua.SECURITY_NOTIFICATION&&s.jsxs(x,{gap:2,alignItems:"center",className:"bg-light rounded mb-2 px-2 py-1 small text-muted",children:[s.jsx(q,{className:"nitro-friends-spritesheet icon-warning flex-shrink-0"}),s.jsx(q,{children:u.message})]}),u.type===ua.ROOM_INVITE&&s.jsxs(x,{gap:2,alignItems:"center",className:"messenger-box rounded mb-2 px-2 py-1 small",children:[s.jsx(q,{className:"messenger-notification-icon flex-shrink-0"}),s.jsxs(q,{children:[g("messenger.invitation")+" ",u.message]})]}),u.type===ua.STATUS_NOTIFICATION&&s.jsxs(x,{gap:2,alignItems:"center",className:"messenger-box-notify rounded mb-2 px-2 py-1 small",children:[s.jsx(q,{className:"messenger-notification-status-icon flex-shrink-0"}),s.jsx(q,{children:u.message})]})]})},d))})},Hne=a=>{const{thread:e=null}=a;return e.setRead(),s.jsx(s.Fragment,{children:e.groups.length>0&&e.groups.map((t,i)=>s.jsx(Vne,{thread:e,group:t},i))})},Wne=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(-1),[n,o]=h.useState(""),{visibleThreads:l=[],activeThread:c=null,getMessageThread:u=null,messageThreads:d=[],sendMessage:_=null,setActiveThreadId:m=null,closeThread:f=null}=kG(),{report:E=null}=Rn(),I=h.useRef(),p=()=>c&&c.participant&&K(new dT(c.participant.id)),S=()=>c&&c.participant&&ir(c.participant.id),R=()=>{!c||!n.length||(_(c,te().userId,n),o(""))},O=A=>{A.key==="Enter"&&R()},C=(A,b=!1)=>{_(c,te().userId,A)};return h.useEffect(()=>{const A={linkReceived:b=>{const y=b.split("/");if(y.length===2){if(y[1]==="open"){t(!0);return}if(y[1]==="toggle"){t(U=>!U);return}const M=u(parseInt(y[1]));if(!M)return;m(M.threadId),t(!0)}},eventUrlPrefix:"friends-messenger/"};return fs(A),()=>ps(A)},[u,m]),h.useEffect(()=>{!e||!c||(I.current.scrollTop=I.current.scrollHeight)},[e,c]),h.useEffect(()=>{if(e&&!c){i>0?m(i):l.length>0&&m(l[0].threadId);return}!e&&c&&(r(c.threadId),m(-1))},[e,c,i,l,m]),e?s.jsx(ve,{className:"nitro-friends-messenger",uniqueKey:"nitro-friends-messenger",theme:"primary-slim",children:s.jsx(be,{children:s.jsxs(Ye,{overflow:"hidden",children:[s.jsx(N,{size:2,overflow:"hidden",style:{width:"150px"},children:s.jsx(N,{fit:!0,overflow:"auto",children:s.jsx(N,{style:{paddingRight:"6px"},children:l&&l.length>0&&l.map(A=>{var b;return s.jsxs(ct,{className:"container-friend-messenger",itemActive:c===A,onClick:y=>m(A.threadId),children:[s.jsx("div",{className:"close-messenger",onClick:y=>f(c.threadId),children:s.jsx(pr,{className:"fa-icon w-12 h-12"})}),A.unread&&s.jsx(wo,{className:"nitro-item-count-messenger",count:A.unreadCount}),s.jsx(x,{fullWidth:!0,alignItems:"center",children:s.jsxs(x,{className:"position-relative",children:[s.jsxs(x,{alignItems:"center",className:"friend-head",children:[A.participant.id>0&&s.jsx(ls,{figure:A.participant.figure,headOnly:!0,direction:3}),A.participant.id<=0&&s.jsx(as,{isGroup:!0,badgeCode:A.participant.figure})]}),s.jsx("div",{className:`friend-${A.participant.online?"online":"offline"}`}),s.jsxs(N,{gap:1,style:{marginTop:"4px",maxWidth:"60px"},children:[s.jsx(T,{truncate:!0,bold:!0,children:A.participant.name}),s.jsx(T,{truncate:!0,variant:"muted",children:(b=d.find(y=>y.participant.id===A.participant.id))==null?void 0:b.lastMessage})]})]})})]},A.threadId)})})})}),s.jsxs(N,{size:10,overflow:"hidden",children:[s.jsxs(x,{classNames:["header-friends drag-handler"],alignItems:"center",justifyContent:"between",gap:1,children:[c&&s.jsxs(x,{className:"position-relative",gap:2,children:[s.jsxs(x,{alignItems:"center",className:"friend-thread-head",children:[c.participant.id>0&&s.jsx(ls,{figure:c.participant.figure,headOnly:!0,direction:3}),c.participant.id<=0&&s.jsx(as,{isGroup:!0,badgeCode:c.participant.figure})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:c.participant.name}),s.jsx(T,{truncate:!0,style:{maxWidth:"150px"},children:c.participant.motto})]})]}),s.jsxs(x,{gap:1,children:[c&&s.jsxs(s.Fragment,{children:[c.participant.followingAllowed&&s.jsx(x,{justifyContent:"center",alignItems:"center",classNames:["button-actions shadow-button"],onClick:p,children:s.jsx(q,{className:"icon-follow-new"})}),s.jsx(x,{justifyContent:"center",alignItems:"center",classNames:["button-actions shadow-button"],onClick:S,children:s.jsx(q,{className:"nitro-friends-spritesheet icon-profile-sm"})}),s.jsx(x,{justifyContent:"center",alignItems:"center",classNames:["button-actions shadow-button"],onClick:()=>E(xs.IM,{reportedUserId:c.participant.id}),children:s.jsx(q,{className:"icon-warning-new"})})]}),s.jsx(x,{justifyContent:"center",alignItems:"center",classNames:["button-actions shadow-button white"],onClick:A=>t(!1),children:s.jsx(pr,{className:"fa-icon"})})]})]}),c&&s.jsxs(s.Fragment,{children:[s.jsx(N,{fit:!0,className:"p-2 rounded chat-messages",children:s.jsx(N,{className:"messages__container",innerRef:I,overflow:"auto",children:s.jsx(Hne,{thread:c})})}),s.jsxs(x,{gap:1,alignItems:"center",classNames:["console-bottom"],children:[s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:255,placeholder:g("messenger.window.input.default",["FRIEND_NAME"],[c.participant.name]),value:n,onChange:A=>o(A.target.value),onKeyDown:O}),s.jsx(gB,{setChatValue:o}),s.jsx(_B,{sendChatValue:C}),s.jsx(x,{justifyContent:"center",alignItems:"center",classNames:["button-actions shadow-button send-message"],onClick:R,children:g("widgets.chatinput.say")}),s.jsx(mB,{customClass:"button-actions shadow-button send-voice",sendChatValue:C})]})]})]})]})})}):null},Yne=a=>{const{settings:e=null,onlineFriends:t=[]}=Jr();return e?s.jsxs(s.Fragment,{children:[tC.createPortal(s.jsx(jne,{onlineFriends:t}),document.getElementById("toolbar-friend-bar-container")),s.jsx(Bne,{}),s.jsx(Wne,{})]}):null},zne=()=>{const{games:a,selectedGame:e,setSelectedGame:t}=vT(),i=n=>{let o=["game-icon"];return e===n&&o.push("selected"),o.join(" ")},r=n=>`url(${n.assetUrl}${n.gameNameId}_icon.png)`;return s.jsxs(q,{fullWidth:!0,className:"gameList-container bg-dark p-1",children:[g("gamecenter.game_list_title"),s.jsx(x,{gap:3,children:a&&a.map((n,o)=>s.jsx(q,{className:i(n),onClick:l=>t(n),style:{backgroundImage:r(n)}},o))})]})},Kne=()=>{const{gameURL:a,setGameURL:e}=vT(),[t,i]=h.useState(0),r=h.useRef();return h.useEffect(()=>{if(!r||r&&!r.current)return;i(0);let n=document.createElement("iframe");n.src=a,n.classList.add("game-center-stage"),n.classList.add("h-100"),n.onload=()=>{i(o=>o+=1)},r.current.innerHTML="",r.current.appendChild(n)},[r,a]),h.useEffect(()=>{t>1&&(e(null),K(new FP))},[t,e]),a?s.jsx(q,{innerRef:r,className:"game-center-stage"}):null},qne=()=>{const{selectedGame:a,accountStatus:e}=vT();h.useEffect(()=>{a&&(K(new BP(a.gameId)),K(new kP(a.gameId)))},[a]);const t=()=>sr.uintHexColor(a.bgColor),i=()=>`url(${a.assetUrl}${a.gameNameId}_theme.png)`,r=()=>sr.uintHexColor(a.textColor),n=()=>{K(new HP(a.gameId))};return!e||!a?null:s.jsxs(x,{className:"game-view py-4",fullHeight:!0,style:{backgroundColor:t(),backgroundImage:i(),color:r()},children:[s.jsxs(x,{className:"w-75",column:!0,alignItems:"center",gap:2,children:[s.jsx(T,{bold:!0,children:g(`gamecenter.${a.gameNameId}.description_title`)}),s.jsx("img",{src:a.assetUrl+a.gameNameId+"_logo.png"}),(e.hasUnlimitedGames||e.freeGamesLeft>0)&&s.jsx(s.Fragment,{children:s.jsxs(X,{variant:"light",position:"relative",className:"px-4",onClick:n,children:[g("gamecenter.play_now"),!e.hasUnlimitedGames&&s.jsx(wo,{className:"me-n1 mt-n1",count:e.freeGamesLeft})]})}),s.jsx(T,{bold:!0,className:"w-50",center:!0,children:g(`gamecenter.${a.gameNameId}.description_content`)})]}),s.jsx(q,{className:"w-25"})]})},Xne=()=>{const{isVisible:a,setIsVisible:e,games:t,accountStatus:i}=vT();if(h.useEffect(()=>{const r=()=>{e(o=>!o)},n={linkReceived:o=>{switch(o.split("/")[1]){case"toggle":r();break}},eventUrlPrefix:"games/"};return fs(n),()=>ps(n)},[]),!(!a||!t))return s.jsxs(x,{position:"absolute",className:"top-0 bottom-0 start-0 end-0 bg-black",justifyContent:"center",children:[s.jsxs(x,{className:"game-center-main",column:!0,children:[s.jsx(qne,{}),s.jsx(zne,{})]}),s.jsx(Kne,{})]})},$ne=[0,1,2,3,4,5,6,7,8],Qne=a=>{const{badgeParts:e=[],setBadgeParts:t=null}=a,[i,r]=h.useState(-1),{groupCustomize:n=null}=Tm(),o=(l,c,u)=>{const d=[...e];d[l][c]=u,t(d),c==="key"&&r(-1)};return!e||!e.length?null:s.jsxs(s.Fragment,{children:[i<0&&e&&e.length>0&&e.map((l,c)=>s.jsxs(x,{alignItems:"center",justifyContent:"between",gap:2,className:"bg-muted rounded px-2 py-1",children:[s.jsxs(x,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:u=>r(c),children:[e[c].code&&e[c].code.length>0&&s.jsx(as,{badgeCode:e[c].code,isGroup:!0}),(!e[c].code||!e[c].code.length)&&s.jsx(x,{center:!0,className:"badge-image group-badge",children:s.jsx(zd,{className:"fa-icon"})})]}),l.type!==_n.BASE&&s.jsx(Ye,{gap:1,columnCount:3,children:$ne.map((u,d)=>s.jsx(q,{pointer:!0,className:`group-badge-position-swatch ${e[c].position===u?"active":""}`,onClick:_=>o(c,"position",u)},d))}),s.jsx(Ye,{gap:1,columnCount:8,children:n.badgePartColors.length>0&&n.badgePartColors.map((u,d)=>s.jsx(q,{pointer:!0,className:`group-badge-color-swatch ${e[c].color===d+1?"active":""}`,style:{backgroundColor:"#"+u.color},onClick:_=>o(c,"color",d+1)},d))})]},c)),i>=0&&s.jsxs(Ye,{gap:1,columnCount:5,children:[e[i].type===_n.SYMBOL&&s.jsx(N,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:l=>o(i,"key",0),children:s.jsx(x,{center:!0,className:"badge-image group-badge",children:s.jsx(pr,{className:"fa-icon"})})}),(e[i].type===_n.BASE?n.badgeBases:n.badgeSymbols).map((l,c)=>s.jsx(N,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:u=>o(i,"key",l.id),children:s.jsx(as,{badgeCode:_n.getCode(e[i].type,l.id,e[i].color,4),isGroup:!0})},c))]})]})},fB=a=>{const{groupData:e=null,setGroupData:t=null,setCloseAction:i=null,skipDefault:r=null}=a,[n,o]=h.useState(null),{groupCustomize:l=null}=Tm(),c=()=>{if(!n||!n.length)return"";let d="";return n.forEach(_=>_.code&&(d+=_.code)),d},u=h.useCallback(()=>{if(!e||!n||!n.length)return!1;if(e.groupBadgeParts===n)return!0;if(e.groupId<=0)return t(_=>{const m={..._};return m.groupBadgeParts=n,m}),!0;const d=[];return n.forEach(_=>{_.code&&(d.push(_.key),d.push(_.color),d.push(_.position))}),K(new tU(e.groupId,d)),!0},[e,n,t]);return h.useEffect(()=>{if(e.groupBadgeParts)return;const d=[new _n(_n.BASE,l.badgeBases[0].id,l.badgePartColors[0].id),new _n(_n.SYMBOL,0,l.badgePartColors[0].id),new _n(_n.SYMBOL,0,l.badgePartColors[0].id),new _n(_n.SYMBOL,0,l.badgePartColors[0].id),new _n(_n.SYMBOL,0,l.badgePartColors[0].id)];t(_=>({..._,groupBadgeParts:d}))},[e.groupBadgeParts,l,t]),h.useEffect(()=>{if(e.groupId<=0){o(e.groupBadgeParts?[...e.groupBadgeParts]:null);return}o(e.groupBadgeParts)},[e]),h.useEffect(()=>(i({action:u}),()=>i(null)),[i,u]),s.jsxs(Ye,{overflow:"hidden",gap:1,children:[s.jsx(N,{size:2,children:s.jsx(x,{center:!0,className:"bg-muted rounded p-1",children:s.jsx(as,{badgeCode:c(),isGroup:!0})})}),s.jsx(N,{size:10,overflow:"auto",children:s.jsx(Qne,{badgeParts:n,setBadgeParts:o})})]})},pB=a=>{const{groupData:e=null,setGroupData:t=null,setCloseAction:i=null}=a,[r,n]=h.useState(null),{groupCustomize:o=null}=Tm(),l=d=>d===0?o.groupColorsA.find(_=>_.id===r[d]).color:o.groupColorsB.find(_=>_.id===r[d]).color,c=(d,_)=>{n(m=>{const f=[...m];return f[d]=_,f})},u=h.useCallback(()=>!e||!r||!r.length?!1:e.groupColors===r?!0:e.groupId<=0?(t(d=>{const _={...d};return _.groupColors=[...r],_}),!0):(K(new sU(e.groupId,r[0],r[1])),!0),[e,r,t]);return h.useEffect(()=>{if(!o.groupColorsA||!o.groupColorsB||e.groupColors)return;const d=[o.groupColorsA[0].id,o.groupColorsB[0].id];t(_=>({..._,groupColors:d}))},[o,e.groupColors,t]),h.useEffect(()=>{if(e.groupId<=0){n(e.groupColors?[...e.groupColors]:null);return}n(e.groupColors)},[e]),h.useEffect(()=>(i({action:u}),()=>i(null)),[i,u]),r?s.jsxs(Ye,{overflow:"hidden",children:[s.jsxs(N,{size:2,gap:1,children:[s.jsx(T,{bold:!0,children:g("group.edit.color.guild.color")}),e.groupColors&&e.groupColors.length>0&&s.jsxs(x,{overflow:"hidden",className:"rounded border",children:[s.jsx(q,{className:"group-color-swatch",style:{backgroundColor:"#"+l(0)}}),s.jsx(q,{className:"group-color-swatch",style:{backgroundColor:"#"+l(1)}})]})]}),s.jsxs(N,{size:5,gap:1,overflow:"hidden",children:[s.jsx(T,{bold:!0,children:g("group.edit.color.primary.color")}),s.jsx(Os,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:e.groupColors&&o.groupColorsA&&o.groupColorsA.map((d,_)=>s.jsx("div",{className:za("group-badge-color-swatch cursor-pointer",e.groupColors[0]===d.id&&"active"),style:{backgroundColor:"#"+d.color},onClick:()=>c(0,d.id)},_))})]}),s.jsxs(N,{size:5,gap:1,overflow:"hidden",children:[s.jsx(T,{bold:!0,children:g("group.edit.color.secondary.color")}),s.jsx(Os,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:e.groupColors&&o.groupColorsB&&o.groupColorsB.map((d,_)=>s.jsx("div",{className:za("group-badge-color-swatch cursor-pointer",e.groupColors[1]===d.id&&"active"),style:{backgroundColor:"#"+d.color},onClick:()=>c(1,d.id)},_))})]})]}):null},Jne=a=>{const{groupData:e=null,setGroupData:t=null,purchaseCost:i=0}=a,{groupCustomize:r=null}=Tm(),n=()=>{if(!e||!e.groupBadgeParts||!e.groupBadgeParts.length)return"";let l="";return e.groupBadgeParts.forEach(c=>c.code&&(l+=c.code)),l},o=l=>l===0?r.groupColorsA.find(c=>c.id===e.groupColors[l]).color:r.groupColorsB.find(c=>c.id===e.groupColors[l]).color;return e?s.jsxs(Ye,{overflow:"hidden",gap:1,children:[s.jsxs(N,{size:3,children:[s.jsxs(N,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[s.jsx(T,{bold:!0,center:!0,children:g("group.create.confirm.guildbadge")}),s.jsx(as,{badgeCode:n(),isGroup:!0})]}),s.jsxs(N,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[s.jsx(T,{bold:!0,center:!0,children:g("group.edit.color.guild.color")}),s.jsxs(x,{overflow:"hidden",className:"rounded border",children:[s.jsx(q,{className:"group-color-swatch",style:{backgroundColor:"#"+o(0)}}),s.jsx(q,{className:"group-color-swatch",style:{backgroundColor:"#"+o(1)}})]})]})]}),s.jsxs(N,{size:9,justifyContent:"between",children:[s.jsxs(N,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:e.groupName}),s.jsx(T,{children:e.groupDescription})]}),s.jsx(T,{overflow:"auto",children:g("group.create.confirm.info")})]}),s.jsx(T,{center:!0,variant:"white",className:"bg-primary rounded p-1",children:g("group.create.confirm.buyinfo",["amount"],[i.toString()])})]})]}):null},EB=a=>{const{groupData:e=null,setGroupData:t=null,setCloseAction:i=null,onClose:r=null,isCreator:n=!1,availableRooms:o=[]}=a,[l,c]=h.useState(""),[u,d]=h.useState(""),[_,m]=h.useState(-1),{showConfirm:f=null}=kt(),E=()=>{!e||e.groupId<=0||f(g("group.deleteconfirm.desc"),()=>{K(new $P(e.groupId)),r&&r()},null,null,null,g("group.deleteconfirm.title"))},I=h.useCallback(()=>!e||!l||!l.length?!1:l===e.groupName&&u===e.groupDescription?!0:e.groupId<=0?_<=0?!1:(t(p=>{const S={...p};return S.groupName=l,S.groupDescription=u,S.groupHomeroomId=_,S}),!0):(K(new iU(e.groupId,l,u||"")),!0),[e,l,u,_,t]);return h.useEffect(()=>{c(e.groupName||""),d(e.groupDescription||""),m(e.groupHomeroomId)},[e]),h.useEffect(()=>(i({action:I}),()=>i(null)),[i,I]),e?s.jsxs(N,{justifyContent:"between",overflow:"auto",children:[s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{center:!0,className:"col-3",children:g("group.edit.name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:l,maxLength:29,onChange:p=>c(p.target.value)})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{center:!0,className:"col-3",children:g("group.edit.desc")}),s.jsx("textarea",{className:"form-control form-control-sm",value:u,maxLength:254,onChange:p=>d(p.target.value)})]}),n&&s.jsxs(s.Fragment,{children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{center:!0,className:"col-3",children:g("group.edit.base")}),s.jsx(N,{fullWidth:!0,gap:1,children:s.jsxs("select",{className:"form-select form-select-sm",value:_,onChange:p=>m(parseInt(p.target.value)),children:[s.jsx("option",{value:-1,disabled:!0,children:g("group.edit.base.select.room")}),o&&o.map((p,S)=>s.jsx("option",{value:p.id,children:p.name},S))]})})]}),s.jsxs(x,{gap:1,children:[s.jsx(q,{className:"col-3",children:" "}),s.jsx(T,{small:!0,children:g("group.edit.base.warning")})]})]})]}),!n&&s.jsx(X,{variant:"danger",onClick:E,children:g("group.delete")}),n&&s.jsx(T,{underline:!0,center:!0,fullWidth:!0,pointer:!0,onClick:p=>Ce("navigator/create"),children:g("group.createroom")})]}):null},Zne=[1,2,3,4],eae=a=>{const{onClose:e=null}=a,[t,i]=h.useState(1),[r,n]=h.useState(null),[o,l]=h.useState(null),[c,u]=h.useState(null),[d,_]=h.useState(0),m=()=>{n(null),l(null),e&&e()},f=()=>{if(!o)return;const p=[];o.groupBadgeParts.forEach(S=>{S.code&&(p.push(S.key),p.push(S.color),p.push(S.position))}),K(new KP(o.groupName,o.groupDescription,o.groupHomeroomId,o.groupColors[0],o.groupColors[1],p))},E=()=>{if(!(r&&r.action&&!r.action())){if(t===1){e();return}i(p=>p-1)}},I=()=>{if(!(r&&r.action&&!r.action())){if(t===4){f();return}i(p=>p===4?p:p+1)}};return J(gM,p=>{const S=p.getParser(),R=[];S.availableRooms.forEach((O,C)=>R.push({id:C,name:O})),u(R),_(S.groupCost)}),h.useEffect(()=>{i(1),l({groupId:-1,groupName:null,groupDescription:null,groupHomeroomId:-1,groupState:1,groupCanMembersDecorate:!0,groupColors:null,groupBadgeParts:null}),K(new qP)},[l]),o?s.jsxs(ve,{className:"nitro-group-creator",theme:"primary-slim",children:[s.jsx(je,{headerText:g("group.create.title"),onCloseClick:m}),s.jsxs(be,{children:[s.jsx(x,{center:!0,className:"creator-tabs",children:Zne.map((p,S)=>s.jsx(x,{center:!0,className:`tab tab-${p===1?"blue-flat":p===4?"yellow":"blue-arrow"} ${t===p?"active":""}`,children:s.jsx(T,{variant:"white",children:g(`group.create.steplabel.${p}`)})},S))}),s.jsxs(N,{overflow:"hidden",children:[s.jsxs(x,{alignItems:"center",gap:2,children:[s.jsx(q,{className:`nitro-group-tab-image tab-${t}`}),s.jsxs(N,{grow:!0,gap:0,children:[s.jsx(T,{bold:!0,fontSize:4,children:g(`group.create.stepcaption.${t}`)}),s.jsx(T,{children:g(`group.create.stepdesc.${t}`)})]})]}),s.jsxs(N,{overflow:"hidden",children:[t===1&&s.jsx(EB,{groupData:o,setGroupData:l,setCloseAction:n,onClose:null,isCreator:!0,availableRooms:c}),t===2&&s.jsx(fB,{groupData:o,setGroupData:l,setCloseAction:n}),t===3&&s.jsx(pB,{groupData:o,setGroupData:l,setCloseAction:n}),t===4&&s.jsx(Jne,{groupData:o,setGroupData:l,purchaseCost:d})]}),s.jsxs(x,{justifyContent:"between",children:[s.jsx(X,{variant:"link",className:"text-black",onClick:E,children:g(t===1?"generic.cancel":"group.create.previousstep")}),s.jsx(X,{disabled:t===4&&!Uu(),variant:t===4?Uu()?"success":"danger":"primary",onClick:I,children:g(t===4?Uu()?"group.create.confirm.buy":"group.create.confirm.viprequired":"group.create.nextstep")})]})]})]})]}):null},tae=["regular","exclusive","private"],IB=a=>{const{groupInformation:e=null,onClose:t=null,overflow:i="hidden",primaryColor:r="",accentColor:n="",...o}=a,{showConfirm:l=null}=kt(),c=e&&e.ownerName===te().userName,u=()=>e&&xN(e.id),d=()=>{l(g("group.leaveconfirm.desc"),()=>{K(new _T(e.id,te().userId)),t&&t()},null)},_=()=>{if(e.type===Or.PRIVATE&&e.membershipType!==ci.MEMBER)return"";if(e.membershipType===ci.MEMBER)return g("group.leave");if(e.membershipType===ci.NOT_MEMBER&&e.type===Or.REGULAR)return g("group.join");if(e.membershipType===ci.REQUEST_PENDING)return g("group.membershippending");if(e.membershipType===ci.NOT_MEMBER&&e.type===Or.EXCLUSIVE)return g("group.requestmembership")},m=()=>{if(e.type===Or.PRIVATE&&e.membershipType!==ci.MEMBER||e.membershipType===ci.REQUEST_PENDING||e.membershipType===ci.NOT_MEMBER&&e.type===Or.EXCLUSIVE)return"primary";if(e.membershipType===ci.MEMBER)return"danger";if(e.membershipType===ci.NOT_MEMBER&&e.type===Or.REGULAR)return"success"},f=()=>{if(!(e.type===Or.PRIVATE&&e.membershipType===ci.NOT_MEMBER)){if(e.membershipType===ci.MEMBER){d();return}u()}},E=I=>{switch(I){case"members":Pb(e.id);break;case"members_pending":Pb(e.id,2);break;case"manage":ST(e.id);break;case"homeroom":qn(e.roomId);break;case"furniture":Ce("catalog/open/"+Yg.GUILD_CUSTOM_FURNI);break;case"popular_groups":Ce("navigator/search/groups");break}};return e?s.jsxs(Ye,{className:"bg-card-profile group-details p-1",overflow:i,...o,children:[s.jsxs(N,{size:3,gap:1,children:[s.jsx(x,{justifyContent:"center",alignItems:"center",overflow:"hidden",className:"group-bg-content badge-content rounded p-1",style:{background:n},children:s.jsx(as,{badgeCode:e.badge,isGroup:!0})}),s.jsxs(x,{onClick:()=>E("members"),center:!0,gap:1,className:"group-bg-content members rounded p-1",style:{background:n},children:[s.jsx("i",{className:"icon icon-avatar-members"}),s.jsx("div",{className:"cursor-pointer d-inline small",children:e.membersCount.toString()})]})]}),s.jsxs(N,{size:9,justifyContent:"between",overflow:"auto",children:[s.jsxs(N,{gap:1,overflow:"hidden",children:[s.jsx(N,{gap:1,children:s.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[s.jsxs(x,{gap:1,children:[s.jsx(T,{bold:!0,children:e.title}),s.jsxs(x,{gap:1,children:[s.jsx("i",{className:"icon icon-group-type-"+e.type,title:g(`group.edit.settings.type.${tae[e.type]}.help`)}),e.canMembersDecorate&&s.jsx("i",{className:"icon icon-group-decorate",title:g("group.memberscandecorate")}),s.jsx("i",{className:"icon furni-details-id",title:`ID: ${e.id}`})]})]}),e.isOwner&&s.jsx("i",{className:"icon icon-cog cursor-pointer",title:g("group.manage"),onClick:()=>E("manage")})]})}),s.jsx("div",{className:"overflow-auto d-inline text-black small group-description",children:e.description})]}),s.jsxs(x,{gap:1,children:[s.jsx(X,{variant:"gray",classNames:["border-0 button-group-actions"],onClick:()=>E("homeroom"),children:g("group.homeroominfo.title")}),(e.type!==Or.PRIVATE||e.type===Or.PRIVATE&&e.membershipType===ci.MEMBER)&&s.jsx(X,{variant:m(),classNames:["border-0 button-group-actions"],disabled:e.membershipType===ci.REQUEST_PENDING||c,onClick:f,children:_()})]})]})]}):null},sae=a=>{const[e,t]=h.useState(null);return J(Xd,i=>{const r=i.getParser();(e&&e.id===r.id||r.flag)&&t(r)}),e?s.jsxs(ve,{className:"nitro-group-information-standalone",theme:"primary-slim",children:[s.jsx(je,{headerText:g("group.window.title"),onCloseClick:i=>t(null)}),s.jsx(be,{children:s.jsx(IB,{groupInformation:e,onClose:()=>t(null)})})]}):null},iae=["regular","exclusive","private"],rae=a=>{const{groupData:e=null,setGroupData:t=null,setCloseAction:i=null}=a,[r,n]=h.useState(e.groupState),[o,l]=h.useState(e.groupCanMembersDecorate),c=h.useCallback(()=>e?r===e.groupState&&o===e.groupCanMembersDecorate?!0:e.groupId<=0?(t(u=>{const d={...u};return d.groupState=r,d.groupCanMembersDecorate=o,d}),!0):(K(new rU(e.groupId,r,o?0:1)),!0):!1,[e,r,o,t]);return h.useEffect(()=>{n(e.groupState),l(e.groupCanMembersDecorate)},[e]),h.useEffect(()=>(i({action:c}),()=>i(null)),[i,c]),s.jsxs(N,{overflow:"auto",children:[s.jsx(N,{children:iae.map((u,d)=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"groupState",checked:r===d,onChange:_=>n(d)}),s.jsxs(N,{gap:0,children:[s.jsxs(x,{gap:1,children:[s.jsx("i",{className:`icon icon-group-type-${d}`}),s.jsx(T,{bold:!0,children:g(`group.edit.settings.type.${u}.label`)})]}),s.jsx(T,{children:g(`group.edit.settings.type.${u}.help`)})]})]},d))}),s.jsx(Lte,{}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:o,onChange:u=>l(d=>!d)}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("group.edit.settings.rights.caption")}),s.jsx(T,{children:g("group.edit.settings.rights.members.help")})]})]})]})},nae=[1,2,3,5],aae=a=>{const[e,t]=h.useState(1),[i,r]=h.useState(null),[n,o]=h.useState(null),l=()=>{r(u=>(u&&u.action&&u.action(),null)),o(null)},c=u=>{i&&i.action&&i.action(),t(u)};return J(Xd,u=>{const d=u.getParser();!n||n.groupId!==d.id||o(_=>{const m={..._};return m.groupName=d.title,m.groupDescription=d.description,m.groupState=d.type,m.groupCanMembersDecorate=d.canMembersDecorate,m})}),J(EM,u=>{const d=u.getParser(),_=[];d.badgeParts.forEach((m,f)=>{_.push(new xc(m.isBase?xc.BASE:xc.SYMBOL,m.key,m.color,m.position))}),o({groupId:d.id,groupName:d.title,groupDescription:d.description,groupHomeroomId:d.roomId,groupState:d.state,groupCanMembersDecorate:d.canMembersDecorate,groupColors:[d.colorA,d.colorB],groupBadgeParts:_})}),!n||n.groupId<=0?null:s.jsxs(ve,{className:"nitro-group-manager",children:[s.jsx(je,{headerText:g("group.window.title"),onCloseClick:l}),s.jsx($n,{children:nae.map(u=>s.jsx(In,{isActive:e===u,onClick:()=>c(u),children:g(`group.edit.tab.${u}`)},u))}),s.jsxs(be,{children:[s.jsxs(x,{alignItems:"center",gap:2,children:[s.jsx(q,{className:`nitro-group-tab-image tab-${e}`}),s.jsxs(N,{grow:!0,gap:0,children:[s.jsx(T,{bold:!0,fontSize:4,children:g(`group.edit.tabcaption.${e}`)}),s.jsx(T,{children:g(`group.edit.tabdesc.${e}`)})]})]}),s.jsxs(N,{grow:!0,overflow:"hidden",children:[e===1&&s.jsx(EB,{groupData:n,setGroupData:o,setCloseAction:r,onClose:l}),e===2&&s.jsx(fB,{groupData:n,setGroupData:o,setCloseAction:r,skipDefault:!0}),e===3&&s.jsx(pB,{groupData:n,setGroupData:o,setCloseAction:r}),e===5&&s.jsx(rae,{groupData:n,setGroupData:o,setCloseAction:r})]})]})]})},oae=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),[n,o]=h.useState(null),[l,c]=h.useState(-1),[u,d]=h.useState(0),[_,m]=h.useState(""),[f,E]=h.useState(null),{showConfirm:I=null}=kt(),p=A=>{if(A.rank===nr.OWNER)return"group.members.owner";if(n.admin){if(A.rank===nr.ADMIN)return"group.members.removerights";if(A.rank===nr.MEMBER)return"group.members.giverights"}return""},S=h.useCallback(()=>{e===-1||i===-1||l===-1||K(new mx(e,l,_,i))},[e,i,l,_]),R=A=>{!n.admin||A.rank===nr.OWNER||(A.rank!==nr.ADMIN?K(new WP(n.groupId,A.id)):K(new YP(n.groupId,A.id)),S())},O=A=>{!n.admin||A.rank!==nr.REQUESTED||(K(new ZP(n.groupId,A.id)),S())},C=A=>{if(n.admin){if(A.rank===nr.REQUESTED){K(new eU(n.groupId,A.id)),S();return}E(A.name),K(new XP(n.groupId,A.id))}};return J(fM,A=>{const b=A.getParser();o(b),r(b.level),d(Math.ceil(b.totalMembersCount/b.pageSize))}),J(mM,A=>{const b=A.getParser();I(g(b.furnitureCount>0?"group.kickconfirm.desc":"group.kickconfirm_nofurni.desc",["user","amount"],[f,b.furnitureCount.toString()]),()=>{K(new _T(n.groupId,b.userId)),S()},null),E(null)}),h.useEffect(()=>{const A={linkReceived:b=>{const y=b.split("/");if(y.length<2)return;const M=parseInt(y[1])||-1,U=parseInt(y[2])||3;t(M),r(U),c(0)},eventUrlPrefix:"group-members/"};return fs(A),()=>ps(A)},[]),h.useEffect(()=>{c(0)},[e,i,_]),h.useEffect(()=>{e===-1||i===-1||l===-1||K(new mx(e,l,_,i))},[e,i,l,_]),h.useEffect(()=>{e!==-1&&(r(-1),o(null),d(0),m(""),E(null))},[e]),e===-1||!n?null:s.jsxs(ve,{className:"nitro-group-members",theme:"primary-slim",children:[s.jsx(je,{headerText:g("group.members.title",["groupName"],[n?n.groupTitle:""]),onCloseClick:A=>t(-1)}),s.jsxs(be,{overflow:"hidden",children:[s.jsxs(x,{gap:2,children:[s.jsx(x,{center:!0,className:"group-badge",children:s.jsx(as,{badgeCode:n.badge,isGroup:!0,className:"mx-auto d-block"})}),s.jsxs(N,{fullWidth:!0,gap:1,children:[s.jsx("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:g("group.members.searchinfo"),value:_,onChange:A=>m(A.target.value)}),s.jsxs("select",{className:"form-select form-select-sm w-100",value:i,onChange:A=>r(parseInt(A.target.value)),children:[s.jsx("option",{value:"0",children:g("group.members.search.all")}),s.jsx("option",{value:"1",children:g("group.members.search.admins")}),s.jsx("option",{value:"2",children:g("group.members.search.pending")})]})]})]}),s.jsx(Ye,{columnCount:2,overflow:"auto",className:"nitro-group-members-list-grid",children:n.result.map((A,b)=>s.jsxs(x,{gap:2,alignItems:"center",overflow:"hidden",className:"member-list-item bg-white rounded p-2",children:[s.jsx("div",{className:"avatar-head cursor-pointer",onClick:()=>ir(A.id),children:s.jsx(ls,{figure:A.figure,headOnly:!0,direction:2})}),s.jsxs(N,{grow:!0,gap:1,children:[s.jsx(T,{bold:!0,small:!0,pointer:!0,onClick:y=>ir(A.id),children:A.name}),A.rank!==nr.REQUESTED&&s.jsx(T,{small:!0,italics:!0,variant:"muted",children:g("group.members.since",["date"],[A.joinedAt])})]}),s.jsxs(N,{gap:1,children:[A.rank!==nr.REQUESTED&&s.jsx(x,{center:!0,children:s.jsx(q,{pointer:n.admin,className:`icon icon-group-small-${A.rank===nr.OWNER?"owner":A.rank===nr.ADMIN?"admin":n.admin&&A.rank===nr.MEMBER?"not-admin":""}`,title:g(p(A)),onClick:y=>R(A)})}),n.admin&&A.rank===nr.REQUESTED&&s.jsx(x,{alignItems:"center",children:s.jsx(q,{pointer:!0,className:"nitro-friends-spritesheet icon-accept",title:g("group.members.accept"),onClick:y=>O(A)})}),n.admin&&A.rank!==nr.OWNER&&A.id!==te().userId&&s.jsx(x,{alignItems:"center",children:s.jsx(q,{pointer:!0,className:"nitro-friends-spritesheet icon-deny",title:g(A.rank===nr.REQUESTED?"group.members.reject":"group.members.kick"),onClick:y=>C(A)})})]})]},b))}),s.jsxs(x,{gap:1,justifyContent:"between",alignItems:"center",children:[s.jsx(X,{disabled:n.pageIndex===0,onClick:A=>c(b=>b-1),children:s.jsx(ds,{className:"fa-icon"})}),s.jsx(T,{small:!0,children:g("group.members.pageinfo",["amount","page","totalPages"],[n.totalMembersCount.toString(),(n.pageIndex+1).toString(),u.toString()])}),s.jsx(X,{disabled:n.pageIndex===u-1,onClick:A=>c(b=>b+1),children:s.jsx(_s,{className:"fa-icon"})})]})]})]})},lae=a=>{const[e,t]=h.useState(!1);return Tm(),J(pM,i=>{const r=i.getParser();t(!1),qn(r.roomId)}),h.useEffect(()=>{const i={linkReceived:r=>{const n=r.split("/");if(!(n.length<2))switch(n[1]){case"create":t(!0);return;case"manage":if(!n[2])return;t(!1),K(new nU(Number(n[2])));return}},eventUrlPrefix:"groups/"};return fs(i),()=>ps(i)},[]),s.jsxs(s.Fragment,{children:[e&&s.jsx(eae,{onClose:()=>t(!1)}),!e&&s.jsx(aae,{}),s.jsx(oae,{}),s.jsx(sae,{})]})},cae=a=>{const{helpRequestDescription:e=null,helpRequestAverageTime:t=0}=a,i=r=>K(new AU(r));return s.jsxs(N,{children:[s.jsxs(N,{gap:0,className:"bg-muted p-2 rounded",children:[s.jsx(T,{bold:!0,children:g("guide.help.request.guide.accept.request.title")}),s.jsx(T,{variant:"muted",children:g("guide.help.request.type.1")}),s.jsx(T,{wrap:!0,textBreak:!0,children:e})]}),s.jsxs(N,{gap:1,children:[s.jsx(X,{variant:"success",onClick:r=>i(!0),children:g("guide.help.request.guide.accept.accept.button")}),s.jsx(X,{variant:"danger",onClick:r=>i(!1),children:g("guide.help.request.guide.accept.skip.link")})]})]})},uae=a=>{const{isOnDuty:e=!1,isHandlingGuideRequests:t=!1,setIsHandlingGuideRequests:i=null,isHandlingHelpRequests:r=!1,setIsHandlingHelpRequests:n=null,isHandlingBullyReports:o=!1,setIsHandlingBullyReports:l=null,guidesOnDuty:c=0,helpersOnDuty:u=0,guardiansOnDuty:d=0,processAction:_=null}=a;return s.jsxs(N,{children:[s.jsxs(x,{alignItems:"center",gap:2,className:"bg-muted p-2 rounded",children:[s.jsx(q,{className:"duty-switch"+(e?"":" off"),onClick:m=>_("toggle_duty")}),s.jsxs(N,{gap:0,children:[s.jsx(T,{bold:!0,children:g("guide.help.guide.tool.yourstatus")}),s.jsx(T,{children:g(`guide.help.guide.tool.duty.${e?"on":"off"}`)})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("guide.help.guide.tool.tickettypeselection.caption")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:t,onChange:m=>i(m.target.checked)}),s.jsx(T,{children:g("guide.help.guide.tool.tickettypeselection.guiderequests")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:r,onChange:m=>n(m.target.checked)}),s.jsx(T,{children:g("guide.help.guide.tool.tickettypeselection.onlyhelprequests")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:o,onChange:m=>l(m.target.checked)}),s.jsx(T,{children:g("guide.help.guide.tool.tickettypeselection.bullyreports")})]})]}),s.jsx("hr",{className:"bg-dark m-0"}),s.jsxs(x,{center:!0,gap:2,children:[s.jsx(q,{className:"info-icon"}),s.jsxs(N,{gap:1,children:[s.jsx(q,{dangerouslySetInnerHTML:{__html:g("guide.help.guide.tool.guidesonduty",["amount"],[c.toString()])}}),s.jsx(q,{dangerouslySetInnerHTML:{__html:g("guide.help.guide.tool.helpersonduty",["amount"],[u.toString()])}}),s.jsx(q,{dangerouslySetInnerHTML:{__html:g("guide.help.guide.tool.guardiansonduty",["amount"],[d.toString()])}})]})]}),s.jsx("hr",{className:"bg-dark m-0"}),s.jsxs(x,{justifyContent:"between",gap:2,children:[s.jsx(X,{disabled:!0,onClick:m=>_("forum_link"),children:g("guide.help.guide.tool.forum.link")}),s.jsx(X,{disabled:!0,children:g("guide.help.guide.tool.skill.link")})]})]})},hae=a=>{const e=h.useRef(null),{isGuide:t=!1,userId:i=0,userName:r=null,userFigure:n=null,isTyping:o=!1,messageGroups:l=[]}=a,[c,u]=h.useState("");h.useEffect(()=>{var p;(p=e.current)==null||p.scrollIntoView({block:"end",behavior:"smooth"})},[l]);const d=h.useCallback(()=>{K(new NU)},[]),_=h.useCallback(()=>{K(new bU)},[]),m=h.useCallback(()=>{K(new DU)},[]);J(BM,p=>{const S=p.getParser();qn(S.requesterRoomId)});const f=h.useCallback(()=>{!c||!c.length||(K(new vU(c)),u(""))},[c]),E=h.useCallback(p=>{p.key==="Enter"&&f()},[f]),I=h.useCallback(p=>p===te().userId,[]);return s.jsxs(N,{fullHeight:!0,children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[t&&s.jsxs(Ya,{children:[s.jsx(X,{onClick:d,children:g("guide.help.request.guide.ongoing.visit.button")}),s.jsx(X,{onClick:_,children:g("guide.help.request.guide.ongoing.invite.button")})]}),!t&&s.jsxs(N,{gap:0,children:[s.jsx(T,{bold:!0,children:r}),s.jsx(T,{children:g("guide.help.request.user.ongoing.guide.desc")})]}),s.jsx(X,{variant:"danger",disabled:!0,children:g("guide.help.common.report.link")})]}),s.jsx(N,{overflow:"hidden",gap:1,className:"bg-muted rounded chat-messages p-2",children:s.jsxs(N,{overflow:"auto",children:[l.map((p,S)=>s.jsxs(x,{fullWidth:!0,justifyContent:I(p.userId)?"end":"start",gap:2,children:[s.jsx(q,{shrink:!0,className:"message-avatar",children:!I(p.userId)&&s.jsx(ls,{figure:n,direction:2})}),s.jsxs(q,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(I(p.userId)?"right":"left"),children:[s.jsxs(T,{bold:!0,children:[I(p.userId)&&te().userName,!I(p.userId)&&r]}),p.messages.map((R,O)=>s.jsx(q,{pointer:!!R.roomId,className:R.roomId?"text-break text-underline":"text-break",onClick:()=>R.roomId?qn(R.roomId):null,children:R.message},O))]}),I(p.userId)&&s.jsx(q,{className:"message-avatar flex-shrink-0",children:s.jsx(ls,{figure:te().figure,direction:4})})]},S)),s.jsx("div",{ref:e})]})}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{gap:1,children:[s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("guide.help.request.guide.ongoing.input.empty",["name"],[r]),value:c,onChange:p=>u(p.target.value),onKeyDown:E}),s.jsx(X,{variant:"success",onClick:f,children:g("widgets.chatinput.say")})]}),o&&s.jsx(T,{variant:"muted",children:g("guide.help.common.typing")})]}),s.jsx(X,{fullWidth:!0,variant:"success",onClick:m,children:g("guide.help.request."+(t?"guide":"user")+".ongoing.close.link")})]})},dae=15,_ae=a=>{const{userRequest:e="",setUserRequest:t=null}=a,[i,r]=h.useState(!1),n=()=>{r(!0),K(new OU(1,e))};return s.jsxs(N,{children:[s.jsx(T,{children:g("guide.help.request.user.create.help")}),s.jsx("textarea",{className:"request-message",maxLength:140,value:e,onChange:o=>t(o.target.value),placeholder:g("guide.help.request.user.create.input.help")}),s.jsx(X,{fullWidth:!0,variant:"success",disabled:e.length<dae||i,onClick:n,children:g("guide.help.request.user.create.input.button")})]})},gae=a=>{const{userName:e=null}=a,t=i=>K(new CU(i));return s.jsxs(N,{children:[s.jsxs(x,{justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[s.jsxs(N,{gap:0,children:[s.jsx(T,{bold:!0,children:e}),s.jsx(T,{children:g("guide.help.request.user.feedback.guide.desc")})]}),s.jsx(X,{variant:"danger",disabled:!0,children:g("guide.help.common.report.link")})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("guide.help.request.user.feedback.closed.title")}),s.jsx(T,{children:g("guide.help.request.user.feedback.closed.desc")})]}),e&&e.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"bg-dark m-0 mt-auto"}),s.jsxs(N,{children:[s.jsx(T,{center:!0,bold:!0,children:g("guide.help.request.user.feedback.question")}),s.jsxs(x,{gap:1,children:[s.jsx(X,{fullWidth:!0,variant:"success",onClick:i=>t(!0),children:g("guide.help.request.user.feedback.positive.button")}),s.jsx(X,{fullWidth:!0,variant:"danger",onClick:i=>t(!1),children:g("guide.help.request.user.feedback.negative.button")})]})]})]})]})},mae=a=>s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("guide.help.request.no_tour_guides.title")}),s.jsx(T,{children:g("guide.help.request.no_tour_guides.message")})]}),fae=a=>{const{helpRequestDescription:e=null,helpRequestAverageTime:t=0}=a,i=()=>K(new yU);return s.jsxs(N,{children:[s.jsxs(N,{gap:0,className:"bg-muted rounded p-2",children:[s.jsx(T,{bold:!0,children:g("guide.help.request.guide.accept.request.title")}),s.jsx(T,{variant:"muted",children:g("guide.help.request.type.1")}),s.jsx(T,{wrap:!0,textBreak:!0,children:e})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("guide.help.request.user.pending.info.title")}),s.jsx(T,{children:g("guide.help.request.user.pending.info.message")}),s.jsx(T,{children:g("guide.help.request.user.pending.info.waiting",["waitingtime"],[t.toString()])})]}),s.jsx(X,{variant:"danger",onClick:i,children:g("guide.help.request.user.pending.cancel.button")})]})},pae=a=>s.jsx(N,{gap:1,children:s.jsx(T,{children:g("guide.help.request.user.guide.disconnected.error.desc")})}),Eae=a=>s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("guide.help.request.user.thanks.info.title")}),s.jsx(T,{children:g("guide.help.request.user.thanks.info.desc")})]}),Iae=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(g("guide.help.guide.tool.title")),[n,o]=h.useState(!1),[l,c]=h.useState(ts.GUIDE_TOOL_MENU),[u,d]=h.useState(!1),[_,m]=h.useState(!1),[f,E]=h.useState(!1),[I,p]=h.useState(!1),[S,R]=h.useState(0),[O,C]=h.useState(0),[A,b]=h.useState(0),[y,M]=h.useState(""),[U,G]=h.useState(null),[F,H]=h.useState(0),[v,B]=h.useState(0),[z,$]=h.useState(null),[W,V]=h.useState(null),[se,ee]=h.useState(!1),[ie,Z]=h.useState([]),{simpleAlert:ne=null}=kt(),_e=h.useCallback((fe,ae)=>{switch(fe){case ts.GUIDE_TOOL_MENU:r(g("guide.help.guide.tool.title")),o(!1);break;case ts.GUIDE_ACCEPT:r(g("guide.help.request.guide.accept.title")),o(!0);break;case ts.GUIDE_ONGOING:r(g("guide.help.request.guide.ongoing.title",["name"],[ae])),o(!0);break;case ts.USER_CREATE:r(g("guide.help.request.user.create.title")),o(!1);break;case ts.USER_PENDING:r(g("guide.help.request.user.pending.title")),o(!0);break;case ts.USER_ONGOING:r(g("guide.help.request.user.ongoing.title",["name"],[ae])),o(!0);break;case ts.USER_FEEDBACK:r(g("guide.help.request.user.feedback.title")),o(!0);break;case ts.USER_THANKS:r(g("guide.help.request.user.thanks.title")),o(!1);break;case ts.USER_NO_HELPERS:r(g("guide.help.request.no_tour_guides.heading")),o(!1);break;case ts.USER_SOMETHING_WRONG:r(g("guide.help.request.user.guide.disconnected.error.heading")),o(!1);break}c(fe),t(!0)},[]),de=h.useCallback(fe=>{switch(fe.type){case mn.SHOW_GUIDE_TOOL:t(!0);return;case mn.HIDE_GUIDE_TOOL:t(!1);return;case mn.TOGGLE_GUIDE_TOOL:t(ae=>!ae);return;case mn.CREATE_HELP_REQUEST:_e(ts.USER_CREATE);return}},[_e]);Js(mn.SHOW_GUIDE_TOOL,de),Js(mn.HIDE_GUIDE_TOOL,de),Js(mn.TOGGLE_GUIDE_TOOL,de),Js(mn.CREATE_HELP_REQUEST,de),J(DC,fe=>{!fe.getParser().isAllowed(Yf.USE_GUIDE_TOOL)&&u&&(d(!1),K(new fx(!1,!1,!1,!1)))}),J(PM,fe=>{const ae=fe.getParser();d(ae.onDuty),C(ae.guidesOnDuty),R(ae.helpersOnDuty),b(ae.guardiansOnDuty)}),J(UM,fe=>{const ae=fe.getParser();G(ae.helpRequestDescription),H(ae.roleSpecificWaitTime),ae.asGuide&&u&&_e(ts.GUIDE_ACCEPT),ae.asGuide||_e(ts.USER_PENDING)}),J(OC,fe=>{const ae=fe.getParser();u?(B(ae.requesterUserId),$(ae.requesterName),V(ae.requesterFigure),_e(ts.GUIDE_ONGOING,ae.requesterName)):(B(ae.guideUserId),$(ae.guideName),V(ae.guideFigure),_e(ts.USER_ONGOING,ae.guideName))}),J(GM,fe=>{const ae=fe.getParser();ee(ae.isTyping)}),J(kM,fe=>{const ae=fe.getParser(),Te=[...ie];let Se=Te[Te.length-1];(!Se||Se.userId!==ae.senderId)&&(Se=new wb(ae.senderId),Te.push(Se)),Se.addChat(new Ub(ae.chatMessage)),Z(Te)}),J(FM,fe=>{const ae=fe.getParser();if(ae.roomId!==0){const Te=[...ie];let Se=Te[Te.length-1];const Le=u?te().userId:v;(!Se||Se.userId!==Le)&&(Se=new wb(Le),Te.push(Se)),Se.addChat(new Ub(ae.roomName,ae.roomId)),Z(Te)}}),J(RC,fe=>{u?(B(0),$(null),V(null),ee(!1),Z([]),_e(ts.GUIDE_TOOL_MENU)):_e(ts.USER_FEEDBACK)}),J(xC,fe=>{switch(fe.getParser().errorCode){case 0:_e(ts.USER_SOMETHING_WRONG);break;case 1:case 2:_e(ts.USER_NO_HELPERS);break}}),J(wM,fe=>{B(0),$(null),V(null),ee(!1),Z([]),_e(u?ts.GUIDE_TOOL_MENU:ts.USER_THANKS)}),h.useEffect(()=>{const fe={linkReceived:ae=>{const Te=ae.split("/");if(!(Te.length<2))switch(Te[1]){case"tour":return}},eventUrlPrefix:"help/"};return fs(fe),()=>ps(fe)},[]);const me=h.useCallback(fe=>{switch(fe){case"close":t(!1),M(""),c(ts.GUIDE_TOOL_MENU);return;case"toggle_duty":if(!_&&!f&&!I){ne(g("guide.help.guide.tool.noqueueselected.message"),null,null,null,g("guide.help.guide.tool.noqueueselected.caption"),null);return}d(Te=>(K(new fx(!Te,Te?!1:f,Te?!1:I,Te?!1:_)),!Te));return;case"forum_link":const ae=xe("group.homepage.url","").replace("%groupid%",xe("guide.help.alpha.groupid","0"));window.open(ae);return}},[_,f,I,ne]);return e?s.jsxs(ve,{className:"nitro-guide-tool",theme:"primary-slim",children:[s.jsx(je,{headerText:i,onCloseClick:fe=>me("close"),noCloseButton:n}),s.jsxs(be,{className:"text-black",children:[l===ts.GUIDE_TOOL_MENU&&s.jsx(uae,{isOnDuty:u,isHandlingGuideRequests:f,setIsHandlingGuideRequests:E,isHandlingHelpRequests:I,setIsHandlingHelpRequests:p,isHandlingBullyReports:_,setIsHandlingBullyReports:m,guidesOnDuty:O,helpersOnDuty:S,guardiansOnDuty:A,processAction:me}),l===ts.GUIDE_ACCEPT&&s.jsx(cae,{helpRequestDescription:U,helpRequestAverageTime:F}),[ts.GUIDE_ONGOING,ts.USER_ONGOING].includes(l)&&s.jsx(hae,{isGuide:u,userId:v,userName:z,userFigure:W,isTyping:se,messageGroups:ie}),l===ts.USER_CREATE&&s.jsx(_ae,{userRequest:y,setUserRequest:M}),l===ts.USER_PENDING&&s.jsx(fae,{helpRequestDescription:U,helpRequestAverageTime:F}),l===ts.USER_FEEDBACK&&s.jsx(gae,{userName:z}),l===ts.USER_THANKS&&s.jsx(Eae,{}),l===ts.USER_NO_HELPERS&&s.jsx(mae,{}),l===ts.USER_SOMETHING_WRONG&&s.jsx(pae,{})]})]}):null},Tae=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(null),[n,o]=h.useState(0),[l,c]=h.useState(null),{userFigure:u=null}=Ja(),{purse:d=null,clubStatus:_=null}=Qa(),{badgeCodes:m=[],activate:f=null,deactivate:E=null}=Yd(),I=()=>d.clubDays<=0?g("purse.clubdays.zero.amount.text"):d.minutesUntilExpiration>-1&&d.minutesUntilExpiration<60*24?Mr.shortFormat(d.minutesUntilExpiration*60):Mr.shortFormat((d.clubPeriods*31+d.clubDays)*86400),p=()=>{switch(_){case vo.ACTIVE:return g(`hccenter.status.${_}.info`,["timeleft","joindate","streakduration"],[I(),i==null?void 0:i.firstSubscriptionDate,Mr.shortFormat((i==null?void 0:i.currentHcStreak)*86400)]);case vo.EXPIRED:return g(`hccenter.status.${_}.info`,["joindate"],[i==null?void 0:i.firstSubscriptionDate]);default:return g(`hccenter.status.${_}.info`)}},S=()=>!i||i.timeUntilPayday<60?g("hccenter.special.time.soon"):Mr.shortFormat(i.timeUntilPayday*60),R=()=>g("hccenter.special.sum",["credits"],[((i==null?void 0:i.creditRewardForStreakBonus)+(i==null?void 0:i.creditRewardForMonthlySpent)).toString()]);if(J(fC,C=>{const A=C.getParser();o(A.giftsAvailable)}),J(YL,C=>{const A=C.getParser();r(A.data)}),h.useEffect(()=>{const C={linkReceived:A=>{const b=A.split("/");if(!(b.length<2))switch(b[1]){case"open":if(b.length>2)switch(b[2]){case"hccenter":t(!0);break}return}},eventUrlPrefix:"habboUI/"};return fs(C),()=>ps(C)},[]),h.useEffect(()=>{c(dJ(m))},[m]),h.useEffect(()=>{if(!e)return;const C=f();return()=>E(C)},[e,f,E]),h.useEffect(()=>{K(new KC),K(new IF)},[]),!e)return null;const O=s.jsx(Oc,{id:"popover-basic",children:s.jsxs(Oc.Body,{className:"text-black py-2 px-3",children:[s.jsx("h5",{children:g("hccenter.breakdown.title")}),s.jsx("div",{children:g("hccenter.breakdown.creditsspent",["credits"],[i==null?void 0:i.totalCreditsSpent.toString()])}),s.jsx("div",{children:g("hccenter.breakdown.paydayfactor.percent",["percent"],[((i==null?void 0:i.kickbackPercentage)*100).toString()])}),s.jsx("div",{children:g("hccenter.breakdown.streakbonus",["credits"],[i==null?void 0:i.creditRewardForStreakBonus.toString()])}),s.jsx("hr",{className:"w-100 text-black my-1"}),s.jsx("div",{children:g("hccenter.breakdown.total",["credits","actual"],[R(),(((i==null?void 0:i.kickbackPercentage)*(i==null?void 0:i.totalCreditsSpent)+(i==null?void 0:i.creditRewardForStreakBonus))*100/100).toString()])}),s.jsx("div",{className:"btn btn-link text-primary p-0",onClick:()=>Ce("habbopages/"+xe("hc.center")["payday.habbopage"]),children:g("hccenter.special.infolink")})]})});return s.jsxs(ve,{theme:"primary-slim",className:"nitro-hc-center",children:[s.jsx(je,{headerText:g("generic.hccenter"),onCloseClick:()=>t(!1)}),s.jsxs(x,{position:"relative",className:"bg-muted p-2",children:[s.jsxs(N,{gap:1,children:[s.jsx("div",{className:"hc-logo"}),s.jsx(x,{children:s.jsx(X,{variant:"success",onClick:C=>Ce("catalog/open/"+xe("catalog.links")["hc.buy_hc"]),children:g(_===vo.ACTIVE?"hccenter.btn.extend":"hccenter.btn.buy")})})]}),s.jsx(q,{position:"absolute",className:"end-0 p-4 top-0 habbo-avatar",children:s.jsx(ls,{figure:u,direction:4,scale:2})})]}),s.jsxs(be,{children:[s.jsxs(x,{gap:2,children:[s.jsx(as,{badgeCode:l,className:"align-self-center flex-shrink-0 me-1"}),s.jsxs(N,{size:5,className:"streak-info",gap:0,children:[s.jsx(T,{children:g("hccenter.status."+_)}),s.jsx(T,{dangerouslySetInnerHTML:{__html:p()}})]})]}),xe("hc.center")["payday.info"]&&s.jsxs(x,{alignItems:"center",children:[s.jsxs(N,{className:"rounded-start bg-primary p-2 payday-special mb-1",children:[s.jsx("h4",{className:"mb-1",children:g("hccenter.special.title")}),s.jsx("div",{children:g("hccenter.special.info")}),s.jsx("div",{className:"btn btn-link text-white p-0 mt-auto align-self-baseline",onClick:()=>Ce("habbopages/"+xe("hc.center")["payday.habbopage"]),children:g("hccenter.special.infolink")})]}),s.jsxs("div",{className:"payday flex-shrink-0 p-2",children:[s.jsx("h5",{className:"mb-2 ms-2",children:g("hccenter.special.time.title")}),s.jsxs("div",{className:"d-flex flex-row mb-2",children:[s.jsx("div",{className:"clock me-2"}),s.jsx("h6",{className:"mb-0 align-self-center",children:S()})]}),_===vo.ACTIVE&&s.jsxs("div",{className:"pe-3",children:[s.jsx("h5",{className:"ms-2 mb-1 bolder",children:g("hccenter.special.amount.title")}),s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("div",{className:"w-100 text-center ms-4n",children:R()}),s.jsx(cc,{trigger:["hover","focus"],placement:"left",overlay:O,children:s.jsx("div",{className:"btn btn-link align-self-end text-primary",children:g("hccenter.breakdown.infolink")})})]})]})]})]}),xe("hc.center")["gift.info"]&&s.jsxs("div",{className:"rounded bg-success p-2 d-flex flex-row mb-0",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"mb-1",children:g("hccenter.gift.title")}),s.jsx("div",{dangerouslySetInnerHTML:{__html:n>0?g("hccenter.unclaimedgifts",["unclaimedgifts"],[n.toString()]):g("hccenter.gift.info")}})]}),s.jsx("button",{className:"btn btn-primary btn-lg align-self-center ms-auto",onClick:()=>Ce("catalog/open/"+xe("catalog.links")["hc.hc_gifts"]),children:g(_===vo.ACTIVE?"hccenter.btn.gifts.redeem":"hccenter.btn.gifts.view")})]}),xe("hc.center")["benefits.info"]&&s.jsxs("div",{className:"benefits text-black py-2",children:[s.jsx("h5",{className:"mb-1 text-primary",children:g("hccenter.general.title")}),s.jsx("div",{className:"mb-2",dangerouslySetInnerHTML:{__html:g("hccenter.general.info")}}),s.jsx("button",{className:"btn btn-link p-0 text-primary",onClick:()=>Ce("habbopages/"+xe("hc.center")["benefits.habbopage"]),children:g("hccenter.general.infolink")})]})]})]})},Sae=a=>{const[e,t]=h.useState(""),{activeReport:i=null,setActiveReport:r=null}=Rn(),n=()=>{e.length<15||r(l=>{const c=fr.REPORT_SUMMARY;return{...l,message:e,currentStep:c}})},o=()=>{r(l=>({...l,currentStep:l.currentStep-1}))};return s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{fontSize:4,children:g("help.emergency.chat_report.subtitle")}),s.jsx(T,{children:g("help.cfh.input.text")})]}),s.jsx("textarea",{className:"form-control h-100",value:e,onChange:l=>t(l.target.value)}),s.jsxs(x,{gap:2,justifyContent:"between",children:[s.jsx(X,{variant:"secondary",disabled:!(i.reportType===xs.BULLY||i.reportType===xs.EMERGENCY),onClick:o,children:g("generic.back")}),s.jsx(X,{disabled:e.length<15,onClick:n,children:g("help.emergency.main.submit.button")})]})]})},Rae=a=>{const{setActiveReport:e=null}=Rn(),t=()=>{e(i=>{const r=fr.SELECT_USER,n=xs.BULLY;return{...i,currentStep:r,reportType:n}})};return s.jsxs(s.Fragment,{children:[s.jsxs(N,{grow:!0,center:!0,gap:1,children:[s.jsx(T,{fontSize:3,children:g("help.main.frame.title")}),s.jsx(T,{children:g("help.main.self.description")})]}),s.jsxs(N,{gap:1,children:[s.jsx(X,{onClick:t,children:g("help.main.bully.subtitle")}),s.jsx(X,{onClick:()=>_i(new mn(mn.CREATE_HELP_REQUEST)),disabled:!xe("guides.enabled"),children:g("help.main.help.title")}),s.jsx(X,{disabled:!0,children:g("help.main.self.tips.title")})]}),s.jsx(X,{variant:"link",textColor:"black",onClick:()=>K(new RU(!1)),children:g("help.main.my.sanction.status")})]})},xae=a=>{const{username:e="",onAction:t=null}=a,[i,r]=h.useState(!1),n=()=>{i||(r(!0),K(new nP(e)))};return J(cT,o=>{const l=o.getParser();l&&l.webId===te().userId&&t("close")}),s.jsxs("div",{className:"d-flex flex-column gap-4 h-100",children:[s.jsx("div",{className:"bg-muted rounded p-2 text-center",children:g("tutorial.name_change.info.confirm")}),s.jsxs("div",{className:"d-flex flex-column align-items-center gap-1 h-100",children:[s.jsx("div",{children:g("tutorial.name_change.confirm")}),s.jsx("div",{className:"fw-bold",children:e})]}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx("button",{className:"btn btn-success w-100",disabled:i,onClick:n,children:g("generic.ok")}),s.jsx("button",{className:"btn btn-primary w-100",onClick:()=>t("close"),children:g("cancel")})]})]})},Oae=a=>{const{onAction:e=null}=a;return s.jsxs("div",{className:"d-flex flex-column gap-4 h-100",children:[s.jsx("div",{className:"bg-muted rounded p-2 text-center",children:g("tutorial.name_change.info.main")}),s.jsx("div",{className:"fw-bold d-flex align-items-center justify-content-center h-100 w-100",children:g("tutorial.name_change.current",["name"],[te().userName])}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx("button",{className:"btn btn-success w-100",onClick:()=>e("start"),children:g("tutorial.name_change.change")}),s.jsx("button",{className:"btn btn-primary w-100",onClick:()=>e("confirmation",te().userName),children:g("tutorial.name_change.keep")})]})]})},Cae=0,Nae=2,Aae=3,bae=4,vae=5,yae=6,Dae=a=>{const{onAction:e=null}=a,[t,i]=h.useState(""),[r,n]=h.useState(!1),[o,l]=h.useState(!1),[c,u]=h.useState(null),[d,_]=h.useState([]),m=()=>{t!==""&&(n(!1),_([]),u(null),l(!0),K(new aP(t)))},f=E=>{n(!1),_([]),u(null),i(E)};return J(ID,E=>{l(!1);const I=E.getParser();if(I)switch(I.resultCode){case Cae:n(!0);break;case Nae:u("short");break;case Aae:u("long");break;case bae:u("invalid");break;case vae:_(I.nameSuggestions),u("taken");break;case yae:u("change_not_allowed")}}),s.jsxs("div",{className:"d-flex flex-column gap-3 h-100",children:[s.jsx("div",{children:g("tutorial.name_change.info.select")}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:E=>f(E.target.value)}),s.jsx("button",{className:"btn btn-primary",disabled:t===""||o,onClick:m,children:g("tutorial.name_change.check")})]}),!c&&!r&&s.jsx("div",{className:"bg-muted rounded p-2 text-center",children:g("help.tutorial.name.info")}),c&&s.jsx("div",{className:"bg-danger rounded p-2 text-center text-white",children:g(`help.tutorial.name.${c}`,["name"],[t])}),r&&s.jsx("div",{className:"bg-success rounded p-2 text-center text-white",children:g("help.tutorial.name.available",["name"],[t])}),d&&s.jsx("div",{className:"d-flex flex-column gap-2",children:d.map((E,I)=>s.jsx("div",{className:"col bg-muted rounded p-1 cursor-pointer",onClick:()=>f(E),children:E},I))}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx("button",{className:"btn btn-success w-100",disabled:!r,onClick:()=>e("confirmation",t),children:g("tutorial.name_change.pick")}),s.jsx("button",{className:"btn btn-primary w-100",onClick:()=>e("close"),children:g("cancel")})]})]})},Vm="INIT",iS="INPUT",rS="CONFIRMATION",Mae=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(Vm),[n,o]=h.useState(""),l=(u,d)=>{switch(u){case"start":r(iS);break;case"confirmation":o(d),r(rS);break;case"close":o(""),t(!1);break}},c=h.useMemo(()=>{switch(i){case Vm:return"tutorial.name_change.title.main";case iS:return"tutorial.name_change.title.select";case rS:return"tutorial.name_change.title.confirm"}},[i]);return Js(om.INIT,u=>{r(Vm),t(!0)}),e?s.jsxs(ve,{className:"nitro-change-username",theme:"primary-slim",children:[s.jsx(je,{headerText:g(c),onCloseClick:()=>l("close")}),s.jsxs(be,{className:"text-black",children:[i===Vm&&s.jsx(Oae,{onAction:l}),i===iS&&s.jsx(Dae,{onAction:l}),i===rS&&s.jsx(xae,{username:n,onAction:l})]})]}):null},jae=a=>{const{activeReport:e=null,setActiveReport:t=null}=Rn(),i=()=>{const r=[];switch(e.reportType){case xs.BULLY:case xs.EMERGENCY:case xs.ROOM:{const n=e.roomId<=0?e.reportedChats[0].roomId:e.roomId;e.reportedChats.forEach(o=>r.push(o.webId,o.message)),K(new TU(e.message,e.cfhTopic,e.reportedUserId,n,r));break}case xs.IM:e.reportedChats.forEach(n=>r.push(n.webId,n.message)),K(new EU(e.message,e.cfhTopic,e.reportedUserId,r));break;case xs.THREAD:K(new pU(e.groupId,e.threadId,e.cfhTopic,e.message));break;case xs.MESSAGE:K(new fU(e.groupId,e.threadId,e.messageId,e.cfhTopic,e.message));break;case xs.PHOTO:K(new IU(e.extraData,e.roomId,e.reportedUserId,e.cfhTopic,e.roomObjectId));break}t(null)};return s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{fontSize:4,children:g("help.cfh.button.send")}),s.jsx(T,{children:g("help.main.summary")})]}),s.jsx(X,{variant:"success",onClick:i,children:g("guide.help.request.emergency.submit.button")})]})},Lae=a=>{const{sanctionInfo:e=null,setSanctionInfo:t=null}=Rn(),i=(r,n,o)=>{let l=`help.sanction.${r}`;switch(n){case"ALERT":l=l+".alert";break;case"MUTE":l=l+".mute";break;case"BAN_PERMANENT":l=l+".permban";break;default:if(l=l+".ban",o>24)return l=l+".days",g(l,["days"],[(o/24).toString()])}return g(l,["hours"],[o.toString()])};return e?s.jsxs(ve,{className:"nitro-help",theme:"primary-slim",children:[s.jsx(je,{headerText:g("help.sanction.info.title"),onCloseClick:()=>t(null)}),s.jsx(be,{className:"text-black",children:s.jsxs(Ye,{children:[s.jsx(N,{center:!0,size:5,overflow:"hidden",children:s.jsx(q,{className:"index-image"})}),s.jsxs(N,{justifyContent:"between",size:7,overflow:"hidden",children:[e.sanctionReason==="cfh.reason.EMPTY"?s.jsx("div",{className:"col-12 fw-bold",children:g("help.sanction.current.none")}):s.jsxs(s.Fragment,{children:[(e.probationHoursLeft>0||e.isSanctionActive)&&s.jsx("div",{className:"col-12 fw-bold",children:g("help.sanction.probation.reminder")}),s.jsxs("div",{className:`col-12 fw-bold ${e.isSanctionNew?"text-danger":""}`,children:[g("help.sanction.last.sanction")," ",i("current",e.sanctionName,e.sanctionLengthHours)]}),s.jsxs("div",{className:"col-12",children:[g("generic.start.time")," ",e.sanctionCreationTime]}),s.jsxs("div",{className:"col-12",children:[g("generic.reason")," ",e.sanctionReason]}),s.jsxs("div",{className:"col-12",children:[g("help.sanction.probation.days.left")," ",Math.trunc(e.probationHoursLeft/24)+1]})]}),e.hasCustomMute&&!e.isSanctionActive&&s.jsx("div",{className:"col-12 fw-bold",children:g("help.sanction.custom.mute")}),e.tradeLockExpiryTime&&e.tradeLockExpiryTime.length>0&&s.jsxs("div",{className:"col-12 fw-bold",children:[g("trade.locked.until")," ",e.tradeLockExpiryTime]}),s.jsx("div",{className:"col-12",children:i("next",e.nextSanctionName,e.nextSanctionLengthHours)}),s.jsx(X,{variant:"success",onClick:r=>t(null),children:g("habbo.way.ok.button")})]})]})})]}):null},Pae=a=>{const[e,t]=h.useState([]),{activeReport:i=null,setActiveReport:r=null}=Rn(),{chatHistory:n=[],messengerHistory:o=[]}=bT(),l=h.useMemo(()=>{switch(i.reportType){case xs.BULLY:case xs.EMERGENCY:return n.filter(_=>_.type===Ar.TYPE_CHAT&&_.webId===i.reportedUserId&&_.entityType===Xt.USER);case xs.IM:return o.filter(_=>_.webId===i.reportedUserId&&_.type===Ar.TYPE_IM)}return[]},[i,n,o]),c=_=>{t(m=>{const f=[...m],E=f.indexOf(_);return E>=0?f.splice(E,1):f.push(_),f})},u=()=>{!e||e.length<=0||r(_=>({..._,reportedChats:e,currentStep:fr.SELECT_TOPICS}))},d=()=>{r(_=>({..._,currentStep:_.currentStep-1}))};return s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{fontSize:4,children:g("help.emergency.chat_report.subtitle")}),s.jsx(T,{children:g("help.emergency.chat_report.description")})]}),s.jsxs(N,{gap:1,overflow:"hidden",children:[!l||!l.length&&s.jsx(T,{children:g("help.cfh.error.no_user_data")}),l.length>0&&s.jsx(Os,{gap:1,columnCount:1,columnMinHeight:25,overflow:"auto",children:l.map((_,m)=>s.jsx(ct,{onClick:f=>c(_),itemActive:e.indexOf(_)>=0,children:s.jsx(T,{children:_.message})},_.id))})]}),s.jsxs(x,{gap:2,justifyContent:"between",children:[s.jsx(X,{variant:"secondary",onClick:d,disabled:i.reportType===xs.IM,children:g("generic.back")}),s.jsx(X,{disabled:e.length<=0,onClick:u,children:g("help.emergency.main.submit.button")})]})]})},Uae=a=>{const[e,t]=h.useState(-1),{chatHistory:i=[]}=bT(),{activeReport:r=null,setActiveReport:n=null}=Rn(),o=h.useMemo(()=>{const d=new Map;return i.forEach(_=>{_.type===Ar.TYPE_CHAT&&_.entityType===Xt.USER&&_.webId!==te().userId&&!d.has(_.webId)&&d.set(_.webId,{id:_.webId,username:_.name})}),Array.from(d.values())},[i]),l=d=>{d<=0||n(_=>({..._,reportedUserId:d,currentStep:fr.SELECT_CHATS}))},c=d=>{t(_=>d===_?-1:d)},u=()=>{n(d=>({...d,currentStep:d.currentStep-1}))};return s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{fontSize:4,children:g("help.emergency.main.step.two.title")}),o.length>0&&s.jsx(T,{children:g("report.user.pick.user")})]}),s.jsxs(N,{gap:1,overflow:"hidden",children:[!o.length&&s.jsx(T,{children:g("report.user.error.nolist")}),o.length>0&&s.jsx(Os,{columnCount:1,columnMinHeight:25,gap:1,children:o.map((d,_)=>s.jsx(ct,{onClick:m=>c(d.id),itemActive:e===d.id,children:s.jsx("span",{dangerouslySetInnerHTML:{__html:d.username}})},d.id))})]}),s.jsxs(x,{gap:2,justifyContent:"between",children:[s.jsx(X,{variant:"secondary",onClick:u,children:g("generic.back")}),s.jsx(X,{disabled:e<=0,onClick:()=>l(e),children:g("help.emergency.main.submit.button")})]})]})},wae=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),{setActiveReport:n=null}=Rn(),{cfhCategories:o=[]}=Zd(),l=()=>{e<0||i<0||n(u=>({...u,cfhCategory:e,cfhTopic:o[e].topics[i].id,currentStep:fr.INPUT_REPORT_MESSAGE}))},c=()=>{n(u=>({...u,currentStep:u.currentStep-1}))};return s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{fontSize:4,children:g("help.emergency.chat_report.subtitle")}),s.jsx(T,{children:g("help.cfh.pick.topic")})]}),s.jsxs(N,{gap:1,overflow:"auto",children:[e<0&&o.map((u,d)=>s.jsx(X,{variant:"danger",onClick:_=>t(d),children:g(`help.cfh.reason.${u.name}`)},d)),e>=0&&o[e].topics.map((u,d)=>s.jsx(X,{variant:"danger",onClick:_=>r(d),active:i===d,children:g(`help.cfh.topic.${u.id}`)},d))]}),s.jsxs(x,{gap:2,justifyContent:"between",children:[s.jsx(X,{variant:"secondary",onClick:c,children:g("generic.back")}),s.jsx(X,{disabled:i<0,onClick:l,children:g("help.emergency.main.submit.button")})]})]})},Fae=a=>{const[e,t]=h.useState(!1),{activeReport:i=null,setActiveReport:r=null,report:n=null}=Rn(),o=()=>{r(null),t(!1)};h.useEffect(()=>{const c={linkReceived:u=>{const d=u.split("/");if(!(d.length<2))switch(d[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(_=>!_);return;case"tour":return;case"report":d.length>=5&&d[2]==="room"&&(parseInt(d[3]),unescape(d.splice(4).join("/")));return}},eventUrlPrefix:"help/"};return fs(c),()=>ps(c)},[]),h.useEffect(()=>{i&&t(!0)},[i]);const l=()=>{if(i)switch(i.currentStep){case fr.SELECT_USER:return s.jsx(Uae,{});case fr.SELECT_CHATS:return s.jsx(Pae,{});case fr.SELECT_TOPICS:return s.jsx(wae,{});case fr.INPUT_REPORT_MESSAGE:return s.jsx(Sae,{});case fr.REPORT_SUMMARY:return s.jsx(jae,{})}return s.jsx(Rae,{})};return s.jsxs(s.Fragment,{children:[e&&s.jsxs(ve,{className:"nitro-help",theme:"primary-slim",children:[s.jsx(je,{headerText:g("help.button.cfh"),onCloseClick:o}),s.jsx(be,{className:"text-black",children:s.jsxs(Ye,{children:[s.jsx(N,{center:!0,size:5,overflow:"hidden",children:s.jsx(q,{className:"index-image"})}),s.jsx(N,{justifyContent:"between",size:7,overflow:"hidden",children:s.jsx(l,{})})]})})]}),s.jsx(Lae,{}),s.jsx(Mae,{})]})},kae=a=>{const[e,t]=h.useState(null),[i,r]=h.useState(null),[n,o]=h.useState(null),[l,c]=h.useState(null);return J(jD,u=>{const d=u.getParser();t(d.productType),r(d.productClassId),o(d.totalCoinsForBonus),c(d.coinsStillRequiredToBuy)}),h.useEffect(()=>{K(new _P)},[]),e?s.jsxs("div",{className:"bonus-rare widget d-flex",children:[e,s.jsxs("div",{className:"bg-light-dark rounded overflow-hidden position-relative bonus-bar-container",children:[s.jsx("div",{className:"d-flex justify-content-center align-items-center w-100 h-100 position-absolute small top-0",children:n-l+"/"+n}),s.jsx("div",{className:"small bg-info rounded position-absolute top-0 h-100",style:{width:(n-l)/n*100+"%"}})]})]}):null},Gae=a=>{const{data:e=null,level:t=0}=a;return s.jsxs("div",{className:"hof-user-container",children:[s.jsxs("div",{className:"hof-tooltip",children:[s.jsxs("div",{className:"hof-header",children:[t,". ",e.userName," ",s.jsx(Xn,{userId:e.userId})]}),s.jsx("div",{className:"small text-center text-white",children:g("landing.view.competition.hof.points",["points"],[dr(e.currentScore).toString()])})]}),s.jsx(ls,{figure:e.figure,direction:2})]})},Bae=a=>{const{slot:e=-1,conf:t=null}=a,[i,r]=h.useState(null);return J(Rj,n=>{const o=n.getParser();r(o.data)}),h.useEffect(()=>{const n=t?t.campaign:"";K(new P1(n))},[t]),i?s.jsx("div",{className:"hall-of-fame d-flex",children:i.hof&&i.hof.length>0&&i.hof.map((n,o)=>s.jsx(Gae,{data:n,level:o+1},o))}):null},Vae=a=>{const[e,t]=h.useState(null),[i,r]=h.useState(0);return J(d0,n=>{const o=n.getParser();t(o.articles)}),h.useEffect(()=>{K(new YU)},[]),e?s.jsxs("div",{className:"promo-articles widget mb-2",children:[s.jsxs("div",{className:"d-flex flex-row align-items-center w-100 mb-1",children:[s.jsx("small",{className:"flex-shrink-0 pe-1",children:g("landing.view.promo.article.header")}),s.jsx("hr",{className:"w-100 my-0"})]}),s.jsx("div",{className:"d-flex flex-row mb-1",children:e&&e.length>0&&e.map((n,o)=>s.jsx("div",{className:"promo-articles-bullet cursor-pointer "+(n===e[i]?"promo-articles-bullet-active":""),onClick:l=>r(o)},n.id))}),e&&e[i]&&s.jsxs("div",{className:"promo-article d-flex flex-row row mx-0 mt-3",children:[s.jsx("div",{className:"promo-article-image",style:{backgroundImage:`url(//cdn.jsdelivr.net/gh/Divinezx/hubbecdn/swfs/c_images/${e[i].imageUrl})`}}),s.jsxs("div",{className:"col-3 d-flex flex-column w-100 promo-article-content",children:[s.jsx("h3",{className:"my-0",style:{fontSize:"20px",fontWeight:600},children:e[i].title}),s.jsx("b",{style:{fontSize:"14px",fontWeight:500,textAlign:"justify"},children:e[i].bodyText}),s.jsx("button",{className:"btn btn-sm mt-2 btn-gainsboro",onClick:n=>nh(e[i].linkContent),children:e[i].buttonText})]})]})]}):null},Hae=a=>{const{conf:e=null}=a,t=i=>{const r=e[i];if(!r)return null;switch(i){case"image":return st.interpolate(r)}return r};return s.jsxs("div",{className:"widgetcontainer widget d-flex flex-row overflow-hidden",children:[s.jsx("div",{className:"widgetcontainer-image flex-shrink-0",style:{backgroundImage:`url(${t("image")})`}}),s.jsxs("div",{className:"d-flex flex-column align-self-center gap-3",children:[s.jsx("h3",{className:"my-0",children:g(`landing.view.${t("texts")}.header`)}),s.jsx("i",{children:g(`landing.view.${t("texts")}.body`)}),s.jsx("button",{className:"btn btn-sm btn-gainsboro align-self-start px-3 mt-auto",onClick:i=>nh(t("btnLink")),children:g(`landing.view.${t("texts")}.button`)})]})]})},Wae=a=>{switch(a.widgetType){case"promoarticle":return s.jsx(Vae,{});case"achievementcompetition_hall_of_fame":return s.jsx(Bae,{slot:a.slot,conf:a.widgetConf});case"bonusrare":return s.jsx(kae,{});case"widgetcontainer":return s.jsx(Hae,{conf:a.widgetConf});default:return null}},Hc=a=>{const{widgetType:e=null,widgetSlot:t=0,widgetConf:i=null,className:r="",...n}=a;return s.jsx("div",{className:`widget-slot slot-${t} ${r||""}`,...n,children:s.jsx(Wae,{widgetType:e,slot:t,widgetConf:i})})},Yae=a=>{const[e,t]=h.useState(!0),{userFigure:i=null}=Ja();if(ms([Ve.CREATED,Ve.ENDED],_=>{switch(_.type){case Ve.CREATED:t(!1);return;case Ve.ENDED:t(_.openLandingView);return}}),!e)return null;const r=xe("hotelview").images["background.colour"],n=st.interpolate(xe("hotelview").images.background),o=st.interpolate(xe("hotelview").images.sun),l=st.interpolate(xe("hotelview").images.drape),c=st.interpolate(xe("hotelview").images.left),u=st.interpolate(xe("hotelview").images["right.repeat"]),d=st.interpolate(xe("hotelview").images.right);return s.jsxs("div",{className:"nitro-hotel-view",style:r&&r?{background:r}:{},children:[s.jsx("div",{className:"container h-100 py-3 overflow-hidden landing-widgets",children:s.jsxs("div",{className:"row h-100",children:[s.jsxs("div",{className:"col-12 h-100 d-flex flex-column",children:[s.jsxs("div",{className:"col-12 d-flex gap-5",children:[s.jsx(Hc,{widgetSlot:1,widgetType:xe("hotelview").widgets["slot.1.widget"],widgetConf:xe("hotelview").widgets["slot.1.conf"],className:"col-5"}),s.jsx(Hc,{widgetSlot:2,widgetType:xe("hotelview").widgets["slot.2.widget"],widgetConf:xe("hotelview").widgets["slot.2.conf"],className:"col-5 mt-5"})]}),s.jsxs("div",{className:"col-5 mx-0",children:[s.jsx(Hc,{widgetSlot:3,widgetType:xe("hotelview").widgets["slot.3.widget"],widgetConf:xe("hotelview").widgets["slot.3.conf"],className:"col-5"}),s.jsx(Hc,{widgetSlot:4,widgetType:xe("hotelview").widgets["slot.4.widget"],widgetConf:xe("hotelview").widgets["slot.4.conf"],className:"col-7"}),s.jsx(Hc,{widgetSlot:5,widgetType:xe("hotelview").widgets["slot.5.widget"],widgetConf:xe("hotelview").widgets["slot.5.conf"],className:"col-5"})]}),s.jsx(Hc,{widgetSlot:6,widgetType:xe("hotelview").widgets["slot.6.widget"],widgetConf:xe("hotelview").widgets["slot.6.conf"],className:"mt-auto"})]}),s.jsx("div",{className:"col-3 h-100",children:s.jsx(Hc,{widgetSlot:7,widgetType:xe("hotelview").widgets["slot.7.widget"],widgetConf:xe("hotelview").widgets["slot.7.conf"]})})]})}),s.jsx("div",{className:"background position-absolute",style:n&&n.length?{backgroundImage:`url(${n})`}:{}}),s.jsx("div",{className:"sun position-absolute",style:o&&o.length?{backgroundImage:`url(${o})`}:{}}),s.jsx("div",{className:"drape position-absolute",style:l&&l.length?{backgroundImage:`url(${l})`}:{}}),s.jsx("div",{className:"left position-absolute",style:c&&c.length?{backgroundImage:`url(${c})`}:{}}),s.jsx("div",{className:"right-repeat position-absolute",style:u&&u.length?{backgroundImage:`url(${u})`}:{}}),s.jsx("div",{className:"right position-absolute",style:d&&d.length?{backgroundImage:`url(${d})`}:{}}),xe("hotelview")["show.avatar"]&&s.jsx("div",{className:"avatar-image",children:s.jsx(ls,{figure:i,direction:2})})]})},xv=a=>{const{badgeCode:e=null,draggable:t=!1,handleDragStart:i=null,handleDragOver:r=null,handleDrop:n=null,onClick:o=null,children:l=null,...c}=a,{selectedBadgeCode:u=null,setSelectedBadgeCode:d=null,toggleBadge:_=null,getBadgeId:m=null}=Yd(),{isUnseen:f=null}=Qn(),{isMobile:E,isTablet:I}=Ia(),p=f(Ps.BADGE,m(e)),S=(O,C)=>{i&&i(C)},R=(O,C)=>{O.preventDefault(),r&&r(O,C)};return s.jsxs(ct,{itemActive:u===e,itemUnseen:p,onMouseDown:O=>d(e),onDoubleClick:O=>_(u),onClick:()=>(E||I)&&o&&o(e),draggable:t,onDragStart:O=>S(O,e),onDragOver:O=>R(O,e),onDrop:O=>n(O),...c,children:[s.jsx(as,{badgeCode:e}),l]})},zae=["all","ach","others"],Kae=a=>{const{groupBadges:e=[],setGroupBadges:t=null}=a,[i,r]=h.useState(""),[n,o]=h.useState("all");return h.useEffect(()=>{let l=[...e];if(i&&i.length){const c=i.toLocaleLowerCase();l=e.filter(u=>c&&c.length&&(u.toLocaleLowerCase().includes(c)||$d(u).toLocaleLowerCase().includes(c)||Em(u).toLocaleLowerCase().includes(c))?u:null)}n==="ach"&&(l=l.filter(c=>c.startsWith("ACH_"))),n==="others"&&(l=l.filter(c=>!c.startsWith("ACH_"))),l=[...l].sort((c,u)=>c.startsWith("ACH_")&&!u.startsWith("ACH_")?-1:!c.startsWith("ACH_")&&u.startsWith("ACH_")?1:c.localeCompare(u)),t(l)},[e,t,i,n]),s.jsxs(x,{gap:1,children:[s.jsx("select",{className:"form-select form-select-sm",value:n||"any",onChange:l=>o(l.target.value),children:zae.map((l,c)=>s.jsx("option",{value:l,children:g("inventory.filter.placement."+l)},c))}),s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("generic.search"),value:i,onChange:l=>r(l.target.value)}),s.jsx(X,{variant:"primary",children:s.jsx(tT,{className:"fa-icon"})})]})},qae=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState([]),{badgeCodes:n=[],activeBadgeCodes:o=[],maxBadgeCount:l,setActiveBadgeCodes:c=null,selectedBadgeCode:u=null,isWearingBadge:d=null,isHiddenBadge:_=null,canWearBadges:m=null,toggleBadge:f=null,toggleHideBadge:E=null,getBadgeId:I=null,activate:p=null,deactivate:S=null}=Yd(),{isUnseen:R=null,removeUnseen:O=null}=Qn(),{seeHiddenBadges:C=!1}=Yd(),[A,b]=h.useState(null),[y,M]=h.useState(null),U=v=>{if(!y){M(v);return}if(y===v){M(null);return}const B=o.indexOf(y),z=o.indexOf(v);if(B===-1||z===-1)return;const $=[...o],[W]=$.splice(B,1);$.splice(z,0,W),c($),M(null);const V=new cp;for(let se=0;se<l;se++)V.addActivatedBadge($[se]??"");K(V)};h.useEffect(()=>{!u||!R(Ps.BADGE,I(u))||O(Ps.BADGE,I(u))},[u,R,O,I]),h.useEffect(()=>{if(!e)return;const v=p();return()=>S(v)},[e,p,S]),h.useEffect(()=>(t(!0),()=>t(!1)),[]);const G=v=>{b(v)},F=(v,B)=>{if(A===B)return;const z=[...o],$=z.indexOf(A),W=z.indexOf(B);if($===-1||W===-1)return;const V=z[$];$>W?(z.splice($,1),z.splice(W,0,V)):$<W&&(z.splice($,1),z.splice(W+1,0,V)),c(z)},H=v=>{v.preventDefault();const B=new cp;for(let z=0;z<l;z++)B.addActivatedBadge(o[z]??"");K(B),b(null)};return s.jsxs(Ye,{children:[s.jsxs(N,{size:7,overflow:"hidden",children:[s.jsx(Kae,{groupBadges:n,setGroupBadges:r}),s.jsx(N,{size:7,overflow:"hidden",fullHeight:!0,children:s.jsx(ch,{rows:i.filter(v=>d(v)?!1:!(!C&&_(v))),columnCount:5,overscan:5,estimateSize:40,preserveScroll:!0,itemRender:(v,B)=>s.jsx(xv,{badgeCode:v,draggable:!1},B)})})]}),s.jsxs(N,{className:"justify-content-between",size:5,overflow:"auto",children:[s.jsxs(N,{overflow:"hidden",gap:2,children:[s.jsx(T,{children:g("inventory.badges.activebadges")}),s.jsx(Os,{columnCount:3,children:o&&o.length>0&&o.map((v,B)=>s.jsx(xv,{badgeCode:v,draggable:!0,handleDragStart:G,handleDragOver:F,handleDrop:H,onClick:U},B))})]}),!!u&&s.jsxs(N,{grow:!0,justifyContent:"end",gap:2,children:[!m()&&s.jsxs(x,{gap:2,style:{background:"#34c0eb",borderRadius:"5px",padding:"4px"},alignItems:"center",children:[s.jsx(q,{pointer:!0,className:"icon icon-navigator-info-2"}),s.jsx(T,{variant:"white",fontSize:7,children:g("badges.max.slots.info")})]}),s.jsxs(x,{alignItems:"center",gap:2,children:[s.jsx(as,{shrink:!0,badgeCode:u}),s.jsxs(x,{column:!0,gap:1,children:[s.jsx(T,{bold:!0,children:$d(u)}),s.jsx(T,{children:Em(u)})]})]}),!d(u)&&s.jsx(X,{variant:"secondary",disabled:d(u),onClick:v=>E(u),children:g(_(u)?"Voltar a mostrar emblema":"Esconder emblema do inventário")}),(m()||d(u))&&s.jsx(X,{variant:d(u)?"danger":"success",disabled:!d(u)&&!m(),onClick:v=>f(u),children:g(d(u)?"inventory.badges.clearbadge":"inventory.badges.wearbadge")})]})]})]})},zN=a=>{const{title:e="",desc:t="",children:i=null,...r}=a;return s.jsxs(Ye,{...r,children:[s.jsx(N,{center:!0,size:5,overflow:"hidden",children:s.jsx("div",{className:"empty-image"})}),s.jsxs(N,{justifyContent:"center",size:7,overflow:"hidden",children:[s.jsx(T,{fontWeight:"bold",fontSize:5,overflow:"unset",truncate:!0,children:e}),s.jsx(T,{overflow:"auto",children:t})]}),i]})},Xae=a=>{const{botItem:e=null,children:t=null,...i}=a,[r,n]=h.useState(!1),{selectedBot:o=null,setSelectedBot:l=null}=GG(),{isUnseen:c=null}=Qn(),u=c(Ps.BOT,e.botData.id),d=_=>{switch(_.type){case Re.MOUSE_DOWN:l(e),n(!0);return;case Re.MOUSE_UP:n(!1);return;case Re.ROLL_OUT:if(!r||o!==e)return;Gx(e);return;case"dblclick":Gx(e);return}};return s.jsxs(ct,{itemActive:o===e,itemUnseen:u,onMouseDown:d,onMouseUp:d,onMouseOut:d,onDoubleClick:d,...i,children:[s.jsx(ls,{figure:e.botData.figure,direction:3,headOnly:!0}),t]})},$ae=a=>{const{roomSession:e=null,roomPreviewer:t=null}=a,[i,r]=h.useState(!1),{botItems:n=[],selectedBot:o=null,activate:l=null,deactivate:c=null}=GG(),{isUnseen:u=null,removeUnseen:d=null}=Qn();return h.useEffect(()=>{if(!o||!t)return;const _=o.botData,m=ce();let f=m.getRoomInstanceVariable(m.activeRoomId,D.ROOM_WALL_TYPE),E=m.getRoomInstanceVariable(m.activeRoomId,D.ROOM_FLOOR_TYPE),I=m.getRoomInstanceVariable(m.activeRoomId,D.ROOM_LANDSCAPE_TYPE);f=f&&f.length?f:"101",E=E&&E.length?E:"101",I=I&&I.length?I:"1.1",t.reset(!1),t.updateRoomWallsAndFloorVisibility(!0,!0),t.updateObjectRoom(E,f,I),t.addAvatarIntoRoom(_.figure,0)},[t,o]),h.useEffect(()=>{!o||!u(Ps.BOT,o.botData.id)||d(Ps.BOT,o.botData.id)},[o,u,d]),h.useEffect(()=>{if(!i)return;const _=l();return()=>c(_)},[i,l,c]),h.useEffect(()=>(r(!0),()=>r(!1)),[]),!n||!n.length?s.jsx(zN,{title:g("inventory.empty.bots.title"),desc:g("inventory.empty.bots.desc")}):s.jsxs(Ye,{children:[s.jsx(N,{size:7,overflow:"hidden",children:s.jsx(Os,{columnCount:5,children:n&&n.length>0&&n.map(_=>s.jsx(Xae,{botItem:_},_.botData.id))})}),s.jsxs(N,{size:5,overflow:"auto",children:[s.jsx(N,{overflow:"hidden",position:"relative",children:s.jsx(CT,{roomPreviewer:t,height:140})}),o&&s.jsxs(N,{grow:!0,justifyContent:"between",gap:2,children:[s.jsx(T,{grow:!0,truncate:!0,children:o.botData.name}),e&&s.jsx(X,{variant:"success",onClick:_=>Gx(o),disabled:e.playTestMode||!e.moderationSettings.allowAddBot&&!e.isRoomOwner,children:g("inventory.bot.placetoroom")})]})]})]})},Qae=a=>{const{groupItem:e=null,...t}=a,[i,r]=h.useState(!1),{selectedItem:n=null,setSelectedItem:o=null}=$a(),l=u=>{switch(u.type){case Re.MOUSE_DOWN:o(e),r(!0);return;case Re.MOUSE_UP:r(!1);return;case Re.ROLL_OUT:if(!i||e!==n)return;wd(e);return;case"dblclick":wd(e);return}},c=e.getUnlockedCount();return s.jsx(ct,{className:c?"":"opacity-0-5 ",itemImage:e.iconUrl,itemCount:e.getUnlockedCount(),itemActive:e===n,itemUniqueNumber:e.stuffData.uniqueNumber,itemUnseen:e.hasUnseenItems,onMouseDown:l,onMouseUp:l,onMouseOut:l,onDoubleClick:l,...t})},Jae=["any","alphabetic","alphabetical_desc","floor","wall","rares_ltd","wireds","nodeletable"],TB=a=>{const{groupItems:e=[],setGroupItems:t=null}=a,{searchResult:i="",setSearchResult:r,selectResult:n="any",setSelectResult:o,setCurrentPage:l}=$a();return h.useEffect(()=>{let c=[...e];switch(n){case"any":c=[...e];break;case"floor":c=e.filter(u=>u.isWallItem?null:u);break;case"wall":c=e.filter(u=>u.isWallItem?u:null);break;case"rares_ltd":c=e.filter(u=>u.getLastItem().stuffData.uniqueNumber>0&&u.getLastItem().stuffData.uniqueSeries>0?u:null);break;case"wireds":c=e.filter(u=>{const d=u.iconUrl;if(d){const _=d==null?void 0:d.split("/"),m=_[_.length-1].replace(".png","");if(m.toLocaleLowerCase().startsWith("wf_")||m.toLocaleLowerCase().startsWith("conf_")||m.toLocaleLowerCase().startsWith("highscore_")||m.toLocaleLowerCase().startsWith("compusermat_")||m.toLocaleLowerCase().startsWith("memory")||m.toLocaleLowerCase().startsWith("hubbe_w")||m.toLocaleLowerCase().startsWith("opmsg_")||m.toLocaleLowerCase().startsWith("opusermat_"))return u}return null});break;case"nodeletable":c=e.filter(u=>u.getLastItem().deletable?null:u);break;case"alphabetic":c=[...e].sort((u,d)=>u.name.toLocaleLowerCase().localeCompare(d.name.toLocaleLowerCase()));break;case"alphabetical_desc":c=[...e].sort((u,d)=>d.name.toLocaleLowerCase().localeCompare(u.name.toLocaleLowerCase()));break;default:c=[...e]}if(i&&i.length){const u=i.toLocaleLowerCase();c=c.filter(d=>u&&u.length&&d.name.toLocaleLowerCase().includes(u)?d:null)}t(c)},[e,t,i,n]),s.jsxs(x,{gap:1,children:[s.jsx("select",{className:"form-select form-select-sm",value:n||"any",onChange:c=>{o(c.target.value),l(0)},children:Jae.map((c,u)=>s.jsx("option",{value:c,children:g("inventory.filter.placement."+c)},u))}),s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("generic.search"),value:i||"",onChange:c=>{r(c.target.value),l(0)}}),i&&i.length?s.jsx(X,{variant:"primary",className:"catalog-search-button",onClick:c=>{r(""),l(0)},children:s.jsx(pr,{className:"fa-icon"})}):s.jsx(X,{variant:"primary",children:s.jsx(tT,{className:"fa-icon"})})]})},Zae=a=>{const e=a.getLastItem();if(!e||!e.sellable)return!1;_i(new kp(e))},eoe=a=>{const{roomSession:e=null,roomPreviewer:t=null}=a,[i,r]=h.useState(!1),[n,o]=h.useState([]),{groupItems:l=[],selectedItem:c=null,activate:u=null,deactivate:d=null}=$a(),{resetItems:_=null}=Qn(),{showDeletableItemAlert:m=null}=kt(),{playTestMode:f}=Tn(),E=(I,p,S)=>{m(I,p,S,null,null,null)};return h.useEffect(()=>{if(!c||!t)return;const I=c.getLastItem();if(!I)return;const p=ce();let S=p.getRoomInstanceVariable(p.activeRoomId,D.ROOM_WALL_TYPE),R=p.getRoomInstanceVariable(p.activeRoomId,D.ROOM_FLOOR_TYPE),O=p.getRoomInstanceVariable(p.activeRoomId,D.ROOM_LANDSCAPE_TYPE);if(S=S&&S.length?S:"101",R=R&&R.length?R:"101",O=O&&O.length?O:"1.1",t.reset(!1),t.updateObjectRoom(R,S,O),t.updateRoomWallsAndFloorVisibility(!0,!0),I.category===Je.WALL_PAPER||I.category===Je.FLOOR||I.category===Je.LANDSCAPE){if(R=I.category===Je.FLOOR?c.stuffData.getLegacyString():R,S=I.category===Je.WALL_PAPER?c.stuffData.getLegacyString():S,O=I.category===Je.LANDSCAPE?c.stuffData.getLegacyString():O,t.updateObjectRoom(R,S,O),I.category===Je.LANDSCAPE){const C=te().getWallItemDataByName("window_double_default");C&&t.addWallItemIntoRoom(C.id,new Y(90,0,0),C.customParams)}}else c.isWallItem?t.addWallItemIntoRoom(c.type,new Y(90),I.stuffData.getLegacyString()):t.addFurnitureIntoRoom(c.type,new Y(90),c.stuffData,I.extra.toString())},[t,c]),h.useEffect(()=>{!c||!c.hasUnseenItems||(_(Ps.FURNI,c.items.map(I=>I.id)),c.hasUnseenItems=!1)},[c,_]),h.useEffect(()=>{if(!i)return;const I=u();return()=>d(I)},[i,u,d]),h.useEffect(()=>(r(!0),()=>r(!1)),[]),!l||!l.length?s.jsx(zN,{title:g("inventory.empty.title"),desc:g("inventory.empty.desc")}):s.jsxs(Ye,{children:[s.jsxs(N,{size:7,overflow:"hidden",children:[s.jsx(x,{gap:2,children:s.jsx(TB,{groupItems:l,setGroupItems:o})}),s.jsx(N,{size:7,overflow:"hidden",justifyContent:"between",fullHeight:!0,children:s.jsx(ch,{rows:n,columnCount:5,overscan:5,preserveScroll:!0,itemRender:(I,p)=>s.jsx(Qae,{groupItem:I},p)})})]}),s.jsxs(N,{size:5,overflow:"auto",children:[s.jsxs(N,{overflow:"hidden",position:"relative",children:[s.jsx(CT,{roomPreviewer:t,height:140}),c&&c.stuffData.isUnique&&s.jsx(LG,{className:"top-2 end-2",position:"absolute",uniqueNumber:c.stuffData.uniqueNumber,uniqueSeries:c.stuffData.uniqueSeries}),c&&c.stuffData.rarityLevel>-1&&s.jsx(UN,{className:"top-2 end-2",position:"absolute",level:c.stuffData.rarityLevel})]}),c&&s.jsxs(N,{grow:!0,justifyContent:"between",gap:2,children:[s.jsx(T,{grow:!0,truncate:!0,children:c.name}),s.jsxs(N,{gap:1,children:[e&&s.jsx(X,{variant:"success",onClick:I=>wd(c),disabled:e.controllerLevel<pt.USER_WITH_RIGHTS||f,children:g("inventory.furni.placetoroom")}),c&&c.isSellable&&s.jsx(X,{onClick:I=>Zae(c),children:g("inventory.marketplace.sell")}),c&&c.isDeletable&&!c.isSellable&&s.jsx(X,{variant:"danger",onClick:I=>E(c,1,c.items.length),children:g("inventory.furni.delete")})]})]})]})]})},nS=9,toe=a=>{const{cancelTrade:e=null}=a,[t,i]=h.useState(null),[r,n]=h.useState(null),[o,l]=h.useState(null),[c,u]=h.useState(null),[d,_]=h.useState(3),[m,f]=h.useState(1),{ownUser:E=null,otherUser:I=null,groupItems:p=[],tradeState:S=Ti.TRADING_STATE_READY,progressTrade:R=null,removeItem:O=null,setTradeState:C=null}=VG(),{simpleAlert:A=null}=kt(),b=(F,H,v,B,z)=>{if(!E||E.accepts||!E.userItems)return!1;if(E.userItems.length<nS)return!0;if(!B)return!1;let $=H.toString();return v===Je.POSTER?$=$+"poster"+z.getLegacyString():v===Je.GUILD_FURNI?$=tJ(H,z):$=(F?"I":"S")+$,!!E.userItems.getValue($)},y=F=>{if(!t)return;const H=t.getTradeItems(F);if(!H||!H.length)return;let v=null;const B=[];for(const $ of H)B.push($.id),v||(v=$);if(E.userItems.length+B.length<=1500)if(!v.isGroupable&&B.length)K(new Tx(B.pop()));else{const $=[];for(const W of B)b(v.isWallItem,v.type,v.category,v.isGroupable,v.stuffData)&&$.push(W);$.length&&($.length===1?K(new Tx($.pop())):K(new kU(...$)))}else A(g("trading.items.too_many_items.desc"),lt.DEFAULT,null,null,g("trading.items.too_many_items.title"))},M=F=>F?s.jsx(Hy,{className:"text-success fa-icon"}):s.jsx(IV,{className:"text-danger fa-icon"}),U=(F,H)=>{(isNaN(Number(F))||Number(F)<0||!F)&&(F=1),F=Math.max(Number(F),1),F=Math.min(Number(F),H),F!==m&&f(F)},G=F=>{U(m,F),y(m)};return h.useEffect(()=>{f(1)},[t]),h.useEffect(()=>{if(S!==Ti.TRADING_STATE_COUNTDOWN)return;_(3);const F=setInterval(()=>{_(H=>{const v=H-1;return v===0&&clearInterval(F),v})},1e3);return()=>clearInterval(F)},[S,C]),h.useEffect(()=>{d===0&&C(Ti.TRADING_STATE_CONFIRMING)},[d,C]),S===Ti.TRADING_STATE_READY||!E||!I?null:s.jsxs(Ye,{children:[s.jsxs(N,{size:4,overflow:"hidden",children:[s.jsx(TB,{groupItems:p,setGroupItems:u}),s.jsxs(x,{column:!0,fullHeight:!0,justifyContent:"between",overflow:"hidden",gap:2,children:[s.jsx(Os,{columnCount:3,children:c&&c.length>0&&c.map((F,H)=>{const v=F.getUnlockedCount();return s.jsx(ct,{className:v?"":"opacity-0-5 ",itemImage:F.iconUrl,itemCount:v,itemActive:t===F,itemUniqueNumber:F.stuffData.uniqueNumber,onClick:B=>v&&i(F),onDoubleClick:B=>y(1),children:v>0&&t===F&&s.jsx(X,{position:"absolute",variant:"success",className:"trade-button bottom-1 end-1",onClick:B=>y(1),children:s.jsx(_s,{className:"fa-icon"})})},H)})}),s.jsxs(N,{gap:1,alignItems:"end",children:[s.jsxs(Ye,{overflow:"hidden",children:[s.jsx(N,{size:6,overflow:"hidden",children:s.jsx("input",{type:"number",className:"form-control form-control-sm quantity-input",placeholder:g("catalog.bundlewidget.spinner.select.amount"),disabled:!t,value:m,onChange:F=>f(F.target.valueAsNumber)})}),s.jsx(N,{size:6,overflow:"hidden",children:s.jsx(X,{variant:"secondary",disabled:!t,onClick:F=>G(t.getUnlockedCount()),children:g("inventory.trading.areoffering")})})]}),s.jsx(q,{fullWidth:!0,className:"badge bg-muted",children:t?t.name:g("catalog_selectproduct")})]})]})]}),s.jsxs(N,{size:8,overflow:"hidden",children:[s.jsxs(Ye,{overflow:"hidden",children:[s.jsxs(N,{size:6,overflow:"hidden",children:[s.jsxs(x,{justifyContent:"between",alignItems:"center",children:[s.jsxs(T,{children:[g("inventory.trading.you")," ",g("inventory.trading.areoffering"),":"]}),M(E.accepts)]}),s.jsx(Os,{columnCount:3,children:Array.from(Array(nS),(F,H)=>{const v=E.userItems.getWithIndex(H)||null;return v?s.jsx(ct,{itemActive:r===v,itemImage:v.iconUrl,itemCount:v.getTotalCount(),itemUniqueNumber:v.stuffData.uniqueNumber,onClick:B=>n(v),onDoubleClick:B=>O(v),children:r===v&&s.jsx(X,{position:"absolute",variant:"danger",className:"trade-button bottom-1 start-1",onClick:B=>O(v),children:s.jsx(ds,{className:"fa-icon"})})},H):s.jsx(ct,{},H)})}),s.jsx(q,{fullWidth:!0,className:"badge bg-muted",children:r?r.name:g("catalog_selectproduct")})]}),s.jsxs(N,{size:6,overflow:"hidden",children:[s.jsxs(x,{justifyContent:"between",alignItems:"center",children:[s.jsxs(T,{children:[I.userName," ",g("inventory.trading.isoffering"),":"]}),M(I.accepts)]}),s.jsx(Os,{columnCount:3,children:Array.from(Array(nS),(F,H)=>{const v=I.userItems.getWithIndex(H)||null;return v?s.jsx(ct,{itemActive:o===v,itemImage:v.iconUrl,itemCount:v.getTotalCount(),itemUniqueNumber:v.stuffData.uniqueNumber,onClick:B=>l(v)},H):s.jsx(ct,{},H)})}),s.jsx(q,{fullWidth:!0,className:"badge bg-muted w-100",children:o?o.name:g("catalog_selectproduct")})]})]}),s.jsxs(x,{gap:2,style:{background:"#34c0eb",borderRadius:"5px",padding:"4px"},alignItems:"center",children:[s.jsx(q,{pointer:!0,className:"icon icon-navigator-info-2"}),s.jsxs(T,{variant:"white",fontSize:7,children:["Ao efetuar a troca concorda com os ",s.jsx("a",{href:"https://help.hubbe.biz/hub-economia#leis-do-mercado",rel:"noreferrer",target:"_blank",children:"termos de negociação do Hubbe"}),"."]})]}),s.jsxs(x,{grow:!0,justifyContent:"between",children:[s.jsx(X,{variant:"danger",onClick:e,children:g("generic.cancel")}),S===Ti.TRADING_STATE_READY&&s.jsx(X,{variant:"secondary",disabled:!E.itemCount&&!I.itemCount,onClick:R,children:g("inventory.trading.accept")}),S===Ti.TRADING_STATE_RUNNING&&s.jsx(X,{variant:"secondary",disabled:!E.itemCount&&!I.itemCount,onClick:R,children:g(E.accepts?"inventory.trading.modify":"inventory.trading.accept")}),S===Ti.TRADING_STATE_COUNTDOWN&&s.jsx(X,{variant:"secondary",disabled:!0,children:g("inventory.trading.countdown",["counter"],[d.toString()])}),S===Ti.TRADING_STATE_CONFIRMING&&s.jsx(X,{variant:"secondary",onClick:R,children:g("inventory.trading.button.restore")}),S===Ti.TRADING_STATE_CONFIRMED&&s.jsx(X,{variant:"secondary",children:g("inventory.trading.info.waiting")})]})]})]})},soe=a=>{const{petItem:e=null,children:t=null,...i}=a,[r,n]=h.useState(!1),{selectedPet:o=null,setSelectedPet:l=null}=BG(),{isUnseen:c}=Qn(),u=c(Ps.PET,e.petData.id),d=_=>{switch(_.type){case Re.MOUSE_DOWN:l(e),n(!0);return;case Re.MOUSE_UP:n(!1);return;case Re.ROLL_OUT:if(!r||e!==o)return;kx(e);return;case"dblclick":kx(e);return}};return s.jsxs(ct,{itemActive:e===o,itemUnseen:u,onMouseDown:d,onMouseUp:d,onMouseOut:d,onDoubleClick:d,...i,children:[s.jsx(Fn,{figure:e.petData.figureData.figuredata,direction:3,headOnly:!0}),t]})},ioe=a=>{const{roomSession:e=null,roomPreviewer:t=null}=a,[i,r]=h.useState(!1),{petItems:n=null,selectedPet:o=null,activate:l=null,deactivate:c=null}=BG(),{isUnseen:u=null,removeUnseen:d=null}=Qn();return h.useEffect(()=>{if(!o||!t)return;const _=o.petData,m=ce();let f=m.getRoomInstanceVariable(m.activeRoomId,D.ROOM_WALL_TYPE),E=m.getRoomInstanceVariable(m.activeRoomId,D.ROOM_FLOOR_TYPE),I=m.getRoomInstanceVariable(m.activeRoomId,D.ROOM_LANDSCAPE_TYPE);f=f&&f.length?f:"101",E=E&&E.length?E:"101",I=I&&I.length?I:"1.1",t.reset(!1),t.updateRoomWallsAndFloorVisibility(!0,!0),t.updateObjectRoom(E,f,I),t.addPetIntoRoom(_.figureString)},[t,o]),h.useEffect(()=>{!o||!u(Ps.PET,o.petData.id)||d(Ps.PET,o.petData.id)},[o,u,d]),h.useEffect(()=>{if(!i)return;const _=l();return()=>c(_)},[i,l,c]),h.useEffect(()=>(r(!0),()=>r(!1)),[]),!n||!n.length?s.jsx(zN,{title:g("inventory.empty.pets.title"),desc:g("inventory.empty.pets.desc")}):s.jsxs(Ye,{children:[s.jsx(N,{size:7,overflow:"hidden",children:s.jsx(Os,{columnCount:5,children:n&&n.length>0&&n.map(_=>s.jsx(soe,{petItem:_},_.petData.id))})}),s.jsxs(N,{size:5,overflow:"auto",children:[s.jsx(N,{overflow:"hidden",position:"relative",children:s.jsx(CT,{roomPreviewer:t,height:140})}),o&&o.petData&&s.jsxs(N,{grow:!0,justifyContent:"between",gap:2,children:[s.jsx(T,{grow:!0,truncate:!0,children:o.petData.name}),e&&s.jsx(X,{variant:"success",onClick:_=>kx(o),disabled:e.playTestMode||!e.allowPets&&!e.isRoomOwner,children:g("inventory.furni.placetoroom")})]})]})]})},JO="inventory.furni",SB="inventory.bots",RB="inventory.furni.tab.pets",xB="inventory.badges",Ov=[JO,SB,RB,xB],roe=[Ps.FURNI,Ps.BOT,Ps.PET,Ps.BADGE],noe=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(Ov[0]),[n,o]=h.useState(null),[l,c]=h.useState(null),{isTrading:u=!1,stopTrading:d=null}=VG(),{getCount:_=null,resetCategory:m=null}=Qn(),{selectedItem:f,setSelectedItem:E}=$a(),{playTestMode:I}=Tn(),p=()=>{u&&d(),t(!1)},S=h.useCallback(()=>{if(!f||i!==JO)return;const R=f.items.length-1;let O=-1;for(let C=R-1;C>=0;C--){const A=f.getItemByIndex(C);if(A&&!A.locked){O=C;break}}O!==-1?QQ(f.getItemByIndex(O)):(bc(-1),Nc(!1),t(!0))},[i,f]);return ut(ke.PLACED,R=>{xk()&&(I||(R.placedInRoom?S():(t(!0),bc(-1),Nc(!1))))}),ms([Ve.CREATED,Ve.ENDED,Ve.RESTARTED],R=>{switch(R.type){case Ve.CREATED:o(R.session);return;case Ve.ENDED:o(null),t(!1);return;case Ve.RESTARTED:t(!1);return}}),J(CC,R=>{const O=R.getParser();for(const C of O.data)tk().setBadgePointLimit(C.badgeId,C.limit)}),h.useEffect(()=>{const R={linkReceived:O=>{const C=O.split("/");if(!(C.length<2))switch(C[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(A=>!A);return}},eventUrlPrefix:"inventory/"};return fs(R),()=>ps(R)},[]),h.useEffect(()=>(c(new kd(ce(),++kd.PREVIEW_COUNTER)),()=>{c(R=>(R.dispose(),null))}),[]),h.useEffect(()=>{!e&&u&&t(!0)},[e,u]),e?s.jsxs(ve,{uniqueKey:"inventory",className:"nitro-inventory",theme:u?"primary-slim":"",children:[s.jsx(je,{headerText:g("inventory.title"),onCloseClick:p}),!u&&s.jsxs(s.Fragment,{children:[s.jsx($n,{children:Ov.map((R,O)=>s.jsx(In,{isActive:i===R,onClick:C=>r(R),count:_(roe[O]),children:g(R)},O))}),s.jsxs(be,{children:[i===JO&&s.jsx(eoe,{roomSession:n,roomPreviewer:l}),i===SB&&s.jsx($ae,{roomSession:n,roomPreviewer:l}),i===RB&&s.jsx(ioe,{roomSession:n,roomPreviewer:l}),i===xB&&s.jsx(qae,{})]})]}),u&&s.jsx(be,{children:s.jsx(toe,{cancelTrade:p})})]}):null},KN=a=>{const{records:e=null}=a,{openRoomInfo:t=null}=Zd(),i=h.useMemo(()=>{const n=[];return e.forEach(o=>{n.push({isRoomInfo:!0,roomId:o.roomId,roomName:o.roomName}),o.chatlog.forEach(l=>{n.push({timestamp:l.timestamp,habboId:l.userId,username:l.userName,hasHighlighting:l.hasHighlighting,message:l.message,isRoomInfo:!1})})}),n},[e]),r=n=>s.jsxs(x,{gap:2,alignItems:"center",justifyContent:"between",className:"bg-muted rounded p-1",children:[s.jsxs(x,{gap:1,children:[s.jsx(T,{bold:!0,children:"Quarto:"}),s.jsx(T,{children:n.roomName})]}),s.jsxs(x,{gap:1,children:[s.jsx(X,{onClick:o=>qn(n.roomId),children:"Visitar"}),s.jsx(X,{onClick:o=>t(n.roomId),children:"Ferramentas"})]})]});return s.jsx(s.Fragment,{children:s.jsxs(N,{fit:!0,gap:0,overflow:"hidden",children:[s.jsx(N,{gap:2,children:s.jsxs(Ye,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[s.jsx(q,{className:"g-col-2",children:"Tempo"}),s.jsx(q,{className:"g-col-3",children:"Usuário"}),s.jsx(q,{className:"g-col-7",children:"Mensagem"})]})}),e&&e.length>0&&s.jsx(Wd,{rows:i,rowRender:n=>s.jsxs(s.Fragment,{children:[n.isRoomInfo&&s.jsx(r,{roomId:n.roomId,roomName:n.roomName},n.roomId),!n.isRoomInfo&&s.jsxs(Ye,{fullHeight:!1,gap:1,alignItems:"center",className:"log-entry py-1 border-bottom",children:[s.jsx(T,{className:"g-col-2",children:n.timestamp}),s.jsx(T,{className:"g-col-3",bold:!0,underline:!0,pointer:!0,onClick:o=>Ce(`mod-tools/open-user-info/${n.habboId}`),children:n.username}),s.jsx(T,{textBreak:!0,wrap:!0,className:"g-col-7",children:n.message})]},n.roomId)]})})]})})},aoe=a=>{const{roomId:e=null,onCloseClick:t=null}=a,[i,r]=h.useState(null);return J(D0,n=>{const o=n.getParser();!o||o.data.roomId!==e||r(o.data)}),h.useEffect(()=>{K(new r1(e))},[e]),i?s.jsxs(ve,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",windowPosition:Vi.TOP_LEFT,children:[s.jsx(je,{headerText:`Chatlog do quarto ${i.roomName}`,onCloseClick:t}),s.jsx(be,{className:"text-black",overflow:"hidden",children:i&&s.jsx(KN,{records:[i]})})]}):null},ooe=a=>{const{roomId:e=null,onCloseClick:t=null}=a,[i,r]=h.useState(!1),[n,o]=h.useState(null),[l,c]=h.useState(null),[u,d]=h.useState(null),[_,m]=h.useState(null),[f,E]=h.useState(!1),[I,p]=h.useState(0),[S,R]=h.useState(!1),[O,C]=h.useState(!1),[A,b]=h.useState(!1),[y,M]=h.useState(""),U=(G,F)=>{if(G)switch(G){case"alert_only":if(y.trim().length===0)return;K(new Pu(Pu.ACTION_ALERT,y,"")),K(new Rx(e,O?1:0,A?1:0,S?1:0));return;case"send_message":if(y.trim().length===0)return;K(new Pu(Pu.ACTION_MESSAGE,y,"")),K(new Rx(e,O?1:0,A?1:0,S?1:0));return}};return J(b0,G=>{const F=G.getParser();!F||F.data.flatId!==e||(o(F.data.flatId),c(F.data.room.name),d(F.data.ownerId),m(F.data.ownerName),E(F.data.ownerInRoom),p(F.data.userCount))}),h.useEffect(()=>{i||(K(new s1(e)),r(!0))},[e,i,r]),s.jsxs(ve,{className:"nitro-mod-tools-room",theme:"primary-slim",windowPosition:Vi.TOP_LEFT,children:[s.jsx(je,{headerText:"Quarto"+(l?": "+l:""),onCloseClick:G=>t()}),s.jsxs(be,{className:"text-black",children:[s.jsxs(x,{gap:2,children:[s.jsxs(N,{justifyContent:"center",grow:!0,gap:1,children:[s.jsxs(x,{alignItems:"center",gap:2,children:[s.jsx(T,{bold:!0,align:"start",className:"col-7",children:"Dono do quarto:"}),s.jsx(T,{underline:!0,pointer:!0,truncate:!0,children:_})]}),s.jsxs(x,{alignItems:"center",gap:2,children:[s.jsx(T,{bold:!0,align:"start",className:"col-7",children:"Usuários no Quarto:"}),s.jsx(T,{children:I})]}),s.jsxs(x,{alignItems:"center",gap:2,children:[s.jsx(T,{bold:!0,align:"start",className:"col-7",children:"Dono está no Quarto:"}),s.jsx(T,{children:f?"Sim":"Não"})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(X,{onClick:G=>qn(e),children:"Visitar Quarto"}),s.jsx(X,{onClick:G=>Ce(`mod-tools/open-room-chatlog/${e}`),children:"Log Chat"})]})]}),s.jsxs(N,{className:"bg-muted rounded p-2",gap:1,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:S,onChange:G=>R(G.target.checked)}),s.jsx(T,{small:!0,children:"Kickar todos os usuários"})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:O,onChange:G=>C(G.target.checked)}),s.jsx(T,{small:!0,children:"Ativar campainha"})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:A,onChange:G=>b(G.target.checked)}),s.jsx(T,{small:!0,children:"Mudar nome do quarto"})]})]}),s.jsx("textarea",{className:"form-control",placeholder:"Escreva uma mensagem obrigatória para os usuários neste campo de texto...",value:y,onChange:G=>M(G.target.value)}),s.jsxs(x,{justifyContent:"between",children:[s.jsx(X,{variant:"danger",onClick:G=>U("send_message"),children:"Enviar Advertência"}),s.jsx(X,{onClick:G=>U("alert_only"),children:"Enviar Alerta"})]})]})]})},loe=a=>{const{onCloseClick:e=null,issueId:t=null}=a,[i,r]=h.useState(null);return J(T0,n=>{const o=n.getParser();!o||o.data.issueId!==t||r(o.data)}),h.useEffect(()=>{K(new t1(t))},[t]),s.jsxs(ve,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",children:[s.jsx(je,{headerText:"Issue Chatlog",onCloseClick:e}),s.jsx(be,{className:"text-black",children:i&&s.jsx(KN,{records:[i.chatRecord]})})]})},coe=a=>{const{issueId:e=null,onIssueInfoClosed:t=null}=a,[i,r]=h.useState(!1),{tickets:n=[],openUserInfo:o=null}=Zd(),l=n.find(d=>d.issueId===e),c=d=>{K(new JC([d])),t(d)},u=d=>{K(new Lu([e],d)),t(e)};return s.jsxs(s.Fragment,{children:[s.jsxs(ve,{className:"nitro-mod-tools-handle-issue",theme:"primary-slim",children:[s.jsx(je,{headerText:"Resolving issue "+e,onCloseClick:()=>t(e)}),s.jsxs(be,{className:"text-black",children:[s.jsx(T,{fontSize:4,children:"Issue Information"}),s.jsxs(Ye,{overflow:"auto",children:[s.jsx(N,{size:8,children:s.jsx("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:s.jsxs("tbody",{children:[s.jsxs("tr",{children:[s.jsx("th",{children:"Source"}),s.jsx("td",{children:gJ(l.categoryId)})]}),s.jsxs("tr",{children:[s.jsx("th",{children:"Category"}),s.jsx("td",{className:"text-break",children:g("help.cfh.topic."+l.reportedCategoryId)})]}),s.jsxs("tr",{children:[s.jsx("th",{children:"Description"}),s.jsx("td",{className:"text-break",children:l.message})]}),s.jsxs("tr",{children:[s.jsx("th",{children:"Caller"}),s.jsx("td",{children:s.jsx(T,{bold:!0,underline:!0,pointer:!0,onClick:d=>o(l.reporterUserId),children:l.reporterUserName})})]}),s.jsxs("tr",{children:[s.jsx("th",{children:"Reported User"}),s.jsx("td",{children:s.jsx(T,{bold:!0,underline:!0,pointer:!0,onClick:d=>o(l.reportedUserId),children:l.reportedUserName})})]})]})})}),s.jsxs(N,{size:4,gap:1,children:[s.jsx(X,{variant:"secondary",onClick:()=>r(!i),children:"Log Chat"}),s.jsx(X,{onClick:d=>u(Lu.RESOLUTION_USELESS),children:"Fechar sem motivo"}),s.jsx(X,{variant:"danger",onClick:d=>u(Lu.RESOLUTION_ABUSIVE),children:"Marcar como abusivo"}),s.jsx(X,{variant:"success",onClick:d=>u(Lu.RESOLUTION_RESOLVED),children:"Marcar como resolvido"}),s.jsx(X,{variant:"secondary",onClick:d=>c(e),children:"Libertar"})]})]})]})]}),i&&s.jsx(loe,{issueId:e,onCloseClick:()=>r(!1)})]})},uoe=a=>{const{myIssues:e=null,handleIssue:t=null}=a;return s.jsxs(N,{gap:0,overflow:"hidden",children:[s.jsx(N,{gap:2,children:s.jsxs(Ye,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[s.jsx(q,{className:"g-col-2",children:"Tipo"}),s.jsx(q,{className:"g-col-3",children:"Usuário"}),s.jsx(q,{className:"g-col-3",children:"Data"}),s.jsx(q,{className:"g-col-2"}),s.jsx(q,{className:"g-col-2"})]})}),s.jsx(N,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(i=>s.jsxs(Ye,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[s.jsx(q,{className:"g-col-2",children:i.categoryId}),s.jsx(q,{className:"g-col-3",children:i.reportedUserName}),s.jsx(q,{className:"g-col-3",children:new Date(Date.now()-i.issueAgeInMilliseconds).toLocaleTimeString()}),s.jsx(q,{className:"g-col-2",children:s.jsx(X,{variant:"primary",onClick:r=>t(i.issueId),children:"Gerir"})}),s.jsx(q,{className:"g-col-2",children:s.jsx(X,{variant:"danger",onClick:r=>K(new JC([i.issueId])),children:"Libertar"})})]},i.issueId))})]})},hoe=a=>{const{openIssues:e=null}=a;return s.jsxs(N,{gap:0,overflow:"hidden",children:[s.jsx(N,{gap:2,children:s.jsxs(Ye,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[s.jsx(q,{className:"g-col-2",children:"Tipo"}),s.jsx(q,{className:"g-col-3",children:"Usuário"}),s.jsx(q,{className:"g-col-4",children:"Data"}),s.jsx(q,{className:"g-col-3"})]})}),s.jsx(N,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(t=>s.jsxs(Ye,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[s.jsx(q,{className:"g-col-2",children:t.categoryId}),s.jsx(q,{className:"g-col-3",children:t.reportedUserName}),s.jsx(q,{className:"g-col-4",children:new Date(Date.now()-t.issueAgeInMilliseconds).toLocaleTimeString()}),s.jsx(q,{className:"g-col-3",children:s.jsx(X,{variant:"success",onClick:i=>K(new h1([t.issueId],!1,0,"pick issue button")),children:"Atender"})})]},t.issueId))})]})},doe=a=>{const{pickedIssues:e=null}=a;return s.jsxs(N,{gap:0,overflow:"hidden",children:[s.jsx(N,{gap:2,children:s.jsxs(Ye,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[s.jsx(q,{className:"g-col-2",children:"Tipo"}),s.jsx(q,{className:"g-col-3",children:"Usuário"}),s.jsx(q,{className:"g-col-4",children:"Data"}),s.jsx(q,{className:"g-col-3",children:"Atendido por"})]})}),s.jsx(N,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(t=>s.jsxs(Ye,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[s.jsx(q,{className:"g-col-2",children:t.categoryId}),s.jsx(q,{className:"g-col-3",children:t.reportedUserName}),s.jsx(q,{className:"g-col-4",children:new Date(Date.now()-t.issueAgeInMilliseconds).toLocaleTimeString()}),s.jsx(q,{className:"g-col-3",children:t.pickerUserName})]},t.issueId))})]})},_oe=["Pedidos em Abertos","Meus Pedidos","Log de Pedidos"],goe=a=>{const{onCloseClick:e=null}=a,[t,i]=h.useState(0),[r,n]=h.useState([]),{tickets:o=[]}=Zd(),l=o.filter(f=>f.state===Vu.STATE_OPEN),c=o.filter(f=>f.state===Vu.STATE_PICKED&&f.pickerUserId===te().userId),u=o.filter(f=>f.state===Vu.STATE_PICKED),d=f=>{n(E=>{const I=[...E],p=I.indexOf(f);return p>=0&&I.splice(p,1),I})},_=f=>{n(E=>{const I=[...E],p=I.indexOf(f);return p===-1?I.push(f):I.splice(p,1),I})},m=()=>{switch(t){case 0:return s.jsx(hoe,{openIssues:l});case 1:return s.jsx(uoe,{myIssues:c,handleIssue:_});case 2:return s.jsx(doe,{pickedIssues:u})}return null};return s.jsxs(s.Fragment,{children:[s.jsxs(ve,{className:"nitro-mod-tools-tickets",children:[s.jsx(je,{headerText:"Tickets",onCloseClick:e}),s.jsx($n,{children:_oe.map((f,E)=>s.jsx(In,{isActive:t===E,onClick:I=>i(E),children:f},E))}),s.jsx(be,{gap:1,children:s.jsx(m,{})})]}),r&&r.length>0&&r.map(f=>s.jsx(coe,{issueId:f,onIssueInfoClosed:d},f))]})},moe=a=>{const{userId:e=null,onCloseClick:t=null}=a,[i,r]=h.useState(null),[n,o]=h.useState(null);return J(L0,l=>{const c=l.getParser();!c||c.data.userId!==e||(o(c.data.username),r(c.data.roomChatlogs))}),h.useEffect(()=>{K(new a1(e))},[e]),s.jsxs(ve,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",windowPosition:Vi.TOP_LEFT,children:[s.jsx(je,{headerText:`User Chatlog: ${n||""}`,onCloseClick:t}),s.jsx(be,{className:"text-black h-100",children:i&&s.jsx(KN,{records:i})})]})},Cv=[new us(1,"Alerta",us.ALERT,1,0),new us(2,"Mutar 1h",us.MUTE,2,0),new us(3,"Ban 18h",us.BAN,3,0),new us(4,"Ban 7 dias",us.BAN,4,0),new us(5,"Ban 30 dias",us.BAN,5,0),new us(7,"Ban 30 dias",us.BAN,7,0),new us(6,"Ban permanente",us.BAN,6,0),new us(106,"Ban avatar permanente",us.BAN,6,0),new us(101,"Expulsar",us.KICK,0,0),new us(102,"Bloquear trocas",us.TRADE_LOCK,0,168),new us(104,"Bloquear trocas permanente",us.TRADE_LOCK,0,876e3),new us(105,"Mensagem",us.MESSAGE,0,0)],foe=a=>{const{user:e=null,onCloseClick:t=null}=a,[i,r]=h.useState(-1),[n,o]=h.useState(-1),[l,c]=h.useState(""),{cfhCategories:u=null,settings:d=null}=Zd(),{simpleAlert:_=null}=kt(),m=h.useMemo(()=>{const p=[];if(u&&u.length)for(const S of u)for(const R of S.topics)p.push(R);return p},[u]),f=p=>_(p,lt.DEFAULT,null,null,"Error"),E=()=>{let p=null;const S=m[i];if(i===-1&&(p="Você deve selecionar um tópico de CFH"),p)return f(p);const R=l.trim().length===0?g(`help.cfh.topic.${S.id}`):l;K(new e1(e.userId,i,R)),t()},I=()=>{let p=null;const S=m[i],R=Cv[n];if(i===-1||n===-1?p="Você deve selecionar um tópico de CFH e uma ação":!d||!d.cfhPermission?p="Você não tem permissão para usar o CFH":S?R||(p="Você deve selecionar uma ação"):p="Você deve selecionar um tópico de CFH",p){f(p);return}const O=l.trim().length===0?g(`help.cfh.topic.${S.id}`):l;switch(R.actionType){case us.ALERT:{if(!d.alertPermission){f("Você tem permissões insuficientes");return}K(new o1(e.userId,O,S.id));break}case us.MUTE:K(new c1(e.userId,O,S.id));break;case us.BAN:{if(!d.banPermission){f("Você tem permissões insuficientes");return}K(new Fo(e.userId,O,S.id,n,R.actionId===106));break}case us.KICK:{if(!d.kickPermission){f("Você tem permissões insuficientes");return}K(new l1(e.userId,O,S.id));break}case us.TRADE_LOCK:{const C=R.actionLengthHours*60;K(new u1(e.userId,O,C,S.id));break}case us.MESSAGE:{if(l.trim().length===0){f("Você deve inserir uma mensagem");return}K(new QC(e.userId,l,S.id));break}}t()};return e?s.jsxs(ve,{className:"nitro-mod-tools-user-action",theme:"primary-slim",windowPosition:Vi.TOP_LEFT,children:[s.jsx(je,{headerText:"Adverter: "+(e?e.username:""),onCloseClick:()=>t()}),s.jsxs(be,{className:"text-black",children:[s.jsxs("select",{className:"form-select form-select-sm",value:i,onChange:p=>r(parseInt(p.target.value)),children:[s.jsx("option",{value:-1,disabled:!0,children:"Tópico do CFH"}),m.map((p,S)=>s.jsx("option",{value:S,children:g("help.cfh.topic."+p.id)},S))]}),s.jsxs("select",{className:"form-select form-select-sm",value:n,onChange:p=>o(parseInt(p.target.value)),children:[s.jsx("option",{value:-1,disabled:!0,children:"Tipo de ação"}),Cv.map((p,S)=>s.jsx("option",{value:S,children:p.name},S))]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{small:!0,children:"Mensagem opcional, substitui a padrão"}),s.jsx("textarea",{className:"form-control",value:l,onChange:p=>c(p.target.value)})]}),s.jsxs(x,{justifyContent:"between",gap:1,children:[s.jsx(X,{variant:"primary",onClick:E,children:"Ação Padrão"}),s.jsx(X,{variant:"success",onClick:I,children:"Enviar"})]})]})]}):null},poe=a=>{const{userId:e=null,onCloseClick:t=null}=a,[i,r]=h.useState(null);return J(M0,n=>{const o=n.getParser();o.data.userId===e&&r(o.data)}),h.useEffect(()=>{K(new n1(e))},[e]),e?s.jsxs(ve,{className:"nitro-mod-tools-user-visits",theme:"primary-slim",windowPosition:Vi.TOP_LEFT,children:[s.jsx(je,{headerText:"Visitas de quarto",onCloseClick:t}),s.jsx(be,{className:"text-black",gap:1,children:s.jsxs(N,{fullHeight:!0,gap:0,overflow:"hidden",children:[s.jsx(N,{gap:2,children:s.jsxs(Ye,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[s.jsx(q,{className:"g-col-2",children:"Tempo"}),s.jsx(q,{className:"g-col-7",children:"Quarto"}),s.jsx(q,{className:"g-col-3",children:"Visitar"})]})}),s.jsx(Wd,{rows:(i==null?void 0:i.rooms)??[],rowRender:n=>s.jsxs(Ye,{fullHeight:!1,gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[s.jsxs(T,{className:"g-col-2",children:[n.enterHour.toString().padStart(2,"0"),": ",n.enterMinute.toString().padStart(2,"0")]}),s.jsx(T,{className:"g-col-7",children:n.roomName}),s.jsx(T,{bold:!0,underline:!0,pointer:!0,variant:"primary",className:"g-col-3",onClick:o=>qn(n.roomId),style:{display:"inline-flex"},children:"Visitar"})]},n.id+"")})]})})]}):null},Eoe=a=>{const{user:e=null,onCloseClick:t=null}=a,[i,r]=h.useState(""),{simpleAlert:n=null}=kt();if(!e)return null;const o=()=>{if(i.trim().length===0){n("Please write a message to user.",null,null,null,"Error",null);return}K(new QC(e.userId,i,-999)),t()};return s.jsxs(ve,{className:"nitro-mod-tools-user-message",theme:"primary-slim",windowPosition:Vi.TOP_LEFT,children:[s.jsx(je,{headerText:"Send Message",onCloseClick:()=>t()}),s.jsxs(be,{className:"text-black",children:[s.jsxs(T,{children:["Message To: ",e.username]}),s.jsx("textarea",{className:"form-control",value:i,onChange:l=>r(l.target.value)}),s.jsx(X,{fullWidth:!0,onClick:o,children:"Send message"})]})]})},Ioe=a=>{const{onCloseClick:e=null,userId:t=null}=a,[i,r]=h.useState(null),[n,o]=h.useState(!1),[l,c]=h.useState(!1),[u,d]=h.useState(!1),_=h.useMemo(()=>i?[{localeKey:"Nome",value:i.userName,showOnline:!0},{localeKey:"Reportes",value:i.cfhCount.toString()},{localeKey:"Reportes Abusivos",value:i.abusiveCfhCount.toString()},{localeKey:"Avisos",value:i.cautionCount.toString()},{localeKey:"Banimentos",value:i.banCount.toString()},{localeKey:"Último Aviso",value:i.lastSanctionTime.length?i.lastSanctionTime:"Nunca"},{localeKey:"Trocas Bloqueadas",value:i.tradingLockCount.toString()},{localeKey:"Data de Expiração",value:i.tradingExpiryDate},{localeKey:"Último Login",value:Mr.format(i.minutesSinceLastLogin*60,".ago",2)},{localeKey:"Última Compra",value:i.lastPurchaseDate},{localeKey:"Contas Banidas",value:i.identityRelatedBanCount.toString()},{localeKey:"Conta há",value:Mr.format(i.registrationAgeInMinutes*60,".ago",2)}]:null,[i]);return J(y0,m=>{const f=m.getParser();!f||f.data.userId!==t||r(f.data)}),h.useEffect(()=>{K(new i1(t))},[t]),i?s.jsxs(s.Fragment,{children:[s.jsxs(ve,{className:"nitro-mod-tools-user",theme:"primary-slim",windowPosition:Vi.TOP_LEFT,children:[s.jsx(je,{headerText:`Usuário: ${i.userName}`,onCloseClick:()=>e()}),s.jsx(be,{className:"text-black",children:s.jsxs(Ye,{overflow:"hidden",children:[s.jsx(N,{size:8,overflow:"auto",children:s.jsx("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:s.jsx("tbody",{children:_.map((m,f)=>s.jsxs("tr",{children:[s.jsx("th",{scope:"row",children:g(m.localeKey)}),s.jsxs("td",{children:[m.value,m.showOnline&&s.jsx("i",{className:`icon icon-pf-${i.online?"online":"offline"} ms-2`})]})]},f))})})}),s.jsxs(N,{size:4,gap:1,children:[s.jsx(X,{onClick:m=>o(!n),children:"Enviar Mensagem"}),s.jsx(X,{onClick:m=>d(!u),children:"Visitas de Quartos"}),s.jsx(X,{onClick:m=>c(!l),children:"Adverter"})]})]})})]}),n&&s.jsx(Eoe,{user:{userId:t,username:i.userName},onCloseClick:()=>o(!1)}),l&&s.jsx(foe,{user:{userId:t,username:i.userName},onCloseClick:()=>c(!1)}),u&&s.jsx(poe,{userId:t,onCloseClick:()=>d(!1)})]}):null},Toe=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(-1),[n,o]=h.useState(null),[l,c]=h.useState(!1),{openRooms:u=[],openRoomChatlogs:d=[],openUserChatlogs:_=[],openUserInfos:m=[],openRoomInfo:f=null,closeRoomInfo:E=null,toggleRoomInfo:I=null,openRoomChatlog:p=null,closeRoomChatlog:S=null,toggleRoomChatlog:R=null,openUserInfo:O=null,closeUserInfo:C=null,toggleUserInfo:A=null,openUserChatlog:b=null,closeUserChatlog:y=null,toggleUserChatlog:M=null}=Zd(),U=h.useRef(null);return ut([Ot.INITIALIZED,Ot.DISPOSED],G=>{if(!Ba.isRoomPreviewerId(G.roomId))switch(G.type){case Ot.INITIALIZED:r(G.roomId);return;case Ot.DISPOSED:r(-1);return}}),Sm(G=>{if(G.category!==Q.UNIT)return;const F=$e();if(!F)return;const H=F.userDataManager.getUserDataByIndex(G.id);!H||H.type!==Xt.USER||o({userId:H.webID,username:H.name})}),h.useEffect(()=>{const G={linkReceived:F=>{const H=F.split("/");if(!(H.length<2))switch(H[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(v=>!v);return;case"open-room-info":f(Number(H[2]));return;case"close-room-info":E(Number(H[2]));return;case"toggle-room-info":I(Number(H[2]));return;case"open-room-chatlog":p(Number(H[2]));return;case"close-room-chatlog":S(Number(H[2]));return;case"toggle-room-chatlog":R(Number(H[2]));return;case"open-user-info":O(Number(H[2]));return;case"close-user-info":C(Number(H[2]));return;case"toggle-user-info":A(Number(H[2]));return;case"open-user-chatlog":b(Number(H[2]));return;case"close-user-chatlog":y(Number(H[2]));return;case"toggle-user-chatlog":M(Number(H[2]));return}},eventUrlPrefix:"mod-tools/"};return fs(G),()=>ps(G)},[f,E,I,p,S,R,O,C,A,b,y,M]),s.jsxs(s.Fragment,{children:[e&&s.jsxs(ve,{uniqueKey:"mod-tools",className:"nitro-mod-tools",windowPosition:Vi.TOP_LEFT,theme:"primary-slim",children:[s.jsx(je,{headerText:"Mod Tools",onCloseClick:G=>t(!1)}),s.jsxs(be,{className:"text-black",gap:1,children:[s.jsxs(X,{gap:1,onClick:G=>Ce(`mod-tools/toggle-room-info/${i}`),disabled:i<=0,className:"position-relative",children:[s.jsx(q,{className:"icon icon-small-room position-absolute start-1"})," Ferramenta Quarto"]}),s.jsxs(X,{innerRef:U,gap:1,onClick:G=>Ce(`mod-tools/toggle-room-chatlog/${i}`),disabled:i<=0,className:"position-relative",children:[s.jsx(q,{className:"icon icon-chat-history position-absolute start-1"})," Ferramenta Chat"]}),s.jsxs(X,{gap:1,onClick:()=>Ce(`mod-tools/toggle-user-info/${n.userId}`),disabled:!n,className:"position-relative",children:[s.jsx(q,{className:"icon icon-user position-absolute start-1"})," Usuário: ",n?n.username:""]}),s.jsxs(X,{gap:1,onClick:()=>c(G=>!G),className:"position-relative",children:[s.jsx(q,{className:"icon icon-tickets position-absolute start-1"})," Ferramenta Reports"]})]})]}),u.length>0&&u.map(G=>s.jsx(ooe,{roomId:G,onCloseClick:()=>Ce(`mod-tools/close-room-info/${G}`)},G)),d.length>0&&d.map(G=>s.jsx(aoe,{roomId:G,onCloseClick:()=>Ce(`mod-tools/close-room-chatlog/${G}`)},G)),m.length>0&&m.map(G=>s.jsx(Ioe,{userId:G,onCloseClick:()=>Ce(`mod-tools/close-user-info/${G}`)},G)),_.length>0&&_.map(G=>s.jsx(moe,{userId:G,onCloseClick:()=>Ce(`mod-tools/close-user-chatlog/${G}`)},G)),l&&s.jsx(goe,{onCloseClick:()=>c(!1)})]})},Soe=[Wt.START_DOORBELL,Wt.STATE_WAITING,Wt.STATE_NO_ANSWER,Wt.START_PASSWORD,Wt.STATE_WRONG_PASSWORD,Wt.START_INVISIBLE],Roe=[Wt.START_DOORBELL,Wt.STATE_WAITING,Wt.STATE_NO_ANSWER],xoe=a=>{const[e,t]=h.useState(""),{doorData:i=null,setDoorData:r=null}=Ir(),n=()=>{i&&i.state===Wt.STATE_WAITING&&yx(),r(null)},o=()=>{!i||!i.roomInfo||(_c(i.roomInfo.roomId),r(_=>{const m={..._};return m.state=Wt.STATE_PENDING_SERVER,m}))},l=()=>{!i||!i.roomInfo||(_c(i.roomInfo.roomId,null,2),r(_=>{const m={..._};return m.state=Wt.STATE_PENDING_SERVER,m}))},c=()=>{!i||!i.roomInfo||(_c(i.roomInfo.roomId,e),r(_=>{const m={..._};return m.state=Wt.STATE_PENDING_SERVER,m}))};h.useEffect(()=>{!i||i.state!==Wt.STATE_NO_ANSWER||yx()},[i]);const u=h.useMemo(()=>i&&Roe.indexOf(i.state)>=0&&i.state!==Wt.START_INVISIBLE,[i]),d=h.useMemo(()=>i&&i.state===Wt.START_INVISIBLE,[i]);return!i||i.state===Wt.NONE||Soe.indexOf(i.state)===-1||d&&!te().isModerator?null:s.jsxs(ve,{className:"nitro-navigator-doorbell",theme:"primary-slim",children:[s.jsx(je,{headerText:g(u?"navigator.doorbell.title":d?"navigator.invisible.title":"navigator.password.title"),onCloseClick:n}),s.jsxs(be,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:i&&i.roomInfo&&i.roomInfo.roomName}),i.state===Wt.START_DOORBELL&&s.jsx(T,{children:g("navigator.doorbell.info")}),i.state===Wt.STATE_WAITING&&s.jsx(T,{children:g("navigator.doorbell.waiting")}),i.state===Wt.STATE_NO_ANSWER&&s.jsx(T,{children:g("navigator.doorbell.no.answer")}),i.state===Wt.START_PASSWORD&&s.jsx(T,{children:g("navigator.password.info")}),i.state===Wt.STATE_WRONG_PASSWORD&&s.jsx(T,{children:g("navigator.password.retryinfo")}),i.state===Wt.START_INVISIBLE&&s.jsx(T,{children:g("navigator.invisible.info")})]}),u&&s.jsxs(N,{gap:1,children:[i.state===Wt.START_DOORBELL&&te().isModerator&&s.jsx(X,{variant:"primary",onClick:l,children:g("navigator.doorbell.button.enter_without_bell")}),i.state===Wt.START_DOORBELL&&s.jsx(X,{variant:"success",onClick:o,children:g("navigator.doorbell.button.ring")}),s.jsx(X,{variant:"danger",onClick:n,children:g("generic.cancel")})]}),d&&te().isModerator&&s.jsxs(N,{gap:1,children:[s.jsx(X,{variant:"primary",onClick:l,children:g("navigator.invisible.button.enter")}),s.jsx(X,{variant:"success",onClick:i.roomInfo.userCount>0?o:l,children:g("navigator.doorbell.button.ring")}),s.jsx(X,{variant:"danger",onClick:n,children:g("generic.cancel")})]}),!u&&!d&&s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("navigator.password.enter")}),s.jsx("input",{type:"password",className:"form-control form-control-sm",onChange:_=>t(_.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(X,{variant:"success",onClick:c,children:g("navigator.password.button.try")}),s.jsx(X,{variant:"danger",onClick:n,children:g("generic.cancel")})]})]})]})]})},Ooe=a=>{const[e,t]=h.useState(null),[i,r]=h.useState(null),[n,o]=h.useState(null),[l,c]=h.useState(null),[u,d]=h.useState(null),[_,m]=h.useState(0),[f,E]=h.useState([]),[I,p]=h.useState(""),{categories:S=null}=Ir(),R=xe("hc.disabled",!1),O=b=>xe("images.url")+`/navigator/models/model_${b}.png`,C=(b,y)=>{!b||b.clubLevel>ti()||p(f[y].name)},A=()=>{K(new g1(i,n,"model_"+I,Number(l),Number(u),_))};return h.useEffect(()=>{if(!e){const b=[];for(let y=10;y<=100;y=y+10)b.push(y);t(b),d(b[0])}},[e]),h.useEffect(()=>{S&&S.length&&c(S[0].id)},[S]),h.useEffect(()=>{const b=xe("navigator.room.models");b&&b.length&&(E(b),p(b[0].name))},[]),s.jsxs(N,{overflow:"hidden",children:[s.jsxs(Ye,{overflow:"hidden",children:[s.jsxs(N,{size:6,gap:1,overflow:"auto",children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("navigator.createroom.roomnameinfo")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:60,onChange:b=>r(b.target.value),placeholder:g("navigator.createroom.roomnameinfo")})]}),s.jsxs(N,{grow:!0,gap:1,children:[s.jsx(T,{children:g("navigator.createroom.roomdescinfo")}),s.jsx("textarea",{className:"flex-grow-1 form-control form-control-sm w-100",maxLength:255,onChange:b=>o(b.target.value),placeholder:g("navigator.createroom.roomdescinfo")})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("navigator.category")}),s.jsx("select",{className:"form-select form-select-sm",onChange:b=>c(Number(b.target.value)),children:S&&S.length>0&&S.map(b=>s.jsx("option",{value:b.id,children:g(b.name)},b.id))})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("navigator.maxvisitors")}),s.jsx("select",{className:"form-select form-select-sm",onChange:b=>d(Number(b.target.value)),children:e&&e.map(b=>s.jsx("option",{value:b,children:b},b))})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("navigator.tradesettings")}),s.jsxs("select",{className:"form-select form-select-sm",onChange:b=>m(Number(b.target.value)),children:[s.jsx("option",{value:"0",children:g("navigator.roomsettings.trade_not_allowed")}),s.jsx("option",{value:"1",children:g("navigator.roomsettings.trade_not_with_Controller")}),s.jsx("option",{value:"2",children:g("navigator.roomsettings.trade_allowed")})]})]})]}),s.jsx(N,{size:6,gap:1,overflow:"auto",children:f.map((b,y)=>s.jsxs(ct,{fullHeight:!0,onClick:()=>C(b,y),itemActive:I===b.name,overflow:"unset",gap:0,className:"p-1",disabled:ti()<b.clubLevel,children:[s.jsx(x,{fullHeight:!0,center:!0,overflow:"hidden",children:s.jsx("img",{alt:"",src:O(b.name)})}),s.jsxs(T,{bold:!0,children:[b.tileSize," ",g("navigator.createroom.tilesize")]}),!R&&b.clubLevel>rr.NO_CLUB&&s.jsx(gs,{position:"absolute",className:"top-1 end-1",type:"hc"})]},b.name))})]}),s.jsx(X,{fullWidth:!0,variant:!i||i.length<3?"danger":"success",onClick:A,disabled:!i||i.length<3,children:g("navigator.createroom.create")})]})},Coe=a=>{const{onCloseClick:e=null}=a,[t,i]=h.useState(!1),[r,n]=h.useState(!1),{report:o=null}=Rn(),{navigatorData:l=null}=Ir(),c=$e(),u=_=>{if(_==="staff_pick")return te().securityLevel>=zu.COMMUNITY;if(te().userId===l.enteredGuestRoom.ownerId||te().isModerator)return!0;if(!c||!c.moderationSettings)return!1;switch(_){case"settings":return c.moderationSettings.allowDeleteRoom==Zt.MODERATION_LEVEL_USER_WITH_RIGHTS&&c.controllerLevel>=pt.USER_WITH_RIGHTS;case"mute_all":return c.moderationSettings.allowMuteRoom==Zt.MODERATION_LEVEL_USER_WITH_RIGHTS&&c.controllerLevel>=pt.USER_WITH_RIGHTS;case"floor_plan":return c.moderationSettings.allowSaveFloorPlan==Zt.MODERATION_LEVEL_USER_WITH_RIGHTS&&c.controllerLevel>=pt.USER_WITH_RIGHTS;case"rights":return c.controllerLevel>=pt.USER_WITH_RIGHTS;default:return!1}},d=(_,m)=>{if(!(!l||!l.enteredGuestRoom))switch(_){case"set_home_room":let f=-1;l.homeRoomId!==l.enteredGuestRoom.roomId&&(f=l.enteredGuestRoom.roomId),K(new iN(f));return;case"toggle_favourite_room":if(l.favouriteRooms.includes(l.enteredGuestRoom.roomId)){const E=l.favouriteRooms.indexOf(l.enteredGuestRoom.roomId);E>-1&&l.favouriteRooms.splice(E,1),K(new eN(l.enteredGuestRoom.roomId))}else l.favouriteRooms.push(l.enteredGuestRoom.roomId),K(new ZC(l.enteredGuestRoom.roomId));return;case"navigator_search_tag":Ce(`navigator/search/${m}`),K(new Ku("hotel_view",`tag:${m}`));return;case"open_room_thumbnail_camera":_i(new bo(bo.TOGGLE_THUMBNAIL));return;case"open_group_info":Qd(l.enteredGuestRoom.habboGroupId);return;case"toggle_room_link":Ce("navigator/toggle-room-link");return;case"open_room_settings":K(new mT(l.enteredGuestRoom.roomId));return;case"toggle_pick":i(E=>!E),K(new T1(l.enteredGuestRoom.roomId));return;case"toggle_mute":n(E=>!E),K(new Kw);return;case"room_filter":K(new f1(l.enteredGuestRoom.roomId));return;case"open_floorplan_editor":Ce("floor-editor/toggle");return;case"report_room":o(xs.ROOM,{roomId:l.enteredGuestRoom.roomId,roomName:l.enteredGuestRoom.roomName});return;case"close":e();return;case"open_wall_editor":Ce("wall-editor/show");return;case"remove_rights":K(new sN(l.enteredGuestRoom.roomId));return}};return h.useEffect(()=>{l&&(i(l.currentRoomIsStaffPick),l.enteredGuestRoom&&n(l.enteredGuestRoom.allInRoomMuted))},[l]),l.enteredGuestRoom?s.jsxs(ve,{className:"nitro-room-info",theme:"primary-slim",children:[s.jsx(je,{headerText:g("navigator.roomsettings.roominfo"),onCloseClick:()=>d("close")}),s.jsx(be,{className:"text-black",children:l.enteredGuestRoom&&s.jsxs(s.Fragment,{children:[s.jsxs(x,{gap:2,overflow:"hidden",children:[s.jsxs(N,{gap:2,children:[s.jsx(NT,{roomId:l.enteredGuestRoom.roomId,customUrl:l.enteredGuestRoom.officialRoomPicRef,children:u("settings")&&s.jsx("i",{className:"icon icon-camera-small position-absolute b-0 r-0 m-1 cursor-pointer top-0",onClick:()=>d("open_room_thumbnail_camera")})}),s.jsxs("div",{className:"btn-group button-container",children:[s.jsx(X,{style:{maxWidth:"37px",borderColor:"#1e7295"},title:g(l.homeRoomId!==l.enteredGuestRoom.roomId?"Definir Cafofo":"Remover como Cafofo"),children:s.jsx("i",{onClick:()=>d("set_home_room"),className:za("flex-shrink-0 icon icon-house-small cursor-pointer",l.homeRoomId!==l.enteredGuestRoom.roomId&&"gray")})}),s.jsx(X,{style:{maxWidth:"37px",borderColor:"#1e7295"},title:g(l.favouriteRooms.includes(l.enteredGuestRoom.roomId)?"Remover dos Favoritos":"Adicionar nos Favoritos"),children:s.jsx("i",{onClick:()=>d("toggle_favourite_room"),className:za("flex-shrink-0 icon cursor-pointer",l.favouriteRooms.includes(l.enteredGuestRoom.roomId)?"icon-favourited-room":"icon-unfavourited-room")})}),s.jsx(X,{style:{maxWidth:"37px",borderColor:"#1e7295"},children:s.jsx("i",{title:g("navigator.embed.caption"),className:"flex-shrink-0 cursor-pointer icon icon-room-link",onClick:_=>Ce("navigator/toggle-room-link")})})]}),l.enteredGuestRoom.tags.length>0&&l.enteredGuestRoom.tags.every(_=>_.length)&&s.jsx(N,{alignItems:"start",gap:1,style:{width:"110px"},children:l.enteredGuestRoom.tags.map(_=>s.jsxs(T,{truncate:!0,pointer:!0,className:"bg-muted rounded p-1",style:{width:"110px"},onClick:m=>d("navigator_search_tag",_),children:["#",_]},_))})]}),s.jsxs(N,{grow:!0,gap:1,overflow:"hidden",children:[s.jsxs(x,{gap:1,children:[s.jsxs(N,{grow:!0,gap:1,overflow:"hidden",children:[s.jsx(x,{gap:1,children:s.jsx(T,{bold:!0,className:"text-truncate",children:l.enteredGuestRoom.roomName})}),l.enteredGuestRoom.showOwner&&s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{variant:"muted",children:g("navigator.roomownercaption")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(Xn,{userId:l.enteredGuestRoom.ownerId}),s.jsx(T,{children:l.enteredGuestRoom.ownerName})]})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{variant:"muted",children:g("navigator.roomrating")}),s.jsx(T,{children:l.currentRoomRating})]})]}),s.jsx(N,{alignItems:"center",gap:1,children:s.jsxs(x,{alignItems:"center",gap:1,children:[u("rights")&&s.jsx(q,{pointer:!0,title:g("infostand.button.removerights"),onClick:()=>d("remove_rights"),className:"icon icon-remove-rights"}),u("settings")&&s.jsx("i",{className:"icon icon-cog cursor-pointer",title:g("navigator.room.popup.info.room.settings"),onClick:_=>d("open_room_settings")})]})})]}),s.jsx(T,{overflow:"auto",style:{maxHeight:"121px",overflowWrap:"anywhere"},children:l.enteredGuestRoom.description}),l.enteredGuestRoom.habboGroupId>0&&s.jsxs(x,{pointer:!0,alignItems:"center",gap:1,onClick:()=>d("open_group_info"),children:[s.jsx(as,{className:"flex-none",badgeCode:l.enteredGuestRoom.groupBadgeCode,isGroup:!0}),s.jsx(T,{underline:!0,children:g("navigator.guildbase",["groupName"],[l.enteredGuestRoom.groupName])})]})]})]}),s.jsxs(N,{gap:1,children:[u("staff_pick")&&s.jsx(X,{onClick:()=>d("toggle_pick"),children:g(t?"navigator.staffpicks.unpick":"navigator.staffpicks.pick")}),u("mute_all")&&s.jsx(X,{onClick:()=>d("toggle_mute"),children:g(r?"navigator.muteall_on":"navigator.muteall_off")}),u("room_filter")&&s.jsx(X,{onClick:()=>d("room_filter"),children:g("navigator.roomsettings.roomfilter")}),u("floor_plan")&&s.jsx(X,{onClick:()=>d("open_floorplan_editor"),children:g("open.floor.plan.editor")}),u("rights")&&s.jsx(X,{onClick:()=>d("open_wall_editor"),children:g("wall-editor.title")}),s.jsx(X,{variant:"danger",onClick:()=>d("report_room"),children:g("help.emergency.main.report.room")})]})]})})]}):null},Noe=a=>{const{onCloseClick:e=null,roomId:t=-1}=a,{navigatorData:i=null}=Ir(),r=!isNaN(t)&&t>0;return!i.enteredGuestRoom&&!r?null:s.jsxs(ve,{className:"nitro-room-link",theme:"primary-slim",children:[s.jsx(je,{headerText:g("navigator.embed.title"),onCloseClick:e}),s.jsx(be,{className:"text-black d-flex align-items-center",children:s.jsxs(x,{gap:2,children:[s.jsx(NT,{roomId:i.enteredGuestRoom?i.enteredGuestRoom.roomId:-1,customUrl:i.enteredGuestRoom?i.enteredGuestRoom.officialRoomPicRef:""}),s.jsxs(N,{gap:3,children:[s.jsx(T,{bold:!0,fontSize:5,children:g("navigator.embed.headline")}),s.jsx(T,{children:g("navigator.embed.info")}),s.jsxs(x,{gap:1,children:[s.jsx(X,{onClick:()=>navigator.clipboard.writeText(g("navigator.embed.src",["roomId"],[r?t.toString():i.enteredGuestRoom.roomId.toString()]).replace("${url.prefix}",xe("url.prefix",""))),children:"Copiar URL do quarto"}),s.jsx(X,{onClick:()=>navigator.clipboard.writeText(r?t.toString():i.enteredGuestRoom.roomId.toString()),children:"Copiar ID do quarto"})]})]})]})})]})},Aoe=a=>{const{roomData:e=null,handleChange:t=null}=a,[i,r]=h.useState(""),[n,o]=h.useState(""),[l,c]=h.useState(!1),u=()=>{!l||i.length<=0||n.length<=0||i!==n||t("password",i)};return h.useEffect(()=>{r(""),o(""),c(!1)},[e]),s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.roomaccess.caption")}),s.jsx(T,{children:g("navigator.roomsettings.roomaccess.info")})]}),s.jsxs(N,{overflow:"auto",children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.doormode")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===is.OPEN_STATE&&!l,onChange:d=>t("lock_state",is.OPEN_STATE)}),s.jsx(T,{children:g("navigator.roomsettings.doormode.open")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===is.DOORBELL_STATE&&!l,onChange:d=>t("lock_state",is.DOORBELL_STATE)}),s.jsx(T,{children:g("navigator.roomsettings.doormode.doorbell")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===is.INVISIBLE_STATE&&!l,onChange:d=>t("lock_state",is.INVISIBLE_STATE)}),s.jsx(T,{children:g("navigator.roomsettings.doormode.invisible")})]}),s.jsxs(x,{fullWidth:!0,gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===is.PASSWORD_STATE||l,onChange:d=>c(d.target.checked)}),!l&&e.lockState!==is.PASSWORD_STATE&&s.jsx(T,{children:g("navigator.roomsettings.doormode.password")}),(l||e.lockState===is.PASSWORD_STATE)&&s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("navigator.roomsettings.doormode.password")}),s.jsx("input",{type:"password",className:"form-control form-control-sm col-4",value:i,onChange:d=>r(d.target.value),placeholder:g("navigator.roomsettings.password"),onFocus:d=>c(!0),autoComplete:"off"}),l&&i.length<=0&&s.jsx(T,{bold:!0,small:!0,variant:"danger",children:g("navigator.roomsettings.passwordismandatory")}),s.jsx("input",{type:"password",className:"form-control form-control-sm col-4",value:n,onChange:d=>o(d.target.value),onBlur:u,placeholder:g("navigator.roomsettings.passwordconfirm"),autoComplete:"off"}),l&&i.length>0&&i!==n&&s.jsx(T,{bold:!0,small:!0,variant:"danger",children:g("navigator.roomsettings.invalidconfirm")})]})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.pets")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.allowPets,onChange:d=>t("allow_pets",d.target.checked)}),s.jsx(T,{children:g("navigator.roomsettings.allowpets")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.allowPetsEat,onChange:d=>t("allow_pets_eat",d.target.checked)}),s.jsx(T,{children:g("navigator.roomsettings.allowfoodconsume")})]})]})]})]})},Nv=3,Av=60,bv=255,Hm=15,boe=a=>{var M,U,G;const{roomData:e=null,handleChange:t=null,onClose:i=null}=a,[r,n]=h.useState(""),[o,l]=h.useState(""),[c,u]=h.useState(""),[d,_]=h.useState(""),[m,f]=h.useState(0),[E,I]=h.useState(""),{showConfirm:p=null}=kt(),{categories:S=null,navigatorData:R=null}=Ir(),O=((M=te())==null?void 0:M.userId)!==((U=R.enteredGuestRoom)==null?void 0:U.ownerId)&&!((G=te())!=null&&G.isModerator);J(fL,F=>{const H=F.getParser();if(H)switch(H.code){case Ug.ERROR_INVALID_TAG:I("navigator.roomsettings.unacceptablewords");break;case Ug.ERROR_NON_USER_CHOOSABLE_TAG:I("navigator.roomsettings.nonuserchoosabletag");break;default:I("");break}});const C=()=>{p(g("navigator.roomsettings.deleteroom.confirm.message",["room_name"],[e.roomName]),()=>{K(new V1(e.roomId)),i&&i(),Ce("navigator/search/myworld_view")},null,null,null,g("navigator.roomsettings.deleteroom.confirm.title"))},A=()=>{r===e.roomName||r.length<Nv||r.length>Av||t("name",r)},b=()=>{o===e.roomDescription||o.length>bv||t("description",o)},y=F=>{F===0&&c===e.tags[0]||c.length>Hm||F===1&&d===e.tags[1]||d.length>Hm||(c===""&&d!==""&&_(""),I(""),f(F),t("tags",c===""&&d!==""?[d]:[c,d]))};return h.useEffect(()=>{n(e.roomName),l(e.roomDescription),u(e.tags.length>0&&e.tags[0]?e.tags[0]:""),_(e.tags.length>0&&e.tags[1]?e.tags[1]:"")},[e]),s.jsxs(s.Fragment,{children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{className:"col-3",children:g("navigator.roomname")}),s.jsxs(N,{fullWidth:!0,gap:0,children:[s.jsx("input",{className:"form-control form-control-sm",value:r,maxLength:Av,onChange:F=>n(F.target.value),onBlur:A,disabled:O}),r.length<Nv&&s.jsx(T,{bold:!0,small:!0,variant:"danger",children:g("navigator.roomsettings.roomnameismandatory")})]})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{className:"col-3",children:g("navigator.roomsettings.desc")}),s.jsx("textarea",{className:"form-control form-control-sm",value:o,maxLength:bv,onChange:F=>l(F.target.value),onBlur:b,disabled:O})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{className:"col-3",children:g("navigator.category")}),s.jsx("select",{className:"form-select form-select-sm",value:e.categoryId,onChange:F=>t("category",F.target.value),disabled:O,children:S&&S.map(F=>s.jsx("option",{value:F.id,children:g(F.name)},F.id))})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{className:"col-3",children:g("navigator.maxvisitors")}),s.jsx("select",{className:"form-select form-select-sm",value:e.userCount,disabled:O,onChange:F=>t("max_visitors",F.target.value),children:Fb&&Fb.map(F=>s.jsx("option",{value:F,children:F},F))})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{className:"col-3",children:g("navigator.path_finder_settings")}),s.jsxs(N,{gap:0,children:[s.jsxs("select",{className:"form-select form-select-sm",value:e.pathfinder,disabled:O,onChange:F=>t("path_finder",F.target.value),children:[s.jsx("option",{value:"0",children:g("navigator.roomsettings.path_finder.default")}),s.jsx("option",{value:"1",children:g("navigator.roomsettings.path_finder.old")})]}),s.jsxs(x,{style:{marginTop:"5px"},children:[e.pathfinder===0&&s.jsx("span",{className:"text-black",style:{opacity:.5,fontSize:"12px"},children:g("navigator.roomsettings.path_finder_desc.default")}),e.pathfinder===1&&s.jsx("span",{className:"text-black",style:{opacity:.5,fontSize:"12px"},children:g("navigator.roomsettings.path_finder_desc.old")})]})]})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{className:"col-3",children:g("navigator.tradesettings")}),s.jsxs("select",{className:"form-select form-select-sm",value:e.tradeState,disabled:O,onChange:F=>t("trade_state",F.target.value),children:[s.jsx("option",{value:"0",children:g("navigator.roomsettings.trade_not_allowed")}),s.jsx("option",{value:"1",children:g("navigator.roomsettings.trade_not_with_Controller")}),s.jsx("option",{value:"2",children:g("navigator.roomsettings.trade_allowed")})]})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{className:"col-3",children:g("navigator.tags")}),s.jsxs(N,{fullWidth:!0,gap:0,children:[s.jsx("input",{className:"form-control form-control-sm",value:c,disabled:O,onChange:F=>u(F.target.value),onBlur:()=>y(0)}),c.length>Hm&&s.jsx(T,{bold:!0,small:!0,variant:"danger",children:g("navigator.roomsettings.toomanycharacters")}),m===0&&E!=""&&s.jsx(T,{bold:!0,small:!0,variant:"danger",children:g(E)})]}),s.jsxs(N,{fullWidth:!0,gap:0,children:[s.jsx("input",{className:"form-control form-control-sm",value:d,disabled:O,onChange:F=>_(F.target.value),onBlur:()=>y(1)}),d.length>Hm&&s.jsx(T,{bold:!0,small:!0,variant:"danger",children:g("navigator.roomsettings.toomanycharacters")}),m===1&&E!=""&&s.jsx(T,{bold:!0,small:!0,variant:"danger",children:g(E)})]})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(q,{className:"col-3"}),s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.allowWalkthrough,disabled:O,onChange:F=>t("allow_walkthrough",F.target.checked)}),s.jsx(T,{children:g("navigator.roomsettings.allow_walk_through")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(q,{className:"col-3"}),s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.allowAudio,disabled:O,onChange:F=>t("allow_audio",F.target.checked)}),s.jsx(T,{children:g("navigator.roomsettings.allow_audio")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(q,{className:"col-3"}),s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.allowGif,disabled:O,onChange:F=>t("allow_gif",F.target.checked)}),s.jsx(T,{children:g("navigator.roomsettings.allow_gif")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(q,{className:"col-3"}),s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.everyoneOpenWireds,disabled:O,onChange:F=>t("everyone_open_wireds",F.target.checked)}),s.jsx(T,{children:g("navigator.roomsettings.everyone_open_wireds")})]}),s.jsxs(T,{variant:"danger",underline:!0,bold:!0,pointer:!0,className:"d-flex justify-content-center align-items-center gap-1",onClick:C,children:[s.jsx(pr,{className:"fa-icon"}),g("navigator.roomsettings.delete")]})]})},voe=a=>{const{roomData:e=null,handleChange:t=null}=a;return s.jsxs(Ye,{overflow:"auto",style:{minHeight:"210px"},children:[s.jsxs(N,{size:6,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.moderation.mute.header")}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsxs("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowMute,onChange:i=>t("moderation_mute",i.target.value),children:[s.jsx("option",{value:Zt.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),s.jsx("option",{value:Zt.MODERATION_LEVEL_USER_WITH_RIGHTS,children:g("navigator.roomsettings.moderation.rights")})]})})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.moderation.kick.header")}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsxs("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowKick,onChange:i=>t("moderation_kick",i.target.value),children:[s.jsx("option",{value:Zt.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),s.jsx("option",{value:Zt.MODERATION_LEVEL_USER_WITH_RIGHTS,children:g("navigator.roomsettings.moderation.rights")}),s.jsx("option",{value:Zt.MODERATION_LEVEL_ALL,children:g("navigator.roomsettings.moderation.all")})]})})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.moderation.ban.header")}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsxs("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowBan,onChange:i=>t("moderation_ban",i.target.value),children:[s.jsx("option",{value:Zt.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),s.jsx("option",{value:Zt.MODERATION_LEVEL_USER_WITH_RIGHTS,children:g("navigator.roomsettings.moderation.rights")})]})})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.moderation.mute.room.header")}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsxs("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowMuteRoom,onChange:i=>t("moderation_mute_room",i.target.value),children:[s.jsx("option",{value:Zt.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),s.jsx("option",{value:Zt.MODERATION_LEVEL_USER_WITH_RIGHTS,children:g("navigator.roomsettings.moderation.rights")})]})})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.moderation.give.rights.header")}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsxs("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowGiveRights,onChange:i=>t("moderation_give_rights",i.target.value),children:[s.jsx("option",{value:Zt.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),s.jsx("option",{value:Zt.MODERATION_LEVEL_USER_WITH_RIGHTS,children:g("navigator.roomsettings.moderation.rights")})]})})]})]}),s.jsxs(N,{size:6,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.moderation.delete.room.header")}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsxs("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowDeleteRoom,onChange:i=>t("moderation_delete_room",i.target.value),children:[s.jsx("option",{value:Zt.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),s.jsx("option",{value:Zt.MODERATION_LEVEL_USER_WITH_RIGHTS,children:g("navigator.roomsettings.moderation.rights")})]})})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.moderation.add.bot.header")}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsxs("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowAddBot,onChange:i=>t("moderation_add_bot",i.target.value),children:[s.jsx("option",{value:Zt.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),s.jsx("option",{value:Zt.MODERATION_LEVEL_USER_WITH_RIGHTS,children:g("navigator.roomsettings.moderation.rights")})]})})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.moderation.save.floor.plan.header")}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsxs("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowSaveFloorPlan,onChange:i=>t("moderation_save_floor_plan",i.target.value),children:[s.jsx("option",{value:Zt.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),s.jsx("option",{value:Zt.MODERATION_LEVEL_USER_WITH_RIGHTS,children:g("navigator.roomsettings.moderation.rights")})]})})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.moderation.change.look.header")}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsxs("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowChangeLook,onChange:i=>t("allow_change_look",i.target.value),children:[s.jsx("option",{value:Zt.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),s.jsx("option",{value:Zt.MODERATION_LEVEL_USER_WITH_RIGHTS,children:g("navigator.roomsettings.moderation.rights")}),s.jsx("option",{value:Zt.MODERATION_LEVEL_ALL,children:g("navigator.roomsettings.moderation.all")})]})})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.moderation.allow.commands")}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsxs("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowCommands?Zt.MODERATION_LEVEL_ALL:Zt.MODERATION_LEVEL_NONE,onChange:i=>t("allow_commands",i.target.value),children:[s.jsx("option",{value:Zt.MODERATION_LEVEL_NONE,children:g("navigator.roomsettings.moderation.none")}),s.jsx("option",{value:Zt.MODERATION_LEVEL_ALL,children:g("navigator.roomsettings.moderation.all")})]})})]})]})]})},yoe=a=>{const{roomData:e=null}=a,[t,i]=h.useState(new Map),[r,n]=h.useState(new Map);let[o,l]=h.useState(0),[c,u]=h.useState(0);const[d,_]=h.useState("");J(gL,E=>{const I=E.getParser();!e||e.roomId!==I.roomId||(i(I.users),l(I.totalUsers))}),J(pL,E=>{const I=E.getParser();!e||e.roomId!==I.roomId||(n(I.users),u(I.totalUsers))}),J(dL,E=>{const I=E.getParser();!e||e.roomId!==I.roomId||(i(p=>{const S=new Map(p);return S.set(I.data.userId,I.data.userName),S}),n(p=>{const S=new Map(p);return S.delete(I.data.userId),S}),l(p=>p+1),u(p=>p-1))}),J(_L,E=>{const I=E.getParser();!e||e.roomId!==I.roomId||(i(p=>{const S=new Map(p);return S.delete(I.userId),S}),n(p=>{const S=new Map(p);return S.set(I.userId,I.userName),S}),l(p=>p-1),u(p=>p+1))}),h.useEffect(()=>{K(new q1(e.roomId))},[e.roomId]);const m=Array.from(t.entries()).filter(([E,I])=>d.length?I.toLowerCase().includes(d.toLowerCase()):!0),f=Array.from(r.entries()).filter(([E,I])=>d.length?I.toLowerCase().includes(d.toLowerCase()):!0);return s.jsxs(N,{children:[s.jsxs(x,{gap:2,justifyContent:"center",alignItems:"center",children:[s.jsx(T,{bold:!0,children:g("navigator.flatctrls.filter")}),s.jsx("input",{className:"form-control form-control-sm",type:"text",placeholder:g("navigator.flatctrls.filterplaceholder"),onInput:E=>_(E.currentTarget.value)})]}),s.jsxs(x,{gap:1,children:[s.jsxs(N,{size:6,children:[s.jsx(T,{bold:!0,children:g("navigator.flatctrls.userswithrights",["displayed","total"],[m.length.toString(),o.toString()])}),s.jsx(x,{overflow:"hidden",className:"bg-white rounded p-2",style:{height:"200px"},children:s.jsx(N,{fullWidth:!0,overflow:"auto",gap:1,children:m.map(([E,I],p)=>s.jsxs(x,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[s.jsx(Xn,{userName:I,userId:E}),s.jsxs(T,{pointer:!0,grow:!0,onClick:S=>K(new nN(E)),children:[" ",I]})]},p))})}),s.jsx(X,{variant:"danger",disabled:!t.size,onClick:E=>K(new k1(e.roomId)),children:g("navigator.flatctrls.clear")})]}),s.jsxs(N,{size:6,children:[s.jsx(T,{bold:!0,children:g("navigator.flatctrls.userswithoutrights",["displayed","total"],[f.length.toString(),c.toString()])}),s.jsx(x,{overflow:"hidden",className:"bg-white rounded p-2",style:{height:"200px"},children:s.jsx(N,{fullWidth:!0,overflow:"auto",gap:1,children:f.map(([E,I],p)=>s.jsxs(x,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[s.jsx(Xn,{userName:I,userId:E}),s.jsxs(T,{pointer:!0,grow:!0,onClick:S=>K(new rN(E)),children:[" ",I]})]},p))})})]})]})]})},Doe=a=>{const{roomData:e=null,handleChange:t=null}=a,[i,r]=h.useState(0);return h.useEffect(()=>{r(e.chatSettings.distance)},[e.chatSettings]),s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.vip.caption")}),s.jsx(T,{children:g("navigator.roomsettings.vip.info")})]}),s.jsxs(Ye,{overflow:"auto",children:[s.jsxs(N,{size:6,gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.chat_settings")}),s.jsx(T,{children:g("navigator.roomsettings.chat_settings.info")}),s.jsxs("select",{className:"form-select form-select-sm",value:e.chatSettings.mode,onChange:n=>t("bubble_mode",n.target.value),children:[s.jsx("option",{value:Ds.CHAT_MODE_FREE_FLOW,children:g("navigator.roomsettings.chat.mode.free.flow")}),s.jsx("option",{value:Ds.CHAT_MODE_LINE_BY_LINE,children:g("navigator.roomsettings.chat.mode.line.by.line")})]}),s.jsxs("select",{className:"form-select form-select-sm",value:e.chatSettings.weight,onChange:n=>t("chat_weight",n.target.value),children:[s.jsx("option",{value:Ds.CHAT_BUBBLE_WIDTH_NORMAL,children:g("navigator.roomsettings.chat.bubbles.width.normal")}),s.jsx("option",{value:Ds.CHAT_BUBBLE_WIDTH_THIN,children:g("navigator.roomsettings.chat.bubbles.width.thin")}),s.jsx("option",{value:Ds.CHAT_BUBBLE_WIDTH_WIDE,children:g("navigator.roomsettings.chat.bubbles.width.wide")})]}),s.jsxs("select",{className:"form-select form-select-sm",value:e.chatSettings.speed,onChange:n=>t("bubble_speed",n.target.value),children:[s.jsx("option",{value:Ds.CHAT_SCROLL_SPEED_FAST,children:g("navigator.roomsettings.chat.speed.fast")}),s.jsx("option",{value:Ds.CHAT_SCROLL_SPEED_NORMAL,children:g("navigator.roomsettings.chat.speed.normal")}),s.jsx("option",{value:Ds.CHAT_SCROLL_SPEED_SLOW,children:g("navigator.roomsettings.chat.speed.slow")})]}),s.jsxs("select",{className:"form-select form-select-sm",value:e.chatSettings.protection,onChange:n=>t("flood_protection",n.target.value),children:[s.jsx("option",{value:Ds.FLOOD_FILTER_LOOSE,children:g("navigator.roomsettings.chat.flood.loose")}),s.jsx("option",{value:Ds.FLOOD_FILTER_NORMAL,children:g("navigator.roomsettings.chat.flood.normal")}),s.jsx("option",{value:Ds.FLOOD_FILTER_STRICT,children:g("navigator.roomsettings.chat.flood.strict")})]}),s.jsx(T,{children:g("navigator.roomsettings.chat_settings.hearing.distance")}),s.jsx("input",{type:"number",min:"0",className:"form-control form-control-sm",value:i,onChange:n=>r(n.target.valueAsNumber),onBlur:n=>t("chat_distance",i)})]}),s.jsxs(N,{size:6,gap:1,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.vip_settings")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.hideWalls,onChange:n=>t("hide_walls",n.target.checked)}),s.jsx(T,{children:g("navigator.roomsettings.hide_walls")})]}),s.jsxs("select",{className:"form-select form-select-sm",value:e.wallThickness,onChange:n=>t("wall_thickness",n.target.value),children:[s.jsx("option",{value:"0",children:g("navigator.roomsettings.wall_thickness.normal")}),s.jsx("option",{value:"1",children:g("navigator.roomsettings.wall_thickness.thick")}),s.jsx("option",{value:"-1",children:g("navigator.roomsettings.wall_thickness.thin")}),s.jsx("option",{value:"-2",children:g("navigator.roomsettings.wall_thickness.thinnest")})]}),s.jsxs("select",{className:"form-select form-select-sm",value:e.floorThickness,onChange:n=>t("floor_thickness",n.target.value),children:[s.jsx("option",{value:"0",children:g("navigator.roomsettings.floor_thickness.normal")}),s.jsx("option",{value:"1",children:g("navigator.roomsettings.floor_thickness.thick")}),s.jsx("option",{value:"-1",children:g("navigator.roomsettings.floor_thickness.thin")}),s.jsx("option",{value:"-2",children:g("navigator.roomsettings.floor_thickness.thinnest")})]})]})]})]})},aS=[{name:"Nenhum",value:0},{name:"Preto e Branco",value:1},{name:"Sépia",value:2},{name:"Browni",value:3},{name:"Vintage",value:4},{name:"Kodachrome",value:5},{name:"LSD",value:6},{name:"Polaroid",value:7},{name:"Technicolor",value:8}],Moe=a=>{const{roomData:e=null,handleChange:t=null}=a,[i,r]=h.useState(0);h.useEffect(()=>{r(e.filter)},[e]);const n=o=>{t("filter",o)};return s.jsx(s.Fragment,{children:s.jsx(Ye,{columnCount:3,overflow:"auto",children:aS&&aS.length>0&&aS.map((o,l)=>{const c=i===o.value;return s.jsx(ct,{itemActive:c,onClick:u=>n(o.value),children:s.jsx("div",{className:"p-2 text-black",children:o.name})},l)})})})},joe=a=>{const{roomData:e=null}=a,[t,i]=h.useState(-1),[r,n]=h.useState([]),[o,l]=h.useState(""),[c,u]=h.useState("RWUAM_BAN_USER_HOUR"),d=m=>{K(new Y1(m,e.roomId)),n(f=>f.filter(E=>E.userId!==m)),i(-1),K(new d_(e.roomId))},_=()=>{o.trim()&&(K(new z1(o,e.roomId,c)),l(""),K(new d_(e.roomId)))};return J(hL,m=>{const f=m.getParser();!e||e.roomId!==f.roomId||n(f.bannedUsers)}),h.useEffect(()=>{K(new d_(e.roomId))},[e.roomId]),s.jsx(N,{gap:4,children:s.jsxs(x,{gap:3,fullWidth:!0,children:[s.jsxs(N,{gap:1,fullWidth:!0,children:[s.jsx(T,{bold:!0,children:g("navigator.roomsettings.moderation.ban.user")}),s.jsx(T,{variant:"muted",children:g("navigator.roomsettings.moderation.ban.user.info")}),s.jsxs(N,{overflow:"hidden",className:"bg-white rounded p-2",gap:2,style:{maxHeight:"200px",minHeight:"150px"},children:[s.jsxs(x,{center:!0,gap:2,children:[s.jsx(T,{small:!0,children:g("navigator.roomsettings.moderation.ban.user.name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:o,onChange:m=>l(m.target.value),onKeyDown:m=>{m.key==="Enter"&&_()}})]}),s.jsxs(x,{center:!0,gap:2,children:[s.jsx(T,{small:!0,children:g("navigator.roomsettings.moderation.ban.user.duration")}),s.jsxs("select",{className:"form-select form-select-sm",value:c,onChange:m=>u(m.target.value),children:[s.jsx("option",{value:"RWUAM_BAN_USER_HOUR",children:"1 hora"}),s.jsx("option",{value:"RWUAM_BAN_USER_DAY",children:"1 dia"}),s.jsx("option",{value:"RWUAM_BAN_USER_FOREVER",children:"Permanente"})]})]})]}),s.jsx(X,{variant:"danger",onClick:_,disabled:!o.trim(),children:g("navigator.roomsettings.moderation.ban.user.button")})]}),s.jsxs(N,{gap:1,fullWidth:!0,children:[s.jsxs(T,{bold:!0,children:[g("navigator.roomsettings.moderation.banned.users"),s.jsxs(T,{children:[" (",r.length,")"]})]}),s.jsx(T,{variant:"muted",children:g("navigator.roomsettings.moderation.banned.users.info")}),s.jsx(x,{overflow:"hidden",className:"bg-white rounded p-2",style:{maxHeight:"200px",minHeight:"150px"},children:s.jsx(N,{fullWidth:!0,overflow:"auto",gap:2,children:r.map((m,f)=>s.jsxs(x,{alignItems:"center",gap:2,className:`p-2 rounded ${t===m.userId?"bg-light":""}`,onClick:()=>i(E=>E===m.userId?-1:m.userId),style:{cursor:"pointer"},children:[s.jsx(Xn,{userName:m.userName,userId:m.userId}),s.jsx(N,{grow:!0,children:s.jsx(T,{bold:!0,children:m.userName})})]},f))})}),s.jsx(X,{variant:"danger",size:"sm",disabled:t===-1,onClick:m=>{d(t)},children:g("navigator.roomsettings.moderation.banned.users.unban")})]})]})})},eo=["navigator.roomsettings.tab.1","navigator.roomsettings.tab.2","navigator.roomsettings.tab.3","navigator.roomsettings.tab.4","navigator.roomsettings.tab.6","navigator.roomsettings.tab.5","navigator.roomsettings.tab.7"],Loe=a=>{const[e,t]=h.useState(null),[i,r]=h.useState(eo[0]),{navigatorData:n=null}=Ir();J(mL,u=>{const d=u.getParser();if(!d)return;const _=d.data;t({roomId:_.roomId,roomName:_.name,roomDescription:_.description,categoryId:_.categoryId,userCount:_.maximumVisitors,tags:_.tags,tradeState:_.tradeMode,allowWalkthrough:_.allowWalkThrough,allowAudio:_.allowAudio,allowGif:_.allowGif,lockState:_.doorMode,password:null,allowPets:_.allowPets,allowPetsEat:_.allowFoodConsume,hideWalls:_.hideWalls,wallThickness:_.wallThickness,floorThickness:_.floorThickness,chatSettings:{mode:_.chatSettings.mode,weight:_.chatSettings.weight,speed:_.chatSettings.speed,distance:_.chatSettings.distance,protection:_.chatSettings.protection},moderationSettings:{allowMute:_.roomModerationSettings.allowMute,allowKick:_.roomModerationSettings.allowKick,allowBan:_.roomModerationSettings.allowBan,allowDeleteRoom:_.roomModerationSettings.allowDeleteRoom,allowAddBot:_.roomModerationSettings.allowAddBot,allowSaveFloorPlan:_.roomModerationSettings.allowSaveFloorPlan,allowMuteRoom:_.roomModerationSettings.allowMuteRoom,allowGiveRights:_.roomModerationSettings.allowGiveRights,allowChangeLook:_.roomModerationSettings.allowChangeLook,allowCommands:_.roomModerationSettings.allowCommands},everyoneOpenWireds:_.everyoneOpenWireds,filter:_.filter,pathfinder:_.pathfinder}),K(new d_(_.roomId))});const o=()=>{t(null),r(eo[0])},l=u=>{te().userId!==n.enteredGuestRoom.ownerId&&!te().isModerator||r(u)},c=(u,d)=>{te().userId!==n.enteredGuestRoom.ownerId&&!te().isModerator||t(_=>{const m={..._};switch(u){case"allow_change_look":m.moderationSettings.allowChangeLook=Number(d);break;case"allow_commands":m.moderationSettings.allowCommands=Number(d)===Zt.MODERATION_LEVEL_ALL;break;case"name":m.roomName=String(d);break;case"description":m.roomDescription=String(d);break;case"category":m.categoryId=Number(d);break;case"max_visitors":m.userCount=Number(d);break;case"trade_state":m.tradeState=Number(d);break;case"tags":m.tags=d;break;case"allow_walkthrough":m.allowWalkthrough=!!d;break;case"allow_audio":m.allowAudio=!!d;break;case"allow_gif":m.allowGif=!!d;break;case"allow_pets":m.allowPets=!!d;break;case"allow_pets_eat":m.allowPetsEat=!!d;break;case"hide_walls":m.hideWalls=!!d;break;case"wall_thickness":m.wallThickness=Number(d);break;case"floor_thickness":m.floorThickness=Number(d);break;case"lock_state":m.lockState=Number(d);break;case"password":m.lockState=is.PASSWORD_STATE,m.password=String(d);break;case"moderation_mute":m.moderationSettings.allowMute=Number(d);break;case"moderation_kick":m.moderationSettings.allowKick=Number(d);break;case"moderation_ban":m.moderationSettings.allowBan=Number(d);break;case"moderation_delete_room":m.moderationSettings.allowDeleteRoom=Number(d);break;case"moderation_add_bot":m.moderationSettings.allowAddBot=Number(d);break;case"moderation_save_floor_plan":m.moderationSettings.allowSaveFloorPlan=Number(d);break;case"moderation_mute_room":m.moderationSettings.allowMuteRoom=Number(d);break;case"moderation_give_rights":m.moderationSettings.allowGiveRights=Number(d);break;case"bubble_mode":m.chatSettings.mode=Number(d);break;case"chat_weight":m.chatSettings.weight=Number(d);break;case"bubble_speed":m.chatSettings.speed=Number(d);break;case"flood_protection":m.chatSettings.protection=Number(d);break;case"chat_distance":m.chatSettings.distance=Number(d);break;case"everyone_open_wireds":m.everyoneOpenWireds=!!d;break;case"filter":m.filter=Number(d);break;case"path_finder":m.pathfinder=Number(d);break}return K(new X1(m.roomId,m.roomName,m.roomDescription,m.lockState,m.password,m.userCount,m.categoryId,m.tags.length,m.tags,m.tradeState,m.allowPets,m.allowPetsEat,m.allowWalkthrough,m.hideWalls,m.wallThickness,m.floorThickness,m.moderationSettings.allowMute,m.moderationSettings.allowKick,m.moderationSettings.allowBan,m.chatSettings.mode,m.chatSettings.weight,m.chatSettings.speed,m.chatSettings.distance,m.chatSettings.protection,m.allowAudio,m.allowGif,m.everyoneOpenWireds,m.moderationSettings.allowDeleteRoom,m.moderationSettings.allowAddBot,m.moderationSettings.allowSaveFloorPlan,m.moderationSettings.allowMuteRoom,m.moderationSettings.allowGiveRights,m.filter,m.pathfinder,m.moderationSettings.allowChangeLook,m.moderationSettings.allowCommands)),m})};return e?s.jsxs(ve,{uniqueKey:"nitro-room-settings",className:"nitro-room-settings",children:[s.jsx(je,{headerText:g("navigator.roomsettings"),onCloseClick:o}),s.jsx($n,{children:eo.map(u=>s.jsx(In,{isActive:i===u,onClick:d=>l(u),children:g(u)},u))}),s.jsxs(be,{children:[i===eo[0]&&s.jsx(boe,{roomData:e,handleChange:c,onClose:o}),i===eo[1]&&s.jsx(Aoe,{roomData:e,handleChange:c}),i===eo[2]&&s.jsx(yoe,{roomData:e,handleChange:c}),i===eo[3]&&s.jsx(Doe,{roomData:e,handleChange:c}),i===eo[4]&&s.jsx(Moe,{roomData:e,handleChange:c}),i===eo[5]&&s.jsx(voe,{roomData:e,handleChange:c}),i===eo[6]&&s.jsx(joe,{roomData:e,handleChange:c})]})]}):null},vv=a=>{var d;const{roomData:e=null}=a,[t,i]=h.useState(!1),r=h.useRef(),{navigatorData:n=null}=Ir(),{report:o=null}=Rn(),l=(_,m)=>{if(!(!n||!e))switch(_){case"set_home_room":let f=-1;n.homeRoomId!==e.roomId&&(f=e.roomId),K(new iN(f));return;case"toggle_favourite_room":if(n.favouriteRooms.includes(e.roomId)){const E=n.favouriteRooms.indexOf(e.roomId);E>-1&&n.favouriteRooms.splice(E,1),K(new eN(e.roomId))}else n.favouriteRooms.push(e.roomId),K(new ZC(e.roomId));return;case"open_group_info":Qd(e.habboGroupId);return;case"toggle_room_link":Ce(`navigator/toggle-room-link/${e.roomId}`);return;case"report_room":o(xs.ROOM,{roomId:e.roomId,roomName:e.roomName});return;case"open_room_settings":K(new mT(e.roomId));return}},c=((d=te())==null?void 0:d.userName)===(e==null?void 0:e.ownerName),u=()=>{if(e.tradeMode===0)return"Não permitido";if(e.tradeMode===1)return"Com direitos";if(e.tradeMode===2)return"Permitido"};return s.jsxs(s.Fragment,{children:[s.jsx(q,{pointer:!0,innerRef:r,className:"icon icon-navigator-info",onMouseOver:_=>i(!0),onMouseLeave:_=>i(!1)}),s.jsx(Kd,{show:t,target:r.current,placement:"right",children:s.jsx(Oc,{onClick:_=>_.stopPropagation(),onMouseEnter:_=>i(!0),onMouseLeave:_=>i(!1),style:{minWidth:"360px",minHeight:"230px"},children:s.jsxs(be,{overflow:"hidden",className:"room-info bg-transparent",style:{minWidth:"360px",minHeight:"230px"},children:[s.jsxs(x,{gap:2,overflow:"hidden",className:"room-info-bg p-2",children:[s.jsx(N,{gap:1,children:s.jsxs(NT,{roomId:e.roomId,customUrl:e.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[e.habboGroupId>0&&s.jsx(as,{badgeCode:e.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1"}),e.doorMode!==is.OPEN_STATE&&s.jsx("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(e.doorMode===is.DOORBELL_STATE?"locked":e.doorMode===is.PASSWORD_STATE?"password":e.doorMode===is.INVISIBLE_STATE?"invisible":"")})]})}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{gap:1,children:[s.jsx(T,{bold:!0,truncate:!0,className:"flex-grow-1",style:{maxHeight:"20px",maxWidth:"190px",minWidth:"190px"},children:e.roomName}),s.jsx("i",{title:g("navigator.embed.caption"),onClick:()=>l("toggle_room_link"),className:"cursor-pointer icon icon-room-link"})]}),s.jsx(T,{className:"flex-grow-1",children:e.description})]})]}),s.jsxs(N,{gap:0,children:[s.jsxs(x,{justifyContent:"between",children:[e.showOwner&&s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(Xn,{userId:e.ownerId}),s.jsx(T,{bold:!0,underline:!0,className:"cursor-pointer",onClick:_=>ir(e.ownerId),children:e.ownerName})]}),s.jsx(x,{gap:1,justifyContent:"end",alignItems:"center",onClick:()=>l("open_group_info"),children:e.habboGroupId>0&&s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"icon icon-navigator-room-group"}),s.jsx(T,{bold:!0,underline:!0,className:"cursor-pointer",children:e.groupName})]})})]}),s.jsxs(q,{className:"mt-2 row align-items-center",fullWidth:!0,children:[s.jsx(q,{className:"col",children:s.jsx(T,{bold:!0,children:"Trocas"})}),s.jsx(q,{className:"col",children:s.jsx(T,{center:!0,children:u()})}),s.jsxs(q,{className:"col",children:[s.jsx("i",{onClick:()=>l("toggle_favourite_room"),className:`cursor-pointer icon icon-room-info-favorite${n.favouriteRooms.includes(e.roomId)?"-active":""}`}),s.jsx(T,{style:{marginLeft:"5px"},center:!0,children:"Favorito"})]})]}),s.jsxs(q,{className:"mt-2 row align-items-center",fullWidth:!0,children:[s.jsx(q,{className:"col",children:s.jsx(T,{bold:!0,children:"Máx. usuários"})}),s.jsx(q,{className:"col",children:s.jsx(T,{center:!0,children:e.maxUserCount})}),s.jsxs(q,{className:"col",children:[s.jsx("i",{onClick:()=>l("set_home_room"),className:`cursor-pointer icon icon-room-info-home${n.homeRoomId===e.roomId?"-active":""}`}),s.jsx(T,{style:{marginLeft:"5px"},center:!0,children:"Meu cafofo"})]})]}),s.jsxs(q,{className:"mt-2 row align-items-center",fullWidth:!0,children:[s.jsx(q,{className:"col",children:s.jsx(T,{bold:!0,children:"Nota"})}),s.jsx(q,{className:"col",children:s.jsx(T,{center:!0,children:e.score})}),!c&&s.jsxs(q,{className:"col",children:[s.jsx("i",{onClick:()=>l("report_room"),className:"cursor-pointer icon icon-room-info-report"}),s.jsx(T,{style:{marginLeft:"5px"},center:!0,children:"Reportar quarto"})]}),c&&s.jsxs(q,{className:"col",children:[s.jsx("i",{onClick:()=>l("open_room_settings"),className:"cursor-pointer icon icon-room-info-settings"}),s.jsx(T,{style:{marginLeft:"5px"},center:!0,children:"Configurações"})]})]}),e.tags.length>0&&s.jsx(x,{gap:2,alignItems:"start",style:{marginTop:"5px"},children:e.tags.map(_=>s.jsxs(T,{variant:"white",className:"bg-warning p-1",children:["#",_]},_))}),e.roomAdName&&e.roomAdName.length>0&&s.jsx(q,{className:"rounded p-2 text-white",style:{marginTop:"8px",backgroundColor:"#edba44"},children:s.jsxs(q,{className:"row",children:[s.jsx(x,{alignItems:"center",justifyContent:"center",className:"col-sm-2",children:s.jsx("i",{className:"icon bg-white room-info-promotion"})}),s.jsxs(N,{className:"col",gap:1,children:[s.jsxs(q,{children:[s.jsx(T,{bold:!0,variant:"white",children:"Nome do Evento: "}),s.jsx(T,{bold:!0,variant:"white",children:e.roomAdName})]}),s.jsxs(x,{children:[s.jsx(T,{variant:"white",children:"Descrição do Evento: "}),s.jsx(T,{variant:"white",children:e.roomAdDescription})]}),s.jsxs(q,{children:[s.jsx(T,{variant:"white",children:"Validade: "}),s.jsx(T,{variant:"white",children:e.roomAdExpiresInMin>0?e.roomAdExpiresInMin+" minuto(s)":"Indefinido"})]})]})]})})]})]})})})]})},yv=a=>{const{roomData:e=null,children:t=null,thumbnail:i=!1,draggable:r=!1,handleDragStart:n=null,handleDragOver:o=null,handleDrop:l=null,...c}=a,{setDoorData:u=null}=Ir(),[d,_]=h.useState(!1),{roomSession:m}=vt(),f=()=>{const I=100*(e.userCount/e.maxUserCount);let p="bg-primary";return I>=92?p="bg-danger":I>=50?p="bg-warning":I>0&&(p="bg-success"),p},E=I=>{if(d)return;let p=!1;if(e.ownerId!==te().userId&&e.doorMode!==is.OPEN_STATE){if(e.habboGroupId!==0){qn(e.roomId);return}switch(e.doorMode){case is.DOORBELL_STATE:u(S=>{const R={...S};return R.roomInfo=e,R.state=Wt.START_DOORBELL,R});return;case is.PASSWORD_STATE:u(S=>{const R={...S};return R.roomInfo=e,R.state=Wt.START_PASSWORD,R});return}}else p=m!=null,K(new gT(e.roomId)),Ce("navigator/hide"),m&&jl().events.dispatchEvent(new Ve(Ve.RESTARTED,null,!1));p||_c(e.roomId,null,0)};return i?s.jsxs(N,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:E,gap:0,className:"navigator-item p-1 bg-light rounded-3 small mb-1 flex-column border border-muted",...c,children:[s.jsxs(NT,{roomId:e.roomId,customUrl:e.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[e.habboGroupId>0&&s.jsx(as,{badgeCode:e.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1"}),s.jsxs(x,{center:!0,className:"badge p-1 position-absolute m-1 "+f(),gap:1,children:[s.jsx(HA,{className:"fa-icon"}),e.userCount]}),e.doorMode!==is.OPEN_STATE&&s.jsx("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(e.doorMode===is.DOORBELL_STATE?"locked":e.doorMode===is.PASSWORD_STATE?"password":e.doorMode===is.INVISIBLE_STATE?"invisible":"")})]}),s.jsxs(x,{className:"w-100",children:[s.jsx(T,{truncate:!0,className:"flex-grow-1",children:e.roomName}),s.jsx(x,{reverse:!0,alignItems:"center",gap:1,children:s.jsx(vv,{roomData:e})}),t]})]}):s.jsxs(x,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:E,gap:2,className:"navigator-item px-2 py-1 small",draggable:r,onDragStart:I=>{_(!0),n(e.roomId)},onDragOver:I=>o(I,e.roomId),onDrop:I=>{_(!1),l(I)},...c,children:[s.jsxs(x,{center:!0,className:"badge p-1 "+f(),gap:1,children:[s.jsx(HA,{className:"fa-icon"}),e.userCount]}),s.jsx(T,{truncate:!0,grow:!0,children:e.roomName}),s.jsxs(x,{reverse:!0,alignItems:"center",gap:1,children:[r&&s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 512 512",className:"fa-icon text-secondary",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M352.201 425.775l-79.196 79.196c-9.373 9.373-24.568 9.373-33.941 0l-79.196-79.196c-15.119-15.119-4.411-40.971 16.971-40.97h51.162L228 284H127.196v51.162c0 21.382-25.851 32.09-40.971 16.971L7.029 272.937c-9.373-9.373-9.373-24.569 0-33.941L86.225 159.8c15.119-15.119 40.971-4.411 40.971 16.971V228H228V127.196h-51.23c-21.382 0-32.09-25.851-16.971-40.971l79.196-79.196c9.373-9.373 24.568-9.373 33.941 0l79.196 79.196c15.119 15.119 4.411 40.971-16.971 40.971h-51.162V228h100.804v-51.162c0-21.382 25.851-32.09 40.97-16.971l79.196 79.196c9.373 9.373 9.373 24.569 0 33.941L425.773 352.2c-15.119 15.119-40.971 4.411-40.97-16.971V284H284v100.804h51.23c21.382 0 32.09 25.851 16.971 40.971z"})}),s.jsx(vv,{roomData:e}),e.habboGroupId>0&&s.jsx("i",{className:"icon icon-navigator-room-group"}),e.hubDj&&s.jsx("i",{className:"icon icon-chat-youtube"}),e.doorMode!==is.OPEN_STATE&&s.jsx("i",{className:"icon icon-navigator-room-"+(e.doorMode===is.DOORBELL_STATE?"locked":e.doorMode===is.PASSWORD_STATE?"password":e.doorMode===is.INVISIBLE_STATE?"invisible":"")})]}),t]})},Poe=a=>{const{searchResult:e=null,...t}=a,[i,r]=h.useState(!0),[n,o]=h.useState(0),[l,c]=h.useState(null),[u,d]=h.useState([]),{topLevelContext:_=null}=Ir(),m=()=>{let O=e.code;return!O||!O.length||g("navigator.searchcode.title."+O)=="navigator.searchcode.title."+O?e.data:O.startsWith("${")?O.slice(2,O.length-1):"navigator.searchcode.title."+O},f=()=>{o(O=>O===Fl.LIST?Fl.THUMBNAILS:Fl.LIST)},E=()=>{e.action==1?K(new Ku(e.code,"")):e.action==2&&_&&K(new Ku(_.code,""))};h.useEffect(()=>{if(e){if(r(!e.closed),o(e.mode),e.code==="my"||e.code==="query"){let O=[...e.rooms];if(O.sort((C,A)=>C.position>=0&&C.position-A.position),e.code==="query"){const C=O.filter(A=>A.userCount>0);O=O.filter(A=>A.userCount===0),O=[...C,...O]}d(O);return}d(e.rooms)}},[e]);const I=n>=Fl.THUMBNAILS,p=O=>{c(O)},S=(O,C)=>{if(O.preventDefault(),l!==null&&l!==C){const A=[...u],b=A.findIndex(U=>U.roomId===l),y=A.findIndex(U=>U.roomId===C);if(b===-1||y===-1)return;const M=A[b];if(b>y)for(let U=b;U>y;U--)A[U]=A[U-1],A[U].position=U;else for(let U=b;U<y;U++)A[U]=A[U+1],A[U].position=U;A[y]=M,A[y].position=y,d(A)}},R=O=>{O.preventDefault(),!(!l||u.length<=1||!u.some(C=>C.roomId===l))&&(K(new R1(l,u.find(C=>C.roomId===l).position)),c(null))};return s.jsxs(N,{className:"bg-white rounded border border-muted",gap:0,children:[s.jsxs(x,{fullWidth:!0,alignItems:"center",justifyContent:"between",className:"px-2 py-1",children:[s.jsxs(x,{grow:!0,pointer:!0,alignItems:"center",gap:1,onClick:O=>r(C=>!C),children:[i&&s.jsx(TV,{className:"text-secondary fa-icon"}),!i&&s.jsx(zd,{className:"text-secondary fa-icon"}),s.jsx(T,{children:g(m())})]}),s.jsxs(x,{gap:2,children:[n===Fl.LIST&&s.jsx(SV,{className:"text-secondary fa-icon",onClick:f}),n>=Fl.THUMBNAILS&&s.jsx(RV,{className:"text-secondary fa-icon",onClick:f}),e.action>0&&e.action===1&&s.jsx(xV,{className:"text-secondary fa-icon",onClick:E}),e.action>0&&e.action!==1&&s.jsx(OV,{className:"text-secondary fa-icon",onClick:E})]})]})," ",i&&s.jsx(s.Fragment,{children:I?s.jsx(Os,{columnCount:3,...t,columnMinWidth:110,columnMinHeight:130,className:"mx-2",children:u.length>0&&u.map((O,C)=>s.jsx(yv,{roomData:O,thumbnail:!0},C))}):s.jsx(Ye,{columnCount:1,className:"navigator-grid",gap:0,children:u.length>0&&u.map((O,C)=>s.jsx(yv,{roomData:O,draggable:e.code==="my",handleDragStart:p,handleDragOver:S,handleDrop:R},C))})})]})},Uoe=a=>{const{sendSearch:e=null}=a,[t,i]=h.useState(0),[r,n]=h.useState(""),{topLevelContext:o=null,searchResult:l=null}=Ir(),c=()=>{if(!o)return;let d=dh[t];d||(d=dh[0]);const _=(d.query?d.query+":":"")+r;e(_||"",o.code)},u=d=>{d.key==="Enter"&&c()};return h.useEffect(()=>{if(!l)return;const d=l.data.split(":");let _=null,m="";if(d.length>=2){const[f,...E]=d;_=dh.find(I=>I.query===f),m=E.join(":")}else m=l.data;_||(_=dh[0]),i(dh.findIndex(f=>f===_)),n(m)},[l]),s.jsxs(x,{fullWidth:!0,gap:1,children:[s.jsx(x,{shrink:!0,children:s.jsx("select",{className:"form-select form-select-sm",value:t,onChange:d=>i(parseInt(d.target.value)),children:dh.map((d,_)=>s.jsx("option",{value:_,children:g("navigator.filter."+d.name)},_))})}),s.jsxs(x,{fullWidth:!0,gap:1,children:[s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("navigator.filter.input.placeholder"),value:r,onChange:d=>n(d.target.value),onKeyDown:d=>u(d)}),s.jsx(X,{variant:"primary",onClick:c,children:s.jsx(tT,{className:"fa-icon"})})]})]})},woe=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(!1),[n,o]=h.useState(!1),[l,c]=h.useState(!1),[u,d]=h.useState(!1),[_,m]=h.useState(-1),[f,E]=h.useState(!1),[I,p]=h.useState(!0),[S,R]=h.useState(!1),{searchResult:O=null,topLevelContext:C=null,topLevelContexts:A=null,navigatorData:b=null}=Ir(),y=h.useRef(null),M=h.useRef();ms(Ve.CREATED,F=>{t(!1),o(!1)});const U=h.useCallback((F,H)=>{o(!1),K(new Ku(H,F)),E(!0)},[]),G=h.useCallback(()=>{if(!i){R(!0);return}if(y.current){U(y.current.value,y.current.code),y.current=null;return}if(O){U(O.data,O.code);return}C&&U("",C.code)},[i,O,C,U]);return h.useEffect(()=>{const F={linkReceived:H=>{const v=H.split("/");if(!(v.length<2))switch(v[1]){case"show":{t(!0),R(!0);return}case"hide":t(!1);return;case"toggle":{if(e){t(!1);return}t(!0),R(!0);return}case"toggle-room-info":c(B=>!B);return;case"toggle-room-link":d(B=>!B),v.length===3?m(parseInt(v[2])):m(-1);return;case"goto":if(v.length<=2)return;switch(v[2]){case"home":if(b.homeRoomId<=0)return;qn(b.homeRoomId);break;default:{const B=parseInt(v[2]);qn(B)}}return;case"create":t(!0),o(!0);return;case"search":if(v.length>2){const B=v[2];let z="";v.length>3&&(z=v[3]),y.current={value:z,code:B},t(!0),R(!0)}return}},eventUrlPrefix:"navigator/"};return fs(F),()=>ps(F)},[e,b]),h.useEffect(()=>{O&&(E(!1),M&&M.current&&(M.current.scrollTop=0))},[O]),h.useEffect(()=>{!e||!i||!S||(G(),R(!1))},[e,i,S,G]),h.useEffect(()=>{i||!C||r(!0)},[i,C]),h.useEffect(()=>{!e||!I||(K(new E1),p(!1))},[e,I]),h.useEffect(()=>{Me.addCallback(Xa.OPENROOM,(F,H=!1,v=null)=>K(new _1(new aC(F))))},[]),s.jsxs(s.Fragment,{children:[e&&s.jsxs(ve,{uniqueKey:"navigator",className:"nitro-navigator",children:[s.jsx(je,{headerText:g(n?"navigator.createroom.title":"navigator.title"),onCloseClick:F=>t(!1)}),s.jsxs($n,{children:[A&&A.length>0&&A.map((F,H)=>s.jsx(In,{isActive:C===F&&!n,onClick:v=>U("",F.code),children:g("navigator.toplevelview."+F.code)},H)),s.jsx(In,{isActive:n,onClick:F=>o(!0),children:s.jsx(zd,{className:"fa-icon"})})]}),s.jsxs(be,{position:"relative",children:[f&&s.jsx(q,{fit:!0,position:"absolute",className:"top-0 start-0 z-index-1 bg-muted opacity-0-5"}),!n&&s.jsxs(s.Fragment,{children:[s.jsx(Uoe,{sendSearch:U}),s.jsx(N,{innerRef:M,overflow:"auto",children:O&&O.results.map((F,H)=>s.jsx(Poe,{searchResult:F},H))})]}),n&&s.jsx(Ooe,{})]})]}),s.jsx(xoe,{}),l&&s.jsx(Coe,{onCloseClick:()=>c(!1)}),u&&s.jsx(Noe,{onCloseClick:()=>d(!1),roomId:_}),s.jsx(Loe,{})]})},Foe=/\n\r|\n|\r/mg,koe=a=>{const[e,t]=h.useState(null),[i,r]=h.useState(""),[n,o]=h.useState(null),l=h.useRef(null);return h.useEffect(()=>{const c=async d=>{try{const _=await fetch(d);if(!_)return;const f=(await _.text()).split(Foe),E=f.shift().split("|");r(E[0]),o(I=>E[1]&&E[1].split(";").length===2?{width:parseInt(E[1].split(";")[0]),height:parseInt(E[1].split(";")[1])}:null),t(f.join(""))}catch{ze.error(`Failed to fetch ${d}`)}},u={linkReceived:d=>{const _=d.split("/");_.length<2||(_.shift(),c(xe("habbopages.url")+_.join("/")))},eventUrlPrefix:"habbopages/"};return fs(u),()=>ps(u)},[]),h.useEffect(()=>{const c=u=>{if(!(u.target instanceof HTMLAnchorElement))return;u.preventDefault();const d=u.target.href;!d||!d.length||nh(d)};return document.addEventListener("click",c),()=>{document.removeEventListener("click",c)}},[]),e?s.jsxs(ve,{className:"nitropedia",theme:"primary-slim",style:n?{width:n.width,height:n.height}:{},children:[s.jsx(je,{headerText:i,onCloseClick:()=>t(null)}),s.jsx(be,{children:s.jsx(q,{fit:!0,innerRef:l,className:"text-black",dangerouslySetInnerHTML:{__html:e}})})]}):null},Goe=a=>{const{offer:e=null,setOpen:t=null}=a;if(e)return s.jsxs(PN,{fadesOut:!1,onClose:null,onClick:i=>t(!0),gap:2,children:[s.jsx(q,{className:"nitro-targeted-offer-icon",style:{backgroundImage:`url(${xe("image.library.url")+e.iconImageUrl})`}}),s.jsx(T,{variant:"light",className:"ubuntu-bold",children:e.title})]})},Boe=a=>{const{offer:e=null,setOpen:t=null}=a,{getCurrencyAmount:i}=Qa(),[r,n]=h.useState(1),o=h.useMemo(()=>{let u=!1,d=!1,_=!1;return e.priceInCredits>0&&(u=i(-1)>=e.priceInCredits),e.priceInActivityPoints>0?d=i(e.activityPointType)>=e.priceInActivityPoints:d=!0,e.purchaseLimit>0&&(_=!0),u&&d&&_},[e,i]),l=()=>{let u=Math.max(0,(e.expirationTime-Date.now())/1e3);return Mr.format(u)},c=()=>{K(new xP(e.id,r)),K(new qC)};if(e)return s.jsxs(ve,{theme:"primary-slim",uniqueKey:"targeted-offer",className:"nitro-targeted-offer",children:[s.jsx(je,{headerText:g(e.title),onCloseClick:u=>t(!1)}),s.jsx(DG,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",variant:"danger",gap:3,children:g("targeted.offer.timeleft",["timeleft"],[l()])}),s.jsxs(be,{gap:1,children:[s.jsxs(x,{gap:1,fullHeight:!0,children:[s.jsxs(x,{gap:1,column:!0,className:"w-75 text-black",children:[s.jsxs(N,{className:"bg-warning p-2",fullHeight:!0,children:[s.jsx("h4",{children:g(e.title)}),s.jsx(q,{dangerouslySetInnerHTML:{__html:e.description}})]}),s.jsxs(x,{alignSelf:"center",alignItems:"center",justifyContent:"center",gap:2,children:[e.purchaseLimit>1&&s.jsxs(x,{gap:1,children:[s.jsx(T,{variant:"muted",children:g("catalog.bundlewidget.quantity")}),s.jsx("input",{type:"number",value:r,onChange:u=>n(parseInt(u.target.value)),min:1,max:e.purchaseLimit})]}),s.jsx(X,{variant:"primary",disabled:!o,onClick:()=>c(),children:g("targeted.offer.button.buy")})]})]}),s.jsx(q,{className:"w-50",fullHeight:!0,style:{background:`url(${xe("image.library.url")+e.imageUrl}) no-repeat center`}})]}),s.jsxs(x,{className:"price-ray position-absolute",alignItems:"center",justifyContent:"center",column:!0,children:[s.jsx(T,{children:g("targeted.offer.price.label")}),e.priceInCredits>0&&s.jsxs(x,{gap:1,children:[s.jsx(T,{variant:"light",children:e.priceInCredits}),s.jsx(gs,{type:-1})]}),e.priceInActivityPoints>0&&s.jsxs(x,{gap:1,children:[s.jsxs(T,{className:"ubuntu-bold",variant:"light",children:["+",e.priceInActivityPoints]})," ",s.jsx(gs,{type:e.activityPointType})]})]})]})]})},Voe=()=>{const[a,e]=h.useState(null),[t,i]=h.useState(!1);if(J($D,r=>{let n=r.getParser();n&&e(n.data)}),QG(()=>{K(new qC)}),!!a)return s.jsx(s.Fragment,{children:t?s.jsx(Boe,{offer:a,setOpen:i}):s.jsx(Goe,{offer:a,setOpen:i})})},Hoe=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(null),[n,o]=h.useState(!0),{showConfirm:l=null}=kt();J(Gg,f=>{t(0),r(null)}),J(MC,f=>{t(0),r(null)}),J(bl,f=>{const E=f.getParser();E.roomEnter&&(E.data.habboGroupId>0?(t(E.data.habboGroupId),K(new Pd(E.data.habboGroupId,!1))):(t(0),r(null)))}),J(IM,f=>{const E=f.getParser();!i||E.groupId!==i.id&&E.groupId!==e||(t(0),r(null))}),J(Xd,f=>{const E=f.getParser();E.id===e&&r(E)});const c=()=>{l(g("group.leaveconfirm.desc"),()=>{K(new _T(i.id,te().userId))},null)},u=i&&i.ownerName===te().userName,d=()=>{if(u)return"group.manage";if(i.type===Or.PRIVATE)return"";if(i.membershipType===ci.MEMBER)return"group.leave";if(i.membershipType===ci.NOT_MEMBER&&i.type===Or.REGULAR)return"group.join";if(i.membershipType===ci.REQUEST_PENDING)return"group.membershippending";if(i.membershipType===ci.NOT_MEMBER&&i.type===Or.EXCLUSIVE)return"group.requestmembership"},_=()=>{if(u)return ST(i.id);if(!(i.type===Or.PRIVATE&&i.membershipType===ci.NOT_MEMBER)){if(i.membershipType===ci.MEMBER){c();return}xN(i.id)}},m=()=>{Ce("group-forum/show/group/"+i.id)};return i?s.jsx(q,{className:"nitro-notification-bubble rounded",children:s.jsxs(N,{children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:f=>o(E=>!E),children:[s.jsx(T,{variant:"white",children:g("group.homeroominfo.title")}),n&&s.jsx(Nd,{className:"fa-icon"}),!n&&s.jsx(Ad,{className:"fa-icon"})]}),n&&s.jsxs(s.Fragment,{children:[s.jsxs(x,{pointer:!0,alignItems:"center",gap:2,onClick:f=>Qd(i.id),children:[s.jsx(q,{className:"group-badge",children:s.jsx(as,{badgeCode:i.badge,isGroup:!0})}),s.jsx(T,{variant:"white",children:i.title})]}),i.hasForum&&s.jsx(X,{fullWidth:!0,onClick:m,children:g("group.showforum")}),(i.type!==Or.PRIVATE||u)&&s.jsx(X,{fullWidth:!0,variant:"success",disabled:i.membershipType===ci.REQUEST_PENDING,onClick:_,children:g(d())})]})]})}):null},Woe=a=>{const{title:e="Nitro",onClose:t=null,...i}=a;return s.jsx(Jd,{title:e,onClose:t,...i,children:s.jsxs(Ye,{children:[s.jsx(N,{center:!0,size:5,children:s.jsx("object",{data:"https://assets.nitrodev.co/logos/nitro-n-dark.svg",width:"100",height:"100",children:" "})}),s.jsxs(N,{size:7,children:[s.jsxs(N,{alignItems:"center",gap:0,children:[s.jsx(T,{bold:!0,fontSize:4,children:"Nitro React"}),s.jsxs(T,{children:["v",yk()]})]}),s.jsxs(N,{alignItems:"center",children:[s.jsxs(T,{children:[s.jsx("b",{children:"Renderer:"})," v",lJ()]}),s.jsxs(N,{fullWidth:!0,gap:1,children:[s.jsx(X,{fullWidth:!0,variant:"success",onClick:r=>window.open("https://discord.nitrodev.co"),children:"Discord"}),s.jsxs(x,{gap:1,children:[s.jsx(X,{fullWidth:!0,onClick:r=>window.open("https://git.krews.org/nitro/nitro-react"),children:"Git"}),s.jsx(X,{fullWidth:!0,onClick:r=>window.open("https://git.krews.org/nitro/nitro-react/-/issues"),children:"Bug Report"})]})]})]})]})]})})},Yoe=a=>{const{item:e=null,title:t=a.item&&a.item.title||"",onClose:i=null,...r}=a,[n,o]=h.useState(!1),l=()=>{nh(e.clickUrl),i()},c=e.alertType===lt.DEFAULT;return s.jsxs(Jd,{title:t,onClose:i,...r,type:c?lt.DEFAULT:e.alertType,children:[s.jsxs(x,{fullHeight:!0,overflow:"auto",gap:c||e.imageUrl&&!n?2:0,children:[c&&!e.imageUrl&&s.jsx(q,{className:"notification-frank flex-shrink-0"}),e.imageUrl&&!n&&s.jsx("img",{src:e.imageUrl,alt:e.title,onError:()=>{o(!0)},className:"align-self-baseline"}),s.jsxs(q,{classNames:["notification-text overflow-y-auto d-flex flex-column w-100",e.clickUrl&&!c?"justify-content-center":""],children:[e.messages.length>0&&e.messages.map((u,d)=>{const _=u.replace(/\r\n|\r|\n/g,"<br />");return s.jsx(q,{dangerouslySetInnerHTML:{__html:_}},d)}),e.clickUrl&&e.clickUrl.length>0&&e.imageUrl&&!n&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"my-2 w-100"}),s.jsx(X,{onClick:l,className:"align-self-center px-3",children:g(e.clickUrlText)})]})]})]}),(!e.imageUrl||e.imageUrl&&n)&&s.jsx(s.Fragment,{children:s.jsxs(N,{alignItems:"center",center:!0,gap:0,children:[s.jsx("hr",{className:"my-2 w-100"}),!e.clickUrl&&s.jsx(X,{onClick:i,children:g("generic.close")}),e.clickUrl&&e.clickUrl.length>0&&s.jsx(X,{onClick:l,children:g(e.clickUrlText)})]})})]})},zoe=a=>{const{item:e=null,title:t=a.item&&a.item.title||"",onClose:i=null,...r}=a,[n,o]=h.useState(""),[l,c]=h.useState([]),u=()=>{nh(e.clickUrl),i()},d=m=>{let f=JSON.parse(e.messages[0]);c(f.filter(E=>E.includes(m))),o(m)};h.useEffect(()=>{c(JSON.parse(e.messages[0]))},[e]);const _=e.clickUrl&&e.clickUrl.startsWith("event:");return s.jsxs(Jd,{title:t,onClose:i,...r,children:[s.jsx(x,{fullWidth:!0,alignItems:"center",position:"relative",children:s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("generic.search"),value:n,onChange:m=>d(m.target.value)})}),s.jsx(N,{fullHeight:!0,className:"py-1",overflow:"hidden",children:s.jsx(Os,{gap:1,columnCount:1,children:l&&l.map((m,f)=>s.jsx("span",{children:m},f))})}),s.jsx("hr",{className:"my-2"}),s.jsxs(N,{alignItems:"center",center:!0,gap:1,children:[!_&&!e.clickUrl&&s.jsx(X,{onClick:i,children:g("generic.close")}),e.clickUrl&&e.clickUrl.length>0&&s.jsx(X,{onClick:u,children:g(e.clickUrlText)})]})]})},Koe=(a,e)=>{if(!a)return null;const t={item:a,onClose:e};switch(a.alertType){case lt.NITRO:return s.jsx(Woe,{...t},a.id);case lt.SEARCH:return s.jsx(zoe,{...t},a.id);default:return s.jsx(Yoe,{...t},a.id)}},qoe=a=>{const{item:e=null,onClose:t=null,...i}=a;return s.jsxs(PN,{fadesOut:!1,className:"flex-column club-gift",onClose:t,...i,children:[s.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[s.jsx(gs,{type:"hc",className:"flex-shrink-0"}),s.jsx("span",{className:"ms-1",children:g("notifications.text.club_gift")})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-end gap-2",children:[s.jsx("button",{type:"button",className:"btn btn-success w-100 btn-sm",onClick:()=>nh(e.linkUrl),children:g("notifications.button.show_gift_list")}),s.jsx("span",{className:"text-decoration-underline cursor-pointer text-nowrap",onClick:t,children:g("notifications.button.later")})]})]})},Xoe=a=>{const{item:e=null,onClose:t=null,...i}=a,r=e.message;return s.jsxs(PN,{onClose:t,gap:2,alignItems:"center",onClick:n=>e.linkUrl&&e.linkUrl.length&&nh(e.linkUrl),...i,children:[s.jsx(x,{center:!0,className:"bubble-image-container",children:e.iconUrl&&e.iconUrl.length&&s.jsx("img",{className:"no-select",src:e.iconUrl,alt:""})}),s.jsx(T,{wrap:!0,textBreak:!0,variant:"white",dangerouslySetInnerHTML:{__html:r}})]})},$oe=(a,e)=>{if(!a)return null;const t={item:a,onClose:e};switch(a.notificationType){case bi.CLUBGIFT:return s.jsx(qoe,{...t},a.id);default:return s.jsx(Xoe,{...t},a.id)}},Dv=a=>{const{item:e=null,onClose:t=null,...i}=a,{message:r=null,onConfirm:n=null,onCancel:o=null,confirmText:l=null,cancelText:c=null,title:u=null}=e,d=()=>{n&&n(),t()},_=()=>{o&&o(),t()};return s.jsxs(Jd,{title:u,onClose:t,...i,type:lt.ALERT,children:[s.jsx(x,{grow:!0,center:!0,children:s.jsx(T,{children:r})}),s.jsxs(x,{gap:1,children:[s.jsx(X,{fullWidth:!0,variant:"danger",onClick:_,children:c}),s.jsx(X,{fullWidth:!0,onClick:d,children:l})]})]})},Qoe=(a,e)=>{if(!a)return null;const t={item:a,onClose:e};switch(a.confirmType){default:return s.jsx(Dv,{style:{whiteSpace:"pre-line"},...t},a.id);case"centered":return s.jsx(Dv,{style:{whiteSpace:"pre-line",height:"230px",textAlign:"center"},...t},a.id)}},Joe=a=>{const{item:e=null,onClose:t=null,...i}=a,{offer:r,message:n=null,onConfirm:o=null,onCancel:l=null,confirmText:c=null,cancelText:u=null,title:d=null}=e,_=()=>{o&&o(),t()},m=()=>{l&&l(),t()},f=h.useMemo(()=>r?g((r.furniType===2?"wallItem":"roomItem")+`.name.${r.furniId}`):"",[r]);return s.jsxs(Jd,{title:d,onClose:t,...i,type:lt.MARKET_PLACE,children:[s.jsxs(N,{column:!1,children:[s.jsx(x,{style:{width:60,height:60,background:"white",borderRadius:5},center:!0,children:s.jsx("div",{style:{width:30,height:30,backgroundImage:`url(${pN(r.furniType===qu.TYPE_FLOOR?dt.FLOOR:dt.WALL,r.furniId,r.extraData)})`,backgroundRepeat:"no-repeat",backgroundSize:"contain",backgroundPosition:"center"}})}),s.jsxs(x,{column:!0,children:[s.jsx(T,{bold:!0,style:{marginBottom:5},children:f}),s.jsx(T,{children:g("catalog.marketplace.offer.price_public_item",["price","average","rarePrice"],[r.price.toString(),r.averagePrice>0?r.averagePrice.toString():"-",r.rarePrice>0?r.rarePrice.toString():"-"])}),s.jsx(T,{children:g("catalog.marketplace.offer_count",["count"],[r.offerCount.toString()])}),r.isUniqueLimitedItem&&s.jsxs(T,{children:["Lote: ",r.stuffData.uniqueNumber,"/",r.stuffData.uniqueSeries]})]})]}),s.jsxs(x,{gap:1,children:[s.jsx(X,{fullWidth:!0,variant:"danger",onClick:m,children:u}),s.jsx(X,{fullWidth:!0,onClick:_,children:c})]})]})},Zoe=(a,e)=>{if(!a)return null;const t={item:a,onClose:e};switch(a.marketplaceType){case lt.MARKET_PLACE:return s.jsx(Joe,{...t},a.id)}},ele=100,tle=a=>{var M,U;const{item:e=null,onClose:t=null,...i}=a,{message:r=null,onConfirm:n=null,onCancel:o=null,confirmText:l=null,cancelText:c=null,title:u=null}=e,[d,_]=h.useState(((U=(M=e.groupItem)==null?void 0:M.getLastItem())==null?void 0:U.id)||-1),[m,f]=h.useState(e.amount),{showConfirm:E}=kt(),[I]=HG(),p=e?g(e.groupItem.isWallItem?"wallItem.name."+e.groupItem.type:"roomItem.name."+e.groupItem.type):"",S=e?g(e.groupItem.isWallItem?"wallItem.desc."+e.groupItem.type:"roomItem.desc."+e.groupItem.type):"",R=h.useCallback(()=>{if(n)n();else if(I)vl().send(new Ex(d,m));else{const G=g("inventory.delete.confirm",["value","furni"],[e.amount.toString(),p]);E(G,()=>{vl().send(new Ex(d,m))},o)}t()},[n,t,I,d,m,e.amount,p,E,o]),O=h.useRef(null),C=G=>{f(F=>{var v;const H=Math.max(1,Math.min(e.groupItem.getTotalCount(),F+G));return _(((v=e.groupItem.getLastItem())==null?void 0:v.id)||-1),H})},A=G=>{isNaN(G)&&(G=1),G=Math.max(1,Math.min(e.groupItem.getTotalCount(),G)),f(G)},b=G=>{C(G),O.current&&(clearInterval(O.current),O.current=null),O.current=window.setInterval(()=>{C(G)},ele)},y=()=>{O.current&&(clearInterval(O.current),O.current=null)};return e?h.createElement(Jd,{title:u,onClose:t,...i,type:lt.DELETABLE_DEFAULT,key:e.id},s.jsx(x,{fullHeight:!0,column:!0,gap:2,children:s.jsxs(N,{column:!1,fullHeight:!0,children:[s.jsx(N,{overflow:"hidden",gap:2,alignItems:"center",size:4,className:"p-2",justifyContent:"center",fullHeight:!0,style:{background:"#B6BEC5",borderRadius:5},center:!0,children:s.jsx(N,{center:!0,className:"bg-muted rounded p-2",size:4,overflow:"hidden",fullWidth:!0,fullHeight:!0,children:s.jsx(xT,{productType:e.groupItem.isWallItem?dt.WALL:dt.FLOOR,productClassId:e.groupItem.type,extraData:e.groupItem.extra.toString()})})}),s.jsxs(x,{column:!0,fullWidth:!0,fullHeight:!0,justifyContent:"between",children:[s.jsxs(N,{fullWidth:!0,children:[s.jsx(T,{bold:!0,style:{marginBottom:5},children:p}),s.jsx(T,{children:S})]}),s.jsxs(N,{gap:1,fullWidth:!0,children:[s.jsx(x,{gap:1,children:s.jsx(T,{children:g("notification.deletable.item")})}),s.jsxs(x,{center:!0,gap:1,children:[s.jsx(of,{className:"text-black cursor-pointer fa-icon",onMouseDown:()=>b(-1),onMouseUp:y,onMouseLeave:y,onTouchStart:()=>b(-1),onTouchEnd:y}),s.jsx("input",{type:"number",className:"w-100 form-control form-control-sm quantity-input",value:m,onChange:G=>A(G.target.valueAsNumber)}),s.jsx(xg,{className:"text-black cursor-pointer fa-icon",onMouseDown:()=>b(1),onMouseUp:y,onMouseLeave:y,onTouchStart:()=>b(1),onTouchEnd:y}),s.jsx(X,{style:{width:"28px"},variant:"black",onClick:()=>A(e.groupItem.getTotalCount()),children:"Max"})]}),s.jsx(X,{variant:"danger",fullWidth:!0,onClick:R,children:l})]})]})]})})):null},sle=(a,e)=>{if(!a)return null;const t={item:a,onClose:e};return s.jsx(tle,{...t})},ile=a=>{const{alerts:e=[],bubbleAlerts:t=[],confirms:i=[],marketplaces:r=[],deletables:n=[],closeAlert:o=null,closeBubbleAlert:l=null,closeConfirm:c=null,closeMarketplace:u=null,closeDeletableItem:d}=kt(),_=h.useMemo(()=>{if(!e||!e.length)return null;const p=[];for(const S of e){const R=Koe(S,()=>o(S));p.push(R)}return p},[e,o]),m=h.useMemo(()=>{if(!t||!t.length)return null;const p=[];for(const S of t){const R=$oe(S,()=>l(S));if(S.notificationType===bi.CLUBGIFT){p.unshift(R);continue}p.push(R)}return p},[t,l]),f=h.useMemo(()=>{if(!i||!i.length)return null;const p=[];for(const S of i){const R=Qoe(S,()=>c(S));p.push(R)}return p},[i,c]),E=h.useMemo(()=>{if(!r||!r.length)return null;const p=[];for(const S of r){const R=Zoe(S,()=>u(S));p.push(R)}return p},[r,u]),I=h.useMemo(()=>{if(!n||!n.length)return null;const p=[];for(const S of n){const R=sle(S,()=>d(S));p.push(R)}return p},[n,d]);return s.jsxs(s.Fragment,{children:[s.jsx(N,{gap:1,children:m}),f,_,E,I]})},rle=a=>{const{type:e=-1,amount:t=-1,short:i=!1}=a,r=h.useMemo(()=>s.jsxs(x,{justifyContent:"end",pointer:!0,gap:1,className:"nitro-purse-button rounded",children:[s.jsx(T,{truncate:!0,textEnd:!0,variant:"white",grow:!0,children:i?FQ(t):dr(t)}),s.jsx(gs,{type:e})]}),[t,i,e]);return i?s.jsx(cc,{placement:"left",overlay:s.jsx(Wc,{id:`tooltip-${e}`,children:dr(t)}),children:r}):r},nle=a=>{const{type:e=-1,amount:t=-1}=a;return s.jsxs(x,{fullWidth:!0,justifyContent:"between",className:"nitro-purse-seasonal-currency p-2 rounded",children:[s.jsx(T,{variant:"white",children:g(`purse.seasonal.currency.${e}`)}),s.jsxs(x,{gap:1,children:[s.jsx(T,{variant:"white",children:dr(t)}),s.jsx(gs,{type:e})]})]})},ale=a=>{const{purse:e=null,hcDisabled:t=!1}=Qa(),[i,r]=h.useState(!1),[n,o]=h.useState(0),{isMobile:l}=Ia(),[c,u]=h.useState(!l),d=h.useMemo(()=>xe("system.currency.types",[]),[]),_=h.useMemo(()=>xe("currency.display.number.short",!1),[]);(()=>{if(!e)return null;const E=e.clubPeriods*31+e.clubDays,I=e.minutesUntilExpiration;return e.clubLevel===rr.NO_CLUB?g("purse.clubdays.zero.amount.text"):I>-1&&I<60*24?Mr.shortFormat(I*60):Mr.shortFormat(E*86400)})();const m=(E,I=-1,p=!1)=>{if(!e||!e.activityPoints||!e.activityPoints.size)return null;const S=Array.from(e.activityPoints.keys()).filter(C=>d.indexOf(C)>=0);let R=0;for(;R<E;)S.shift(),R++;R=0;const O=[];for(const C of S){if(I>-1&&R===I)break;p?O.push(s.jsx(nle,{type:C,amount:e.activityPoints.get(C)},C)):O.push(s.jsx(rle,{type:C,amount:e.activityPoints.get(C),short:_},C)),R++}return O};J(WC,E=>{o(E.getParser().vipTimestamp)});const f=E=>{const I=E/86400,p=E/60;return p>-1&&p<60*24?Mr.shortFormat(p*60):Mr.shortFormat(I*86400)};return e?s.jsxs(N,{alignItems:"end",className:"nitro-purse-container",gap:1,children:[s.jsx(x,{alignItems:"center",className:"mobile-close-option",onClick:()=>u(!c),children:c?s.jsx(Nd,{className:"fa-icon"}):s.jsx(Ad,{className:"fa-icon"})}),s.jsx(x,{className:`nitro-purse rounded-bottom py-1 ${!c&&"nitro-purse-widget-open"}`,children:s.jsxs(N,{alignItems:"end",gap:2,children:[s.jsxs("div",{className:"container-carteira",children:[s.jsx("div",{className:"carteira-botoes",children:s.jsxs("button",{className:"carteira-bolsa",id:"carteira",children:[s.jsx("i",{id:"carteiraImg",onClick:()=>r(E=>!E),className:"icon "+(i?"icon-wallet-opened":"icon-wallet-closed")}),i&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"carteira-bolsa-display moeda",children:[s.jsx("span",{children:"8"}),s.jsx("i",{className:"icon icon-moeda"})]}),s.jsxs("div",{className:"carteira-bolsa-display ducket",children:[s.jsx("span",{children:dr(e.activityPoints.get(0))}),s.jsx("i",{className:"icon icon-ducket"})]}),s.jsxs("div",{className:"carteira-bolsa-display diamante",children:[s.jsx("span",{children:dr(e.activityPoints.get(105))}),s.jsx("i",{className:"icon icon-diamante"})]}),s.jsxs("div",{className:"carteira-bolsa-display hubcoin",children:[s.jsx("span",{children:dr(e.activityPoints.get(107))}),s.jsx("i",{className:"icon icon-hubcoin"})]}),s.jsxs("div",{className:"carteira-bolsa-display promocoin",onClick:()=>{Ce("catalog/open/"+Yg.PROMOCOINS)},children:[s.jsx("span",{children:dr(e.activityPoints.get(108))}),s.jsx("i",{className:"icon icon-promocoin"})]})]})]})}),s.jsxs(x,{gap:1,style:{marginTop:"3px"},children:[s.jsxs("button",{className:"carteira-vip",onClick:()=>Me.call("openLoja",{moedaEscolhida:wx(),diamantes:dr(e.activityPoints.get(105)),hubbeCoins:dr(e.activityPoints.get(107)),vipEndDate:Fx(),playerId:te().userId,promoCoins:dr(e.activityPoints.get(108))}),children:[s.jsx("i",{className:"icon icon-loja"}),s.jsx("span",{children:"LOJA"})]}),s.jsxs(x,{gap:2,children:[s.jsx(x,{className:"carteira-bolsa",alignItems:"center",justifyContent:"center",pointer:!0,onClick:E=>Ce("user-transactions/toggle"),children:s.jsx("i",{className:"icon icon-clock"})}),s.jsx(x,{className:"carteira-bolsa",alignItems:"center",justifyContent:"center",pointer:!0,onClick:E=>Ce("help/show"),children:s.jsx("i",{className:"icon icon-help"})}),s.jsx(x,{className:"carteira-bolsa",alignItems:"center",justifyContent:"center",pointer:!0,onClick:E=>Ce("user-settings/toggle"),children:s.jsx("i",{className:"icon icon-cog"})})]})]})]}),s.jsxs("div",{className:"club-container",onClick:()=>Me.call("openLoja",{moedaEscolhida:wx(),diamantes:dr(e.activityPoints.get(105)),hubbeCoins:dr(e.activityPoints.get(107)),vipEndDate:Fx(),playerId:te().userId,promoCoins:dr(e.activityPoints.get(108))}),children:[s.jsx("div",{className:"club-icon",children:s.jsx("i",{className:"icon icon-club"})}),n<=0&&s.jsx("span",{className:"club-period",children:"Faça parte do HubbeClub"}),n>0&&s.jsx("span",{className:"club-period",children:f(n)})]})]})}),m(2,-1,!0)]}):null},ole={purple:9452386,blue:3891856,green:6459451,yellow:10658089,lilac:6897548,orange:10841125,turquoise:2661026,red:10104881},lle=a=>{const[e,t]=h.useState(!0),[i,r]=h.useState(""),[n,o]=h.useState("");wte(Rf.MYSTERY_BOX_KEYS_UPDATE,c=>{r(c.keyColor),o(c.boxColor)});const l=c=>{const u=ole[c];return sr.int2rgb(u)};return i===""&&n===""?null:s.jsx(q,{className:"nitro-notification-bubble rounded mysterybox-extension",children:s.jsxs(N,{children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:c=>t(u=>!u),children:[s.jsx(T,{variant:"white",children:g("mysterybox.tracker.title")}),e&&s.jsx(Nd,{className:"fa-icon"}),!e&&s.jsx(Ad,{className:"fa-icon"})]}),e&&s.jsxs(s.Fragment,{children:[s.jsx(T,{variant:"white",children:g("mysterybox.tracker.description")}),s.jsxs(x,{justifyContent:"center",alignItems:"center",gap:2,children:[s.jsx(ct,{className:"mysterybox-container",children:s.jsx("div",{className:"box-image flex-shrink-0",style:{backgroundColor:l(n)},children:s.jsx("div",{className:"chain-overlay-image"})})}),s.jsx(ct,{className:"mysterybox-container",children:s.jsx("div",{className:"key-image flex-shrink-0",style:{backgroundColor:l(i)},children:s.jsx("div",{className:"key-overlay-image"})})})]})]})]})})},cle=a=>{const{eventId:e=-1,eventName:t="",eventDescription:i="",setIsEditingPromote:r=null}=a,[n,o]=h.useState(t),[l,c]=h.useState(i),{promoteInformation:u}=DT(),d=()=>{K(new m1(e,n,l)),r(!1)};return s.jsxs(ve,{className:"nitro-guide-tool",theme:"primary-slim",children:[s.jsx(je,{headerText:g("navigator.eventsettings.editcaption"),onCloseClick:()=>r(!1)}),s.jsxs(be,{className:"text-black",children:[s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("navigator.eventsettings.name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("navigator.eventsettings.name"),maxLength:64,value:n,onChange:_=>o(_.target.value)})]}),s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("navigator.eventsettings.desc")}),s.jsx("textarea",{className:"form-control form-control-sm",placeholder:g("navigator.eventsettings.desc"),maxLength:64,value:l,onChange:_=>c(_.target.value)})]}),s.jsx(N,{children:s.jsxs(T,{overflow:"hidden",fontSize:6,style:{textTransform:"capitalize"},children:["Encerra em:",s.jsx("br",{}),u.data.expirationDate.toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})]})}),s.jsx(N,{children:s.jsx(X,{fullWidth:!0,disabled:!n||!l,variant:!n||!l?"danger":"success",onClick:_=>d(),children:g("navigator.eventsettings.edit")})})]})]})},ule=a=>{const{eventDescription:e="",setIsEditingPromote:t=null}=a,{setIsExtended:i}=DT(),r=()=>{i(!0),Ce("catalog/open/room_event")};return s.jsxs(s.Fragment,{children:[s.jsx(x,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:s.jsx(T,{variant:"white",children:e})}),s.jsx("br",{}),s.jsx("br",{}),s.jsxs(Ye,{className:"d-flex align-items-center justify-content-end gap-2",children:[s.jsx(X,{fullWidth:!0,onClick:n=>t(!0),children:g("navigator.roominfo.editevent")}),s.jsx(X,{fullWidth:!0,onClick:r,children:g("roomad.extend.event")})]})]})},hle=a=>{const{eventDescription:e="",expirationDate:t=null}=a,[i,r]=h.useState(0);return s.jsxs(s.Fragment,{children:[s.jsx(x,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:s.jsx(T,{variant:"white",children:e})}),s.jsx("br",{}),s.jsx("br",{}),s.jsx(N,{alignItems:"center",gap:1,children:s.jsxs(q,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[s.jsx(x,{fit:!0,center:!0,position:"absolute",children:s.jsx(T,{variant:"white",center:!0,children:g("navigator.eventinprogress")})}),s.jsx(x,{style:{width:"100%",height:"20px",borderRadius:"5px",overflow:"hidden"},children:s.jsx(T,{style:{width:`${i}%`,height:"100%",background:"#1e7295",transition:"width 1s linear"}})})]})})]})},dle=a=>{var m;const{roomSession:e}=vt(),[t,i]=h.useState(!1),[r,n]=h.useState(!0),[o,l]=h.useState(!1),{promoteInformation:c,setPromoteInformation:u}=DT(),{navigatorData:d=null}=Ir();J(Gg,f=>{u(null),l(!1)}),h.useEffect(()=>{l(!1)},[e]);const _=te().userName===((m=d.enteredGuestRoom)==null?void 0:m.ownerName);return!e||!c||c.data.adId===-1&&!_?null:c.data.adId===-1&&_?s.jsx(q,{className:"nitro-notification-bubble rounded",children:s.jsxs(N,{children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:f=>l(E=>!E),children:[s.jsxs(x,{gap:1,children:[s.jsx("i",{className:"icon icon-small-room"}),s.jsx(T,{variant:"white",overflow:"hidden",children:"Promover Quarto"})]}),o&&s.jsx(Nd,{className:"fa-icon"}),!o&&s.jsx(Ad,{className:"fa-icon"})]}),o&&s.jsxs(N,{children:[s.jsx(T,{variant:"white",children:"Não há nenhum evento sendo promovido neste quarto!"}),s.jsx(X,{onClick:()=>Ce("catalog/open/room_event"),children:"Que tal começar um?"})]})]})}):s.jsx(q,{className:"nitro-notification-bubble rounded",children:s.jsxs(N,{children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:f=>n(E=>!E),children:[s.jsxs(x,{gap:1,children:[s.jsx("i",{className:"icon icon-small-room"}),s.jsx(T,{variant:"white",overflow:"hidden",children:c.data.eventName})]}),r&&s.jsx(Nd,{className:"fa-icon"}),!r&&s.jsx(Ad,{className:"fa-icon"})]}),r&&te().userId!==c.data.ownerAvatarId&&s.jsx(hle,{eventDescription:c.data.eventDescription,expirationDate:c.data.expirationDate}),r&&te().userId===c.data.ownerAvatarId&&s.jsx(ule,{eventDescription:c.data.eventDescription,setIsEditingPromote:()=>i(!0)}),t&&s.jsx(cle,{eventId:c.data.adId,eventName:c.data.eventName,eventDescription:c.data.eventDescription,setIsEditingPromote:()=>i(!1)})]})})},OB=a=>{const{quest:e,acceptQuest:t,cancelQuest:i,progressColor:r,isHint:n=!1}=a,o=()=>e.accepted?"white":"black";return s.jsx(x,{className:`quest-view image-rendering-pixelated ${e.accepted?"accepted-quest":""}`,children:s.jsx(N,{className:`quest-content ${e.accepted?"accepted-quest":""}`,fullWidth:!0,children:s.jsxs(N,{fullWidth:!0,fullHeight:!0,children:[s.jsxs(x,{justifyContent:"between",alignItems:"center",className:`quest-header ${e.accepted?"accepted-quest":""}`,children:[s.jsx(T,{bold:!0,style:{marginLeft:"20px"},variant:o(),children:g(e.questName)}),s.jsxs(x,{gap:2,alignItems:"center",style:{marginRight:"5px"},children:[s.jsx(T,{variant:o(),children:e.timeToExpire}),s.jsx("i",{className:"icon icon-hourglass"})]})]}),s.jsxs(x,{alignItems:"center",gap:3,children:[s.jsx(N,{children:s.jsxs(N,{className:`quest-badge-reward ${e.accepted?"accepted-quest":""}`,children:[s.jsx(as,{shrink:!0,badgeCode:e.catalogPageName}),s.jsxs(x,{className:`quest-steps quest-difficulty-${r}`,children:[s.jsx(T,{variant:"white",bold:!0,children:e.completedQuestsInCampaign}),s.jsx(T,{variant:"white",bold:!0,children:"/"}),s.jsx(T,{variant:"white",bold:!0,children:e.questCountInCampaign})]})]})}),s.jsxs(N,{gap:3,overflow:"hidden",children:[s.jsxs(N,{gap:3,children:[s.jsx(T,{bold:!0,style:{maxWidth:"300px"},children:g(e.questDesc)}),n&&s.jsx(T,{bold:!0,style:{maxWidth:"300px"},children:g(e.questHint)})]}),s.jsxs(x,{gap:2,alignItems:"center",children:[s.jsxs(T,{children:["Prêmios: ",e.rewardCurrencyAmount]}),s.jsx(gs,{type:e.currencyIcon}),s.jsx(T,{children:150}),s.jsx(gs,{type:6}),!e.accepted&&!n&&s.jsx(x,{justifyContent:"end",className:"quest-button-accept",children:s.jsx(X,{variant:"primary",onClick:()=>t(e.id),children:"Ativar tarefa"})}),(e.accepted||n)&&s.jsx(x,{justifyContent:"end",className:"quest-button-reject",children:s.jsx(T,{underline:!0,pointer:!0,onClick:i,children:"Cancelar tarefa"})})]})]})]})]})})},e.id)},_le=a=>{const{setVisible:e}=a,{acceptedQuest:t,cancelQuest:i}=kN();return s.jsxs(ve,{className:"nitro-quests-view nitro-quest-hit no-resize",theme:"primary-slim",children:[s.jsx(je,{headerText:"Tarefa",onCloseClick:()=>e(!1)}),s.jsx(be,{children:s.jsx(OB,{quest:t,acceptQuest:null,cancelQuest:i,progressColor:t.easy?"blue":"red",isHint:!0},t.id)})]})},gle=a=>{const{quest:e}=a,[t,i]=h.useState(!0),[r,n]=h.useState(!1);return s.jsxs(q,{className:"nitro-notification-bubble rounded",children:[s.jsxs(N,{children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:o=>i(l=>!l),children:[s.jsx(x,{gap:1,children:s.jsxs(T,{variant:"white",overflow:"hidden",style:{maxWidth:"180px"},children:["Tarefa: ",g(e.questName)]})}),t&&s.jsx(Nd,{className:"fa-icon"}),!t&&s.jsx(Ad,{className:"fa-icon"})]}),t&&s.jsxs(N,{fullWidth:!0,children:[s.jsxs(x,{gap:2,children:[s.jsx(x,{children:s.jsx(as,{shrink:!0,badgeCode:e.catalogPageName})}),s.jsx(T,{variant:"white",children:g(e.questDesc)})]}),s.jsxs(N,{alignItems:"center",fullWidth:!0,children:[s.jsx(N,{grow:!0,fullWidth:!0,alignItems:"center",justifyContent:"center",children:s.jsx(OT,{fullWidth:!0,progress:e.completedSteps,maxProgress:e.totalSteps,text:"Progresso"})}),s.jsx(x,{children:s.jsx(T,{variant:"link",underline:!0,pointer:!0,onClick:o=>n(!r),children:"Quer uma dica?"})})]})]})]}),r&&s.jsx(_le,{setVisible:n})]})},mle=a=>{const{acceptedQuest:e}=kN();return e?s.jsx(gle,{quest:e}):null},fle=a=>s.jsx("div",{className:"nitro-right-side",children:s.jsxs(N,{position:"relative",gap:1,children:[s.jsx(ale,{}),s.jsx(Hoe,{}),s.jsx(lle,{}),s.jsx(Voe,{}),s.jsx(dle,{}),s.jsx(mle,{}),s.jsx(ile,{})]})}),ple=a=>s.jsx("div",{className:"room-spectator"}),Ele=a=>{const[e,t]=h.useState(null),[i,r]=h.useState(null),{chatStyleId:n=0}=Ja(),{roomSession:o=null}=vt();J(_j,c=>{const u=c.getParser();if(!u)return;const d=o.userDataManager.getPetData(u.petId);d&&(t(d),r(u))});const l=(c,u)=>{!c||!u||o==null||o.sendChatMessage(`${c} ${u}`,n)};return!e||!i?null:s.jsxs(ve,{uniqueKey:"user-settings",className:"user-settings-window no-resize",theme:"primary-slim",children:[s.jsx(je,{headerText:g("widgets.pet.commands.title"),onCloseClick:()=>r(null)}),s.jsxs(be,{className:"text-black",children:[s.jsx(x,{alignItems:"center",justifyContent:"center",gap:2,children:s.jsxs(Ye,{columnCount:2,children:[s.jsx(N,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:s.jsx(Fn,{figure:e.figure,posture:"std",direction:2})}),s.jsx(T,{variant:"black",small:!0,wrap:!0,children:e.name})]})}),s.jsx(Ye,{columnCount:2,children:i.commands&&i.commands.length>0&&i.commands.map((c,u)=>s.jsx(X,{disabled:!i.enabledCommands.includes(c),onClick:()=>l(e.name,g(`pet.command.${c}`)),children:g(`pet.command.${c}`)},u))})]})]})},mr=a=>{const{justifyContent:e="center",alignItems:t="center",classNames:i=[],...r}=a,n=h.useMemo(()=>{const o=["menu-header","p-1"];return i.length&&o.push(...i),o},[i]);return s.jsx(x,{justifyContent:e,alignItems:t,classNames:n,...r})},Ile=a=>{const{chatEvent:e=null,onClose:t=null}=a,[i,r]=h.useState(e.chat==="${bot.skill.chatter.configuration.text.placeholder}"?"":e.chat),[n,o]=h.useState(e.automaticChat),[l,c]=h.useState(e.mixSentences),[u,d]=h.useState(e.chatDelay),_=h.useMemo(()=>EN($e().roomId,e.objectId,e.category,1),[e]),m=E=>E.replace(/;#;/g," ").replace(/\r\n|\r|\n/g,"\r"),f=()=>{const E=m(i)+";#;"+n+";#;"+u+";#;"+l;K(new so(e.botId,Rs.SETUP_CHAT,E)),t()};return s.jsx(jc,{windowPosition:Vi.NOTHING,handleSelector:".drag-handler",dragStyle:{top:_.y,left:_.x},children:s.jsxs(q,{className:"nitro-context-menu bot-chat",children:[s.jsx(mr,{className:"drag-handler",children:g("bot.skill.chatter.configuration.title")}),s.jsxs(N,{className:"p-1",children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{variant:"white",children:g("bot.skill.chatter.configuration.chat.text")}),s.jsx("textarea",{className:"form-control form-control-sm",placeholder:g("bot.skill.chatter.configuration.text.placeholder"),value:i,rows:7,onChange:E=>r(E.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{gap:1,alignItems:"center",justifyContent:"between",children:[s.jsx(T,{fullWidth:!0,variant:"white",children:g("bot.skill.chatter.configuration.automatic.chat")}),s.jsx("input",{type:"checkbox",className:"form-check-input",checked:n,onChange:E=>o(E.target.checked)})]}),s.jsxs(x,{gap:1,alignItems:"center",justifyContent:"between",children:[s.jsx(T,{fullWidth:!0,variant:"white",children:g("bot.skill.chatter.configuration.markov")}),s.jsx("input",{type:"checkbox",className:"form-check-input",checked:l,onChange:E=>c(E.target.checked)})]}),s.jsxs(x,{gap:1,alignItems:"center",justifyContent:"between",children:[s.jsx(T,{fullWidth:!0,variant:"white",children:g("bot.skill.chatter.configuration.chat.delay")}),s.jsx("input",{type:"number",className:"form-control form-control-sm",value:u,onChange:E=>d(E.target.valueAsNumber)})]})]}),s.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[s.jsx(X,{fullWidth:!0,variant:"primary",onClick:t,children:g("cancel")}),s.jsx(X,{fullWidth:!0,variant:"success",onClick:f,children:g("save")})]})]})]})})},Mv=-1,jv=0,Lv=1,Pv=2,Uv=3,wv=4,Fv=5,kv=6,mh=7,Tle=a=>{var S,R,O,C;const{item:e=null,onClose:t=null,monsterPlantBreed:i=-1}=a,[r,n]=h.useState(Mv),[o,l]=h.useState(null),[c,u]=h.useState(null),[d,_]=h.useState(null),{roomSession:m=null}=vt(),f=()=>{o&&ce().selectRoomObject(m.roomId,o.roomIndex,Q.UNIT)},E=()=>{vl().send(new hp(0,o==null?void 0:o.webID,c==null?void 0:c.webID)),t()},I=()=>{m.usePetProduct(e.requestRoomObjectId,o.webID),t()},p=h.useMemo(()=>{if(!o||!d)return null;const A=new Vo(o.figure),b=d.customParams.split(" "),y=parseInt(b[0]);switch(d.specialType){case Je.PET_SHAMPOO:{if(b.length<2)return null;const M=ce().getPetColorResult(y,A.paletteId),U=ce().getPetColorResultsForTag(y,b[1]);let G=-1;for(const F of U)if(F.breed===M.breed){G=parseInt(F.id);break}return s.jsx(Fn,{typeId:A.typeId,paletteId:G,petColor:A.color,customParts:A.customParts,direction:2})}case Je.PET_CUSTOM_PART:{if(b.length<4)return null;const M=[],U=b[1].split(",").map(v=>parseInt(v)),G=b[2].split(",").map(v=>parseInt(v)),F=b[3].split(",").map(v=>parseInt(v));let H=0;for(;H<U.length;){const v=U[H],B=A.getCustomPart(v);let z=F[H];B!=null&&(z=B.paletteId),M.push(new nf(v,G[H],z)),H++}return s.jsx(Fn,{typeId:A.typeId,paletteId:A.paletteId,petColor:A.color,customParts:M,direction:2})}case Je.PET_CUSTOM_PART_SHAMPOO:{if(b.length<3)return null;const M=[],U=b[1].split(",").map(H=>parseInt(H)),G=b[2].split(",").map(H=>parseInt(H));let F=0;for(;F<U.length;){const H=U[F],v=A.getCustomPart(H);let B=-1;v!=null&&(B=v.partId),M.push(new nf(U[F],B,G[F])),F++}return s.jsx(Fn,{typeId:A.typeId,paletteId:A.paletteId,petColor:A.color,customParts:M,direction:2})}case Je.PET_SADDLE:{if(b.length<4)return null;const M=[],U=b[1].split(",").map(v=>parseInt(v)),G=b[2].split(",").map(v=>parseInt(v)),F=b[3].split(",").map(v=>parseInt(v));let H=0;for(;H<U.length;)M.push(new nf(U[H],G[H],F[H])),H++;for(const v of A.customParts)U.indexOf(v.layerId)===-1&&M.push(v);return s.jsx(Fn,{typeId:A.typeId,paletteId:A.paletteId,petColor:A.color,customParts:M,direction:2})}case Je.MONSTERPLANT_REBREED:case Je.MONSTERPLANT_REVIVAL:case Je.MONSTERPLANT_FERTILIZE:{let M="rip";const U=ce().getRoomObject(m.roomId,o.roomIndex,Q.UNIT);if(U&&(M=U.model.getValue(D.FIGURE_POSTURE),M==="rip")){const G=o.petLevel;G<7?M=`grw${G}`:M="std"}return s.jsx(Fn,{typeId:A.typeId,paletteId:A.paletteId,petColor:A.color,customParts:A.customParts,posture:M,direction:2})}}},[o,d,m]);return h.useEffect(()=>{if(i>0){n(mh);const M=m.userDataManager.getUserDataByIndex(i);u(M)}const A=m.userDataManager.getUserDataByIndex(e.id);l(A);const b=IT(m.roomId,e.requestRoomObjectId,Q.FLOOR);if(!b)return;_(b);let y=Mv;switch(b.specialType){case Je.PET_SHAMPOO:y=jv;break;case Je.PET_CUSTOM_PART:y=Lv;break;case Je.PET_CUSTOM_PART_SHAMPOO:y=Pv;break;case Je.PET_SADDLE:y=Uv;break;case Je.MONSTERPLANT_REVIVAL:y=wv;break;case Je.MONSTERPLANT_REBREED:y=Fv;break;case Je.MONSTERPLANT_FERTILIZE:y=kv;break}n(y)},[m,e]),o?s.jsxs(ve,{className:"nitro-use-product-confirmation",children:[s.jsx(je,{headerText:r===mh?g("breedpets.widget.title"):g("useproduct.widget.title",["name"],[o.name]),onCloseClick:t}),s.jsxs(be,{center:!0,children:[r===mh&&s.jsxs(s.Fragment,{children:[s.jsx(T,{children:g("breedpets.widget.text")}),s.jsx(T,{italics:!0,children:g("breedpets.widget.info")}),s.jsxs(x,{gap:2,overflow:"hidden",children:[s.jsxs(N,{center:!0,children:[s.jsx(T,{children:c==null?void 0:c.name}),s.jsx(q,{pointer:!0,className:"product-preview",onClick:f,children:s.jsx(Fn,{figure:c==null?void 0:c.figure,direction:4})}),s.jsx(T,{children:g("infostand.pet.text.raritylevel",["level"],[(S=c==null?void 0:c.rarityLevel)==null?void 0:S.toString()])}),s.jsx(T,{children:g("infostand.text.petowner",["name"],[(R=c==null?void 0:c.ownerName)==null?void 0:R.toString()])})]}),s.jsxs(N,{center:!0,children:[s.jsx(T,{children:o==null?void 0:o.name}),s.jsx(q,{pointer:!0,className:"product-preview",onClick:f,children:s.jsx(Fn,{figure:o==null?void 0:o.figure,direction:4})}),s.jsx(T,{children:g("infostand.pet.text.raritylevel",["level"],[(O=o==null?void 0:o.rarityLevel)==null?void 0:O.toString()])}),s.jsx(T,{children:g("infostand.text.petowner",["name"],[(C=o==null?void 0:o.ownerName)==null?void 0:C.toString()])})]})]})]}),s.jsxs(x,{gap:2,overflow:"hidden",children:[r!==mh&&s.jsx(N,{children:s.jsx(q,{pointer:!0,className:"product-preview",onClick:f,children:p})}),s.jsxs(N,{justifyContent:"between",overflow:"auto",children:[s.jsxs(N,{gap:2,children:[r===jv&&s.jsxs(s.Fragment,{children:[s.jsx(T,{children:g("useproduct.widget.text.shampoo",["productName"],[d.name])}),s.jsx(T,{children:g("useproduct.widget.info.shampoo")})]}),r===Lv&&s.jsxs(s.Fragment,{children:[s.jsx(T,{children:g("useproduct.widget.text.custompart",["productName"],[d.name])}),s.jsx(T,{children:g("useproduct.widget.info.custompart")})]}),r===Pv&&s.jsxs(s.Fragment,{children:[s.jsx(T,{children:g("useproduct.widget.text.custompartshampoo",["productName"],[d.name])}),s.jsx(T,{children:g("useproduct.widget.info.custompartshampoo")})]}),r===Uv&&s.jsxs(s.Fragment,{children:[s.jsx(T,{children:g("useproduct.widget.text.saddle",["productName"],[d.name])}),s.jsx(T,{children:g("useproduct.widget.info.saddle")})]}),r===wv&&s.jsxs(s.Fragment,{children:[s.jsx(T,{children:g("useproduct.widget.text.revive_monsterplant",["productName"],[d.name])}),s.jsx(T,{children:g("useproduct.widget.info.revive_monsterplant")})]}),r===Fv&&s.jsxs(s.Fragment,{children:[s.jsx(T,{children:g("useproduct.widget.text.rebreed_monsterplant",["productName"],[d.name])}),s.jsx(T,{children:g("useproduct.widget.info.rebreed_monsterplant")})]}),r===kv&&s.jsxs(s.Fragment,{children:[s.jsx(T,{children:g("useproduct.widget.text.fertilize_monsterplant",["productName"],[d.name])}),s.jsx(T,{children:g("useproduct.widget.info.fertilize_monsterplant")})]})]}),s.jsxs(x,{gap:2,alignItems:"center",justifyContent:"between",children:[s.jsx(X,{variant:"danger",onClick:t,children:g("useproduct.widget.cancel")}),s.jsx(X,{variant:"success",onClick:r===mh?E:I,children:g((r===mh?"breedpets":"useproduct")+".widget.use")})]})]})]})]})]}):null},oe=a=>{const{disabled:e=!1,fullWidth:t=!0,justifyContent:i="center",alignItems:r="center",classNames:n=[],onClick:o=null,...l}=a,c=d=>{e||o&&o(d)},u=h.useMemo(()=>{const d=["menu-item","list-item"];return e&&d.push("disabled"),n.length&&d.push(...n),d},[e,n]);return s.jsx(x,{fullWidth:t,justifyContent:i,alignItems:r,classNames:u,onClick:c,...l})},Sle=a=>{const{justifyContent:e="center",alignItems:t="center",classNames:i=[],collapsed:r=!0,...n}=a,o=h.useMemo(()=>{const l=["menu-footer"];return i.length&&l.push(...i),l},[i]);return s.jsxs(x,{justifyContent:e,alignItems:t,classNames:o,...n,children:[!r&&s.jsx(CV,{className:"fa-icon align-self-center"}),r&&s.jsx(Wy,{className:"fa-icon align-self-center"})]})},Rle=25,Gv=3,xle=5e3,Ole=75,fh=10;let Bv=!1;const ma=a=>{const{objectId:e=-1,category:t=-1,objectType:i=-1,fades:r=!1,onClose:n=null,position:o="absolute",classNames:l=[],style:c={},children:u=null,collapsable:d=!1,..._}=a,[m,f]=h.useState({x:null,y:null}),[E,I]=h.useState(1),[p,S]=h.useState(!1),[R,O]=h.useState(Bv),C=h.useRef(),A=h.useRef(null),b=h.useRef(-1e6),y=h.useRef(1),M=h.useCallback(H=>{if(!p)return;y.current+=H;const v=1-y.current/Ole;if(v<=0)return n(),!1;I(v)},[p,n]),U=h.useCallback((H,v)=>{if(!H||!v||!A.current)return;let B=-C.current.offsetHeight;i>-1&&(i===Xt.USER||i===Xt.BOT||i===Xt.RENTABLE_BOT)?B+=H.height>50?15:0:B-=14,A.current.addValue(v.y-H.top);let z=A.current.getMax();z<b.current-Gv&&(z=b.current-Gv),b.current=z;const $=v.y-z;let W=~~(v.x-C.current.offsetWidth/2),V=~~($+B);const se=Oe().width-C.current.offsetWidth-fh,ee=Oe().height-C.current.offsetHeight-fh;W<fh?W=fh:W>se&&(W=se),V<fh?V=fh:V>ee&&(V=ee),f({x:W,y:V})},[i]),G=h.useMemo(()=>{const H=["nitro-context-menu"];return R&&H.push("menu-hidden"),H.push(m.x!==null?"visible":"invisible"),l.length&&H.push(...l),H},[m,l,R]),F=h.useMemo(()=>{let H={left:m.x||0,top:m.y||0,opacity:E};return Object.keys(c).length&&(H={...H,...c}),H},[m,E,c]);return h.useEffect(()=>{if(!C.current)return;const H=v=>{if(!C.current||(M(v),!$e()))return;const B=EN($e().roomId,e,t),z=nk($e().roomId,e,t);U(B,z)};return Gi().add(H),()=>Gi().remove(H)},[e,t,M,U]),h.useEffect(()=>{if(!r)return;const H=setTimeout(()=>S(!0),xle);return()=>clearTimeout(H)},[r]),h.useEffect(()=>{Bv=R},[R]),h.useEffect(()=>{A.current=new C2(Rle),b.current=-1e6,y.current=1},[]),s.jsxs(q,{innerRef:C,position:o,classNames:G,style:F,..._,children:[!(d&&R)&&u,d&&s.jsx(Sle,{onClick:()=>O(!R),collapsed:R})]})},Vv=0,Hv=1,Wv=2,Yv=3,zv=4,Kv=5,qv=6,Xv=7,$v=8,Cle=a=>{const{item:e=null,updateConfirmingProduct:t=null,onClose:i=null}=a,[r,n]=h.useState(0),{roomSession:o=null}=vt(),l=c=>{if(c)switch(c){case"use_product":case"use_product_shampoo":case"use_product_custom_part":case"use_product_custom_part_shampoo":case"use_product_saddle":case"replace_product_saddle":case"revive_monsterplant":case"rebreed_monsterplant":case"fertilize_monsterplant":case"breed":t(e);break}};return h.useEffect(()=>{if(!e)return;let c=Vv;if(e.category===Q.UNIT){const d=ce().getRoomObject(o.roomId,e.requestRoomObjectId,Q.UNIT);if(d&&d.type===Ft.MONSTER_PLANT){c=$v,n(c);return}}const u=IT(o.roomId,e.requestRoomObjectId,Q.FLOOR);if(u){switch(u.specialType){case Je.PET_SHAMPOO:c=Hv;break;case Je.PET_CUSTOM_PART:c=Wv;break;case Je.PET_CUSTOM_PART_SHAMPOO:c=Yv;break;case Je.PET_SADDLE:c=zv;break;case Je.MONSTERPLANT_REVIVAL:c=Kv;break;case Je.MONSTERPLANT_REBREED:c=qv;break;case Je.MONSTERPLANT_FERTILIZE:c=Xv;break}n(c)}},[o,e]),s.jsxs(ma,{objectId:e.id,category:Q.UNIT,objectType:Xt.PET,onClose:i,collapsable:!0,children:[s.jsx(mr,{children:e.name}),r===Vv&&s.jsx(oe,{onClick:c=>l("use_product"),children:g("infostand.button.useproduct")}),r===$v&&s.jsx(oe,{onClick:c=>l("breed"),children:g("breedpets.widget.use")}),r===Hv&&s.jsx(oe,{onClick:c=>l("use_product_shampoo"),children:g("infostand.button.useproduct_shampoo")}),r===Wv&&s.jsx(oe,{onClick:c=>l("use_product_custom_part"),children:g("infostand.button.useproduct_custom_part")}),r===Yv&&s.jsx(oe,{onClick:c=>l("use_product_custom_part_shampoo"),children:g("infostand.button.useproduct_custom_part_shampoo")}),r===zv&&s.jsxs(s.Fragment,{children:[e.replace&&s.jsx(oe,{onClick:c=>l("replace_product_saddle"),children:g("infostand.button.replaceproduct_saddle")}),!e.replace&&s.jsx(oe,{onClick:c=>l("use_product_saddle"),children:g("infostand.button.useproduct_saddle")})]}),r===Kv&&s.jsx(oe,{onClick:c=>l("revive_monsterplant"),children:g("infostand.button.revive_monsterplant")}),r===qv&&s.jsx(oe,{onClick:c=>l("rebreed_monsterplant"),children:g("infostand.button.rebreed_monsterplant")}),r===Xv&&s.jsx(oe,{onClick:c=>l("fertilize_monsterplant"),children:g("infostand.button.fertilize_monsterplant")})]})},Nle=a=>{const{avatarInfo:e=null,onClose:t=null,setOpen:i=null,open:r=!1}=a,{isMobile:n}=Ia();return e?s.jsx(N,{className:"nitro-infostand rounded",children:s.jsxs(x,{children:[n&&s.jsx(x,{alignItems:"center",className:"mobile-toggle-info-widget",onClick:()=>i(!r),children:r?s.jsx(_s,{className:"fa-icon"}):s.jsx(ds,{className:"fa-icon"})}),s.jsxs(N,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[s.jsx(T,{variant:"white",small:!0,wrap:!0,children:e.name}),s.jsx(pr,{className:"cursor-pointer fa-icon",onClick:t})]}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{gap:1,children:[s.jsx(N,{fullWidth:!0,className:"body-image bot",children:s.jsx(ls,{figure:e.figure,direction:4})}),s.jsx(N,{grow:!0,center:!0,gap:0,children:e.badges.length>0&&e.badges.map(o=>s.jsx(as,{badgeCode:o,showInfo:!0},o))})]}),s.jsx("hr",{className:"m-0"})]}),s.jsx(x,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:s.jsx(T,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:e.motto})}),e.carryItem>0&&s.jsxs(N,{gap:1,children:[s.jsx("hr",{className:"m-0"}),s.jsx(T,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.handitem",["item"],[g("handitem"+e.carryItem)])})]})]})]})}):null},Ale=()=>br(tr.FURNITURE_FURNI_DETAILS,!1),CB=()=>Ht(Ale),oS=0,Qv=1,Jv=2,ble=[{type:"Normal",value:0},{type:"Adição",value:1},{type:"Subtração",value:28},{type:"Multiplicação",value:2},{type:"Divisão",value:3},{type:"Sobrepor",value:4},{type:"Luz Direta",value:10},{type:"Luz Indireta",value:9},{type:"Origem Dentro",value:21},{type:"Origem Fora",value:22},{type:"Origem Sobreposta",value:23},{type:"Destino Sobre",value:24},{type:"Destino Dentro",value:25},{type:"Destino Fora",value:26},{type:"Destino Sobreposto",value:27},{type:"Diferenciação (XOR)",value:29}],vle=a=>{const{avatarInfo:e=null,onClose:t=null,setOpen:i=null,open:r=!1}=a,{roomSession:n=null}=vt(),[o,l]=h.useState(0),[c,u]=h.useState(!1),[d,_]=h.useState(!1),[m,f]=h.useState(!0),[E,I]=h.useState([]),[p,S]=h.useState([]),[R,O]=h.useState([]),[C,A]=h.useState([]),[b,y]=h.useState(!1),[M,U]=h.useState(0),[G,F]=h.useState(0),[H,v]=h.useState(!1),[B,z]=h.useState(!1),[$,W]=h.useState(null),[V,se]=h.useState(!1),[ee,ie]=h.useState(!1),[Z,ne]=h.useState(-1),[_e,de]=h.useState(""),[me,fe]=h.useState(""),[ae,Te]=h.useState(0),[Se,Le]=h.useState(0),[Et,ri]=h.useState(0),[ni,gt]=h.useState(0),[yt,ws]=h.useState(0),[Jn,Uc]=h.useState(!1),[yi,Ze]=h.useState(!1),{isMobile:ht}=Ia(),{wiredInspectButton:Wi,playTestMode:Cs}=Tn(),[js]=CB(),{showConfirm:Ll=null}=kt(),Pl=h.useCallback(()=>{ce().processRoomObjectPlacement(zn.INFO_STAND,-e.purchaseOfferId,e.category,e.classId,e.extraParam)},[e]);Zc(Po.NPE_SONG_CHANGED,Pe=>{ne(Pe.id)},V||ee),Zc(sh.SIR_TRAX_SONG_INFO_RECEIVED,Pe=>{if(Pe.id!==Z)return;const Dt=Oe().soundManager.musicController.getSongInfo(Pe.id);Dt&&(de(Dt.name),fe(Dt.creator))},V||ee),ut(Tf.PLACED,Pe=>{if(Pe.objectPlacementSource===zn.INFO_STAND&&Pe.placedInRoom){switch(Pe.category){case Q.FLOOR:if(!Pe.placedOnFloor)return;K(new YC(-1,e.classId,e.extraParam,Pe.x,Pe.y,Pe.direction));break;case Q.WALL:if(!Pe.placedOnWall)return;K(new zC(-1,e.classId,e.extraParam,Pe.wallLocation));break}Pl()}});const zo=h.useCallback(()=>{if(!e)return;const Pe=ce().getRoomObject($e().roomId,e.id,e.category);Pe&&(Te(Pe.location.x),Le(Pe.location.y),ri(Pe.location.z),gt(Pe.direction.x%360/45),ws(Pe.getState()),Uc(!0),Ze(e.isWallItem))},[e]);h.useEffect(()=>{let Pe=oS,Dt=!1,he=!1,pe=!1,Ne=[],Xe=[],xt=[],cs=[],ai=!1,Tt=0,Lr=0,Am=!1,LA=!1,PA=!1,UA=!1,wT=-1;const bm=e.roomControllerLevel>=pt.USER_WITH_RIGHTS;if((bm||e.isOwner||e.isRoomOwner||e.isAnyRoomController)&&(Dt=!0,he=!e.isWallItem,e.canEditAds&&(Am=!0)),e.isAnyRoomController&&(LA=!0),(e.usagePolicy===ff.EVERYBODY||e.usagePolicy===ff.CONTROLLER&&bm||e.extraParam===hi.JUKEBOX&&bm||e.extraParam===hi.USABLE_PRODUCT&&bm)&&(pe=!0),e.extraParam){if(e.extraParam===hi.CRACKABLE_FURNI){const Zn=e.stuffData;pe=!0,ai=!0,Tt=Zn.hits,Lr=Zn.target}else if(e.extraParam===hi.JUKEBOX){const Zn=Oe().soundManager.musicController.getRoomItemPlaylist();Zn&&(wT=Zn.nowPlayingSongId),PA=!0}else e.extraParam.indexOf(hi.SONGDISK)===0&&(wT=parseInt(e.extraParam.substr(hi.SONGDISK.length)),UA=!0);if(Am){const Zn=e.extraParam.substr(hi.BRANDING_OPTIONS.length);if(Zn){const i_=Zn.split("	");for(const FT of i_){const kc=FT.split("=");kc&&kc.length===2&&(Ne.push(kc[0]),Xe.push(kc[1]))}}}}if(Am){const Zn=ce().getRoomObject(n.roomId,e.id,e.isWallItem?Q.WALL:Q.FLOOR);if(Zn){const i_=Zn.model.getValue(D.FURNITURE_CUSTOM_VARIABLES),FT=Zn.model.getValue(D.FURNITURE_DATA);if(i_&&i_.length)for(const kc of i_)xt.push(kc),cs.push(FT[kc]||"")}}e.isOwner||e.isAnyRoomController?Pe=Jv:(e.isRoomOwner||e.roomControllerLevel>=pt.GUILD_ADMIN)&&(Pe=Qv),e.isStickie&&(Pe=oS),l(Cs?0:Pe),u(Dt&&!Cs),_(he&&!Cs),f(pe),I(Ne),S(Xe),O(xt),A(cs),y(ai),U(Tt),F(Lr),v(Am),z(LA),W(null),se(PA),ie(UA),ne(wT),e.groupId&&K(new Pd(e.groupId,!1)),zo()},[n,e,zo,Cs]),J(Xd,Pe=>{const Dt=Pe.getParser();!e||e.groupId!==Dt.id||Dt.flag||($&&W(null),W(Dt.title))}),h.useEffect(()=>{const Pe=Oe().soundManager.musicController.getSongInfo(Z);de((Pe==null?void 0:Pe.name)??""),fe((Pe==null?void 0:Pe.creator)??"")},[Z]);const s_=h.useCallback((Pe,Dt)=>{const he=Array.from(p);he[Pe]=Dt,S(he)},[p]),Cm=h.useCallback((Pe,Dt)=>{const he=Array.from(C);he[Pe]=Dt,A(he)},[C]),Nm=h.useCallback(()=>{if(E.length===0||p.length===0)return"";let Pe="",Dt=0;for(;Dt<E.length;){const he=E[Dt],pe=p[Dt];Pe=Pe+(he+"="+pe+"	"),Dt++}return Pe},[E,p]),Pi=h.useCallback(Pe=>{if(!(!Pe||Pe==="")){switch(Pe){case"buy_one":Ce(`catalog/open/offerId/${e.purchaseOfferId}`);return;case"place_furni":Pl();return;case"move":ce().processRoomObjectOperation(e.id,e.category,at.OBJECT_MOVE);break;case"rotate":ce().processRoomObjectOperation(e.id,e.category,at.OBJECT_ROTATE_POSITIVE);break;case"pickup":o===Jv?Rk()?Ll(g("help.pickup.all.body"),()=>{ce().processRoomObjectOperation(e.id,e.category,at.OBJECT_PICKUP)},null,null,null,g("help.pickup.all.title")):ce().processRoomObjectOperation(e.id,e.category,at.OBJECT_PICKUP):ce().processRoomObjectOperation(e.id,e.category,at.OBJECT_EJECT);break;case"use":ce().useRoomObject(e.id,e.category);break;case"inspect":Ce("wiredmenu/open/variable_inspection/0/"+e.id);break;case"save_branding_configuration":{const Dt=new Map,he=Nm().split("	");if(he)for(const pe of he){const[Ne,Xe]=pe.split("=",2);Dt.set(Ne,Xe)}ce().modifyRoomObjectDataWithMap(e.id,e.category,at.OBJECT_SAVE_STUFF_DATA,Dt);break}case"save_custom_variables":{const Dt=new Map;for(let he=0;he<R.length;he++){const pe=R[he],Ne=C[he];pe&&pe.length&&Ne&&Ne.length&&Dt.set(pe,Ne)}K(new aN(e.id,Dt));break}}zo()}},[zo,e.purchaseOfferId,e.id,e.category,Pl,o,Ll,Nm,R,C]),wc=h.useCallback(()=>{const Pe=e.stuffData;return!Pe||!(Pe instanceof qa)?null:Pe.getValue(2)},[e]),Fc=(Pe,Dt,he,pe)=>{K(new Ud(Pe,Dt,he,pe))};return e?s.jsxs(N,{gap:1,alignItems:"end",children:[s.jsx(N,{className:"nitro-infostand rounded",children:s.jsxs(x,{children:[ht&&s.jsx(x,{alignItems:"center",className:"mobile-toggle-info-widget",onClick:()=>i(!r),children:r?s.jsx(_s,{className:"fa-icon"}):s.jsx(ds,{className:"fa-icon"})}),s.jsxs(N,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[s.jsx(T,{variant:"white",small:!0,wrap:!0,children:e.name}),s.jsx(pr,{className:"cursor-pointer fa-icon",onClick:t})]}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{position:"relative",gap:1,children:[e.stuffData.isUnique&&s.jsx("div",{className:"position-absolute end-0",style:{zIndex:2},children:s.jsx(LG,{uniqueNumber:e.stuffData.uniqueNumber,uniqueSeries:e.stuffData.uniqueSeries})}),e.stuffData.rarityLevel>-1&&s.jsx("div",{className:"position-absolute end-0",style:{zIndex:2},children:s.jsx(UN,{level:e.stuffData.rarityLevel})}),e.image&&e.image.src.length&&s.jsx("img",{className:"d-block mx-auto",src:e.image.src,alt:""})]}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,children:e.description}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(Xn,{userId:e.ownerId}),s.jsx(T,{variant:"white",small:!0,wrap:!0,center:!0,children:e.ownerName})]}),e.purchaseOfferId>0&&s.jsxs(x,{gap:2,children:[!e.stuffData.isUnique&&!e.extraParam.length&&(c||H)&&!Cs&&s.jsxs(X,{gap:1,variant:"white",onClick:Pe=>Pi("place_furni"),style:{height:"18px",padding:"0 5px"},children:[s.jsx("i",{className:"icon furni-place"}),g("infostand.button.place_furni")]}),s.jsxs(X,{gap:1,variant:"white",onClick:Pe=>Pi("buy_one"),style:{height:"18px",padding:"0 5px"},children:[s.jsx("i",{className:"icon furni-shop"}),g("infostand.button.buy")]})]})]}),(V||ee)&&s.jsxs(N,{gap:1,children:[s.jsx("hr",{className:"m-0"}),Z===-1&&s.jsx(T,{variant:"white",small:!0,wrap:!0,children:g("infostand.jukebox.text.not.playing")}),!!_e.length&&s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(q,{className:"icon disk-icon"}),s.jsx(T,{variant:"white",small:!0,wrap:!0,children:_e})]}),!!me.length&&s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(q,{className:"icon disk-creator"}),s.jsx(T,{variant:"white",small:!0,wrap:!0,children:me})]})]}),s.jsxs(N,{gap:1,children:[b&&G&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"m-0"}),s.jsx(T,{variant:"white",small:!0,wrap:!0,children:g("infostand.crackable_furni.hits_remaining",["hits","target"],[M.toString(),G.toString()])})]}),e.groupId>0&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"m-0"}),s.jsxs(x,{pointer:!0,alignItems:"center",gap:2,onClick:()=>Qd(e.groupId),children:[s.jsx(as,{badgeCode:wc(),isGroup:!0}),s.jsx(T,{variant:"white",underline:!0,children:$})]})]}),H&&!Cs&&s.jsx(s.Fragment,{children:E.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"m-0"}),s.jsx(N,{gap:1,children:E.map((Pe,Dt)=>Pe==="blendMode"?s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:Pe}),s.jsx("select",{className:"form-select form-select-sm",value:p[Dt],onChange:he=>s_(Dt,he.target.value),children:ble.map(he=>s.jsx("option",{value:he.value,children:he.type},he.type))})]},Dt):s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:Pe}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:p[Dt],onChange:he=>s_(Dt,he.target.value)})]},Dt))})]})}),R.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"m-0 my-1"}),s.jsx(N,{gap:1,children:R.map((Pe,Dt)=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(T,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:Pe}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:C[Dt],onChange:he=>Cm(Dt,he.target.value)})]},Dt))})]}),s.jsx("hr",{className:"m-0"}),Jn&&js&&s.jsxs(s.Fragment,{children:[s.jsxs(x,{justifyContent:"between",children:[s.jsxs(x,{gap:1,title:`Posição X : ${ae}`,children:[s.jsx("div",{className:"icon furni-details-x"}),s.jsx(T,{small:!0,wrap:!0,variant:"white",children:": "}),s.jsx("input",{disabled:!c||ht,className:"furni-details-input",type:"number",value:ae,max:100,min:1,onChange:Pe=>{Te(parseInt(Pe.target.value)),Fc(e.id,parseInt(Pe.target.value),Se,ni)}})]}),s.jsxs(x,{gap:1,title:`Rotação : ${ni}`,children:[s.jsx("input",{disabled:!c||ht,className:"furni-details-input invert-text",type:"number",value:ni,max:7,min:0,onChange:Pe=>{gt(parseInt(Pe.target.value)),Fc(e.id,ae,Se,parseInt(Pe.target.value))}}),s.jsx(T,{small:!0,wrap:!0,variant:"white",children:" :"}),s.jsx("div",{className:"icon furni-details-r"})]})]}),s.jsxs(x,{justifyContent:"between",children:[s.jsxs(x,{gap:1,title:`Posição Y : ${Se}`,children:[s.jsx("div",{className:"icon furni-details-y"}),s.jsx(T,{small:!0,wrap:!0,variant:"white",children:": "}),s.jsx("input",{disabled:!c||ht,className:"furni-details-input",type:"number",value:Se,max:100,min:1,onChange:Pe=>{Le(parseInt(Pe.target.value)),Fc(e.id,ae,parseInt(Pe.target.value),ni)}})]}),s.jsxs(x,{gap:1,title:`Estado Atual : ${yt}`,children:[s.jsx(T,{small:!0,wrap:!0,variant:"white",children:`${yt} :`}),s.jsx("div",{className:"icon furni-details-state"})]})]}),s.jsxs(x,{justifyContent:"between",children:[s.jsxs(x,{gap:1,title:`Posição Z : ${Et}`,children:[s.jsx("div",{className:"icon furni-details-z"}),s.jsx(T,{small:!0,wrap:!0,variant:"white",children:": "}),s.jsx("input",{disabled:!c||ht,className:"furni-details-input",type:"number",value:Et,max:100,min:-100,onChange:Pe=>ri(parseInt(Pe.target.value))})]}),s.jsxs(x,{gap:1,children:[s.jsx(T,{small:!0,wrap:!0,variant:"white",title:`ID: ${e.id}`,children:`${e.id} :`}),s.jsx("div",{className:"icon furni-details-id"})]})]})]}),yi&&s.jsx(x,{fullWidth:!0,center:!0,children:s.jsxs(X,{onClick:()=>Ce("wall-editor/show"),variant:"gray",children:[s.jsx("i",{className:"icon icon-tools",style:{marginRight:"5px",marginTop:"-5px"}}),s.jsx(T,{variant:"white",children:g("wall-editor.title")})]})})]})]})]})}),s.jsxs(x,{gap:1,justifyContent:"end",children:[c&&s.jsx(X,{variant:"dark",onClick:Pe=>Pi("move"),children:s.jsx(T,{variant:"white",children:g("infostand.button.move")})}),d&&s.jsx(X,{variant:"dark",onClick:Pe=>Pi("rotate"),children:s.jsx(T,{variant:"white",children:g("infostand.button.rotate")})}),o!==oS&&s.jsx(X,{variant:"dark",onClick:Pe=>Pi("pickup"),children:s.jsx(T,{variant:"white",children:g(o===Qv?"infostand.button.eject":"infostand.button.pickup")})}),s.jsx(X,{variant:"dark",onClick:Pe=>Pi("use"),children:s.jsx(T,{variant:"white",children:g("infostand.button.use")})}),Wi&&s.jsx(X,{variant:"dark",onClick:Pe=>Pi("inspect"),children:s.jsx(T,{variant:"white",children:g("wiredmenu.inspect")})}),E.length>0&&p.length>0&&E.length===p.length&&s.jsx(X,{variant:"dark",onClick:()=>Pi("save_branding_configuration"),children:s.jsx(T,{variant:"white",children:g("save")})}),R.length>0&&C.length>0&&R.length===C.length&&s.jsx(X,{variant:"dark",onClick:()=>Pi("save_custom_variables"),children:s.jsx(T,{variant:"white",children:g("save")})})]})]}):null},yle=a=>{const{avatarInfo:e=null,onClose:t=null,setOpen:i=null,open:r=!1}=a,[n,o]=h.useState(0),[l,c]=h.useState(0),{roomSession:u=null}=vt(),{petRespectRemaining:d=0,respectPet:_=null}=Ja(),{isMobile:m}=Ia();if(h.useEffect(()=>{o(e.remainingGrowTime),c(e.remainingTimeToLive)},[e]),h.useEffect(()=>{if(e.petType!==ui.MONSTERPLANT||e.dead)return;const E=setInterval(()=>{o(I=>I-1),c(I=>I-1)},1e3);return()=>clearInterval(E)},[e]),!e)return null;const f=E=>{let I=!0;if(!(!E||E=="")){switch(E){case"respect":_(e.id),d-1>=1&&(I=!1);break;case"buyfood":Ce("catalog/open/"+xe("catalog.links")["pets.buy_food"]);break;case"train":u==null||u.requestPetCommands(e.id);break;case"treat":K(new gm(e.id));break;case"compost":u==null||u.compostPlant(e.id);break;case"pick_up":u==null||u.pickupPet(e.id);break}I&&t()}};return s.jsxs(N,{gap:1,alignItems:"end",children:[s.jsx(N,{className:"nitro-infostand rounded",children:s.jsxs(x,{children:[m&&s.jsx(x,{alignItems:"center",className:"mobile-toggle-info-widget",onClick:()=>i(!r),children:r?s.jsx(_s,{className:"fa-icon"}):s.jsx(ds,{className:"fa-icon"})}),s.jsxs(N,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[s.jsx(T,{variant:"white",small:!0,wrap:!0,children:e.name}),s.jsx(pr,{className:"cursor-pointer fa-icon",onClick:t})]}),s.jsx(T,{variant:"white",small:!0,wrap:!0,children:g(`pet.breed.${e.petType}.${e.petBreed}`)}),s.jsx("hr",{className:"m-0"})]}),e.petType===ui.MONSTERPLANT&&s.jsxs(s.Fragment,{children:[s.jsxs(N,{center:!0,gap:1,children:[s.jsx(Fn,{figure:e.petFigure,posture:e.posture,direction:4}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:2,children:[!e.dead&&s.jsx(N,{alignItems:"center",gap:1,children:s.jsx(T,{variant:"white",center:!0,small:!0,wrap:!0,children:g("pet.level",["level","maxlevel"],[e.level.toString(),e.maximumLevel.toString()])})}),s.jsxs(N,{alignItems:"center",gap:1,children:[s.jsx(T,{variant:"white",small:!0,truncate:!0,children:g("infostand.pet.text.wellbeing")}),s.jsxs(q,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[s.jsx(x,{fit:!0,center:!0,position:"absolute",children:s.jsx(T,{variant:"white",small:!0,children:e.dead?"00:00:00":Bc(l==0?e.remainingTimeToLive:l).split(":")[1]+":"+Bc(l==null||l==null?0:l).split(":")[2]+":"+Bc(l==null||l==null?0:l).split(":")[3]})}),s.jsx(q,{className:"bg-success rounded pet-stats",style:{width:e.dead?"0":Math.round(e.maximumTimeToLive*100/l).toString()}})]})]}),n!=0&&n>0&&s.jsxs(N,{alignItems:"center",gap:1,children:[s.jsx(T,{variant:"white",small:!0,truncate:!0,children:g("infostand.pet.text.growth")}),s.jsx(vte,{className:"top-2 end-2",day:Bc(n).split(":")[0],hour:Bc(n).split(":")[1],minutes:Bc(n).split(":")[2],seconds:Bc(n).split(":")[3]})]}),s.jsxs(N,{alignItems:"center",gap:1,children:[s.jsx(T,{variant:"white",small:!0,truncate:!0,children:g("infostand.pet.text.raritylevel",["level"],[g(`infostand.pet.raritylevel.${e.rarityLevel}`)])}),s.jsx(UN,{className:"top-2 end-2",level:e.rarityLevel})]}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{variant:"white",small:!0,wrap:!0,children:g("pet.age",["age"],[e.age.toString()])}),s.jsx("hr",{className:"m-0"})]})]}),e.petType!==ui.MONSTERPLANT&&s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsxs(x,{gap:1,children:[s.jsx(N,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:s.jsx(Fn,{figure:e.petFigure,posture:e.posture,direction:4})}),s.jsxs(N,{grow:!0,gap:1,children:[s.jsx(T,{variant:"white",center:!0,small:!0,wrap:!0,children:g("pet.level",["level","maxlevel"],[e.level.toString(),e.maximumLevel.toString()])}),s.jsxs(N,{alignItems:"center",gap:1,children:[s.jsx(T,{variant:"white",small:!0,truncate:!0,children:g("infostand.pet.text.happiness")}),s.jsxs(q,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[s.jsx(x,{fit:!0,center:!0,position:"absolute",children:s.jsx(T,{variant:"white",small:!0,children:e.happyness+"/"+e.maximumHappyness})}),s.jsx(q,{className:"bg-info rounded pet-stats",style:{width:e.happyness/e.maximumHappyness*100+"%"}})]})]}),s.jsxs(N,{alignItems:"center",gap:1,children:[s.jsx(T,{variant:"white",small:!0,truncate:!0,children:g("infostand.pet.text.experience")}),s.jsxs(q,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[s.jsx(x,{fit:!0,center:!0,position:"absolute",children:s.jsx(T,{variant:"white",small:!0,children:e.experience+"/"+e.levelExperienceGoal})}),s.jsx(q,{className:"bg-purple rounded pet-stats",style:{width:e.experience/e.levelExperienceGoal*100+"%"}})]})]}),s.jsxs(N,{alignItems:"center",gap:1,children:[s.jsx(T,{variant:"white",small:!0,truncate:!0,children:g("infostand.pet.text.energy")}),s.jsxs(q,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[s.jsx(x,{fit:!0,center:!0,position:"absolute",children:s.jsx(T,{variant:"white",small:!0,children:e.energy+"/"+e.maximumEnergy})}),s.jsx(q,{className:"bg-success rounded pet-stats",style:{width:e.energy/e.maximumEnergy*100+"%"}})]})]})]})]}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:1,children:[e.petType!==ui.MONSTERPLANT&&s.jsx(T,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.petrespect",["count"],[e.respect.toString()])}),s.jsx(T,{variant:"white",small:!0,wrap:!0,children:g("pet.age",["age"],[e.age.toString()])}),s.jsx("hr",{className:"m-0"})]})]}),s.jsx(N,{gap:1,children:s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(Xn,{userId:e.ownerId}),s.jsx(T,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.petowner",["name"],[e.ownerName])})]})})]})]})}),s.jsxs(x,{gap:1,justifyContent:"end",children:[e.petType!==ui.MONSTERPLANT&&s.jsx(X,{variant:"dark",onClick:E=>f("buyfood"),children:g("infostand.button.buyfood")}),e.isOwner&&e.petType!==ui.MONSTERPLANT&&s.jsx(X,{variant:"dark",onClick:E=>f("train"),children:g("infostand.button.train")}),!e.dead&&e.energy/e.maximumEnergy<.98&&e.petType===ui.MONSTERPLANT&&s.jsx(X,{variant:"dark",onClick:E=>f("treat"),children:g("infostand.button.pettreat")}),(u==null?void 0:u.isRoomOwner)&&e.petType===ui.MONSTERPLANT&&s.jsx(X,{variant:"dark",onClick:E=>f("compost"),children:g("infostand.button.compost")}),e.isOwner&&s.jsx(X,{variant:"dark",onClick:E=>f("pick_up"),children:g("inventory.pets.pickup")}),d>0&&e.petType!==ui.MONSTERPLANT&&s.jsx(X,{variant:"dark",onClick:E=>f("respect"),children:g("infostand.button.petrespect",["count"],[d.toString()])})]})]})},Dle=a=>{const{avatarInfo:e=null,onClose:t=null,setOpen:i=null,open:r=!1}=a,{isMobile:n}=Ia(),o=h.useMemo(()=>!(e.botSkills.indexOf(Rs.NO_PICK_UP)>=0||!e.amIOwner&&!e.amIAnyRoomController),[e]),l=()=>K(new fT(e.webID));if(e)return s.jsxs(N,{gap:1,children:[s.jsx(N,{className:"nitro-infostand rounded",children:s.jsxs(x,{children:[n&&s.jsx(x,{alignItems:"center",className:"mobile-toggle-info-widget",onClick:()=>i(!r),children:r?s.jsx(_s,{className:"fa-icon"}):s.jsx(ds,{className:"fa-icon"})}),s.jsxs(N,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[s.jsx(T,{variant:"white",small:!0,wrap:!0,children:e.name}),s.jsx(pr,{className:"cursor-pointer fa-icon",onClick:t})]}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{gap:1,children:[s.jsx(N,{fullWidth:!0,className:"body-image bot",children:s.jsx(ls,{figure:e.figure,direction:4})}),s.jsx(N,{grow:!0,center:!0,gap:0,children:e.badges.length>0&&e.badges.map(c=>s.jsx(as,{badgeCode:c,showInfo:!0},c))})]}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:1,children:[s.jsx(x,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:s.jsx(T,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:e.motto})}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(Xn,{userId:e.ownerId}),s.jsx(T,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.botowner",["name"],[e.ownerName])})]}),e.carryItem>0&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"m-0"}),s.jsx(T,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.handitem",["item"],[g("handitem"+e.carryItem)])})]})]})]})]})}),o&&s.jsx(x,{justifyContent:"end",children:s.jsx(X,{variant:"dark",onClick:l,children:g("infostand.button.pickup")})})]})},Wm=a=>{const{type:e=-1,relationship:t=null}=a;if(!t)return null;const i=_r.RELATIONSHIP_NAMES[e].toLocaleLowerCase();return s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("i",{className:`nitro-friends-spritesheet icon-${i}`}),s.jsx(x,{alignItems:"center",gap:0,children:s.jsxs(T,{small:!0,variant:"white",onClick:r=>ir(t.randomFriendId),children:[s.jsx("u",{children:t.randomFriendName}),t.friendCount>1&&" "+g(`extendedprofile.relstatus.others.${i}`,["count"],[(t.friendCount-1).toString()])]})})]})},Mle=a=>{const{relationships:e=null}=a;return!e||!e.relationshipStatusMap.length?null:s.jsxs(s.Fragment,{children:[s.jsx(Wm,{type:_r.HEART,relationship:e.relationshipStatusMap.getValue(_r.HEART)}),s.jsx(Wm,{type:_r.SMILE,relationship:e.relationshipStatusMap.getValue(_r.SMILE)}),s.jsx(Wm,{type:_r.BOBBA,relationship:e.relationshipStatusMap.getValue(_r.BOBBA)}),s.jsx(Wm,{type:_r.POOP,relationship:e.relationshipStatusMap.getValue(_r.POOP)})]})},jle=a=>{Ce(`navigator/search/${a}`),K(new Ku("hotel_view",`tag:${a}`))},Lle=a=>{const{tags:e=null}=a;return!e||!e.length?null:s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"m-0"}),s.jsx(x,{className:"flex-tags",children:e&&e.length>0&&e.map((t,i)=>s.jsx(T,{variant:"white",className:"text-tags",onClick:r=>jle(t),children:t},i))})]})},Ple=a=>{const{avatarInfo:e=null,setAvatarInfo:t=null,onClose:i=null,setOpen:r=null,open:n=!1}=a,[o,l]=h.useState(null),[c,u]=h.useState(!1),[d,_]=h.useState(null),{roomSession:m=null}=vt(),{isMobile:f}=Ia(),E=S=>{!c||S.length>64||(m.sendMottoMessage(S),u(!1))},I=S=>E(S.target.value),p=S=>{switch(S.stopPropagation(),S.key){case"Enter":E(S.target.value);return}};return ms(vf.RSUBE_BADGES,S=>{!e||e.webID!==S.userId||e.badges.join("")===S.badges.join("")||t(O=>{const C=Dr(O);return C.badges=S.badges,C})}),ms(Df.USER_FIGURE,S=>{!e||e.roomIndex!==S.roomIndex||t(R=>{const O=Dr(R);return O.figure=S.figure,O.motto=S.customInfo,O.achievementScore=S.activityPoints,O})}),ms(Of.FAVOURITE_GROUP_UPDATE,S=>{!e||e.roomIndex!==S.roomIndex||t(R=>{const O=Dr(R),C=S.status===-1||S.habboGroupId<=0;return O.groupId=C?-1:S.habboGroupId,O.groupName=C?null:S.habboGroupName,O.groupBadgeId=C?null:te().getGroupBadge(S.habboGroupId),O})}),J(UC,S=>{const R=S.getParser();!e||e.webID!==R.userId||_(R)}),h.useEffect(()=>(u(!1),l(e.motto),K(new mN(e.webID)),()=>{u(!1),l(null),_(null)}),[e]),e?s.jsx(N,{className:"nitro-infostand rounded",children:s.jsxs(x,{children:[f&&s.jsx(x,{alignItems:"center",className:"mobile-toggle-info-widget",onClick:()=>r(!n),children:n?s.jsx(_s,{className:"fa-icon"}):s.jsx(ds,{className:"fa-icon"})}),s.jsxs(N,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(Xn,{userId:e.webID}),s.jsx(T,{variant:"white",small:!0,wrap:!0,dangerouslySetInnerHTML:{__html:e.coloredName}})]}),s.jsx(pr,{className:"cursor-pointer fa-icon",onClick:i})]}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{gap:1,children:[s.jsx(N,{fullWidth:!0,className:"body-image",onClick:S=>ir(e.webID),children:s.jsx(ls,{figure:e.figure,direction:4})}),s.jsx(N,{grow:!0,alignItems:"center",gap:0,children:e.groupId>0?s.jsxs(s.Fragment,{children:[s.jsxs(x,{gap:1,children:[s.jsx(x,{center:!0,className:"badge-image",children:e.badges[0]&&s.jsx(as,{badgeCode:e.badges[0],showInfo:!0})}),s.jsx(x,{center:!0,pointer:!0,className:"badge-image",onClick:()=>Qd(e.groupId),children:s.jsx(as,{badgeCode:e.groupBadgeId,isGroup:!0,showInfo:!0,customTitle:e.groupName})})]}),s.jsx(x,{center:!0,gap:1,children:[1,2].map(S=>s.jsx(x,{center:!0,className:"badge-image",children:e.badges[S]&&s.jsx(as,{badgeCode:e.badges[S],showInfo:!0})},S))}),s.jsx(x,{center:!0,gap:1,children:[3,4].map(S=>s.jsx(x,{center:!0,className:"badge-image",children:e.badges[S]&&s.jsx(as,{badgeCode:e.badges[S],showInfo:!0})},S))})]}):s.jsx(s.Fragment,{children:[0,2,4].map((S,R)=>s.jsx(x,{center:!0,gap:1,children:[S,S+1].map(O=>s.jsx(x,{center:!0,className:"badge-image",children:e.badges[O]&&s.jsx(as,{badgeCode:e.badges[O],showInfo:!0})},O))},R))})})]}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:[e.type!==$s.OWN_USER&&s.jsx(x,{grow:!0,alignItems:"center",children:s.jsx(T,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",className:"motto-content",onClick:S=>navigator.clipboard.writeText(o),children:o})}),e.type===$s.OWN_USER&&s.jsxs(x,{grow:!0,alignItems:"center",gap:2,children:[s.jsx(NV,{className:"small fa-icon"}),s.jsxs(x,{grow:!0,alignItems:"center",children:[!c&&s.jsxs(T,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",className:"motto-content",onClick:S=>u(!0),children:[o," "]}),c&&s.jsx("input",{type:"text",className:"motto-input",maxLength:64,value:o,onChange:S=>l(S.target.value),onBlur:I,onKeyDown:p,autoFocus:!0})]})]})]}),s.jsx("hr",{className:"m-0"})]}),s.jsxs(N,{gap:1,children:[e.nick&&e.nick.length>0&&s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("i",{className:"icon icon-id cursor-pointer",title:g("infostand.text.nickname_info")}),s.jsx(T,{variant:"white",small:!0,wrap:!0,dangerouslySetInnerHTML:{__html:e.name}})]}),s.jsx(T,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.achievement_score")+" "+e.achievementScore}),e.carryItem>0&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"m-0"}),s.jsx(T,{variant:"white",small:!0,wrap:!0,children:g("infostand.text.handitem",["item"],[g("handitem"+e.carryItem)])})]})]}),s.jsx(N,{gap:1,children:s.jsx(Mle,{relationships:d})}),xe("user.tags.enabled")&&s.jsx(N,{gap:1,className:"mt-1",children:s.jsx(Lle,{tags:te().tags})})]})]})}):null},Ym=0,lS=1,Zv=2,ey=3,cS=4,ty=5,sy=6,iy=7,ry=8,Ule=a=>{const{avatarInfo:e=null,onClose:t=null}=a,[i,r]=h.useState(Ym),{canRequestFriend:n=null}=Jr(),{report:o=null}=Rn(),{roomSession:l=null,groupWhisper:c=[],setGroupWhisper:u=null}=vt(),{userRespectRemaining:d=0,respectUser:_=null,userKissRemaining:m=0,kissUser:f=null,starGem:E=null}=Ja(),{wiredInspectButton:I,setJumpingToInspectId:p,setJumpToInspectUser:S}=Tn(),R=h.useMemo(()=>e.amIOwner&&e.targetRoomControllerLevel<pt.USER_WITH_RIGHTS&&!e.isGuildRoom,[e]),O=h.useMemo(()=>e.amIOwner&&e.targetRoomControllerLevel===pt.USER_WITH_RIGHTS&&!e.isGuildRoom,[e]),C=h.useMemo(()=>e.canBeKicked||e.canBeBanned||e.canBeMuted||R||O,[R,O,e]),A=h.useMemo(()=>{let y=!1;const M=ah();if(M){const U=M.model.getValue(D.FIGURE_CARRY_OBJECT);U>0&&U<999999&&(y=!0)}return y},[]),b=y=>{let M=!0;if(y)switch(y){case"moderate":M=!1,r(lS);break;case"ban":M=!1,r(Zv);break;case"mute":M=!1,r(ey);break;case"ambassador":M=!1,r(cS);break;case"ambassador_mute":M=!1,r(ty);break;case"back_moderate":M=!1,r(lS);break;case"back_ambassador":M=!1,r(cS);break;case"back":M=!1,r(Ym);break;case"whisper":_i(new Lo(Lo.WHISPER,e.name));break;case"stargem":M=!1,E(e.webID);break;case"whisper.group":_i(new Lo(Lo.WHISPER_GROUP,"grupo")),K(new Fk(e.name));break;case"friend":Ce(`friends/request/${e.webID}/${e.name}`);break;case"relationship":M=!1,r(sy);break;case"interactions":M=!1,r(iy);break;case"more_interactions":M=!1,r(ry);break;case"respect":{_(e.webID),d-1>=1&&(M=!1);break}case"kiss":{f(e.webID),m-1>=1&&(M=!1);break}case"ignore":te().ignoreUser(e.name);break;case"unignore":te().unignoreUser(e.name);break;case"kick":l.sendKickMessage(e.webID);break;case"ban_hour":l.sendBanMessage(e.webID,"RWUAM_BAN_USER_HOUR");break;case"ban_day":l.sendBanMessage(e.webID,"RWUAM_BAN_USER_DAY");break;case"perm_ban":l.sendBanMessage(e.webID,"RWUAM_BAN_USER_PERM");break;case"mute_2min":l.sendMuteMessage(e.webID,2);break;case"mute_5min":l.sendMuteMessage(e.webID,5);break;case"mute_10min":l.sendMuteMessage(e.webID,10);break;case"give_rights":l.sendGiveRightsMessage(e.webID);break;case"remove_rights":l.sendTakeRightsMessage(e.webID);break;case"trade":K(new BU(e.roomIndex));break;case"report":o(xs.BULLY,{reportedUserId:e.webID});break;case"pass_hand_item":K(new Bw(e.webID));break;case"ambassador_alert":l.sendAmbassadorAlertMessage(e.webID);break;case"ambassador_kick":l.sendKickMessage(e.webID);break;case"ambassador_mute_2min":l.sendMuteMessage(e.webID,2);break;case"ambassador_mute_10min":l.sendMuteMessage(e.webID,10);break;case"ambassador_mute_60min":l.sendMuteMessage(e.webID,60);break;case"ambassador_mute_18hour":l.sendMuteMessage(e.webID,1080);break;case"rship_heart":K(new Kc(e.webID,$i.RELATIONSHIP_HEART));break;case"rship_smile":K(new Kc(e.webID,$i.RELATIONSHIP_SMILE));break;case"rship_bobba":K(new Kc(e.webID,$i.RELATIONSHIP_BOBBA));break;case"rship_poop":K(new Kc(e.webID,$i.RELATIONSHIP_POOP));break;case"rship_none":K(new Kc(e.webID,$i.RELATIONSHIP_NONE));break;case"kill":te().sendSpecialCommandMessage(`:matar ${e.name}`);break;case"push":te().sendSpecialCommandMessage(`:push ${e.name}`);break;case"pull":te().sendSpecialCommandMessage(`:pull ${e.name}`);break;case"hug":te().sendSpecialCommandMessage(`:hug ${e.name}`);break;case"copy":te().sendSpecialCommandMessage(`:copy ${e.name}`);break;case"punch":te().sendSpecialCommandMessage(`:punch ${e.name}`);break;case"kicking":te().sendSpecialCommandMessage(`:kicking ${e.name}`);break;case"touch":te().sendSpecialCommandMessage(`:touch ${e.name}`);break;case"burn":te().sendSpecialCommandMessage(`:burn ${e.name}`);break;case"tie":te().sendSpecialCommandMessage(`:tie ${e.name}`);break;case"slime":te().sendSpecialCommandMessage(`:slime ${e.name}`);break;case"nuke":te().sendSpecialCommandMessage(`:nuke ${e.name}`);break;case"slap":te().sendSpecialCommandMessage(`:slap ${e.name}`);break;case"inspect":Ce("wiredmenu/open/variable_inspection/1/"+e.roomIndex);break}M&&t()};return h.useEffect(()=>{r(Ym)},[e]),s.jsxs(ma,{objectId:e.roomIndex,category:Q.UNIT,objectType:e.userType,onClose:t,collapsable:!0,children:[s.jsx(mr,{className:"cursor-pointer",onClick:y=>ir(e.webID),dangerouslySetInnerHTML:{__html:e.coloredName}}),i===Ym&&s.jsxs(s.Fragment,{children:[n(e.webID)&&s.jsx(oe,{onClick:y=>b("friend"),children:g("infostand.button.friend")}),s.jsx(oe,{onClick:y=>b("trade"),children:g("infostand.button.trade")}),s.jsx(oe,{onClick:y=>b("whisper"),children:g("infostand.button.whisper")}),s.jsxs(oe,{onClick:y=>b("whisper.group"),children:[c.length>0&&!c.includes(e.name)&&g("infostand.button.whisper.group.add"),c.length>0&&c.includes(e.name)&&g("infostand.button.whisper.group.remove"),c.length===0&&g("infostand.button.whisper.group")]}),d>0&&s.jsx(oe,{onClick:y=>b("respect"),children:g("infostand.button.respect",["count"],[d.toString()])}),m>0&&s.jsx(oe,{onClick:y=>b("kiss"),children:g("infostand.button.kiss",["count"],[m.toString()])}),!n(e.webID)&&s.jsxs(oe,{onClick:y=>b("relationship"),children:[g("infostand.link.relationship"),s.jsx(_s,{className:"right fa-icon"})]}),s.jsxs(oe,{onClick:y=>b("interactions"),children:[g("profile.interactions"),s.jsx(_s,{className:"right fa-icon"})]}),!e.isIgnored&&s.jsx(oe,{onClick:y=>b("ignore"),children:g("infostand.button.ignore")}),e.isIgnored&&s.jsx(oe,{onClick:y=>b("unignore"),children:g("infostand.button.unignore")}),s.jsx(oe,{onClick:y=>b("report"),children:g("infostand.button.report")}),C&&s.jsxs(oe,{onClick:y=>b("moderate"),children:[s.jsx(_s,{className:"right fa-icon"}),g("infostand.link.moderate")]}),e.isAmbassador&&s.jsxs(oe,{onClick:y=>b("ambassador"),children:[s.jsx(_s,{className:"right fa-icon"}),g("infostand.link.ambassador")]}),I&&s.jsx(oe,{onClick:y=>b("inspect"),children:g("wiredmenu.inspect")}),A&&s.jsx(oe,{onClick:y=>b("pass_hand_item"),children:g("avatar.widget.pass_hand_item")})]}),i===lS&&s.jsxs(s.Fragment,{children:[s.jsx(oe,{onClick:y=>b("kick"),children:g("infostand.button.kick")}),s.jsxs(oe,{onClick:y=>b("mute"),children:[s.jsx(_s,{className:"right fa-icon"}),g("infostand.button.mute")]}),s.jsxs(oe,{onClick:y=>b("ban"),children:[s.jsx(_s,{className:"right fa-icon"}),g("infostand.button.ban")]}),R&&s.jsx(oe,{onClick:y=>b("give_rights"),children:g("infostand.button.giverights")}),O&&s.jsx(oe,{onClick:y=>b("remove_rights"),children:g("infostand.button.removerights")}),s.jsxs(oe,{onClick:y=>b("back"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),i===Zv&&s.jsxs(s.Fragment,{children:[s.jsx(oe,{onClick:y=>b("ban_hour"),children:g("infostand.button.ban_hour")}),s.jsx(oe,{onClick:y=>b("ban_day"),children:g("infostand.button.ban_day")}),s.jsx(oe,{onClick:y=>b("perm_ban"),children:g("infostand.button.perm_ban")}),s.jsxs(oe,{onClick:y=>b("back_moderate"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),i===ey&&s.jsxs(s.Fragment,{children:[s.jsx(oe,{onClick:y=>b("mute_2min"),children:g("infostand.button.mute_2min")}),s.jsx(oe,{onClick:y=>b("mute_5min"),children:g("infostand.button.mute_5min")}),s.jsx(oe,{onClick:y=>b("mute_10min"),children:g("infostand.button.mute_10min")}),s.jsxs(oe,{onClick:y=>b("back_moderate"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),i===cS&&s.jsxs(s.Fragment,{children:[s.jsx(oe,{onClick:y=>b("ambassador_alert"),children:g("infostand.button.alert")}),s.jsx(oe,{onClick:y=>b("ambassador_kick"),children:g("infostand.button.kick")}),s.jsxs(oe,{onClick:y=>b("ambassador_mute"),children:[g("infostand.button.mute"),s.jsx(_s,{className:"right fa-icon"})]}),s.jsxs(oe,{onClick:y=>b("back"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),i===ty&&s.jsxs(s.Fragment,{children:[s.jsx(oe,{onClick:y=>b("ambassador_mute_2min"),children:g("infostand.button.mute_2min")}),s.jsx(oe,{onClick:y=>b("ambassador_mute_10min"),children:g("infostand.button.mute_10min")}),s.jsx(oe,{onClick:y=>b("ambassador_mute_60min"),children:g("infostand.button.mute_60min")}),s.jsx(oe,{onClick:y=>b("ambassador_mute_18hr"),children:g("infostand.button.mute_18hour")}),s.jsxs(oe,{onClick:y=>b("back_ambassador"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),i===iy&&s.jsxs(s.Fragment,{children:[s.jsxs(oe,{onClick:y=>b("hug"),children:[s.jsx("i",{className:"left fa-icon icon icon-hug"}),g("profile.hug")]}),s.jsxs(oe,{onClick:y=>b("burn"),children:[s.jsx("i",{className:"left fa-icon icon icon-fire"}),g("profile.burn")]}),s.jsxs(oe,{onClick:y=>b("touch"),children:[s.jsx("i",{className:"left fa-icon icon icon-touch"}),g("profile.touch")]}),s.jsxs(oe,{onClick:y=>b("slap"),children:[s.jsx("i",{className:"left fa-icon icon icon-slap"}),g("profile.slap")]}),s.jsxs(oe,{onClick:y=>b("punch"),children:[s.jsx("i",{className:"left fa-icon icon icon-slap"}),g("profile.punch")]}),s.jsxs(oe,{onClick:y=>b("kill"),children:[s.jsx("i",{className:"left fa-icon icon icon-shoot"}),g("profile.kill")]}),s.jsxs(oe,{onClick:y=>b("more_interactions"),children:[g("profile.more"),s.jsx(_s,{className:"right fa-icon"})]}),s.jsxs(oe,{onClick:y=>b("back"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),i===ry&&s.jsxs(s.Fragment,{children:[s.jsxs(oe,{onClick:y=>b("stargem"),children:[s.jsx("i",{className:"left fa-icon icon icon-ducket-small"}),g("profile.give_gem")]}),s.jsxs(oe,{onClick:y=>b("push"),children:[s.jsx("i",{className:"left fa-icon icon icon-kicking"}),g("profile.push")]}),s.jsxs(oe,{onClick:y=>b("pull"),children:[s.jsx("i",{className:"left fa-icon icon icon-slap"}),g("profile.pull")]}),s.jsxs(oe,{onClick:y=>b("kicking"),children:[s.jsx("i",{className:"left fa-icon icon icon-kicking"}),g("profile.kicking")]}),s.jsxs(oe,{onClick:y=>b("tie"),children:[s.jsx("i",{className:"left fa-icon icon icon-tie"}),g("profile.tie")]}),s.jsxs(oe,{onClick:y=>b("slime"),children:[s.jsx("i",{className:"left fa-icon icon icon-slime"}),g("profile.slime")]}),s.jsxs(oe,{onClick:y=>b("nuke"),children:[s.jsx("i",{className:"left fa-icon icon icon-nuke"}),g("profile.nuke")]}),s.jsxs(oe,{onClick:y=>b("interactions"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),i===sy&&s.jsxs(s.Fragment,{children:[s.jsxs(x,{className:"menu-list-split-3",children:[s.jsx(oe,{onClick:y=>b("rship_heart"),children:s.jsx(q,{pointer:!0,className:"nitro-friends-spritesheet icon-heart"})}),s.jsx(oe,{onClick:y=>b("rship_smile"),children:s.jsx(q,{pointer:!0,className:"nitro-friends-spritesheet icon-smile"})}),s.jsx(oe,{onClick:y=>b("rship_bobba"),children:s.jsx(q,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba"})}),s.jsx(oe,{onClick:y=>b("rship_poop"),children:s.jsx(q,{pointer:!0,className:"nitro-friends-spritesheet icon-poop"})})]}),s.jsx(oe,{onClick:y=>b("rship_none"),children:g("avatar.widget.clear_relationship")}),s.jsxs(oe,{onClick:y=>b("back"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]})]})},qN=a=>{const{classNames:e=[],...t}=a,i=h.useMemo(()=>{const r=["menu-list"];return e.length&&r.push(...e),r},[e]);return s.jsx(N,{classNames:i,...t})},wle=a=>{const{userId:e=-1,userName:t="",roomIndex:i=-1,setIsDecorating:r=null}=a;return s.jsx(ma,{objectId:i,category:Q.UNIT,onClose:null,children:s.jsx(qN,{children:s.jsx(oe,{onClick:n=>r(!1),children:g("widget.avatar.stop_decorating")})})})},Fle=a=>{const{avatarInfo:e=null,onClose:t=null}=a,{showConfirm:i=null}=kt(),r=n=>{if(n)switch(n){case"move":Xc(e.id,e.category,at.OBJECT_MOVE);break;case"rotate":Xc(e.id,e.category,at.OBJECT_ROTATE_POSITIVE);break;case"pickup":Rk()?i(g("help.pickup.all.body"),()=>{Xc(e.id,e.category,at.OBJECT_PICKUP)},null,null,null,g("help.pickup.all.title")):Xc(e.id,e.category,at.OBJECT_PICKUP);break;case"eject":Xc(e.id,e.category,at.OBJECT_EJECT);break}};return s.jsxs(ma,{objectId:e.id,category:e.category,onClose:t,collapsable:!0,children:[s.jsx(mr,{children:e.name}),s.jsxs(x,{className:"menu-list-split-3",children:[s.jsx(oe,{onClick:n=>r("move"),children:s.jsx(AV,{className:"center fa-icon"})}),s.jsx(oe,{onClick:n=>r("rotate"),disabled:e.isWallItem,children:s.jsx(bV,{className:"center fa-icon"})}),(e.isOwner||e.isAnyRoomController)&&s.jsx(oe,{onClick:n=>r("pickup"),children:s.jsx(WA,{className:"center fa-icon"})}),!e.isOwner&&!e.isAnyRoomController&&(e.isRoomOwner||e.roomControllerLevel>=pt.GUILD_ADMIN)&&s.jsx(oe,{onClick:n=>r("eject"),children:s.jsx(WA,{className:"center fa-icon"})})]})]})},ny=a=>{const{nameInfo:e=null,onClose:t=null}=a,i=h.useMemo(()=>{const r=["name-only"];return e.isFriend&&r.push("is-friend"),r},[e]);return e.isFriend?s.jsx(ma,{objectId:e.roomIndex,category:e.category,objectType:e.userType,fades:e.id!==te().userId,classNames:i,onClose:t,children:s.jsx("div",{className:"text-shadow",dangerouslySetInnerHTML:{__html:e.name}})}):s.jsx(ma,{objectId:e.roomIndex,category:e.category,objectType:e.userType,fades:e.id!==te().userId,classNames:i,onClose:t,children:s.jsx("div",{className:"text-shadow",dangerouslySetInnerHTML:{__html:!e.isFriend&&e.coloredName?e.coloredName:e.nick&&e.nick.length>0?e.nick:e.name}})})},uS=0,hS=1,ay=3,oy=4,ly=5,cy=6,dS=7,_S=8,uy=9,kle=a=>{const{avatarInfo:e=null,isDancing:t=!1,setIsDecorating:i=null,onClose:r=null}=a,[n,o]=h.useState(t&&Uu()?hS:uS),{roomSession:l=null}=vt(),{wiredInspectButton:c,setJumpingToInspectId:u,setJumpToInspectUser:d}=Tn(),_=h.useMemo(()=>{if(n!=dS)return[[]];const p=[...Oe().avatar.effectDownloadManager.effectMap.keys()].filter(R=>!R.includes("dance")),S=[["0"]];for(let R=0;R<p.length;R+=3){const O=p.slice(R,R+3);S.push(O)}return S},[n]),m=h.useMemo(()=>{if(n!=_S)return[];const p=[[]];for(let S=0;S<200;S+=3){const R=[];for(let O=0;O<3;O++){const C=S+O;C<=200&&R.push(C.toString())}p.push(R)}return p},[n]),f=p=>{let S=!0;if(p)if(p.startsWith("sign_")){const R=parseInt(p.split("_")[1]);l.sendSignMessage(R)}else if(p.startsWith("enable_")){const R=p.split("_")[1];te().sendSpecialCommandMessage(`:enable ${R}`)}else if(p.startsWith("handitem_")){const R=p.split("_")[1];R==="0"?K(new Ax):te().sendSpecialCommandMessage(`:item ${R}`)}else switch(p){case"decorate":i(!0);break;case"change_name":_i(new om(om.INIT));break;case"change_looks":Ce("avatar-editor/show");break;case"expressions":S=!1,o(ay);break;case"sit":l.sendPostureMessage(Rp.POSTURE_SIT);break;case"stand":l.sendPostureMessage(Rp.POSTURE_STAND);break;case"wave":l.sendExpressionMessage(ca.WAVE.ordinal);break;case"blow":l.sendExpressionMessage(ca.BLOW.ordinal);break;case"laugh":l.sendExpressionMessage(ca.LAUGH.ordinal);break;case"idle":l.sendExpressionMessage(ca.IDLE.ordinal);break;case"dance_menu":S=!1,o(hS);break;case"dance":l.sendDanceMessage(1);break;case"dance_stop":l.sendDanceMessage(0);break;case"dance_1":case"dance_2":case"dance_3":case"dance_4":l.sendDanceMessage(parseInt(p.charAt(p.length-1)));break;case"signs":S=!1,o(ly);break;case"back":S=!1,o(uS);break;case"drop_carry_item":K(new Ax);break;case"more_expressions":S=!1,o(oy);break;case"interactions":S=!1,o(cy);break;case"enables":S=!1,o(dS);break;case"hand_items":S=!1,o(_S);break;case"smoke":te().sendSpecialCommandMessage(":fumar sim");break;case"cry":te().sendSpecialCommandMessage(":cry");break;case"eat":te().sendSpecialCommandMessage(":eat");break;case"drink":te().sendSpecialCommandMessage(":drink");break;case"dead":te().sendSpecialCommandMessage(":dead");break;case"customize":S=!1,o(uy);break;case"customize_name":te().sendSpecialCommandMessage(":nc");break;case"customize_tags":Ce("user-tags/toggle");break;case"inspect":Ce("wiredmenu/open/variable_inspection/1/"+e.roomIndex);break}S&&r()},E=()=>e.amIOwner||e.amIAnyRoomController||e.roomControllerLevel>pt.USER_WITH_RIGHTS,I=yQ();return s.jsxs(ma,{objectId:e.roomIndex,category:Q.UNIT,objectType:e.userType,onClose:r,collapsable:!0,children:[s.jsx(mr,{className:"cursor-pointer",onClick:p=>ir(e.webID),dangerouslySetInnerHTML:{__html:e.coloredName}}),n===uS&&s.jsxs(s.Fragment,{children:[e.allowNameChange&&s.jsx(oe,{onClick:p=>f("change_name"),children:g("widget.avatar.change_name")}),E()&&s.jsx(oe,{onClick:p=>f("decorate"),children:g("widget.avatar.decorate")}),s.jsx(oe,{onClick:p=>f("change_looks"),children:g("widget.memenu.myclothes")}),Uu()&&!I&&s.jsxs(oe,{onClick:p=>f("dance_menu"),children:[s.jsx(_s,{className:"right fa-icon"}),g("widget.memenu.dance")]}),!t&&!Uu()&&!I&&s.jsx(oe,{onClick:p=>f("dance"),children:g("widget.memenu.dance")}),t&&!Uu()&&!I&&s.jsx(oe,{onClick:p=>f("dance_stop"),children:g("widget.memenu.dance.stop")}),s.jsxs(oe,{onClick:p=>f("expressions"),children:[s.jsx(_s,{className:"right fa-icon"}),g("infostand.link.expressions")]}),s.jsxs(oe,{onClick:p=>f("signs"),children:[s.jsx(_s,{className:"right fa-icon"}),g("infostand.show.signs")]}),s.jsxs(oe,{onClick:p=>f("interactions"),children:[s.jsx(_s,{className:"right fa-icon"}),g("infostand.link.interactions")]}),s.jsxs(oe,{onClick:p=>f("customize"),children:[s.jsx(_s,{className:"right fa-icon"}),g("infostand.link.customize")]}),c&&s.jsx(oe,{onClick:p=>f("inspect"),children:g("wiredmenu.inspect")}),e.carryItem>0&&s.jsx(oe,{onClick:p=>f("drop_carry_item"),children:g("avatar.widget.drop_hand_item")})]}),n===hS&&s.jsxs(s.Fragment,{children:[t&&s.jsx(oe,{onClick:p=>f("dance_stop"),children:g("widget.memenu.dance.stop")}),s.jsxs(oe,{onClick:p=>f("dance_1"),children:[s.jsx("i",{className:"left fa-icon icon icon-dance-one"}),g("widget.memenu.dance1")]}),s.jsxs(oe,{onClick:p=>f("dance_2"),children:[s.jsx("i",{className:"left fa-icon icon icon-dance-two"}),g("widget.memenu.dance2")]}),s.jsxs(oe,{onClick:p=>f("dance_3"),children:[s.jsx("i",{className:"left fa-icon icon icon-dance-three"}),g("widget.memenu.dance3")]}),s.jsxs(oe,{onClick:p=>f("dance_4"),children:[s.jsx("i",{className:"left fa-icon icon icon-dance-four"}),g("widget.memenu.dance4")]}),s.jsxs(oe,{onClick:p=>f("back"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),n===ay&&s.jsxs(s.Fragment,{children:[AQ()===We.POSTURE_STAND&&s.jsxs(oe,{onClick:p=>f("sit"),children:[s.jsx("i",{className:"left fa-icon icon icon-sit"}),g("widget.memenu.sit")]}),fQ()&&s.jsxs(oe,{onClick:p=>f("stand"),children:[s.jsx("i",{className:"left fa-icon icon icon-stand"}),g("widget.memenu.stand")]}),qT()&&s.jsxs(oe,{onClick:p=>f("wave"),children:[s.jsx("i",{className:"left fa-icon icon icon-wave"}),g("widget.memenu.wave")]}),qT()&&s.jsxs(oe,{onClick:p=>f("laugh"),children:[s.jsx("i",{className:"left fa-icon icon icon-laugh"}),g("widget.memenu.laugh")]}),qT()&&s.jsxs(oe,{onClick:p=>f("blow"),children:[s.jsx("i",{className:"left fa-icon icon icon-blow"}),g("widget.memenu.blow")]}),s.jsxs(oe,{onClick:p=>f("idle"),children:[s.jsx("i",{className:"left fa-icon icon icon-idle"}),g("widget.memenu.idle")]}),s.jsxs(oe,{onClick:p=>f("more_expressions"),children:[g("profile.more"),s.jsx(_s,{className:"right fa-icon"})]}),s.jsxs(oe,{onClick:p=>f("back"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),n===oy&&s.jsxs(s.Fragment,{children:[s.jsxs(oe,{onClick:p=>f("cry"),children:[s.jsx("i",{className:"left fa-icon icon icon-cry"}),g("widget.memenu.cry")]}),s.jsxs(oe,{onClick:p=>f("eat"),children:[s.jsx("i",{className:"left fa-icon icon icon-eat"}),g("widget.memenu.eat")]}),s.jsxs(oe,{onClick:p=>f("drink"),children:[s.jsx("i",{className:"left fa-icon icon icon-drink"}),g("widget.memenu.drink")]}),s.jsxs(oe,{onClick:p=>f("dead"),children:[s.jsx("i",{className:"left fa-icon icon icon-dead"}),g("widget.memenu.dead")]}),s.jsxs(oe,{onClick:p=>f("smoke"),children:[s.jsx("i",{className:"left fa-icon icon icon-smoke"}),g("widget.memenu.smoke")]}),s.jsxs(oe,{onClick:p=>f("expressions"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),n===ly&&s.jsxs(s.Fragment,{children:[s.jsxs(x,{className:"menu-list-split-3",children:[s.jsx(oe,{onClick:p=>f("sign_1"),children:"1"}),s.jsx(oe,{onClick:p=>f("sign_2"),children:"2"}),s.jsx(oe,{onClick:p=>f("sign_3"),children:"3"})]}),s.jsxs(x,{className:"menu-list-split-3",children:[s.jsx(oe,{onClick:p=>f("sign_4"),children:"4"}),s.jsx(oe,{onClick:p=>f("sign_5"),children:"5"}),s.jsx(oe,{onClick:p=>f("sign_6"),children:"6"})]}),s.jsxs(x,{className:"menu-list-split-3",children:[s.jsx(oe,{onClick:p=>f("sign_7"),children:"7"}),s.jsx(oe,{onClick:p=>f("sign_8"),children:"8"}),s.jsx(oe,{onClick:p=>f("sign_9"),children:"9"})]}),s.jsxs(x,{className:"menu-list-split-3",children:[s.jsx(oe,{onClick:p=>f("sign_10"),children:"10"}),s.jsx(oe,{onClick:p=>f("sign_11"),children:s.jsx("i",{className:"icon icon-sign-heart"})}),s.jsx(oe,{onClick:p=>f("sign_12"),children:s.jsx("i",{className:"icon icon-sign-skull"})})]}),s.jsxs(x,{className:"menu-list-split-3",children:[s.jsx(oe,{onClick:p=>f("sign_0"),children:"0"}),s.jsx(oe,{onClick:p=>f("sign_13"),children:s.jsx("i",{className:"icon icon-sign-exclamation"})}),s.jsx(oe,{onClick:p=>f("sign_15"),children:s.jsx("i",{className:"icon icon-sign-smile"})})]}),s.jsxs(x,{className:"menu-list-split-3",children:[s.jsx(oe,{onClick:p=>f("sign_14"),children:s.jsx("i",{className:"icon icon-sign-soccer"})}),s.jsx(oe,{onClick:p=>f("sign_17"),children:s.jsx("i",{className:"icon icon-sign-yellow"})}),s.jsx(oe,{onClick:p=>f("sign_16"),children:s.jsx("i",{className:"icon icon-sign-red"})})]}),s.jsxs(oe,{onClick:p=>f("back"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),n===cy&&s.jsxs(s.Fragment,{children:[s.jsxs(oe,{onClick:p=>f("enables"),children:[s.jsx("i",{className:"left fa-icon icon icon-enable"}),g("widget.memenu.enables"),s.jsx(_s,{className:"right fa-icon"})]}),s.jsxs(oe,{onClick:p=>f("hand_items"),children:[s.jsx("i",{className:"left fa-icon icon icon-handitem"}),g("widget.memenu.handitems"),s.jsx(_s,{className:"right fa-icon"})]}),s.jsxs(oe,{onClick:p=>f("back"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),n===dS&&s.jsxs(s.Fragment,{children:[s.jsx("div",{style:{maxHeight:"150px",overflow:"auto"},children:_.map((p,S)=>s.jsx(x,{className:"menu-list-split-3",children:p.map((R,O)=>s.jsxs(oe,{onClick:C=>f(`enable_${R}`),gap:1,children:[s.jsx("i",{className:"icon icon-enable-view"}),R]},R))},S))}),s.jsxs(oe,{onClick:p=>f("interactions"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),n===_S&&s.jsxs(s.Fragment,{children:[s.jsx("div",{style:{maxHeight:"150px",overflow:"auto"},children:m.map((p,S)=>s.jsx(x,{className:"menu-list-split-3",children:p.map((R,O)=>s.jsxs(oe,{onClick:C=>f(`handitem_${R}`),gap:1,children:[s.jsx("i",{className:"icon icon-handitem-view"}),R]},R))},S))}),s.jsxs(oe,{onClick:p=>f("interactions"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]}),n===uy&&s.jsxs(s.Fragment,{children:[s.jsxs(oe,{onClick:p=>f("customize_name"),children:[s.jsx("i",{className:"left fa-icon icon icon-icons"}),g("infostand.link.customize_name")]}),s.jsxs(oe,{onClick:p=>f("customize_tags"),children:[s.jsx("i",{className:"left fa-icon icon icon-tag"}),g("infostand.link.customize_tags")]}),s.jsxs(oe,{onClick:p=>f("back"),children:[s.jsx(ds,{className:"left fa-icon"}),g("generic.back")]})]})]})},zm=0,hy=1,dy=2,gS=3,Gle=a=>{const{avatarInfo:e=null,onClose:t=null,setMonsterPlantBreed:i=null}=a,[r,n]=h.useState(zm),{roomSession:o=null}=vt(),{petRespectRemaining:l=0,respectPet:c=null}=Ja();FN();const u=h.useMemo(()=>{let _=!1;const m=ah();if(m){const f=m.model.getValue(D.FIGURE_CARRY_OBJECT);f>0&&f<999999&&(_=!0)}return _},[]),d=_=>{let m=!0;if(_)switch(_){case"respect":c(e.id),l-1>=1&&(m=!1);break;case"treat":K(new gm(e.id));break;case"pass_handitem":K(new hN(e.id));break;case"train":o.requestPetCommands(e.id);break;case"pick_up":o.pickupPet(e.id);break;case"mount":o.mountPet(e.id);break;case"toggle_riding_permission":o.togglePetRiding(e.id);break;case"toggle_breeding_permission":o.togglePetBreeding(e.id);break;case"dismount":o.dismountPet(e.id);break;case"saddle_off":o.removePetSaddle(e.id);break;case"breed":r===zm||r===gS&&(i(e.roomIndex),o.requestBreedPet(e.id));break;case"harvest":o.harvestPet(e.id);break;case"revive":break;case"compost":o.compostPlant(e.id);break;case"buy_saddle":Ce("catalog/open/"+xe("catalog.links")["pets.buy_saddle"]);break}m&&t()};return h.useEffect(()=>{n(_=>e.petType===ui.MONSTERPLANT?gS:e.saddle&&!e.rider?hy:e.rider?dy:zm)},[e]),s.jsxs(ma,{objectId:e.roomIndex,category:Q.UNIT,objectType:Xt.PET,onClose:t,collapsable:!0,children:[s.jsx(mr,{children:e.name}),r===zm&&s.jsxs(s.Fragment,{children:[l>0&&s.jsx(oe,{onClick:_=>d("respect"),children:g("infostand.button.petrespect",["count"],[l.toString()])}),s.jsx(oe,{onClick:_=>d("train"),children:g("infostand.button.train")}),s.jsx(oe,{onClick:_=>d("pick_up"),children:g("infostand.button.pickup")}),e.petType===ui.HORSE&&s.jsx(oe,{onClick:_=>d("buy_saddle"),children:g("infostand.button.buy_saddle")}),[ui.BEAR,ui.TERRIER,ui.CAT,ui.DOG,ui.PIG].indexOf(e.petType)>-1&&s.jsx(oe,{onClick:_=>d("breed"),children:g("infostand.button.breed")})]}),r===hy&&s.jsxs(s.Fragment,{children:[s.jsx(oe,{onClick:_=>d("mount"),children:g("infostand.button.mount")}),s.jsxs(oe,{onClick:_=>d("toggle_riding_permission"),gap:1,children:[s.jsx("input",{type:"checkbox",checked:!!e.publiclyRideable,readOnly:!0}),g("infostand.button.toggle_riding_permission")]}),l>0&&s.jsx(oe,{onClick:_=>d("respect"),children:g("infostand.button.petrespect",["count"],[l.toString()])}),s.jsx(oe,{onClick:_=>d("train"),children:g("infostand.button.train")}),s.jsx(oe,{onClick:_=>d("pick_up"),children:g("infostand.button.pickup")}),s.jsx(oe,{onClick:_=>d("saddle_off"),children:g("infostand.button.saddleoff")})]}),r===dy&&s.jsxs(s.Fragment,{children:[s.jsx(oe,{onClick:_=>d("dismount"),children:g("infostand.button.dismount")}),l>0&&s.jsx(oe,{onClick:_=>d("respect"),children:g("infostand.button.petrespect",["count"],[l.toString()])})]}),r===gS&&s.jsxs(s.Fragment,{children:[s.jsx(oe,{onClick:_=>d("pick_up"),children:g("infostand.button.pickup")}),e.dead&&s.jsx(oe,{onClick:_=>d("revive"),children:g("infostand.button.revive")}),o.isRoomOwner&&s.jsx(oe,{onClick:_=>d("compost"),children:g("infostand.button.compost")}),!e.dead&&e.energy/e.maximumEnergy<.98&&s.jsx(oe,{onClick:_=>d("treat"),children:g("infostand.button.pettreat")}),!e.dead&&e.level===e.maximumLevel&&e.breedable&&s.jsxs(s.Fragment,{children:[s.jsxs(oe,{onClick:_=>d("toggle_breeding_permission"),gap:1,children:[s.jsx("input",{type:"checkbox",checked:e.publiclyBreedable,readOnly:!0}),g("infostand.button.toggle_breeding_permission")]}),s.jsx(oe,{onClick:_=>d("breed"),children:g("infostand.button.breed")})]})]}),u&&s.jsx(oe,{onClick:_=>d("pass_hand_item"),children:g("infostand.button.pass_hand_item")})]})},mS=0,_y=1,gy=2,my=3,Ble=a=>{const{avatarInfo:e=null,onClose:t=null}=a,[i,r]=h.useState(mS),{roomSession:n=null}=vt(),{petRespectRemaining:o=0,respectPet:l=null}=Ja(),c=h.useMemo(()=>n.isRoomOwner||n.controllerLevel>=pt.USER_WITH_RIGHTS||te().isModerator,[n]),u=h.useMemo(()=>{let _=!1;const m=ah();if(m){const f=m.model.getValue(D.FIGURE_CARRY_OBJECT);f>0&&f<999999&&(_=!0)}return _},[]),d=_=>{let m=!0;if(_)switch(_){case"respect":l(e.id),o-1>=1&&(m=!1);break;case"treat":K(new gm(e.id));break;case"pass_handitem":K(new hN(e.id));break;case"pick_up":n.pickupPet(e.id);break;case"mount":n.mountPet(e.id);break;case"dismount":n.dismountPet(e.id);break}m&&t()};return h.useEffect(()=>{r(_=>e.petType===ui.MONSTERPLANT?my:e.saddle&&!e.rider?_y:e.rider?gy:mS)},[e]),s.jsxs(ma,{objectId:e.roomIndex,category:Q.UNIT,objectType:Xt.PET,onClose:t,collapsable:!0,children:[s.jsx(mr,{children:e.name}),i===mS&&o>0&&s.jsx(oe,{onClick:_=>d("respect"),children:g("infostand.button.petrespect",["count"],[o.toString()])}),i===_y&&s.jsxs(s.Fragment,{children:[!!e.publiclyRideable&&s.jsx(oe,{onClick:_=>d("mount"),children:g("infostand.button.mount")}),o>0&&s.jsx(oe,{onClick:_=>d("respect"),children:g("infostand.button.petrespect",["count"],[o.toString()])})]}),i===gy&&s.jsxs(s.Fragment,{children:[s.jsx(oe,{onClick:_=>d("dismount"),children:g("infostand.button.dismount")}),o>0&&s.jsx(oe,{onClick:_=>d("respect"),children:g("infostand.button.petrespect",["count"],[o.toString()])})]}),i===my&&!e.dead&&e.energy/e.maximumEnergy<.98&&s.jsx(oe,{onClick:_=>d("treat"),children:g("infostand.button.pettreat")}),c&&s.jsx(oe,{onClick:_=>d("pick_up"),children:g("infostand.button.pickup")}),u&&s.jsx(oe,{onClick:_=>d("pass_hand_item"),children:g("infostand.button.pass_hand_item")})]})},fS=0,fy=1,py=2,Vle=a=>{const{avatarInfo:e=null,onClose:t=null}=a,[i,r]=h.useState(fS),[n,o]=h.useState(""),[l,c]=h.useState("");Ir();const u=jl().getSession(1);J(vj,f=>{const E=f.getParser();if(E.botId===e.webID)switch(E.commandId){case Rs.CHANGE_BOT_NAME:o(E.data),r(fy);return;case Rs.CHANGE_BOT_MOTTO:c(E.data),r(py);return;case Rs.SETUP_CHAT:{const I=E.data,p=I.split(I.indexOf(";#;")===-1?";":";#;");(p.length===3||p.length===4)&&(_i(new Sp(e.roomIndex,Q.UNIT,e.webID,p[0],p[1].toLowerCase()==="true"||p[1]==="1",parseInt(p[2]),p[3]?p[3].toLowerCase()==="true"||p[3]==="1":!1)),t());return}}});const d=f=>K(new K1(e.webID,f)),_=f=>{let E=!0;if(f)switch(f){case"donate_to_all":d(Rs.DONATE_TO_ALL),K(new so(e.webID,Rs.DONATE_TO_ALL,""));break;case"donate_to_user":d(Rs.DONATE_TO_USER),K(new so(e.webID,Rs.DONATE_TO_USER,""));break;case"change_bot_name":d(Rs.CHANGE_BOT_NAME),E=!1;break;case"save_bot_name":K(new so(e.webID,Rs.CHANGE_BOT_NAME,n));break;case"change_bot_motto":d(Rs.CHANGE_BOT_MOTTO),E=!1;break;case"save_bot_motto":K(new so(e.webID,Rs.CHANGE_BOT_MOTTO,l));break;case"dress_up":K(new so(e.webID,Rs.DRESS_UP,""));break;case"random_walk":K(new so(e.webID,Rs.RANDOM_WALK,""));break;case"setup_chat":d(Rs.SETUP_CHAT),E=!1;break;case"dance":K(new so(e.webID,Rs.DANCE,""));break;case"nux_take_tour":Oe().createLinkEvent("help/tour"),K(new so(e.webID,Rs.NUX_TAKE_TOUR,""));break;case"pick":K(new fT(e.webID));break}E&&t()};h.useEffect(()=>{r(fS)},[e]);const m=e.amIOwner||e.amIAnyRoomController||u&&u.moderationSettings.allowAddBot&&te().hasSecurity(pt.USER_WITH_RIGHTS);return s.jsxs(ma,{objectId:e.roomIndex,category:Q.UNIT,objectType:Xt.RENTABLE_BOT,onClose:t,collapsable:!0,children:[s.jsx(mr,{children:e.name}),i===fS&&m&&s.jsxs(s.Fragment,{children:[e.botSkills.indexOf(Rs.DONATE_TO_ALL)>=0&&s.jsx(oe,{onClick:f=>_("donate_to_all"),children:g("avatar.widget.donate_to_all")}),e.botSkills.indexOf(Rs.DONATE_TO_USER)>=0&&s.jsx(oe,{onClick:f=>_("donate_to_user"),children:g("avatar.widget.donate_to_user")}),e.botSkills.indexOf(Rs.CHANGE_BOT_NAME)>=0&&s.jsx(oe,{onClick:f=>_("change_bot_name"),children:g("avatar.widget.change_bot_name")}),e.botSkills.indexOf(Rs.CHANGE_BOT_MOTTO)>=0&&s.jsx(oe,{onClick:f=>_("change_bot_motto"),children:g("avatar.widget.change_bot_motto")}),e.botSkills.indexOf(Rs.DRESS_UP)>=0&&s.jsx(oe,{onClick:f=>_("dress_up"),children:g("avatar.widget.dress_up")}),e.botSkills.indexOf(Rs.RANDOM_WALK)>=0&&s.jsx(oe,{onClick:f=>_("random_walk"),children:g("avatar.widget.random_walk")}),e.botSkills.indexOf(Rs.SETUP_CHAT)>=0&&s.jsx(oe,{onClick:f=>_("setup_chat"),children:g("avatar.widget.setup_chat")}),e.botSkills.indexOf(Rs.DANCE)>=0&&s.jsx(oe,{onClick:f=>_("dance"),children:g("avatar.widget.dance")}),e.botSkills.indexOf(Rs.NO_PICK_UP)===-1&&s.jsx(oe,{onClick:f=>_("pick"),children:g("avatar.widget.pick_up")})]}),i===fy&&s.jsxs(N,{className:"menu-item",onClick:null,gap:1,children:[s.jsx(T,{variant:"white",children:g("bot.skill.name.configuration.new.name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:n,maxLength:xe("bot.name.max.length",15),onChange:f=>o(f.target.value)}),s.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[s.jsx(X,{fullWidth:!0,variant:"secondary",onClick:f=>_(null),children:g("cancel")}),s.jsx(X,{fullWidth:!0,variant:"success",onClick:f=>_("save_bot_name"),children:g("save")})]})]}),i===py&&s.jsxs(N,{className:"menu-item",onClick:null,gap:1,children:[s.jsx(T,{variant:"white",children:g("bot.skill.name.configuration.new.motto")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:l,maxLength:xe("motto.max.length",38),onChange:f=>c(f.target.value)}),s.jsxs(x,{alignItems:"center",justifyContent:"between",gap:1,children:[s.jsx(X,{fullWidth:!0,variant:"secondary",onClick:f=>_(null),children:g("cancel")}),s.jsx(X,{fullWidth:!0,variant:"success",onClick:f=>_("save_bot_motto"),children:g("save")})]})]})]})},Hle=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(!1),[n,o]=h.useState(null),{avatarInfo:l=null,setAvatarInfo:c=null,activeNameBubble:u=null,setActiveNameBubble:d=null,nameBubbles:_=[],removeNameBubble:m=null,productBubbles:f=[],confirmingProduct:E=null,monsterPlantBreed:I=-1,setMonsterPlantBreed:p=null,updateConfirmingProduct:S=null,removeProductBubble:R=null,isDecorating:O=!1,setIsDecorating:C=null,openMenu:A=!0,setOpenMenu:b=null}=FN(),{roomSession:y=null}=vt(),{isMobile:M}=Ia(),[U,G]=h.useState(!1),[F,H]=h.useState(!1),{objectsIdAndValue:v,isFurniHolders:B}=jT();h.useEffect(()=>{if(!l)return;const W=ce();W&&(H(W.hasClickUserWired()),b(!W.hasClickUserWired()))},[l,b]),ut(Ot.NORMAL_MODE,W=>{e&&t(!1)}),ut(Ot.GAME_MODE,W=>{e||t(!0)}),ms(xf.RSDE_DANCE,W=>{W.roomIndex===y.ownRoomIndex&&r(W.danceId!==0)}),Js(Sp.UPDATE_CHAT,W=>o(W));const z=()=>{if(!y||e)return null;if(u)return s.jsx(ny,{nameInfo:u,onClose:()=>d(null)});if(F&&!A)return null;if(l)switch(l.type){case Vn.FURNI:{const W=l;return O?s.jsx(Fle,{avatarInfo:W,onClose:()=>c(null)}):null}case $s.OWN_USER:case $s.PEER:{const W=l;return xe("user.tags.enabled")&&(te().tags.length=0,te().getUserTags(W.webID)),W.isSpectatorMode?null:W.isOwnUser?Bn.isRunning()?null:s.jsx(kle,{avatarInfo:W,isDancing:i,setIsDecorating:C,onClose:()=>c(null)}):s.jsx(Ule,{avatarInfo:W,onClose:()=>c(null)})}case Xu.PET_INFO:{const W=l;return W.isOwner?s.jsx(Gle,{avatarInfo:W,setMonsterPlantBreed:p,onClose:()=>c(null)}):s.jsx(Ble,{avatarInfo:W,onClose:()=>c(null)})}case $u.RENTABLE_BOT:return s.jsx(Vle,{avatarInfo:l,onClose:()=>c(null)})}return null},$=()=>{if(!l)return null;switch(l.type){case Vn.FURNI:return s.jsx(vle,{open:U,setOpen:G,avatarInfo:l,onClose:()=>c(null)});case $s.OWN_USER:case $s.PEER:return s.jsx(Ple,{open:U,setOpen:G,avatarInfo:l,setAvatarInfo:c,onClose:()=>c(null)});case $s.BOT:return s.jsx(Nle,{open:U,setOpen:G,avatarInfo:l,onClose:()=>c(null)});case $u.RENTABLE_BOT:return s.jsx(Dle,{open:U,setOpen:G,avatarInfo:l,onClose:()=>c(null)});case Xu.PET_INFO:return s.jsx(yle,{open:U,setOpen:G,avatarInfo:l,onClose:()=>c(null)})}};return s.jsxs(s.Fragment,{children:[v.size>0&&[...v.keys()].map(W=>s.jsx(ma,{objectId:W,category:B?Q.FLOOR:Q.UNIT,objectType:B?Xt.FURNI:Xt.USER,classNames:["variable-value","justify-content-center"],onClose:()=>{},children:s.jsx(T,{variant:"white",align:"center",className:"text-shadow",children:v.get(W)})},W)),O&&s.jsx(wle,{userId:te().userId,userName:te().userName,roomIndex:y.ownRoomIndex,setIsDecorating:C}),z(),l&&!e&&s.jsx(N,{alignItems:"end",className:`nitro-infostand-container ${(!M||U)&&"room-widget-open"}`,children:$()}),_.length>0&&_.map((W,V)=>s.jsx(ny,{nameInfo:W,onClose:()=>m(V)},V)),f.length>0&&f.map((W,V)=>s.jsx(Cle,{item:W,updateConfirmingProduct:S,onClose:()=>R(V)},W.id)),n&&s.jsx(Ile,{chatEvent:n,onClose:()=>o(null)}),E&&s.jsx(Tle,{item:E,monsterPlantBreed:I,onClose:()=>{S(null),p(-1)}}),s.jsx(Ele,{})]})},Wle=a=>{const{chatStyleId:e=0,chatStyleIds:t=null,selectChatStyleId:i=null}=a,[r,n]=h.useState(null),[o,l]=h.useState(!1),c=d=>{i(d),l(!1)},u=d=>{let _=!1;l(m=>(_=!m,_)),_&&n(d.target)};return h.useEffect(()=>{o||n(null)},[o]),s.jsxs(s.Fragment,{children:[s.jsx(q,{pointer:!0,className:"chat-styles-selector",onClick:u}),s.jsx(Kd,{show:o,target:r,placement:"top",children:s.jsx(Oc,{className:"nitro-chat-style-selector-container image-rendering-pixelated",children:s.jsx(be,{overflow:"hidden",className:"bg-transparent",children:s.jsx(Ye,{columnCount:3,overflow:"auto",children:t&&t.length>0&&t.map(d=>s.jsx(x,{center:!0,pointer:!0,className:`bubble-parent-container ${e===d?"active":""}`,onClick:_=>c(d),children:s.jsx(q,{className:"bubble-container",children:s.jsx(q,{className:`chat-bubble bubble-${d}`,children:" "})},d)},d))})})})})]})},Yle=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(!1),{chatStyleId:n=0,updateChatStyleId:o=null}=Ja(),{selectedUsername:l="",floodBlocked:c=!1,floodBlockedSeconds:u=0,setIsTyping:d=null,setIsIdle:_=null,sendChat:m=null}=Lie(),{commandsList:f}=Qa(),[E,I]=h.useState(null),{roomSession:p=null}=vt(),[S,R]=h.useState(!1),O=h.useRef(),[C,A]=h.useState(f),b=te(),y=h.useMemo(()=>g("widgets.chatinput.mode.whisper"),[]),M=h.useMemo(()=>g("widgets.chatinput.mode.shout"),[]),U=h.useMemo(()=>g("widgets.chatinput.mode.speak"),[]),G=h.useMemo(()=>b.isModerator?300:bQ()?200:150,[b]),F=h.useCallback(()=>{const V=document.activeElement;return!V||O&&O.current===V?!1:!(!(V instanceof HTMLInputElement)&&!(V instanceof HTMLTextAreaElement))},[O]),H=h.useCallback(()=>{O.current.focus(),O.current.setSelectionRange(O.current.value.length*2,O.current.value.length*2)},[O]),v=h.useCallback(()=>{t(V=>V!==y||!l.length?V:`${V} ${l}`)},[l,y]),B=h.useCallback((V,se=!1,ee=!1,ie=!1)=>{if(!V||V==="")return;let Z=se?yo.CHAT_SHOUT:yo.CHAT_DEFAULT,ne=V;(ee||ie)&&e.split(" ")[0]===y&&(ne=`${e} ${V}`);const _e=ne.split(" ");let de="",me="";switch(_e[0]){case y:Z=yo.CHAT_WHISPER,de=_e[1],me=y+" "+de+" ",_e.shift(),_e.shift();break;case M:Z=yo.CHAT_SHOUT,_e.shift();break;case U:Z=yo.CHAT_DEFAULT,_e.shift();break}ne=_e.join(" "),d(!1),_(!1),ne.length<=G&&(/%CC%/g.test(encodeURIComponent(ne))?t(""):(t(""),m(ne,Z,de,n))),t(me),I(null)},[y,M,U,G,n,d,_,m]),z=h.useCallback(V=>{V.length>G&&(V=V.substring(0,G)),V.length?(d(!0),_(!0)):d(!1),t(V)},[d,_,G]);ut(Ot.DISPOSED,V=>{t(""),I(null),R(!1),A([])}),h.useEffect(()=>{if(!p||!f.length){R(!1);return}if(E)return;if(R(e.startsWith(":")),!e.startsWith(":")){A(f);return}const V=e.toLowerCase();if(V){if(f.find(se=>se.name[0].toLowerCase()===V)){R(!1);return}A(f.filter(se=>se.name[0].toLowerCase().includes(V)))}},[e,f,p,E]),h.useEffect(()=>{if(E){if(!e&&E){I(null);return}if(!E.name.toString().split("/").some(V=>e.toLowerCase().includes(V.trim().toLowerCase()))){I(null);return}}},[e,E]);const $=h.useCallback(V=>{if(c||!O.current||F())return;document.activeElement!==O.current&&H();const se=O.current.value;switch(V.key){case" ":case"Space":v();return;case"NumpadEnter":case"Enter":B(se,V.shiftKey?V.shiftKey:i);return;case"Backspace":if(se){const ee=se.split(" ");ee[0]===y&&ee.length===3&&ee[2]===""&&t("")}return}},[c,F,H,v,B,i,y]);Js(Lo.CHAT_INPUT_CONTENT,V=>{switch(V.chatMode){case Lo.WHISPER_GROUP:case Lo.WHISPER:{t(`${y} ${V.userName} `);return}case Lo.SHOUT:return}});const W=h.useMemo(()=>{let V=[];const se=xe("chat.styles");for(const ee of se)if(ee){if(ee.minRank>0){te().hasSecurity(ee.minRank)&&V.push(ee.styleId);continue}if(ee.isSystemStyle&&te().hasSecurity(pt.MODERATOR)){V.push(ee.styleId);continue}if(!(xe("chat.styles.disabled").indexOf(ee.styleId)>=0)){if(ee.isHcOnly&&te().clubLevel>=rr.VIP){V.push(ee.styleId);continue}if(ee.isAmbassadorOnly&&te().isAmbassador){V.push(ee.styleId);continue}!ee.isHcOnly&&!ee.isAmbassadorOnly&&V.push(ee.styleId)}}return V},[]);return h.useEffect(()=>(document.body.addEventListener("keydown",$),()=>{document.body.removeEventListener("keydown",$)}),[$]),h.useEffect(()=>{O.current&&(O.current.parentElement.dataset.value=e)},[e]),!p||p.isSpectator?null:tC.createPortal(s.jsxs("div",{className:"d-flex align-items-center nitro-chat-input",children:[s.jsx(Wle,{chatStyleId:n,chatStyleIds:W,selectChatStyleId:o}),s.jsx("div",{className:"nitro-chat-input-container",children:s.jsxs("div",{className:"input-sizer align-items-center",children:[!c&&s.jsxs(s.Fragment,{children:[s.jsx(T,{className:"text-change",bold:i,small:!0,variant:"black",onClick:()=>r(!i),children:i?"Negrito":"Normal"}),s.jsx("input",{ref:O,type:"text",className:"chat-input",placeholder:g("widgets.chatinput.default"),value:e,maxLength:G,onChange:V=>z(V.target.value),onMouseDown:V=>H(),autoComplete:"off"})]}),c&&s.jsxs(T,{variant:"danger",children:[g("chat.input.alert.flood",["time"],[u.toString()])," "]}),s.jsxs(x,{children:[s.jsx(_B,{sendChatValue:B}),s.jsx(gB,{setChatValue:t})]})]})}),s.jsx("div",{className:"nitro-mic-input-container",children:s.jsx(mB,{sendChatValue:B})}),E&&s.jsx("div",{className:"commands-panel show",children:s.jsx("div",{className:"command-details",children:s.jsxs("div",{className:"command-item selected",children:[s.jsx("strong",{children:E.name[0]})," - ",E.description]},E.name.length)})}),S&&!E&&s.jsx("div",{className:"commands-panel show",children:s.jsx("div",{className:"commands-list",children:C.length?s.jsx(s.Fragment,{children:C.map((V,se)=>s.jsxs("div",{className:"command-item",onClick:()=>{t(`${V.name[0].split("/")[0].toString().trim()}`),I(V)},children:[s.jsx("strong",{children:V.name[0]})," - ",V.description]},se))}):s.jsx("div",{className:"command-none",children:s.jsx("b",{children:"Nenhum comando encontrado"})})})})]}),document.getElementById("toolbar-chat-input-container"))},zle=()=>{let a=null;self.onmessage=e=>{if(!e)return;const t=e.data;switch(t.action){case"START":a=setInterval(()=>postMessage(null),t.content);break;case"STOP":a&&(clearInterval(a),a=null);break}}};class Kle extends Worker{constructor(e){const t=e.toString(),i=new Blob([`(${t})()`]);super(URL.createObjectURL(i))}}const qle={},Xle=a=>{let e=a;for(const[t,i]of Object.entries(qle)){const r=t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp(r,"g");e=e.replace(n,`<span class="emoji ${i}"></span>`)}return e},$le=a=>{const{chat:e=null,makeRoom:t=null,bubbleWidth:i=Ds.CHAT_BUBBLE_WIDTH_NORMAL}=a,[r,n]=h.useState(!1),[o,l]=h.useState(!1),c=h.useRef(),{settingFontSize:u,showGifs:d,activeChat:_,setActiveChat:m}=Ea(),[f,E]=h.useState(null),I=h.useMemo(()=>{switch(i){case Ds.CHAT_BUBBLE_WIDTH_NORMAL:return 350;case Ds.CHAT_BUBBLE_WIDTH_THIN:return 240;case Ds.CHAT_BUBBLE_WIDTH_WIDE:return 2e3}},[i]);return h.useEffect(()=>{n(!1);const p=c.current;if(!p)return;const S=p.offsetWidth,R=p.offsetHeight;e.width=S,e.height=R,e.elementRef=p;let O=e.left,C=e.top;return!O&&!C&&(O=e.location.x-S/2,C=p.parentElement.offsetHeight-R,e.left=O,e.top=C),l(!0),()=>{e.elementRef=null,l(!1)}},[e]),h.useEffect(()=>{!o||!e||r||(t&&t(e),n(!0))},[e,o,r,t]),s.jsxs("div",{ref:c,className:`bubble-container ${r&&_?"visible":"invisible"} ${e.pureContent?"chat-mention":""}`,onClick:p=>{e.pureContent?window.navigator.clipboard.writeText(e.pureContent):ce().selectRoomObject(e.roomId,e.senderId,Q.UNIT)},title:e.pureContent?"Clique para copiar a mensagem":null,onMouseOver:()=>{e.hasNickname&&E(e.uniqueName)},onMouseLeave:()=>{e.hasNickname&&E(null)},children:[e.styleId===0&&s.jsx("div",{className:"user-container-bg",style:{backgroundColor:e.color}}),s.jsxs("div",{className:`chat-bubble bubble-${e.styleId} type-${e.type}`,style:{maxWidth:I,fontSize:`${u}em`},children:[s.jsx("div",{className:"user-container",children:e.imageUrl&&e.imageUrl.length>0&&s.jsx("div",{className:"user-image",style:{backgroundImage:`url(${e.imageUrl})`}})}),s.jsxs("div",{className:`chat-content ${Va(e.formattedText)?"content-audio":""}`,children:[s.jsx("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${f||e.username}: `}}),Va(e.formattedText)?s.jsx(WN,{src:e.formattedText}):Va(e.formattedText,"gif")?s.jsx(HN,{src:e.formattedText,showGifs:d}):s.jsx("span",{className:"message",dangerouslySetInnerHTML:{__html:Xle(`${e.formattedText}${e.repeatCount>1?` (x${e.repeatCount})`:""}`)}})]}),s.jsx("div",{className:"pointer"})]})]})},Qle=()=>{const{chatMessages:a=[],setChatMessages:e=null,chatSettings:t=null,getScrollSpeed:i=6e3}=kie(),r=h.useRef(),n=h.useCallback(()=>{e(c=>{if(c){const u=c.filter(d=>d.top+d.height>0);if(u.length!==c.length)return u}return c})},[e]),o=h.useCallback((c,u,d)=>{const _=a;for(let m=_.indexOf(c)-1;m>=0;m--){const f=_[m];if(!(!f||c===f||d.indexOf(f)>=0||f.top+f.height-u>c.top+c.height)&&fJ(c,f,-u,0)){const E=Math.abs(f.top+f.height-c.top);d.push(f),f.top-=E,f.skipMovement=!0,o(f,E,d)}}},[a]),l=h.useCallback(c=>{if(t.mode===Ds.CHAT_MODE_FREE_FLOW)c.skipMovement=!0,o(c,0,[c]),n();else{const u=c.top+c.height,d=c.height,_=r.current.offsetHeight-u,m=d-_;_<d&&(e(f=>(f.forEach(E=>{E!==c&&(E.top-=m)}),f)),n())}},[t,o,n,e]);return h.useEffect(()=>{const c=(u=null)=>{if(!r||!r.current)return;const d=r.current.offsetHeight,_=Math.round(document.body.offsetHeight*xe("chat.viewer.height.percentage"));r.current.style.height=`${_}px`,e(m=>(m&&m.forEach(f=>f.top-=d-_),m))};return window.addEventListener("resize",c),c(),()=>{window.removeEventListener("resize",c)}},[e]),h.useEffect(()=>{const c=d=>{e(_=>(_.forEach(m=>{if(m.skipMovement){m.skipMovement=!1;return}m.top-=d}),_)),n()},u=new Kle(zle);return u.onmessage=()=>c(15),u.postMessage({action:"START",content:i}),()=>{u.postMessage({action:"STOP"})}},[i,n,e]),ut(Ot.DISPOSED,c=>{e([])}),s.jsx("div",{ref:r,className:"nitro-chat-widget",children:a.map(c=>s.jsx($le,{chat:c,makeRoom:l,bubbleWidth:t.weight},c.id))})},Jle="inventory.filter.placement.any",NB="inventory.filter.placement.floor",AB="inventory.filter.placement.wall",c_="inventory.filter.placement.rares_ltd",bB="inventory.filter.placement.wireds",Zle="Todos os donos",ece=[Jle,NB,AB,c_,bB],tce=["any","players","pets","bots"],vB=a=>{const{title:e=null,items:t=[],selectItem:i=null,deselectItem:r=null,onClose:n=null,isFurni:o=!0}=a,[l,c]=h.useState([]),[u,d]=h.useState("all"),[_,m]=h.useState(null),[f,E]=h.useState("");te().isModerator;const[I,p]=h.useState(o?"all":"any"),{roomSession:S=null}=vt(),[R,O]=h.useState(new Set),[C,A]=h.useState(0),[b,y]=h.useState(!1),[M,U]=h.useState(-1),[G,F]=h.useState(null),H=h.useRef(null),v=h.useMemo(()=>{if(!o)return[];const Z=f.toLocaleLowerCase();let ne=[...t];const _e=ce().getRoomObjects(S.roomId,Q.FLOOR),de=ce().getRoomObjects(S.roomId,Q.WALL);if(u!=="all"){const ae=_e.filter(Le=>Le.model.getValue(D.FURNITURE_OWNER_NAME)===u),Te=de.filter(Le=>Le.model.getValue(D.FURNITURE_OWNER_NAME)===u),Se=[...ae,...Te];ne=ne.filter(Le=>Se.some(Et=>Et.id===Le.id))}switch(I){case NB:ne=ne.filter(Se=>_e.some(Le=>Le.id===Se.id));break;case AB:ne=ne.filter(Se=>de.some(Le=>Le.id===Se.id));break;case c_:const ae=[..._e,...de].filter(Se=>{const Le=Se.model.getValue(D.FURNITURE_UNIQUE_SERIAL_NUMBER),Et=Se.model.getValue(D.FURNITURE_UNIQUE_EDITION_SIZE);return Le>0&&Et>0});ne=ne.filter(Se=>ae.some(Le=>Le.id===Se.id));break;case bB:const Te=_e.filter(Se=>Se.type.toLocaleLowerCase().startsWith("wf_")||Se.type.toLocaleLowerCase().startsWith("conf_")||Se.type.toLocaleLowerCase().startsWith("highscore_")||Se.type.toLocaleLowerCase().startsWith("compusermat_")||Se.type.toLocaleLowerCase().startsWith("memory")||Se.type.toLocaleLowerCase().startsWith("hubbe_w")||Se.type.toLocaleLowerCase().startsWith("opmsg_")||Se.type.toLocaleLowerCase().startsWith("opusermat_"));ne=ne.filter(Se=>Te.some(Le=>Le.id===Se.id));break}f!==""&&(ne=ne.filter(ae=>{var Te;return(Te=ae.name)==null?void 0:Te.toLocaleLowerCase().includes(Z)}));const me=[],fe=new Map;return ne.forEach(ae=>{fe.has(ae.name)||fe.set(ae.name,[]),fe.get(ae.name).push(ae)}),fe.forEach((ae,Te)=>{if(ae.length===1)me.push({groupItems:[],isGroup:!1,item:ae[0]});else{const Se={item:null,isGroup:!0,groupId:Te,groupItems:ae,isExpanded:R.has(Te)};me.push(Se)}}),me},[t,f,I,u,S,o,R]),B=h.useMemo(()=>{if(o)return[];let Z=[...t];const ne=ce().getRoomObjects(S.roomId,Q.UNIT);switch(I){case"players":Z=Z.filter(_e=>ne.some(de=>de.id===_e.id&&de.type==="user"));break;case"pets":Z=Z.filter(_e=>ne.some(de=>de.id===_e.id&&de.type!=="user"&&de.type!=="rentable_bot"));break;case"bots":Z=Z.filter(_e=>ne.some(de=>de.id===_e.id&&de.type==="rentable_bot"));break}if(f!==""){const _e=f.toLocaleLowerCase();return Z.filter(de=>{var me;return(me=de.name)==null?void 0:me.toLocaleLowerCase().includes(_e)})}return Z},[t,f,I,S,o]);h.useEffect(()=>{if(!o)return;const Z=[...ce().getRoomObjects(S.roomId,Q.FLOOR),...ce().getRoomObjects(S.roomId,Q.WALL)],ne=[...new Set(Z.map(fe=>fe.model.getValue(D.FURNITURE_OWNER_NAME)||"Sem dono"))];c(ne);let _e=0;const de=f.toLocaleLowerCase();let me=[...v].map(fe=>fe.isGroup?fe.groupItems:[fe.item]).flat();de.length&&(me=me.filter(fe=>fe.name.toLocaleLowerCase().includes(de))),u==="all"?_e=me.length:_e=me.filter(fe=>fe.furnitureOwner===u).length,A(_e)},[v]);const z=Z=>{O(ne=>{const _e=new Set(ne);return _e.has(Z)?_e.delete(Z):_e.add(Z),_e})},$=(Z,ne)=>{O(_e=>{const de=new Set(_e);return de.add(Z),de})},W=()=>{O(new Set)},V=Z=>{if(y(!0),Z instanceof wu){m(ne=>(ne==null?void 0:ne.id)===Z.id?null:Z);return}Z.isGroup?z(Z.groupId):m(ne=>(ne==null?void 0:ne.id)===Z.item.id?null:Z.item)},se=Z=>{m(ne=>(ne==null?void 0:ne.id)===Z.id?null:Z)},ee=Z=>{switch(Z){case 2:return"Mascote";case 4:return"Bot";default:return"Hubbe"}},ie=Z=>{H.current&&clearInterval(H.current);let ne=v.findIndex(_e=>_e.isGroup?_e.groupItems.some(de=>de.id===Z.id):_e.item.id===Z.id);ne>=0&&F(Z),U(ne),H.current=setTimeout(()=>{U(null),F(null),H.current=null},2e3)};return Sm(Z=>{if(b||!Z)return;const ne=t.find(de=>de.id===Z.id);if(!ne)return;m(null);const _e=v.find(de=>de.isGroup?de.groupItems.some(me=>me.id===ne.id):de.item.id===ne.id);_e&&_e.isGroup&&(W(),$(_e.groupId)),requestAnimationFrame(()=>{ie(ne)})}),h.useEffect(()=>{if(!_){r&&r(),y(!1);return}i(_),y(!1)},[_]),s.jsxs(ve,{className:`nitro-chooser-widget${o?"-furni":""}`,theme:"primary-slim",children:[s.jsx(je,{headerText:e,onCloseClick:n}),s.jsxs(be,{overflow:"hidden",gap:2,children:[s.jsxs(x,{gap:1,children:[s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("generic.search"),value:f,onChange:Z=>E(Z.target.value)}),s.jsxs("select",{className:"form-select form-select-sm",value:I,onChange:Z=>p(Z.target.value),children:[o&&ece.map((Z,ne)=>s.jsx("option",{value:Z,children:g(Z)},ne)),!o&&tce.map((Z,ne)=>s.jsx("option",{value:Z,children:g("chooser.filter.placement."+Z)},ne))]}),o&&s.jsxs("select",{className:"form-select form-select-sm",value:u,onChange:Z=>d(Z.target.value),children:[s.jsx("option",{value:"all",children:g(Zle)}),l.map((Z,ne)=>s.jsx("option",{value:Z,children:Z},ne))]})]}),!o&&s.jsxs(N,{overflow:"hidden",className:"content",fullHeight:!0,children:[s.jsxs(Ye,{gap:0,className:"border-bottom pb-1",textColor:"black",fullHeight:!1,children:[s.jsx(N,{size:6,children:"Nome"}),s.jsx(N,{size:3,children:"Tipo"}),s.jsx(N,{size:3,children:"Id"})]}),s.jsx(Wd,{rows:B,rowRender:Z=>s.jsxs(Ye,{alignItems:"center",gap:0,className:za("rounded p-1",_===Z&&"bg-muted"),pointer:!0,onClick:()=>se(Z),textColor:"black",children:[s.jsx(N,{size:6,children:Z.name}),s.jsx(N,{size:3,children:ee(Z.type)}),s.jsx(N,{size:3,children:Z.id})]},Z.name)})]}),o&&s.jsxs(N,{overflow:"hidden",className:"content",children:[s.jsxs(Ye,{gap:0,className:"border-bottom pb-1",textColor:"black",fullHeight:!1,children:[s.jsx(N,{size:6,children:"Nome"}),s.jsx(N,{size:3,children:"Dono"}),s.jsx(N,{size:3,children:I===c_?"Lote":"ID"})]}),s.jsx(Wd,{rows:v,rowRender:(Z,ne,_e)=>Z.isGroup?s.jsxs("div",{children:[s.jsxs(Ye,{alignItems:"center",gap:0,className:"p-1 cursor-pointer",onClick:()=>V(Z),textColor:"black",children:[s.jsxs(N,{size:6,column:!1,gap:1,children:[Z.groupId," (x",Z.groupItems.length,")",Z.isExpanded?s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 320 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M288.662 352H31.338c-17.818 0-26.741-21.543-14.142-34.142l128.662-128.662c7.81-7.81 20.474-7.81 28.284 0l128.662 128.662c12.6 12.599 3.676 34.142-14.142 34.142z"})}):s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 320 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"})})]}),s.jsx(N,{size:3}),s.jsx(N,{size:3})]}),Z.isExpanded&&Z.groupItems.map(de=>s.jsxs(zO,{alignItems:"center",gap:0,className:za("rounded p-1 ps-2",_===de&&"bg-muted"),style:{backgroundColor:`${G===de?"rgba(68,117,241,0.2)":""}`},pointer:!0,onClick:()=>V(de),textColor:"black","data-index":_e,children:[s.jsxs(N,{size:6,children:["- ",de.name]}),s.jsx(N,{size:3,children:de.furnitureOwner}),s.jsx(N,{size:3,children:I===c_?`${de.unitLote} / ${de.unitTotal}`:de.id})]},de.id))]},Z.groupId):s.jsxs(zO,{alignItems:"center",gap:0,className:za("rounded p-1",_===Z.item&&"bg-muted"),style:{backgroundColor:`${G===Z.item?"rgba(68,117,241,0.2)":""}`},pointer:!0,onClick:()=>V(Z),textColor:"black","data-index":_e,children:[s.jsx(N,{size:6,children:Z.item.name}),s.jsx(N,{size:3,children:Z.item.furnitureOwner}),s.jsx(N,{size:3,children:I===c_?`${Z.item.unitLote} / ${Z.item.unitTotal}`:Z.item.id})]},Z.item.name),scrollToIndex:M})]}),s.jsxs(T,{style:{marginLeft:"4px"},variant:"muted",children:[o?C:B.length," ",o?"mobis":I==="players"||I==="any"?"Usuário(s)":I==="pets"?"Mascote(s)":"Bot(s)"," encontrado(s)"]})]})]})},sce=a=>{const{items:e=null,onClose:t=null,selectItem:i=null,deselectItem:r=null,populateChooser:n=null}=Kie();return h.useEffect(()=>{const o={linkReceived:l=>{l.split("/"),n()},eventUrlPrefix:"furni-chooser/"};return fs(o),()=>ps(o)},[n]),e?s.jsx(vB,{title:g("widget.chooser.furni.title"),items:e,selectItem:i,deselectItem:r,onClose:t,isFurni:!0}):null},ice=a=>{const{items:e=null,onClose:t=null,selectItem:i=null,populateChooser:r=null}=en();return h.useEffect(()=>{const n={linkReceived:o=>{o.split("/"),r()},eventUrlPrefix:"user-chooser/"};return fs(n),()=>ps(n)},[r]),e?s.jsx(vB,{title:g("widget.chooser.user.title"),items:e,selectItem:i,onClose:t,isFurni:!1}):null},rce=a=>{const[e,t]=h.useState(!1),{users:i=[],answer:r=null}=Bie();return h.useEffect(()=>{t(!!i.length)},[i]),e?s.jsxs(ve,{className:"nitro-widget-doorbell",theme:"primary-slim",windowPosition:Vi.TOP_LEFT,children:[s.jsx(je,{headerText:g("navigator.doorbell.title"),onCloseClick:n=>t(!1)}),s.jsxs(be,{overflow:"hidden",gap:0,children:[s.jsx(N,{gap:2,children:s.jsxs(Ye,{gap:1,className:"text-black fw-bold border-bottom px-1 pb-1",children:[s.jsx(q,{className:"g-col-6",children:g("generic.username")}),s.jsx(q,{className:"g-col-6"})]})}),s.jsx(N,{overflow:"auto",className:"striped-children",gap:0,children:i&&i.length>0&&i.map(n=>s.jsxs(Ye,{gap:1,alignItems:"center",className:"text-black border-bottom p-1",children:[s.jsx(q,{className:"g-col-6",children:n}),s.jsx(q,{className:"g-col-6",children:s.jsxs(x,{alignItems:"center",justifyContent:"end",gap:1,children:[s.jsx(X,{variant:"success",onClick:()=>r(n,!0),children:g("generic.accept")}),s.jsx(X,{variant:"danger",onClick:()=>r(n,!1),children:g("generic.deny")})]})})]},n))})]})]}):null},UT=a=>{const{objectId:e=-1,category:t=-1,noFollow:i=!1,position:r="absolute",...n}=a,[o,l]=h.useState({x:-1,y:-1}),c=h.useRef();return h.useEffect(()=>{let u=!1;const d=()=>{const m=$e();return m?EN(m.roomId,e,t,1):null},_=()=>{const m=d();!m||!c.current||l({x:Math.round(m.left+m.width/2-c.current.offsetWidth/2),y:Math.round(m.top-c.current.offsetHeight+10)})};return i?_():(u=!0,Gi().add(_)),()=>{u&&Gi().remove(_)}},[e,t,i]),s.jsx(q,{innerRef:c,position:r,visible:o.x+(c.current?c.current.offsetWidth:0)>-1,className:"object-location",style:{left:o.x,top:o.y},...n})},nce=a=>{const{roomIndex:e=-1,request:t=null,hideFriendRequest:i=null,requestResponse:r=null}=a;return s.jsx(UT,{objectId:e,category:Q.UNIT,children:s.jsx(q,{className:"nitro-friend-request-dialog nitro-context-menu p-2",children:s.jsxs(N,{children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",gap:2,children:[s.jsx(T,{variant:"white",fontSize:6,children:g("widget.friendrequest.from",["username"],[t.name])}),s.jsx(pr,{className:"cursor-pointer fa-icon",onClick:n=>i(t.requesterUserId)})]}),s.jsxs(x,{justifyContent:"end",gap:1,children:[s.jsx(X,{variant:"danger",onClick:n=>r(t.requesterUserId,!1),children:g("widget.friendrequest.decline")}),s.jsx(X,{variant:"success",onClick:n=>r(t.requesterUserId,!0),children:g("widget.friendrequest.accept")})]})]})})})},ace=a=>{const{displayedRequests:e=[],hideFriendRequest:t=null}=Yie(),{requestResponse:i=null}=Jr();return e.length?s.jsx(s.Fragment,{children:e.map((r,n)=>s.jsx(nce,{roomIndex:r.roomIndex,request:r.request,hideFriendRequest:t,requestResponse:i},n))}):null},oce=a=>{const{productType:e=dt.FLOOR,classId:t=-1,extraParam:i=void 0}=a;switch(e){case dt.WALL:case dt.FLOOR:return s.jsx(xT,{productType:e,productClassId:t});case dt.BADGE:return s.jsx(as,{badgeCode:i});case dt.HABBO_CLUB:return s.jsx(gs,{type:"hc"})}return null},lce=a=>{const{ownerId:e=-1}=a,[t,i]=h.useState(0),[r,n]=h.useState(void 0),o=()=>{t===1&&K(new d1(e)),i(0),n(void 0)};J(F0,c=>{i(1)}),J(P0,c=>{i(0),n(void 0)}),J(U0,c=>{const u=c.getParser();n({contentType:u.contentType,classId:u.classId}),i(2)});const l=te().userId===e;return t===0?null:s.jsxs(ve,{className:"nitro-mysterybox-dialog",theme:"primary-slim",children:[s.jsx(je,{headerText:g(t===1?`mysterybox.dialog.${l?"owner":"other"}.title`:"mysterybox.reward.title"),onCloseClick:o}),s.jsxs(be,{children:[t===1&&s.jsxs(s.Fragment,{children:[s.jsxs(T,{variant:"primary",children:[" ",g(`mysterybox.dialog.${l?"owner":"other"}.subtitle`)," "]}),s.jsxs(T,{children:[" ",g(`mysterybox.dialog.${l?"owner":"other"}.description`)," "]}),s.jsxs(T,{children:[" ",g(`mysterybox.dialog.${l?"owner":"other"}.waiting`)]}),s.jsxs(X,{variant:"danger",onClick:o,className:"mt-auto",children:[" ",g(`mysterybox.dialog.${l?"owner":"other"}.cancel`)," "]})]}),t===2&&r&&s.jsxs(s.Fragment,{children:[s.jsxs(T,{variant:"black",children:[" ",g("mysterybox.reward.text")," "]}),s.jsx(x,{className:"prize-container justify-content-center mx-auto",children:s.jsx(oce,{classId:r.classId,productType:r.contentType})}),s.jsxs(X,{variant:"success",onClick:o,className:"mt-auto",children:[" ",g("mysterybox.reward.close")," "]})]})]})]})},cce=a=>{const{objectId:e=-1,onClose:t=null}=a,[i,r]=h.useState(""),n=()=>{K(new Rw(e,i)),t()};return e===-1?null:s.jsxs(ve,{className:"nitro-mysterytrophy-dialog no-resize",theme:"primary-slim",children:[s.jsx(je,{center:!0,headerText:g("mysterytrophy.header.title"),onCloseClick:t}),s.jsxs(be,{children:[s.jsxs(x,{className:"mysterytrophy-dialog-top p-3",children:[s.jsx("div",{className:"mysterytrophy-image flex-shrink-0"}),s.jsx("div",{className:"m-2",children:s.jsx(T,{variant:"white",className:"mysterytrophy-text-big",children:g("mysterytrophy.header.description")})})]}),s.jsx(x,{className:"mysterytrophy-dialog-bottom p-2",children:s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-mysterytrophy-dialog",children:[s.jsx("textarea",{className:"form-control form-control-sm input-mysterytrophy",value:i,onChange:o=>r(o.target.value)}),s.jsx("div",{className:"mysterytrophy-pencil-image flex-shrink-0 small fa-icon"})]}),s.jsxs(x,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[s.jsx(T,{pointer:!0,className:"text-decoration",onClick:()=>t(),children:g("cancel")}),s.jsx(X,{variant:"success",onClick:()=>n(),children:g("generic.ok")})]})]})})]})]})},uce=a=>{const{objectId:e=-1,onClose:t=null}=a,{roomSession:i=null}=vt(),r=()=>{i.useMultistateItem(e),t()};return s.jsxs(ve,{className:"nitro-use-product-confirmation",children:[s.jsx(je,{headerText:g("effectbox.header.title"),onCloseClick:t}),s.jsx(be,{center:!0,children:s.jsx(x,{gap:2,children:s.jsxs(N,{justifyContent:"between",children:[s.jsx(T,{children:g("effectbox.header.description")}),s.jsxs(x,{alignItems:"center",justifyContent:"between",children:[s.jsx(X,{variant:"danger",onClick:t,children:g("generic.cancel")}),s.jsx(X,{variant:"success",onClick:r,children:g("generic.ok")})]})]})})})]})},Km=-1,hce=0,dce=a=>{const{objectId:e=-1,onClose:t=null}=a,[i,r]=h.useState(null),[n,o]=h.useState(Km),{roomSession:l=null}=vt(),c=()=>{l.useMultistateItem(e),t()};return h.useEffect(()=>{if(!l||e===-1)return;const u=IT(l.roomId,e,Q.FLOOR);if(!u)return;r(u);let d=Km;switch(u.specialType){case Je.MONSTERPLANT_SEED:d=hce;break}if(d===Km){t();return}o(d)},[l,e,t]),n===Km?null:s.jsxs(ve,{className:"nitro-use-product-confirmation",children:[s.jsx(je,{headerText:g("useproduct.widget.title.plant_seed",["name"],[i.name]),onCloseClick:t}),s.jsx(be,{center:!0,children:s.jsxs(x,{gap:2,overflow:"hidden",children:[s.jsx(N,{children:s.jsx(q,{className:"product-preview",children:s.jsx(q,{className:"monsterplant-image"})})}),s.jsxs(N,{justifyContent:"between",overflow:"auto",children:[s.jsxs(N,{gap:2,children:[s.jsx(T,{children:g("useproduct.widget.text.plant_seed",["productName"],[i.name])}),s.jsx(T,{children:g("useproduct.widget.info.plant_seed")})]}),s.jsxs(x,{alignItems:"center",justifyContent:"between",children:[s.jsx(X,{variant:"danger",onClick:t,children:g("useproduct.widget.cancel")}),s.jsx(X,{variant:"success",onClick:c,children:g("widget.monsterplant_seed.button.use")})]})]})]})})]})},qm=-1,_ce=0,gce=a=>{const{objectId:e=-1,onClose:t=null}=a,[i,r]=h.useState(qm),[n,o]=h.useState(gn.MALE),[l,c]=h.useState(null),{roomSession:u=null}=vt(),d=()=>{vl().send(new Dw(e)),vl().send(new gN(n,l)),t()};return h.useEffect(()=>{let _=qm;const m=te().figure,f=te().gender,E=[];if(u&&e>=0){const I=IT(u.roomId,e,Q.FLOOR);if(I)switch(I.specialType){case Je.FIGURE_PURCHASABLE_SET:_=_ce;const p=I.customParams.split(",").map(S=>parseInt(S));for(const S of p)qt().isValidFigureSetForGender(S,f)&&E.push(S);break}}if(_===qm){t();return}o(f),c(qt().getFigureStringWithFigureIds(m,f,E)),r(_)},[u,e,t]),i===qm?null:s.jsxs(ve,{className:"nitro-use-product-confirmation",children:[s.jsx(je,{headerText:g("useproduct.widget.title.bind_clothing"),onCloseClick:t}),s.jsx(be,{center:!0,children:s.jsxs(x,{gap:2,overflow:"hidden",children:[s.jsx(N,{children:s.jsx(q,{className:"mannequin-preview",children:s.jsx(ls,{figure:l,direction:2})})}),s.jsxs(N,{justifyContent:"between",overflow:"auto",children:[s.jsxs(N,{gap:2,children:[s.jsx(T,{children:g("useproduct.widget.text.bind_clothing")}),s.jsx(T,{children:g("useproduct.widget.info.bind_clothing")})]}),s.jsxs(x,{alignItems:"center",justifyContent:"between",children:[s.jsx(X,{variant:"danger",onClick:t,children:g("useproduct.widget.cancel")}),s.jsx(X,{variant:"success",onClick:d,children:g("useproduct.widget.bind_clothing")})]})]})]})})]})},mce=a=>{const{closeConfirm:e=null,processAction:t=null,onClose:i=null,objectId:r=-1,mode:n=null,confirmMode:o=null,confirmingObjectId:l=-1,groupData:c=null,isGroupMember:u=!1,objectOwnerId:d=-1}=Dse(),{simpleAlert:_=null}=kt();J(jj,f=>{const E=f.getParser();if(E)switch(E.count){case 1:_(g("costumehopper.costumerequired.bodytext"),null,"catalog/open/temporary_effects",g("costumehopper.costumerequired.buy"),g("costumehopper.costumerequired.header"),null);break;case 2:_(g("viphopper.viprequired.bodytext"),null,"catalog/open/habbo_club",g("viprequired.buy.vip"),g("viprequired.header"),null);break;case 3:_(g("gate.viprequired.bodytext"),null,"catalog/open/habbo_club",g("viprequired.buy.vip"),g("gate.viprequired.title"),null);break}});const m=te().userId===d;return s.jsxs(s.Fragment,{children:[o===qO&&s.jsx(dce,{objectId:l,onClose:e}),o===XO&&s.jsx(gce,{objectId:l,onClose:e}),o===XG&&s.jsx(uce,{objectId:l,onClose:e}),o===$O&&s.jsx(cce,{objectId:l,onClose:e}),s.jsx(lce,{ownerId:d}),r>=0&&n&&s.jsxs(ma,{objectId:r,category:Q.FLOOR,onClose:i,fades:!0,children:[n===ys.FRIEND_FURNITURE&&s.jsxs(s.Fragment,{children:[s.jsx(mr,{children:g("friendfurni.context.title")}),s.jsx(oe,{onClick:f=>t("use_friend_furni"),children:g("friendfurni.context.use")})]}),n===ys.MONSTERPLANT_SEED&&s.jsxs(s.Fragment,{children:[s.jsx(mr,{children:g("furni.mnstr_seed.name")}),s.jsx(oe,{onClick:f=>t("use_monsterplant_seed"),children:g("widget.monsterplant_seed.button.use")})]}),n===ys.RANDOM_TELEPORT&&s.jsxs(s.Fragment,{children:[s.jsx(mr,{children:g("furni.random_teleport.name")}),s.jsx(oe,{onClick:f=>t("use_random_teleport"),children:g("widget.random_teleport.button.use")}),s.jsx(oe,{onClick:f=>t("use_random_teleport_sync"),children:g("widget.random_teleport.button.sync")})]}),n===ys.PURCHASABLE_CLOTHING&&s.jsxs(s.Fragment,{children:[s.jsx(mr,{children:g("furni.generic_usable.name")}),s.jsx(oe,{onClick:f=>t("use_purchaseable_clothing"),children:g("widget.generic_usable.button.use")})]}),n===ys.MYSTERY_BOX&&s.jsxs(s.Fragment,{children:[s.jsx(mr,{children:g("mysterybox.context.title")}),s.jsx(oe,{onClick:f=>t("use_mystery_box"),children:g("mysterybox.context."+(m?"owner":"other")+".use")})]}),n===ys.MYSTERY_TROPHY&&s.jsxs(s.Fragment,{children:[s.jsx(mr,{children:g("mysterytrophy.header.title")}),s.jsx(oe,{onClick:f=>t("use_mystery_trophy"),children:g("friendfurni.context.use")})]}),n===qG&&c&&s.jsxs(s.Fragment,{children:[s.jsx(mr,{className:"cursor-pointer text-truncate",onClick:()=>Qd(c.guildId),children:c.guildName}),!u&&s.jsx(oe,{onClick:f=>t("join_group"),children:g("widget.furniture.button.join.group")}),s.jsx(oe,{onClick:f=>t("go_to_group_homeroom"),children:g("widget.furniture.button.go.to.group.home.room")}),c.guildHasReadableForum&&s.jsx(oe,{onClick:f=>t("open_forum"),children:g("widget.furniture.button.open_group_forum")})]})]})]})},fce=a=>{const{objectId:e=-1,color:t=0,setColor:i=null,applyToner:r=null,toggleToner:n=null,onClose:o=null}=Ase();return e===-1?null:s.jsxs(ve,{theme:"primary-slim",className:"nitro-room-widget-toner",children:[s.jsx(je,{headerText:g("widget.backgroundcolor.title"),onCloseClick:o}),s.jsxs(be,{overflow:"hidden",justifyContent:"between",children:[s.jsx(N,{overflow:"auto",gap:1,children:s.jsx("input",{type:"color",className:"form-control",value:sr.makeColorNumberHex(t),onChange:l=>i(sr.convertFromHex(l.target.value))})}),s.jsxs(N,{gap:1,children:[s.jsx(X,{fullWidth:!0,variant:"primary",onClick:n,children:g("widget.backgroundcolor.button.on")}),s.jsx(X,{fullWidth:!0,variant:"primary",onClick:r,children:g("widget.backgroundcolor.button.apply")})]})]})]})},pce=a=>{const{objectId:e=-1,color:t="1",badgeName:i="",badgeDesc:r="",date:n="",senderName:o="",onClose:l=null}=vse();return e===-1?null:s.jsx(PG,{color:t,message:r,date:n,senderName:o,customTitle:i,onCloseClick:l})},Ece=a=>{const{objectId:e=-1,recipes:t=[],ingredients:i=[],selectedRecipe:r=null,requiredIngredients:n=null,isCrafting:o=!1,craft:l=null,selectRecipe:c=null,onClose:u=null}=jse(),{roomSession:d=null}=vt(),[_,m]=h.useState(!1),f=h.useMemo(()=>{const p=ce().getRoomObject(d.roomId,e,Q.FLOOR);return gr(p)},[e,d.roomId]),E=h.useMemo(()=>{if(!n||!n.length)return!1;for(const p of n){const S=i.find(R=>R.name===p.itemName);if(!S||S.count<p.count)return!1}return!0},[i,n]),I=()=>{if(!_){m(!0);return}l(),m(!1)};return h.useEffect(()=>{m(!1)},[r]),e===-1?null:s.jsxs(ve,{className:"nitro-widget-crafting",theme:"primary-slim",children:[s.jsx(je,{headerText:g("crafting.title"),onCloseClick:u}),s.jsx(be,{children:s.jsxs(x,{grow:!0,overflow:"hidden",gap:2,children:[s.jsxs(x,{column:!0,fullWidth:!0,gap:2,children:[s.jsxs(N,{overflow:"hidden",fullHeight:!0,children:[s.jsx("div",{className:"bg-muted rounded py-1 text-center",children:g("crafting.title.products")}),s.jsx(Os,{columnCount:5,children:t.length>0&&t.map(p=>s.jsx(ct,{itemImage:p.iconUrl,itemActive:r&&r.name===p.name,onClick:()=>c(p)},p.name))})]}),s.jsxs(N,{overflow:"hidden",fullHeight:!0,children:[s.jsx("div",{className:"bg-muted rounded py-1 text-center",children:g("crafting.title.mixer")}),s.jsx(Os,{columnCount:5,children:i.length>0&&i.map(p=>s.jsx(ct,{itemImage:p.iconUrl,itemCount:p.count,itemCountMinimum:0,className:(p.count?"":"opacity-0-5 ")+"cursor-default"},p.name))})]})]}),s.jsxs(x,{column:!0,fullWidth:!0,gap:2,children:[!r&&s.jsx(N,{center:!0,fullHeight:!0,className:"text-black text-center",children:g("crafting.info.start")}),r&&s.jsxs(s.Fragment,{children:[s.jsxs(N,{overflow:"hidden",fullHeight:!0,children:[s.jsx("div",{className:"bg-muted rounded py-1 text-center",children:g("crafting.current_recipe")}),s.jsx(Os,{columnCount:5,children:!!n&&n.length>0&&n.map((p,S)=>{const R=i.find(C=>C.name===p.itemName),O=p.count-R.count;return s.jsx(ct,{itemImage:R.iconUrl,itemCountMinimum:0,itemCount:O,itemUnseen:R.count>=p.count,className:(R.count>=p.count?"":"opacity-0-5 ")+"cursor-default"},S)})})]}),s.jsxs(x,{gap:2,column:!0,fullHeight:!0,children:[s.jsxs(x,{gap:2,className:"bg-muted rounded",column:!0,fullHeight:!0,children:[s.jsx("div",{className:"py-1 text-center",children:g("crafting.result")}),s.jsxs(x,{gap:1,center:!0,column:!0,fullHeight:!0,className:"pb-1",children:[s.jsx(N,{fullHeight:!0,children:s.jsx("img",{src:r.iconUrl})}),s.jsx("div",{className:"text-black",children:r.localizedName})]})]}),s.jsxs(X,{variant:!f||!E?"danger":_?"warning":o?"primary":"success",disabled:!f||!E||o,onClick:I,children:[!o&&g(f?E?_?"generic.confirm":"crafting.btn.craft":"crafting.status.recipe.incomplete":"crafting.btn.notowner"),o&&s.jsx(LN,{})]})]})]})]})]})})]})},Ice=a=>{const[e,t]=h.useState(!1),{presets:i=[],dimmerState:r=0,selectedPresetId:n=0,color:o=16777215,brightness:l=255,effectId:c=0,selectedColor:u=0,setSelectedColor:d=null,selectedBrightness:_=0,setSelectedBrightness:m=null,selectedEffectId:f=0,setSelectedEffectId:E=null,selectPresetId:I=null,applyChanges:p}=Pse(),S=()=>{No.previewDimmer(o,l,c===2),t(!1)};ut(Ie.REMOVE_DIMMER,O=>t(!1)),h.useEffect(()=>{!i||!i.length||t(!0)},[i]);const R=h.useMemo(()=>xe("widget.dimmer.colorwheel",!1),[]);return e?s.jsxs(ve,{className:"nitro-room-widget-dimmer",children:[s.jsx(je,{headerText:g("widget.dimmer.title"),onCloseClick:S}),r===1&&s.jsx($n,{children:i.map(O=>s.jsx(In,{isActive:n===O.id,onClick:C=>I(O.id),children:g(`widget.dimmer.tab.${O.id}`)},O.id))}),s.jsxs(be,{children:[r===0&&s.jsxs(N,{alignItems:"center",children:[s.jsx(q,{className:"dimmer-banner"}),s.jsx(T,{center:!0,className:"bg-muted rounded p-1",children:g("widget.dimmer.info.off")}),s.jsx(X,{fullWidth:!0,variant:"success",onClick:()=>No.changeState(),children:g("widget.dimmer.button.on")})]}),r===1&&s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{fontWeight:"bold",children:g("widget.backgroundcolor.hue")}),R&&s.jsx("input",{type:"color",className:"form-control",value:sr.makeColorNumberHex(u),onChange:O=>d(sr.convertFromHex(O.target.value))}),!R&&s.jsx(x,{alignItems:"center",children:s.jsx("input",{className:"form-control form-control-sm",type:"color",value:sr.makeColorNumberHex(u),onChange:O=>d(sr.convertFromHex(O.target.value))})})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{fontWeight:"bold",children:g("widget.backgroundcolor.lightness")}),s.jsx(cm,{className:"nitro-slider",min:No.MIN_BRIGHTNESS,max:No.MAX_BRIGHTNESS,value:_,onChange:O=>m(O),thumbClassName:"thumb percent",renderThumb:(O,C)=>s.jsx("div",{...O,children:No.scaleBrightness(C.valueNow)})})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:f===2,onChange:O=>E(O.target.checked?2:1)}),s.jsx(T,{children:g("widget.dimmer.type.checkbox")})]}),s.jsxs(x,{gap:1,children:[s.jsx(X,{fullWidth:!0,variant:"danger",onClick:()=>No.changeState(),children:g("widget.dimmer.button.off")}),s.jsx(X,{fullWidth:!0,variant:"success",onClick:p,children:g("widget.dimmer.button.apply")})]})]})]})]}):null},Tce=a=>{const{objectId:e=-1,value:t=0,onClose:i=null,redeem:r=null}=wse();return e===-1?null:s.jsxs(ve,{className:"nitro-widget-exchange-credit",theme:"primary-slim",children:[s.jsx(je,{headerText:g("catalog.redeem.dialog.title"),onCloseClick:i}),s.jsx(be,{center:!0,children:s.jsxs(x,{overflow:"hidden",gap:2,children:[s.jsx(N,{center:!0,children:s.jsx(q,{className:"exchange-image"})}),s.jsxs(N,{grow:!0,justifyContent:"between",overflow:"hidden",children:[s.jsxs(N,{gap:1,overflow:"auto",children:[s.jsx(T,{fontWeight:"bold",children:g("creditfurni.description",["credits"],[t.toString()])}),s.jsx(T,{children:g("creditfurni.prompt")})]}),s.jsx(X,{variant:"success",onClick:r,children:g("catalog.redeem.dialog.button.exchange")})]})]})})]})},Sce=a=>{var m;const{currentIndex:e=-1,objectId:t=-1,currentPhotos:i=null}=a,[r,n]=h.useState(0),[o,l]=h.useState(!1),c=i&&i.length?i[r]:null,u=f=>{l(!1),f.length&&(K(new iP(t,f)),i[r].m=f)},d=()=>{l(!1),n(f=>{let E=f+1;return E>=i.length&&(E=0),E})},_=()=>{l(!1),n(f=>{let E=f-1;return E<0&&(E=i.length-1),E})};return h.useEffect(()=>{l(!1),n(e)},[e]),c?s.jsxs(Ye,{style:{display:"flex",flexDirection:"column"},children:[s.jsxs(x,{center:!0,className:"picture-preview border border-black position-relative",style:c.w?{backgroundImage:"url("+c.w+")"}:{},children:[!c.w&&s.jsx(T,{bold:!0,children:g("camera.loading")}),s.jsx(x,{style:{position:"absolute",bottom:0,right:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)"},justifyContent:"end",children:s.jsx(T,{variant:"simple",children:new Date(c.t).toLocaleDateString()})})]}),c.m&&c.m.length&&s.jsx(T,{center:!0,children:c.m}),!c.m&&!o&&c.s===((m=te())==null?void 0:m.userId)&&s.jsx(T,{center:!0,underline:!0,className:"cursor-pointer",onClick:f=>l(!0),children:Oe().getLocalizationOrDefault("camera.add_caption","Adicionar legenda")}),o&&s.jsx("input",{autoFocus:!0,className:"form-control form-control-sm",type:"text",placeholder:Oe().getLocalizationOrDefault("camera.caption_placeholder","O dia está lindo!"),maxLength:64,onBlur:f=>u(f.target.value)}),i.length>1&&s.jsxs(x,{className:"picture-preview-buttons",alignItems:"center",children:[s.jsx(Ky,{className:"cursor-pointer picture-preview-buttons-previous fa-icon",onClick:_}),s.jsx(T,{center:!0,underline:!0,className:"cursor-pointer",onClick:f=>ir(c.s),children:c.n}),s.jsx(qy,{className:"cursor-pointer picture-preview-buttons-next fa-icon",onClick:d})]})]}):null},Rce=a=>{const{objectId:e=-1,currentPhotoIndex:t=-1,currentPhotos:i=null,onClose:r=null}=kse(),{report:n=null}=Rn();return e===-1||t===-1?null:s.jsxs(ve,{className:"nitro-external-image-widget no-resize",theme:"primary-slim",children:[s.jsx(je,{headerText:"Foto",isGalleryPhoto:!0,onReportPhoto:()=>n(xs.PHOTO,{extraData:i[t].w,roomId:i[t].s,reportedUserId:te().userId,roomObjectId:Number(i[t].u)}),onCloseClick:r}),s.jsx(be,{children:s.jsx(Sce,{currentIndex:t,currentPhotos:i,objectId:e})})]})},xce=a=>{const{objectId:e=-1,type:t=0,stage:i=0,usernames:r=[],figures:n=[],date:o=null,onClose:l=null,respond:c=null}=Bse();if(e===-1)return null;if(i>0)return s.jsxs(ve,{className:"nitro-engraving-lock",theme:"primary-slim",children:[s.jsx(je,{headerText:g("friend.furniture.confirm.lock.caption"),onCloseClick:l}),s.jsxs(be,{children:[s.jsx("h5",{className:"text-black text-center fw-bold mt-2 mb-2",children:g("friend.furniture.confirm.lock.subtitle")}),s.jsx("div",{className:"d-flex justify-content-center mb-2",children:s.jsx("div",{className:`engraving-lock-stage-${i}`})}),i===2&&s.jsx("div",{className:"text-small text-black text-center mb-2",children:g("friend.furniture.confirm.lock.other.locked")}),s.jsxs(x,{gap:1,children:[s.jsx(X,{fullWidth:!0,onClick:u=>c(!1),children:g("friend.furniture.confirm.lock.button.cancel")}),s.jsx(X,{fullWidth:!0,variant:"success",onClick:u=>c(!0),children:g("friend.furniture.confirm.lock.button.confirm")})]})]})]});if(r.length>0)return s.jsx(jc,{handleSelector:".nitro-engraving-lock-view",children:s.jsxs("div",{className:`nitro-engraving-lock-view engraving-lock-${t}`,children:[s.jsx("div",{className:"engraving-lock-close",onClick:l}),s.jsxs(x,{justifyContent:"center",children:[s.jsx("div",{className:"engraving-lock-avatar",children:s.jsx(ls,{figure:n[0],direction:2})}),s.jsx("div",{className:"engraving-lock-avatar",children:s.jsx(ls,{figure:n[1],direction:4})})]}),s.jsxs(N,{justifyContent:"between",className:"mt-1",children:[s.jsxs(N,{alignItems:"center",justifyContent:"center",gap:1,children:[s.jsxs("div",{children:[t===0&&g("lovelock.engraving.caption"),t===3&&g("wildwest.engraving.caption")]}),s.jsx("div",{children:o})]}),s.jsxs(x,{justifyContent:"center",gap:4,children:[s.jsx("div",{children:r[0]}),s.jsx("div",{children:r[1]})]})]})]})})},Oce=a=>{const{objectId:e=-1,classId:t=-1,itemType:i=null,text:r=null,isOwnerOfFurniture:n=!1,senderName:o=null,senderFigure:l=null,placedItemId:c=-1,placedItemType:u=null,placedInRoom:d=!1,imageUrl:_=null,openPresent:m=null,onClose:f=null}=sie(),{groupItems:E=[]}=$a(),{roomSession:I=null}=vt();if(e===-1)return null;const p=R=>{const O=E.find(C=>{var A;return((A=C.getItemById(R))==null?void 0:A.id)===R});O&&wd(O),f()},S=()=>{if(c>0&&d)if(u===dt.PET)I.pickupPet(c);else{const R=I.roomId,O=Q.FLOOR;ce().getRoomObject(R,c,O)!==null&&ce().processRoomObjectOperation(c,O,at.OBJECT_PICKUP)}f()};return s.jsxs(ve,{className:"nitro-gift-opening",theme:"primary-slim",children:[s.jsx(je,{headerText:g(o?"widget.furni.present.window.title_from":"widget.furni.present.window.title",["name"],[o]),onCloseClick:f}),s.jsxs(be,{children:[c===-1&&s.jsxs(N,{overflow:"hidden",children:[s.jsx(x,{center:!0,overflow:"auto",children:s.jsx(jG,{userName:o,figure:l,message:r})}),n&&s.jsxs(x,{gap:1,children:[o&&s.jsx(X,{fullWidth:!0,onClick:R=>Ce("catalog/open"),children:g("widget.furni.present.give_gift",["name"],[o])}),s.jsx(X,{fullWidth:!0,variant:"success",onClick:m,children:g("widget.furni.present.open_gift")})]})]}),c>-1&&s.jsxs(x,{gap:2,overflow:"hidden",children:[s.jsx(N,{center:!0,className:"p-2",children:s.jsx(Lc,{imageUrl:_})}),s.jsxs(N,{grow:!0,children:[s.jsxs(N,{center:!0,gap:1,children:[s.jsx(T,{wrap:!0,small:!0,children:g("widget.furni.present.message_opened")}),s.jsx(T,{bold:!0,fontSize:5,children:r})]}),s.jsxs(N,{grow:!0,gap:1,children:[s.jsxs(x,{gap:1,children:[d&&s.jsx(X,{fullWidth:!0,onClick:S,children:g("widget.furni.present.put_in_inventory")}),s.jsx(X,{fullWidth:!0,variant:"success",onClick:R=>p(c),children:g(d?"widget.furni.present.keep_in_room":"widget.furni.present.place_in_room")})]}),o&&o.length&&s.jsx(X,{fullWidth:!0,onClick:R=>Ce("catalog/open"),children:g("widget.furni.present.give_gift",["name"],[o])})]})]})]})]})]})},Cce=a=>{const{stuffDatas:e=null,getScoreType:t=null,getClearType:i=null,scoreToTime:r=null}=Yse();return!e||!e.size?null:s.jsx(s.Fragment,{children:Array.from(e.entries()).map(([n,o],l)=>{const c=t(o.scoreType),u=c.indexOf("time")>=0;return s.jsx(UT,{objectId:n,category:Q.FLOOR,children:s.jsxs(N,{className:"nitro-context-menu nitro-widget-high-score",gap:0,children:[s.jsx(mr,{children:g("high.score.display.caption",["scoretype","cleartype"],[g(`high.score.display.scoretype.${c}`),g(`high.score.display.cleartype.${i(o.clearType)}`)])}),s.jsxs(qN,{overflow:"hidden",gap:1,className:"h-100",children:[s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",children:[s.jsx(T,{center:!0,bold:!0,variant:"white",className:"col-8",children:g("high.score.display.users.header")}),s.jsx(T,{center:!0,bold:!0,variant:"white",className:"col-4",children:g(`high.score.display.${u?"time":"score"}.header`)})]}),s.jsx("hr",{className:"m-0"})]}),s.jsx(N,{overflow:"auto",gap:1,className:"overflow-y-scroll",children:o.entries.map((d,_)=>s.jsxs(x,{alignItems:"center",children:[s.jsx(T,{center:!0,variant:"white",className:"col-8",children:d.users.join(", ")}),s.jsx(T,{center:!0,variant:"white",className:"col-4",children:u?d.score>=3600?r(d.score,3):r(d.score,2):d.score})]},_))})]})]})},l)})})},Nce=a=>(qse(),null),Ace=-1,Xm=0,pS=1,ES=2,IS=3,TS=4,bce=a=>{const[e,t]=h.useState(null),[i,r]=h.useState(Ace),{objectId:n=-1,figure:o=null,gender:l=null,clubLevel:c=rr.NO_CLUB,name:u=null,setName:d=null,saveFigure:_=null,wearFigure:m=null,saveName:f=null,onClose:E=null}=$se();return h.useEffect(()=>{if(n===-1)return;const I=$e();if(I.isRoomOwner||I.controllerLevel>=pt.USER_WITH_RIGHTS||te().isModerator){r(Xm);return}if(te().gender.toLowerCase()!==l.toLowerCase()){r(TS);return}if(ti()<c){r(IS);return}r(ES)},[n,l,c]),h.useEffect(()=>{switch(i){case Xm:case TS:{const I=qt().createFigureContainer(o);xd.transformAsMannequinFigure(I),t(I.getFigureString());break}case pS:{const I=qt().createFigureContainer(te().figure);xd.transformAsMannequinFigure(I),t(I.getFigureString());break}case ES:case IS:{const I=xd.getMergedMannequinFigureContainer(te().figure,o);t(I.getFigureString());break}}},[i,o,c]),n===-1?null:s.jsxs(ve,{className:"nitro-mannequin no-resize",theme:"primary-slim",children:[s.jsx(je,{headerText:g("mannequin.widget.title"),onCloseClick:E}),s.jsx(be,{center:!0,children:s.jsxs(x,{fullWidth:!0,gap:2,overflow:"hidden",children:[s.jsx(N,{children:s.jsxs(q,{position:"relative",className:"mannequin-preview",children:[s.jsx(ls,{position:"absolute",figure:e,direction:2}),c>0&&s.jsx(gs,{className:"position-absolute end-2 bottom-2",type:"hc"})]})}),s.jsxs(N,{grow:!0,justifyContent:"between",overflow:"auto",children:[i===Xm&&s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"text",className:"form-control form-control-sm",value:u,onChange:I=>d(I.target.value),onBlur:f}),s.jsxs(N,{gap:1,children:[s.jsx(X,{variant:"success",onClick:I=>r(pS),children:g("mannequin.widget.style")}),s.jsx(X,{variant:"success",onClick:m,children:g("mannequin.widget.wear")})]})]}),i===pS&&s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:u}),s.jsx(T,{wrap:!0,children:g("mannequin.widget.savetext")})]}),s.jsxs(x,{alignItems:"center",justifyContent:"between",children:[s.jsx(T,{underline:!0,pointer:!0,onClick:I=>r(Xm),children:g("mannequin.widget.back")}),s.jsx(X,{variant:"success",onClick:_,children:g("mannequin.widget.save")})]})]}),i===ES&&s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:u}),s.jsx(T,{children:g("mannequin.widget.weartext")})]}),s.jsx(X,{variant:"success",onClick:m,children:g("mannequin.widget.wear")})]}),i===IS&&s.jsx(x,{center:!0,grow:!0,children:s.jsx(T,{children:g("mannequin.widget.clubnotification")})}),i===TS&&s.jsx(T,{children:g("mannequin.widget.wronggender")})]})]})})]})},vce=a=>(nie(),null),yB=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],yce=["blue","pink","green","yellow"],Dce=a=>{let e=yB.indexOf(a);return e===-1&&(e=0),yce[e]},Mce=a=>{const{objectId:e=-1,color:t="0",setColor:i=null,text:r="",setText:n=null,canModify:o=!1,onClose:l=null}=oie();return e===-1?null:s.jsx(jc,{handleSelector:".drag-handler",windowPosition:Vi.TOP_LEFT,children:s.jsxs("div",{className:"nitro-stickie nitro-stickie-image stickie-"+Dce(t),children:[s.jsxs("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[s.jsx("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:o&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:l}),yB.map(c=>s.jsx("div",{className:"stickie-color ms-1",onClick:u=>i(c),style:{backgroundColor:sr.makeColorHex(c)}},c))]})}),s.jsx("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:l})]}),s.jsx("div",{className:"stickie-context",children:s.jsx("textarea",{className:"context-text",value:r,onChange:c=>n(c.target.value),tabIndex:0,autoFocus:!0})})]})})},jce=a=>{const{objectId:e=-1,height:t=0,maxHeight:i=40,onClose:r=null,updateHeight:n=null}=cie(),[o,l]=h.useState(""),c=u=>{l(u);const d=parseFloat(u);isNaN(d)||d===t||n(d)};return h.useEffect(()=>{l(t.toString())},[t]),e===-1?null:s.jsxs(ve,{className:"nitro-widget-custom-stack-height",theme:"primary-slim",children:[s.jsx(je,{headerText:g("widget.custom.stack.height.title"),onCloseClick:r}),s.jsxs(be,{justifyContent:"between",children:[s.jsx(T,{children:g("widget.custom.stack.height.text")}),s.jsxs(x,{gap:2,children:[s.jsx(cm,{className:"nitro-slider",min:0,max:i,step:.01,value:t,onChange:u=>n(u),renderThumb:(u,d)=>s.jsx("div",{...u,children:d.valueNow})}),s.jsx("input",{className:"show-number-arrows",style:{width:50},type:"number",min:0,max:i,value:o,onChange:u=>c(u.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(X,{onClick:u=>K(new up(e,-100)),children:g("furniture.above.stack")}),s.jsx(X,{onClick:u=>K(new up(e,0)),children:g("furniture.floor.level")})]})]})]})},DB=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],Lce=["blue","pink","green","yellow"],Pce=["post_it","post_it_shakesp","post_it_dreams","post_it_xmas","post_it_vd","post_it_juninas"],Uce=["post_it","shakesp","dreams","christmas","heart","juninas"],wce=a=>{let e=DB.indexOf(a);return e===-1&&(e=0),Lce[e]},Fce=a=>{let e=Pce.indexOf(a);return e===-1&&(e=0),Uce[e]},kce=a=>{const{objectId:e=-1,color:t="0",text:i="",type:r="",canModify:n=!1,updateColor:o=null,updateText:l=null,trash:c=null,onClose:u=null}=hie(),[d,_]=h.useState(!1);return h.useEffect(()=>{_(!1)},[e,t,i,r]),e===-1?null:s.jsx(jc,{handleSelector:".drag-handler",windowPosition:Vi.TOP_LEFT,children:s.jsxs("div",{className:"nitro-stickie nitro-stickie-image stickie-"+(r=="post_it"?wce(t):Fce(r)),children:[s.jsxs("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[s.jsx("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:n&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:c}),r=="post_it"&&s.jsx(s.Fragment,{children:DB.map(m=>s.jsx("div",{className:"stickie-color ms-1",onClick:f=>o(m),style:{backgroundColor:sr.makeColorHex(m)}},m))})]})}),s.jsx("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:u})]}),s.jsx("div",{className:"stickie-context",children:!d||!n?s.jsx("div",{className:"context-text",onClick:m=>n&&_(!0),children:i}):s.jsx("textarea",{className:"context-text",defaultValue:i,tabIndex:0,onBlur:m=>l(m.target.value),autoFocus:!0})})]})})},Gce=a=>{const{objectId:e=-1,color:t="1",senderName:i="",date:r="",message:n="",onClose:o=null}=_ie();return e===-1?null:s.jsx(PG,{color:t,message:n,date:r,senderName:i,onCloseClick:o})},Bce=a=>{const[e,t]=h.useState(null),{objectId:i=-1,videoId:r=null,videoStart:n=0,videoEnd:o=0,currentVideoState:l=null,selectedVideo:c=null,playlists:u=[],onClose:d=null,previous:_=null,next:m=null,pause:f=null,play:E=null,selectVideo:I=null}=Iie(),p=R=>{if(t(R.target),i!==-1)switch(R.target.getPlayerState()){case-1:case 1:l!==1&&E();return;case 2:l!==2&&f()}};if(h.useEffect(()=>{if(!(l===null||!e)){if(l===pc.PLAYING&&e.getPlayerState()!==pc.PLAYING){e.playVideo();return}if(l===pc.PAUSED&&e.getPlayerState()!==pc.PAUSED){e.pauseVideo();return}}},[l,e]),i===-1)return null;const S={height:"375",width:"500",playerVars:{autoplay:1,disablekb:1,controls:0,origin:window.origin,modestbranding:1,start:n,end:o}};return s.jsxs(ve,{className:"youtube-tv-widget",children:[s.jsx(je,{headerText:g("catalog.page.youtube_tvs"),onCloseClick:d}),s.jsx(be,{children:s.jsxs("div",{className:"row w-100 h-100",children:[s.jsxs("div",{className:"youtube-video-container col-9 overflow-hidden",children:[r&&r.length>0&&s.jsx(vV,{videoId:r,opts:S,onReady:R=>t(R.target),onStateChange:p,containerClassName:"youtubeContainer"}),(!r||r.length===0)&&s.jsx("div",{className:"empty-video w-100 h-100 justify-content-center align-items-center d-flex",children:g("widget.furni.video_viewer.no_videos")})]}),s.jsxs("div",{className:"playlist-container col-3 d-flex flex-column",children:[s.jsxs("span",{className:"playlist-controls justify-content-center d-flex",children:[s.jsx("i",{className:"icon icon-youtube-prev cursor-pointer",onClick:_}),s.jsx("i",{className:"icon icon-youtube-next cursor-pointer",onClick:m})]}),s.jsx("div",{className:"mb-1",children:g("widget.furni.video_viewer.playlists")}),s.jsx(Os,{columnCount:1,columnMinWidth:80,columnMinHeight:100,className:"mb-1",overflow:"auto",children:u&&u.map((R,O)=>s.jsx(ct,{onClick:C=>I(R.video),itemActive:R.video===c,children:s.jsx("b",{children:R.title})},O))})]})]})})]})},Vce=a=>{const{diskInventory:e=null,addToPlaylist:t=null}=a,[i,r]=h.useState(-1),[n,o]=h.useState(-1),l=h.useCallback((d,_)=>{d.stopPropagation(),o(m=>m===_?-1:_)},[]),c=h.useCallback((d,_)=>{var m,f;d.stopPropagation(),t(_,(f=(m=Oe().soundManager.musicController)==null?void 0:m.getRoomItemPlaylist())==null?void 0:f.length)},[t]),u=()=>{Ce("catalog/open/"+Yg.TRAX_SONGS)};return h.useEffect(()=>{var d;if(n!==-1)return(d=Oe().soundManager.musicController)==null||d.playSong(n,Ji.PRIORITY_SONG_PLAY,0,0,0,0),()=>{var _;(_=Oe().soundManager.musicController)==null||_.stop(Ji.PRIORITY_SONG_PLAY)}},[n]),h.useEffect(()=>()=>o(-1),[]),s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-success py-3 container-fluid justify-content-center d-flex rounded",children:[s.jsx("img",{src:xe("image.library.url")+"playlist/title_mymusic.gif",className:"my-music"}),s.jsx("h2",{className:"ms-4",children:g("playlist.editor.my.music")})]}),s.jsx("div",{className:"h-100 overflow-y-scroll mt-4 py-2",children:s.jsx(Os,{columnCount:3,columnMinWidth:95,gap:1,children:e&&e.getKeys().map((d,_)=>{var I;const m=e.getKey(_),f=e.getWithIndex(_),E=(I=Oe().soundManager.musicController)==null?void 0:I.getSongInfo(f);return s.jsxs(ct,{itemActive:i===_,onClick:()=>r(p=>p===_?-1:_),classNames:["text-black"],children:[s.jsx("div",{className:"disk-image flex-shrink-0 mb-n2",style:{backgroundColor:Mk(E==null?void 0:E.songData)}}),s.jsx(T,{truncate:!0,fullWidth:!0,className:"text-center",children:E==null?void 0:E.name}),i===_&&s.jsxs(x,{position:"absolute",className:"bottom-0 mb-1 bg-secondary p-1 rounded",alignItems:"center",justifyContent:"center",gap:2,children:[s.jsx(X,{onClick:p=>l(p,f),variant:"light",children:s.jsx(q,{className:n===f?"pause-btn":"preview-song"})}),s.jsx(X,{onClick:p=>c(p,m),variant:"light",children:s.jsx(q,{className:"move-disk"})})]})]},_)})})}),s.jsxs("div",{className:"playlist-bottom text-black p-1",children:[s.jsx("h5",{children:g("playlist.editor.text.get.more.music")}),s.jsx("div",{children:g("playlist.editor.text.you.have.no.songdisks.available")}),s.jsx("div",{children:g("playlist.editor.text.you.can.buy.some.from.the.catalogue")}),s.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>u(),children:g("playlist.editor.button.open.catalogue")})]}),s.jsx("img",{src:xe("image.library.url")+"playlist/background_get_more_music.gif",className:"get-more"})]})},Hce=a=>{var d,_;const{furniId:e=-1,playlist:t=null,currentPlayingIndex:i=-1,removeFromPlaylist:r=null,togglePlayPause:n=null}=a,[o,l]=h.useState(-1),c=m=>{o===m&&r(m)},u=(m,f)=>{n(m,f!==-1?f:0)};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-primary py-3 container-fluid justify-content-center d-flex rounded",children:[s.jsx("img",{src:xe("image.library.url")+"playlist/title_playlist.gif",className:"playlist-img"}),s.jsx("h2",{className:"ms-4",children:g("playlist.editor.playlist")})]}),s.jsx("div",{className:"h-100 overflow-y-scroll py-2",children:s.jsx(x,{column:!0,gap:2,children:t&&t.map((m,f)=>s.jsxs(x,{gap:1,className:"text-black cursor-pointer "+(o===f?"border border-muted border-2 rounded":"border-2"),alignItems:"center",onClick:()=>l(E=>E===f?-1:f),children:[s.jsx(q,{onClick:()=>c(f),className:"disk-2 "+(o===f?"selected-song":""),style:{backgroundColor:o===f?"":Mk(m.songData)}}),m.name]},f))})}),(!t||t.length===0)&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"playlist-bottom text-black p-1 ms-5",children:[s.jsx("h5",{children:g("playlist.editor.add.songs.to.your.playlist")}),s.jsx("div",{children:g("playlist.editor.text.click.song.to.choose.click.again.to.move")})]}),s.jsx("img",{src:xe("image.library.url")+"playlist/background_add_songs.gif",className:"add-songs"})]}),t&&t.length>0&&s.jsxs(s.Fragment,{children:[i===-1&&s.jsx(X,{variant:"success",size:"lg",onClick:()=>u(e,o),children:g("playlist.editor.button.play.now")}),i!==-1&&s.jsxs(x,{gap:1,children:[s.jsx(X,{variant:"danger",onClick:()=>u(e,o),children:s.jsx(q,{className:"pause-song"})}),s.jsxs(x,{column:!0,children:[s.jsx(T,{bold:!0,display:"block",children:g("playlist.editor.text.now.playing.in.your.room")}),s.jsx(T,{children:((d=t[i])==null?void 0:d.name)+" - "+((_=t[i])==null?void 0:_.creator)})]})]})]})]})},Wce=a=>{const{objectId:e=-1,currentPlayingIndex:t=-1,playlist:i=null,diskInventory:r=null,onClose:n=null,togglePlayPause:o=null,removeFromPlaylist:l=null,addToPlaylist:c=null}=Jse();return e===-1?null:s.jsxs(ve,{className:"nitro-playlist-editor-widget",theme:"primary-slim",children:[s.jsx(je,{headerText:g("playlist.editor.title"),onCloseClick:n}),s.jsx(be,{children:s.jsxs("div",{className:"d-flex flex-row gap-1 h-100",children:[s.jsx("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:s.jsx(Vce,{addToPlaylist:c,diskInventory:r})}),s.jsx("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:s.jsx(Hce,{furniId:e,removeFromPlaylist:l,playlist:i,togglePlayPause:o,currentPlayingIndex:t})})]})})]})},Yce=()=>{const[a,e]=h.useState(-1),[t,i]=h.useState(-1),[r,n]=h.useState(!1),o=h.useRef(0),l=h.useRef(0),c=h.useRef(0),u=h.useRef(0),d=h.useRef(!1),_=h.useRef(!1),m=h.useRef(!1),f=h.useRef(!1),E=h.useRef(!1),{roomSession:I=null}=vt(),p=()=>I.isRoomOwner||I.controllerLevel>=pt.USER_WITH_RIGHTS||te().isModerator;ut(im.UPDATE_STATE_AREA_HIDE,A=>{A.objectId===a&&(e(A.objectId),i(A.category),n(A.isOn))}),ut(Ie.REQUEST_HIDE_AREA,A=>{if(!p())return;const b=ce().getRoomObject(A.roomId,A.objectId,A.category);b&&(e(A.objectId),i(A.category),n(b.getState(0)===1),o.current=b.model.getValue(D.FURNITURE_AREA_HIDE_ROOT_X),l.current=b.model.getValue(D.FURNITURE_AREA_HIDE_ROOT_Y),c.current=b.model.getValue(D.FURNITURE_AREA_HIDE_WIDTH),u.current=b.model.getValue(D.FURNITURE_AREA_HIDE_LENGTH),d.current=b.model.getValue(D.FURNITURE_AREA_HIDE_INVISIBILITY)===1,_.current=b.model.getValue(D.FURNITURE_AREA_HIDE_WALLITEMS)===1,m.current=b.model.getValue(D.FURNITURE_AREA_HIDE_INVERT)===1,f.current=b.model.getValue(D.FURNITURE_AREA_HIDE_ENTITIES)===1,E.current=b.model.getValue(D.FURNITURE_AREA_HIDE_WALKABLE)===1)});const S=()=>I.useMultistateItem(a),R=()=>{e(-1),i(-1),n(!1),o.current=0,l.current=0,c.current=0,u.current=0,d.current=!1,_.current=!1,m.current=!1,f.current=!1,E.current=!1},O=()=>{a!==-1&&K(new ko(a))},C=h.useCallback(()=>{a!==-1&&K(new wk(a,o.current,l.current,c.current,u.current,d.current,_.current,m.current,f.current,E.current))},[a]);return Zr(a!==-1&&t!==-1,A=>{A.id!==a||A.category!==t||R()}),{objectId:a,isOn:r,rootX:o,rootY:l,width:c,length:u,invisibility:d,wallItems:_,invert:m,hideEntities:f,walkable:E,toggleAreaHide:S,onCloseClick:R,useAreaHide:O,updateData:C}},MB=Yce,zce=a=>{const{objectId:e=-1,isOn:t=!1,onCloseClick:i=null,useAreaHide:r=null,length:n=null,rootX:o=null,rootY:l=null,width:c=null,invisibility:u=null,invert:d=null,wallItems:_=null,updateData:m=null,hideEntities:f=null,walkable:E=null}=MB(),[I,p]=h.useState(!1),[S,R]=h.useState(u.current),[O,C]=h.useState(_.current),[A,b]=h.useState(d.current),[y,M]=h.useState(f.current),[U,G]=h.useState(E.current),[F,H]=h.useState(!1),v=h.useCallback((ne,_e,de,me)=>{o.current=ne,l.current=_e,c.current=de,n.current=me,p(!1),m()},[n,o,l,m,c]),B=h.useCallback(()=>{Oe().roomEngine.areaSelectionManager.setHighlight(o.current,l.current,c.current,n.current)},[n,o,l,c]);h.useEffect(()=>()=>{F&&Oe().roomEngine.areaSelectionManager.deactivate()},[F]),h.useEffect(()=>{if(e!==-1)return t?F&&(Oe().roomEngine.areaSelectionManager.deactivate(),H(!1)):(F||H(Oe().roomEngine.areaSelectionManager.activate(v,"highlight_darken")),F&&setTimeout(()=>{B()},400)),()=>{F&&(Oe().roomEngine.areaSelectionManager.deactivate(),H(!1))}},[t,e,v,F,B]),h.useEffect(()=>{C(_.current),b(d.current),R(u.current),M(f.current),G(E.current)},[e]);const z=()=>{Oe().roomEngine.areaSelectionManager.startSelecting(),p(!0)},$=()=>{Oe().roomEngine.areaSelectionManager.clearHighlight()},W=()=>{F&&Oe().roomEngine.areaSelectionManager.deactivate(),H(!1),i()},V=ne=>{R(ne),u.current=ne,m()},se=ne=>{b(ne),d.current=ne,m()},ee=ne=>{C(ne),_.current=ne,m()},ie=ne=>{M(ne),f.current=ne,m()},Z=ne=>{G(ne),E.current=ne,m()};return e===-1?null:s.jsxs(ve,{className:"nitro-hide-area no-resize",theme:"primary-slim",alignItems:"center",justifyContent:"center",children:[s.jsx(je,{headerText:g("hidearea.widget.title"),onCloseClick:ne=>W()}),s.jsxs(be,{children:[s.jsxs(N,{gap:0,className:"nitro-layout-hide-area",style:{backgroundColor:"#ffffff",padding:"5px 10px",border:"1px solid rgb(153 153 153)",borderRadius:"5px",opacity:t?.5:1},children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.area_selection.select")}),s.jsx(T,{className:"mt-2 text-xs",children:g("wiredfurni.params.area_selection.info")}),s.jsxs(x,{className:"mt-2",alignItems:"center",gap:2,children:[s.jsx(X,{variant:"simple",disabled:I||!F,onClick:z,children:g("Selecione a área")}),s.jsx(X,{variant:"simple",disabled:!F,onClick:$,children:g("wiredfurni.params.area_selection.clear")})]}),s.jsx(T,{className:"mt-3",bold:!0,children:g("wiredfurni.params.hide_area.options")}),s.jsxs(x,{className:"mt-2",gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input flex-shrink-0",type:"checkbox",id:"wallitems",checked:O,onChange:ne=>ee(ne.target.checked),disabled:t}),s.jsx(T,{children:g("wiredfurni.params.hide_area.option.1")})]}),s.jsxs(x,{className:"mt-2",gap:1,children:[s.jsx("input",{className:"form-check-input flex-shrink-0",type:"checkbox",id:"invert",checked:A,onChange:ne=>se(ne.target.checked),disabled:t}),s.jsxs(N,{gap:0,children:[s.jsx(T,{style:{width:"fit-content"},children:g("wiredfurni.params.hide_area.option.2")}),s.jsx("span",{className:"text-black",style:{opacity:.5,fontSize:"12px"},children:"Mantenha a área selecionada visível e oculte o resto do quarto."})]})]}),s.jsxs(x,{className:"mt-2",gap:1,display:"none",children:[s.jsx("input",{className:"form-check-input flex-shrink-0",type:"checkbox",id:"hideEntities",checked:y,onChange:ne=>ie(ne.target.checked),disabled:!0}),s.jsxs(N,{gap:0,children:[s.jsx(T,{style:{width:"fit-content"},children:g("wiredfurni.params.hide_area.option.4")}),s.jsx("span",{className:"text-black",style:{opacity:.5,fontSize:"12px"},children:"Oculta as entidades dentro da área ocultada. (Beta)"})]})]}),s.jsxs(x,{className:"mt-2",gap:1,children:[s.jsx("input",{className:"form-check-input flex-shrink-0",type:"checkbox",id:"invisible",checked:S,onChange:ne=>V(ne.target.checked),disabled:t}),s.jsxs(N,{gap:0,children:[s.jsx(T,{style:{width:"fit-content"},children:g("wiredfurni.params.hide_area.option.3")}),s.jsx("span",{className:"text-black",style:{opacity:.5,fontSize:"12px"},children:'Mobis invisíveis podem ser controlados com o "Controlador de Mobis invisíveis" ou pelo comando ":wired"'})]})]}),s.jsxs(x,{className:"mt-2",gap:1,children:[s.jsx("input",{className:"form-check-input flex-shrink-0",type:"checkbox",id:"invisible",checked:U,onChange:ne=>Z(ne.target.checked),disabled:t}),s.jsxs(N,{gap:0,children:[s.jsx(T,{style:{width:"fit-content"},children:g("wiredfurni.params.hide_area.option.5")}),s.jsx("span",{className:"text-black",style:{opacity:.5,fontSize:"12px"},children:"Bloquear caminhada dentro da área ocultada."})]})]})]}),s.jsxs(x,{gap:1,alignItems:"center",justifyContent:"end",children:[!t&&s.jsx(X,{variant:"simple",onClick:r,children:g("wiredfurni.params.hide_area.turn_on")}),t&&s.jsx(X,{variant:"simple",onClick:r,children:g("wiredfurni.params.hide_area.turn_off")})]})]})]})},Kce=a=>{const{objectId:e=-1}=MB();return e===-1?null:s.jsx(zce,{})},qce=a=>{const{renter:e,isRoomOwner:t,onRent:i,onCancelRent:r,onClose:n}=Sie(),{getCurrencyAmount:o}=Qa();return e?s.jsxs(ve,{className:"nitro-guide-tool no-resize",theme:"primary-slim",children:[s.jsx(je,{headerText:g("rentablespace.widget.title"),onCloseClick:n}),s.jsx(be,{className:"text-black",children:s.jsxs(N,{children:[!e.rented&&s.jsxs(s.Fragment,{children:[s.jsx(T,{children:g("rentablespace.widget.instructions")}),s.jsxs(X,{pointer:!0,center:!0,variant:"muted",alignItems:"center",justifyContent:"center",gap:2,onClick:i,disabled:o(0)<e.price,children:[e.price+" x",s.jsxs(x,{alignItems:"center",justifyContent:"center",gap:1,children:[s.jsx(gs,{type:0,className:"mt-1"}),g("catalog.purchase_confirmation.rent")]})]}),o(0)<e.price&&s.jsx("div",{style:{color:"red"},children:g("rentablespace.widget.error_reason_not_enough_duckets")})]}),e.rented&&s.jsxs(s.Fragment,{children:[s.jsx(T,{bold:!0,children:g("rentablespace.widget.rented_to_label")}),s.jsx(T,{italics:!0,children:e.renterName}),s.jsx(T,{bold:!0,children:g("rentablespace.widget.expires_label")}),s.jsx(T,{italics:!0,children:Mr.shortFormat(e.timeRemaining)}),(t||te().userId===e.renterId)&&s.jsx(X,{variant:"danger",className:"mt-2",onClick:r,children:g("rentablespace.widget.cancel_rent")})]})]})})]}):null},Xce=()=>{const{visible:a,close:e,openMaleEditor:t,openFemaleEditor:i,maleFigure:r,femaleFigure:n,ownerId:o}=MT(),l=te()&&te().userId===o;return a?s.jsxs(ve,{className:"nitro-football-gate no-resize",theme:"primary-slim",children:[s.jsx(je,{headerText:g("furniture.clothing_change"),onCloseClick:e}),s.jsxs(be,{overflow:"hidden",column:!0,gap:2,children:[s.jsx(x,{fullWidth:!0,alignItems:"center",justifyContent:"center",children:s.jsx(T,{bold:!0,children:g(l?"widget.furniture.clothing_change.info":"widget.furniture.clothing_change.info2")})}),l&&s.jsxs(x,{justifyContent:"between",className:"mt-4 px-2",fullHeight:!0,children:[s.jsxs(N,{children:[s.jsx(q,{position:"relative",className:"mannequin-preview",children:s.jsx(ls,{position:"absolute",figure:r,direction:2})}),s.jsx(X,{size:"sm",onClick:t,children:g("widget.furniture.clothing_change.team0")})]}),s.jsxs(N,{children:[s.jsx(q,{position:"relative",className:"mannequin-preview",children:s.jsx(ls,{position:"absolute",figure:n,direction:2})}),s.jsx(X,{size:"sm",onClick:i,children:g("widget.furniture.clothing_change.team1")})]})]})]})]}):null},$ce=a=>{const{stuffDatas:e=null,scoreToTime:t=null,highscoreData:i=null,save:r=null,close:n=null}=Nie(),[o,l]=h.useState(""),[c,u]=h.useState(-1),[d,_]=h.useState(0),[m,f]=h.useState(0),[E,I]=h.useState(""),[p,S]=h.useState(""),[R,O]=h.useState(0),[C,A]=h.useState(!1),[b,y]=h.useState(!1),[M,U]=h.useState(0),[G,F]=h.useState(new Map);h.useEffect(()=>{if(!i){l(""),u(-1),_(0),f(0),I(""),S(""),O(0),A(!1),y(!1),U(0),F(new Map);return}l(i.scoreName),u(i.variableId),_(i.exhibitionType),f(i.comparatorType),I(i.columnName),S(i.columnPointsName),O(i.exhibitionLimit),A(i.onlyUsersInRoom),y(i.filterByValue),U(i.filterValue),F(i.variables)},[i]);const H=()=>{i&&(r(o,c,d,m,E,p,R,C?1:0,b?1:0,M),n())},v=h.useMemo(()=>i?!(c<=0||!o||!E||!p||R<=0||R>50):!1,[i,c,o,E,p,R]);return!i&&(!e||!e.size)?null:s.jsxs(s.Fragment,{children:[!!e&&e.size>0&&Array.from(e.entries()).map(([B,z],$)=>{z.exhibitionType;const W=z.exhibitionType===1;return z.exhibitionType,s.jsx(UT,{objectId:B,category:Q.FLOOR,children:s.jsxs(N,{className:"nitro-widget-high-score nitro-context-menu",gap:0,children:[s.jsx(mr,{children:z.scoreName}),s.jsxs(qN,{overflow:"hidden",gap:1,className:"h-100",children:[s.jsxs(N,{gap:1,children:[!!z.entries&&z.entries.length>0&&s.jsxs(x,{alignItems:"center",children:[s.jsx(T,{center:!0,bold:!0,variant:"white",className:"col-8",children:z.columnName}),s.jsx(T,{center:!0,bold:!0,variant:"white",className:"col-4",children:z.columnPointsName})]}),s.jsx("hr",{className:"m-0"})]}),s.jsx(N,{overflow:"auto",gap:1,className:"overflow-y-scroll",children:z.entries.map((V,se)=>s.jsxs(x,{alignItems:"center",children:[s.jsx(T,{center:!0,variant:"white",className:"col-8",children:V.user}),s.jsx(T,{center:!0,variant:"white",className:"col-4",children:W?Number(V.score)>=3600?t(Number(V.score),3):t(Number(V.score),2):V.score||0})]},se))})]})]})},$)}),i&&s.jsxs(ve,{theme:"primary-slim",className:"nitro-high-score-variable",uniqueKey:"high-score-variable",children:[s.jsx(je,{headerText:g("nitro.highscore.variable.conf_title"),onCloseClick:n}),s.jsx(be,{children:s.jsxs(N,{gap:2,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("highscore.variable.id")}),s.jsxs("select",{className:"form-select form-select-sm",value:c,onChange:B=>u(parseInt(B.target.value)),children:[c==-1&&s.jsx("option",{value:-1,children:g("highscore.variable.select")},-1),Array.from(G.entries()).map(([B,z],$)=>s.jsx("option",{value:B,children:z},$))]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("highscore.variable.name")}),s.jsx("input",{className:"form-control form-control-sm",maxLength:35,value:o,onChange:B=>l(B.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("highscore.variable.column_name")}),s.jsx("input",{className:"form-control form-control-sm",maxLength:35,value:E,onChange:B=>I(B.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("highscore.variable.column_points_name")}),s.jsx("input",{className:"form-control form-control-sm",maxLength:35,value:p,onChange:B=>S(B.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("highscore.variable.exhibition_type")}),s.jsxs("select",{className:"form-select form-select-sm",value:d,onChange:B=>_(parseInt(B.target.value)),children:[s.jsx("option",{value:0,children:g("highscore.variable.exhibition_type.points")}),s.jsx("option",{value:1,children:g("highscore.variable.exhibition_type.time")}),s.jsx("option",{value:2,disabled:!0,children:g("highscore.variable.exhibition_type.date")})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("highscore.variable.comparator_type")}),s.jsxs("select",{className:"form-select form-select-sm",value:m,onChange:B=>f(parseInt(B.target.value)),children:[s.jsx("option",{value:0,children:g("highscore.variable.comparator_type.greater")}),s.jsx("option",{value:1,children:g("highscore.variable.comparator_type.less")}),s.jsx("option",{value:2,children:g("highscore.variable.comparator_type.oldest")}),s.jsx("option",{value:3,children:g("highscore.variable.comparator_type.newest")}),s.jsx("option",{value:4,children:g("highscore.variable.comparator_type.oldest_modified")}),s.jsx("option",{value:5,children:g("highscore.variable.comparator_type.newest_modified")})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("highscore.variable.exhibition_limit")}),s.jsx("input",{className:"form-control form-control-sm",type:"number",value:R,max:50,min:1,onChange:B=>O(parseInt(B.target.value))})]}),s.jsxs(x,{gap:2,children:[s.jsx("input",{type:"checkbox",checked:C,onChange:B=>A(B.target.checked)}),s.jsx(T,{children:g("highscore.variable.only_users_in_room")})]}),s.jsxs(x,{gap:2,children:[s.jsx("input",{type:"checkbox",checked:b,onChange:B=>y(B.target.checked)}),s.jsx(T,{children:g("highscore.variable.filter_by_value")})]}),b&&s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("highscore.variable.filter_value")}),s.jsx("input",{className:"form-control form-control-sm",type:"number",value:M,min:0,onChange:B=>U(parseInt(B.target.value))})]}),s.jsx(X,{fullWidth:!0,alignItems:"center",justifyContent:"center",className:"btn-sm",onClick:H,disabled:!v,children:g("highscore.variable.save")})]})})]})]})},Qce=a=>s.jsxs(q,{fit:!0,position:"absolute",className:"nitro-room-widgets top-0 start-0",children:[s.jsx(fce,{}),s.jsx(pce,{}),s.jsx(Ece,{}),s.jsx(Xce,{}),s.jsx(Ice,{}),s.jsx(Tce,{}),s.jsx(Rce,{}),s.jsx(xce,{}),s.jsx(Oce,{}),s.jsx($ce,{}),s.jsx(Cce,{}),s.jsx(Nce,{}),s.jsx(bce,{}),s.jsx(Wce,{}),s.jsx(vce,{}),s.jsx(Mce,{}),s.jsx(jce,{}),s.jsx(kce,{}),s.jsx(Gce,{}),s.jsx(Kce,{}),s.jsx(mce,{}),s.jsx(Bce,{}),s.jsx(qce,{})]}),Jce=a=>{const{isVisible:e=!1,errorResult:t=null,petName:i=null,objectType:r=null,onChangePetName:n=null,onConfirm:o=null,onClose:l=null}=Xie();return s.jsx(s.Fragment,{children:e&&s.jsxs(ve,{className:"nitro-pet-package no-resize",theme:"primary-slim",children:[s.jsx(je,{center:!0,headerText:g(r==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage.open"),onCloseClick:()=>l()}),s.jsxs(be,{children:[s.jsxs(x,{className:"pet-package-container-top p-3",children:[s.jsx("div",{className:`package-image-${r} flex-shrink-0`}),s.jsx("div",{className:"m-2",children:s.jsx(T,{variant:"white",className:"package-text-big",children:g(r==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage")})})]}),s.jsx(x,{className:"pet-package-container-bottom p-2",children:s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-pet-package-container",children:[s.jsx("input",{type:"text",className:"form-control form-control-sm input-pet-package",maxLength:xe("pet.package.name.max.length"),placeholder:g(r==="gnome_box"?"widgets.gnomepackage.name.select":"widgets.petpackage.name.title"),value:i,onChange:c=>n(c.target.value)}),s.jsx("div",{className:"package-pencil-image flex-shrink-0 small fa-icon"})]}),t.length>0&&s.jsx(q,{className:"invalid-feedback d-block m-0",children:t}),s.jsxs(x,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[s.jsx(T,{pointer:!0,className:"text-decoration",onClick:()=>l(),children:g("cancel")}),s.jsx(yV,{variant:i.length<3?"danger":"success",disabled:i.length<3,onClick:()=>o(),children:g(r==="gnome_box"?"widgets.gnomepackage.name.pick":"furni.petpackage.confirm")})]})]})})]})]})})},Zce=a=>{const[e,t]=h.useState("bobba"),[i,r]=h.useState(""),[n,o]=h.useState(!1),{wordsFilter:l=[],isVisible:c=null,setWordsFilter:u,onClose:d=null}=Hie(),{navigatorData:_=null}=Ir(),m=I=>{(n?!i:!e)||(K(new S1(_.enteredGuestRoom.roomId,I,n?i:e)),r(""),t("bobba"),o(!1),!(I&&l.includes(n?i:e))&&u(p=>{const S=[...p];return I?S.push(n?i:e):S.splice(S.indexOf(n?i:e),1),S}))},f=I=>{t(I),o(!1)},E=I=>{r(I),o(!0)};return c?s.jsxs(ve,{className:"nitro-guide-tool no-resize",theme:"primary-slim",children:[s.jsx(je,{headerText:g("navigator.roomsettings.roomfilter"),onCloseClick:()=>d()}),s.jsxs(be,{className:"text-black",children:[s.jsxs(Ye,{className:"d-flex align-items-center justify-content-end gap-2",children:[s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:255,value:e,onChange:I=>f(I.target.value)}),s.jsx(X,{onClick:()=>m(!0),children:g("navigator.roomsettings.roomfilter.addword")})]}),s.jsx(N,{overflow:"auto",gap:0,className:"form-control form-control-sm",style:{height:"100px"},children:l&&l.length>0&&l.map((I,p)=>s.jsx(x,{alignItems:"center",className:za("rounded p-1",i===I&&"bg-muted"),pointer:!0,onClick:S=>E(I),children:s.jsx(T,{truncate:!0,children:I})},p))}),s.jsx(Ye,{className:"d-flex align-items-center justify-content-end gap-2",children:s.jsx(X,{variant:"danger",onClick:()=>m(!1),disabled:l.length===0||!n,children:g("navigator.roomsettings.roomfilter.removeword")})})]})]}):null},eue=a=>{const[e,t]=h.useState(!1),{roomSession:i=null}=vt();Js([bo.SHOW_THUMBNAIL,bo.HIDE_THUMBNAIL,bo.TOGGLE_THUMBNAIL],n=>{switch(n.type){case bo.SHOW_THUMBNAIL:t(!0);return;case bo.HIDE_THUMBNAIL:t(!1);return;case bo.TOGGLE_THUMBNAIL:t(o=>!o);return}});const r=n=>{ce().saveTextureAsScreenshot(n,!0),t(!1)};return e?s.jsx(Dte,{roomId:i.roomId,textureReceiver:r,onClose:()=>t(!1)}):null},tue=()=>{const[a,e]=h.useState(!1),[t,i]=h.useState(null),[r,n]=h.useState(null),[o,l]=h.useState(null),{isMobile:c}=Ia(),[u,d]=h.useState(!1),[_,m]=h.useState(!c),{navigatorData:f=null}=Ir(),{roomSession:E=null}=vt(),{activeChat:I,setActiveChat:p}=Ea(),S=()=>{const O=$e();return O===null?!1:O.isRoomOwner||O.controllerLevel>=pt.USER_WITH_RIGHTS||te().isModerator},R=(O,C)=>{switch(O){case"settings":Ce("navigator/toggle-room-info");return;case"zoom":e(A=>{let b=ce().getRoomInstanceRenderingCanvasScale(E.roomId,1);return A?b*=2:b/=2,ce().setRoomInstanceRenderingCanvasScale(E.roomId,1,b),!A});return;case"chat_history":Ce("chat-history/toggle");return;case"hubbedj":Me.call("openHubbeDJ",!0);break;case"like_room":K(new I1(1));return;case"toggle_room_link":Ce("navigator/toggle-room-link");return;case"construction":Me.call("openConstruction",!0);return;case"navigator_search_tag":Ce(`navigator/search/${C}`),K(new Ku("hotel_view",`tag:${C}`));return;case"toggle_chat":p(!I);return}};return J(bl,O=>{const C=O.getParser();!C.roomEnter||C.data.roomId!==E.roomId||(t!==C.data.roomName&&i(C.data.roomName),r!==C.data.ownerName&&n(C.data.ownerName),o!==C.data.tags&&l(C.data.tags))}),h.useEffect(()=>{d(!0);const O=setTimeout(()=>d(!1),5e3);return()=>clearTimeout(O)},[t,r,o]),s.jsxs(x,{className:`nitro-room-tools-container ${_?"":"room-widget-open"}`,gap:2,children:[s.jsxs(x,{center:!0,children:[s.jsxs(N,{center:!0,className:"p-2 nitro-room-tools",children:[s.jsx(q,{pointer:!0,title:g("room.settings.button.text"),className:"icon icon-cog",onClick:()=>R("settings")}),s.jsx(q,{pointer:!0,title:g("room.zoom.button.text"),onClick:()=>R("zoom"),className:za("icon",!a&&"icon-zoom-less",a&&"icon-zoom-more")}),s.jsx(q,{pointer:!0,title:g("room.chathistory.button.text"),onClick:()=>R("chat_history"),className:"icon icon-chat-history"}),S()&&s.jsx(q,{pointer:!0,title:g("room.constructiontool.button.text"),onClick:()=>R("construction"),className:"icon icon-chat-construction"}),s.jsx(q,{pointer:!0,title:g("room.hubbedj.button.text"),onClick:()=>R("hubbedj"),className:"icon icon-chat-youtube"}),s.jsx(q,{pointer:!0,title:I?"Desativar chat":"Ativar chat",onClick:()=>R("toggle_chat"),className:za("icon",I?"chat-active":"chat-desactive")}),f.canRate&&s.jsx(q,{pointer:!0,title:g("room.like.button.text"),onClick:()=>R("like_room"),className:"icon icon-like-room"})]}),s.jsx(x,{alignItems:"center",className:"mobile-close-option",onClick:()=>m(!_),children:_?s.jsx(ds,{className:"fa-icon"}):s.jsx(_s,{className:"fa-icon"})})]}),s.jsx(N,{justifyContent:"center",children:s.jsx(Hd,{type:Nr.SLIDE_LEFT,inProp:u,timeout:300,children:s.jsx(N,{center:!0,children:s.jsxs(N,{className:"nitro-room-tools-info rounded py-2 px-3",children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{className:"overflow-hidden text-ellipsis",wrap:!0,variant:"white",fontSize:4,children:t}),s.jsx(T,{variant:"muted",fontSize:5,children:r})]}),o&&o.length>0&&s.jsx(x,{gap:2,children:o.map((O,C)=>s.jsxs(T,{small:!0,pointer:!0,variant:"white",className:"rounded bg-primary p-1",onClick:()=>R("navigator_search_tag",O),children:["#",O]},C))})]})})})})]})},sue=a=>{const{question:e=null,canVote:t=null,vote:i=null,noVotes:r=null,yesVotes:n=null}=a;return s.jsxs(N,{gap:2,className:"wordquiz-question p-2",children:[!t&&s.jsxs(x,{fullWidth:!0,alignItems:"center",gap:2,children:[s.jsx(x,{center:!0,pointer:!0,className:"bg-danger rounded p-2",children:s.jsx(T,{variant:"white",children:r})}),s.jsx(T,{variant:"white",center:!0,textBreak:!0,children:e}),s.jsx(x,{center:!0,pointer:!0,className:"bg-success rounded p-2",children:s.jsx(T,{variant:"white",children:n})})]}),t&&s.jsxs(N,{children:[s.jsx(T,{variant:"white",center:!0,textBreak:!0,children:e}),s.jsxs(x,{fullWidth:!0,justifyContent:"center",gap:1,children:[s.jsx(x,{center:!0,pointer:!0,className:"bg-danger rounded p-1",onClick:o=>i(xp),children:s.jsx(q,{className:"word-quiz-dislike"})}),s.jsx(x,{center:!0,pointer:!0,className:"bg-success rounded p-1",onClick:o=>i(Lk),children:s.jsx(q,{className:"word-quiz-like"})})]})]})]})},iue=a=>{const{userIndex:e=null,vote:t=null,...i}=a;return s.jsx(UT,{objectId:e,category:Q.UNIT,...i,children:s.jsx(x,{center:!0,pointer:!0,className:`bg-${t===xp?"danger":"success"} rounded p-1`,children:s.jsx(q,{className:`word-quiz-${t===xp?"dislike":"like"}-sm`})})})},rue=a=>{const{question:e=null,answerSent:t=!1,answerCounts:i=null,userAnswers:r=null,vote:n=null}=tre();return s.jsxs(s.Fragment,{children:[e&&s.jsx(sue,{question:e.content,canVote:!t,vote:n,noVotes:i.get(xp)||0,yesVotes:i.get(Lk)||0}),r&&Array.from(r.entries()).map(([o,l],c)=>s.jsx(iue,{userIndex:o,vote:l.value},c))]})},nue=()=>{const{roomSession:a=null}=vt(),{simpleAlert:e=null}=kt();return ut(Sf.ROOM_ZOOM,t=>ce().setRoomInstanceRenderingCanvasScale(t.roomId,1,t.level,null,null,!1,t.asDelta)),ut([Ie.REQUEST_TEASER,Ie.REQUEST_ECOTRONBOX,Ie.REQUEST_CLOTHING_CHANGE,Ie.REQUEST_PLAYLIST_EDITOR,Ie.OPEN_WIDGET,Ie.CLOSE_WIDGET,Mo.FURNI_CLICK,Mo.FURNI_DOUBLE_CLICK,Mo.TOOLTIP_SHOW,Mo.TOOLTIP_HIDE],t=>{if(a)switch(t.objectId,t.category,t.type){}}),ms([Pt.RSEME_KICKED,Pt.RSEME_PETS_FORBIDDEN_IN_HOTEL,Pt.RSEME_PETS_FORBIDDEN_IN_FLAT,Pt.RSEME_MAX_PETS,Pt.RSEME_MAX_NUMBER_OF_OWN_PETS,Pt.RSEME_NO_FREE_TILES_FOR_PET,Pt.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET,Pt.RSEME_BOTS_FORBIDDEN_IN_HOTEL,Pt.RSEME_BOTS_FORBIDDEN_IN_FLAT,Pt.RSEME_BOT_LIMIT_REACHED,Pt.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT,Pt.RSEME_BOT_NAME_NOT_ACCEPTED],t=>{let i=g("error.title"),r="";switch(t.type){case Pt.RSEME_MAX_PETS:r=g("room.error.max_pets");break;case Pt.RSEME_MAX_NUMBER_OF_OWN_PETS:r=g("room.error.max_own_pets");break;case Pt.RSEME_KICKED:r=g("room.error.kicked"),i=g("generic.alert.title");break;case Pt.RSEME_PETS_FORBIDDEN_IN_HOTEL:r=g("room.error.pets.forbidden_in_hotel");break;case Pt.RSEME_PETS_FORBIDDEN_IN_FLAT:r=g("room.error.pets.forbidden_in_flat");break;case Pt.RSEME_NO_FREE_TILES_FOR_PET:r=g("room.error.pets.no_free_tiles");break;case Pt.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET:r=g("room.error.pets.selected_tile_not_free");break;case Pt.RSEME_BOTS_FORBIDDEN_IN_HOTEL:r=g("room.error.bots.forbidden_in_hotel");break;case Pt.RSEME_BOTS_FORBIDDEN_IN_FLAT:r=g("room.error.bots.forbidden_in_flat");break;case Pt.RSEME_BOT_LIMIT_REACHED:r=g("room.error.max_bots");break;case Pt.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT:r=g("room.error.bots.selected_tile_not_free");break;case Pt.RSEME_BOT_NAME_NOT_ACCEPTED:r=g("room.error.bots.name.not.accepted");break;default:return}e(r,lt.DEFAULT,null,null,i)}),s.jsxs(s.Fragment,{children:[s.jsx(Hle,{}),s.jsx(Qle,{}),s.jsx(Yle,{}),s.jsx(rce,{}),s.jsx(Qce,{}),s.jsx(tue,{}),s.jsx(Zce,{}),s.jsx(eue,{}),s.jsx(sce,{}),s.jsx(Jce,{}),s.jsx(ice,{}),s.jsx(rue,{}),s.jsx(ace,{})]})},aue=a=>{const{roomSession:e=null}=vt(),t=h.useRef(),{setSelectorNeighborhoodCopy:i,setFurnisSelectedCopy:r,setWiredMusicsCategories:n,setWiredSoundEffectsCategories:o}=le(),{showConfirm:l=null}=kt();return h.useEffect(()=>{const c=Oe().application.renderer.view;if(!c)return;c.onclick=d=>Dm(d,1,l),c.onmousemove=d=>Dm(d,1,l),c.onmousedown=d=>Dm(d,1,l),c.onmouseup=d=>Dm(d,1,l),c.onwheel=d=>UQ(d),c.ontouchstart=d=>Lm(d,1,!1,!1,!1,!1,l),c.ontouchmove=d=>Lm(d,1,!1,!1,!1,!1,l),c.ontouchend=d=>Lm(d,1,!1,!1,!1,!1,l),c.ontouchcancel=d=>Lm(d,1,!1,!1,!1,!1,l);const u=t.current;u&&u.appendChild(c)},[]),h.useEffect(()=>(document.onkeydown=c=>Ib(c,e,"keydown"),document.onkeyup=c=>Ib(c,e,"keyup"),()=>{document.onkeydown=null,document.onkeyup=null,i(null),r(null),n(new Map),o(new Map)}),[e,r,i,n,o]),s.jsx(q,{fit:!0,innerRef:t,className:!e&&"d-none",children:e&&s.jsxs(s.Fragment,{children:[s.jsx(nue,{}),e.isSpectator&&s.jsx(ple,{})]})})},oue=a=>{const{useGuideTool:e=!1,unseenAchievementCount:t=0,setMeExpanded:i=null,children:r=null,...n}=a,o=h.useRef();return h.useEffect(()=>{const l=$e();l&&ce().selectRoomObject(l.roomId,l.ownRoomIndex,Q.UNIT)},[]),h.useEffect(()=>{const l=c=>i(!1);return document.addEventListener("click",l),()=>document.removeEventListener(Re.MOUSE_CLICK,l)},[i]),s.jsxs(x,{innerRef:o,alignItems:"center",className:"nitro-toolbar-me p-2",gap:2,children:[xe("guides.enabled")&&e&&s.jsxs(N,{alignItems:"center",className:"navigation-item",pointer:!0,onClick:l=>_i(new mn(mn.TOGGLE_GUIDE_TOOL)),children:[s.jsx(q,{pointer:!0,className:"navigation-item icon icon-me-helper-tool"}),s.jsx(T,{variant:"white",className:"text",children:"Ferr. Ajudantes"})]}),s.jsxs(N,{alignItems:"center",className:"navigation-item",pointer:!0,onClick:l=>Ce("achievements/toggle"),children:[s.jsx(q,{pointer:!0,className:"navigation-item icon icon-me-achievements",children:t>0&&s.jsx(wo,{count:t})}),s.jsx(T,{variant:"white",className:"text",children:"Conquistas"})]}),s.jsxs(N,{alignItems:"center",className:"navigation-item",pointer:!0,onClick:l=>ir(te().userId),children:[s.jsx(q,{pointer:!0,className:"navigation-item icon icon-me-profile"}),s.jsx(T,{variant:"white",className:"text",children:"Meu Perfil"})]}),s.jsxs(N,{alignItems:"center",className:"navigation-item",pointer:!0,onClick:l=>Ce("navigator/search/myworld_view"),children:[s.jsx(q,{pointer:!0,className:"navigation-item icon icon-me-rooms"}),s.jsx(T,{variant:"white",className:"text",children:"Quartos"})]}),s.jsxs(N,{alignItems:"center",className:"navigation-item",pointer:!0,onClick:l=>Ce("avatar-editor/toggle"),children:[s.jsx(q,{pointer:!0,className:"navigation-item icon icon-me-clothing"}),s.jsx(T,{variant:"white",className:"text",children:"Visuais"})]}),s.jsxs(N,{alignItems:"center",className:"navigation-item",pointer:!0,onClick:l=>Ce("user-settings/toggle"),children:[s.jsx(q,{pointer:!0,className:"navigation-item icon icon-me-settings"}),s.jsx(T,{variant:"white",className:"text",children:"Configurações"})]}),r]})},lue=a=>{const{setProgressionExpanded:e=null,children:t=null,unseenAchievementCount:i,...r}=a,n=h.useRef();return h.useEffect(()=>{const o=l=>e(!1);return document.addEventListener("click",o),()=>document.removeEventListener(Re.MOUSE_CLICK,o)},[e]),s.jsxs(x,{innerRef:n,alignItems:"center",className:"nitro-toolbar-progression p-2",gap:3,children:[s.jsxs(N,{alignItems:"center",className:"navigation-item",style:{pointerEvents:"none"},children:[s.jsx(q,{className:"icon icon-progression-daily-tasks"}),s.jsx(T,{variant:"white",className:"text",children:"Tarefas Diárias"})]}),s.jsxs(N,{alignItems:"center",className:"navigation-item",onClick:o=>Ce("quests/toggle"),pointer:!0,children:[s.jsx(q,{className:"icon icon-progression-prog-quests"}),s.jsx(T,{variant:"white",className:"text",children:"Tarefas"})]}),s.jsxs(N,{alignItems:"center",className:"navigation-item",onClick:o=>Ce("achievements/toggle"),pointer:!0,style:{pointerEvents:"none"},children:[s.jsx(q,{className:"icon icon-me-achievements",children:i>0&&s.jsx(wo,{count:i})}),s.jsx(T,{variant:"white",className:"text",children:"Conquistas"})]}),t]})},cue=a=>{const{isInRoom:e}=a,[t,i]=h.useState(!1),[r,n]=h.useState(!0),[o,l]=h.useState(!0),[c,u]=h.useState(!1),[d,_]=h.useState(!1);Qa();const{isEnabled:m,hasReadPermission:f,hasWritePermission:E,wiredMenuButton:I}=Tn(),{userFigure:p=null}=Ja(),{getFullCount:S=0}=Qn(),{getTotalUnseen:R=0}=AT(),{requests:O=[]}=Jr(),{iconState:C=jo.HIDDEN}=kG(),A=te().canModTools,b=e&&m()&&(f()||E())&&I;J(DC,M=>{const U=M.getParser();u(U.isAllowed(Yf.USE_GUIDE_TOOL))}),ut(vg.ANIMATE_ICON,M=>{((G,F,H,v)=>{const B=document.body.getElementsByClassName(G)[0];if(!B)return;F.className="toolbar-icon-animation",F.style.visibility="visible",F.style.left=H+"px",F.style.top=v+"px",document.body.append(F);const z=B.getBoundingClientRect(),$=F.getBoundingClientRect(),W=$.x-z.x,V=$.y-z.y,se=Math.sqrt(W*W+V*V),ee=500-Math.abs(1/se*100*500*.5),ie=20,Z=`ToolbarBouncing[${G}]`;p_.getMotionByTag(Z)||(p_.runMotion(new Jb(new hte(ee+8),new ate(B,400,12))).tag=Z);const ne=new Jb(new cte(new ute(F,ee,z.x-$.x+ie,z.y-$.y,100,1),1),new nte(F));p_.runMotion(ne)})("icon-inventory",M.image,M.x,M.y)});const y=()=>{Ce("openView/calendar")};return s.jsxs(s.Fragment,{children:[s.jsx(Hd,{type:Nr.FADE_IN,inProp:t,timeout:300,children:s.jsx(oue,{useGuideTool:c,unseenAchievementCount:R,setMeExpanded:i})}),s.jsx(Hd,{type:Nr.FADE_IN,inProp:d,timeout:300,children:s.jsx(lue,{unseenAchievementCount:R,setProgressionExpanded:_})}),s.jsxs(x,{alignItems:"center",justifyContent:"between",gap:2,className:"nitro-toolbar py-1 px-3",children:[s.jsx(x,{gap:2,alignItems:"center",className:"options-tools-user",children:s.jsxs(x,{alignItems:"center",gap:2,children:[s.jsxs(x,{children:[s.jsx(q,{id:"toolbar-user-bar-container",className:`d-none d-lg-block user-bar-list ${o?"open":"closed"}`}),s.jsx(x,{alignItems:"center",className:"close-user-bar cursor-pointer",onClick:()=>l(!o),children:o?s.jsx(ds,{className:"fa-icon"}):s.jsx(_s,{className:"fa-icon"})})]}),e&&o&&s.jsx(q,{pointer:!0,className:"navigation-item icon icon-hubbe",onClick:M=>rk()}),!e&&o&&s.jsx(q,{pointer:!0,className:"navigation-item icon icon-house",onClick:M=>Ce("navigator/goto/home")}),o&&s.jsx(q,{pointer:!0,className:"navigation-item icon icon-rooms",onClick:M=>Ce("navigator/toggle")}),e&&o&&s.jsx(q,{pointer:!0,className:"navigation-item icon icon-progression",onClick:M=>_(!d)}),xe("game.center.enabled")&&o&&s.jsx(q,{pointer:!0,className:"navigation-item icon icon-game",onClick:M=>Ce("games/toggle")}),o&&s.jsx(q,{pointer:!0,className:"navigation-item icon icon-calendar",onClick:y}),s.jsx(q,{pointer:!0,className:"navigation-item icon icon-catalog",onClick:M=>Ce("catalog/toggle")}),s.jsx(q,{pointer:!0,className:"navigation-item icon icon-inventory",onClick:M=>Ce("inventory/toggle"),children:S>0&&s.jsx(wo,{count:S})}),s.jsxs(x,{center:!0,pointer:!0,className:"navigation-item item-avatar "+(t?"active ":""),onClick:M=>i(!t),children:[s.jsx(ls,{figure:p,direction:2,position:"absolute"}),R>0&&s.jsx(wo,{count:R})]}),b&&s.jsx(q,{pointer:!0,className:"navigation-item icon icon-wiredcreatortools",onClick:M=>Ce("wiredmenu/open")}),e&&s.jsx(q,{pointer:!0,className:"navigation-item icon icon-camera",onClick:M=>Ce("camera/toggle")}),A&&s.jsx(q,{pointer:!0,className:"navigation-item icon icon-modtools",onClick:M=>Ce("mod-tools/toggle")})]})}),s.jsx(x,{gap:2,alignItems:"center",justifyContent:"center",id:"toolbar-chat-input-container"}),s.jsxs(x,{alignItems:"center",gap:2,className:r?"friend-bar-open":"friend-bar-closed",children:[s.jsxs(x,{gap:2,children:[s.jsx(q,{pointer:!0,className:"navigation-item icon icon-friendall",onClick:M=>Ce("friends/toggle"),children:O.length>0&&s.jsx(wo,{count:O.length})}),(C===jo.SHOW||C===jo.UNREAD)&&s.jsx(q,{pointer:!0,className:`navigation-item icon icon-message ${C===jo.UNREAD&&"is-unseen"}`,onClick:M=>TT()})]}),s.jsxs(x,{children:[s.jsx(q,{id:"toolbar-friend-bar-container",className:`d-none d-lg-block friend-bar-list ${r?"open":"closed"}`}),s.jsx(x,{alignItems:"center",className:"close-friends cursor-pointer",onClick:()=>n(!r),children:r?s.jsx(_s,{className:"fa-icon"}):s.jsx(ds,{className:"fa-icon"})})]})]})]})]})},uue=a=>{const{badges:e=null,gap:t=1,justifyContent:i="between",style:r={},...n}=a;return s.jsx(s.Fragment,{children:e&&e.length>0&&e.map((o,l)=>s.jsx(N,{className:"badge",center:!0,style:r,children:s.jsx(as,{badgeCode:o},o)},o))})},hue=a=>{const{userProfile:e=null,backgroundPreview:t=null,editBackground:i=null,setEditBackground:r=null,position:n=null,setPosition:o=null,children:l}=a,c=e.id===te().userId,[u,d]=h.useState({x:0,y:0}),[_,m]=h.useState(!1),[f,E]=h.useState({x:0,y:0}),[I,p]=h.useState({width:0,height:0}),S=h.useRef(null),R=()=>{d({x:n.x,y:n.y}),r(!i)},O=M=>{if(!i)return;m(!0);const U=S.current.getBoundingClientRect();E({x:M.clientX-U.left-u.x,y:M.clientY-U.top-u.y})},C=()=>{m(!1)},A=M=>{if(!i||!_)return;const U=S.current.getBoundingClientRect();let G=M.clientX-U.left-f.x,F=M.clientY-U.top-f.y;const H=U.width,v=U.height,B=I.width,z=I.height;B>H?(G=Math.min(G,0),G=Math.max(G,H-B)):G=0,z>v?(F=Math.min(F,0),F=Math.max(F,v-z)):F=0,d({x:G,y:F})},b=M=>{M.preventDefault();const U=`${u.x};${u.y}`;vl().send(new Bk(U)),o({x:u.x,y:u.y}),r(!1)},y=M=>{const U=new Image;U.src=M,U.onload=G=>{p({width:U.width,height:U.height})}};return h.useEffect(()=>{const M=`https://cdn.hubbe.biz/background_profile/${e==null?void 0:e.profileImage}`;y(M)},[e]),h.useEffect(()=>{const M=S.current;if(!(!M||!i))return M.addEventListener("mousedown",O),document.addEventListener("mousemove",A),document.addEventListener("mouseup",C),()=>{M.removeEventListener("mousedown",O),document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",C)}},[_,n,i,O,A]),s.jsxs("div",{ref:S,className:"user-profile-header position-relative p-2 overflow-hidden",style:{transition:"background-position 50ms linear",backgroundPositionX:`${i?u.x:n.x}px`,backgroundPositionY:`${i?u.y:n.y}px`,backgroundRepeat:"no-repeat",backgroundImage:t?`url(${t})`:`url(https://cdn.hubbe.biz/background_profile/${e.profileImage})`},children:[c&&e.isHC&&s.jsx(N,{position:"absolute",className:`p-2 top-0 start-0 w-100 h-100 ${i?"overlay":""}`,children:i?s.jsxs(x,{children:[s.jsx(q,{pointer:!0,className:"icon accept-icon",onClick:b}),s.jsx(q,{pointer:!0,className:"icon deny-icon",onClick:R})]}):s.jsx(q,{pointer:!0,className:"icon pencil-icon",onClick:R})}),l]})},due=a=>{const{relationships:e=null}=a,t=({type:i})=>{const r=e&&e.relationshipStatusMap.hasKey(i)?e.relationshipStatusMap.getValue(i):null,n=_r.RELATIONSHIP_NAMES[i].toLocaleLowerCase();return s.jsxs(x,{alignItems:"center",position:"relative",fullWidth:!0,gap:1,children:[s.jsx("i",{className:`nitro-friend-sprite nitro-friends-spritesheet icon-${n}`}),s.jsx(x,{center:!0,className:"user-relationship friend-avatar-image",children:s.jsx(x,{onClick:o=>r&&r.randomFriendId>=1&&ir(r.randomFriendId),center:!0,position:"relative",className:`avatar-image-container ${!r||r.friendCount===0?"disabled":""}`,children:s.jsx(ls,{figure:(r==null?void 0:r.randomFriendFigure)??null,headOnly:!0,direction:2})})}),s.jsxs(N,{grow:!0,gap:0,children:[s.jsxs(T,{small:!0,bold:!0,pointer:!0,onClick:o=>r&&r.randomFriendId>=1&&ir(r.randomFriendId),children:[(!r||r.friendCount===0)&&g("extendedprofile.relationship.nofriend"),r&&r.friendCount>=1&&r.randomFriendName]}),s.jsxs(T,{small:!0,italics:!0,className:"user-relationship-count",children:[(!r||r.friendCount===0)&&g("extendedprofile.relationship.select"),r&&r.friendCount>1&&g(`extendedprofile.relstatus.others.${n}`,["count"],[(r.friendCount-1).toString()])," "]})]})]})};return s.jsxs(s.Fragment,{children:[s.jsx(t,{type:_r.HEART}),s.jsx(t,{type:_r.SMILE}),s.jsx(t,{type:_r.BOBBA}),s.jsx(t,{type:_r.POOP})]})},_ue=DV.memo(a=>{const{relationships:e=null,friendsCount:t=null}=a;return s.jsxs(N,{gap:1,children:[s.jsx(T,{className:"pt-1",small:!0,children:s.jsxs("b",{children:[g("people.friends.title")," (",t,")"]})}),s.jsx(N,{gap:1,children:s.jsx(due,{relationships:e})})]})}),SS=5,gue=a=>{const{itsMe:e=null,groups:t=null,onLeaveGroup:i=null,overflow:r="hidden",gap:n=2,style:o={},primaryColor:l="",accentColor:c="",...u}=a,[d,_]=h.useState(null),[m,f]=h.useState(null),[E,I]=h.useState(0);if(J(Xd,C=>{const A=C.getParser();!d||d!==A.id||A.flag||f(A)}),h.useEffect(()=>{d&&K(new Pd(d,!1))},[d]),h.useEffect(()=>{f(null),t.length>0&&_(C=>(C===t[0].groupId&&K(new Pd(t[0].groupId,!1)),t[0].groupId))},[t]),!t||!t.length)return s.jsx(N,{className:"bg-card-profile p-1 group-container",center:!0,fullHeight:!0,style:{...o,backgroundColor:`color-mix(in srgb, ${l} 55%, white)`},children:s.jsxs(x,{justifyContent:"center",gap:2,children:[s.jsx(q,{className:"no-group-spritesheet image-1"}),s.jsx(q,{className:"no-group-spritesheet image-2"}),s.jsx(q,{className:"no-group-spritesheet image-3"})]})});const p=Math.ceil(t.length/SS),S=()=>{E>0&&I(E-1)},R=()=>{E<p-1&&I(E+1)},O=t==null?void 0:t.slice(E*SS,(E+1)*SS);return s.jsxs(N,{className:"group-container",overflow:r,gap:1,fullHeight:!0,style:o,...u,children:[s.jsxs(x,{className:"bg-card-profile p-1",gap:2,style:{backgroundColor:`color-mix(in srgb, ${l} 55%, white)`},children:[s.jsxs(N,{gap:1,fullWidth:!0,alignItems:"start",overflow:"auto",size:12,children:[s.jsxs(T,{small:!0,fontWeight:"bold",children:[g("avatar.profile.groups")," (",t==null?void 0:t.length,")"]}),s.jsx(x,{gap:2,children:O==null?void 0:O.map((C,A)=>s.jsxs(ct,{overflow:"unset",itemActive:d===C.groupId,onClick:()=>_(C.groupId),className:"nitro-badge-profile",style:{background:c},children:[e&&s.jsx("i",{className:"position-absolute end-0 top-0 z-index-1 icon icon-group-"+(C.favourite?"favorite":"not-favorite"),onClick:()=>cJ(C)}),s.jsx(as,{badgeCode:C.badgeCode,isGroup:!0})]},A))})]}),s.jsxs(N,{gap:1,children:[s.jsx(x,{onClick:()=>S(),alignItems:"center",justifyContent:"center",className:`button-group previous ${E===0?"opacity-50":""}`,children:s.jsx("i",{className:"fa-solid fa-caret-up"})}),s.jsx(x,{onClick:()=>R(),alignItems:"center",justifyContent:"center",className:`button-group next ${E===p-1?"opacity-50":""}`,children:s.jsx("i",{className:"fa-solid fa-caret-down"})})]})]}),s.jsx(N,{size:12,overflow:"hidden",children:m&&s.jsx(IB,{groupInformation:m,onClose:i,style:{backgroundColor:`color-mix(in srgb, ${l} 55%, white)`},primaryColor:l,accentColor:c})})]})},mue=(a,e)=>{let t;return(...i)=>{t&&clearTimeout(t),t=setTimeout(()=>a(...i),e)}},Ey=({color:a,onChange:e})=>{const t=h.useRef(mue(i=>{e(i)},100)).current;return s.jsx(x,{alignItems:"center",gap:1,children:s.jsx("input",{type:"color",value:a,onInput:i=>t(i.currentTarget.value)})})},$m=-1,fue=0,Qm=1,pue=a=>{const e=h.useRef(null),{onCloseClick:t=null,primaryColor:i,onPrimaryColorChange:r,accentColor:n,onAccentColorChange:o,onBackgroundChange:l,onSaveColors:c}=a,[u,d]=h.useState(null),[_,m]=h.useState($m),{showSingleBubble:f}=kt(),E=async R=>{var A;R.preventDefault();const O=(A=R.target.files)==null?void 0:A[0];if(!O)return;const C=new FileReader;C.onload=()=>{const b=C.result;O.size>5e6&&f("O arquivo é muito grande!",bi.INFO),typeof b=="string"&&O.size<5e6&&(d({name:O.name,base64:C.result}),l(C.result))},C.onerror=b=>{console.error("Erro ao ler o arquivo:",b)},C.readAsDataURL(O)},I=R=>{if(R.preventDefault(),!u)return;const O=new rP;O.assignBase64(u.base64),vl().send(O)},p=R=>{R.preventDefault();const O=`${i};${n}`;vl().send(new Vk(O)),c(i,n)},S=R=>{R.preventDefault(),p(R),I(R)};return J(ML,R=>{const O=R.getParser();m(O.result)}),s.jsx(ve,{className:"nitro-profile-upload-background",theme:"primary-slim",children:s.jsx(q,{classNames:["drag-handler"],overflow:"hidden",className:"text-black p-1 gap-2",children:s.jsxs("div",{style:{padding:"10px 10px 0"},children:[_===$m&&s.jsxs(s.Fragment,{children:[s.jsx(T,{className:"banner-title",bold:!0,children:"Banner do Perfil"}),s.jsxs(N,{className:"box cursor-pointer p-1 mb-2 mt-2",onClick:()=>{var R;return(R=e.current)==null?void 0:R.click()},children:[s.jsx("input",{className:"hidden",ref:e,type:"file",onChange:E,accept:".png, .gif",hidden:!0}),s.jsx(x,{justifyContent:"center",alignItems:"center",children:s.jsx("i",{className:"fa-solid fa-arrow-up-from-bracket"})})]}),s.jsx(N,{className:"box color-blue p-1 mb-2",children:s.jsx(x,{justifyContent:"center",alignItems:"center",gap:1,children:u!=null&&u.name?s.jsx(T,{variant:"primary",children:u==null?void 0:u.name}):s.jsx(T,{variant:"primary",dangerouslySetInnerHTML:{__html:g("extendedprofile.upload.select")}})})}),s.jsx("div",{className:"mb-3",children:s.jsx(T,{small:!0,italics:!0,dangerouslySetInnerHTML:{__html:g("extendedprofile.upload.alert.message")}})})]}),(_===Qm||_===fue)&&s.jsxs(s.Fragment,{children:[s.jsx(N,{className:"box p-1 mb-2 mt-2",children:s.jsx(T,{center:!0,variant:_===Qm?"success":"danger",bold:!0,children:g(`extendedprofile.upload.${_===Qm?"success":"danger"}`)})}),s.jsx("div",{className:"mb-3",children:s.jsx(T,{small:!0,italics:!0,children:g(`extendedprofile.upload.${_===Qm?"success":"danger"}.message`)})})]}),s.jsxs("div",{className:"colors-section",children:[s.jsx(T,{className:"colors-title",bold:!0,children:"Cor do Perfil"}),s.jsxs("div",{className:"colors-grid mb-2 mt-2",children:[s.jsx("div",{className:"color-item",children:s.jsx("div",{className:"color-picker-wrapper",children:s.jsx(Ey,{color:i,onChange:r})})}),s.jsx("div",{className:"color-item",children:s.jsx("div",{className:"color-picker-wrapper",children:s.jsx(Ey,{color:n,onChange:o})})})]})]}),s.jsxs(x,{className:"footer-buttons",children:[_===$m&&s.jsx(X,{onClick:S,className:"border-0 flex-grow-1",variant:"success",fullWidth:!0,children:g("generic.send")}),s.jsx(X,{className:"border-0 flex-grow-1",variant:"danger",onClick:t,fullWidth:!0,children:g(_===$m?"generic.cancel":"alert.close.button")})]})]})})})},Eue=a=>{const{userProfile:e=null}=a,[t,i]=h.useState(e.requestSent),r=e.id===te().userId,{report:n=null}=Rn();!t&&!r&&!e.isMyFriend&&e.requestSent;const o=()=>{i(!0),K(new XC(e.username))};return h.useEffect(()=>{i(e.requestSent)},[e]),s.jsxs(Ye,{gap:2,children:[s.jsxs(N,{className:"avatar-infos p-2",gap:1,size:8,children:[s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("div",{className:`status-indicator ${e.isOnline?"online":"offline"}`})," ",e.nickname&&e.nickname.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(T,{bold:!0,children:e.nickname}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("i",{className:"icon icon-id cursor-pointer",title:g("infostand.text.nickname_info")}),s.jsx(T,{small:!0,wrap:!0,children:e.username})]})]}),(!e.nickname||!e.nickname.length)&&s.jsx(T,{bold:!0,children:e.username})]}),s.jsx("div",{className:"text-black small motto",children:e.motto}),s.jsxs(x,{className:"info-login",gap:1,alignItems:"center",children:[s.jsxs(x,{gap:0,alignItems:"center",children:[s.jsxs("div",{className:"fs-7",children:[s.jsxs("b",{children:[g("generic.created"),":"]})," ",e.registration]})," "]}),s.jsx("div",{className:"separator"}),s.jsxs("div",{className:"fs-7",children:[s.jsxs("b",{children:[g("generic.login"),":"]})," ",Mr.format(e.secondsSinceLastVisit,".ago",2)]})]})]}),s.jsx(N,{justifyContent:"center",className:"p-2",gap:1,size:4,children:r?s.jsxs(x,{fullWidth:!0,gap:1,alignItems:"center",justifyContent:"center",className:"me-profile p-2 rounded",children:[s.jsx("div",{children:g("extendedprofile.me")}),s.jsx("div",{className:"icon icon-check-profile"})]}):s.jsxs(x,{gap:2,justifyContent:"end",children:[!t&&!e.isMyFriend?s.jsx(X,{onClick:l=>o(),className:"border-0 fw-bold",variant:"success",children:" Adicionar "}):t||e.requestSent?s.jsx(x,{fullWidth:!0,gap:1,alignItems:"center",justifyContent:"center",className:"me-profile p-2 rounded",children:s.jsx("div",{className:"small text-center",children:g("extendedprofile.friendrequestsent")})}):e.isMyFriend&&s.jsxs(x,{alignItems:"center",justifyContent:"center",fullHeight:!0,fullWidth:!0,gap:2,children:[s.jsx(q,{className:"cursor-pointer navigation-item icon icon-message false",onClick:l=>TT(e.id)}),s.jsxs(x,{fullWidth:!0,gap:1,alignItems:"center",justifyContent:"center",className:"me-profile p-2 rounded",children:[s.jsx("div",{className:"small",children:g("extendedprofile.friend")}),s.jsx("div",{className:"icon icon-check-profile"})]})]}),s.jsx(X,{className:"border-0 fw-bold",variant:"warning",onClick:()=>{n(xs.ROOM,{reportedUserId:e.id})},children:" Reportar "})]})})]})},Iue=a=>{const{userProfile:e=null,style:t={}}=a;return s.jsx(N,{className:"bg-card-profile text-black p-1",size:8,style:t,children:s.jsxs(x,{gap:3,justifyContent:"evenly",children:[s.jsxs(x,{alignItems:"center",gap:2,children:[s.jsx("i",{className:"icon icon-trophy"}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-bold small",children:g("extendedprofile.achievementscore")}),s.jsx("div",{className:"small",children:e.achievementPoints})]})]}),s.jsxs(x,{alignItems:"center",gap:2,children:[s.jsx("i",{className:"icon icon-stargem"}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-bold small",children:g("extendedprofile.stargem")}),s.jsx("div",{className:"small",children:e.starGem})]})]}),s.jsxs(x,{alignItems:"center",gap:2,children:[s.jsx("i",{className:"icon icon-like"}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-bold small",children:g("extendedprofile.respect")}),s.jsx("div",{className:"small",children:e.respect})]})]})]})})},Tue=a=>{const[e,t]=h.useState(null),[i,r]=h.useState([]),[n,o]=h.useState(null),[l,c]=h.useState(!1),[u,d]=h.useState(""),[_,m]=h.useState(""),[f,E]=h.useState(null),[I,p]=h.useState(!1),[S,R]=h.useState({x:0,y:0}),O=()=>{t(null),r([]),o(null),c(!1),d(""),m("")},C=e&&(e==null?void 0:e.id)===te().userId,A=()=>{!e||e.id!==te().userId||ir(e.id)};J(wC,y=>{const M=y.getParser();!e||M.userId!==e.id||r(M.badges)}),J(UC,y=>{const M=y.getParser();!e||M.userId!==e.id||o(M)}),J(jL,y=>{const M=y.getParser();let U=!1;t(G=>(G&&G.id&&(U=G.id===M.id),M)),d(M.primaryColor),m(M.accentColor),R({x:Number(M.positionImageX),y:Number(M.positionImageY)}),U||(r([]),o(null)),K(new _N(M.id)),K(new mN(M.id))}),J(PL,y=>{const M=y.getParser();M.userId==(e==null?void 0:e.id)&&ir(M.userId)}),ut(ke.SELECTED,y=>{if(!e||y.category!==Q.UNIT)return;const M=$e().userDataManager.getUserDataByIndex(y.objectId);M.type===Xt.USER&&ir(M.webID)});const b=h.useMemo(()=>sr.isColorDarkOrLight(u,!0),[u]);return e?s.jsxs(ve,{disableDrag:I,uniqueKey:"nitro-user-profile",theme:"primary-slim",className:`user-profile border-0 color-${b}`,children:[s.jsxs(q,{className:"drag-handler content-area p-2",overflow:"hidden",style:{background:`linear-gradient(to bottom, ${u}, ${_})`},children:[s.jsxs(hue,{position:S,setPosition:R,editBackground:I,setEditBackground:p,userProfile:e,backgroundPreview:f,children:[s.jsxs(N,{gap:1,position:"absolute",className:"top-0 end-0 profile-actions",style:{background:u},children:[s.jsx(x,{justifyContent:"center",alignItems:"center",classNames:["button-actions shadow-button white"],onClick:y=>O(),children:s.jsx(pr,{className:"fa-icon"})}),C&&s.jsx(x,{justifyContent:"center",alignItems:"center",classNames:["button-actions shadow-button gray"],onClick:y=>c(!0),children:s.jsx("i",{className:"icon icon-cog-new"})})]}),s.jsx(x,{gap:1,fullHeight:!0,fullWidth:!0,alignItems:"end",justifyContent:"end",children:s.jsx(uue,{fullWidth:!0,center:!0,badges:i,style:{background:`rgb(from ${u} r g b / 10%)`}})})]}),s.jsxs(Ye,{fullHeight:!1,gap:1,children:[s.jsx(N,{size:2,gap:1,className:"avatar-container",style:{backgroundColor:`color-mix(in srgb, ${_} 55%, black)`},children:s.jsx("div",{className:"avatar-container-background",style:{background:u},children:s.jsx(ls,{figure:e.figure,direction:2})})}),s.jsx(N,{size:12,children:s.jsx(Eue,{userProfile:e})}),s.jsx(Iue,{userProfile:e,style:{backgroundColor:`color-mix(in srgb, ${u} 55%, white)`}}),s.jsx(N,{size:4,alignItems:"start",className:"bg-card-profile text-black p-1 cursor-pointer",onClick:y=>Ce(`navigator/search/hotel_view/owner:${e.username}`),style:{backgroundColor:`color-mix(in srgb, ${u} 55%, white)`},children:s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("i",{className:"icon icon-me-rooms"}),s.jsxs("div",{children:[s.jsx("div",{children:s.jsx(T,{bold:!0,pointer:!0,small:!0,children:g("extendedprofile.rooms")})}),s.jsxs("div",{className:"open-rooms",children:[s.jsx(T,{small:!0,children:g("extendedprofile.openrooms")})," ",s.jsx("i",{className:"fa-solid fa-angles-right"})]})]})]})}),s.jsx(N,{size:8,children:s.jsx(gue,{fullWidth:!0,itsMe:e.id===te().userId,groups:e.groups,onLeaveGroup:A,primaryColor:u,accentColor:_})}),s.jsx(N,{className:"bg-card-profile text-black py-0 px-2 cursor-pointer",size:4,style:{backgroundColor:`color-mix(in srgb, ${u} 55%, white)`},children:n&&s.jsx(_ue,{relationships:n,friendsCount:e.friendsCount})})]})]}),l&&s.jsx(pue,{onCloseClick:()=>{c(!1),d(e.primaryColor),m(e.accentColor),E(null)},onPrimaryColorChange:y=>d(y),onAccentColorChange:y=>m(y),primaryColor:u,accentColor:_,onBackgroundChange:y=>E(y),onSaveColors:()=>{e.isHC&&(e.primaryColor=u,e.accentColor=_)}})]}):null},Sue=a=>{const{userSettings:e,processAction:t}=a,{settingFontSize:i,setSettingFontSize:r}=Ea(),n=A=>(A/16).toFixed(2),o=A=>Math.round(A*16),[l,c]=h.useState(o(Number(i))),u=[12,14,16,18,20,22,24],[d,_]=wG(),[m,f]=FG(),[E,I]=HG(),[p,S]=WG(),{seeHiddenBadges:R=!1,setSeeHiddenBadges:O=null}=Yd(),C=A=>{c(A),r(n(A))};return s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.oldChat,onChange:A=>t("oldchat",A.target.checked)}),s.jsx(T,{children:g("memenu.settings.chat.prefer.old.chat")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.cameraFollow,onChange:A=>t("camera_follow",A.target.checked)}),s.jsx(T,{children:g("memenu.settings.other.disable.room.camera.follow")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:d,onChange:A=>_(A.target.checked)}),s.jsx(T,{children:g("memenu.settings.other.place.multiple.objects")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:m,onChange:A=>f(A.target.checked)}),s.jsx(T,{children:g("memenu.settings.other.skip.purchase.confirmation")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:E,onChange:A=>I(A.target.checked)}),s.jsx(T,{children:g("memenu.settings.other.delete.item.confirmation")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:p,onChange:A=>S(A.target.checked)}),s.jsx(T,{children:g("memenu.settings.other.wired.skip.owner.confirmation")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:R,onChange:A=>O(A.target.checked)}),s.jsx(T,{children:g("memenu.settings.other.see.hidden.badges")})]}),s.jsxs(N,{className:"position-relative mt-2",gap:0,children:[s.jsx(T,{className:"mt-1 mb-1",children:g("user_settings.font_size")}),s.jsx(x,{gap:1,children:u.map(A=>s.jsxs(X,{variant:A===l?"primary":"secondary",onClick:()=>C(A),children:[A,"px"]},A))})]})]})},Rue=a=>{const{userSettings:e,processAction:t}=a,{showGifs:i,setShowGifs:r}=Ea(),n=te().clubLevel>=rr.VIP;return s.jsxs(N,{gap:1,overflow:"auto",style:{maxHeight:"calc(100vh - 30vh)"},children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.hideOnline,onChange:o=>t("hide_online",o.target.checked),disabled:!n}),s.jsx(T,{children:g("memenu.settings.privacy.hide.online")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.hideInRoom,onChange:o=>t("hide_in_room",o.target.checked),disabled:!n}),s.jsx(T,{children:g("memenu.settings.privacy.hide.in_room")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.hideLastSeen,onChange:o=>t("hide_last_seen",o.target.checked),disabled:!n}),s.jsx(T,{children:g("memenu.settings.privacy.hide.last_seen")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.hideTyping,onChange:o=>t("hide_typing",o.target.checked)}),s.jsx(T,{children:g("memenu.settings.privacy.hide.hide_typing")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.allowFriendRequests,onChange:o=>t("allow_friend_requests",o.target.checked)}),s.jsx(T,{children:g("memenu.settings.privacy.disable.friend.requests")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e.roomInvites,onChange:o=>t("room_invites",o.target.checked)}),s.jsx(T,{children:g("memenu.settings.other.ignore.room.invites")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:!e.whisperingToWired,onChange:o=>t("disable_whispering_to_wired",!o.target.checked)}),s.jsx(T,{children:g("memenu.settings.other.disable.whispering.to.wired")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:i,onChange:o=>{r(o.target.checked)}}),s.jsx(T,{children:g("memenu.settings.other.show.gifs")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{style:{maxWidth:"100px",minWidth:"100px"},children:g("user_settings.target_commands")}),s.jsx("select",{className:"form-select form-select-sm",value:e.allowTargetCommands,style:{maxWidth:"150px"},onChange:o=>t("target_commands",parseInt(o.target.value)),children:[1,2,3].map(o=>s.jsx("option",{value:o,children:g(`navigator.roomsettings.privacy.settings.options.${o}`)},o))})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{style:{maxWidth:"100px",minWidth:"100px"},children:g("user_settings.allow_whispering")}),s.jsx("select",{className:"form-select form-select-sm",value:e.allowWhispering,style:{maxWidth:"150px"},onChange:o=>t("allow_whispering",parseInt(o.target.value)),children:[1,2,3].map(o=>s.jsx("option",{value:o,children:g(`navigator.roomsettings.privacy.settings.options.${o}`)},o))})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{style:{maxWidth:"100px",minWidth:"100px"},children:g("user_settings.allow_follow")}),s.jsx("select",{className:"form-select form-select-sm",value:e.allowFollow,style:{maxWidth:"150px"},onChange:o=>t("allow_follow",parseInt(o.target.value)),disabled:!n,children:[1,2,3].map(o=>s.jsx("option",{value:o,children:g(`navigator.roomsettings.privacy.settings.options.${o}`)},o))})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{style:{maxWidth:"100px",minWidth:"100px"},children:g("user_settings.allow_trade")}),s.jsx("select",{className:"form-select form-select-sm",value:e.allowTrade,style:{maxWidth:"150px"},onChange:o=>t("allow_trade",parseInt(o.target.value)),children:[1,2,3].map(o=>s.jsx("option",{value:o,children:g(`navigator.roomsettings.privacy.settings.options.${o}`)},o))})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{style:{maxWidth:"100px",minWidth:"100px"},children:g("user_settings.allow_copy")}),s.jsx("select",{className:"form-select form-select-sm",value:e.allowCopy,style:{maxWidth:"150px"},onChange:o=>t("allow_copy",parseInt(o.target.value)),disabled:!n,children:[1,2,3].map(o=>s.jsx("option",{value:o,children:g(`navigator.roomsettings.privacy.settings.options.${o}`)},o))})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{style:{maxWidth:"100px",minWidth:"100px"},children:g("user_settings.allow_gifts")}),s.jsx("select",{className:"form-select form-select-sm",value:e.allowGifts,style:{maxWidth:"150px"},onChange:o=>t("allow_gifts",parseInt(o.target.value)),children:[1,2,3].map(o=>s.jsx("option",{value:o,children:g(`navigator.roomsettings.privacy.settings.options.${o}`)},o))})]})]})},xue=a=>{const{userSettings:e,processAction:t}=a,[i,r]=CB(),{wiredAlwaysOpenAdvancedOptions:n=!1,setWiredAlwaysOpenAdvancedOptions:o=null}=le(),{showFps:l,setShowFps:c,groupRepeatedMessages:u,setGroupRepeatedMessages:d,roomZoomActive:_,setRoomZoomActive:m}=Ea();return h.useEffect(()=>{$e()&&($e().roomZoomActive=_)},[_]),s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:i,onChange:f=>r(f.target.checked)}),s.jsx(T,{children:g("navigator.roomsettings.furni_details")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:n,onChange:f=>o(f.target.checked)}),s.jsx(T,{children:g("navigator.roomsettings.wired_always_open_advanced_options")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:u,onChange:f=>d(f.target.checked)}),s.jsx(T,{children:g("navigator.roomsettings.group_repeated_messages")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:_,onChange:f=>m(f.target.checked)}),s.jsx(T,{children:g("navigator.roomsettings.room_zoom")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:l,onChange:f=>c(f.target.checked)}),s.jsx(T,{children:g("navigator.roomsettings.show_fps")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{children:g("user_settings.path_finder")}),s.jsxs("select",{className:"form-select form-select-sm",value:e.optionalPathFinderMode+"",style:{maxWidth:"150px"},onChange:f=>t("path_finder",parseInt(f.target.value)),children:[s.jsx("option",{value:"-1",selected:!0,children:g("navigator.roomsettings.path_finder.room")}),s.jsx("option",{value:"0",children:g("navigator.roomsettings.path_finder.default")}),s.jsx("option",{value:"1",children:g("navigator.roomsettings.path_finder.old")})]})]})]})},Oue=a=>{const{userSettings:e,processAction:t,saveRangeSlider:i}=a;return s.jsxs(N,{gap:3,children:[s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",children:[s.jsx(T,{children:g("widget.memenu.settings.volume.ui")}),e.volumeSystem===0&&s.jsx(kT,{className:"text-muted"}),e.volumeSystem<=50&&e.volumeSystem>0&&s.jsx(GT,{className:"text-muted"}),e.volumeSystem>50&&s.jsx(BT,{className:"text-muted"})]}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsx("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",style:{accentColor:"#3b82f6"},id:"volumeSystem",value:e.volumeSystem,onChange:r=>t("system_volume",r.target.value),onMouseUp:()=>i("volume")})})]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",children:[s.jsx(T,{children:g("widget.memenu.settings.volume.furni")}),e.volumeFurni===0&&s.jsx(kT,{className:"text-muted"}),e.volumeFurni<=50&&e.volumeFurni>0&&s.jsx(GT,{className:"text-muted"}),e.volumeFurni>50&&s.jsx(BT,{className:"text-muted"})]}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsx("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",style:{accentColor:"#3b82f6"},id:"volumeFurni",value:e.volumeFurni,onChange:r=>t("furni_volume",r.target.value),onMouseUp:()=>i("volume")})})]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",children:[s.jsx(T,{children:g("widget.memenu.settings.volume.trax")}),e.volumeTrax===0&&s.jsx(kT,{className:"text-muted"}),e.volumeTrax<=50&&e.volumeTrax>0&&s.jsx(GT,{className:"text-muted"}),e.volumeTrax>50&&s.jsx(BT,{className:"text-muted"})]}),s.jsx(x,{alignItems:"center",gap:1,children:s.jsx("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",style:{accentColor:"#3b82f6"},id:"volumeTrax",value:e.volumeTrax,onChange:r=>t("trax_volume",r.target.value),onMouseUp:()=>i("volume")})})]})]})},jB="Geral",LB="Privacidade",PB="Avançadas",UB="Sons",Iy=[jB,LB,PB,UB],Cue=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(null),[n,o]=h.useState(Iy[0]),l=(u,d)=>{var E;let _=!0,m=!1;const f=i.clone();switch(u){case"path_finder":f.optionalPathFinderMode=d,K(new PF(f.optionalPathFinderMode));break;case"close_view":t(!1),_=!1;return;case"oldchat":f.oldChat=d,K(new DF(f.oldChat));break;case"room_invites":f.roomInvites=d,K(new MF(f.roomInvites));break;case"camera_follow":d||(E=ce())==null||E.getCurrentRoomCamera().reset(),f.cameraFollow=d,K(new yF(f.cameraFollow));break;case"system_volume":f.volumeSystem=d,f.volumeSystem=Math.max(0,f.volumeSystem),f.volumeSystem=Math.min(100,f.volumeSystem);break;case"furni_volume":f.volumeFurni=d,f.volumeFurni=Math.max(0,f.volumeFurni),f.volumeFurni=Math.min(100,f.volumeFurni);break;case"trax_volume":f.volumeTrax=d,f.volumeTrax=Math.max(0,f.volumeTrax),f.volumeTrax=Math.min(100,f.volumeTrax);break;case"disable_whispering_to_wired":f.whisperingToWired=d,K(new LF(f.whisperingToWired));break;case"hide_online":f.hideOnline=d,m=!0;break;case"hide_in_room":f.hideInRoom=d,m=!0;break;case"hide_typing":f.hideTyping=d,m=!0;break;case"hide_last_seen":f.hideLastSeen=d,m=!0;break;case"allow_friend_requests":f.allowFriendRequests=d,m=!0;break;case"target_commands":f.allowTargetCommands=d,m=!0;break;case"allow_whispering":f.allowWhispering=d,m=!0;break;case"allow_follow":f.allowFollow=d,m=!0;break;case"allow_trade":f.allowTrade=d,m=!0;break;case"allow_gifts":f.allowGifts=d,m=!0;break;case"allow_copy":f.allowCopy=d,m=!0;break}_&&r(f),m&&K(new UF(f.hideOnline,f.hideInRoom,f.hideTyping,f.hideLastSeen,f.allowFriendRequests,f.allowTargetCommands,f.allowWhispering,f.allowFollow,f.allowTrade,f.allowGifts,f.allowCopy)),mp(f)},c=u=>{switch(u){case"volume":K(new jF(Math.round(i.volumeSystem),Math.round(i.volumeFurni),Math.round(i.volumeTrax)));break}};return J(uT,u=>{const d=u.getParser(),_=new Ic;_.volumeSystem=d.volumeSystem,_.volumeFurni=d.volumeFurni,_.volumeTrax=d.volumeTrax,_.oldChat=d.oldChat,_.roomInvites=d.roomInvites,_.cameraFollow=d.cameraFollow,_.flags=d.flags,_.chatType=d.chatType,_.whisperingToWired=d.whisperingToWired,_.optionalPathFinderMode=d.optionalPathFinderMode,_.hideOnline=d.hideOnline,_.hideInRoom=d.hideInRoom,_.hideTyping=d.hideTyping,_.hideLastSeen=d.hideLastSeen,_.allowFriendRequests=d.allowFriendRequests,_.allowTargetCommands=d.allowTargetCommands,_.allowWhispering=d.allowWhispering,_.allowFollow=d.allowFollow,_.allowTrade=d.allowTrade,_.allowGifts=d.allowGifts,_.allowCopy=d.allowCopy,Ok(d.currency),r(_),mp(_)}),h.useEffect(()=>{const u={linkReceived:d=>{const _=d.split("/");if(!(_.length<2))switch(_[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(m=>!m);return}},eventUrlPrefix:"user-settings/"};return fs(u),()=>ps(u)},[]),h.useEffect(()=>{i&&_i(i)},[i]),!e||!i?null:s.jsxs(ve,{uniqueKey:"user-settings",className:"user-settings-window",theme:"primary-slim-dark",children:[s.jsx(je,{headerText:g("widget.memenu.settings.title"),onCloseClick:u=>l("close_view")}),s.jsx($n,{children:Iy.map((u,d)=>s.jsx(In,{isActive:n===u,onClick:_=>o(u),children:s.jsx(T,{children:g(u)})},d))}),s.jsxs(be,{style:{padding:"0.75rem"},children:[n===jB&&s.jsx(Sue,{userSettings:i,processAction:l}),n===LB&&s.jsx(Rue,{userSettings:i,processAction:l}),n===PB&&s.jsx(xue,{userSettings:i,processAction:l}),n===UB&&s.jsx(Oue,{userSettings:i,processAction:l,saveRangeSlider:c})]})]})},zt=a=>{const{min:e,max:t,value:i,step:r,setValue:n,renderThumb:o}=a,l=r||1;return s.jsxs(x,{className:"gap-2",children:[s.jsx(X,{variant:"secondary",onClick:()=>n(i>e?i-l:e),children:s.jsx(ds,{className:"fa-icon"})}),s.jsx(cm,{className:"nitro-slider",min:e,max:t,step:r,value:i,onChange:c=>n(c),renderThumb:o}),s.jsx(X,{variant:"secondary",onClick:()=>n(i<t?i+l:t),children:s.jsx(_s,{className:"fa-icon"})})]})},Nue=a=>{const{trigger:e=null,furniIds:t=[]}=le();return s.jsxs(N,{gap:1,className:"position-relative",children:[s.jsx(T,{style:{margin:"7px 0px"},bold:!0,children:g("wiredfurni.pickfurnis.caption",["count","limit"],[t.length.toString(),e.maximumItemSelectionCount.toString()])}),s.jsx(T,{small:!0,children:g("wiredfurni.pickfurnis.desc")})]})},Ty=a=>{const{type:e,inputs:t,keyIndex:i,title:r,hiddenPickup:n=!1}=a,{furniSources:o,setFurniSources:l,userSources:c,setUserSources:u}=le(),[d,_]=h.useState(t.indexOf(e=="furni"?o[i]:c[i])),{trigger:m=null,furniIds:f=[],furniIds2:E,setDualType:I,isDual:p,dualType:S}=le(),R=h.useCallback(O=>{if(!m)return;let C;O?C=(d+1)%t.length:C=(d-1+t.length)%t.length,_(C),e==="furni"?(o[i]=t[C],l(o)):e==="users"&&(c[i]=t[C],u(c))},[m,d,t,e,o,i,l,c,u]);return h.useEffect(()=>{m&&_(t.indexOf(e=="furni"?o[i]:c[i]))},[o,t,i,m,e,c]),s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(x,{alignItems:"center",justifyContent:"between",children:[s.jsx(T,{bold:!0,children:g(r)}),(t[d]===100||t[d]===101)&&p&&s.jsx(q,{className:`icon icon-furni-picks-${t[d]===100?1:2} ${S===(t[d]===100?1:2)?"active":""}`,pointer:!0,onClick:()=>{I(t[d]===100?1:2)}},d)]}),s.jsxs(x,{gap:1,alignItems:"center",justifyContent:"between",children:[s.jsxs(X,{variant:"secondary",onClick:()=>R(!1),children:[" ",s.jsx(ds,{className:"fa-icon"})]}),s.jsxs(T,{bold:!0,children:[g(`wiredfurni.params.sources.${e}.${t[d]}`),(t[d]===100||t[d]===101)&&(p||n)&&" ["+(t[d]===100?f:E).length.toString()+"/"+m.maximumItemSelectionCount.toString()+"]"]}),s.jsx(X,{variant:"secondary",onClick:()=>R(!0),children:s.jsx(_s,{className:"fa-icon"})})]})]})},Aue=a=>{const{inputs:e,hiddenPickup:t=!1,keyIndex:i,title:r,userInputsOffset:n,variableType:o=null,disabled:l=!1}=a,{furniSources:c,setFurniSources:u,userSources:d,setUserSources:_,trigger:m=null,furniIds:f=[],setSelectedSource:E=null}=le(),I=M=>{switch(M){default:case 0:return"furni";case 1:return"users";case-10:return"global";case-20:return"context"}},p=h.useCallback(()=>{if(o!==null){const G=I(o);if(G==="furni")return Math.max(0,e.indexOf(c[i]));if(G==="users")return Math.max(n,e.indexOf(d[i],n))}const M=e.indexOf(c[i]);if(M>=0)return C("furni"),M;const U=e.indexOf(d[i],n);return U>=0?(C("users"),U):0},[e,i,n,o,c,d]),[S,R]=h.useState(-1),[O,C]=h.useState("furni");h.useEffect(()=>{const M=p();R(U=>U!==M?M:U),C(U=>{const G=M<n?"furni":"users";return U!==G?G:U})},[m,p,n]),h.useEffect(()=>{if(o===null)return;const M=I(o);C(v=>v!==M?M:v);const U=[...e],G=c[i],F=d[i];let H=M==="furni"?U.indexOf(G):U.indexOf(F,n);H===-1&&(H=M==="furni"?0:n),u(v=>{const B=[...v],z=M==="furni"?U[H]:-1;return B[i]!==z?(B[i]=z,B):v}),_(v=>{const B=[...v],z=M==="users"?U[H]:-1;return B[i]!==z?(B[i]=z,B):v}),R(v=>v!==H?H:v)},[o,e,i,n,c,d,u,_]);const A=h.useCallback(M=>{const U=e.slice(0,n),G=c[i];let F=U.indexOf(G);F===-1&&(F=0);const H=M?(F+1)%U.length:(F-1+U.length)%U.length,v=U[H];[...c],[...d],u(B=>{const z=[...B];return z[i]=v,z}),_(B=>{const z=[...B];return z[i]=-1,z}),R(e.indexOf(v)),C("furni")},[e,n,c,i,d,u,_]),b=h.useCallback(M=>{const U=e.slice(n),G=d[i];let F=U.indexOf(G);F===-1&&(F=0);const H=M?(F+1)%U.length:(F-1+U.length)%U.length,v=U[H];[...c],[...d],u(B=>{const z=[...B];return z[i]=-1,z}),_(B=>{const z=[...B];return z[i]=v,z}),R(n+H),C("users")},[d,i,e,c,u,_,n]),y=M=>{O==="global"||O==="context"||(O==="furni"?A(M):b(M))};return h.useEffect(()=>{O==="global"||O==="context"||E(O)},[E,O]),s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(x,{justifyContent:"between",alignItems:"center",children:[s.jsx(T,{bold:!0,className:l?"disabled-input-sources":"",children:g(r)}),o===null&&s.jsx(x,{justifyContent:"between",alignItems:"center",className:`nitro-variables-options ${l?"disabled-input-sources":""}`,children:["0","1"].map((M,U)=>{const G=(M==="0"?"furni":"users")===O;return s.jsx("div",{className:`icon-variable icon-variable-${M} ${G?"active":""}`,onClick:()=>{M==="0"?A(!1):b(!1)}},U)})})]}),s.jsxs(x,{gap:1,alignItems:"center",justifyContent:"between",children:[s.jsx(X,{disabled:l||O==="global"||O==="context",variant:"secondary",onClick:()=>y(!1),children:s.jsx(ds,{className:"fa-icon"})}),s.jsxs(T,{className:l?"disabled-input-sources":"",bold:!0,children:[g(O==="furni"||O==="users"?`wiredfurni.params.sources.${O}.${e[S]}`:`wiredfurni.params.sources.${O}`),O==="furni"&&e[S]===100&&t&&` [${f.length}/${m.maximumItemSelectionCount}]`]}),s.jsx(X,{disabled:l||O==="global"||O==="context",variant:"secondary",onClick:()=>y(!0),children:s.jsx(_s,{className:"fa-icon"})})]})]})},bue=a=>{const{advancedModeState:e,hiddenPickup:t=!1,mergedSources:i=!1,userSelectionTitle:r,furniSelectionTitle:n,customAdvancedSetting:o,furniSelectionTitleIndexed:l=null,userSelectionTitleIndexed:c=null,mergedSelections:u=[]}=a,{trigger:d=null,quantifier:_=null,setQuantifier:m=null,setFurniSources:f=null,setUserSources:E=null}=le();return h.useEffect(()=>{f(d.furniSourceTypes),E(d.userSourceTypes),m(d.quantifierCode)},[d,m,f,E]),e===wB.ADVANCED_EXPANDED&&s.jsxs(s.Fragment,{children:[d instanceof _m&&d.quantifierType!=0&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.quantifier_selection")}),[0,1].map(I=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"quantifier",id:`quantifier${I}`,checked:_===I,onChange:p=>m(I)}),s.jsx(T,{children:g(`wiredfurni.params.quantifier.${d.quantifierType==1?"furni":d.quantifierType==2?"users":"variables"}${d.isInvert?".neg.":"."}${I}`)})]},I))]})]}),i?s.jsx(s.Fragment,{children:u.map((I,p)=>s.jsx(Aue,{hiddenPickup:t,inputs:[...d.inputSourcesConf.getAllAllowedFurniSources[I.sourcesIndex[0]].values()].flat().concat([...d.inputSourcesConf.getAllAllowedUserSources[I.sourcesIndex[1]].values()].flat()),userInputsOffset:[...d.inputSourcesConf.getAllAllowedFurniSources[I.sourcesIndex[0]].values()].flat().length,title:I.title,keyIndex:p,variableType:I.type,disabled:I.isDisabled},p))}):s.jsxs(s.Fragment,{children:[d.inputSourcesConf.getAllAllowedFurniSources.map((I,p)=>s.jsx(Ty,{keyIndex:p,hiddenPickup:t,type:"furni",inputs:I,title:l?l+p:n},p)),d.inputSourcesConf.getAllAllowedUserSources.map((I,p)=>s.jsx(Ty,{keyIndex:p,type:"users",inputs:I,title:c?c+p:r},p))]}),o]})};var wB=(a=>(a[a.ADVANCED_HIDDEN=0]="ADVANCED_HIDDEN",a[a.ADVANCED_VISIBLE=1]="ADVANCED_VISIBLE",a[a.ADVANCED_EXPANDED=2]="ADVANCED_EXPANDED",a))(wB||{});const e_=a=>{const{wiredType:e="",save:t=null,validate:i=null,children:r=null,mergedSources:n=!1,mergeSelectionTitle:o=null,mergedSelections:l=null,hasSpecialInput:c=!1,hasAdvancedSpecialInputs:u=!1,advancedAlwaysVisible:d=!1,usingCustomAdvancedSettings:_=!1,forceHidePickFurniInstructions:m=!1,requiresFurni:f=ge.STUFF_SELECTION_OPTION_NONE,userSelectionTitle:E="wiredfurni.params.sources.users.title",furniSelectionTitle:I="wiredfurni.params.sources.furni.title",furniSelectionTitleIndexed:p=null,userSelectionTitleIndexed:S=null,customAdvancedSetting:R=null,applyConfigurationSaved:O=!1,viewVariableInMenu:C=!1}=a,[A,b]=h.useState(null),[y,M]=h.useState(null),[U,G]=h.useState(!1);h.useState([]),h.useState([]);const[F,H]=h.useState(0),{trigger:v=null,setTrigger:B=null,setIntParams:z=null,setStringParam:$=null,setFurniIds:W=null,setFurniIds2:V=null,allowsFurni:se=null,setAllowsFurni:ee=null,saveWired:ie=null,wiredAlwaysOpenAdvancedOptions:Z,isDual:ne,dualType:_e}=le(),{hasWritePermission:de,hasReadPermission:me}=Tn(),fe=h.useMemo(()=>v!=null&&v.stringData.length>0&&C&&me(),[me,v,C]),ae=()=>{Ai.unhighlightActiveWired(v.id),B(null)},Te=()=>{i&&!i()||(t&&t(),G(!0))},Se=()=>{H(F===2?1:2)},Le=()=>{K(new zw(v.id))},Et=()=>{fe&&Ce("wiredmenu/open/variable_overview/"+v.stringData)};return h.useEffect(()=>{U&&(ie(),G(!1))},[U,ie]),h.useEffect(()=>{if(!v)return;const ri=v.spriteId||-1,ni=te().getFloorItemData(ri);ni?(b(ni.name),M(ni.description)):(b("NAME: "+ri),M("NAME: "+ri)),c&&(z(v.intData),$(v.stringData)),m||!v.inputSourcesConf.isFurniSelectionDefault()&&ge.STUFF_SELECTION_OPTION_NONE;const gt=f>ge.STUFF_SELECTION_OPTION_NONE||v.inputSourcesConf.allowFurniSelection();gt&&(W(yi=>(yi&&yi.length&&Ai.hideAll(yi),v.selectedItems&&v.selectedItems.length?(Ai.showAll(v.selectedItems,ne,1),v.selectedItems):[])),V(yi=>(yi&&yi.length&&Ai.hideAll(yi),v.selectedItems2&&v.selectedItems2.length?(Ai.showAll(v.selectedItems2,ne,2),v.selectedItems2):[]))),ee(gt);const yt=v.inputSourcesConf,ws=yt.amountFurniSelections>0,Jn=yt.amountUserSelections>0,Uc=v instanceof _m?v.quantifierType!=0:!1;v.advancedMode&&(ws||Jn||Uc||u)&&(d||v.usingCustomInputSources||_||Z?H(2):H(1))},[v,c,f,m,z,$,W,ee,u,d,_,ne,Z,V]),h.useEffect(()=>{u&&H(Z?2:1)},[u,Z]),s.jsxs(ve,{uniqueKey:"nitro-wired",className:"nitro-wired",theme:"primary-slim",overflow:"unset",children:[s.jsx(je,{headerText:g("wiredfurni.title"),onCloseClick:ae}),s.jsxs(be,{overflow:"unset",children:[s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("i",{className:`icon icon-wired-${e}`}),s.jsx(T,{bold:!0,children:A})]}),s.jsx(T,{small:!0,children:y})]}),O&&s.jsxs(T,{align:"center",underline:!0,onClick:Le,children:[" ",g("wiredfurni.params.apply_configuration")]}),C&&s.jsx(x,{fullWidth:!0,alignItems:"center",justifyContent:"center",children:s.jsxs(T,{style:{pointerEvents:fe?"all":"auto",cursor:fe?"pointer":""},align:"center",underline:!0,onClick:Et,children:[" ",g("wiredfurni.params.view_variable_in_menu")]})}),!!r&&s.jsx("hr",{className:"m-0 bg-dark"}),r,!ne&&se&&!(m||!v.inputSourcesConf.isFurniSelectionDefault()&&f===ge.STUFF_SELECTION_OPTION_NONE)&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"m-0 bg-dark"}),s.jsx(Nue,{})]}),s.jsxs(s.Fragment,{children:[!d&&!Z&&F>0&&s.jsx("div",{className:"d-inline text-black text-decoration-underline text-center",onClick:Se,children:g(F===1?"wiredfurni.params.sources.expand":"wiredfurni.params.sources.collapse")}),s.jsx(bue,{hiddenPickup:m||!v.inputSourcesConf.isFurniSelectionDefault()&&f===ge.STUFF_SELECTION_OPTION_NONE,customAdvancedSetting:R,advancedModeState:F,userSelectionTitle:E,furniSelectionTitle:I,furniSelectionTitleIndexed:p,userSelectionTitleIndexed:S,mergedSources:n,mergedSelectionTitle:o,mergedSelections:l})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(X,{fullWidth:!0,variant:"success",onClick:Te,disabled:!de(),children:g("wiredfurni.ready")}),s.jsx(X,{fullWidth:!0,variant:"secondary",onClick:ae,children:g("cancel")})]})]})]})},qe=a=>{const{requiresFurni:e=ge.STUFF_SELECTION_OPTION_NONE,save:t=null,hasSpecialInput:i=!1,children:r=null,customAdvancedSetting:n=null,furniSelectionTitleIndexed:o=null,userSelectionTitleIndexed:l=null,advancedAlwaysVisible:c=!1,userSelectionTitle:u="wiredfurni.params.sources.users.title",furniSelectionTitle:d="wiredfurni.params.sources.furni.title",forceHidePickFurniInstructions:_=!1,applyConfigurationSaved:m=!1,mergedSources:f=!1,mergedSelections:E=null}=a,{trigger:I=null,actionDelay:p=0,setActionDelay:S=null}=le();return h.useEffect(()=>{S(I.delayInPulses)},[I,S]),s.jsxs(e_,{furniSelectionTitleIndexed:o,userSelectionTitleIndexed:l,wiredType:"action",requiresFurni:e,customAdvancedSetting:n,save:t,hasSpecialInput:i,advancedAlwaysVisible:c,furniSelectionTitle:d,userSelectionTitle:u,forceHidePickFurniInstructions:_,applyConfigurationSaved:m,mergedSelections:E,mergedSources:f,children:[r,!!r&&s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.delay",["seconds"],[oh(p)])}),s.jsx(zt,{min:0,max:20,value:p,setValue:S})]})]})},vue=a=>{const{trigger:e,setIntParams:t,setStringParam:i}=le(),[r,n]=h.useState(0),[o,l]=h.useState(0),[c,u]=h.useState(0),d=()=>{t([Math.floor(o/2),c,o%2,r])};return h.useEffect(()=>{l(e.intData.length>0?e.intData[0]*2+e.intData[2]:0),u(e.intData.length>1?e.intData[1]:0),n(e.intData.length>3?e.intData[3]:0)},[e]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:d,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("wiredfurni.params.choose_type")}),[0,1,2].map(_=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"typeSelector",id:"typeSelector",checked:r===_,onChange:m=>n(_)}),s.jsx(T,{children:g(`wiredfurni.params.operator.${_}`)})]},_))]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.clock_minutes",["minutes"],[c.toString()])}),s.jsx(zt,{min:0,max:99,value:c,setValue:u})]}),s.jsxs(N,{gap:1,children:[s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.clock_seconds",["seconds"],[oh(o)])}),s.jsx(zt,{min:0,max:119,value:o,setValue:l})]})]})]})},yue=["%executor%","%executor_tag%","%message%","%motto%","%handitem%","%enable%","%team%","%clicked_username%","%who_clicked_username%","%roomname%","%usersonline%","%pet_name%","%pet_energy%","%pet_hunger%","%owner_name%","%random_selector_furni_id%","%random_selector_furni_state%","%selector_user_count%","%selector_furni_count%","%selector_total_count%","%random_selector_username%","%random_selector_motto%","%random_selector_user_tag%","%random_selector_user_handitem%","%random_selector_user_enable%","%random_signal_username%","%random_signal_motto%","%random_signal_user_tag%","%random_signal_furni_state%","%signal_user_count%","%signal_furni_count%","%signal_total_count%"],Sy=["@white@","@black@","@red@","@green@","@blue@","@purple@","@pink@","@cyan@","@yellow@","@orange@","@brown@"],Hi=a=>{const{data:e=[],value:t,onChange:i,maxLength:r,showDropdown:n,setShowDropdown:o,showPlaceholders:l=!1,showColors:c=!1,isTextArea:u=!1}=a,[d,_]=h.useState([]),[m,f]=h.useState(-1),E=h.useRef(null),I=h.useRef([]),p=O=>{if(O.length>r)return;i(O);const C=O.split(" "),A=C[C.length-1];if(l&&A.startsWith("%")){const b=yue.filter(y=>y.includes(A));_(b),o(b.length>0)}else if(c&&A.startsWith("@")){const b=Sy.filter(y=>y.includes(A));_(b.map(y=>`<span style="color:${y.replace("@","").replace("@","")}">${y}</span>`)),o(b.length>0)}else{const b=e.filter(y=>y.toLowerCase().includes(O.toLowerCase()));_(b),o(b.length>0)}f(-1)},S=O=>{if(O.startsWith("<span")){const A=Sy.find(b=>O.includes(b));A&&(O=A)}const C=t.split(" ");C[C.length-1]=O,i(C.join(" ")),o(!1),f(-1)},R=O=>{n&&(O.key==="ArrowDown"?f(C=>Math.min(C+1,d.length-1)):O.key==="ArrowUp"?f(C=>Math.max(C-1,0)):O.key==="Enter"&&m!==-1?(S(d[m]),O.preventDefault()):O.key==="Tab"&&d.length>0&&(S(d[0]),O.preventDefault()))};return h.useEffect(()=>{d.length===0&&f(-1)},[d]),h.useEffect(()=>{var O;m!==-1&&I.current[m]&&((O=I.current[m])==null||O.scrollIntoView({block:"nearest",behavior:"smooth"}))},[m]),s.jsxs("div",{style:{position:"relative",width:"100%"},children:[u?s.jsx("textarea",{value:t,onChange:O=>p(O.target.value),maxLength:r,className:"form-control form-control-sm",onKeyDown:R,onClick:()=>{o(!0),p(t)},style:{height:u?"100px":""}}):s.jsx("input",{type:"text",value:t,onChange:O=>p(O.target.value),maxLength:r,className:"form-control form-control-sm",onKeyDown:R,onClick:()=>{o(!0),p(t)}}),n&&d.length>0&&s.jsx("ul",{ref:E,style:{position:"absolute",width:"100%",listStyle:"none",margin:0,zIndex:10,color:"black",maxHeight:"100px",overflowY:"auto",padding:"5px"},className:"form-control form-control-sm",children:d.map((O,C)=>s.jsx("li",{ref:A=>I.current[C]=A,onClick:()=>S(O),style:{cursor:"pointer",width:"100%",padding:"3px",background:m===C?"#d3d3d3":C%2===0?"#f5f5f5":"#fff"},dangerouslySetInnerHTML:{__html:O}},C))})]})},Due="hd-180-1.ch-210-66.lg-270-82.sh-290-81",Mue=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(!1),[n,o]=h.useState(""),[l,c]=h.useState(0),{trigger:u=null,setStringParam:d=null,setIntParams:_=null}=le(),{items:m,populateChooser:f}=en(),[E,I]=h.useState([]),[p,S]=h.useState(!1),R=()=>{d(e+Yt+n),_([l,i?1:0])};return h.useEffect(()=>{const O=u.stringData.split(Yt);O.length>0&&t(O[0]),O.length>1&&o(O[1].length>0?O[1]:Due),c(u.intData.length>0?u.intData[0]:0),r(u.intData.length>1?u.intData[1]===1:!1)},[u]),h.useEffect(()=>{if(!m){f();return}const O=m.filter(C=>C&&C.type===4).map(C=>C.name);I(O)},[m]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,userSelectionTitle:"wiredfurni.params.sources.user.title.bot",save:R,children:[s.jsxs(N,{gap:1,onMouseLeave:()=>S(!1),children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:i,onChange:O=>r(O.target.checked)}),s.jsxs(T,{children:[" ",g("wiredfurni.params.bot.name")]})]}),i&&s.jsx(Hi,{data:E,value:e,onChange:t,maxLength:32,showDropdown:p,setShowDropdown:S},E.length)]}),s.jsxs(N,{children:[s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"option",id:"option0",checked:l===0,onChange:O=>c(0)}),s.jsx(T,{bold:!0,children:g("wiredfurni.params.copy_visual")})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"option",id:"option0",checked:l===1,onChange:O=>c(1)}),s.jsx(T,{bold:!0,children:g("wiredfurni.params.copy_executor_visual")})]}),l==0&&s.jsxs(x,{center:!0,children:[s.jsx(ls,{figure:n,direction:4}),s.jsx(X,{onClick:O=>o(te().figure),children:g("wiredfurni.params.capture.figure")})]})]})]})},jue=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(-1),{trigger:n=null,setStringParam:o=null,setIntParams:l=null}=le(),{items:c,populateChooser:u}=en(),[d,_]=h.useState([]),[m,f]=h.useState(!1),E=()=>{o(e),l([i])};return h.useEffect(()=>{t(n.stringData),r(n.intData.length>0?n.intData[0]:0)},[n]),h.useEffect(()=>{if(!c){u();return}const I=c.filter(p=>p&&p.type===4).map(p=>p.name);_(I)},[c]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,userSelectionTitleIndexed:"wiredfurni.params.sources.user.title.botindex.",save:E,children:[s.jsxs(N,{gap:1,onMouseLeave:()=>f(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.name")}),s.jsx(Hi,{data:d,value:e,onChange:t,maxLength:32,showDropdown:m,setShowDropdown:f},d.length)]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode1",checked:i===1,onChange:I=>r(1)}),s.jsx(T,{children:g("wiredfurni.params.start.following")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode2",checked:i===0,onChange:I=>r(0)}),s.jsx(T,{children:g("wiredfurni.params.stop.following")})]})]})]})},Ry=[0,2,5,8,9,10,27],Lue=a=>{const e=$e(),t=te().userId,i=e.userDataManager.getUserData(t),[r,n]=h.useState(0),[o,l]=h.useState(!1),[c,u]=h.useState(""),[d,_]=h.useState(-1),{trigger:m=null,setStringParam:f=null,setIntParams:E=null}=le(),{items:I,populateChooser:p}=en(),[S,R]=h.useState([]),[O,C]=h.useState(!1);function A(){const y=Co.getUserInfo(100,i);n(y.carryItem),_(y.carryItem)}const b=()=>{f(o?c:null),E([d])};return h.useEffect(()=>{m.stringData.length>0?l(!0):l(!1),m.intData.length>0&&m.intData[0]&&!Ry.includes(m.intData[0])&&m.intData[0]>0&&n(m.intData[0]),u(m.stringData),_(m.intData.length>0?m.intData[0]:0)},[m]),h.useEffect(()=>{if(!I){p();return}const y=I.filter(M=>M&&M.type===4).map(M=>M.name);R(y)},[I]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,userSelectionTitleIndexed:"wiredfurni.params.sources.user.title.botindex.",save:b,children:[s.jsx(N,{gap:1,children:s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:o,onChange:y=>l(y.target.checked)}),s.jsxs(T,{children:[" ",g("wiredfurni.params.bot.usage")]})]})}),o&&s.jsxs(N,{gap:1,onMouseLeave:()=>C(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.name")}),s.jsx(Hi,{data:S,value:c,onChange:u,maxLength:32,showDropdown:O,setShowDropdown:C},S.length)]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.handitem")}),s.jsxs("select",{className:"form-select form-select-sm",value:d,onChange:y=>_(parseInt(y.target.value)),children:[r>0&&s.jsx("option",{value:r,children:g(`handitem${r}`)},r),Ry.map(y=>s.jsx("option",{value:y,children:g(`handitem${y}`)},y))]}),s.jsx(X,{variant:"secondary",onClick:()=>A(),children:g("wiredfurni.params.capture.handitem")})]})]})},Pue=a=>{const[e,t]=h.useState(""),{trigger:i=null,setStringParam:r=null}=le(),{items:n,populateChooser:o}=en(),[l,c]=h.useState([]),[u,d]=h.useState(!1),_=()=>r(e);return h.useEffect(()=>{t(i.stringData)},[i]),h.useEffect(()=>{if(!n){o();return}const m=n.filter(f=>f&&f.type===4).map(f=>f.name);c(m)},[n]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:_,children:s.jsxs(N,{gap:1,onMouseLeave:()=>d(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.name")}),s.jsx(Hi,{data:l,value:e,onChange:t,maxLength:32,showDropdown:u,setShowDropdown:d},l.length)]})})},Uue=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(""),{trigger:n=null,setStringParam:o=null}=le(),{items:l,populateChooser:c}=en(),[u,d]=h.useState([]),[_,m]=h.useState(!1),f=()=>{o(e+Yt+i)};return h.useEffect(()=>{const E=n.stringData.split(Yt);E.length>0&&t(E[0]),E.length>1&&r(E[1])},[n]),h.useEffect(()=>{if(!l){c();return}const E=l.filter(I=>I&&I.type===4).map(I=>I.name);d(E)},[l]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:f,children:[s.jsxs(N,{gap:1,onMouseLeave:()=>m(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.name")}),s.jsx(Hi,{data:u,value:i,onChange:r,maxLength:32,showDropdown:_,setShowDropdown:m},u.length)]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"number",className:"form-control form-control-sm",max:7,min:-1,value:e,onChange:E=>t(E.target.value)})]})]})},wue=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(""),[n,o]=h.useState(-1),{items:l,populateChooser:c}=en(),[u,d]=h.useState([]),{trigger:_=null,setStringParam:m=null,setIntParams:f=null}=le(),[E,I]=h.useState(!1),[p,S]=h.useState(!1),R=()=>{m(e+Yt+i),f([n])};return h.useEffect(()=>{const O=_.stringData.split(Yt);O.length>0&&t(O[0]),O.length>1&&r(O[1].length>0?O[1]:""),o(_.intData.length>0?_.intData[0]:0)},[_]),h.useEffect(()=>{if(!l){c();return}const O=l.filter(C=>C&&C.type===4).map(C=>C.name);d(O)},[l]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,userSelectionTitleIndexed:"wiredfurni.params.sources.user.title.botindex.",save:R,children:[s.jsxs(N,{gap:1,onMouseLeave:()=>I(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.name")}),s.jsx(Hi,{data:u,value:e,onChange:t,maxLength:32,showDropdown:E,setShowDropdown:I},u.length)]}),s.jsxs(N,{gap:1,onMouseLeave:()=>S(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.message")}),s.jsx(Hi,{data:[],value:i,onChange:r,maxLength:100,showDropdown:p,setShowDropdown:S,showPlaceholders:!0,showColors:!0},u.length+1)]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:n===0,onChange:()=>o(0)}),s.jsx(T,{children:g("wiredfurni.params.talk")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:n===1,onChange:()=>o(1)}),s.jsx(T,{children:g("wiredfurni.params.whisper")})]})]})]})},Fue=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(""),[n,o]=h.useState(-1),{items:l,populateChooser:c}=en(),[u,d]=h.useState([]),{trigger:_=null,setStringParam:m=null,setIntParams:f=null}=le(),[E,I]=h.useState(!1),[p,S]=h.useState(!1),R=()=>{m(e+Yt+i),f([n])};return h.useEffect(()=>{const O=_.stringData.split(Yt);O.length>0&&t(O[0]),O.length>1&&r(O[1].length>0?O[1]:""),o(_.intData.length>0?_.intData[0]:0)},[_]),h.useEffect(()=>{if(!l){c();return}const O=l.filter(C=>C&&C.type===4).map(C=>C.name);d(O)},[l]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,userSelectionTitle:"wiredfurni.params.sources.user.title.bot",save:R,children:[s.jsxs(N,{gap:1,onMouseLeave:()=>I(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.name")}),s.jsx(Hi,{data:u,value:e,onChange:t,maxLength:32,showDropdown:E,setShowDropdown:I},u.length)]}),s.jsxs(N,{gap:1,onMouseLeave:()=>S(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.message")}),s.jsx(Hi,{data:[],value:i,onChange:r,maxLength:100,showDropdown:p,setShowDropdown:S,showPlaceholders:!0,showColors:!0},u.length+1)]}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:n===0,onChange:O=>o(0)}),s.jsx(T,{children:g("wiredfurni.params.talk")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:n===1,onChange:O=>o(1)}),s.jsx(T,{children:g("wiredfurni.params.shout")})]})]})]})},kue=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(0),{trigger:n=null,setStringParam:o=null,setIntParams:l}=le(),{items:c,populateChooser:u}=en(),[d,_]=h.useState([]),[m,f]=h.useState(!1),E=()=>{o(e),l([i])};return h.useEffect(()=>{t(n.stringData),r(n.intData.length>0?n.intData[0]:0)},[n]),h.useEffect(()=>{if(!c){u();return}const I=c.filter(p=>p&&p.type===4).map(p=>p.name);_(I)},[c]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:E,children:s.jsxs(N,{gap:1,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"teleportEffect",checked:!!i,onChange:I=>r(I.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.teleporteffect")})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,onMouseLeave:()=>f(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.name")}),s.jsx(Hi,{data:d,value:e,onChange:t,maxLength:32,showDropdown:m,setShowDropdown:f},d.length)]})]})})},Gue=a=>{const[e,t]=h.useState(-1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.requirecondition")}),[0,1].map(o=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"requireCondition",id:`requireCondition${o}`,checked:e===o,onChange:l=>t(o)}),s.jsx(T,{children:g("wiredfurni.params.requirecondition."+o)})]},o))]})})},Bue=a=>{const[e,t]=h.useState(3),{trigger:i=null,setIntParams:r=null}=le(),n=()=>{r([e])};return h.useEffect(()=>{i.intData.length&&t(i.intData[0])},[i]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.chase.distance")}),s.jsx("input",{type:"number",className:"form-control form-control-sm",min:"1",max:"10",value:e,onChange:o=>t(parseInt(o.target.value))})]})})},xy=["black","white","red","green","blue","purple","pink","cyan","yellow","orange","brown"],Vue=a=>{const[e,t]=h.useState(""),{trigger:i=null,setStringParam:r=null,setIntParams:n=null}=le(),[o,l]=h.useState(0),[c,u]=h.useState([]),[d,_]=h.useState(""),[m,f]=h.useState(!1),E=()=>{r(e),n([o])},I=p=>{if(p==="black"){xy.forEach(S=>{e.includes(`@${S}@`)&&t(e.replace(new RegExp(`@${S}@`,"g"),""))}),_("");return}if(e.includes(`@${p}@`)){t(e.replace(new RegExp(`@${p}@`,"g"),"")),_("");return}t(`@${p}@${e.replace(new RegExp(`@${d}@`,"g"),"")}`),_(p)};return h.useEffect(()=>{t(i.stringData),l(i.intData[0]||0)},[i]),h.useEffect(()=>{const p=xe("chat.styles");p&&u(p.map(S=>S.styleId))},[]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:E,children:s.jsxs(N,{gap:1,children:[s.jsxs(x,{justifyContent:"between",children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.message")}),s.jsx(x,{gap:1,justifyContent:"center",alignItems:"center",children:xy.map((p,S)=>s.jsx("div",{onClick:()=>I(p),style:{backgroundColor:p,width:10,height:10,cursor:"pointer",borderRadius:5}},S))})]}),s.jsx(x,{gap:1,children:s.jsx(Hi,{value:e,onChange:t,maxLength:200,showDropdown:m,setShowDropdown:f,showPlaceholders:!0,showColors:!0},"inputChat0")}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.style_selection")}),s.jsxs(x,{gap:2,children:[s.jsx("input",{type:"number",className:"form-control form-control-sm",value:o,onChange:p=>l(parseInt(p.target.value)),min:0,max:c.length-1}),s.jsx("div",{className:"nitro-wired-style-selector-container image-rendering-pixelated",children:s.jsx(x,{center:!0,pointer:!0,className:"bubble-parent-container",children:s.jsx(q,{className:"bubble-container",children:s.jsx(q,{className:`chat-bubble bubble-${o}`,children:" "})},o)},o)})]})]})]})})},Hue=a=>{const{trigger:e,setIntParams:t}=le(),[i,r]=h.useState(0),n=()=>{t([i])};return h.useEffect(()=>{r(e.intData.length>0?e.intData[0]:0)},[e]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("wiredfurni.params.clock_control")}),[0,1,2,3,4].map(o=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"controlClock",id:"controlClock",checked:i===o,onChange:l=>r(o)}),s.jsx(T,{children:g(`wiredfurni.params.clock_control.${o}`)})]},o))]})})},Wue=a=>s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),Yue=[0,1,2,3,4,5],zue=a=>{const{trigger:e,setIntParams:t}=le(),[i,r]=h.useState(0),[n,o]=h.useState(0),[l,c]=h.useState(0),u=()=>{t([n,i,l])};return h.useEffect(()=>{o(e.intData.length>0?e.intData[0]:0),r(e.intData.length>1?e.intData[1]:0),c(e.intData.length>2?e.intData[2]:0)},[e]),s.jsxs(qe,{hasSpecialInput:!0,save:u,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"showMessage",checked:!!n,onChange:d=>o(d.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.showmessage")})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.give_effect")}),s.jsx("select",{className:"form-select form-select-sm",value:i,onChange:d=>r(parseInt(d.target.value)),children:Yue.map((d,_)=>s.jsx("option",{value:d,children:g(`wiredfurni.params.freeze.effect.${d}`)},_))}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!l,onChange:d=>c(d.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.freeze.cancel_on_teleport")})]})]})]})},Kue=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(1),[n,o]=h.useState(!1),[l,c]=h.useState(1),[u,d]=h.useState(1),[_,m]=h.useState([]),{trigger:f=null,setIntParams:E=null,setStringParam:I=null}=le(),p=()=>m(C=>[...C,{isBadge:!1,itemCode:"",probability:null}]),S=C=>{m(A=>{const b=Array.from(A);return b.splice(C,1),b})},R=(C,A,b,y)=>{const M=Array.from(_),U=M[C];U&&(U.isBadge=A,U.itemCode=b,U.probability=y,m(M))},O=()=>{let C=[];for(const A of _){if(!A.itemCode)continue;const b=[A.isBadge?"0":"1",A.itemCode,A.probability.toString()];C.push(b.join(","))}C.length>0&&(I(C.join(";")),E([i,n?1:0,e?l:0,u]))};return h.useEffect(()=>{const C=[];if(f.stringData.length>0){const A=f.stringData.split(";");for(const b of A){const y=b.split(",");y.length===3&&C.push({isBadge:y[0]==="0",itemCode:y[1],probability:Number(y[2])})}}C.length===0&&C.push({isBadge:!1,itemCode:"",probability:null}),r(f.intData.length>0?f.intData[0]:0),o(f.intData.length>1?f.intData[1]===1:!1),c(f.intData.length>2?f.intData[2]:0),d(f.intData.length>3?f.intData[3]:0),t(f.intData.length>3?f.intData[2]>0:!1),m(C)},[f]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:O,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"limitEnabled",onChange:C=>t(C.target.checked),checked:e}),s.jsx(T,{children:g("wiredfurni.params.prizelimit",["amount"],[e?l.toString():""])})]}),!e&&s.jsx(T,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"Reward limit not set. Make sure rewards are badges or non-tradeable items."}),e&&s.jsx(zt,{min:1,max:1e3,value:l,setValue:c}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:"How often can a user be rewarded?"}),s.jsxs(x,{gap:1,children:[s.jsxs("select",{className:"form-select form-select-sm w-100",value:i,onChange:C=>r(Number(C.target.value)),children:[s.jsx("option",{value:"0",children:"Once"}),s.jsxs("option",{value:"3",children:["Once every ",u," minutes"]}),s.jsxs("option",{value:"2",children:["Once every ",u," hours"]}),s.jsxs("option",{value:"1",children:["Once every ",u," days"]})]}),i>0&&s.jsx("input",{type:"number",className:"form-control form-control-sm",value:u,onChange:C=>d(Number(C.target.value))})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"uniqueRewards",checked:n,onChange:C=>o(C.target.checked)}),s.jsx(T,{children:"Unique rewards"})]}),s.jsx(T,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"If checked each reward will be given once to each user. This will disable the probabilities option."}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(x,{justifyContent:"between",alignItems:"center",children:[s.jsx(T,{bold:!0,children:"Rewards"}),s.jsx(X,{variant:"success",onClick:p,children:s.jsx(zd,{className:"fa-icon"})})]}),s.jsx(N,{gap:1,children:_&&_.map((C,A)=>s.jsxs(x,{gap:1,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:C.isBadge,onChange:b=>R(A,b.target.checked,C.itemCode,C.probability)}),s.jsx(T,{small:!0,children:"Badge?"})]}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:C.itemCode,onChange:b=>R(A,C.isBadge,b.target.value,C.probability),placeholder:"Item Code"}),s.jsx("input",{type:"number",className:"form-control form-control-sm",value:C.probability,onChange:b=>R(A,C.isBadge,C.itemCode,Number(b.target.value)),placeholder:"Probability"}),A>0&&s.jsx(X,{variant:"danger",onClick:b=>S(A),children:s.jsx(eT,{className:"fa-icon"})})]},A))})]})},que=a=>{const[e,t]=h.useState(1),[i,r]=h.useState(1),[n,o]=h.useState(1),[l,c]=h.useState(0),{trigger:u=null,setIntParams:d=null}=le(),_=()=>d([e,i,n,l]);return h.useEffect(()=>{u.intData.length>=3?(t(u.intData[0]),r(u.intData[1]),o(u.intData[2]),c(u.intData[3])):(t(1),r(1),o(1),c(0))},[u]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:_,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.setpoints",["points"],[e.toString()])}),s.jsx(zt,{min:1,max:100,value:e,setValue:t})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.settimesingame",["times"],[i.toString()])}),s.jsx(zt,{min:1,max:10,value:i,setValue:r})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.points_operation")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:l===0,onChange:m=>c(0)}),s.jsx(T,{children:g("wiredfurni.params.points_operation.0")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:l===1,onChange:m=>c(1)}),s.jsx(T,{children:g("wiredfurni.params.points_operation.1")})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.team")}),s.jsx(x,{className:"flex-wrap col-10",justifyContent:"between",gap:2,children:[1,2,3,4].map(m=>s.jsxs(x,{alignItems:"center",gap:1,className:"col-5",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${m}`,checked:n===m,onChange:f=>o(m)}),s.jsx(T,{children:g("wiredfurni.params.team."+m)})]},m))})]})]})},Xue=a=>{const[e,t]=h.useState(1),[i,r]=h.useState(1),[n,o]=h.useState(0),{trigger:l=null,setIntParams:c=null}=le(),u=()=>c([e,i,n]);return h.useEffect(()=>{l.intData.length>=3?(t(l.intData[0]),r(l.intData[1]),o(l.intData[2])):(t(1),r(1),o(0))},[l]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,forceHidePickFurniInstructions:!0,save:u,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.setpoints",["points"],[e.toString()])}),s.jsx(zt,{min:1,max:100,value:e,setValue:t})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.settimesingame",["times"],[i.toString()])}),s.jsx(zt,{min:1,max:10,value:i,setValue:r})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.points_operation")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:n===0,onChange:d=>o(0)}),s.jsx(T,{children:g("wiredfurni.params.points_operation.0")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:n===1,onChange:d=>o(1)}),s.jsx(T,{children:g("wiredfurni.params.points_operation.1")})]})]})]})},$ue=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(0),{trigger:n=null,setIntParams:o=null}=le(),l=()=>o([e,i]);return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.intData.length>1?n.intData[1]:0)},[n]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:s.jsxs(N,{gap:2,children:[s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.team")}),s.jsx(Ye,{columnCount:2,gap:1,children:[1,2,3,4].map(c=>s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${c}`,checked:e===c,onChange:u=>t(c)}),s.jsx(T,{children:g(`wiredfurni.params.team.${c}`)})]},c))})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("Escolha o tipo:")}),[1,2,3].map(c=>s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeamType",id:`selectedTeamType${c}`,checked:i===c,onChange:u=>r(c)}),s.jsx(T,{children:g(`wiredfurni.params.team.type.${c}`)})]},c))]})]})})},Que=a=>{const[e,t]=h.useState(""),{trigger:i=null,setStringParam:r=null}=le(),n=()=>r(e);return h.useEffect(()=>{t(i.stringData)},[i]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.message")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:o=>t(o.target.value),maxLength:xe("wired.action.kick.from.room.max.length",100)})]})})},Jue=a=>s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),Zue=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(""),{trigger:n,setIntParams:o,setStringParam:l}=le(),c=()=>{l(i),o([e])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.stringData)},[n]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:u=>r(u.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.operation")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2,3,4].map(u=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedOperation${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g(`wiredfurni.params.memorybox.eval_mode.op.${u}`)})]},u))})]})]})},ehe=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(""),{trigger:n,setIntParams:o,setStringParam:l}=le(),c=()=>{l(i),o([e])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.stringData)},[n]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:u=>r(u.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.operation")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2].map(u=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedOperation${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g(`wiredfurni.params.memorybox_string.eval_mode.op.${u}`)})]},u))})]})]})},the=a=>{const[e,t]=h.useState(""),{trigger:i=null,setStringParam:r=null}=le(),n=()=>{r(e)};return h.useEffect(()=>{t(i.stringData)},[i]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:80,value:e,onChange:o=>t(o.target.value)})]})})},she=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(""),{trigger:n,setIntParams:o,setStringParam:l}=le(),c=()=>{l(i),o([e])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.stringData)},[n]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:u=>r(u.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.operation")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2,3,4].map(u=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedOperation${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g(`wiredfurni.params.memorybox.eval_mode.op.${u}`)})]},u))})]})]})},ihe=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(""),{trigger:n,setIntParams:o,setStringParam:l}=le(),c=()=>{l(i),o([e])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.stringData)},[n]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:u=>r(u.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.operation")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2].map(u=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedOperation${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g(`wiredfurni.params.memorybox_string.eval_mode.op.${u}`)})]},u))})]})]})},rhe=[{value:0,icon:"ne"},{value:1,icon:"east"},{value:2,icon:"se"},{value:3,icon:"south"},{value:4,icon:"sw"},{value:5,icon:"west"},{value:6,icon:"nw"},{value:7,icon:"north"}],nhe=[0,1,2,3,4,5,6],ahe=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),[n,o]=h.useState(!1),[l,c]=h.useState(0),{trigger:u=null,setIntParams:d=null}=le(),_=()=>d([e,i,n?1:0,l]);return h.useEffect(()=>{u&&(t(u.intData[0]??-1),r(u.intData[1]??-1),o(u.intData[2]===1),c(u.intData[3]??0))},[u]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:_,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.startdir")}),s.jsx(x,{gap:2,className:"flex-wrap col-7",children:rhe.map(m=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${m.value}`,checked:e===m.value,onChange:f=>t(m.value)}),s.jsx(T,{children:s.jsx("i",{className:`icon icon-${m.icon}`})})]},m.value))})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.turn")}),nhe.map(m=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${m}`,checked:i===m,onChange:f=>r(m)}),s.jsx(T,{children:g(`wiredfurni.params.turn.${m}`)})]},m))]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.on_user_collided")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"onUserCollided",checked:n,onClick:m=>o(m.currentTarget.checked)}),s.jsx(T,{children:g("wiredfurni.params.block_furni_movements")})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.collision_type")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",id:"collisionType1",checked:l==1,onClick:m=>c(1)}),s.jsx(T,{children:g("wiredfurni.params.collision_normal")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",id:"collisionType2",checked:l==0,onClick:m=>c(0)}),s.jsx(T,{children:g("wiredfurni.params.advanced")})]})]})]})},ohe=a=>s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null,furniSelectionTitleIndexed:"wiredfurni.params.sources.furni.title.mv.",advancedAlwaysVisible:!0}),lhe=a=>s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null,furniSelectionTitle:"wiredfurni.params.sources.furni.title.mv.0",userSelectionTitle:"wiredfurni.params.sources.furni.title.mv_user",advancedAlwaysVisible:!0}),che=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],uhe=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),{trigger:n=null,setIntParams:o=null}=le(),l=()=>o([i,e]);return h.useEffect(()=>{n.intData.length>=2?(t(n.intData[1]),r(n.intData[0])):(t(-1),r(-1))},[n]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.emptytiles",["tiles"],[e.toString()])}),s.jsx(zt,{min:1,max:5,value:e,setValue:t})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.startdir")}),s.jsx(x,{gap:1,children:che.map(c=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${c.value}`,checked:i===c.value,onChange:u=>r(c.value)}),s.jsx(T,{children:s.jsx("i",{className:`icon icon-${c.icon}`})})]},c.value))})]})]})},hhe=[{value:4,icon:"ne",tooltip:"Para baixo no eixo vertical"},{value:8,icon:"east",tooltip:"Diagonalmente para baixo e à direita"},{value:5,icon:"se",tooltip:"Para a direita no eixo horizontal"},{value:9,icon:"south",tooltip:"Diagonalmente para cima e à direita"},{value:6,icon:"sw",tooltip:"Para cima no eixo vertical"},{value:10,icon:"west",tooltip:"Diagonalmente para cima e à esquerda"},{value:7,icon:"nw",tooltip:"Para a esquerda no eixo horizontal"},{value:11,icon:"north",tooltip:"Diagonalmente para baixo e à esquerda"},{value:2,icon:"mv-2",tooltip:"Para a direita ou esquerda no eixo horizontal"},{value:3,icon:"mv-3",tooltip:"Para cima ou para baixo no eixo vertical"},{value:1,icon:"mv-1",tooltip:"Para qualquer direção"}],dhe=[0,1,2,3],_he=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),[n,o]=h.useState(0),{trigger:l=null,setIntParams:c=null}=le(),u=()=>c([e,i,n]);return h.useEffect(()=>{l.intData.length>=3?(t(l.intData[0]),r(l.intData[1]),o(l.intData[2])):(t(-1),r(-1),o(0))},[l]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:u,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.movefurni")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"movement0",checked:e===-1,onChange:d=>t(-1)}),s.jsx(T,{children:g("wiredfurni.params.movefurni.0")})]}),s.jsxs(x,{gap:2,className:"flex-wrap col-7",children:[hhe.map(d=>s.jsxs(x,{alignItems:"center",gap:1,title:d.tooltip,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${d.value}`,checked:e===d.value,onChange:_=>t(d.value)}),s.jsx("i",{className:`icon icon-${d.icon}`})]},d.value)),s.jsx("div",{className:"col"})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.rotatefurni")}),dhe.map(d=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${d}`,checked:i===d,onChange:_=>r(d)}),s.jsxs(T,{children:[[1,2].includes(d)&&s.jsx("i",{className:`icon icon-rot-${d}`}),g(`wiredfurni.params.rotatefurni.${d}`)]})]},d))]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.on_user_collided")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"showMessage",checked:!!n,onChange:d=>o(d.target.checked?1:0)}),s.jsx(T,{children:"Acionar batidas"})]})]})]})},ghe=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(1),[n,o]=h.useState([]),[l,c]=h.useState(""),{trigger:u=null,setIntParams:d=null,setStringParam:_=null}=le(),m=()=>{d([e,i]),_(l)};return h.useEffect(()=>{t(u.intData.length>0?u.intData[0]:0),r(u.intData.length>1?u.intData[1]:0),c(u.stringData)},[u]),h.useEffect(()=>{const f=xe("chat.styles");f&&o(f.map(E=>E.styleId))},[]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:m,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.length.minutes",["minutes"],[e.toString()])}),s.jsx(zt,{min:1,max:10,value:e,setValue:t})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.message")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:l,onChange:f=>c(f.target.value),maxLength:xe("wired.action.mute.user.max.length",100)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.style_selection")}),s.jsxs(x,{gap:2,children:[s.jsx("input",{type:"number",className:"form-control form-control-sm",value:i,onChange:f=>r(parseInt(f.target.value)),min:0,max:n.length-1}),s.jsx("div",{className:"nitro-wired-style-selector-container image-rendering-pixelated",children:s.jsx(x,{center:!0,pointer:!0,className:"bubble-parent-container",children:s.jsx(q,{className:"bubble-container",children:s.jsx(q,{className:`chat-bubble bubble-${i}`,children:" "})},i)},i)})]})]})]})},mhe=a=>{const{trigger:e,setIntParams:t}=le(),[i,r]=h.useState(0),[n,o]=h.useState(0),l=()=>{t([i,n])};return h.useEffect(()=>{r(e.intData.length>0?e.intData[0]:0),o(e.intData.length>1?e.intData[1]:0)},[e]),s.jsx(qe,{userSelectionTitle:"wiredfurni.params.opacityitem.user",furniSelectionTitle:"wiredfurni.params.opacityitem.furni",requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:l,children:s.jsxs(N,{gap:1,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"clickable",checked:!!n,onChange:c=>o(c.target.checked?1:0)}),s.jsx(T,{children:g("Clicável")})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsxs(T,{bold:!0,children:[g("wiredfurni.params.opacityitem"),s.jsx("input",{type:"number",maxLength:2,max:10,className:"form-control form-control-sm fs-7 d-inline",step:".1",style:{maxWidth:"50px",marginLeft:"5px"},value:i/10,onChange:c=>{r(parseFloat(c.target.value)*10)}})]}),s.jsx(zt,{min:0,max:10,value:i,setValue:r})]})]})})},fhe=[{value:0,icon:"se"},{value:1,icon:"nw"}],phe=[{value:0,icon:"sw"},{value:1,icon:"ne"}],Ehe=a=>{const{trigger:e,setIntParams:t}=le(),[i,r]=h.useState(0),[n,o]=h.useState(0),[l,c]=h.useState(0),[u,d]=h.useState(0),_=()=>{t([i===1?-n:n,l===1?-u:u])};return h.useEffect(()=>{const m=e.intData.length>0?e.intData[0]:0,f=e.intData.length>1?e.intData[1]:0;o(m),d(f),m<0?(o(Math.abs(m)),r(1)):r(0),f<0?(d(Math.abs(f)),c(1)):c(0)},[e]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:_,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.movement.horizontal.selection")}),s.jsx(x,{gap:3,children:fhe.map(m=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"movementX",id:`movementX${m.value}`,checked:i===m.value,onChange:f=>r(m.value)}),s.jsx(T,{children:s.jsx("i",{className:`icon icon-${m.icon}`})})]},m.value))}),s.jsx(T,{bold:!0,children:g("wiredfurni.params.movement.horizontal.distance",["distance"],[n.toString()])}),s.jsx(zt,{min:0,step:1,max:20,value:n,setValue:o})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.movement.vertical.selection")}),s.jsx(x,{gap:3,children:phe.map(m=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"movementY",id:`movementY${m.value}`,checked:l===m.value,onChange:f=>c(m.value)}),s.jsx(T,{children:s.jsx("i",{className:`icon icon-${m.icon}`})})]},m.value))}),s.jsx(T,{bold:!0,children:g("wiredfurni.params.movement.vertical.distance",["distance"],[u.toString()])}),s.jsx(zt,{min:0,step:1,max:20,value:u,setValue:d})]})]})},Ihe=a=>s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),The=a=>{const{trigger:e,setIntParams:t}=le(),[i,r]=h.useState(!1),[n,o]=h.useState(!1),l=()=>{t([i?1:0,n?1:0])};h.useEffect(()=>{r(e.intData.length>0?!!e.intData[0]:!1),o(e.intData.length>1?!!e.intData[1]:!1)},[e]);const c=s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.signal.send_options")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:i,onChange:u=>r(u.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.signal.split_furni")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:n,onChange:u=>o(u.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.signal.split_users")})]})]})]});return s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,furniSelectionTitleIndexed:"wiredfurni.params.sources.furni.title.signal.",userSelectionTitle:"wiredfurni.params.sources.users.title.signal_forward",customAdvancedSetting:c,hasSpecialInput:!0,save:l})},XN=a=>a/100,She=a=>{const{trigger:e,setIntParams:t,setStringParam:i}=le(),[r,n]=h.useState(0),[o,l]=h.useState(0),c=()=>{t([o,r])};return h.useEffect(()=>{l(e.intData.length>0?e.intData[0]:0),n(e.intData.length>1?e.intData[1]:0)},[e]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g("wiredfurni.params.choose_type")}),[0,1,2].map(u=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"typeSelector",id:"typeSelector",checked:r===u,onChange:d=>n(u)}),s.jsx(T,{children:g(`wiredfurni.params.operator.${u}`)})]},u))]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsxs(T,{bold:!0,children:[g("wiredfurni.params.setaltitude"),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7 d-inline",step:".01",style:{maxWidth:"50px",marginLeft:"5px"},value:XN(o),onChange:u=>{l(parseFloat(u.target.value)*100)}})]}),s.jsx(zt,{min:0,max:4e3,value:o,setValue:l})]})]})},Rhe=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),[n,o]=h.useState(0),[l,c]=h.useState(0);h.useState(0);const{trigger:u=null,setIntParams:d=null}=le(),_=()=>d([e,i,n,l]);return h.useEffect(()=>{t(u.getBoolean(0)?1:0),r(u.getBoolean(1)?1:0),o(u.getBoolean(2)?1:0),c(u.getBoolean(3)?1:0)},[u]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:_,applyConfigurationSaved:!0,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.conditions")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!e,onChange:m=>t(m.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.condition.state")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!i,onChange:m=>r(m.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.condition.direction")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!n,onChange:m=>o(m.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.condition.position")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"altitudeFlag",checked:!!l,onChange:m=>c(m.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.condition.altitude")})]})]})})},RS=a=>{const{title:e="",requiresFurni:t=ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:i=!0}=a,[r,n]=h.useState(""),{trigger:o=null,setStringParam:l=null}=le(),c=()=>{l(r)};return h.useEffect(()=>{n(o.stringData)},[o]),s.jsx(qe,{requiresFurni:t,hasSpecialInput:i,save:c,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g(e)}),s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:80,value:r,onChange:u=>n(u.target.value)})]})})},xhe=a=>{const[e,t]=h.useState(0),{trigger:i=null,setIntParams:r=null}=le(),n=()=>{r([e])};return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"teleportEffect",checked:!!e,onChange:o=>t(o.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.teleporteffect")})]})]})})},Ohe=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(""),{trigger:n=null,setIntParams:o=null,setStringParam:l=null}=le(),c=()=>{o([e]),l(i)};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.stringData)},[n]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:c,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.toggletype_selection")}),[0,1,2].map(u=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"toggleType",id:`toggleType${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g("wiredfurni.params.toggletype."+u)})]},u)),e===2&&s.jsxs(N,{gap:1,children:[s.jsxs(N,{gap:0,children:[s.jsx(T,{bold:!0,children:"Ignorar Estados"}),s.jsx("span",{className:"text-black",style:{opacity:.5,fontSize:"12px"},children:"Exemplo: 1,2,3 (separados por vírgula e sem espaços)"})]}),s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:i,onChange:u=>r(u.target.value.trim())})]})]})})},Che=a=>{const{trigger:e,setIntParams:t}=le(),[i,r]=h.useState(0),[n,o]=h.useState(0),l=()=>{t([i,n])};return h.useEffect(()=>{r(e.intData.length>0?e.intData[0]:0),o(e.intData.length>1?e.intData[1]:0)},[e]),s.jsx(qe,{hasSpecialInput:!0,save:l,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"showMessage",checked:!!i,onChange:c=>r(c.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.showmessage")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"showMessage",checked:!!n,onChange:c=>o(c.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.removeeffect")})]})]})})},Nhe=a=>{const[e,t]=h.useState(""),{trigger:i=null,setStringParam:r=null}=le(),n=()=>{r(e)};return h.useEffect(()=>{t(i.stringData)},[i]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.youtube.url")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:80,value:e,onChange:o=>t(o.target.value)})]})})},Ahe=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(""),{trigger:n,setIntParams:o,setStringParam:l}=le(),c=()=>{l(i),o([e])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.stringData)},[n]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:u=>r(u.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.operation")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2,3,4,5].map(u=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedOperation${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g(`wiredfurni.params.memorybox.eval_mode.cmp.${u}`)})]},u))})]})]})},bhe=[{value:1,text:"widget.memenu.wave"},{value:2,text:"widget.memenu.blow"},{value:3,text:"widget.memenu.laugh"},{value:4,text:"widget.memenu.sit"},{value:5,text:"widget.memenu.thumb"},{value:6,text:"widget.memenu.stand"},{value:7,text:"wiredfurni.params.action.8"},{value:8,text:"widget.memenu.sign"},{value:9,text:"widget.memenu.dance"}],vhe=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],yhe=[1,2,3,4],Dhe=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(""),[n,o]=h.useState("0"),{items:l,populateChooser:c}=en(),[u,d]=h.useState([]),{trigger:_=null,setStringParam:m=null,setIntParams:f=null}=le(),[E,I]=h.useState(!1),p=()=>{m(e+Yt+i+Yt+n)};return h.useEffect(()=>{const S=_.stringData.split(Yt);S.length>0&&t(parseInt(S[0])),S.length>1&&r(S[1]),S.length>2&&o(S[2])},[_]),h.useEffect(()=>{if(!l){c();return}const S=l.filter(R=>R&&R.type===4).map(R=>R.name);d(S)},[l]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:p,children:[s.jsxs(N,{gap:1,onMouseLeave:()=>I(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.name")}),s.jsx(Hi,{data:u,value:i,onChange:r,maxLength:32,showDropdown:E,setShowDropdown:I},u.length)]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.action_selection")}),s.jsx("select",{className:"form-select form-select-sm",value:e,onChange:S=>t(parseInt(S.target.value)),children:bhe.map(({value:S,text:R})=>s.jsx("option",{value:S,children:g(R)},S))})]}),(e===8||e===9)&&s.jsxs(s.Fragment,{children:[e===8?s.jsx(N,{gap:1,children:s.jsx("select",{className:"form-select form-select-sm",value:n,onChange:S=>o(S.target.value),children:vhe.map((S,R)=>s.jsx("option",{value:S,children:g(`wiredfurni.params.action.sign.${S}`)},R))})}):null,e===9?s.jsx(N,{gap:1,children:s.jsx("select",{className:"form-select form-select-sm",value:n,onChange:S=>o(S.target.value),children:yhe.map((S,R)=>s.jsx("option",{value:S,children:g(g(`wiredfurni.params.action.dance.${S}`))},R))})}):null]})]})},Mhe=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),{trigger:n=null,setIntParams:o=null}=le(),l=()=>{o([e,i])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.intData.length>1?n.intData[1]:0)},[n]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"showMessage",checked:!!e,onChange:c=>t(c.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.showmessage")})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.chattriggertype")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:i===1,onChange:c=>r(1)}),s.jsx(T,{children:g("wiredfurni.params.mute")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:i===0,onChange:c=>r(0)}),s.jsx(T,{children:g("wiredfurni.params.unmute")})]})]})]})},jhe=a=>{const e=$e(),t=te().userId,i=e.userDataManager.getUserData(t),[r,n]=h.useState(""),[o,l]=h.useState(""),{items:c,populateChooser:u}=en(),[d,_]=h.useState([]),{trigger:m=null,setStringParam:f=null,setIntParams:E=null}=le(),[I,p]=h.useState(!1);function S(){const O=Co.getUserInfo(100,i);l(O.carryItem.toString())}const R=()=>f(r+Yt+o);return h.useEffect(()=>{const O=m.stringData.split(Yt);O.length>0&&n(O[0]),O.length>1&&l(O[1])},[m]),h.useEffect(()=>{if(!c){u();return}const O=c.filter(C=>C&&C.type===4).map(C=>C.name);_(O)},[c]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:R,children:[s.jsxs(N,{gap:1,onMouseLeave:()=>p(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.namee")}),s.jsx(Hi,{data:d,value:r,onChange:n,maxLength:32,showDropdown:I,setShowDropdown:p},d.length)]}),s.jsxs(N,{gap:1,children:[s.jsxs(T,{bold:!0,children:[g("wiredfurni.params.handitem")," "]}),s.jsx("input",{type:"number",className:"form-control form-control-sm",maxLength:1,value:o,onChange:O=>l(O.target.value)}),s.jsx(X,{variant:"secondary",onClick:()=>S(),children:g("wiredfurni.params.capture.handitem")})]})]})},Lhe=a=>{const[e,t]=h.useState(0),{trigger:i=null,setIntParams:r=null}=le(),n=()=>{r([e])};return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.chattriggertype")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:e===0,onChange:o=>t(0)}),s.jsx(T,{children:g("wiredfurni.params.on")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:e===1,onChange:o=>t(1)}),s.jsx(T,{children:g("wiredfurni.params.off")})]})]})})},Phe=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(""),{trigger:n=null,setStringParam:o=null}=le(),l=()=>{o(e+Yt+i)};return h.useEffect(()=>{const c=n.stringData.split(Yt);t(c[0]||"#ffffff"),r(c[1]||"#ffffff")},[n]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:l,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.firstcolor")}),s.jsx(x,{alignItems:"center",children:s.jsx("input",{className:"form-control form-control-sm",type:"color",value:e,onChange:c=>t(c.target.value)})}),s.jsx(T,{bold:!0,children:g("wiredfurni.params.secondcolor")}),s.jsx(x,{alignItems:"center",children:s.jsx("input",{className:"form-control form-control-sm",type:"color",value:i,onChange:c=>r(c.target.value)})})]})})},Uhe=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),[n,o]=h.useState(0),[l,c]=h.useState(0),{trigger:u=null,setIntParams:d=null}=le(),_=()=>{d([e,i,l,n])};return h.useEffect(()=>{t(u.intData.length>0?u.intData[0]:0),r(u.intData.length>1?u.intData[1]:0),c(u.intData.length>2?u.intData[2]:0),o(u.intData.length>3?u.intData[3]:0)},[u]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:_,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.chattriggertype")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:e===0,onChange:m=>t(0)}),s.jsx(T,{children:g("wiredfurni.params.invisible")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:e===1,onChange:m=>t(1)}),s.jsx(T,{children:g("wiredfurni.params.visible")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:e===2,onChange:m=>t(2)}),s.jsx(T,{children:g("wiredfurni.params.toggletype.3")})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.users_with_rights_can_see")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType1",id:"triggererType2",checked:i===0,onChange:m=>r(0)}),s.jsx(T,{children:g("wiredfurni.params.on")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType1",id:"triggererType3",checked:i===1,onChange:m=>r(1)}),s.jsx(T,{children:g("wiredfurni.params.off")})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.invisibles_see_invisibles")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType2",id:"triggererType4",checked:l===0,onChange:m=>c(0)}),s.jsx(T,{children:g("wiredfurni.params.on")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType2",id:"triggererType5",checked:l===1,onChange:m=>c(1)}),s.jsx(T,{children:g("wiredfurni.params.off")})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.apply_effect")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType3",id:"triggererType6",checked:n===0,onChange:m=>o(0)}),s.jsx(T,{children:g("wiredfurni.params.on")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType3",id:"triggererType7",checked:n===1,onChange:m=>o(1)}),s.jsx(T,{children:g("wiredfurni.params.off")})]})]})]})},whe=a=>{const[e,t]=h.useState(-1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"toggleType",checked:e===0,onChange:o=>t(0)}),s.jsx(T,{children:g("wiredfurni.params.on")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"toggleType",checked:e===1,onChange:o=>t(1)}),s.jsx(T,{children:g("wiredfurni.params.off")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"toggleType",checked:e===2,onChange:o=>t(2)}),s.jsx(T,{children:g("wiredfurni.params.toggletype.3")})]},2)]})})},Fhe=[{value:0,icon:"ne"},{value:1,icon:"east"},{value:2,icon:"se"},{value:3,icon:"south"},{value:4,icon:"sw"},{value:5,icon:"west"},{value:6,icon:"nw"},{value:7,icon:"north"}],khe=[{value:0,icon:"icon-ne"},{value:1,icon:"icon-east"},{value:2,icon:"icon-se"},{value:3,icon:"icon-south"},{value:4,icon:"icon-sw"},{value:5,icon:"icon-west"},{value:6,icon:"icon-nw"},{value:7,icon:"icon-north"},{value:8,icon:"icon-rot-1"},{value:9,icon:"icon-rot-2"}],Ghe=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),{trigger:n=null,setIntParams:o=null}=le(),l=()=>o([e,i]);return h.useEffect(()=>{n.intData.length>=2?(t(n.intData[0]),r(n.intData[1])):(t(-1),r(-1))},[n]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.move.user")}),s.jsxs(x,{gap:2,className:"flex-wrap col-7",children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedMovement",id:"movement-1",checked:e===-1,onChange:c=>t(-1)}),s.jsx(T,{children:g("wiredfurni.params.movefurni.0")})]}),Fhe.map(c=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${c.value}`,checked:e===c.value,onChange:u=>t(c.value)}),s.jsx(T,{children:s.jsx("i",{className:`icon icon-${c.icon}`})})]},c.value))]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.rotate.user")}),s.jsxs(x,{gap:2,className:"flex-wrap col-7",children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedRotation",id:"rotation-1",checked:i===-1,onChange:c=>r(-1)}),s.jsx(T,{children:g("wiredfurni.params.movefurni.0")})]}),khe.map(c=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${c.value}`,checked:i===c.value,onChange:u=>r(c.value)}),s.jsx("i",{className:`icon ${c.icon}`})]},c.value))]})]})]})},Bhe=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),{trigger:n=null,setIntParams:o=null}=le(),l=()=>{o([i,e])};return h.useEffect(()=>{r(n.intData.length>0?n.intData[0]:0),t(n.intData.length>1?n.intData[1]:0)},[n]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"showMessage",checked:i===1,onChange:c=>r(c.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.showmessage")})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.chattriggertype")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:e===0,onChange:c=>t(0)}),s.jsx(T,{children:g("wiredfurni.params.off")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:e===1,onChange:c=>t(1)}),s.jsx(T,{children:g("wiredfurni.params.on")})]})]})]})},Vhe=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(""),[n,o]=h.useState("1"),[l,c]=h.useState(0),{trigger:u=null,setIntParams:d=null,setStringParam:_=null}=le(),m=()=>{d([e,l]),_(i+Yt+n)};return h.useEffect(()=>{if(t(u.intData[0]||0),c(u.intData[1]||0),u.stringData.length>=1){const f=u.stringData.split(Yt);r(f[0]),o(f[1])}},[u]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,forceHidePickFurniInstructions:!0,save:m,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.setpoints.custom")}),s.jsx("input",{type:"text",className:"form-control",value:n,onChange:f=>o(f.target.value)})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e===1,onClick:f=>{t(e===0?1:0),r("")}}),s.jsx(T,{bold:!0,children:g("wiredfurni.params.use_specific_name")})]}),e==1&&s.jsx(N,{children:s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:i,onChange:f=>r(f.target.value)})}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.points_operation")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:l===0,onChange:f=>c(0)}),s.jsx(T,{children:g("wiredfurni.params.points_operation.0")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:l===1,onChange:f=>c(1)}),s.jsx(T,{children:g("wiredfurni.params.points_operation.1")})]})]})]})},Oy=a=>s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),Hhe=[{value:1,text:"widget.memenu.wave"},{value:2,text:"widget.memenu.blow"},{value:3,text:"widget.memenu.laugh"},{value:4,text:"widget.memenu.sit"},{value:5,text:"widget.memenu.thumb"},{value:6,text:"widget.memenu.stand"},{value:7,text:"wiredfurni.params.action.8"},{value:8,text:"widget.memenu.sign"},{value:9,text:"widget.memenu.dance"}],Whe=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],Yhe=[1,2,3,4],zhe=a=>{const[e,t]=h.useState(0),[i,r]=h.useState("0"),{trigger:n=null,setIntParams:o=null}=le(),l=()=>{o([e,parseInt(i)])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.intData.length>1?n.intData[1].toString():"0")},[n]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.action_selection")}),s.jsx("select",{className:"form-select form-select-sm",value:e,onChange:c=>t(parseInt(c.target.value)),children:Hhe.map(({value:c,text:u})=>s.jsx("option",{value:c,children:g(u)},c))})]}),(e===8||e===9)&&s.jsxs(s.Fragment,{children:[e===8?s.jsx(N,{gap:1,children:s.jsx("select",{className:"form-select form-select-sm",value:i,onChange:c=>r(c.target.value),children:Whe.map((c,u)=>s.jsx("option",{value:c,children:g(`wiredfurni.params.action.sign.${c}`)},u))})}):null,e===9?s.jsx(N,{gap:1,children:s.jsx("select",{className:"form-select form-select-sm",value:i,onChange:c=>r(c.target.value),children:Yhe.map((c,u)=>s.jsx("option",{value:c,children:g(g(`wiredfurni.params.action.dance.${c}`))},u))})}):null]})]})},Khe=[{key:"wired",value:"Wired"},{key:"generic",value:"Hubbe"},{key:"GHOST",value:"Fantasma"},{key:"KILL",value:"Morte"},{key:"AVATAR",value:"Avatar"},{key:"AVATAR_HEAD",value:"Avatar (Cabeça)"},{key:"SUCCESS",value:"Sucesso"},{key:"ERROR",value:"Erro"},{key:"INFO",value:"Informação"},{key:"WARNING",value:"Aviso"}],qhe=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(""),{trigger:n=null,setStringParam:o=null}=le(),[l,c]=h.useState(!1),u=()=>{o(e+Yt+i)};return h.useEffect(()=>{const d=n.stringData.split(Yt);d.length>0&&t(d[0]),d.length>1&&r(d[1])},[n]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.message")}),s.jsx(Hi,{data:[],value:e,onChange:t,maxLength:150,showDropdown:l,setShowDropdown:c,showPlaceholders:!0},"inputChat0")]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.notification")}),s.jsx(N,{gap:1,children:s.jsx("select",{className:"form-select form-select-sm",value:i,onChange:d=>r(d.target.value),children:Khe.map(({key:d,value:_})=>s.jsx("option",{value:d,children:_},d))})})]})]})},Xhe=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(""),[n,o]=h.useState(50),{trigger:l=null,setStringParam:c=null,setIntParams:u=null,wiredSoundEffectsCategories:d}=le(),_=()=>{c(e+Yt+i),u([n])};h.useEffect(()=>{if(!l)return;const f=l.stringData.split(Yt);t(f.length>0?f[0]:""),r(f.length>=1?f[1]:""),o(l.intData.length>0?l.intData[0]:50)},[l]);const m=()=>{kQ(i,n/100)};return s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:_,children:s.jsxs(N,{gap:2,children:[s.jsx(T,{bold:!0,children:"Categoria:"}),s.jsxs("select",{className:"form-control form-control-sm",value:e,onChange:f=>{t(f.target.value),r("")},children:[s.jsx("option",{value:"",disabled:!0,children:"Selecione..."}),d.size>0?[...d.keys()].map(f=>s.jsx("option",{value:f,children:f},f)):null]}),s.jsx(T,{bold:!0,children:"Efeito sonoro:"}),s.jsxs(x,{children:[s.jsxs("select",{className:"form-control form-control-sm",value:i,onChange:f=>r(f.target.value),children:[s.jsx("option",{value:"",disabled:!0,children:"Selecione..."}),d.size>0&&e?d.get(e).map(f=>s.jsx("option",{value:f,children:f.replace(new RegExp("_","g")," ")},f)):null]}),s.jsx(X,{alignItems:"center",justifyContent:"center",style:{borderRadius:"5px",marginInline:"5px"},disabled:!i,onClick:m,children:s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 448 512",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"})})})]}),s.jsxs(N,{gap:1,children:[s.jsxs(T,{bold:!0,children:[g("Volume:"),s.jsx("input",{type:"number",min:0,max:100,className:"form-control form-control-sm fs-7 d-inline",step:"1",style:{maxWidth:"50px",marginLeft:"5px"},value:n,onChange:f=>{o(parseInt(f.target.value))}})]}),s.jsx(zt,{min:0,max:100,value:n,setValue:o})]})]})})},$he=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(2),[n,o]=h.useState(2),{trigger:l=null,setIntParams:c=null}=le(),u=()=>c([e,i,n]);return h.useEffect(()=>{t(l.intData.length>0?l.intData[0]:0),r(l.intData.length>1?l.intData[1]:2);let d=l.intData.length>2?l.intData[2]:2;d<2?d=2:d>11&&(d=11),o(d)},[l]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:u,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"showMessage",checked:!!e,onChange:d=>t(d.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.showmessage")})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsx(T,{bold:!0,children:g("Modo:")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"toggleType",checked:i===0,onChange:d=>r(0)}),s.jsx(T,{children:g("wiredfurni.params.on")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"toggleType",checked:i===1,onChange:d=>r(1)}),s.jsx(T,{children:g("wiredfurni.params.off")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"toggleType",checked:i===2,onChange:d=>r(2)}),s.jsx(T,{children:g("wiredfurni.params.toggletype.3")})]},2),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsx(T,{bold:!0,children:g("Passos:")}),s.jsx("input",{type:"number",className:"form-control",max:11,min:2,value:n,onChange:d=>o(parseInt(d.target.value))})]})})},Qhe=[0,1,2,3,4,5],Jhe=a=>{const{trigger:e,setIntParams:t,setStringParam:i}=le(),[r,n]=h.useState(""),[o,l]=h.useState(0),[c,u]=h.useState(""),{items:d,populateChooser:_}=en(),[m,f]=h.useState([]),[E,I]=h.useState(!1),p=()=>{i(r+Yt+c),t([o])};return h.useEffect(()=>{const S=e.stringData.split(Yt);n(S.length>0?S[0]:"1"),u(S.length>1?S[1]:""),l(e.intData.length>1?e.intData[1]:0)},[e]),h.useEffect(()=>{if(!d){_();return}const S=d.filter(R=>R&&R.type===4).map(R=>R.name);f(S)},[d]),s.jsx(qe,{hasSpecialInput:!0,save:p,children:s.jsxs(N,{gap:2,children:[s.jsxs(N,{gap:1,onMouseLeave:()=>I(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.name")}),s.jsx(Hi,{data:m,value:c,onChange:u,maxLength:32,showDropdown:E,setShowDropdown:I},m.length)]}),s.jsx(N,{gap:1,children:s.jsxs(x,{gap:2,children:[s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"freeze",id:"freeze",checked:r==="1",onChange:S=>n("1")}),s.jsx(T,{children:g("Congelar")})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"freeze",id:"unfreeze",checked:r==="0",onChange:S=>n("0")}),s.jsx(T,{children:g("Descongelar")})]})]})}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.give_effect")}),s.jsx("select",{className:"form-select form-select-sm",value:o,onChange:S=>l(parseInt(S.target.value)),children:Qhe.map((S,R)=>s.jsx("option",{value:S,children:g(`wiredfurni.params.freeze.effect.${S}`)},R))})]})]})})},Zhe=a=>{const{trigger:e,setIntParams:t}=le(),[i,r]=h.useState(0),n=()=>{t([i])};return h.useEffect(()=>{r(e.intData.length>0?e.intData[0]:0)},[e]),s.jsx(qe,{hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"showMessage",checked:!!i,onChange:o=>r(o.target.checked?1:0)}),s.jsx(T,{children:"Colisão na Diagonal"})]})]})})},ede=a=>{var E;const[e,t]=h.useState(""),[i,r]=h.useState(""),[n,o]=h.useState(50),[l,c]=h.useState(0),{trigger:u=null,setStringParam:d=null,setIntParams:_=null,wiredMusicsCategories:m}=le(),f=()=>{d(e+Yt+i),_([n,l])};return h.useEffect(()=>{if(!u)return;const I=u.stringData.split(Yt);t(I.length>0?I[0]:""),r(I.length>=1?I[1]:""),o(u.intData.length>0?u.intData[0]:50),c(u.intData.length>1?u.intData[1]:0)},[u]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:f,children:s.jsxs(N,{gap:2,children:[s.jsx(T,{bold:!0,children:"Categoria:"}),s.jsxs("select",{className:"form-control form-control-sm",value:e,onChange:I=>{t(I.target.value),r("")},children:[s.jsx("option",{value:"",disabled:!0,children:"Selecione..."}),m.size>0?[...m.keys()].map(I=>s.jsx("option",{value:I,children:I},I)):null]}),s.jsx(T,{bold:!0,children:"Música:"}),s.jsxs("select",{className:"form-control form-control-sm",value:i,onChange:I=>r(I.target.value),children:[s.jsx("option",{value:"",disabled:!0,children:"Selecione..."}),m.size>0&&e?(E=m.get(e))==null?void 0:E.map(I=>s.jsx("option",{value:I,children:I.replace(new RegExp("_","g")," ")},I)):null]}),s.jsx(T,{bold:!0,children:"Repetir:"}),s.jsxs("select",{className:"form-control form-control-sm",value:l,onChange:I=>c(parseInt(I.target.value)),children:[s.jsx("option",{value:"0",children:"Não"}),s.jsx("option",{value:"1",children:"Sim"})]}),s.jsxs(N,{gap:1,children:[s.jsxs(T,{bold:!0,children:[g("Volume:"),s.jsx("input",{type:"number",min:0,max:100,className:"form-control form-control-sm fs-7 d-inline",step:"1",style:{maxWidth:"50px",marginLeft:"5px"},value:n,onChange:I=>{o(parseInt(I.target.value))}})]}),s.jsx(zt,{min:0,max:100,value:n,setValue:o})]})]})})},tde=a=>{const[e,t]=h.useState("0"),[i,r]=h.useState("0"),[n,o]=h.useState("0"),[l,c]=h.useState(0),[u,d]=h.useState(0),[_,m]=h.useState(0),{trigger:f=null,setIntParams:E=null,setStringParam:I=null}=le(),p=()=>{I(e+Yt+i+Yt+n),E([l,u,_])};return h.useEffect(()=>{const S=f.stringData.split(Yt);S.length>0&&t(S[0]),S.length>1&&r(S[1]),S.length>2&&o(S[2]),f.intData.length>0&&c(f.intData[0]),f.intData.length>1&&d(f.intData[1]),f.intData.length>2&&m(f.intData[2])},[f]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:p,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{children:"Coordenada X:"}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"xFlag",checked:!!l,onChange:S=>c(S.target.checked?1:0)}),s.jsx("input",{type:"text",className:"form-control form-control-sm",max:"32",disabled:!l,value:e,onChange:S=>t(S.target.value)})]}),s.jsx(T,{children:"Coordenada Y:"}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"yFlag",checked:!!u,onChange:S=>d(S.target.checked?1:0)}),s.jsx("input",{type:"text",className:"form-control form-control-sm",max:"32",disabled:!u,value:i,onChange:S=>r(S.target.value)})]}),s.jsx(T,{children:"Coordenada Z:"}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"zFlag",checked:!!_,onChange:S=>m(S.target.checked?1:0)}),s.jsx("input",{type:"text",className:"form-control form-control-sm",max:"32",disabled:!_,value:n,onChange:S=>o(S.target.value)})]})]})})},Bp=2147483647,Er=a=>{const{wiredVariableTypes:e=[],type:t=Bp,setType:i=null,selectedVar:r=null,setSelectedVar:n=null,callback:o=null,isDisabled:l=!1,tooltip:c="wiredfurni.params.variables.variable_selection.tooltip",title:u="wiredfurni.params.variables.variable_selection",bold:d=!0,isReference:_=!1,disableInternal:m=!1,neededPermissions:f={write:!1,createAndDelete:!1,interceptChanges:!1,alwaysAvailable:!1,value:!1},availabilityTypes:E=[]}=a,{trigger:I}=le(),[p,S]=h.useState(!1),[R,O]=h.useState(!0),[C,A]=h.useState(!1),[b,y]=h.useState(""),[M,U]=h.useState(null),[G,F]=h.useState(2),[H,v]=h.useState([]),[B,z]=h.useState({top:0,left:0}),$=h.useRef(null);h.useEffect(()=>{const me=fe=>{var ae;(ae=$.current)!=null&&ae.contains(fe.target)||(A(!1),v([]))};return document.addEventListener("mousedown",me),()=>document.removeEventListener("mousedown",me)},[]);const W=(me,fe)=>{if(!fe.children)return v([]);const ae=me.currentTarget.getBoundingClientRect(),Te=$.current.getBoundingClientRect();v(fe.children),z({top:ae.top-Te.top+110,left:ae.width+15})},V=h.useCallback(me=>E.length&&!E.includes(me.availabilityType)||f.write&&!me.canWriteValue||f.createAndDelete&&!me.canCreateAndDelete||f.interceptChanges&&!me.canInterceptChanges||f.alwaysAvailable&&!me.alwaysAvailable?!1:!(f.value&&!me.hasValue),[E,f]),se=h.useMemo(()=>{var ae,Te,Se;const me=[],fe=I.wiredContext?((ae=I.wiredContext.roomVariablesList)==null?void 0:ae.variables)||((Te=I.wiredContext.rulesetVariables)==null?void 0:Te.variables)||((Se=I.wiredContext.referenceVariablesList)==null?void 0:Se.variables):[];if(!fe||!fe.length)return me;for(const Le of fe)(o==null||o(Le))&&Le.variableName!=""&&(Le.variableTarget===t||t===Bp)&&(Le.isInvisible&&r!==Le.variableId||(r===Le.variableId&&(Le.availabilityType===Ls.INTERNAL&&!_||(Le.availabilityType===Ls.REFERENCE||Le.availabilityType===Ls.INTERNAL)&&_)&&!R&&!m&&O(!0),Le.availabilityType===Ls.INTERNAL&&S(!m),(Le.availabilityType===Ls.REFERENCE&&_&&R&&!m||Le.availabilityType===Ls.INTERNAL&&(R||_)&&!m||Le.availabilityType===Ls.SMART&&(R||_)&&!m||Le.availabilityType!==Ls.INTERNAL&&Le.availabilityType!==Ls.REFERENCE&&Le.availabilityType!==Ls.SMART)&&me.push(Le)));return me.filter(Le=>e.includes(Le.variableTarget))},[I,o,t,r,_,R,m,e]);h.useEffect(()=>{r&&U(se[se.map(me=>me.variableId).indexOf(r)])},[r,se]);const ie=h.useCallback(me=>{switch(G){default:case 0:return me;case 1:return[];case 2:return me.filter(fe=>fe.availabilityType!==Ls.INTERNAL&&fe.availabilityType!==Ls.REFERENCE&&fe.availabilityType!==Ls.SMART);case 3:return me.filter(fe=>fe.availabilityType===Ls.SMART);case 4:return me.filter(fe=>fe.availabilityType===Ls.INTERNAL||fe.availabilityType===Ls.REFERENCE);case 5:return me.map(fe=>fe.variableName.toLowerCase().includes(b.toLowerCase())?fe:null).filter(Boolean)}},[G,b])(se),Z=(me,fe)=>me.availabilityType===Ls.INTERNAL||fe?me.variableName:ne(me.variableName.split("_").join(" ").replace("."," -> ")),ne=me=>{let fe=me.split(" "),ae=[];for(const Te of fe)ae.push(Te.charAt(0).toUpperCase()+Te.slice(1));return ae.join(" ")},_e=me=>{n(me.variableId),U(me)},de=()=>{U(null),n(-1),y("")};return s.jsxs(N,{gap:1,children:[s.jsxs(x,{justifyContent:"between",children:[s.jsx(T,{bold:d,children:g(u)}),t!=null&&i&&s.jsx(N,{children:s.jsx(x,{justifyContent:"between",alignItems:"center",className:`nitro-variables-options ${l&&"disabled-input-sources"}`,children:e==null?void 0:e.map((me,fe)=>s.jsx("div",{className:`icon-variable icon-variable-${me} ${me===t?"active":""}`,onClick:()=>i(me)},fe))})})]}),s.jsxs("div",{className:`ns-container ${l?"disabled":""}`,ref:$,children:[s.jsxs("button",{className:"ns-toggle",onClick:()=>{A(me=>!me),M&&y(Z(M,!1))},"aria-haspopup":"listbox","aria-expanded":C,children:[M?Z(M,!1):g(c),s.jsx(bS,{})]}),C&&s.jsxs("div",{className:"ns-dropdown",children:[s.jsxs("div",{className:"ns-categories",children:[s.jsx("div",{title:"Todas as variáveis",className:"ns-category "+(G===0?"ns-category-active":""),onClick:()=>F(0),children:s.jsx(MV,{size:13})}),s.jsx("div",{title:"Variáveis recentes",className:"ns-category "+(G===1?"ns-category-active":""),onClick:()=>F(1),children:s.jsx(jV,{size:13})}),s.jsx("div",{title:"Variáveis criadas pelo usuário",className:"ns-category "+(G===2?"ns-category-active":""),onClick:()=>F(2),children:s.jsx(LV,{size:13})}),s.jsx("div",{title:"Variáveis inteligentes",className:"ns-category "+(G===3?"ns-category-active":""),onClick:()=>F(3),children:s.jsx(PV,{size:13})}),s.jsx("div",{title:"Variáveis internas",className:"ns-category "+(G===4?"ns-category-active":""),onClick:()=>F(4),children:s.jsx(UV,{size:13})}),s.jsx("div",{title:"Buscar",className:"ns-category "+(G===5?"ns-category-active":""),onClick:()=>F(5),children:s.jsx(wV,{size:13})})]}),s.jsxs("div",{className:"ns-search-container",children:[s.jsx("input",{type:"text",className:"ns-search",placeholder:g(c),value:b,onChange:me=>{y(me.target.value),F(5)},autoFocus:!0}),M&&s.jsx("div",{className:"ns-removeVar",onClick:()=>de(),children:s.jsx(FV,{size:12})})]}),s.jsxs("div",{className:"ns-pane",children:[ie.length>0&&ie.map(me=>s.jsx("div",{className:`ns-item ${V(me)?"":"disabled"}`,onMouseEnter:fe=>W(fe,me),onClick:fe=>{!me.children&&V(me)&&(_e(me),A(!1))},children:s.jsx("span",{children:Z(me,!1)})},Z(me,!1))),ie.length===0&&s.jsx("div",{className:"sn-pane-nothing",children:g("wired.variablepicker.nothing")})]})]})]})]})},md=class md{};md.FURNI=0,md.USER=1,md.GLOBAL=-10,md.CONTEXT=-20;let qs=md;class $r{constructor(e,t,i,r,n){this._sourcesIndex=e,this._title=t,this._type=i,this._setType=r,this._isDisabled=n}get sourcesIndex(){return this._sourcesIndex}get title(){return this._title}get type(){return this._type}get setType(){return this._setType}get isDisabled(){return this._isDisabled}}const sde=a=>{const[e,t]=h.useState(qs.USER),[i,r]=h.useState(-1),[n,o]=h.useState(!1),[l,c]=h.useState(0),{trigger:u,setIntParams:d,setVariableIds:_}=le(),m=()=>{d([e,l,n?1:0]),_([i])};return h.useEffect(()=>{t(u.intData.length>0?u.intData[0]:0),c(u.intData.length>1?u.intData[1]:0),o(u.intData.length>2?u.intData[2]===1:!1),r(u.variableIds.length>0?u.variableIds[0]:-1)},[u]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,mergedSelections:[new $r([0,0],"wiredfurni.params.sources.merged.title.variables_destination",e,t)],mergedSources:!0,advancedAlwaysVisible:!0,save:m,children:[s.jsx(Er,{wiredVariableTypes:[0,1,-20],type:e,setType:t,selectedVar:i,setSelectedVar:r,neededPermissions:{createAndDelete:!0}}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"replaceVariable",checked:n,onChange:f=>o(f.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.variables.value_settings.override_existing")})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,className:!n&&"disabled-input-sources",children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.value_settings")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{children:g("wiredfurni.params.variables.value_settings.initial_value")}),s.jsx("input",{disabled:!n,className:"form-control form-control-sm fs-7",style:{maxWidth:"60px"},type:"number",value:l,onChange:f=>c(parseInt(f.target.value))})]})]})]})},ide=a=>{const[e,t]=h.useState(-10),[i,r]=h.useState(-10),[n,o]=h.useState(-1),[l,c]=h.useState(-1),[u,d]=h.useState(0),[_,m]=h.useState(0),[f,E]=h.useState(0),[I,p]=h.useState(!1),{trigger:S,setIntParams:R,setVariableIds:O}=le(),C=h.useMemo(()=>_!==1,[_]),A=h.useMemo(()=>{const M=[0,1,2,3,4,5,6],U=[40,41,50,60,100,101,102,103,104,105];return I?[...M,...U]:M},[I]),b=M=>{const U=parseInt(M.target.value);if(U===-1){M.stopPropagation(),M.preventDefault(),p(!0);return}d(U)},y=()=>{R([e,u,_,f,i]),O([n,l])};return h.useEffect(()=>{t(S.intData.length>0?S.intData[0]:-10),d(S.intData.length>1?S.intData[1]:0),m(S.intData.length>2?S.intData[2]:0),E(S.intData.length>3?S.intData[3]:0),r(S.intData.length>4?S.intData[4]:-10),o(S.variableIds.length>0?S.variableIds[0]:-1),c(S.variableIds.length>1?S.variableIds[1]:-1)},[S]),h.useEffect(()=>{p(u>=50)},[u]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,mergedSources:!0,advancedAlwaysVisible:!0,mergedSelections:[new $r([0,0],"wiredfurni.params.sources.merged.title.variables",e,t),new $r([1,1],"wiredfurni.params.sources.merged.title.variables_reference",i,r,C)],save:y,children:[s.jsx(Er,{wiredVariableTypes:[0,1,-10,-20],type:e,setType:t,selectedVar:n,setSelectedVar:o,neededPermissions:{write:!0}}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.comparison_selection")}),s.jsxs("select",{className:"form-select form-select-sm w-100",value:u,onChange:b,children:[A.map((M,U)=>s.jsx("option",{value:M,children:g(`wiredfurni.params.variables.operation.${M}`)},U)),!I&&s.jsx("option",{id:"showAdvanced",value:-1,children:g("wiredfurni.params.variables.operation.advanced")})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,disabled:u===60,children:g("wiredfurni.params.variables.reference_value")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedReferenceValue",id:"selectedReferenceValue0",checked:_===0,disabled:u===60,onChange:M=>m(0)}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{children:g("wiredfurni.params.variables.reference_value.set_value")}),s.jsx("input",{className:"form-control form-control-sm fs-7",style:{maxWidth:"60px"},disabled:u===60,type:"number",onChange:M=>E(parseInt(M.target.value)),value:f})]})]},0),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedReferenceValue",id:"selectedReferenceValue1",checked:_===1,disabled:u===60,onChange:M=>m(1)}),s.jsx("div",{className:"flex-grow-1",children:s.jsx(Er,{wiredVariableTypes:[0,1,-10,-20],type:i,setType:r,selectedVar:l,setSelectedVar:c,isDisabled:_!==1||u===60,isReference:!0,bold:!1,title:"wiredfurni.params.variables.reference_value.from_variable"})})]},1)]})]})},rde=a=>{const[e,t]=h.useState(1),[i,r]=h.useState(-1),[n,o]=h.useState(0),{trigger:l,setIntParams:c,setVariableIds:u}=le(),d=()=>{c([e,n]),u([i])};return h.useEffect(()=>{t(l.intData.length>0?l.intData[0]:0),o(l.intData.length>1?l.intData[1]:0),r(l.variableIds.length>0?l.variableIds[0]:-1)},[l]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:d,mergedSources:!0,advancedAlwaysVisible:!0,mergedSelections:[new $r([0,0],"wiredfurni.params.sources.merged.title.variables",e,t)],children:[s.jsx(Er,{wiredVariableTypes:[0,1,-20],type:e,setType:t,isDisabled:n==1,selectedVar:i,setSelectedVar:r,neededPermissions:{createAndDelete:!0}}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(x,{column:!0,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.remove_options")}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",id:"selectedVar",name:"operationMode",checked:n===0,onChange:()=>o(0)}),s.jsx(T,{children:g("wiredfurni.params.variables.selected_var")})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",id:"allVars",name:"operationMode",checked:n===1,onChange:()=>o(1)}),s.jsx(T,{children:g("wiredfurni.params.variables.all_vars")})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",id:"resetData",name:"operationMode",checked:n===2,onChange:()=>o(2)}),s.jsx(T,{children:g("wiredfurni.params.variables.reset_data")})]})]})]})},nde=a=>{const[e,t]=h.useState(0),{trigger:i,setIntParams:r}=le(),n=()=>{r([e])};return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:"Se o usuário estivesse andando:"}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:e===0,onChange:o=>t(0)}),s.jsx(T,{children:"Continuar andando se for movido para junto do alvo"})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:e===1,onChange:o=>t(1)}),s.jsx(T,{children:"Continuar andando"})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType2",checked:e===2,onChange:o=>t(2)}),s.jsx(T,{children:"Parar de andar"})]})]})})},ade=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(""),{items:n,populateChooser:o}=en(),[l,c]=h.useState([]),{trigger:u=null,setStringParam:d=null}=le(),[_,m]=h.useState(!1),[f,E]=h.useState(!1),I=()=>{d(e+Yt+i)};return h.useEffect(()=>{const p=u.stringData.split(Yt);p.length>0&&t(p[0]),p.length>1&&r(p[1].length>0?p[1]:"")},[u]),h.useEffect(()=>{if(!n){o();return}const p=n.filter(S=>S&&S.type===4).map(S=>S.name);c(p)},[n]),s.jsxs(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,userSelectionTitle:"wiredfurni.params.sources.user.title.bot",save:I,children:[s.jsxs(N,{gap:1,onMouseLeave:()=>m(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.name")}),s.jsx(Hi,{data:l,value:e,onChange:t,maxLength:32,showDropdown:_,setShowDropdown:m},l.length)]}),s.jsxs(N,{gap:1,onMouseLeave:()=>E(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.motto")}),s.jsx(Hi,{data:[],value:i,onChange:r,maxLength:64,showDropdown:f,setShowDropdown:E,showPlaceholders:!0,showColors:!0},l.length+1)]})]})},ode=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(0),[n,o]=h.useState(0),[l,c]=h.useState(0),{trigger:u=null,setStringParam:d=null,setIntParams:_=null}=le(),m=()=>{d(e),_([i,n,l])};return h.useEffect(()=>{t(u.stringData),r(u.intData.length>0?u.intData[0]:0),o(u.intData.length>1?u.intData[1]:0),c(u.intData.length>2?u.intData[2]:0)},[u]),s.jsxs(qe,{hasSpecialInput:!0,save:m,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wired.params.seteffect")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:80,value:e,onChange:f=>t(f.target.value)})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(x,{gap:1,children:[s.jsx("input",{type:"checkbox",className:"form-check-input",checked:i===1,onChange:f=>r(f.target.checked?1:0)}),s.jsx(T,{children:g("wired.params.use_duration")})]}),i===1&&s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wired.params.duration_time")}),s.jsx("input",{type:"number",className:"form-control form-control-sm",value:n,onChange:f=>o(parseInt(f.target.value))})]}),i===1&&s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(x,{gap:1,children:[s.jsx("input",{type:"checkbox",className:"form-check-input",checked:l===1,onChange:f=>c(f.target.checked?1:0)}),s.jsx(T,{children:g("wired.params.last_effect")})]})]})},lde=a=>{const[e,t]=h.useState(0),{trigger:i=null,setIntParams:r=null}=le(),n=()=>{r([e?1:0])};return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(qe,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:n,furniSelectionTitleIndexed:"wiredfurni.params.sources.furni.title.mv.",advancedAlwaysVisible:!0,children:s.jsxs(x,{gap:1,children:[s.jsx("input",{type:"checkbox",className:"form-check-input",checked:e===1,onChange:o=>t(o.target.checked?1:0)}),s.jsx(T,{children:g("wired.params.allow_diagonal")})]})})},cde=a=>{switch(a){case Fe.DEFAULT:return s.jsx(Oy,{});case Fe.BOT_CHANGE_FIGURE:return s.jsx(Mue,{});case Fe.BOT_FOLLOW_AVATAR:return s.jsx(jue,{});case Fe.BOT_GIVE_HAND_ITEM:return s.jsx(Lue,{});case Fe.BOT_MOVE:return s.jsx(Pue,{});case Fe.BOT_TALK:return s.jsx(Fue,{});case Fe.CHANGE_BOT_MOTTO:return s.jsx(ade,{});case Fe.BOT_TALK_DIRECT_TO_AVTR:return s.jsx(wue,{});case Fe.BOT_TELEPORT:return s.jsx(kue,{});case Fe.CALL_ANOTHER_STACK:case Fe.NEG_CALL_ANOTHER_STACK:return s.jsx(Gue,{});case Fe.CHASE:return s.jsx(Bue,{});case Fe.CHAT:return s.jsx(Vue,{});case Fe.FLEE:return s.jsx(Wue,{});case Fe.GIVE_REWARD:return s.jsx(Kue,{});case Fe.GIVE_SCORE:return s.jsx(Xue,{});case Fe.GIVE_SCORE_TO_PREDEFINED_TEAM:return s.jsx(que,{});case Fe.JOIN_TEAM:return s.jsx($ue,{});case Fe.KICK_FROM_ROOM:return s.jsx(Que,{});case Fe.LEAVE_TEAM:return s.jsx(Jue,{});case Fe.MOVE_FURNI:return s.jsx(_he,{});case Fe.MOVE_AND_ROTATE_FURNI:return s.jsx(ahe,{});case Fe.MOVE_FURNI_TO:return s.jsx(uhe,{});case Fe.MUTE_USER:return s.jsx(ghe,{});case Fe.RESET:return s.jsx(Ihe,{});case Fe.SET_FURNI_STATE:return s.jsx(Rhe,{});case Fe.TELEPORT:return s.jsx(xhe,{});case Fe.TOGGLE_FURNI_STATE:return s.jsx(Ohe,{});case Fe.CONTROL_CLOCK:return s.jsx(Hue,{});case Fe.SET_FURNI_ALTITUDE:return s.jsx(She,{});case Fe.SEND_SIGNAL:case Fe.NEG_SEND_SIGNAL:return s.jsx(The,{});case Fe.FREEZE_USER:return s.jsx(zue,{});case Fe.UNFREEZE_USER:return s.jsx(Che,{});case Fe.RELATIVE_FURNI_MOVE:return s.jsx(Ehe,{});case Fe.MOVE_FURNI_TO_FURNI:return s.jsx(ohe,{});case Fe.MOVE_FURNI_TO_USER:return s.jsx(lhe,{});case Fe.ADJUST_CLOCK:return s.jsx(vue,{});case Fe.YOUTUBE:return s.jsx(Nhe,{});case Fe.MEMORY_OPERATION:return s.jsx(the,{});case Fe.GIVE_BADGE:return s.jsx(RS,{title:"wiredfurni.params.givebadge.code"});case Fe.SEND_SCRIPT_SIGNAL:return s.jsx(RS,{title:"wiredfurni.params.scriptsignal.code"});case Fe.SUPER_WIRED:return s.jsx(RS,{title:"wiredfurni.params.superwired.code",requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID});case Fe.OPACITY_ITEM:return s.jsx(mhe,{});case Fe.MEMORY_BOX:return s.jsx(Zue,{});case Fe.MEMORY_USER:return s.jsx(she,{});case Fe.MEMORY_BOX_STRING:return s.jsx(ehe,{});case Fe.MEMORY_USER_STRING:return s.jsx(ihe,{});case Fe.ROTATE_BOT:return s.jsx(Uue,{});case Fe.RESET_HIGHSCORE:return s.jsx(Ahe,{});case Fe.BOT_ACTIONS:return s.jsx(Dhe,{});case Fe.INFINITE_MUTE_USER:return s.jsx(Mhe,{});case Fe.BOT_SET_HAND_ITEM:return s.jsx(jhe,{});case Fe.LIGHT_CONTROLLER:return s.jsx(Lhe,{});case Fe.PAINT_FURNI:return s.jsx(Phe,{});case Fe.PLAYER_VISIBLE:return s.jsx(Uhe,{});case Fe.DISABLE_WIRED:return s.jsx(whe,{});case Fe.MOVE_USER:return s.jsx(Ghe,{});case Fe.TOGGLE_USER_INTERACTION:return s.jsx(Bhe,{});case Fe.GIVE_SCORE_CUSTOM:return s.jsx(Vhe,{});case Fe.USER_ACTIONS:return s.jsx(zhe,{});case Fe.USER_NOTIFICATION:return s.jsx(qhe,{});case Fe.PLAY_SOUND_EFFECT:return s.jsx(Xhe,{});case Fe.FAST_WALK:return s.jsx($he,{});case Fe.BOT_FREEZE:return s.jsx(Jhe,{});case Fe.COLLISION_AROUND:return s.jsx(Zhe,{});case Fe.PLAY_MUSIC:return s.jsx(ede,{});case Fe.MOVE_FURNI_BY_COORDINATES:return s.jsx(tde,{});case Fe.GIVE_VAR:return s.jsx(sde,{});case Fe.CHANGE_VAR:return s.jsx(ide,{});case Fe.REMOVE_VAR:return s.jsx(rde,{});case Fe.MOVE_USER_TO_FURNI:return s.jsx(nde,{});case Fe.SET_EFFECT:return s.jsx(ode,{});case Fe.FOLLOW_FURNI:return s.jsx(lde,{})}return s.jsx(Oy,{})},Tr=a=>{const{hasAdvancedSpecialInputs:e=!1,requiresFurni:t=ge.STUFF_SELECTION_OPTION_NONE,save:i=null,hasSpecialInput:r=!1,forceHidePickFurniInstructions:n=!1,children:o=null,advancedAlwaysVisible:l=!1,furniSelectionTitleIndexed:c=null,mergedSelections:u=null,mergedSources:d=!1}=a,_=()=>i&&i();return s.jsx(e_,{hasAdvancedSpecialInputs:e,wiredType:"addon",requiresFurni:t,forceHidePickFurniInstructions:n,hasSpecialInput:r,advancedAlwaysVisible:l,save:_,furniSelectionTitleIndexed:c,mergedSelections:u,mergedSources:d,children:o})},ude=a=>{const{trigger:e,setIntParams:t}=le(),[i,r]=h.useState(0),n=()=>t([i]);return h.useEffect(()=>{r(e.intData.length>0?e.intData[0]:0)},[e]),s.jsx(Tr,{hasSpecialInput:!0,save:n,children:s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.setanimationtime",["ms"],[i.toString()])}),s.jsx(zt,{min:0,max:2e3,step:50,value:i,setValue:r,renderThumb:(o,l)=>s.jsx("div",{...o,children:l.valueNow})})]})})},Jm=4,hde=(a,e)=>{switch(e.type){case"SET":return{...a,[e.key]:e.value};case"RESET":return{...a,[e.key]:e.value};default:return a}},dde=a=>{const[e,t]=h.useState(0),[i,r]=h.useReducer(hde,{});h.useState(0);const{trigger:n,setIntParams:o}=le(),l=()=>{e>=Jm?o([-1,e-Jm,i[e]||0]):o([e,0,0])};return h.useEffect(()=>{if((n.intData.length>0?n.intData[0]:0)===-1){const u=(n.intData.length>1?n.intData[1]:0)+Jm;t(u),r({type:"RESET",key:u,value:n.intData.length>2?n.intData[2]:0})}else t(n.intData.length>0?n.intData[0]:0)},[n]),s.jsxs(Tr,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:l,children:[s.jsx(T,{children:g("wiredfurni.params.cond_eval.note")}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.eval_mode")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2,3,4,5,6].map(c=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${c}`,checked:e===c,onChange:u=>t(c)}),s.jsxs(T,{children:[g(c>3?`wiredfurni.params.eval_mode.cmp.${c-Jm}`:`wiredfurni.params.eval_mode.${c}`),c>3&&s.jsx("input",{type:"number",className:"form-control form-control-sm fs-7 d-inline",step:"1",style:{maxWidth:"50px",marginLeft:"5px"},value:i[c]||0,onChange:u=>r({type:"SET",key:c,value:parseInt(u.target.value)||0})})]})]},c))})]})]})},_de=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),{trigger:n,setIntParams:o}=le(),l=()=>{o([i,e])};return h.useEffect(()=>{r(n.intData.length>0?n.intData[0]:0),t(n.intData.length>1?n.intData[1]:0)},[n]),s.jsxs(Tr,{hasSpecialInput:!0,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{fontWeight:"bold",children:g("wiredfurni.params.pickamount",["picks"],[e.toString()])}),s.jsx(zt,{min:1,max:50,value:e,setValue:t})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{fontWeight:"bold",children:g("wiredfurni.params.skipactions",["skips"],[i.toString()])}),s.jsx(zt,{min:0,max:50,value:i,setValue:r})]})]})},gde=a=>s.jsx(Tr,{hasSpecialInput:!1,save:null}),Cy=({limit:a})=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),{trigger:n,setIntParams:o}=le(),l=()=>{o([e,i])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.intData.length>1?n.intData[1]:0)},[n]),s.jsxs(Tr,{hasSpecialInput:!0,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{fontWeight:"bold",children:g("wiredfurni.params.setexecutions",["amount"],[e.toString()])}),s.jsx(zt,{min:1,max:a,value:e,setValue:t})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{fontWeight:"bold",children:g("wiredfurni.params.settimewindow",["timewindow"],[oh(i)])}),s.jsx(zt,{min:0,max:20,value:i,setValue:r})]})]})},mde=a=>s.jsx(Tr,{hasSpecialInput:!1,save:null}),fde=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(!1),[n,o]=h.useState(!1),[l,c]=h.useState(!1),{trigger:u,setIntParams:d}=le(),_=()=>{d([e?1:0,i?1:0,n?1:0,l?1:0])};return h.useEffect(()=>{t(u.intData.length>0?u.getBoolean(0):!1),r(u.intData.length>1?u.getBoolean(1):!1),o(u.intData.length>2?u.getBoolean(2):!1),c(u.intData.length>3?u.getBoolean(3):!1)},[u]),s.jsx(Tr,{hasSpecialInput:!0,save:_,forceHidePickFurniInstructions:!0,furniSelectionTitleIndexed:"wiredfurni.params.sources.furni.fisics.",children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.select_options")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"heightOption",checked:e,onChange:m=>t(m.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.movephysics.keep_altitude")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"moveThroughFurniOption",checked:i,onChange:m=>r(m.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.movephysics.move_through_furni")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"moveThroughHabboOption",checked:n,onChange:m=>o(m.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.movephysics.move_through_users")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"blockedByFurniOption",checked:l,onChange:m=>c(m.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.movephysics.block_by_furni")})]})]})})},pde=a=>{const{trigger:e,setIntParams:t}=le(),[i,r]=h.useState(0),n=()=>{t([i])};return h.useEffect(()=>{r(e.intData.length>0?e.intData[0]:0)},[e]),s.jsx(Tr,{hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.carry_mode")}),s.jsx(x,{column:!0,children:[0,1].map(o=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`carryMode${o}`,checked:i===o,onChange:l=>r(o)}),s.jsx(T,{children:g(`wiredfurni.params.carry_mode.${o}`)})]},o))})]})})},FB=a=>{const[e,t]=h.useState(10),[i,r]=h.useState(-1),[n,o]=h.useState(0),[l,c]=h.useState(0),{trigger:u,setIntParams:d,setVariableIds:_}=le(),m=()=>{d([e,n,l]),_([i])};return h.useEffect(()=>{t(u.intData.length>0?u.intData[0]:10),o(u.intData.length>1?u.intData[1]:0),c(u.intData.length>2?u.intData[2]:-10),r(u.variableIds.length>0?u.variableIds[0]:-1)},[u]),s.jsx(Tr,{hasSpecialInput:!0,save:m,mergedSources:!0,mergedSelections:[new $r([0,0],"wiredfurni.params.sources.merged.title.variables_reference",l,c,n===0)],children:s.jsx(N,{gap:1,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.setfilter")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedReferenceValue",id:"selectedReferenceValue0",checked:n===0,onChange:f=>o(0)}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{children:g("wiredfurni.params.variables.reference_value.set_value")}),s.jsx("input",{disabled:n===1,className:"form-control form-control-sm fs-7",style:{maxWidth:"60px"},value:e,onChange:f=>t(parseInt(f.target.value)),type:"number"})]})]},0),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedReferenceValue",id:"selectedReferenceValue1",checked:n===1,onChange:f=>o(1)}),s.jsx("div",{className:"flex-grow-1",children:s.jsx(Er,{wiredVariableTypes:[0,1,-10,-20],type:l,setType:c,selectedVar:i,setSelectedVar:r,isDisabled:n===0,isReference:!0,bold:!1,title:"wiredfurni.params.variables.reference_value.from_variable",neededPermissions:{value:!0}})})]},1)]})})})},Ede=a=>s.jsx(FB,{paramTitle:"wiredfurni.params.setfilter"}),Ide=a=>s.jsx(FB,{paramTitle:"wiredfurni.params.setfilter"}),Tde=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(""),{trigger:n=null,setStringParam:o=null,setIntParams:l=null}=le(),c=()=>{o(e+Yt+i)};return h.useEffect(()=>{const u=n.stringData.split(Yt);u.length>0&&t(u[0]),u.length>1&&r(u[1])},[n]),s.jsxs(Tr,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.key")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:u=>t(u.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:u=>r(u.target.value)})]})]})},Sde=a=>{const{title:e=""}=a,[t,i]=h.useState(""),{trigger:r=null,setStringParam:n=null}=le(),o=()=>{n(t)};return h.useEffect(()=>{i(r.stringData)},[r]),s.jsx(Tr,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:o,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g(e)}),s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:80,value:t,onChange:l=>i(l.target.value)})]})})},Rde=a=>{const[e,t]=h.useState(1),{trigger:i,setIntParams:r}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData[0]||1)},[i]),s.jsxs(Tr,{hasSpecialInput:!0,save:n,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.order.execute")}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"executeOrder",checked:e===1,onChange:()=>t(1)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.order.execute1")})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"executeOrder",checked:e===2,onChange:()=>t(2)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.order.execute2")})]})]})]})},Ny=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),[n,o]=h.useState(!1);h.useState(!0);const[l,c]=h.useState(0),[u,d]=h.useState(0),[_,m]=h.useState(0),[f,E]=h.useState([0,1,2,3,4,5]),[I,p]=h.useState(10),{trigger:S,setIntParams:R,setVariableIds:O}=le(),{variablesSource:C=Bp}=a,A=()=>{R([_,u,I,l]),O([e,i])};h.useEffect(()=>{m(S.intData.length>0?S.intData[0]:0),d(S.intData.length>1?S.intData[1]:0),p(S.intData.length>2?S.intData[2]:0),c(S.intData.length>3?S.intData[3]:-10),t(S.variableIds.length>0?S.variableIds[0]:-1),r(S.variableIds.length>1?S.variableIds[1]:-1)},[S]);const b=y=>{const M=parseInt(y.target.value);if(M===-1){y.stopPropagation(),y.preventDefault(),o(!0);return}M<50&&o(!1),m(M)};return h.useEffect(()=>{o(_>=50)},[_]),s.jsxs(Tr,{hasSpecialInput:!0,save:A,mergedSources:!0,advancedAlwaysVisible:!0,mergedSelections:[new $r([0,0],"wiredfurni.params.sources.merged.title.variables_reference",l,c,u===0)],children:[s.jsx(Er,{wiredVariableTypes:[C],type:C,selectedVar:e,setSelectedVar:t}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.comparison_selection")}),s.jsx("select",{className:"form-select form-select-sm w-100",value:_,onChange:b,children:f.map((y,M)=>s.jsx("option",{value:y,children:g(`wiredfurni.params.variables.sort_by.${y}`)},M))})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.setfilter")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedReferenceValue",id:"selectedReferenceValue0",checked:u===0,onChange:y=>d(0)}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{children:g("wiredfurni.params.variables.reference_value.set_value")}),s.jsx("input",{disabled:u===1,className:"form-control form-control-sm fs-7",style:{maxWidth:"60px"},value:I,onChange:y=>p(parseInt(y.target.value)),type:"number"})]})]},0),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedReferenceValue",id:"selectedReferenceValue1",checked:u===1,onChange:y=>d(1)}),s.jsx("div",{className:"flex-grow-1",children:s.jsx(Er,{wiredVariableTypes:[0,1,-10,-20],type:l,setType:c,selectedVar:i,setSelectedVar:r,isDisabled:u===0,isReference:!0,bold:!1,title:"wiredfurni.params.variables.reference_value.from_variable"})})]},1)]})]})},xde=29,Ode=a=>{const[e,t]=h.useState(""),{trigger:i,setStringParam:r}=le(),n=()=>r(e.replace(/\n\r/g,"	").replace(/\r/g,"	").replace(/\n/g,"	"));h.useEffect(()=>{t(i.stringData.replace(/\t/g,`
`).replace(/\r/g,`
`).replace(/\n\r/g,`
`))},[i]);const o=h.useCallback(l=>{const u=l.target.value.split(`
`);let d=0;const _=[];for(let m=0;m<u.length;m++){const f=u[m];f.includes("=")&&d<xde?(d++,_.push(f)):f.includes("=")||_.push(f)}t(_.join(`
`))},[]);return s.jsx(Tr,{hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.connect_text.title")}),s.jsx("textarea",{className:"form-control form-control-sm",placeholder:g("wiredfurni.params.variables.connect_text.caption"),value:e,rows:7,onChange:o})]})})};function Cde(a){return a.variableName.replace("@","").replace("~","").replace(/\./g,"_")}const Nde=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(""),[n,o]=h.useState(1),{trigger:l,setIntParams:c,setStringParam:u,setVariableIds:d}=le(),_=E=>{var p,S,R;t(E);const I=(R=(S=(p=l.wiredContext)==null?void 0:p.roomVariablesList)==null?void 0:S.variables)==null?void 0:R.find(O=>O.variableId===E);I&&!i.length&&r(Cde(I))},m=()=>{u(i),c([n]),d([e])};h.useEffect(()=>{r(l.stringData),o(l.intData.length>0?l.intData[0]:1),t(l.variableIds.length>0?l.variableIds[0]:-1)},[l]);const f=h.useMemo(()=>{var E;return l&&l.wiredContext&&l.wiredContext.roomVariablesList&&l.wiredContext.roomVariablesList.variables&&((E=l.wiredContext.roomVariablesList.variables.find(I=>I.variableId===e))==null?void 0:E.hasTextConnector)},[l,e]);return s.jsxs(Tr,{hasSpecialInput:!0,save:m,children:[s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.texts.capturer_name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:E=>r(E.target.value)}),s.jsx(T,{dangerouslySetInnerHTML:{__html:g("wiredfurni.params.texts.placeholder_preview",["placeholder"],["#("+i+")"])}})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsx(Er,{title:"wiredfurni.params.texts.variable_output",tooltip:"wiredfurni.params.variables.variable_selection.tooltip.context",wiredVariableTypes:[-20],selectedVar:e,setSelectedVar:_}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.texts.variable_input_type")}),[1,2].map(E=>s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedEntranceType",id:`selectedOperation${E}`,checked:n===E,disabled:E===2&&!f,onChange:I=>o(E)}),s.jsxs(N,{children:[s.jsx(T,{children:g(`wiredfurni.params.texts.variable_display_type.${E}`)}),E===2&&s.jsx(T,{style:{opacity:.6},children:g("wiredfurni.params.texts.variable_display_type.2.info")})]})]},E))]})]})};function Ade(a){return a.variableName.replace("@","").replace("~","").replace(/\./g,"_")}const bde=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(""),[n,o]=h.useState(1),[l,c]=h.useState(1),[u,d]=h.useState(1),[_,m]=h.useState(""),[f,E]=h.useState(0),{trigger:I,setVariableIds:p,setStringParam:S,setIntParams:R}=le(),O=b=>{var M,U,G;t(b);const y=(G=(U=(M=I.wiredContext)==null?void 0:M.roomVariablesList)==null?void 0:U.variables)==null?void 0:G.find(F=>F.variableId===b);y&&!i.length&&r(Ade(y))},C=()=>{S(i+Yt+_),R([n,u,l,f]),p([e])};h.useEffect(()=>{const b=I.stringData.split(Yt);r(b[0]??""),m(b[1]??""),o(I.intData.length>0?I.intData[0]:1),d(I.intData.length>1?I.intData[1]:1),c(I.intData.length>2?I.intData[2]:1),E(I.intData.length>3?I.intData[3]:0),t(I.variableIds.length>0?I.variableIds[0]:-1)},[I]);const A=h.useMemo(()=>{var b;return I&&I.wiredContext&&I.wiredContext.roomVariablesList&&I.wiredContext.roomVariablesList.variables&&((b=I.wiredContext.roomVariablesList.variables.find(y=>y.variableId===e))==null?void 0:b.hasTextConnector)},[I,e]);return s.jsxs(Tr,{hasSpecialInput:!1,save:C,mergedSources:!0,forceHidePickFurniInstructions:!0,advancedAlwaysVisible:!0,mergedSelections:[new $r([0,0],"wiredfurni.params.sources.merged.title.variables",l,c)],children:[s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.texts.capturer_name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:b=>r(b.target.value)}),s.jsx(T,{dangerouslySetInnerHTML:{__html:g("wiredfurni.params.texts.placeholder_preview",["placeholder"],["$("+i+")"])}})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsx(Er,{type:l,setType:c,wiredVariableTypes:[0,1,-10,-20],selectedVar:e,setSelectedVar:O}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.texts.variable_input_type")}),[1,2].map(b=>s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedEntranceType",id:`selectedOperation${b}`,checked:n===b,disabled:b===2&&!A,onChange:y=>o(b)}),s.jsxs(N,{gap:1,children:[s.jsx(T,{children:g(`wiredfurni.params.texts.variable_display_type.${b}`)}),b===1&&[0,1,2].map(y=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"exhibitionOrder",id:`exhibitionOrder${y}`,disabled:n!==b,checked:f===y,onChange:M=>E(y)}),s.jsx(T,{children:g(`wiredfurni.params.texts.variable_display_type.1.order.${y}`)})]},y)),b===2&&s.jsx(T,{style:{opacity:.6},children:g("wiredfurni.params.texts.variable_display_type.2.info")})]})]},b))]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.texts.placeholder_type")}),[1,2].map(b=>s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"spaceType",id:`spaceType${b}`,checked:u===b,onChange:y=>d(b)}),s.jsxs(N,{children:[s.jsx(T,{children:g(`wiredfurni.params.texts.placeholder_type.${b}`)}),b===2&&s.jsxs(x,{gap:2,alignItems:"center",children:[s.jsx(T,{children:g("wiredfurni.params.texts.select_delimiter")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",disabled:u!==2,style:{maxWidth:"60px"},value:_,onChange:y=>m(y.target.value)})]})]})]},b))]})]})},vde=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(1),[n,o]=h.useState(""),{trigger:l,setStringParam:c,setIntParams:u}=le(),d=()=>{c(e+Yt+n),u([i])};return h.useEffect(()=>{const _=l.stringData.split(Yt);t(_[0]??""),o(_[1]??""),r(l.intData.length>0?l.intData[0]:1)},[l]),s.jsxs(Tr,{hasSpecialInput:!0,save:d,children:[s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.texts.capturer_name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:_=>t(_.target.value)}),s.jsx(T,{dangerouslySetInnerHTML:{__html:g("wiredfurni.params.texts.placeholder_preview",["placeholder"],["$("+e+")"])}})]}),s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.texts.placeholder_type")}),[1,2].map(_=>s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedEntranceType",id:`selectedOperation${_}`,checked:i===_,onChange:m=>r(_)}),s.jsxs(N,{children:[s.jsx(T,{children:g(`wiredfurni.params.texts.placeholder_type.user.${_}`)}),_===2&&s.jsxs(x,{gap:2,alignItems:"center",children:[s.jsx(T,{children:g("wiredfurni.params.texts.select_delimiter")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",style:{maxWidth:"60px"},value:n,onChange:m=>o(m.target.value)})]})]})]},_))]})]})},yde=a=>{switch(a){case mi.CONDITION_EVALUATION:return s.jsx(dde,{});case mi.PICK_ONE_RANDOMLY_PROPAGATION:return s.jsx(_de,{});case mi.PICK_IN_ORDER_PROPAGATION:return s.jsx(gde,{});case mi.EXECUTION_LIMIT:return s.jsx(Cy,{limit:100});case mi.REPEAT_STACK:return s.jsx(Cy,{limit:20});case mi.NO_MOVE_ANIMATION:return s.jsx(mde,{});case mi.MOVEMENT_FISICS:return s.jsx(fde,{});case mi.CARRY_USERS:return s.jsx(pde,{});case mi.ANIMATION_TIME:return s.jsx(ude,{});case mi.FURNI_SELECTOR_FILTER:return s.jsx(Ede,{});case mi.USER_SELECTOR_FILTER:return s.jsx(Ide,{});case mi.MEMORY_BOX:return s.jsx(Tde,{});case mi.SCRIPT_BOX:return s.jsx(Sde,{title:"wiredfurni.params.scriptname.code"});case mi.ORDER_EXECUTE:return s.jsx(Rde,{});case mi.FURNI_VAR_FILTER:return s.jsx(Ny,{variablesSource:0});case mi.USER_VAR_FILTER:return s.jsx(Ny,{variablesSource:1});case mi.TEXT_CONNECTOR:return s.jsx(Ode,{});case mi.CAPTURE_VAR:return s.jsx(Nde,{});case mi.VARIABLE_FIELD:return s.jsx(bde,{});case mi.USERNAME_FIELD:return s.jsx(vde,{})}return null},bt=a=>{const{requiresFurni:e=ge.STUFF_SELECTION_OPTION_NONE,save:t=null,hasSpecialInput:i=!1,mergedSelections:r=null,children:n=null,advancedAlwaysVisible:o=!1,furniSelectionTitleIndexed:l=null,userSelectionTitleIndexed:c=null,forceHidePickFurniInstructions:u=!1,mergedSources:d=!1,mergeSelectionTitle:_=null,applyConfigurationSaved:m=!1}=a,f=()=>t&&t();return s.jsx(e_,{wiredType:"condition",furniSelectionTitleIndexed:l,userSelectionTitleIndexed:c,forceHidePickFurniInstructions:u,mergedSources:d,mergeSelectionTitle:_,requiresFurni:e,hasSpecialInput:i,advancedAlwaysVisible:o,save:f,mergedSelections:r,applyConfigurationSaved:m,children:n})},Dde=a=>{const e=$e(),t=te().userId,i=e.userDataManager.getUserData(t),[r,n]=h.useState(""),{trigger:o=null,setStringParam:l=null}=le(),c=()=>l(r);function u(){const d=Co.getUserInfo(100,i);n(d.carryItem.toString())}return h.useEffect(()=>{n(o.stringData)},[o]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.handitem")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:d=>n(d.target.value)}),s.jsx(X,{variant:"secondary",onClick:()=>u(),children:g("wiredfurni.params.capture.handitem")})]})})},Mde=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),{trigger:n=null,setStringParam:o=null,setIntParams:l=null,groups:c}=le(),u=()=>{l([i,e])};return h.useEffect(()=>{K(new pm),r(n.intData.length>0?n.intData[0]:0),t(n.intData.length>1&&n.intData[0]>0?n.intData[1]:0)},[n]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.groupselection")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:i===0,onChange:d=>r(0)}),s.jsx(T,{children:g("wiredfurni.params.grouptype.0")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:i===1,onChange:d=>r(1)}),s.jsx(T,{children:g("wiredfurni.params.grouptype.1")})]}),i==1&&s.jsxs("select",{className:"form-select form-select-sm",value:e,onChange:d=>t(parseInt(d.target.value)),children:[s.jsx("option",{children:g("wiredfurni.tooltip.group")},"0"),!c||!c.length?null:c.map((d,_)=>s.jsx("option",{value:d.groupId,children:d.groupName},_))]})]})})},jde=a=>s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),Lde=[1,2,3,4],Pde=a=>{const[e,t]=h.useState(-1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.team")}),Lde.map(o=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${o}`,checked:e===o,onChange:l=>t(o)}),s.jsx(T,{children:g(`wiredfurni.params.team.${o}`)})]},o))]})})},Ude=a=>{const[e,t]=h.useState(""),{trigger:i=null,setStringParam:r=null}=le(),n=()=>r(e);return h.useEffect(()=>{t(i.stringData)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.badgecode")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:o=>t(o.target.value)})]})})},wde=a=>{const[e,t]=h.useState(""),{trigger:i=null,setStringParam:r=null}=le(),n=()=>r(e);return h.useEffect(()=>{t(i.stringData)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.tooltip.effectid")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:o=>t(o.target.value)})]})})},Fde=a=>s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),kde=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),[n,o]=h.useState(-1),{trigger:l=null,setIntParams:c=null}=le(),u=()=>c([e,i,n]);return h.useEffect(()=>{t(l.intData.length>0?l.intData[0]:0),r(l.intData.length>1?l.intData[1]:0),o(l.intData.length>2?l.intData[2]:0)},[l]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:u,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.comparison_selection")}),s.jsx(x,{className:"flex-wrap col-10",justifyContent:"between",gap:2,children:[0,1,2].map(d=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"comparison",id:`comparison${d}`,checked:e===d,onChange:_=>t(d)}),s.jsx(T,{children:g(`wiredfurni.params.comparison.${d}`)})]},d))})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.clock_minutes_elapsed",["minutes"],[i.toString()])}),s.jsx(zt,{min:0,max:99,value:i,setValue:r})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.clock_seconds_elapsed",["seconds"],[n.toString()])}),s.jsx(zt,{min:0,max:60,value:n,setValue:o})]})]})},kB=a=>{const{save:e=null,hasSpecialInput:t=!1,children:i=null}=a,{trigger:r=null,setStringParam:n=null,setIntParams:o=null}=le(),[l,c]=h.useState("BET"),u=h.useMemo(()=>[{key:"BET",timezone:"America/Sao_Paulo"},{key:"ECT",timezone:"Europe/Paris"},{key:"UTC",timezone:"UTC"}],[]),d=()=>{n(l),e&&e()};return h.useEffect(()=>{c(r.stringData)},[r]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:t,save:d,children:[i,s.jsx("hr",{className:"m-0 bg-dark"}),s.jsx(T,{bold:!0,children:g("wiredfurni.params.time.timezone_selection")}),s.jsx("select",{className:"form-select form-select-sm",value:l,onChange:_=>c(_.target.value),children:u.map(({key:_,timezone:m},f)=>s.jsx("option",{value:_,children:m},f))})]})},Gde=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(0),[n,o]=h.useState(1),[l,c]=h.useState(1),[u,d]=h.useState(-1),[_,m]=h.useState(0),[f,E]=h.useState(-1),[I,p]=h.useState(-1),{trigger:S=null,setIntParams:R=null}=le(),O=()=>R([i,_,e,n,l,u,f,I]);return h.useEffect(()=>{r(S.intData.length>0?S.intData[0]:0),m(S.intData.length>1?S.intData[1]:0),t(S.intData.length>2?S.intData[2]:0),o(S.intData.length>3?S.intData[3]===0?1:S.intData[3]:0),c(S.intData.length>4?S.intData[4]===0?1:S.intData[4]:0),d(S.intData.length>5?S.intData[5]:0),E(S.intData.length>6?S.intData[6]:0),p(S.intData.length>7?S.intData[7]:0),n!==l&&i>0&&r(2)},[S]),s.jsxs(kB,{hasSpecialInput:!0,save:O,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.time.weekday_selection")}),s.jsx(Ye,{gap:1,children:[1,2,3,4,5,6,7].map((C,A)=>s.jsx(N,{size:6,children:s.jsxs("div",{children:[s.jsx("input",{className:"form-check-input",style:{marginRight:"5px"},type:"checkbox",id:"redOption",checked:(e&1<<C)!==0,onChange:b=>t(y=>b.target.checked?y|1<<C:y^1<<C)}),s.jsx(T,{fontSize:6,children:g(`wiredfurni.params.time.weekday.${C}`)})]})},A))})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.time.day_selection")}),s.jsxs(x,{gap:1,column:!0,children:[s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"daySelectionNoFilter",checked:i===0,onChange:()=>r(0)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.nofilter")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"daySelectionExact",checked:i===1,onChange:()=>r(1)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.exact")}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:n,onChange:C=>{o(parseInt(C.target.value)),c(parseInt(C.target.value))}})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"daySelectionRange",checked:i===2,onChange:()=>r(2)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.range")}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:n,onChange:C=>o(parseInt(C.target.value))}),s.jsx(T,{fontSize:6,children:"-"}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:l,onChange:C=>c(parseInt(C.target.value))})]})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.time.month_selection")}),s.jsx(Ye,{gap:1,children:[1,2,3,4,5,6,7,8,9,10,11,12].map((C,A)=>s.jsx(N,{size:4,children:s.jsxs("div",{children:[s.jsx("input",{className:"form-check-input",style:{marginRight:"5px"},type:"checkbox",id:"redOption",checked:(u&1<<A)!==0,onChange:b=>d(y=>b.target.checked?y|1<<A:y^1<<A)}),s.jsx(T,{fontSize:6,children:g(`wiredfurni.params.time.month.${C}`)})]})},A))})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.time.year_selection")}),s.jsxs(x,{gap:1,column:!0,children:[s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"yearSelection",id:"yearSelectionNoFilter",checked:_===0,onChange:()=>m(0)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.nofilter")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"yearSelection",id:"yearSelectionExact",checked:_===1,onChange:()=>m(1)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.exact")}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:f,onChange:C=>{E(parseInt(C.target.value)),p(parseInt(C.target.value))}})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"yearSelection",id:"yearSelectionRange",checked:_===2,onChange:()=>m(2)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.range")}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:f,onChange:C=>E(parseInt(C.target.value))}),s.jsx(T,{fontSize:6,children:"-"}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:I,onChange:C=>p(parseInt(C.target.value))})]})]})]})]})},Bde=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(""),{trigger:n=null,setIntParams:o=null}=le(),l=()=>{let c=0,u=0;const d=new Date(e),_=new Date(i);d&&_&&(c=d.getTime()/1e3,u=_.getTime()/1e3),o([c,u])};return h.useEffect(()=>{if(n.intData.length>=2){let c=new Date,u=new Date;n.intData[0]>0&&(c=new Date(n.intData[0]*1e3)),n.intData[1]>0&&(u=new Date(n.intData[1]*1e3)),t(Gb(c)),r(Gb(u))}},[n]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.startdate")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:c=>t(c.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.enddate")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:c=>r(c.target.value)})]})]})},Vde=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),{trigger:n=null,setIntParams:o=null,setStringParam:l=null}=le(),c=()=>{o([i,e])};return h.useEffect(()=>{r(n.intData.length>0?n.intData[0]:0),t(n.intData.length>1?n.intData[1]:0)},[n]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.comparison_selection")}),s.jsx(x,{className:"flex-wrap col-10",justifyContent:"between",gap:2,column:!0,children:[0,1,2].map(u=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"comparison",id:`comparison${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g(`wiredfurni.params.comparison.${u}`)})]},u))})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsxs(T,{bold:!0,children:[g("wiredfurni.params.setaltitude"),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7 d-inline",step:".01",style:{maxWidth:"50px",marginLeft:"5px"},value:XN(i),onChange:u=>{r(parseFloat(u.target.value)*100)}})]}),s.jsx(zt,{min:0,max:4e3,step:1,value:i,setValue:r})]})]})},Hde=a=>{const[e,t]=h.useState(-1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.requireall")}),[0,1].map(o=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${o}`,checked:e===o,onChange:l=>t(o)}),s.jsx(T,{children:g("wiredfurni.params.requireall."+(o+2))})]},o))]})})},Wde=a=>{const[e,t]=h.useState(-1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.requireall")}),[0,1].map(o=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${o}`,checked:e===o,onChange:l=>t(o)}),s.jsx(T,{children:g("wiredfurni.params.requireall."+o)})]},o))]})})},Yde=a=>{const[e,t]=h.useState(-1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.requireall")}),[0,1].map(o=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${o}`,checked:e===o,onChange:l=>t(o)}),s.jsx(T,{children:g("wiredfurni.params.not_requireall."+(o+2))})]},o))]})})},zde=a=>{const[e,t]=h.useState(-1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.not_requireall")}),[0,1].map(o=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${o}`,checked:e===o,onChange:l=>t(o)}),s.jsx(T,{children:g(`wiredfurni.params.not_requireall.${o}`)})]},o))]})})},Ay=a=>s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null,furniSelectionTitleIndexed:"wiredfurni.params.sources.furni.title.furniisoftype.",advancedAlwaysVisible:!0,forceHidePickFurniInstructions:!0}),Kde=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),[n,o]=h.useState(0),{trigger:l=null,setIntParams:c=null}=le(),u=()=>c([e,i,n]);return h.useEffect(()=>{t(l.getBoolean(0)?1:0),r(l.getBoolean(1)?1:0),o(l.getBoolean(2)?1:0)},[l]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:u,applyConfigurationSaved:!0,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.conditions")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!e,onChange:d=>t(d.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.condition.state")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!i,onChange:d=>r(d.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.condition.direction")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!n,onChange:d=>o(d.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.condition.position")})]})]})})},qde=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),[n,o]=h.useState(-1),{trigger:l=null,setIntParams:c=null,selectedSource:u}=le(),d=()=>c([0,n,i,e]);return h.useEffect(()=>{o(l.intData.length>1?l.intData[1]:0),r(l.intData.length>2?l.intData[2]:0),t(l.intData.length>3?l.intData[3]:-1)},[l]),h.useEffect(()=>{t(u=="users"?0:u=="furni"?1:-1)},[u]),s.jsxs(bt,{mergedSources:!0,mergedSelections:[new $r([0,0],"wiredfurni.params.sources.merged.title")],hasSpecialInput:!0,save:d,advancedAlwaysVisible:!0,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.comparison_selection")}),s.jsx(x,{className:"flex-wrap col-10",justifyContent:"between",gap:2,column:!0,children:[0,1,2].map(_=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"comparison",id:`comparison${_}`,checked:i===_,onChange:m=>r(_)}),s.jsx(T,{children:g(`wiredfurni.params.comparison.${_}`)})]},_))})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.setamount",["amount"],[n.toString()])}),s.jsx(zt,{min:0,max:100,value:n,setValue:o})]})]})},Xde=[{value:1,text:"widget.memenu.wave"},{value:2,text:"widget.memenu.blow"},{value:3,text:"widget.memenu.laugh"},{value:4,text:"widget.memenu.sit"},{value:7,text:"widget.memenu.thumb"},{value:5,text:"widget.memenu.idle"},{value:6,text:"wiredfurni.params.action.4"},{value:8,text:"widget.memenu.stand"},{value:9,text:"wiredfurni.params.action.8"},{value:10,text:"widget.memenu.sign"},{value:11,text:"widget.memenu.dance"}],$de=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],Qde=[1,2,3,4],Jde=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),[n,o]=h.useState(""),{trigger:l=null,setIntParams:c=null,setStringParam:u}=le(),d=()=>{c([e]),u(e===10||e===11?n:"")};return h.useEffect(()=>{const _=l.intData.length>0?l.intData[0]:0;_===10&&l.stringData!==""||_===11&&l.stringData!==""?(r(1),o(l.stringData)):(r(0),o("")),t(_)},[l]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.action_selection")}),s.jsx("select",{className:"form-select form-select-sm",value:e,onChange:_=>t(parseInt(_.target.value)),children:Xde.map((_,m)=>s.jsx("option",{value:_.value,children:g(_.text)},m))})]}),(e===10||e===11)&&s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g(`${e===11?"wiredfurni.params.dance_txt":"wiredfurni.params.sign_txt"}`)}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"filter",checked:!!i,onChange:_=>r(_.target.checked?1:0)}),s.jsx(T,{children:g(`${e===11?"wiredfurni.params.dance_filter":"wiredfurni.params.sign_filter"}`)})]})]}),i&&e===10?s.jsx(N,{gap:1,children:s.jsx("select",{className:"form-select form-select-sm",value:n,onChange:_=>o(_.target.value),children:$de.map((_,m)=>s.jsx("option",{value:_,children:g(`wiredfurni.params.action.sign.${_}`)},m))})}):null,i&&e===11?s.jsx(N,{gap:1,children:s.jsx("select",{className:"form-select form-select-sm",value:n,onChange:_=>o(_.target.value),children:Qde.map((_,m)=>s.jsx("option",{value:"dance "+_,children:g(g(`wiredfurni.params.action.dance.${_}`))},m))})}):null]})]})},Zde=[1,2,3,4],e_e=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),[n,o]=h.useState(1),{trigger:l=null,setIntParams:c=null}=le(),u=()=>c([e,i,n]);return h.useEffect(()=>{t(l.intData.length>0?l.intData[0]:0),r(l.intData.length>1?l.intData[1]:0),o(l.intData.length>2?l.intData[2]:1)},[l]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.team")}),s.jsxs(x,{className:"flex-wrap col-10",justifyContent:"between",gap:2,children:[s.jsxs(x,{gap:1,alignItems:"center",className:"col-10",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"selectedTeam0",checked:e===0,onChange:d=>t(0)}),s.jsx(T,{children:g("wiredfurni.params.team.triggerer")})]},0),Zde.map(d=>s.jsxs(x,{gap:1,alignItems:"center",className:"col-5",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${d}`,checked:e===d,onChange:_=>t(d)}),s.jsx(T,{children:g(`wiredfurni.params.team.${d}`)})]},d))]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.comparison_selection")}),s.jsx(x,{className:"flex-wrap col-10",justifyContent:"between",gap:2,children:[0,1,2].map(d=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"comparison",id:`comparison${d}`,checked:i===d,onChange:_=>r(d)}),s.jsx(T,{children:g(`wiredfurni.params.comparison.${d}`)})]},d))})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.setpoints",["points"],[n.toString()])}),s.jsx(zt,{min:0,max:100,value:n,setValue:o})]})]})},by=[1,2,3,4],t_e=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(1),{trigger:n=null,setIntParams:o=null}=le(),l=()=>{o([e,i])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.intData.length>1?n.intData[1]===0?1:n.intData[1]:1)},[n]),s.jsxs(bt,{hasSpecialInput:!0,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.team")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"selectedTeamAtivador",checked:e===0,onChange:c=>t(0)}),s.jsx(T,{children:g("wiredfurni.params.team.triggerer")})]}),s.jsx(Ye,{children:by.map(c=>s.jsx(N,{size:6,children:s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${c}`,checked:e===c,onChange:u=>t(c)}),s.jsx(T,{children:g(`wiredfurni.params.team.${c}`)})]})},c))})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.placement_selection")}),s.jsx(x,{gap:4,children:by.map(c=>s.jsxs(x,{alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedSelector",id:`selectedSelector${c}`,checked:i===c,onChange:u=>r(c)}),s.jsx(T,{children:g(`wiredfurni.params.placement.${c}`)})]},c))})]})]})},s_e=a=>{const[e,t]=h.useState(-1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.allowbefore",["seconds"],[oh(e)])}),s.jsx(zt,{min:1,max:1200,value:e,setValue:t})]})})},i_e=a=>{const[e,t]=h.useState(-1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.allowafter",["seconds"],[oh(e)])}),s.jsx(zt,{min:1,max:1200,value:e,setValue:t})]})})},r_e=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),[n,o]=h.useState(0),[l,c]=h.useState(0),[u,d]=h.useState(0),[_,m]=h.useState(0),[f,E]=h.useState(0),[I,p]=h.useState(0),[S,R]=h.useState(0),{trigger:O=null,setIntParams:C=null}=le(),A=()=>C([e,i,n,l,u,_,f,I,S]);return h.useEffect(()=>{t(O.intData.length>0?O.intData[0]:0),r(O.intData.length>1?O.intData[1]:0),o(O.intData.length>2?O.intData[2]:0),c(O.intData.length>3?O.intData[3]:0),d(O.intData.length>4?O.intData[4]:0),m(O.intData.length>5?O.intData[5]:0),E(O.intData.length>6?O.intData[6]:0),p(O.intData.length>7?O.intData[7]:0),R(O.intData.length>8?O.intData[8]:0)},[O]),s.jsxs(kB,{hasSpecialInput:!0,save:A,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.time.hour_selection")}),s.jsxs(x,{gap:1,column:!0,children:[s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"daySelectionNoFilter",checked:e===0,onChange:()=>t(0)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.nofilter")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"daySelectionExact",checked:e===1,onChange:()=>t(1)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.exact")}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:l,onChange:b=>{c(parseInt(b.target.value)),d(parseInt(b.target.value))}})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"daySelectionRange",checked:e===2,onChange:()=>t(2)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.range")}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:l,onChange:b=>c(parseInt(b.target.value))}),s.jsx(T,{fontSize:6,children:"-"}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:u,onChange:b=>d(parseInt(b.target.value))})]})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.time.minute_selection")}),s.jsxs(x,{gap:1,column:!0,children:[s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"minutesSelection",id:"minutesSelectionNoFilter",checked:i===0,onChange:()=>r(0)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.nofilter")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"minutesSelection",id:"minutesSelectionExact",checked:i===1,onChange:()=>r(1)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.exact")}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:_,onChange:b=>{m(parseInt(b.target.value)),E(parseInt(b.target.value))}})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"minutesSelection",id:"minutesSelectionRange",checked:i===2,onChange:()=>r(2)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.range")}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:_,onChange:b=>m(parseInt(b.target.value))}),s.jsx(T,{fontSize:6,children:"-"}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:f,onChange:b=>E(parseInt(b.target.value))})]})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.time.second_selection")}),s.jsxs(x,{gap:1,column:!0,children:[s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"secondsSelection",id:"secondsSelectionNoFilter",checked:n===0,onChange:()=>o(0)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.nofilter")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"secondsSelection",id:"secondsSelectionExact",checked:n===1,onChange:()=>o(1)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.exact")}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:I,onChange:b=>{p(parseInt(b.target.value)),R(parseInt(b.target.value))}})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"secondsSelection",id:"secondsSelectionRange",checked:n===2,onChange:()=>o(2)}),s.jsx(T,{fontSize:6,children:g("wiredfurni.params.time.range")}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:I,onChange:b=>p(parseInt(b.target.value))}),s.jsx(T,{fontSize:6,children:"-"}),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7",style:{maxWidth:"50px"},value:S,onChange:b=>R(parseInt(b.target.value))})]})]})]})]})},n_e=[1,2,4],a_e=a=>{const[e,t]=h.useState(1),[i,r]=h.useState(""),[n,o]=h.useState(0),{trigger:l=null,setIntParams:c=null,setStringParam:u}=le(),d=()=>{c([e]),u(n===0?"":i)};return h.useEffect(()=>{t(l.intData.length>0?l.intData[0]:0),r(l.stringData),l.stringData&&o(1)},[l]),s.jsxs(bt,{hasSpecialInput:!0,save:d,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.usertype")}),s.jsx(x,{column:!0,children:n_e.map(_=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${_}`,checked:e===_,onChange:m=>t(_)}),s.jsx(T,{children:g(`wiredfurni.params.usertype.${_}`)})]},_))})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.picktriggerer")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode0",checked:n===0,onChange:_=>o(0)}),s.jsx(T,{children:g("wiredfurni.params.anyavatar")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode1",checked:n===1,onChange:_=>o(1)}),s.jsx(T,{children:g("wiredfurni.params.certainavatar")})]}),n===1&&s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:_=>r(_.target.value)})]})]})},o_e=a=>{const[e,t]=h.useState(1),[i,r]=h.useState(1),{trigger:n=null,setIntParams:o=null}=le(),l=()=>o([e,i]);return h.useEffect(()=>{n.intData.length>=2?(t(n.intData[0]),r(n.intData[1])):(t(1),r(1))},[n]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.usercountmin",["value"],[e.toString()])}),s.jsx(zt,{min:1,max:50,value:e,setValue:t})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.usercountmax",["value"],[i.toString()])}),s.jsx(zt,{min:1,max:50,value:i,setValue:r})]})]})},l_e=[{value:0,icon:"ne"},{value:1,icon:"east"},{value:2,icon:"se"},{value:3,icon:"south"},{value:4,icon:"sw"},{value:5,icon:"west"},{value:6,icon:"nw"},{value:7,icon:"north"}],c_e=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),{trigger:n=null,setIntParams:o=null}=le(),l=()=>o([e,i]);return h.useEffect(()=>{n.intData.length>=2?(t(n.intData[0]),r(n.intData[1])):(t(-256),r(-1))},[n]),s.jsx(bt,{hasSpecialInput:!0,save:l,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.startdir")}),s.jsx(x,{gap:2,className:"flex-wrap col-7",children:l_e.map((c,u)=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",name:"movement",id:`movement${c.value}`,checked:(e&1<<u)!==0,onChange:d=>t(_=>d.target.checked?_|1<<u:_^1<<u)}),s.jsx(T,{children:s.jsx("i",{className:`icon icon-${c.icon}`})})]},c.value))})]})})},u_e=a=>{const[e,t]=h.useState(""),{trigger:i=null,setStringParam:r=null}=le(),n=()=>r(e);return h.useEffect(()=>{t(i.stringData)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memory.box.formula")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:80,value:e,onChange:o=>t(o.target.value)})]})})},h_e=a=>s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:null}),d_e=a=>{const[e,t]=h.useState(-1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t((i==null?void 0:i.intData[0])??0)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.tooltip.duckets")}),s.jsx("input",{type:"number",className:"form-control form-control-sm",value:e,onChange:o=>t(parseInt(o.target.value))})]})})},__e=a=>{const[e,t]=h.useState(-1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t((i==null?void 0:i.intData[0])??0)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.tooltip.diamonds")}),s.jsx("input",{type:"number",className:"form-control form-control-sm",value:e,onChange:o=>t(parseInt(o.target.value))})]})})},g_e=a=>{$e();const[e,t]=h.useState(0),[i,r]=h.useState(""),{trigger:n,setIntParams:o,setStringParam:l}=le(),c=()=>{l(i),o([e])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.stringData)},[n]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:u=>r(u.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.operation")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2,3,4,5].map(u=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedOperation${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g(`wiredfurni.params.memorybox.eval_mode.cmp.${u}`)})]},u))})]})]})},m_e=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(""),{trigger:n,setIntParams:o,setStringParam:l}=le(),c=()=>{l(i),o([e])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.stringData)},[n]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:u=>r(u.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.operation")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2,3,4,5].map(u=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedOperation${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g(`wiredfurni.params.memorybox.eval_mode.cmp.${u}`)})]},u))})]})]})},f_e=a=>{$e();const[e,t]=h.useState(0),[i,r]=h.useState(""),{trigger:n,setIntParams:o,setStringParam:l}=le(),c=()=>{l(i),o([e])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.stringData)},[n]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:u=>r(u.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.operation")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2,3].map(u=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedOperation${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g(`wiredfurni.params.memorybox_string.eval_mode.cmp.${u}`)})]},u))})]})]})},p_e=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(""),{trigger:n,setIntParams:o,setStringParam:l}=le(),c=()=>{l(i),o([e])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.stringData)},[n]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:u=>r(u.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.operation")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2,3].map(u=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedOperation${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g(`wiredfurni.params.memorybox_string.eval_mode.cmp.${u}`)})]},u))})]})]})},E_e=a=>{$e();const[e,t]=h.useState(0),[i,r]=h.useState(-1),[n,o]=h.useState(""),{trigger:l,setIntParams:c,setStringParam:u}=le(),d=()=>{u(n),c([e,i])};return h.useEffect(()=>{t(l.intData.length>0?l.intData[0]:0),r(l.intData.length>1?l.intData[1]:0),o(l.stringData)},[l]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:d,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"number",className:"form-control form-control-sm",value:n,onChange:_=>o(_.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.operation")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2,3,4,5].map(_=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedOperation${_}`,checked:e===_,onChange:m=>t(_)}),s.jsx(T,{children:g(`wiredfurni.params.memorybox.eval_mode.cmp.${_}`)})]},_))})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.requireall")}),[0,1].map(_=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${_}`,checked:i===_,onChange:m=>r(_)}),s.jsx(T,{children:g("wiredfurni.params.requireall."+(_+2))})]},_))]})]})},I_e=a=>{$e();const[e,t]=h.useState(-1),[i,r]=h.useState(-1),[n,o]=h.useState(""),{trigger:l,setIntParams:c,setStringParam:u}=le(),d=()=>{u(n),c([e,i])};return h.useEffect(()=>{t(l.intData.length>0?l.intData[0]:0),r(l.intData.length>1?l.intData[1]:1),o(l.stringData)},[l]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:n,onChange:_=>o(_.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.chattriggertype")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:e===0,onChange:_=>t(0)}),s.jsx(T,{children:g("wiredfurni.params.chatcontains")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:e===1,onChange:_=>t(1)}),s.jsx(T,{children:g("wiredfurni.params.exactmatch")})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"ignoreCase",checked:!!i,onChange:_=>r(_.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.ignorecase")})]})]})]})},T_e=a=>{$e();const[e,t]=h.useState(""),{trigger:i,setIntParams:r,setStringParam:n}=le(),o=()=>{n(e)};return h.useEffect(()=>{t(i.stringData)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:o,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:l=>t(l.target.value)})]})})},S_e=a=>{$e();const[e,t]=h.useState(0),[i,r]=h.useState(-1),{trigger:n,setIntParams:o,setStringParam:l}=le(),c=()=>{o([e,i])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.intData.length>1?n.intData[1]:0)},[n]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.axis.title")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2].map(u=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedOperation${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g(`wiredfurni.params.axis.${u}`)})]},u))})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.requireall")}),[0,1].map(u=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${u}`,checked:i===u,onChange:d=>r(u)}),s.jsx(T,{children:g("wiredfurni.params.requireall."+(u+2))})]},u))]})]})},R_e=a=>{const[e,t]=h.useState(""),{trigger:i,setIntParams:r,setStringParam:n}=le(),o=()=>n(e.replace(/\n\r/g,"	").replace(/\r/g,"	").replace(/\n/g,"	"));return h.useEffect(()=>{t(i.stringData.replace(/\t/g,"\r"))},[i]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:o,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.enter_names")}),s.jsx(x,{className:"flex-wrap",justifyContent:"between",gap:2,column:!0,children:s.jsx("textarea",{className:"form-control form-control-sm",value:e,rows:7,onChange:l=>t(l.target.value)})})]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},x_e=a=>{$e();const[e,t]=h.useState(0),[i,r]=h.useState(""),{trigger:n,setIntParams:o,setStringParam:l}=le(),c=()=>{l(i),o([e])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.stringData)},[n]),s.jsxs(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,forceHidePickFurniInstructions:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.value")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i,onChange:u=>r(u.target.value)})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.memorybox.operation")}),s.jsx(x,{column:!0,gap:1,children:[0,1,2,3,4,5].map(u=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedOperation${u}`,checked:e===u,onChange:d=>t(u)}),s.jsx(T,{children:g(`wiredfurni.params.memorybox.eval_mode.cmp.${u}`)})]},u))})]})]})},O_e=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(""),{trigger:n=null,setStringParam:o=null}=le(),l=()=>{o(e+Yt+i)};return h.useEffect(()=>{const c=n.stringData.split(Yt);t(c[0]||"#ffffff"),r(c[1]||"#ffffff")},[n]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.firstcolor")}),s.jsx(x,{alignItems:"center",children:s.jsx("input",{className:"form-control form-control-sm",type:"color",value:e,onChange:c=>t(c.target.value)})}),s.jsx(T,{bold:!0,children:g("wiredfurni.params.secondcolor")}),s.jsx(x,{alignItems:"center",children:s.jsx("input",{className:"form-control form-control-sm",type:"color",value:i,onChange:c=>r(c.target.value)})})]})})},C_e=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(-1),{trigger:n,setIntParams:o,setVariableIds:l}=le(),c=()=>{o([e]),l([i])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.variableIds.length>0?n.variableIds[0]:-1)},[n]),s.jsx(bt,{save:c,hasSpecialInput:!1,mergedSources:!0,advancedAlwaysVisible:!0,mergedSelections:[new $r([0,0],"wiredfurni.params.sources.merged.title.variables",e,t)],children:s.jsx(Er,{wiredVariableTypes:[0,1,-20],type:e,setType:t,selectedVar:i,setSelectedVar:r})})},N_e=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),[n,o]=h.useState(-1),[l,c]=h.useState(-1),[u,d]=h.useState(0),[_,m]=h.useState(0),[f,E]=h.useState(0),{trigger:I,setIntParams:p,setVariableIds:S}=le(),R=()=>{p([e,u,_,f,i]),S([n,l])};h.useEffect(()=>{t(I.intData.length>0?I.intData[0]:0),d(I.intData.length>1?I.intData[1]:0),m(I.intData.length>2?I.intData[2]:0),E(I.intData.length>3?I.intData[3]:0),r(I.intData.length>4?I.intData[4]:0),o(I.variableIds.length>0?I.variableIds[0]:-1),c(I.variableIds.length>1?I.variableIds[1]:-1)},[I]);const O=h.useMemo(()=>_!==1,[_]);return s.jsxs(bt,{save:R,hasSpecialInput:!1,mergedSources:!0,advancedAlwaysVisible:!0,mergedSelections:[new $r([0,0],"wiredfurni.params.sources.merged.title.variables",e,t),new $r([1,1],"wiredfurni.params.sources.merged.title.variables_reference",i,r,O)],children:[s.jsx(Er,{wiredVariableTypes:[0,1,-10,-20],type:e,setType:t,selectedVar:n,isReference:!0,setSelectedVar:o}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.comparison_selection")}),s.jsxs(x,{gap:3,children:[s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedOperation",id:"selectedOperation0",checked:u===0,onChange:C=>d(0)}),s.jsx(T,{children:">"})]},0),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedOperation",id:"selectedTeam1",checked:u===1,onChange:C=>d(1)}),s.jsx(T,{children:"≥"})]},1),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedOperation",id:"selectedTeam2",checked:u===2,onChange:C=>d(2)}),s.jsx(T,{children:"="})]},2),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedOperation",id:"selectedTeam3",checked:u===3,onChange:C=>d(3)}),s.jsx(T,{children:"<"})]},3),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedOperation",id:"selectedTeam4",checked:u===4,onChange:C=>d(4)}),s.jsx(T,{children:"≤"})]},4),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedOperation",id:"selectedTeam4",checked:u===5,onChange:C=>d(5)}),s.jsx(T,{children:"≠"})]},5)]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.reference_value")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedReferenceValue",id:"selectedReferenceValue0",checked:_===0,onChange:C=>m(0)}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{children:g("wiredfurni.params.variables.reference_value.set_value")}),s.jsx("input",{className:"form-control form-control-sm fs-7",style:{maxWidth:"60px"},type:"number",value:f,onChange:C=>E(parseInt(C.target.value))})]})]},0),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedReferenceValue",id:"selectedReferenceValue1",checked:_===1,onChange:C=>m(1)}),s.jsx("div",{className:"flex-grow-1",children:s.jsx(Er,{wiredVariableTypes:[0,1,-10,-20],type:i,setType:r,selectedVar:l,setSelectedVar:c,isDisabled:_!==1,isReference:!0,bold:!1,title:"wiredfurni.params.variables.reference_value.from_variable"})})]},1)]})]})},A_e=()=>{const[a,e]=h.useState(0),[t,i]=h.useState(-1),[r,n]=h.useState(0),[o,l]=h.useState(0),[c,u]=h.useState(0),[d,_]=h.useState(0),{trigger:m,setIntParams:f,setVariableIds:E}=le(),I=()=>{f([a,r,o,c,d]),E([t])};return h.useEffect(()=>{e(m.intData.length>0?m.intData[0]:0),n(m.intData.length>1?m.intData[1]:0),l(m.intData.length>2?m.intData[2]:0),u(m.intData.length>3?m.intData[3]:0),_(m.intData.length>4?m.intData[4]:0),i(m.variableIds.length>0?m.variableIds[0]:-1)},[m]),s.jsxs(bt,{save:I,hasSpecialInput:!1,mergedSources:!0,advancedAlwaysVisible:!0,mergedSelections:[new $r([0,0],"wiredfurni.params.sources.merged.title.variables",a,e)],children:[s.jsx(Er,{wiredVariableTypes:[0,1,-10,-20],type:a,setType:e,selectedVar:t,disableInternal:!0,setSelectedVar:i}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.compare_value")}),[0,1].map(p=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedComparisonValue",id:`selectedComparisonValue${p}`,checked:r===p,onChange:S=>n(p)}),s.jsx(T,{children:g(`wiredfurni.params.variables.compare_value.${p}`)})]},p))]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.comparison_selection")}),[0,2].map(p=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectedComparisonType",id:`selectedComparisonType${p}`,checked:o===p,onChange:()=>l(p)}),s.jsx(T,{children:g(`wiredfurni.params.comparison.${p}`)})]},p))]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.time_selection")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{children:g("wiredfurni.params.variables.duration")}),s.jsx("input",{className:"form-control form-control-sm fs-7",style:{maxWidth:"60px"},type:"number",value:c,onChange:p=>u(parseInt(p.target.value))}),s.jsx("select",{className:"form-select form-select-sm",value:d,onChange:p=>_(parseInt(p.target.value)),children:[0,1,2,3,4,5,6,7].map((p,S)=>s.jsx("option",{value:p,children:g(g(`wiredfurni.params.variables.duration.${p}`))},S))})]})]})]})},b_e=a=>{const[e,t]=h.useState(0),{trigger:i=null,setIntParams:r=null}=le(),n=()=>{r([e])};return h.useEffect(()=>{i&&t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(bt,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.keybind.key.is_pressing")}),s.jsx("select",{className:"form-select form-select-sm",value:e,onChange:o=>t(parseInt(o.target.value)),children:[0,1,2,3,4,5,6,7].map((o,l)=>s.jsx("option",{value:o,children:g("wiredfurni.params.keybind."+o)},"keybind."+l))})]})})},v_e=a=>{switch(a){case et.STATES_MATCH:case et.NOT_STATES_MATCH:return s.jsx(Kde,{});case et.FURNIS_HAVE_AVATARS:return s.jsx(Hde,{});case et.ACTOR_IS_ON_FURNI:case et.NOT_ACTOR_ON_FURNI:return s.jsx(jde,{});case et.TIME_ELAPSED_MORE:return s.jsx(i_e,{});case et.TIME_ELAPSED_LESS:return s.jsx(s_e,{});case et.USER_COUNT_IN:case et.NOT_USER_COUNT_IN:return s.jsx(o_e,{});case et.ACTOR_IS_IN_TEAM:case et.NOT_ACTOR_IN_TEAM:return s.jsx(Pde,{});case et.HAS_STACKED_FURNIS:return s.jsx(Wde,{});case et.STUFF_TYPE_MATCHES:case et.NOT_FURNI_IS_OF_TYPE:return s.jsx(Ay,{});case et.STUFFS_IN_FORMATION:case et.NOT_STUFFS_IN_FORMATION:return s.jsx(Ay,{});case et.ACTOR_IS_GROUP_MEMBER:case et.NOT_ACTOR_IN_GROUP:return s.jsx(Mde,{});case et.ACTOR_IS_WEARING_BADGE:case et.NOT_ACTOR_WEARS_BADGE:return s.jsx(Ude,{});case et.ACTOR_IS_WEARING_EFFECT:case et.NOT_ACTOR_WEARING_EFFECT:return s.jsx(wde,{});case et.FURNI_NOT_HAVE_HABBO:return s.jsx(Yde,{});case et.NOT_HAS_STACKED_FURNIS:return s.jsx(zde,{});case et.DATE_RANGE_ACTIVE:return s.jsx(Bde,{});case et.ACTOR_HAS_HANDITEM:case et.NOT_HAS_HANDITEM:return s.jsx(Dde,{});case et.TRIGGERER_MATCHES:case et.NOT_TRIGGERER_MATCHES:return s.jsx(a_e,{});case et.TIME_MATCHES:return s.jsx(r_e,{});case et.DATE_MATCHES:return s.jsx(Gde,{});case et.TEAM_IS_WINNING:return s.jsx(t_e,{});case et.PERFORMING_ACTION:case et.NOT_PERFORMING_ACTION:return s.jsx(Jde,{});case et.CLOCK_TIME_MATCHES:return s.jsx(kde,{});case et.FURNI_HAS_ALTITUDE:return s.jsx(Vde,{});case et.USER_DIRECTION:return s.jsx(c_e,{});case et.INPUT_SOURCE_QUANTITY:return s.jsx(qde,{});case et.CAN_PERFORM_MOVE:return s.jsx(Fde,{});case et.TEAM_HAS_SCORE:return s.jsx(e_e,{});case et.MEMORY_BOX_UNIVERSAL:return s.jsx(u_e,{});case et.HABBO_HAS_RIGHTS:return s.jsx(h_e,{});case et.HABBO_HAS_DIAMONDS:return s.jsx(__e,{});case et.HABBO_HAS_DUCKETS:return s.jsx(d_e,{});case et.MEMORY_BOX:return s.jsx(g_e,{});case et.MEMORY_USER:return s.jsx(m_e,{});case et.MEMORY_BOX_STRING:return s.jsx(f_e,{});case et.MEMORY_USER_STRING:return s.jsx(p_e,{});case et.FURNI_CLOSE:return s.jsx(E_e,{});case et.HAS_MOTTO:return s.jsx(I_e,{});case et.HAS_POINTS_SCOREBOARD:return s.jsx(x_e,{});case et.HAS_TAG:return s.jsx(T_e,{});case et.NAMES_MATCHES:return s.jsx(R_e,{});case et.FURNI_SAME_DIRECTION:return s.jsx(S_e,{});case et.FURNI_COLORS_MATCHES:return s.jsx(O_e,{});case et.HAS_VARIABLE:return s.jsx(C_e,{});case et.VARIABLE_VALUE:return s.jsx(N_e,{});case et.VARIABLE_AGE:return s.jsx(A_e,{});case et.IS_PRESSING_KEY:return s.jsx(b_e,{})}return null},Li=a=>{const{requiresFurni:e=ge.STUFF_SELECTION_OPTION_NONE,save:t=null,hasSpecialInput:i=!1,children:r=null,advancedAlwaysVisible:n=!1,forceHidePickFurniInstructions:o=!1,mergedSources:l=!1,mergedSelections:c=null}=a,{trigger:u,filter:d,setFilter:_,inverse:m,setInverse:f}=le();h.useEffect(()=>{_(u.isFilter?1:0),f(u.isInvert?1:0)},[u]);const E=()=>t&&t();return s.jsxs(e_,{wiredType:"condition",requiresFurni:e,hasSpecialInput:i,advancedAlwaysVisible:n,forceHidePickFurniInstructions:o,mergedSources:l,mergedSelections:c,save:E,children:[r,s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.selector_options_selector")}),s.jsxs(x,{className:"flex-wrap col-10",column:!0,gap:2,children:[s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"redOption",checked:d===1,onChange:I=>_(I.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.selector_option.0")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"greenOption",checked:m===1,onChange:I=>f(I.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.selector_option.1")})]})]})]})]})},y_e=a=>{const[e,t]=h.useState(!1),{trigger:i,setIntParams:r}=le(),n=()=>{r([e?1:0])};return h.useEffect(()=>{t(i.intData.length>0?i.getBoolean(0):!1)},[i]),s.jsxs(Li,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:n,children:[s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"redOption",checked:e,onChange:o=>t(o.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.state_match")})]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},D_e=a=>s.jsx(Li,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),M_e=a=>{const{trigger:e,setIntParams:t}=le(),[i,r]=h.useState(0),n=()=>{t([i])};return h.useEffect(()=>{r(e.intData.length>0?e.intData[0]:0)},[e]),s.jsxs(Li,{hasSpecialInput:!0,save:n,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.selection_type")}),[0,1,2,3].map(o=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode1",checked:i===o,onChange:l=>r(o)}),s.jsx(T,{children:g(`wiredfurni.params.onfurni.${o}`)})]},o))]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},j_e=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),{trigger:n=null,setIntParams:o=null}=le(),l=()=>{o([i,e])};return h.useEffect(()=>{r(n.intData.length>0?n.intData[0]:0),t(n.intData.length>1?n.intData[1]:0)},[n]),s.jsxs(Li,{hasSpecialInput:!0,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.comparison_selection")}),s.jsx(x,{className:"flex-wrap col-10",justifyContent:"between",gap:2,column:!0,children:[0,1,2].map(c=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"comparison",id:`comparison${c}`,checked:e===c,onChange:u=>t(c)}),s.jsx(T,{children:g(`wiredfurni.params.comparison.${c}`)})]},c))})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsxs(T,{bold:!0,children:[g("wiredfurni.params.setaltitude"),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7 d-inline",step:".01",style:{maxWidth:"50px",marginLeft:"5px"},value:XN(i),onChange:c=>{r(parseFloat(c.target.value)*100)}})]}),s.jsx(zt,{min:0,max:4e3,value:i,setValue:r})]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},L_e=a=>{const[e,t]=h.useState(""),{trigger:i=null,setStringParam:r=null}=le(),n=()=>r(e.replace(/\n\r/g,"	").replace(/\r/g,"	").replace(/\n/g,"	"));return h.useEffect(()=>{t(i.stringData.replace(/\t/g,"\r"))},[i]),s.jsxs(Li,{hasSpecialInput:!0,save:n,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.enter_names")}),s.jsx(x,{className:"flex-wrap",justifyContent:"between",gap:2,column:!0,children:s.jsx("textarea",{className:"form-control form-control-sm",value:e,rows:7,onChange:o=>t(o.target.value)})})]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},P_e=a=>{const[e,t]=h.useState(0),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:1)},[i]),s.jsxs(Li,{hasSpecialInput:!0,save:n,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.usertype")}),[1,2,4].map(o=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"selectType",id:`selectType${o}`,checked:e===o,onChange:l=>t(o)}),s.jsx(T,{children:g(`wiredfurni.params.usertype.${o}`)})]},o))]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},U_e=a=>s.jsx(Li,{hasSpecialInput:!1,save:null}),w_e=a=>s.jsx(Li,{hasSpecialInput:!1,save:null}),F_e=a=>{const{trigger:e,groups:t,setStringParam:i}=le(),[r,n]=h.useState(-1),[o,l]=h.useState(0),c=()=>{i(u?u.groupId.toString():"")};h.useEffect(()=>{K(new pm)},[]),h.useEffect(()=>{if(e.stringData){const _=d(e.stringData);_===-1?(l(0),n(-1)):(l(1),n(_))}else l(0),n(-1)},[e]);const u=t[r],d=_=>{for(let m=0;m<t.length;m++)if(t[m].groupId.toString()===_)return m;return-1};return s.jsxs(Li,{hasSpecialInput:!0,save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.groupselection")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:o===0,onChange:_=>l(0)}),s.jsx(T,{children:g("wiredfurni.params.grouptype.0")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:o===1,onChange:_=>l(1)}),s.jsx(T,{children:g("wiredfurni.params.grouptype.1")})]}),o===1&&s.jsxs("select",{className:"form-select form-select-sm",value:r,onChange:_=>n(parseInt(_.target.value)),children:[s.jsx("option",{value:-1},-1),t.map((_,m)=>s.jsx("option",{value:m,children:_.groupName},m))]})]}),s.jsx("hr",{className:"bg-dark m-0"})]})},k_e=a=>{const{trigger:e,setIntParams:t}=le(),[i,r]=h.useState(-1),n=()=>{t([i])};return h.useEffect(()=>{r(e.intData.length>0?e.intData[0]:0)},[e]),s.jsxs(Li,{hasSpecialInput:!0,save:n,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.team")}),s.jsxs(x,{gap:2,className:"flex-wrap col-10",justifyContent:"between",children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType0",id:"triggererType0",checked:i===0,onChange:o=>r(0)}),s.jsx(T,{children:g("wiredfurni.params.team.any")})]}),[1,2,3,4].map(o=>s.jsxs(x,{alignItems:"center",gap:1,className:"col-5",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType"+o,id:"triggererType",checked:i===o,onChange:l=>r(o)}),s.jsx(T,{children:g("wiredfurni.params.team."+o)})]},o))]})]}),s.jsx("hr",{className:"bg-dark m-0"})]})},G_e=a=>s.jsx(Li,{hasSpecialInput:!1,save:null}),B_e=[{value:1,text:"widget.memenu.wave"},{value:2,text:"widget.memenu.blow"},{value:3,text:"widget.memenu.laugh"},{value:4,text:"widget.memenu.sit"},{value:7,text:"widget.memenu.thumb"},{value:5,text:"widget.memenu.idle"},{value:6,text:"wiredfurni.params.action.4"},{value:8,text:"widget.memenu.stand"},{value:9,text:"wiredfurni.params.action.8"},{value:10,text:"widget.memenu.sign"},{value:11,text:"widget.memenu.dance"}],V_e=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],H_e=[1,2,3,4],W_e=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),[n,o]=h.useState(""),{trigger:l=null,setIntParams:c=null,setStringParam:u}=le(),d=()=>{c([e,i]),u(e===10||e===11?n:"")};return h.useEffect(()=>{const _=l.intData.length>0?l.intData[0]:0,m=l.intData.length>1?l.intData[1]:0;_===10||_===11?(r(m),o(l.stringData!==""?l.stringData:"")):(r(0),o("")),t(_)},[l]),s.jsxs(Li,{hasSpecialInput:!0,save:d,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.action_selection")}),s.jsx("select",{className:"form-select form-select-sm",value:e,onChange:_=>t(parseInt(_.target.value)),children:B_e.map((_,m)=>s.jsx("option",{value:_.value,children:g(_.text)},m))})]}),(e===10||e===11)&&s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g(`${e===11?"wiredfurni.params.dance_txt":"wiredfurni.params.sign_txt"}`)}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"filter",checked:!!i,onChange:_=>r(_.target.checked?1:0)}),s.jsx(T,{children:g(`${e===11?"wiredfurni.params.dance_filter":"wiredfurni.params.sign_filter"}`)})]})]}),i&&e===10?s.jsx(N,{gap:1,children:s.jsx("select",{className:"form-select form-select-sm",value:n,onChange:_=>o(_.target.value),children:V_e.map((_,m)=>s.jsx("option",{value:_,children:g(`wiredfurni.params.action.sign.${_}`)},m))})}):null,i&&e===11?s.jsx(N,{gap:1,children:s.jsx("select",{className:"form-select form-select-sm",value:n,onChange:_=>o(_.target.value),children:H_e.map((_,m)=>s.jsx("option",{value:"dance "+_,children:g(g(`wiredfurni.params.action.dance.${_}`))},m))})}):null]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},vy=[0,2,5,8,9,10,27],Y_e=a=>{const e=$e(),t=te().userId,i=e.userDataManager.getUserData(t),[r,n]=h.useState(-1),[o,l]=h.useState(0),{trigger:c=null,setIntParams:u=null}=le(),d=()=>u([r]);function _(){const m=Co.getUserInfo(100,i);l(m.carryItem),n(m.carryItem)}return h.useEffect(()=>{c.intData.length>0&&c.intData[0]&&!vy.includes(c.intData[0])&&c.intData[0]>0&&l(c.intData[0]),n(c.intData.length>0?c.intData[0]:0)},[c]),s.jsxs(Li,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.handitem")}),s.jsxs("select",{className:"form-select form-select-sm",value:r,onChange:m=>n(parseInt(m.target.value)),children:[o>0&&s.jsx("option",{value:o,children:g(`handitem${o}`)},o),vy.filter(m=>m!==-1).map(m=>s.jsx("option",{value:m,children:m===0?"Nenhum":g(`handitem${m}`)},m))]}),s.jsx(X,{variant:"secondary",onClick:()=>_(),children:g("wiredfurni.params.capture.handitem")})]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},z_e=a=>{const{trigger:e,setIntParams:t}=le(),[i,r]=h.useState(!1),n=h.useRef(0),o=h.useRef(0),l=h.useRef(0),c=h.useRef(0),[u,d]=h.useState(!1),_=()=>{t([n.current,o.current,l.current,c.current])},m=(I,p,S,R)=>{n.current=I,o.current=p,l.current=S,c.current=R,r(!1)};h.useEffect(()=>{if(Oe().roomEngine.areaSelectionManager.areaSelectionState===Cd.NOT_ACTIVE)return d(Oe().roomEngine.areaSelectionManager.activate(m,"highlight_brighten")),n.current=e.intData.length>0?e.intData[0]:0,o.current=e.intData.length>1?e.intData[1]:0,l.current=e.intData.length>2?e.intData[2]:0,c.current=e.intData.length>3?e.intData[3]:0,Oe().roomEngine.areaSelectionManager.setHighlight(n.current,o.current,l.current,c.current),()=>{Oe().roomEngine.areaSelectionManager.deactivate()}},[e]);const f=()=>{Oe().roomEngine.areaSelectionManager.startSelecting(),r(!0)},E=()=>{Oe().roomEngine.areaSelectionManager.clearHighlight()};return s.jsxs(Li,{hasSpecialInput:!0,save:_,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.area_selection.select")}),s.jsx(T,{children:g("wiredfurni.params.area_selection.info")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx(X,{fullWidth:!0,variant:"dark",disabled:i,onClick:f,children:g("wiredfurni.params.area_selection")}),s.jsx(X,{fullWidth:!0,variant:"dark",onClick:E,children:g("wiredfurni.params.area_selection.clear")})]})]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},Sg=class Sg{};Sg.ROOT=0,Sg.UP=1,Sg.DOWN=2;let ga=Sg;const Wn=16,Ua=17,K_e=Wn*Ua,q_e=Wn*Ua/2+(Wn+Ua),GB=130,BB=15,yy=(a,e)=>{let t=a*Wn/2-e*Wn/2,i=a*Wn/4+e*Wn/4;return t=t+GB,i=i+BB,[t,i]},X_e=(a,e)=>{const t=a-GB,i=e-BB,r=(t/(Wn/2)+i/(Wn/4))/2,n=(i/(Wn/4)-t/(Wn/2))/2;return[r,n]},Rg=class Rg extends di{constructor(e,t){super({width:K_e,height:q_e,backgroundColor:14671839,antialias:!0,autoDensity:!0,resolution:1,sharedLoader:!0,sharedTicker:!0}),this._shiftPressed=!1,this._selectedTiles=new Set,this._startPoint=new ei(-1,-1),this._currentPoint=new ei(-1,-1),this._tilemap=[],this._rootLocation=new ei(0,0),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile=new ei(-1,-1),this._startPoint=new ei(-1,-1),this._actionSettings=new cB,this.setRootX=e,this.setRootY=t,this._selectedTiles=new Set}initialize(){if(this._isInitialized)return;const e=vr().getCollection("neighbor3");e&&(this._assetCollection=e,this._tilemapRenderer=new eD(e.baseTexture),this.registerEventListeners(),this.stage.addChild(this._tilemapRenderer),this._isInitialized=!0)}registerEventListeners(){window.addEventListener("keydown",t=>{t.key==="Shift"&&(this._shiftPressed=!0)}),window.addEventListener("keyup",t=>{t.key==="Shift"&&(this._shiftPressed=!1)});const e=new ei;this._tilemapRenderer.containsPoint=t=>(this._tilemapRenderer.worldTransform.applyInverse(t,e),this.tileHitDetection(e,!1)),this._tilemapRenderer.on("pointerup",()=>{this._isHolding=!1,this._startPoint.set(-1,-1),this._selectedTiles.forEach(t=>{this.onClick(t.x,t.y)}),this._selectedTiles.clear(),this.renderTiles()}),this._tilemapRenderer.on("pointerout",()=>{this._isHolding=!1}),this._tilemapRenderer.on("pointerdown",t=>{if(!(t.data.originalEvent instanceof PointerEvent)&&!(t.data.originalEvent instanceof TouchEvent))return;const i=t.data.originalEvent;if(i instanceof MouseEvent&&i.button===2)return;const r=t.data.global;this.tileHitDetection(r,!0)}),this._tilemapRenderer.on("click",t=>{if(!(t.data.originalEvent instanceof PointerEvent)||t.data.originalEvent.button===2)return;const r=t.data.global;this.tileHitDetection(r,!0,!0)})}tileHitDetection(e,t,i=!1){const r=this._tilemapRenderer.pointsBuf,n=zy,o=r.length;t&&(this._isHolding=!0);for(let l=0;l<o;l+=n){const c=l+n,u=r.slice(l,c),d=Wn,_=Wn/2,m=Math.floor(e.x),f=Math.floor(e.y),E=u[2],I=u[3],p=E+d/2,S=I+_/2,R=Math.abs(m-p),O=Math.abs(f-S);if(R*R/(d*.5)**2+O*O/(_*.5)**2<=1){if(this._isHolding){const[A,b]=X_e(E,I);if(i&&this._selectedTiles.size<=0)this.onClick(A,b);else if(this._shiftPressed&&(this._lastUsedTile.x!==A||this._lastUsedTile.y!==b)){this._startPoint.x===-1&&this._startPoint.y===-1&&this._startPoint.set(A,b),this._currentPoint.set(A,b);const y=Math.min(Math.abs(this._startPoint.x),Math.abs(this._currentPoint.x)),M=Math.max(Math.abs(this._startPoint.x),Math.abs(this._currentPoint.x)),U=Math.min(Math.abs(this._startPoint.y),Math.abs(this._currentPoint.y)),G=Math.max(Math.abs(this._startPoint.y),Math.abs(this._currentPoint.y));this._selectedTiles.clear();for(let F=U;F<=G;F++)for(let H=y;H<=M;H++){const v=new ei(H,F);this._selectedTiles.add(v)}this.processTile(),this._lastUsedTile.x=A,this._lastUsedTile.y=b}else(this._lastUsedTile.x!==A||this._lastUsedTile.y!==b)&&(this._lastUsedTile.x=A,this._lastUsedTile.y=b,this.onClick(A,b))}return!0}}return!1}processTile(){this.renderTiles()}onClick(e,t){const i=this._tilemap[e][t];switch(this._actionSettings.currentAction){case ga.ROOT:this._rootLocation.x=e,this._rootLocation.y=t,this.setRootX(e-Math.floor(Ua/2)),this.setRootY(t-Math.floor(Ua/2)),this.renderTiles();return;case ga.UP:if(i)return;this._tilemap[e][t]=!0;break;case ga.DOWN:if(!i)return;this._tilemap[e][t]=!1;break}this.renderTiles()}renderTiles(){this.tilemapRenderer.clear();for(let e=0;e<Ua;e++)for(let t=0;t<Ua;t++){const i=this.tilemap[t][e],[r,n]=yy(t,e);Array.from(this._selectedTiles).some(o=>o.x===t&&o.y===e)?this._tilemapRenderer.tile(this._assetCollection.getTexture(this._actionSettings.currentAction===ga.UP?"tile_s":"tile_n"),r,n):this._tilemapRenderer.tile(this._assetCollection.getTexture(i?"tile_s":"tile_n"),r,n)}if(this._rootLocation.x>=0&&this._rootLocation.x<=Ua&&this._rootLocation.y>=0&&this._rootLocation.y<=Ua){const[e,t]=yy(this._rootLocation.x,this._rootLocation.y);this._tilemapRenderer.tile(this._assetCollection.getTexture(this._tilemap[this._rootLocation.x][this._rootLocation.y]?"tile_selected_s":"tile_selected_n"),e,t)}}clear(){this._tilemapRenderer.interactive=!1,this._tilemap=[],this._rootLocation.set(-1,-1),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile.set(-1,-1),this._actionSettings.clear(),this._tilemapRenderer.clear(),this.setRootX=null,this.setRootY=null}get tilemapRenderer(){return this._tilemapRenderer}get tilemap(){return this._tilemap}set tilemap(e){this._tilemap=e}get rootLocation(){return this._rootLocation}set rootLocation(e){this._rootLocation=e}get actionSettings(){return this._actionSettings}};Rg._INSTANCE=null,Rg.TILE_BLOCKED="r_blocked",Rg.TILE_DOOR="r_door";let Vp=Rg;class Do{static parseSpiralVector(e,t){var i=0,r=0,n=null,o=Do.intParamsToBoolMask(e),l=t*2+1,c=[];for(i=0;i<l;){for(c[i]=[],r=0;r<l;)c[i][r]=!1,r++;i++}var u=Do.walkSpiral(t);for(i=0;i<u.length;)(n=u[i]).rank<o.length&&o[n.rank]&&(c[n.x+t][n.y+t]=!0),i++;return c}static createSpiralVector(e,t){var i=0,r=null,n=t*2+1,o=n*n,l=[];for(i=0;i<o;)l.push(!1),i++;var c=Do.walkSpiral(t);for(i=0;i<c.length;)r=c[i],e[r.x+t][r.y+t]&&(l[r.rank]=!0),i++;return Do.boolMaskToIntParams(l)}static walkSpiral(e){var t=0,i=0,r=0,n=e*2+1,o=n*n,l=[],c=0,u=0,d=0,_=[1,0];for(t=1;t<=n;){for(i=0;i<2;){for(r=0;r<t;){if(l.push({rank:c,x:u,y:d}),u+=_[0],d+=_[1],(c+=1)==o)return l;r++}_=Do.nextDirection(_),i++}t++}return l}static nextDirection(e){return e[0]==0&&e[1]==-1?[-1,0]:e[0]==1&&e[1]==0?[0,-1]:e[0]==0&&e[1]==1?[1,0]:[0,1]}static intParamsToBoolMask(e){let t=e.length*4,i=new ArrayBuffer(t),r=new DataView(i);for(let o=0;o<e.length;o++)r.setInt32(o*4,e[o],!0);let n=[];for(let o=0;o<t;o++){let l=r.getUint8(o);for(let c=0;c<8;c++)n.push((l&1<<c)!==0)}return n}static boolMaskToIntParams(e){let t=Math.ceil(e.length/8),i=new ArrayBuffer(t),r=new DataView(i),n=0,o=0;for(;n<e.length;){let c=0;for(let u=0;u<8&&n<e.length;u++)e[n]&&(c|=1<<u),n++;r.setInt8(o,c),o++}let l=[];for(let c=0;c+4<=t;c+=4)l.push(r.getInt32(c,!0));if(t%4!==0){let c=0;for(let u=t-t%4;u<t;u++)c|=r.getUint8(u)<<u%4*8;l.push(c)}return l}}const $_e=a=>{const e=Math.floor(Ua/2),{trigger:t,setIntParams:i,selectorNeighborhoodCopy:r,setSelectorNeighborhoodCopy:n,furniIds:o,setSourceForWired:l,selectObjectForWired:c,neighborhood:u}=le(),d=h.useRef(null),[_,m]=h.useState(Bt.UP),[f,E]=h.useState(""),[I,p]=h.useState(""),[S,R]=h.useState(!1),O=()=>{i([S?1:0,u.current.rootLocation.x-e,u.current.rootLocation.y-e,...Do.createSpiralVector(u.current.tilemap,e)])},C=y=>{m(y),u.current.actionSettings.currentAction=y},A=y=>{let M=y.target.value;if(!M){E("");return}M.startsWith("-")?M=M.slice(0,2):M=M.slice(0,1);let U=parseInt(M);(U>e||U<-e)&&(U=U>e?e:-e,M=U>e?e.toString():(-e).toString()),u.current.rootLocation.x=U+e,E(M),u.current.renderTiles()},b=y=>{let M=y.target.value;if(!M){p("");return}M.startsWith("-")?M=M.slice(0,2):M=M.slice(0,1);let U=parseInt(M);(U>e||U<-e)&&(U=U>e?e:-e,M=U>e?e.toString():(-e).toString()),u.current.rootLocation.y=U+e,p(M),u.current.renderTiles()};return h.useEffect(()=>(u.current||(u.current=new Vp(E,p),u.current.initialize()),m(Bt.UP),u.current.rootLocation=new ei(t.intData.length>0?t.intData[1]+e:e,t.intData.length>1?t.intData[2]+e:e),E((u.current.rootLocation.x-e).toString()),p((u.current.rootLocation.y-e).toString()),u.current.tilemap=Do.parseSpiralVector(t.intData.slice(3),e),u.current.actionSettings.currentAction=_,u.current.renderTiles(),u.current.tilemapRenderer.interactive=!0,d.current.replaceChildren(u.current.renderer.view),()=>{u.current&&u.current.clear()}),[t]),s.jsxs(Li,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,advancedAlwaysVisible:!0,forceHidePickFurniInstructions:!0,hasSpecialInput:!0,save:O,children:[s.jsxs(N,{gap:1,className:"position-relative",children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.neighborhood_selection")}),s.jsxs(x,{gap:3,children:[s.jsxs(x,{gap:1,children:[s.jsx(ct,{itemActive:_===ga.UP,onClick:y=>C(Bt.UP),children:s.jsx("i",{className:"icon icon-addfloor-neighbor"})}),s.jsx(ct,{itemActive:_===ga.DOWN,onClick:y=>C(Bt.DOWN),children:s.jsx("i",{className:"icon icon-removefloor-neighbor"})})]}),s.jsx("div",{style:{marginTop:"1px",height:"25px",width:"1px",backgroundColor:"#909090"}}),s.jsx(ct,{itemActive:_===ga.ROOT,onClick:y=>C(Bt.DOOR),children:s.jsx("i",{className:"icon icon-set-rootlocation"})})]}),s.jsx(Ye,{gap:1,children:s.jsx(N,{size:12,gap:1,children:s.jsx(q,{innerRef:d})})})]}),s.jsxs(x,{gap:2,alignItems:"center",justifyContent:"end",style:{marginTop:"-10px"},children:[s.jsxs(x,{gap:1,alignItems:"center",style:{color:"black"},children:["x: ",s.jsx("input",{type:"number",maxLength:1,max:e,min:-e,className:"form-control form-control-sm fs-7",value:f,onChange:A,style:{maxWidth:"35px"}})]}),s.jsxs(x,{gap:1,alignItems:"center",style:{color:"black"},children:["y: ",s.jsx("input",{type:"number",maxLength:1,max:e,min:-e,className:"form-control form-control-sm fs-7",value:I,onChange:b,style:{maxWidth:"35px"}})]})]}),s.jsx("hr",{className:"bg-dark m-0"})]})},Q_e=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),{trigger:n=null,setIntParams:o=null}=le(),l=()=>{o([i,e])};return h.useEffect(()=>{r(n.intData.length>0?n.intData[0]:0),t(n.intData.length>1?n.intData[1]:0)},[n]),s.jsxs(Li,{hasSpecialInput:!0,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.comparison_selection")}),s.jsx(x,{className:"flex-wrap col-10",justifyContent:"between",gap:2,column:!0,children:[0,1,2].map(c=>s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"comparison",id:`comparison${c}`,checked:e===c,onChange:u=>t(c)}),s.jsx(T,{children:g(`wiredfurni.params.comparison.${c}`)})]},c))})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsxs(T,{bold:!0,children:[g("wiredfurni.params.opacityitem"),s.jsx("input",{type:"number",maxLength:2,className:"form-control form-control-sm fs-7 d-inline",step:".01",max:10,style:{maxWidth:"50px",marginLeft:"5px"},value:i/10,onChange:c=>{r(parseFloat(c.target.value)*10)}})]}),s.jsx(zt,{min:0,max:10,value:i,setValue:r})]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},J_e=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),[n,o]=h.useState(0),{trigger:l=null,setIntParams:c=null}=le(),u=()=>{c([e,i,n])};return h.useEffect(()=>{t(l.intData.length>0?l.intData[0]:0),r(l.intData.length>1?l.intData[1]:0),o(l.intData.length>2?l.intData[2]:0)},[l]),s.jsxs(Li,{hasSpecialInput:!0,save:u,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.selection_remote")}),s.jsx("span",{className:"text-xs text-black",style:{opacity:.5},children:g("wiredfurni.params.remote.info")}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",checked:e===0,onChange:()=>t(0)}),s.jsx(T,{children:g("wiredfurni.params.remote.option_1")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",checked:e===1,onChange:()=>t(1)}),s.jsx(T,{children:g("wiredfurni.params.remote.option_2")})]})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.remote.filter_wired")}),s.jsxs(N,{gap:1,children:[s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",checked:i===0,onChange:()=>r(0)}),s.jsx(T,{children:g("wiredfurni.params.remote.filter.option_1")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"radio",checked:i===1,onChange:()=>r(1)}),s.jsx(T,{children:g("wiredfurni.params.remote.filter.option_2")}),s.jsx("input",{type:"number",className:"form-control",disabled:i!==1,style:{padding:"5px 5px",height:"20px",width:"35px",border:"1px solid rgba(0, 0, 0, 0.5)"},value:n,onChange:d=>o(parseInt(d.target.value))})]})]})]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},Dy=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(-1),[n,o]=h.useState(-1),[l,c]=h.useState(0),[u,d]=h.useState(0),[_,m]=h.useState(!1),[f,E]=h.useState(0),{trigger:I,setIntParams:p,setVariableIds:S}=le(),{variablesSource:R=Bp}=a,O=()=>{p([_?1:0,l,u,f,e]),S([i,n])};h.useEffect(()=>{m(I.intData.length>0?I.intData[0]===1:!1),c(I.intData.length>1?I.intData[1]:0),d(I.intData.length>2?I.intData[2]:0),E(I.intData.length>3?I.intData[3]:0),t(I.intData.length>4?I.intData[4]:-10),r(I.variableIds.length>0?I.variableIds[0]:-1),o(I.variableIds.length>1?I.variableIds[1]:-1)},[I]);const C=h.useMemo(()=>u!==1||!_,[u,_]);return s.jsxs(Li,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,mergedSources:!0,advancedAlwaysVisible:!0,mergedSelections:[new $r([0,0],"wiredfurni.params.sources.merged.title.variables",e,t,C)],save:O,children:[s.jsx(Er,{wiredVariableTypes:[R],type:R,selectedVar:i,setSelectedVar:r}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.comparison_selection")}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"created",checked:_,onChange:A=>m(A.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.variables.value_settings.select_by_value")})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,className:!_&&"disabled-input-sources",children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.comparison_selection")}),s.jsxs(x,{gap:3,children:[s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{disabled:!_,className:"form-check-input",type:"radio",name:"selectedOperation",id:"selectedOperation0",checked:l===0,onChange:A=>c(0)}),s.jsx(T,{children:">"})]},0),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{disabled:!_,className:"form-check-input",type:"radio",name:"selectedOperation",id:"selectedTeam1",checked:l===1,onChange:A=>c(1)}),s.jsx(T,{children:"≥"})]},1),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{disabled:!_,className:"form-check-input",type:"radio",name:"selectedOperation",id:"selectedTeam2",checked:l===2,onChange:A=>c(2)}),s.jsx(T,{children:"="})]},2),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{disabled:!_,className:"form-check-input",type:"radio",name:"selectedOperation",id:"selectedTeam3",checked:l===3,onChange:A=>c(3)}),s.jsx(T,{children:"<"})]},3),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{disabled:!_,className:"form-check-input",type:"radio",name:"selectedOperation",id:"selectedTeam4",checked:l===4,onChange:A=>c(4)}),s.jsx(T,{children:"≤"})]},4),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{disabled:!_,className:"form-check-input",type:"radio",name:"selectedOperation",id:"selectedTeam4",checked:l===5,onChange:A=>c(5)}),s.jsx(T,{children:"≠"})]},5)]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.reference_value")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{disabled:!_,className:"form-check-input",type:"radio",name:"selectedReferenceValue",id:"selectedReferenceValue0",checked:u===0,onChange:A=>d(0)}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx(T,{children:g("wiredfurni.params.variables.reference_value.set_value")}),s.jsx("input",{disabled:!_,className:"form-control form-control-sm fs-7",style:{maxWidth:"60px"},value:f,onChange:A=>E(parseInt(A.target.value)),type:"number"})]})]},0),s.jsxs(x,{gap:1,children:[s.jsx("input",{disabled:!_,className:"form-check-input",type:"radio",name:"selectedReferenceValue",id:"selectedReferenceValue1",checked:u===1,onChange:A=>d(1)}),s.jsx("div",{className:"flex-grow-1",children:s.jsx(Er,{wiredVariableTypes:[0,1,-10,-20],type:e,setType:t,selectedVar:n,setSelectedVar:o,isDisabled:C,isReference:!0,bold:!1,title:"wiredfurni.params.variables.reference_value.from_variable"})})]},1)]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},Z_e=a=>{const[e,t]=h.useState(""),{trigger:i=null,setStringParam:r=null}=le(),n=()=>r(e);return h.useEffect(()=>{t(i.stringData)},[i]),s.jsxs(Li,{hasSpecialInput:!0,save:n,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("Efeito: ")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:o=>t(o.target.value)})]}),s.jsx("hr",{className:"m-0 bg-dark"})]})},ege=a=>{const e=Math.floor(Ua/2),{trigger:t,setIntParams:i,selectorNeighborhoodCopy:r,setSelectorNeighborhoodCopy:n,furniIds:o,setSourceForWired:l,selectObjectForWired:c,neighborhood:u,selectedSource:d}=le(),_=h.useRef(null),[m,f]=h.useState(Bt.UP),[E,I]=h.useState(""),[p,S]=h.useState(""),[R,O]=h.useState(!1),C=()=>{i([R?1:0,u.current.rootLocation.x-e,u.current.rootLocation.y-e,...Do.createSpiralVector(u.current.tilemap,e)])},A=M=>{f(M),u.current.actionSettings.currentAction=M};h.useEffect(()=>{O(d=="users")},[d]);const b=M=>{let U=M.target.value;if(!U){I("");return}U.startsWith("-")?U=U.slice(0,2):U=U.slice(0,1);let G=parseInt(U);(G>e||G<-e)&&(G=G>e?e:-e,U=G>e?e.toString():(-e).toString()),u.current.rootLocation.x=G+e,I(U),u.current.renderTiles()},y=M=>{let U=M.target.value;if(!U){S("");return}U.startsWith("-")?U=U.slice(0,2):U=U.slice(0,1);let G=parseInt(U);(G>e||G<-e)&&(G=G>e?e:-e,U=G>e?e.toString():(-e).toString()),u.current.rootLocation.y=G+e,S(U),u.current.renderTiles()};return h.useEffect(()=>(u.current||(u.current=new Vp(I,S),u.current.initialize()),f(Bt.UP),O(t.intData.length>0&&t.intData[0]===1),u.current.rootLocation=new ei(t.intData.length>0?t.intData[1]+e:e,t.intData.length>1?t.intData[2]+e:e),I((u.current.rootLocation.x-e).toString()),S((u.current.rootLocation.y-e).toString()),u.current.tilemap=Do.parseSpiralVector(t.intData.slice(3),e),u.current.actionSettings.currentAction=m,u.current.renderTiles(),u.current.tilemapRenderer.interactive=!0,_.current.replaceChildren(u.current.renderer.view),()=>{u.current&&u.current.clear()}),[t]),s.jsxs(Li,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID,advancedAlwaysVisible:!0,forceHidePickFurniInstructions:!0,mergedSources:!0,mergedSelections:[new $r([0,0],"wiredfurni.params.sources.merged.title")],hasSpecialInput:!0,save:C,children:[s.jsxs(N,{gap:1,className:"position-relative",children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.neighborhood_selection")}),s.jsxs(x,{gap:3,children:[s.jsxs(x,{gap:1,children:[s.jsx(ct,{itemActive:m===ga.UP,onClick:M=>A(Bt.UP),children:s.jsx("i",{className:"icon icon-addfloor-neighbor"})}),s.jsx(ct,{itemActive:m===ga.DOWN,onClick:M=>A(Bt.DOWN),children:s.jsx("i",{className:"icon icon-removefloor-neighbor"})})]}),s.jsx("div",{style:{marginTop:"1px",height:"25px",width:"1px",backgroundColor:"#909090"}}),s.jsx(ct,{itemActive:m===ga.ROOT,onClick:M=>A(Bt.DOOR),children:s.jsx("i",{className:"icon icon-set-rootlocation"})})]}),s.jsx(Ye,{gap:1,children:s.jsx(N,{size:12,gap:1,children:s.jsx(q,{innerRef:_})})})]}),s.jsxs(x,{gap:2,alignItems:"center",justifyContent:"end",style:{marginTop:"-10px"},children:[s.jsxs(x,{gap:1,alignItems:"center",style:{color:"black"},children:["x: ",s.jsx("input",{type:"number",maxLength:1,max:e,min:-e,className:"form-control form-control-sm fs-7",value:E,onChange:b,style:{maxWidth:"35px"}})]}),s.jsxs(x,{gap:1,alignItems:"center",style:{color:"black"},children:["y: ",s.jsx("input",{type:"number",maxLength:1,max:e,min:-e,className:"form-control form-control-sm fs-7",value:p,onChange:y,style:{maxWidth:"35px"}})]})]}),s.jsx("hr",{className:"bg-dark m-0"})]})},tge=a=>{switch(a){case Fs.FURNI_BY_TYPE:return s.jsx(y_e,{});case Fs.FURNI_CHOOSER:return s.jsx(D_e,{});case Fs.USERS_BY_TYPE:return s.jsx(P_e,{});case Fs.USERS_IN_TEAM:return s.jsx(k_e,{});case Fs.FURNI_ON_FURNI:return s.jsx(M_e,{});case Fs.FURNI_FROM_SIGNAL:return s.jsx(w_e,{});case Fs.USERS_ON_FURNI:return s.jsx(G_e,{});case Fs.USERS_PERFORMING_ACTION:return s.jsx(W_e,{});case Fs.USERS_FROM_SIGNAL:return s.jsx(U_e,{});case Fs.USERS_BY_NAME:return s.jsx(L_e,{});case Fs.FURNI_IN_NEIGHBORHOOD:case Fs.USERS_IN_NEIGHBORHOOD:return s.jsx($_e,{});case Fs.USERS_IN_AREA:case Fs.FURNI_IN_AREA:return s.jsx(z_e,{});case Fs.USERS_WITH_HANDITEM:return s.jsx(Y_e,{});case Fs.USERS_IN_GROUP:return s.jsx(F_e,{});case Fs.FURNI_WITH_ALTITUDE:return s.jsx(j_e,{});case Fs.FURNI_WITH_OPACITY:return s.jsx(Q_e,{});case Fs.REMOTE_SELECTION:return s.jsx(J_e,{});case Fs.FURNI_WITH_VAR:return s.jsx(Dy,{variablesSource:0});case Fs.USERS_WITH_VAR:return s.jsx(Dy,{variablesSource:1});case Fs.USERS_WITH_EFFECT:return s.jsx(Z_e,{});case Fs.FURNI_IN_NEIGHBORHOOD2:case Fs.USERS_IN_NEIGHBORHOOD2:return s.jsx(ege,{})}},Us=a=>{const{requiresFurni:e=ge.STUFF_SELECTION_OPTION_NONE,save:t=null,hasSpecialInput:i=!1,children:r=null,userSelectionTitle:n=null,applyConfigurationSaved:o=!1,mergedSelections:l=null}=a,c=()=>t&&t();return s.jsx(e_,{wiredType:"trigger",requiresFurni:e,hasSpecialInput:i,userSelectionTitle:n,save:c,applyConfigurationSaved:o,mergedSelections:l,children:r})},sge=a=>s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),ige=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(0),{trigger:n=null,setStringParam:o=null}=le(),l=()=>o(i===1?e:"");return h.useEffect(()=>{t(n.stringData),r(n.stringData?1:0)},[n]),s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l})},rge=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(-1),[n,o]=h.useState(-1),[l,c]=h.useState(0),[u,d]=h.useState(0),[_,m]=h.useState(0),{trigger:f=null,setStringParam:E=null,setIntParams:I=null}=le(),p=()=>{E(e),I([i,n,l,u,_])};return h.useEffect(()=>{t(f.stringData),r(f.intData.length>0?f.intData[0]:0),o(f.intData.length>1?f.intData[1]:0),c(f.intData.length>2?f.intData[2]:0),d(f.intData.length>3?f.intData[3]:0),m(f.intData.length>4?f.intData[4]:0)},[f]),s.jsxs(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:p,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.whatissaid")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:S=>t(S.target.value),disabled:n===2})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.chattriggertype")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:n===0,onChange:S=>o(0)}),s.jsx(T,{children:g("wiredfurni.params.chatcontains")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:n===1,onChange:S=>o(1)}),s.jsx(T,{children:g("wiredfurni.params.exactmatch")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:n===2,onChange:S=>o(2)}),s.jsx(T,{children:g("wiredfurni.params.agree_with_full_text")})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.picktriggerer")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar0",checked:i===0,onChange:S=>r(0)}),s.jsx(T,{children:g("wiredfurni.params.anyavatar")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar1",checked:i===1,onChange:S=>r(1)}),s.jsx(T,{children:g("wiredfurni.params.only_owner")})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.exhibition")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"redOption",checked:!!l&&!_,onChange:S=>{c(S.target.checked?1:0),m(S.target.checked?0:_)}}),s.jsx(T,{children:g("wiredfurni.params.exhibitionkey")})]}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"sendWhisperMessage",checked:!!_&&!l,onChange:S=>{m(S.target.checked?1:0),c(S.target.checked?0:l)}}),s.jsx(T,{children:g("wiredfurni.params.exhibition.send_whisper_message")})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"ignoreCase",checked:!!u,onChange:S=>d(S.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.ignorecase")})]})]})]})},nge=a=>{const[e,t]=h.useState(1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{i.intData.length>=1?t(i.intData[0]):t(1)},[i]),s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.position_check")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",id:"byFurni",checked:e==1,onClick:o=>t(1)}),s.jsx(T,{children:g("wiredfurni.params.walks.by_furni")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",id:"byPosition",checked:e==2,onClick:o=>t(2)}),s.jsx(T,{children:g("wiredfurni.params.walks.by_position")})]})]})})},age=a=>{const[e,t]=h.useState(1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{i.intData.length>=1?t(i.intData[0]):t(1)},[i]),s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.walks.checks_by")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",id:"byFurni",checked:e==1,onClick:o=>t(1)}),s.jsx(T,{children:g("wiredfurni.params.walks.checks_by_furni")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",id:"byPosition",checked:e==2,onClick:o=>t(2)}),s.jsx(T,{children:g("wiredfurni.params.walks.checks_by_position")})]})]})})},oge=a=>{const[e,t]=h.useState(""),{trigger:i=null,setStringParam:r=null,setIntParams:n}=le(),[o,l]=h.useState(0),{items:c,populateChooser:u}=en(),[d,_]=h.useState([]),[m,f]=h.useState(!1),E=()=>{r(e),n([o])};return h.useEffect(()=>{t(i.stringData),l(i.intData.length>0?i.intData[0]:0)},[i]),h.useEffect(()=>{if(!c){u();return}const I=c.filter(p=>p&&p.type===4).map(p=>p.name);_(I)},[c]),s.jsxs(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:E,children:[s.jsxs(N,{gap:1,onMouseLeave:()=>f(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.name")}),s.jsx(Hi,{data:d,value:e,onChange:t,maxLength:32,showDropdown:m,setShowDropdown:f},d.length)]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.triggerer_choice")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:o===0,onChange:I=>l(0)}),s.jsx(T,{children:g("wiredfurni.params.triggerer.user")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:o===1,onChange:I=>l(1)}),s.jsx(T,{children:g("wiredfurni.params.triggerer.bot")})]})]})]})},lge=a=>{const[e,t]=h.useState(""),{trigger:i=null,setStringParam:r=null}=le(),{items:n,populateChooser:o}=en(),[l,c]=h.useState([]),[u,d]=h.useState(!1),_=()=>r(e);return h.useEffect(()=>{t(i.stringData)},[i]),h.useEffect(()=>{if(!n){o();return}const m=n.filter(f=>f&&f.type===4).map(f=>f.name);c(m)},[n]),s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,userSelectionTitle:"wiredfurni.params.sources.users.title",save:_,children:s.jsxs(N,{gap:1,onMouseLeave:()=>d(!1),children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.bot.name")}),s.jsx(Hi,{data:l,value:e,onChange:t,maxLength:32,showDropdown:u,setShowDropdown:d},l.length)]})})},cge=a=>s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),uge=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),{trigger:n=null,setIntParams:o=null}=le(),l=()=>o([e,i]);return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.intData.length>1?n.intData[1]:0)},[n]),s.jsxs(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:l,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.clock_minutes_elapsed",["minutes"],[e.toString()])}),s.jsx(zt,{min:0,max:99,value:e,setValue:t})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.clock_seconds_elapsed",["seconds"],[i.toString()])}),s.jsx(zt,{min:0,max:60,value:i,setValue:r})]})]})},hge=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),{trigger:n=null,setIntParams:o=null}=le(),l=()=>{o([e,i])};return h.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),r(n.intData.length>1?n.intData[1]:0)},[n]),s.jsxs(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:l,children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",name:"triggererType",id:"triggererType0",checked:e===1,onChange:c=>t(e===0?1:0)}),s.jsx(T,{children:g("wiredfurni.params.collision.receive_all_users")})]}),s.jsx(s.Fragment,{children:e===0&&s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",name:"triggererType",id:"triggererType0",checked:i===1,onChange:c=>r(i===0?1:0)}),s.jsx(T,{children:g("wiredfurni.params.collision.random_user")})]})})]})},dge=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),[n,o]=h.useState(0),[l,c]=h.useState(0),{trigger:u=null,setIntParams:d=null}=le(),_=()=>d([e,i,n,l]);return h.useEffect(()=>{t(u.intData.length>0?u.intData[0]:0),r(u.intData.length>1?u.intData[1]:0),o(u.intData.length>2?u.intData[2]:0),c(u.intData.length>3?u.intData[3]:0)},[u]),s.jsxs(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:_,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.team")}),s.jsxs(x,{className:"flex-wrap col-10",justifyContent:"between",gap:2,children:[s.jsxs(x,{gap:1,alignItems:"center",className:"col-5",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"redOption",checked:!!e,onChange:m=>t(m.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.team.1")})]}),s.jsxs(x,{gap:1,alignItems:"center",className:"col-5",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"greenOption",checked:!!i,onChange:m=>r(m.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.team.2")})]}),s.jsxs(x,{gap:1,alignItems:"center",className:"col-5",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"blueOption",checked:!!n,onChange:m=>o(m.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.team.3")})]}),s.jsxs(x,{gap:1,alignItems:"center",className:"col-5",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"yellowOption",checked:!!l,onChange:m=>c(m.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.team.4")})]})]})]})},_ge=a=>{const[e,t]=h.useState(1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.settime",["seconds"],[oh(e)])}),s.jsx(zt,{min:1,max:1200,value:e,setValue:t})]})})},gge=a=>{const[e,t]=h.useState(1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.setlongtime",["time"],[Mr.format(e*5).toString()])}),s.jsx(zt,{min:1,max:120,value:e,setValue:t})]})})},mge=a=>{const[e,t]=h.useState(1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.settime",["seconds"],[oh(e)])}),s.jsx(zt,{min:1,max:60,value:e,setValue:t})]})})},fge=a=>s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),pge=a=>s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),Ege=a=>{const[e,t]=h.useState(1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>r([e]);return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.setshorttime",["ms"],[(e*50).toString()])}),s.jsx(zt,{min:1,max:20,value:e,setValue:t})]})})},Ige=[{value:1,text:"widget.memenu.wave"},{value:2,text:"widget.memenu.blow"},{value:3,text:"widget.memenu.laugh"},{value:4,text:"widget.memenu.sit"},{value:5,text:"widget.memenu.idle"},{value:6,text:"wiredfurni.params.action.4"},{value:7,text:"widget.memenu.thumb"},{value:8,text:"widget.memenu.stand"},{value:9,text:"wiredfurni.params.action.8"},{value:10,text:"widget.memenu.sign"},{value:11,text:"widget.memenu.dance"}],Tge=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],Sge=[1,2,3,4],Rge=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),[n,o]=h.useState(""),{trigger:l=null,setIntParams:c=null,setStringParam:u}=le(),d=()=>{c([e]),u(e===10||e===11?n:"")};return h.useEffect(()=>{const _=l.intData.length>0?l.intData[0]:0;_===10&&l.stringData!==""||_===11&&l.stringData!==""?(r(1),o(l.stringData)):(r(0),o("")),t(_)},[l]),s.jsxs(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.action_selection")}),s.jsx("select",{className:"form-select form-select-sm",value:e,onChange:_=>t(parseInt(_.target.value)),children:Ige.map((_,m)=>s.jsx("option",{value:_.value,children:g(_.text)},m))})]}),(e===10||e===11)&&s.jsxs(s.Fragment,{children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g(`${e===11?"wiredfurni.params.dance_txt":"wiredfurni.params.sign_txt"}`)}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"filter",checked:!!i,onChange:_=>r(_.target.checked?1:0)}),s.jsx(T,{children:g(`${e===11?"wiredfurni.params.dance_filter":"wiredfurni.params.sign_filter"}`)})]})]}),i&&e===10?s.jsx(N,{gap:1,children:s.jsx("select",{className:"form-select form-select-sm",value:n,onChange:_=>o(_.target.value),children:Tge.map((_,m)=>s.jsx("option",{value:_,children:g(`wiredfurni.params.action.sign.${_}`)},m))})}):null,i&&e===11?s.jsx(N,{gap:1,children:s.jsx("select",{className:"form-select form-select-sm",value:n,onChange:_=>o(_.target.value),children:Sge.map((_,m)=>s.jsx("option",{value:"dance "+_,children:g(g(`wiredfurni.params.action.dance.${_}`))},m))})}):null]})]})},xge=a=>s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),Oge=a=>{const[e,t]=h.useState(0),[i,r]=h.useState("0"),[n,o]=h.useState(0),{trigger:l=null,setIntParams:c=null,setStringParam:u=null}=le(),d=()=>{c([e,n]),u(i)};return h.useEffect(()=>{r(l.stringData||"0"),t(l.intData.length>0?l.intData[0]:0),o(l.intData.length>1?l.intData[1]:0)},[l]),s.jsxs(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[s.jsx(N,{gap:1,children:s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",checked:e==1,onChange:_=>t(_.target.checked?1:0)}),s.jsxs(T,{children:[" ",g("wiredfurni.params.team.usage")]})]})}),e==1&&s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.team")}),s.jsxs(x,{gap:2,className:"flex-wrap col-10",justifyContent:"between",children:[s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType0",id:"triggererType0",checked:n===0,onChange:_=>o(0)}),s.jsx(T,{children:g("wiredfurni.params.team.any")})]}),[1,2,3,4].map(_=>s.jsxs(x,{alignItems:"center",gap:1,className:"col-5",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType"+_,id:"triggererType",checked:n===_,onChange:m=>o(_)}),s.jsx(T,{children:g("wiredfurni.params.team."+_)})]},_))]})]}),s.jsxs(N,{gap:1,children:[e==0&&s.jsx(T,{bold:!0,children:g("wiredfurni.params.setscore.user")}),e==1&&s.jsx(T,{bold:!0,children:g("wiredfurni.params.setscore.team")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:i||"0",onChange:_=>{r(_.target.value)}})]})]})},Cge=a=>{const[e,t]=h.useState(-1),{trigger:i=null,setIntParams:r=null}=le(),n=()=>{r([e])};return h.useEffect(()=>{t(i.intData.length>0?i.intData[0]:0)},[i]),s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,applyConfigurationSaved:!0,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.state_match")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:e===0,onChange:o=>t(0)}),s.jsx(T,{children:g("wiredfurni.params.state_trigger.0")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:e===1,onChange:o=>t(1)}),s.jsx(T,{children:g("wiredfurni.params.state_trigger.1")})]})]})})},Nge=a=>s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),Age=a=>{const{title:e=""}=a,[t,i]=h.useState(""),{trigger:r=null,setStringParam:n=null}=le(),o=()=>{n(t)};return h.useEffect(()=>{i(r.stringData)},[r]),s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:o,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g(e)}),s.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:80,value:t,onChange:l=>i(l.target.value)})]})})},bge=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(-1),[n,o]=h.useState(-1),[l,c]=h.useState(-1),[u,d]=h.useState(-1),{trigger:_=null,setIntParams:m=null}=le(),f=()=>m([e,i,n,l,u]);return h.useEffect(()=>{t(_.intData.length>0?_.intData[0]:0),r(_.intData.length>1?_.intData[1]:0),o(_.intData.length>2?_.intData[2]:0),c(_.intData.length>3?_.intData[3]:0),d(_.intData.length>4?_.intData[4]:0)},[_]),s.jsxs(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:f,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:"Quando um Hubbe é clicado:"}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",name:"triggererOpenMenu",id:"triggererOpenMenu",checked:l===1,onChange:E=>c(E.target.checked?1:0)}),s.jsx(T,{children:"Não abrir o menu de avatar"})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",name:"triggererLookTo",id:"triggererLookTo",checked:u===1,onChange:E=>d(E.target.checked?1:0)}),s.jsx(T,{children:"Não gire"})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.picktriggerer")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar0",checked:e===0,onChange:E=>t(0)}),s.jsx(T,{children:g("wiredfurni.params.anyavatar")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar1",checked:e===1,onChange:E=>t(1)}),s.jsx(T,{children:g("wiredfurni.params.only_owner")})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:"Aplicar ações em:"}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:i===0,onChange:E=>r(0)}),s.jsx(T,{children:"Jogador clicado"})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:i===1,onChange:E=>r(1)}),s.jsx(T,{children:"Jogador que clicou"})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:"Alcance do jogador"}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererDistance",id:"triggererDistance0",checked:n===0,onChange:E=>o(0)}),s.jsx(T,{children:"Distante"})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererDistance",id:"triggererDistance1",checked:n===1,onChange:E=>o(1)}),s.jsx(T,{children:"Perto de"})]})]})]})},vge=a=>{const[e,t]=h.useState(""),[i,r]=h.useState(-1),[n,o]=h.useState(-1),[l,c]=h.useState(-1),[u,d]=h.useState(0),{trigger:_=null,setStringParam:m=null,setIntParams:f=null}=le(),E=()=>{m(e),f([i,u,n,l])};return h.useEffect(()=>{t(_.stringData),r(_.intData.length>0?_.intData[0]:0),d(_.intData.length>1?_.intData[1]:0),o(_.intData.length>2?_.intData[2]:0),c(_.intData.length>3?_.intData[3]:0)},[_]),s.jsxs(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:E,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.whatissaid")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:I=>t(I.target.value)})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:"Aplicar ações em:"}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType0",checked:n===0,onChange:I=>o(0)}),s.jsx(T,{children:"Jogador clicado"})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererType",id:"triggererType1",checked:n===1,onChange:I=>o(1)}),s.jsx(T,{children:"Jogador que clicou"})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:"Alcance do jogador"}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererDistance",id:"triggererDistance0",checked:l===0,onChange:I=>c(0)}),s.jsx(T,{children:"Distante"})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererDistance",id:"triggererDistance1",checked:l===1,onChange:I=>c(1)}),s.jsx(T,{children:"Perto de"})]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.picktriggerer")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar0",checked:i===0,onChange:I=>r(0)}),s.jsx(T,{children:g("wiredfurni.params.anyavatar")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar1",checked:i===1,onChange:I=>r(1)}),s.jsx(T,{children:te().userName})]})]}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.configuration")}),s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"ignoreCase",checked:!!u,onChange:I=>d(I.target.checked?1:0)}),s.jsx(T,{children:g("wiredfurni.params.ignorecase")})]})]})]})},yge=a=>{const[e,t]=h.useState(0),[i,r]=h.useState(0),{trigger:n=null,setIntParams:o=null,setStringParam:l=null}=le(),c=()=>{o([e,i?1:0])};return h.useEffect(()=>{t(n.intData[0]||0),r(n.intData[1]||0)},[n]),s.jsx(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:c,children:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.keybind.key")}),s.jsx("select",{className:"form-select form-select-sm",value:e,onChange:u=>t(parseInt(u.target.value)),children:[0,1,2,3,4,5,6,7].map((u,d)=>s.jsx("option",{value:u,children:g("wiredfurni.params.keybind."+u)},"keybind."+d))}),s.jsx(T,{bold:!0,children:g("wiredfurni.params.keybind.execute_on")}),s.jsxs("select",{className:"form-select form-select-sm",value:i,onChange:u=>r(parseInt(u.target.value)),children:[s.jsx("option",{value:0,children:g("wiredfurni.params.keybind.key_down")}),s.jsx("option",{value:1,children:g("wiredfurni.params.keybind.key_up")})]})]})})},Dge=a=>{const[e,t]=h.useState(-1),[i,r]=h.useState(!0),[n,o]=h.useState(!0),[l,c]=h.useState(!0),[u,d]=h.useState(!0),[_,m]=h.useState(!0),[f,E]=h.useState(0),[I,p]=h.useState(!1),{trigger:S,setIntParams:R,setVariableIds:O}=le(),C=()=>{R([i?1:0,n?1:0,I?1:0,l?1:0,u?1:0,_?1:0,f]),O([e])};return h.useEffect(()=>{r(S.intData.length>0?S.intData[0]===1:!0),o(S.intData.length>1?S.intData[1]===1:!0),p(S.intData.length>2?S.intData[2]===1:!1),c(S.intData.length>3?S.intData[3]===1:!0),d(S.intData.length>4?S.intData[4]===1:!0),m(S.intData.length>5?S.intData[5]===1:!0),E(S.intData.length>6?S.intData[6]:0),t(S.variableIds.length>0?S.variableIds[0]:-1)},[S]),s.jsxs(Us,{requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:C,children:[s.jsx(Er,{wiredVariableTypes:[0,1,-10],type:f,setType:E,selectedVar:e,disableInternal:!0,setSelectedVar:t,neededPermissions:{interceptChanges:!0}}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.trigger_options")}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"created",checked:i,onChange:A=>r(A.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.variables.trigger_options.0")})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"created",checked:n,onChange:A=>o(A.target.checked)}),s.jsxs(x,{column:!0,gap:1,children:[s.jsx(T,{children:g("wiredfurni.params.variables.trigger_options.1")}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"changedToUp",checked:l,onChange:A=>c(A.target.checked),disabled:!n}),s.jsx(T,{children:g("wiredfurni.params.variables.trigger_options.3")})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"changedToDown",checked:u,onChange:A=>d(A.target.checked),disabled:!n}),s.jsx(T,{children:g("wiredfurni.params.variables.trigger_options.4")})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"changedToEqual",checked:_,onChange:A=>m(A.target.checked),disabled:!n}),s.jsx(T,{children:g("wiredfurni.params.variables.trigger_options.5")})]})]})]}),s.jsxs(x,{gap:1,children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"created",checked:I,onChange:A=>p(A.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.variables.trigger_options.2")})]})]})]})},Mge=a=>{switch(a){case Ts.AVATAR_SAYS_SOMETHING:return s.jsx(rge,{});case Ts.AVATAR_WALKS_ON_FURNI:return s.jsx(age,{});case Ts.AVATAR_WALKS_OFF_FURNI:return s.jsx(nge,{});case Ts.EXECUTE_ONCE:return s.jsx(_ge,{});case Ts.TOGGLE_FURNI:return s.jsx(Nge,{});case Ts.EXECUTE_PERIODICALLY:return s.jsx(mge,{});case Ts.AVATAR_ENTERS_ROOM:return s.jsx(ige,{});case Ts.GAME_STARTS:return s.jsx(pge,{});case Ts.GAME_ENDS:return s.jsx(fge,{});case Ts.SCORE_ACHIEVED:return s.jsx(Oge,{});case Ts.COLLISION:return s.jsx(hge,{});case Ts.EXECUTE_PERIODICALLY_LONG:return s.jsx(gge,{});case Ts.BOT_REACHED_STUFF:return s.jsx(lge,{});case Ts.BOT_REACHED_AVATAR:return s.jsx(oge,{});case Ts.CLOCK_REACH_TIME:return s.jsx(uge,{});case Ts.PERFORM_ACTION:return s.jsx(Rge,{});case Ts.RECEIVE_SIGNAL:return s.jsx(xge,{});case Ts.AVATAR_CLICKS_FURNI:return s.jsx(sge,{});case Ts.PERIODIC_SHORT:return s.jsx(Ege,{});case Ts.STATE_CHANGE:return s.jsx(Cge,{});case Ts.CLICK_BLOCK:return s.jsx(cge,{});case Ts.ENTER_OR_LEAVE_TEAM:return s.jsx(dge,{});case Ts.RECEIVE_SCRIPT_SIGNAL:return s.jsx(Age,{title:"wiredfurni.params.scriptsignal.code"});case Ts.AVATAR_CLICKS_AVATAR:return s.jsx(bge,{});case Ts.COMMANDS:return s.jsx(vge,{});case Ts.KEYBOARD:return s.jsx(yge,{});case Ts.VAR_CHANGED:return s.jsx(Dge,{})}return null},lc=class lc{};lc.FURNI_VARIABLE=0,lc.USER_VARIABLE=1,lc.GLOBAL_VARIABLE=2,lc.CONTEXT_VARIABLE=3,lc.REFERENCE_VARIABLE=4,lc.ECHO_VARIABLE=5;let Gl=lc;const t_=a=>{const{mergedSelections:e=[new $r([0,0],"wiredfurni.params.sources.merged.title.variables")],save:t=null,children:i=null}=a,r=()=>t&&t();return s.jsx(e_,{wiredType:"variable",requiresFurni:ge.STUFF_SELECTION_OPTION_NONE,viewVariableInMenu:!0,hasSpecialInput:!1,advancedAlwaysVisible:!1,forceHidePickFurniInstructions:!1,mergedSources:!0,mergedSelections:e,save:r,children:i})},$N=a=>{const{hasValue:e=!1,setHasValue:t}=a;return s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.settings")}),s.jsx(x,{className:"flex-wrap col-10",column:!0,gap:2,children:s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"redOption",checked:e,onChange:i=>t(i.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.variables.settings.has_value")})]})})]})},jge=a=>{const{trigger:e,setIntParams:t,setStringParam:i}=le(),[r,n]=h.useState(""),[o,l]=h.useState(!1);h.useEffect(()=>{l(e.intData.length>0?e.intData[0]===1:!1),n(e.stringData)},[e]);const c=()=>{i(r),t([o?1:0])};return s.jsxs(t_,{save:c,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.variable_name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:u=>n(u.target.value)})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsx($N,{hasValue:o,setHasValue:l})]})},QN=a=>{const{options:e=[],optionSelected:t=0,setOptionSelected:i}=a;return e.length===0?null:s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.availability")}),e.map(r=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"availability",id:`availability-${r}`,checked:t===r,onChange:n=>i(r)}),s.jsx(T,{children:g(`wiredfurni.params.variables.availability.${r}`)})]},r))]})},Lge=a=>{const{trigger:e,setIntParams:t,setStringParam:i}=le(),[r,n]=h.useState(""),[o,l]=h.useState(!1),[c,u]=h.useState(1);h.useEffect(()=>{l(e.intData.length>0?e.intData[0]===1:!1),u(e.intData.length>1?e.intData[1]:0),n(e.stringData)},[e]);const d=()=>{i(r),t([o?1:0,c])};return s.jsxs(t_,{save:d,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.variable_name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:_=>n(_.target.value)})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsx($N,{hasValue:o,setHasValue:l}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsx(QN,{options:[1,10],optionSelected:c,setOptionSelected:u})]})},Pge=a=>{const{trigger:e,setIntParams:t,setStringParam:i}=le(),[r,n]=h.useState(""),[o,l]=h.useState(1),[c,u]=h.useState(0);h.useEffect(()=>{var _,m;l(e.intData.length>0?e.intData[0]:1),n(e.stringData),u(((m=(_=e.wiredContext)==null?void 0:_.globalVariableInfo)==null?void 0:m.value)||0)},[e]);const d=()=>{i(r),t([o])};return s.jsxs(t_,{save:d,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.variable_name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:_=>n(_.target.value)})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.inspection")}),s.jsx(T,{children:g("wiredfurni.params.variables.inspection.current_value",["value"],[c+""])})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsx(QN,{options:[1,10,11],optionSelected:o,setOptionSelected:l})]})},Uge=a=>{const{hasValue:e=!1,setHasValue:t}=a;return s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.settings")}),s.jsx(x,{className:"flex-wrap col-10",column:!0,gap:2,children:s.jsxs(x,{gap:1,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"redOption",checked:e,onChange:i=>t(i.target.checked)}),s.jsx(T,{children:g("wiredfurni.params.variables.settings.read_only")})]})})]})};function wge(a){return a.variableName.replace("@","").replace("~","").replace(/\./g,"_")}const Fge=a=>{const{trigger:e,setIntParams:t,setStringParam:i,setVariableIds:r}=le(),[n,o]=h.useState(""),[l,c]=h.useState(!1),[u,d]=h.useState(0),[_,m]=h.useState(0),f=p=>{var R,O,C;m(p);const S=(C=(O=(R=e.wiredContext)==null?void 0:R.roomVariablesList)==null?void 0:O.variables)==null?void 0:C.find(A=>A.variableId===p);S&&!n.length&&o(wge(S))};h.useEffect(()=>{c(e.intData.length>0?e.intData[0]===1:!1),d(e.intData.length>1?e.intData[1]:-1),o(e.stringData),m(e.variableIds.length>0?e.variableIds[0]:0)},[e]);const E=h.useMemo(()=>{const p=new Map,S=[];return e.wiredContext.referenceVariablesList.sharedVariables.forEach(R=>{if(p.has(R.roomId))return;const O={id:R.roomId,name:R.roomName};p.set(R.roomId,O),S.push(O)}),S.sort((R,O)=>R.name.localeCompare(O.name)),S},[e.wiredContext.referenceVariablesList.sharedVariables]),I=()=>{i(n),r([_]),t([l?1:0,u])};return s.jsxs(t_,{save:I,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.variable_name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:n,onChange:p=>o(p.target.value)})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.room_selection")}),s.jsxs("select",{className:"form-select form-select-sm",value:u,onChange:p=>d(parseInt(p.target.value)),children:[s.jsx("option",{value:-1,children:g("wiredfurni.params.variables.room_selection.tooltip")},-1),E.map((p,S)=>s.jsx("option",{value:p.id,children:p.name},S))]})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.variable_ref_selection")}),s.jsxs("select",{className:"form-select form-select-sm",value:_,onChange:p=>f(parseInt(p.target.value)),children:[s.jsx("option",{value:-1,children:g("wiredfurni.params.variables.variable_selection.tooltip")},-1),e.wiredContext.referenceVariablesList.sharedVariables.filter(p=>p.roomId===u).map((p,S)=>s.jsx("option",{value:p.wiredVariable.variableId,children:p.wiredVariable.variableName},S))]})]}),s.jsx(Uge,{hasValue:l,setHasValue:c})]})},kge=a=>{const{trigger:e,setIntParams:t,setStringParam:i}=le(),[r,n]=h.useState(""),[o,l]=h.useState(!1),[c,u]=h.useState(0);h.useEffect(()=>{l(e.intData.length>0?e.intData[0]===1:!1),u(e.intData.length>1?e.intData[1]:0),n(e.stringData)},[e]);const d=()=>{i(r),t([o?1:0,c])};return s.jsxs(t_,{save:d,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.variable_name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:_=>n(_.target.value)})]}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsx($N,{hasValue:o,setHasValue:l}),s.jsx("hr",{className:"m-0 bg-dark"}),s.jsx(QN,{options:[0,10,11],optionSelected:c,setOptionSelected:u})]})};function Gge(a){return a.variableName.replace("@","").replace("~","").replace(/\./g,"_")}const Bge=a=>{const{trigger:e,setIntParams:t,setStringParam:i,setVariableIds:r}=le(),[n,o]=h.useState(-1),[l,c]=h.useState(""),[u,d]=h.useState(qs.USER),_=f=>{var I,p,S;o(f);const E=(S=(p=(I=e.wiredContext)==null?void 0:I.roomVariablesList)==null?void 0:p.variables)==null?void 0:S.find(R=>R.variableId===f);E&&!l.length&&c(Gge(E))};h.useEffect(()=>{c(e.stringData),d(e.intData.length>0?e.intData[0]:qs.USER),o(e.variableIds[0]||-1)},[e]);const m=()=>{i(l),t([u]),r([n])};return s.jsx(t_,{save:m,children:s.jsxs(N,{gap:3,children:[s.jsxs(N,{gap:1,children:[s.jsx(T,{bold:!0,children:g("wiredfurni.params.variables.variable_name")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:l,onChange:f=>c(f.target.value)})]}),s.jsx(Er,{wiredVariableTypes:[0,1,-10,-20],type:u,setType:d,selectedVar:n,setSelectedVar:_,availabilityTypes:[21,100]})]})})},Vge=a=>{switch(a){case Gl.FURNI_VARIABLE:return s.jsx(Lge,{});case Gl.USER_VARIABLE:return s.jsx(kge,{});case Gl.GLOBAL_VARIABLE:return s.jsx(Pge,{});case Gl.CONTEXT_VARIABLE:return s.jsx(jge,{});case Gl.REFERENCE_VARIABLE:return s.jsx(Fge,{});case Gl.ECHO_VARIABLE:return s.jsx(Bge,{})}return null},Hge=a=>{const{trigger:e=null}=le();return e?e instanceof dC?cde(e.stuffTypeSelectionCode):e instanceof hC?Mge(e.stuffTypeSelectionCode):e instanceof _m?v_e(e.stuffTypeSelectionCode):e instanceof _C?tge(e.stuffTypeSelectionCode):e instanceof gC?yde(e.stuffTypeSelectionCode):e instanceof LC?Vge(e.stuffTypeSelectionCode):null:null},VB=({type:a,selected:e=!1,onSelected:t})=>{const i=()=>{e||t(a)};return s.jsx("div",{className:kV("variable-type-button",`variable-type-button-${a}`,{selected:e}),onClick:i})},fd=class fd{};fd.FURNI_SOURCE=0,fd.USER_SOURCE=1,fd.GLOBAL_SOURCE=-10,fd.CONTEXT_SOURCE=-20;let Pn=fd;const xS=500,Wge=500;function My(a,e){if(!a.hasValue)return null;if(e==2147483647||e==-2147483648)return"Hidden";const i=Yge(a,e);return String(e)+(i==null?"":" ("+i+")")}function Yge(a,e){const t=a.textConnector;return t==null?null:t.getValue(e)}const zge=a=>{const e=["furni","user","global"],[t,i]=h.useState(0),[r,n]=h.useState(null),[o,l]=h.useState(null),[c,u]=h.useState({}),[d,_]=h.useState({}),[m,f]=h.useState(0),E=h.useRef(null),{hasWritePermission:I,setJumpToInspectUser:p,setJumpToInspectFurni:S,jumpingToInspectId:R}=Tn(),{getAllVariables:O,removeListener:C,sortVariables:A}=jT(),[b,y]=h.useState(!1),{roomSession:M}=vt(),[U,G]=h.useState("furni"),[F,H]=h.useState(null),v=ae=>{const Te=ae.split(" "),Se=[];for(const Le in Te)Se.push(Te[Le].charAt(0).toUpperCase()+Te[Le].slice(1));return Se.join(" ")},B=(ae,Te)=>{if(Te==Ls.INTERNAL||Te==Ls.SMART)return ae;const Se=ae.split("_").join(" ").replace("."," -> ");return v(Se)},z=()=>{_(ae=>{for(const Te of Object.values(ae))clearTimeout(Te);return{}})},$=ae=>{G(ae),n(null),l(null),f(-9999),u({}),z(),E.current&&clearInterval(E.current),ae==="global"&&ie(Pn.GLOBAL_SOURCE,0)},W=ae=>{switch(ae){case"furni":return"Selecione um furni.";case"user":return"Selecione um usuário.";default:return""}},V=h.useCallback(ae=>{if(!ae||ae.length===0)return;const Te={};for(const Se of ae)Te[Se.variableId]=Se;u(Se=>({...Se,...Te}))},[]),se=h.useCallback(()=>{if(!r)return!1;for(const ae of r.variableValues.getKeys())if(!(ae in c))return!1;return!0},[r,c]),ee=h.useCallback(ae=>{const Te=ae.getParser();if(!Te||!Te.data)return;const Se=Te.data;if(Se.type===Pn.FURNI_SOURCE&&U==="furni"||Se.type===Pn.USER_SOURCE&&U==="user"||Se.type===Pn.GLOBAL_SOURCE&&U==="global"){if(r)for(const Et of Se.variableValues.getKeys()){const ri=Number(Et);r.variableValues.getValue(Et)!==Se.variableValues.getValue(Et)&&_(ni=>{ni[ri]&&clearTimeout(ni[ri]);const gt=setTimeout(()=>{_(yt=>{const{[ri]:ws,...Jn}=yt;return Jn})},Wge);return{...ni,[ri]:gt}})}n(Se),se()||O(V)}},[U,r,se,O,V]);J(Yk,ee);const ie=h.useCallback((ae,Te)=>{performance.now()-t>xS&&(i(performance.now()),K(new eF(ae,Te)))},[i,t]),Z=h.useCallback(()=>r?r.type===Pn.USER_SOURCE?r.userIndex:r.type===Pn.FURNI_SOURCE?r.objectId:0:0,[r]),ne=(ae,Te)=>{if(!o||!o.hasValue||!o.canWriteValue)return;const Se=parseInt(Te,10);isNaN(Se)||K(new tF(o.variableTarget,Z(),o.variableId,Se))},_e=h.useCallback((ae,Te=!1)=>{if(U!=="furni"&&!Te)return;Te&&y(!0);const Se=U==="furni";if(Te&&!Se)G("furni");else if(!Se)return;r&&r.objectId===ae||ie(Pn.FURNI_SOURCE,ae)},[U,r,ie]),de=h.useCallback((ae,Te=!1)=>{if(U!=="user"&&!Te)return;Te&&y(!0);const Se=U==="user";if(Te&&!Se)G("user");else if(!Se)return;r&&r.userIndex===ae||ie(Pn.USER_SOURCE,ae)},[U,r,ie]);h.useEffect(()=>{let ae=!1,Te=!1;S(Se=>(ae=Se,!1)),p(Se=>(Te=Se,!1)),ae?(_e(R,!0),f(R)):Te&&(de(R,!0),f(R))},[_e,de,R,S,p]),Sm(ae=>{if(!(!ae||b&&m>0)&&ae.id!==m&&U!=="global"){if(z(),ae.category===Q.FLOOR&&U==="furni"){const Te=ce().getRoomObject(M.roomId,ae.id,ae.category);Te&&(_e(Te.id),f(Te.id))}else if(ae.category===Q.UNIT&&U==="user"){const Te=ce().getRoomObject(M.roomId,ae.id,ae.category);Te&&(de(Te.id),f(Te.id))}}}),YG(ae=>{!ae||b||U==="global"||ae.id===m&&(n(null),l(null),f(0),z())}),h.useEffect(()=>()=>{z()},[]),h.useEffect(()=>(E.current&&clearInterval(E.current),r||U==="global"?E.current=setInterval(()=>{performance.now()-t>xS&&(U==="global"?ie(Pn.GLOBAL_SOURCE,0):r&&ie(r.type,Z()))},xS):E.current&&clearInterval(E.current),()=>{E.current&&clearInterval(E.current)}),[U,b,r,t,Z,ie]);const me=h.useMemo(()=>!r||!se()?[]:A(r.variableValues.getKeys().map(ae=>c[ae]).filter(ae=>ae&&!ae.isInvisible&&ae.hasValue)),[r,c,se,A]),fe=h.useMemo(()=>{if(U==="global")return s.jsx("div",{className:"global-image-placeholder"});if(!M)return null;const ae=ce();if(!ae)return null;if(U=="furni"){let Te=0,Se=m;Se>=0?Te=10:(Se=-m,Te=20);const Le=new Y(180),Et=ae.getRoomObjectImage(M.roomId,Se,Te,Le,64,null);return Et&&Et.data?s.jsx(x,{className:"inspection-object",gap:2,alignItems:"center",children:s.jsx("img",{className:"d-block mx-auto",src:Et.getImage().src})}):null}else{const Te=M.userDataManager.getUserDataByIndex(m);if(!Te)return null;const Se=Te.type-1===1;return s.jsx(x,{className:"inspection-object",gap:2,alignItems:"center",children:Se?s.jsx(Fn,{figure:Te.figure,direction:2}):s.jsx(ls,{figure:Te.figure,direction:2})})}},[U,m,M]);return s.jsx(s.Fragment,{children:s.jsxs(x,{children:[s.jsxs(x,{column:!0,gap:3,fullWidth:!0,children:[s.jsxs(x,{column:!0,gap:2,children:[s.jsx(T,{bold:!0,children:"Tipo de variáveis:"}),s.jsx(x,{gap:3,className:"variable-types",children:e.map((ae,Te)=>s.jsx(VB,{type:ae,onSelected:$,selected:ae===U},Te))})]}),s.jsxs(x,{column:!0,gap:2,children:[s.jsx(T,{bold:!0,children:"Visualizar:"}),s.jsx("div",{className:"d-flex inspection-preview",children:fe??s.jsx(T,{className:"inspection-text",children:W(U)})})]}),s.jsx(x,{column:!0,gap:2,children:s.jsxs(x,{gap:2,alignItems:"center",children:[s.jsx("input",{className:"form-check-input",type:"checkbox",id:"keep-selected",checked:b,onChange:ae=>y(ae.target.checked)}),s.jsx(T,{children:"Manter furni/user selecionado"})]})})]}),s.jsx(x,{column:!0,gap:2,fullWidth:!0,children:s.jsxs(x,{column:!0,gap:2,children:[s.jsx(T,{bold:!0,children:"Variáveis:"}),s.jsx(x,{className:"wired-table",children:s.jsx("table",{style:{tableLayout:"inherit"},children:s.jsxs("tbody",{children:[s.jsxs("tr",{children:[s.jsx("th",{children:"Variável"}),s.jsx("th",{children:"Valor"})]}),me.length>0&&me.map((ae,Te)=>s.jsxs("tr",{children:[s.jsx("td",{style:{textAlign:"left"},children:s.jsx(cc,{trigger:["hover","focus"],placement:"bottom",overlay:s.jsx(Wc,{children:s.jsx(T,{variant:"white",bold:!0,children:B(ae.variableName,ae.availabilityType)})}),children:s.jsx("span",{children:B(ae.variableName,ae.availabilityType)})})}),s.jsx("td",{className:`${d[ae.variableId]?"highlight":"normal"}`,onBlur:Se=>l(null),onDoubleClick:Se=>{!I||!ae.canWriteValue||(l(ae),H(String(r.variableValues.getValue(ae.variableId.toString()))))},children:s.jsx("span",{style:{color:My(ae,r.variableValues.getValue(ae.variableId.toString()))==="Hidden"?"red":""},children:o==ae?s.jsx("input",{type:"number",className:"form-control",defaultValue:String(r.variableValues.getValue(ae.variableId.toString())),value:F,onChange:Se=>H(Se.target.value),onKeyDown:Se=>{Se.key==="Enter"&&(ne(ae.variableName,F),l(null))},autoFocus:!0}):My(ae,r.variableValues.getValue(ae.variableId.toString()))})})]},Te))]})})})]})})]},U)})},jy=500,Ly="ff5733",Kge="BD7800",a_="008000",qge=.3,Xge=.7,Py=.6,Uy=.85,$ge=.5,Qge=.8,Jge=a=>{const[e,t]=h.useState(null),[i,r]=h.useState(null),n=h.useRef(null),[o,l]=h.useState(0),[c,u]=h.useState(null),[d,_]=h.useState(null);h.useEffect(()=>(n.current=setInterval(()=>{Date.now()-o<jy||(l(Date.now()),K(new rF),K(new sF))},jy),()=>{n.current&&clearInterval(n.current)}),[]),J(Xk,O=>{const C=O.getParser();C&&t(C.roomStats)}),J(zk,O=>{const C=O.getParser();C&&r(C.errors)});const m=(O,C,A,b,y)=>{const M=(O-C)/(A-C);return M<b?a_:M<y?Kge:Ly},f=h.useCallback(()=>m(e.executionCost,0,e.executionCostCap,qge,Xge),[e]),E=h.useCallback(()=>m(e.floorItemCount,0,e.floorItemCap,Py,Uy),[e]),I=h.useCallback(()=>m(e.wallItemCount,0,e.wallItemCap,Py,Uy),[e]),p=(O,C)=>m(O,0,C,$ge,Qge),S=h.useCallback(()=>{for(const O of i||[])if(O.throwCount>0)return!0;return!1},[i]),R=h.useCallback(()=>e?e.isHeavy||f()!=a_||E()!=a_||I()!=a_?!0:S():!1,[e,f,E,I,S]);return s.jsxs(s.Fragment,{children:[s.jsxs(x,{column:!0,justifyContent:"between",fullWidth:!0,fullHeight:!0,children:[s.jsxs(x,{gap:4,children:[s.jsx(x,{column:!0,gap:2,fullWidth:!0,children:s.jsxs(x,{column:!0,gap:2,children:[s.jsx(T,{bold:!0,children:"Estatísticas do Quarto:"}),s.jsx(x,{column:!0,className:"bg-gray",style:{width:"200px",height:"100px"},children:e&&s.jsxs(x,{column:!0,gap:2,overflow:"auto",className:"m-1",children:[s.jsxs(x,{gap:1,children:[s.jsx(T,{children:"Wireds em Uso:"}),s.jsxs(T,{variant:"none",style:{color:`#${f()}`},children:[e.executionCost," / ",e.executionCostCap]})]}),s.jsxs(x,{gap:1,children:[s.jsx(T,{children:"Sobrecarregado:"}),s.jsx(T,{variant:"none",style:{color:`#${e.isHeavy?Ly:a_}`},children:e.isHeavy?"Sim":"Não"})]}),s.jsxs(x,{gap:1,children:[s.jsx(T,{children:"Mobis de Chão:"}),s.jsxs(T,{variant:"none",style:{color:`#${E()}`},children:[e.floorItemCount," / ",e.floorItemCap]})]}),s.jsxs(x,{gap:1,children:[s.jsx(T,{children:"Mobis de Parede:"}),s.jsxs(T,{variant:"none",style:{color:`#${I()}`},children:[e.wallItemCount," / ",e.wallItemCap]})]}),s.jsxs(x,{gap:1,children:[s.jsx(T,{children:"Permanentes Furni:"}),s.jsxs(T,{variant:"none",style:{color:`#${p(e.permanentFurniVariables,e.maxPermanentFurniVariables)}`},children:[e.permanentFurniVariables," / ",e.maxPermanentFurniVariables]})]}),s.jsxs(x,{gap:1,children:[s.jsx(T,{children:"Permanentes User:"}),s.jsxs(T,{variant:"none",style:{color:`#${p(e.permanentUserVariables,e.maxPermanentUserVariables)}`},children:[e.permanentUserVariables," / ",e.maxPermanentUserVariables]})]}),s.jsxs(x,{gap:1,children:[s.jsx(T,{children:"Permanentes Global:"}),s.jsxs(T,{variant:"none",style:{color:`#${p(e.permanentGlobalVariables,e.maxPermanentGlobalVariables)}`},children:[e.permanentGlobalVariables," / ",e.maxPermanentGlobalVariables]})]})]})})]})}),s.jsx(x,{column:!0,gap:3,fullWidth:!0,children:s.jsxs(x,{alignItems:"center",justifyContent:"center",children:[R()&&s.jsx("div",{className:"d-block mx-auto franking-panicking"}),!R()&&s.jsx("div",{className:"franking"})]})})]}),s.jsxs(x,{column:!0,gap:2,children:[s.jsxs(x,{column:!0,gap:2,children:[s.jsx(T,{bold:!0,children:"Logs:"}),s.jsx(x,{className:"wired-table logs",style:{maxHeight:"160px"},children:s.jsx("table",{style:{tableLayout:"inherit"},children:s.jsxs("tbody",{children:[s.jsxs("tr",{children:[s.jsx("th",{style:{textAlign:"center"},children:"Tipo"}),s.jsx("th",{style:{textAlign:"center"},children:"Categoria"}),s.jsx("th",{style:{textAlign:"center"},children:"Quantidade"}),s.jsx("th",{style:{textAlign:"center"},children:"Última Ocorrência"})]}),i&&i.map((O,C)=>s.jsxs("tr",{style:{backgroundColor:d===C?"rgba(183,224,250,0.8)":""},onClick:()=>_(C),children:[s.jsx("td",{style:{textAlign:"center",textDecoration:"underline",color:"blue",cursor:"pointer"},onClick:()=>u(O),children:O.errorName}),s.jsx("td",{style:{textAlign:"center"},children:O.category}),s.jsx("td",{style:{textAlign:"center"},children:O.throwCount}),s.jsx("td",{style:{textAlign:"center"},children:O.msSinceLastOccurrence&&O.msSinceLastOccurrence>0?new Date(O.msSinceLastOccurrence).toLocaleString():"N/A"})]},C)),(!i||!i.length)&&s.jsx("tr",{children:s.jsx("td",{colSpan:4,style:{textAlign:"center"},children:"Nada para mostrar."})})]})})})]}),s.jsx(x,{justifyContent:"center",className:`text-button ${S()?"":"disabled"}`,style:{alignSelf:"end"},children:s.jsx(T,{children:"Limpar tudo"})})]})]},"wired-creator-tools-monitor-view"),c&&s.jsxs(ve,{uniqueKey:"nitro-wired-creator-tool-error",className:"nitro-wired-creator-tool-error no-resize",children:[s.jsx(je,{headerText:g("navigator.wiredmenu.error_info"),onCloseClick:()=>u(null)}),s.jsx(be,{className:"p-2",children:s.jsxs(x,{column:!0,gap:2,fullWidth:!0,children:[s.jsxs(x,{alignItems:"center",justifyContent:"center",children:[s.jsx(x,{fullWidth:!0,justifyContent:"center",alignItems:"center",children:s.jsx(T,{bold:!0,children:c.errorName})}),s.jsx(x,{className:`wired-${c.category.toLowerCase()}`})]}),s.jsx(x,{column:!0,gap:1,alignItems:"center",justifyContent:"center",className:"p-1",children:s.jsx(T,{align:"start",dangerouslySetInnerHTML:{__html:g("wiredmenu.error_info."+c.errorId.toString()).replaceAll("\\n","<br/>")}})})]})})]})]})},Zge=[1,2,3],eme=[0,1,2,3],tme=["UTC","America/Sao_Paulo","Europe/Paris"],sme=()=>{const[a,e]=h.useState(10),[t,i]=h.useState(10),[r,n]=h.useState("UTC"),{wiredInspectButton:o,wiredMenuButton:l,playTestMode:c,variableSyntaxMode:u,sendPreferences:d,setWiredInspectButton:_,setWiredMenuButton:m,setVariableSyntaxMode:f,switchPlayTestMode:E}=Tn(),I=(C,A,b)=>b?C|1<<A:C&~(1<<A),p=h.useCallback((C,A,b)=>{K(new aF(C,A,b))},[]),S=(C,A)=>{e(b=>{const y=I(b,C,A);return p(y,t,r),y})},R=(C,A)=>{i(b=>{const y=I(b,C,A);return p(a,y,r),y})},O=C=>{n(A=>A===C?A:(p(a,t,C),C))};return J(qk,C=>{const A=C.getParser();A&&(e(A.modifyPermissionMask),i(A.readPermissionMask),n(A.timezone))}),h.useEffect(()=>{K(new iF)},[]),h.useEffect(()=>{d()},[o,l,c,u]),s.jsxs(x,{column:!0,children:[s.jsx(x,{column:!0,gap:3,fullWidth:!0,children:s.jsxs(x,{column:!0,gap:2,children:[s.jsx(T,{bold:!0,children:"Configurações do Quarto:"}),s.jsxs(x,{fullWidth:!0,gap:4,children:[s.jsxs(x,{column:!0,gap:1,className:"bg-gray p-3",style:{width:"225px",height:"120px"},children:[s.jsx(T,{bold:!0,className:"mb-1",children:"Quem pode modificar os Wireds:"}),Zge.map(C=>s.jsxs(x,{gap:2,children:[s.jsx("input",{type:"checkbox",className:"form-check-input",checked:(a&1<<C)!==0,onChange:A=>S(C,A.target.checked)},C),s.jsx(T,{children:g(`modifiy_${C}_checkbox`)})]},C))]}),s.jsxs(x,{column:!0,gap:1,className:"bg-gray p-3",style:{width:"225px",height:"120px"},children:[s.jsx(T,{bold:!0,className:"mb-1",children:"Quem pode Inspecionar os Wireds:"}),eme.map(C=>s.jsxs(x,{gap:2,children:[s.jsx("input",{type:"checkbox",className:"form-check-input",checked:(t&1<<C)!==0,onChange:A=>R(C,A.target.checked)},C),s.jsx(T,{children:g(`read_${C}_checkbox`)})]},C))]})]})]})}),s.jsxs(x,{column:!0,gap:1,className:"bg-gray p-2 mt-4",style:{width:"225px"},children:[s.jsx(T,{bold:!0,className:"mb-1",children:"Fuso Horário:"}),s.jsx("select",{className:"form-select form-select-sm",value:r,onChange:C=>O(C.target.value),children:tme.map(C=>s.jsx("option",{value:C,children:C},C))})]}),s.jsxs(x,{column:!0,gap:2,className:"mt-4",children:[s.jsx(T,{bold:!0,children:"Preferências:"}),s.jsxs(x,{column:!0,gap:1,className:"bg-gray p-2",fullWidth:!0,children:[s.jsxs(x,{gap:2,children:[s.jsx("input",{type:"checkbox",className:"form-check-input",checked:l,onChange:C=>m(C.target.checked)},0),s.jsx(T,{children:g("wiredcreatortools.settings.wired_menu_button")})]},0),s.jsxs(x,{gap:2,children:[s.jsx("input",{type:"checkbox",className:"form-check-input",checked:o,onChange:C=>_(C.target.checked)},1),s.jsx(T,{children:g("wiredcreatortools.settings.wired_inspect_button")})]},1),s.jsxs(x,{gap:2,children:[s.jsx("input",{type:"checkbox",className:"form-check-input",checked:c,onChange:C=>E(C.target.checked,!0,!0)},2),s.jsx(T,{children:g("wiredcreatortools.settings.play_test_mode")})]},2),s.jsxs(x,{gap:2,children:[s.jsx("input",{type:"checkbox",className:"form-check-input",checked:u===1,onChange:C=>f(C.target.checked?1:0)},3),s.jsx(T,{children:g("wiredcreatortools.settings.variable_syntax_mode")})]},3)]})]})]},"wired-creator-tools-settings-view")},yu=class yu{static highlightFurni(e,t){const i=this.getRoomObject(e,!1);!i||this._furniMap.get(e)===t||(this._furniMap.set(e,t),this.addFiltersToObject(i,this._filters))}static highlightUser(e,t){const i=this.getRoomObject(e,!0);if(!i||this._userMap.get(e)===t)return;this._userMap.set(e,t);const n=i.model;n&&n.setValue("figure_highlight_variable_holder",1)}static removeMissing(e,t){for(const[i]of this._furniMap)if(!e.includes(i)){const r=this.getRoomObject(i,!1);r&&this.removeFiltersFromObject(r,this._filters),this._furniMap.delete(i)}for(const[i]of this._userMap)if(!t.includes(i)){const r=this.getRoomObject(i,!0);if(r){const n=r.model;n&&n.setValue("figure_highlight_variable_holder",0)}this._userMap.delete(i)}}static addFiltersToObject(e,t){this._matrix.matrix=[.9,0,0,0,0,0,1,0,0,40,0,0,1,0,80,0,0,0,.85,0],this._filters=[this._matrix,this._glow];const i=e.visualization;if(!i)return;const r=i.filters||[];i.filters=t.concat(r)}static removeFiltersFromObject(e,t){const i=e.visualization;!i||!i.filters||(i.filters=i.filters.filter(r=>!t.includes(r)))}static getRoomObject(e,t){const i=ce();if(!i)return null;const r=t?Q.UNIT:e<0?Q.WALL:Q.FLOOR;return i.getRoomObject(i.activeRoomId,Math.abs(e),r)}static onRoomObjectRemoved(e){if(!e)return;const t=e.objectId;e.category===Q.UNIT?this._userMap.delete(t):this._furniMap.delete(t)}static clear(){this.removeMissing([],[])}static get furniMap(){return this._furniMap}static get userMap(){return this._userMap}};yu._glow=new iC({color:12318714,outerStrength:1,innerStrength:1,distance:4,quality:1,knockout:!1}),yu._matrix=new Yc,yu._filters=[],yu._furniMap=new Map,yu._userMap=new Map;let ar=yu;const Zm=500,ime=1e3,rme=400,nme=400,ame=["name","type","target","availability","has_value","can_write_to","can_create_delete","can_intercept","is_always_available","can_read_creation_time","can_read_last_update_time","is_text_connected"];function ome(a){return g("wiredfurni.params.variables.idtype."+a.variableType)}function lme(a){switch(a.variableTarget){case qs.FURNI:return g("wiredfurni.params.sourcetype.furni");case qs.USER:return g("wiredfurni.params.sourcetype.users");case qs.GLOBAL:return g("wiredfurni.params.sourcetype.global");case qs.CONTEXT:return g("wiredfurni.params.sourcetype.context");default:return""}}function cme(a){return g("wiredfurni.params.variables.availability."+a.availabilityType)}function ef(a,e){if(!a.hasValue)return null;if(e==2147483647||e==-2147483648)return"Hidden";const i=ume(a,e);return String(e)+(i==null?"":" ("+i+")")}function ume(a,e){const t=a.textConnector;return t==null?null:t.getValue(e)}const hme=a=>{const e=["furni","user","global","context"],[t,i]=h.useState(0),[r,n]=h.useState(0),[o,l]=h.useState(!1),[c,u]=h.useState(!1),[d,_]=h.useState([]),[m,f]=h.useState(null),E=h.useRef(null),I=h.useRef(null),{setJumpToVariableByName:p,jumpToVariableByName:S,jumpingVariableName:R,variableSyntaxMode:O}=Tn(),{getAllVariables:C,removeListener:A,setObjectsIdAndValue:b,setIsFurniHolders:y}=jT(),[M,U]=h.useState("furni"),G=V=>{const se=V.split(" "),ee=[];for(const ie in se)ee.push(se[ie].charAt(0).toUpperCase()+se[ie].slice(1));return ee.join(" ")},F=(V,se)=>{if(se==Ls.INTERNAL||se==Ls.SMART)return V;const ee=V.split("_").join(" ").replace("."," -> ");return G(ee)},H=V=>{U(V)},v=h.useCallback(V=>{_(V)},[]);h.useEffect(()=>(C(v),()=>{A(v),b(new Map),ar.clear()}),[]);const B=h.useCallback((V=null)=>V!=null&&V.variableType!==Ls.INTERNAL&&(V.variableTarget===qs.USER||V.variableTarget===qs.FURNI),[]),z=h.useCallback(V=>{f(V),c&&(ar.clear(),b(new Map),requestAnimationFrame(()=>{B(V)&&K(new sf(V.variableId))}))},[B,c,b]);h.useEffect(()=>(E.current&&clearInterval(E.current),I.current&&clearInterval(I.current),E.current=setInterval(()=>{const V=Date.now();V-t>Zm&&(i(V),C(v))},Zm),I.current=setInterval(()=>{if(!o||!B(m)){c&&(ar.clear(),b(new Map),u(!1));return}const V=Date.now();V-r>Zm&&(n(V),K(new sf(m.variableId)))},Zm),()=>{E.current&&clearInterval(E.current),I.current&&clearInterval(I.current)}),[B,C,o,c,t,r,v,m,b]);const $=h.useMemo(()=>!d||d.length===0?[]:d.filter(V=>{if(V.isInvisible)return!1;switch(M){case"furni":return V.variableTarget===qs.FURNI;case"user":return V.variableTarget===qs.USER;case"global":return V.variableTarget===qs.GLOBAL;case"context":return V.variableTarget===qs.CONTEXT;default:return!1}}).sort((V,se)=>V.variableName.startsWith("@")&&!se.variableName.startsWith("@")?1:!V.variableName.startsWith("@")&&se.variableName.startsWith("@")?-1:0),[d,M]);h.useEffect(()=>{f(V=>V==null||!$.some(se=>se.variableId===V.variableId)?$[0]:V)},[$]);const W=h.useCallback(V=>{if(!m)return"";switch(V){case"name":return m.variableName;case"type":return ome(m);case"target":return lme(m);case"availability":return cme(m);case"has_value":return m.hasValue?"Sim":"Não";case"can_write_to":return m.canWriteValue?"Sim":"Não";case"can_create_delete":return m.canCreateAndDelete?"Sim":"Não";case"can_intercept":return m.canInterceptChanges?"Sim":"Não";case"is_always_available":return m.alwaysAvailable?"Sim":"Não";case"can_read_creation_time":return m.canReadCreationTime?"Sim":"Não";case"can_read_last_update_time":return m.canReadLastUpdateTime?"Sim":"Não";case"is_text_connected":return m.hasTextConnector?"Sim":"Não";default:return""}},[m]);return J(Wk,V=>{const se=V.getParser();if(!se)return;if(se.variableInfoAndHolders.variable.variableId!=(m==null?void 0:m.variableId)||!o||!B(m)){c&&(!o||!B(m))&&(ar.clear(),b(new Map),u(!1));return}const ee=se.variableInfoAndHolders.variable,ie=se.variableInfoAndHolders.holders;if(!ee.hasValue&&ie.length>ime||ee.hasValue&&ie.length>rme)return;const Z=[],ne=[];for(const _e of ie){const de=_e.objectId,me=ee.hasValue?_e.value:NaN;if(ee.variableTarget==qs.FURNI){if(ef(ee,me)==="Hidden")continue;ar.highlightFurni(de,ef(ee,me)),ne.push(de)}else if(ee.variableTarget==qs.USER){if(ef(ee,me)==="Hidden")continue;ar.highlightUser(de,ef(ee,me)),Z.push(de)}}ar.removeMissing(ne,Z),u(!0),m.variableTarget===qs.FURNI?(b(_e=>{const de=new Map;for(const me of ar.furniMap){const fe=me[0],ae=me[1];ae==="Hidden"||!m.hasValue||de.set(fe,ae)}return de}),y(!0)):m.variableTarget===qs.USER?(b(_e=>{const de=new Map;for(const me of ar.userMap){const fe=me[0],ae=me[1];ae==="Hidden"||!m.hasValue||de.set(fe,ae)}return de}),y(!1)):b(new Map)}),ut(ke.REMOVED,V=>{V.type===ke.REMOVED&&(ar.onRoomObjectRemoved(V),m&&(m.variableTarget===qs.FURNI?(b(ar.furniMap),y(!0)):m.variableTarget===qs.USER&&(b(ar.userMap),y(!1))))}),h.useEffect(()=>{b(new Map),ar.clear()},[M,b]),h.useEffect(()=>{m||(ar.clear(),b(new Map))},[m,b]),h.useEffect(()=>{if(!S||!R||!d||!d.length)return;const V=d.find(se=>se.variableName===R);if(V){switch(V.variableTarget){case qs.FURNI:U("furni");break;case qs.USER:U("user");break;case qs.GLOBAL:U("global");break;case qs.CONTEXT:U("context");break}z(V),f(V),p(!1)}else f(null),p(!1)},[S,R,z,p,d]),s.jsxs(x,{children:[s.jsxs(x,{column:!0,gap:3,fullWidth:!0,children:[s.jsxs(x,{column:!0,gap:2,children:[s.jsx(T,{bold:!0,children:"Tipo de variáveis:"}),s.jsx(x,{gap:3,className:"variable-types",children:e.map((V,se)=>s.jsx(VB,{type:V,onSelected:H,selected:V===M},se))})]}),s.jsxs(x,{column:!0,gap:2,children:[s.jsx(T,{bold:!0,children:"Seletor de variáveis:"}),s.jsxs(x,{className:"wired-table",style:{maxWidth:"190px",maxHeight:"220px"},children:[$.length===0&&s.jsx(x,{fullWidth:!0,fullHeight:!0,justifyContent:"center",alignItems:"center",children:s.jsx(T,{align:"center",children:"Nada para mostrar"})}),$.length>0&&s.jsx("table",{children:s.jsxs("tbody",{children:[s.jsx("tr",{}),$.map((V,se)=>s.jsx("tr",{style:{backgroundColor:`${V===m?"rgb(184, 226, 252)":""}`},onClick:ee=>z(V),children:s.jsx("td",{style:{textAlign:"left"},children:s.jsx(cc,{trigger:["hover","focus"],placement:"bottom",overlay:s.jsx(Wc,{children:s.jsx(T,{variant:"white",bold:!0,children:F(V.variableName,V.variableType)})}),children:s.jsx("span",{children:F(V.variableName,V.variableType)})})})},se))]})})]}),s.jsxs("div",{className:`text-button ${B(m)?"":"disabled"}`,onClick:V=>{l(!o),o?(ar.clear(),b(new Map),u(!1)):B(m)&&K(new sf(m.variableId))},children:[o&&s.jsx(T,{children:"Remover"}),!o&&s.jsx(T,{children:"Destacar"})]})]})]}),s.jsxs(x,{column:!0,gap:2,children:[s.jsxs(x,{column:!0,gap:2,children:[s.jsx(T,{bold:!0,children:"Propriedades:"}),s.jsx(x,{className:"wired-table",style:{maxHeight:"185px"},children:s.jsx("table",{children:s.jsxs("tbody",{children:[s.jsxs("tr",{children:[s.jsx("th",{style:{textAlign:"left"},children:"Propriedades"}),s.jsx("th",{style:{textAlign:"left"},children:"Texto"})]}),m!=null&&ame.map((V,se)=>s.jsxs("tr",{children:[s.jsx("td",{style:{textAlign:"left"},children:s.jsx(cc,{trigger:["hover","focus"],placement:"bottom",overlay:s.jsx(Wc,{children:s.jsx(T,{variant:"white",bold:!0,children:Oe().getLocalizationOrDefault("wiredmenu.variable_overview.properties."+V,V)})}),children:s.jsx("span",{children:Oe().getLocalizationOrDefault("wiredmenu.variable_overview.properties."+V,V)})})}),s.jsx("td",{style:{textAlign:"left"},children:s.jsx(cc,{trigger:["hover","focus"],placement:"bottom",overlay:s.jsx(Wc,{children:s.jsx(T,{variant:"white",bold:!0,children:W(V)})}),children:s.jsx("span",{children:W(V)})})})]},se))]})})})]}),s.jsxs(x,{column:!0,gap:2,children:[s.jsx(T,{bold:!0,children:"Valores de texto:"}),s.jsx(x,{className:"wired-table",style:{maxHeight:"124px"},children:s.jsx("table",{children:s.jsxs("tbody",{children:[s.jsxs("tr",{children:[s.jsx("th",{style:{textAlign:"left"},children:"Valor"}),s.jsx("th",{style:{textAlign:"right"},children:"Texto"})]}),m&&m.hasTextConnector&&m.textConnector.length>0&&[...m.textConnector.getKeys()].slice(0,nme).map(V=>s.jsxs("tr",{children:[s.jsx("td",{style:{textAlign:"left"},children:s.jsx(cc,{trigger:["hover","focus"],placement:"bottom",overlay:s.jsx(Wc,{children:s.jsx(T,{variant:"white",bold:!0,children:V})}),children:s.jsx("span",{children:V})})}),s.jsx("td",{style:{textAlign:"right"},children:s.jsx(cc,{trigger:["hover","focus"],placement:"bottom",overlay:s.jsx(Wc,{children:s.jsx(T,{variant:"white",bold:!0,children:m.textConnector.getValue(V)})}),children:s.jsx("span",{children:m.textConnector.getValue(V)})})})]},V))]})})})]})]})]},M)},dme=a=>{const[e,t]=h.useState(!1),{currentTab:i,setCurrentTab:r,isRoomOwnerOrStaff:n,isEnabled:o,hasReadPermission:l,hasWritePermission:c}=Tn(),{setJumpToVariableByName:u,setJumpingVariableName:d,setJumpToInspectFurni:_,setJumpToInspectUser:m,setJumpingToInspectId:f}=Tn(),{roomSession:E}=vt(),I=()=>{t(!1)};h.useEffect(()=>{I()},[E]),h.useEffect(()=>{const S={linkReceived:R=>{const O=R.split("/");if(!(O.length<2))switch(O[1]){case"open":if(O.length>=3){const C=Xo.find(A=>A.includes(O[2]));if(!C){t(!1);return}if(r(C),t(!0),C===Xo[1]){const A=O[3];if(!A)return;u(!0),d(A)}if(C===Xo[2]){const A=parseInt(O[4],10);if(isNaN(A))return;O[3]===String(Pn.USER_SOURCE)?(m(!0),_(!1),f(A)):O[3]===String(Pn.FURNI_SOURCE)&&(_(!0),m(!1),f(A))}}else t(C=>!C);break}},eventUrlPrefix:"wiredmenu/"};return fs(S),()=>ps(S)},[]);const p=h.useCallback(S=>{switch(S){case"navigator.wiredcreatortools.tab.1":return g("wiredcreatortools.monitor.title");case"navigator.wiredcreatortools.tab.2":return g("wiredcreatortools.variables.title");case"navigator.wiredcreatortools.tab.3":return g("wiredcreatortools.inspection.title");case"navigator.wiredcreatortools.tab.4":return g("wiredcreatortools.settings.title");default:return""}},[]);return!e||!o()||!l()&&!c()?null:s.jsxs(ve,{uniqueKey:"nitro-wired-creator-tool",className:"nitro-wired-creator-tool",children:[s.jsx(je,{headerText:g("navigator.wiredcreatortools"),onCloseClick:I}),s.jsx($n,{children:Xo.map(S=>s.jsx(In,{isActive:i===S,onClick:R=>r(S),children:g(S)},S))}),s.jsx("div",{className:"wiredcreatortool-header",children:s.jsx("div",{className:"wiredcreatortool-title",children:s.jsx("div",{className:"d-inline text-white",children:p(i)})})}),s.jsx(be,{children:s.jsxs("div",{className:"wiredcreatortool-tab-content",children:[i===Xo[0]&&s.jsx(Jge,{}),i===Xo[1]&&s.jsx(hme,{}),i===Xo[2]&&s.jsx(zge,{}),i===Xo[3]&&s.jsx(sme,{})]})})]})},_me=a=>{const{close:e}=a,[t,i]=h.useState(1),[r,n]=h.useState(0),[o,l]=h.useState(0),[c,u]=h.useState(0),[d,_]=h.useState(0),[m,f]=h.useState(0),[E,I]=h.useState([]),[p,S]=h.useState(""),R=h.useRef(0),O=h.useRef(null),C=h.useRef(p),{avatarInfo:A}=FN();h.useEffect(()=>()=>y(),[]);const b=(V,se)=>{O.current||(O.current=setInterval(()=>{V(se)},50))},y=()=>{O.current&&(clearInterval(O.current),O.current=null)},M=h.useMemo(()=>{if(!A||A.type!==Vn.FURNI)return"";const V=A;return V.isWallItem?V.name:""},[A]);h.useEffect(()=>{S(`:w=${o},${c} l=${d},${m} ${r===0?"l":"r"}`)},[d,m,o,c,r]);const U=()=>{if(R.current>0){R.current=R.current-1;const{wx:V,wy:se,hx:ee,hy:ie,d:Z}=E[R.current];l(V),u(se),_(ee),f(ie),n(Z),H(V,se,ee,ie,Z)}},G=()=>{if(R.current<E.length-1){R.current=R.current+1;const{wx:V,wy:se,hx:ee,hy:ie,d:Z}=E[R.current];l(V),u(se),_(ee),f(ie),n(Z),H(V,se,ee,ie,Z)}},F=()=>{if(E.length>0){R.current=0;const{wx:V,wy:se,hx:ee,hy:ie,d:Z}=E[R.current];l(V),u(se),_(ee),f(ie),n(Z),H(V,se,ee,ie,Z)}};h.useEffect(()=>{if(l(0),u(0),_(0),f(0),I([]),!A||A.type!==Vn.FURNI)return;const V=A;if(!V.isWallItem||!ce())return;const se=ce().getRoomObject(ce().activeRoomId,V.id,Q.WALL);if(!se)return;const ee=se.getDirection().x%360,ie=ce().getLegacyWallGeometry(ce().activeRoomId);if(!ie)return;const Z=ie.getOldLocation(se.getLocation(),ee);if(!Z)return;let ne=Math.trunc(Z[0]),_e=Math.trunc(Z[1]),de=Math.trunc(Z[2]),me=Math.trunc(Z[3]),fe=Z[4]==="l"?0:1;l(ne),u(_e),_(de),f(me),n(fe),R.current=R.current+1,I(ae=>[...ae.slice(0,R.current),{wx:ne,wy:_e,hx:de,hy:me,d:fe}])},[A]);const H=(V,se,ee,ie,Z)=>{if(!A||A.type!==Vn.FURNI)return;const ne=A;ne.isWallItem&&K(new fm(ne.id,`:w=${V},${se} l=${ee},${ie} ${Z===0?"l":"r"}`))},v=(V,se,ee,ie,Z)=>{R.current=R.current+1,I(ne=>[...ne.slice(0,R.current),{wx:V,wy:se,hx:ee,hy:ie,d:Z}])},B=V=>{if(!(!A||A.type!==Vn.FURNI||!A.isWallItem))switch(V){case 0:l(ee=>{let ie=ee-t;return v(ie,c,d,m,r),H(ie,c,d,m,r),ie});break;case 1:u(ee=>{let ie=ee-t;return v(o,ie,d,m,r),H(o,ie,d,m,r),ie});break;case 2:u(ee=>{let ie=ee+t;return v(o,ie,d,m,r),H(o,ie,d,m,r),ie});break;case 3:l(ee=>{let ie=ee+t;return v(ie,c,d,m,r),H(ie,c,d,m,r),ie});break;default:return}},z=V=>{n(V),H(o,c,d,m,V)},$=V=>{if(!(!A||A.type!==Vn.FURNI||!A.isWallItem))switch(V){case 0:_(ee=>{let ie=ee-t;return v(o,c,ie,m,r),H(o,c,ie,m,r),ie});break;case 1:_(ee=>{let ie=ee+t;return v(o,c,ie,m,r),H(o,c,ie,m,r),ie});break;case 2:f(ee=>{let ie=ee-t;return v(o,c,d,ie,r),H(o,c,d,ie,r),ie});break;case 3:f(ee=>{let ie=ee+t;return v(o,c,d,ie,r),H(o,c,d,ie,r),ie});break;default:return}},W=V=>{const se=V.split(" "),ee=se[2];if(ee!=="l"&&ee!=="r"){S(C.current);return}try{const ie=se[0].substring(3).split(","),Z=parseInt(ie[0]),ne=parseInt(ie[1]),_e=se[1].substring(2).split(","),de=parseInt(_e[0]),me=parseInt(_e[1]);l(Z),u(ne),_(de),f(me),n(ee==="l"?0:1),H(Z,ne,de,me,ee==="l"?0:1),v(Z,ne,de,me,ee==="l"?0:1)}catch{S(C.current)}};return s.jsxs(ve,{uniqueKey:"nitro-wall-editor",className:"wall-editor",children:[s.jsx(je,{headerText:g("wall-editor.title"),onCloseClick:e}),s.jsxs(be,{overflow:"hidden",children:[s.jsxs(Ye,{children:[s.jsxs(N,{size:6,overflow:"hidden",children:[s.jsx(T,{bold:!0,children:g("wall-editor.furni.title")}),s.jsx("input",{type:"text",disabled:!0,className:"form-control form-control-sm",placeholder:g("wall-editor.furni.empty"),value:M}),s.jsxs(x,{justifyContent:"center",gap:2,children:[s.jsx(q,{pointer:!0,className:"wall-editor-icon icon icon-upleft",onMouseDown:V=>b(B,0),onMouseUp:y,onMouseLeave:y}),s.jsx(q,{pointer:!0,className:"wall-editor-icon icon icon-upright",onMouseDown:V=>b(B,1),onMouseUp:y,onMouseLeave:y})]}),s.jsxs(x,{justifyContent:"center",gap:2,children:[s.jsx(q,{pointer:!0,className:"wall-editor-icon icon icon-downleft",onMouseDown:V=>b(B,2),onMouseUp:y,onMouseLeave:y}),s.jsx(q,{pointer:!0,className:"wall-editor-icon icon icon-downright",onMouseDown:V=>b(B,3),onMouseUp:y,onMouseLeave:y})]})]}),s.jsxs(N,{size:6,overflow:"hidden",children:[s.jsx(T,{bold:!0,children:g("wall-editor.step.title")}),s.jsx("input",{type:"number",className:"form-control form-control-sm show-number-arrows",placeholder:g("wall-editor.step"),value:t,onChange:V=>{i(parseFloat(V.target.value))}}),s.jsx(T,{bold:!0,children:g("wall-editor.direction.title")}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"wallEditorDirection",id:"wallEditorDirection0",checked:r==0,onChange:V=>z(0)}),s.jsx(T,{children:g("wall-editor.direction.left")})]}),s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"wallEditorDirection",id:"wallEditorDirection1",checked:r==1,onChange:V=>z(1)}),s.jsx(T,{children:g("wall-editor.direction.right")})]}),s.jsxs(x,{justifyContent:"center",gap:2,children:[s.jsx(q,{pointer:!0,className:"wall-editor-icon icon icon-left",onMouseDown:V=>b($,0),onMouseUp:y,onMouseLeave:y}),s.jsx(q,{pointer:!0,className:"wall-editor-icon icon icon-right",onMouseDown:V=>b($,1),onMouseUp:y,onMouseLeave:y}),s.jsx(q,{pointer:!0,className:"wall-editor-icon icon icon-up",onMouseDown:V=>b($,2),onMouseUp:y,onMouseLeave:y}),s.jsx(q,{pointer:!0,className:"wall-editor-icon icon icon-down",onMouseDown:V=>b($,3),onMouseUp:y,onMouseLeave:y})]})]})]}),s.jsxs(x,{gap:2,alignItems:"center",children:[s.jsx(T,{bold:!0,children:g("wall-editor.position.title")}),s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("wall-editor.position"),value:p,onChange:V=>S(V.target.value),onFocus:()=>C.current=p,onBlur:V=>W(V.target.value)}),s.jsx(X,{variant:"primary",className:"mt-2",onClick:U,children:g("generic.undo")}),s.jsx(X,{variant:"primary",className:"mt-2",onClick:G,children:g("generic.redo")}),s.jsx(X,{variant:"primary",className:"mt-2",onClick:F,children:g("generic.reset")})]})]})]})},gme=a=>{const[e,t]=h.useState(!1),{roomSession:i=null}=vt();return h.useEffect(()=>{const r={linkReceived:n=>{const o=n.split("/");if(!(o.length<2))switch(o[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(l=>!l);return}},eventUrlPrefix:"wall-editor/"};return fs(r),()=>ps(r)},[]),!e||!i?null:s.jsx(_me,{close:()=>t(!1)})},mme=()=>{const[a,e]=h.useState(!1),[t,i]=h.useState(!1),[r,n]=h.useState(""),{chatHistory:o=[]}=$G(),{settingFontSize:l}=Ea(),c=h.useMemo(()=>{if(r.length===0)return o;let u=r.toLowerCase();return o.filter(d=>d.message&&d.message.toLowerCase().includes(u)||d.name&&d.name.toLowerCase().includes(u))},[o,r]);return h.useEffect(()=>{const u={linkReceived:d=>{const _=d.split("/");if(!(_.length<2))switch(_[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(m=>!m);return}},eventUrlPrefix:"mention-history/"};return fs(u),()=>ps(u)},[]),a?s.jsxs(ve,{uniqueKey:"mention-history",className:"nitro-chat-history",theme:"primary-slim",children:[s.jsx(je,{headerText:g("Menções"),onCloseClick:u=>e(!1)}),s.jsxs(be,{overflow:"hidden",gap:2,children:[s.jsxs("div",{className:"d-flex gap-2 z-2>",children:[s.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:g("generic.search"),value:r,onChange:u=>n(u.target.value)}),s.jsx("div",{className:"d-flex align-items-center justify-content-center btn btn-primary btn-sm",onClick:()=>i(!t),children:t?s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 448 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"})}):s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 448 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"})})})]}),s.jsx(Wd,{rows:c,scrollToBottom:!t,placement:"bottom",rowRender:u=>s.jsxs(x,{alignItems:"center",className:"p-1",gap:2,children:[s.jsx(T,{variant:"muted",children:u.timestamp}),s.jsxs("div",{onClick:()=>Ce(u.linkUrl),className:"bubble-container",style:{position:"relative"},children:[u.style===0&&s.jsx("div",{className:"user-container-bg",style:{backgroundColor:u.color}}),s.jsxs("div",{className:`chat-bubble bubble-${u.style} type-${u.chatType}`,style:{maxWidth:"100%",fontSize:`${l}em`},children:[s.jsx("div",{className:"user-container",children:u.image&&u.image.length>0&&s.jsx("div",{className:"user-image",style:{backgroundImage:`url(${u.image})`}})}),s.jsxs("div",{className:"chat-content",children:[s.jsx("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${u.name}: `}}),s.jsx("span",{className:"message",dangerouslySetInnerHTML:{__html:`${u.message}`}})]})]})]})]},u.id+"")})]})]}):null},fme=a=>{const[e,t]=h.useState("snow"),[i,r]=h.useState(0),[n,o]=h.useState(!1),{userFigure:l=null}=Ja(),{groupItems:c=[],getItemsByType:u}=$a(),{tokensSnow:d,setTokensSnow:_,tokensSand:m,setTokensSand:f,rankingSnow:E,rankingSand:I,totalSnow:p,totalSand:S,checkpointRatio:R,numCheckpoints:O}=a;h.useEffect(()=>{const G=u(35199),F=u(35200);!G||G.length===0?_(0):_(G[0].items.length),!F||F.length===0?f(0):f(F[0].items.length)},[c,u]);const C=h.useMemo(()=>R*O,[R,O]),b=h.useCallback(G=>G==="snow"?d:m,[d,m])(e),y=G=>{const F=Number(G.target.value);r(F),b!==0&&G.target.style.setProperty("--value",`${F/b*100}%`)},M=G=>{t(G),r(0);const F=document.querySelector('.natal-campaign__profile__boost__form__range input[type="range"]');F&&F.style.setProperty("--value","0%")},U=()=>{i>0&&(K(new zF(i,e)),r(0))};return s.jsxs("div",{className:"natal-campaign__container",children:[s.jsxs("div",{className:"natal-campaign__ranking",children:[s.jsxs("div",{className:"natal-campaign__ranking__sand",children:[s.jsx("div",{className:"natal-campaign__ranking__sand__title",children:"Ranking Tropical"}),s.jsxs("div",{className:"natal-campaign__ranking__podium",children:[s.jsxs("div",{className:"natal-campaign__ranking__podium__user",children:[s.jsx("img",{className:"natal-campaign__ranking__podium__user__medal",src:"https://imgur.com/rTkW2y3.png"}),I.length>=1&&s.jsx("img",{src:`https://hubbe.biz/avatarid/${I[0].id}?headonly=1`,alt:"Top 1"})]}),s.jsxs("div",{className:"natal-campaign__ranking__podium__user",children:[s.jsx("img",{className:"natal-campaign__ranking__podium__user__medal",src:"https://imgur.com/ahG9M4Z.png"}),I.length>=2&&s.jsx("img",{src:`https://hubbe.biz/avatarid/${I[1].id}?headonly=1`,alt:"Top 2"})]}),s.jsxs("div",{className:"natal-campaign__ranking__podium__user",children:[s.jsx("img",{className:"natal-campaign__ranking__podium__user__medal",src:"https://imgur.com/uS7ePyF.png"}),I.length>=3&&s.jsx("img",{src:`https://hubbe.biz/avatarid/${I[2].id}?headonly=1`,alt:"Top 3"})]})]})]}),s.jsxs("div",{className:"natal-campaign__ranking__snow",children:[s.jsx("div",{className:"natal-campaign__ranking__snow__title",children:"Ranking Nevado"}),s.jsxs("div",{className:"natal-campaign__ranking__podium",children:[s.jsxs("div",{className:"natal-campaign__ranking__podium__user",children:[s.jsx("img",{className:"natal-campaign__ranking__podium__user__medal",src:"https://imgur.com/rTkW2y3.png"}),E.length>=1&&s.jsx("img",{src:`https://hubbe.biz/avatarid/${E[0].id}?headonly=1`,alt:"Top 1"}),"                        "]}),s.jsxs("div",{className:"natal-campaign__ranking__podium__user",children:[s.jsx("img",{className:"natal-campaign__ranking__podium__user__medal",src:"https://imgur.com/ahG9M4Z.png"}),E.length>=2&&s.jsx("img",{src:`https://hubbe.biz/avatarid/${E[1].id}?headonly=1`,alt:"Top 2"}),"                        "]}),s.jsxs("div",{className:"natal-campaign__ranking__podium__user",children:[s.jsx("img",{className:"natal-campaign__ranking__podium__user__medal",src:"https://imgur.com/uS7ePyF.png"}),E.length>=3&&s.jsx("img",{src:`https://hubbe.biz/avatarid/${E[2].id}?headonly=1`,alt:"Top 3"}),"                        "]})]})]})]}),s.jsxs("div",{className:"natal-campaign__profile",children:[s.jsxs("div",{className:"natal-campaign__profile__title",children:[s.jsxs("span",{children:[s.jsx("b",{children:"HUBBE:"})," Acelera Noel!"]}),s.jsx("button",{className:"natal-campaign__profile__close",children:"x"})]}),s.jsxs("div",{className:"natal-campaign__profile__data",children:[s.jsx("div",{className:"natal-campaign__profile__data__avatar",children:s.jsx(ls,{figure:l,direction:2})}),s.jsx("div",{className:"natal-campaign__profile__data__name",children:te().userName})]}),s.jsx("div",{className:"natal-campaign__profile__boost",children:s.jsxs("form",{className:"natal-campaign__profile__boost__form",children:[s.jsxs("div",{className:"natal-campaign__profile__boost__form__labels",children:[s.jsxs("label",{htmlFor:"snow",className:"natal-campaign__profile__boost__form__labels__label",children:[s.jsx("input",{type:"radio",id:"snow",name:"tokenType",value:"snow",checked:e==="snow",onChange:()=>M("snow")}),"Token de Neve"]}),s.jsxs("label",{htmlFor:"sand",className:"natal-campaign__profile__boost__form__labels__label",children:[s.jsx("input",{type:"radio",id:"sand",name:"tokenType",value:"sand",checked:e==="sand",onChange:()=>M("sand")}),"Token de Areia"]})]}),s.jsxs("div",{className:"natal-campaign__profile__boost__form__range",children:[s.jsx("input",{type:"range",min:0,max:b,value:i,onMouseDown:()=>{o(!0)},onMouseUp:()=>{o(!1)},onChange:y}),s.jsx("div",{className:"natal-campaign__profile__boost__form__range__bubble",style:{display:`${n?"block":"none"}`,left:`${b===0?0:i*100/b}%`},children:i}),s.jsxs("div",{className:"natal-campaign__profile__boost__form__range__info",children:["Quantidade Selecionada: ",s.jsx("b",{children:i})," / ",b," ",e==="snow"?"Tokens de Neve":"Tokens de Areia"]})]}),s.jsx("button",{type:"button",className:"natal-campaign__profile__boost__form__confirm",onClick:U,children:"Impulsionar"})]})}),s.jsx("div",{className:"natal-campaign__stars",children:s.jsx("span",{children:"Em desenvolvimento"})})]}),s.jsxs("div",{className:"natal-campaign__race-track",children:[s.jsx("div",{className:"natal-campaign__race-track__trajectory-sand",children:s.jsx("div",{className:"natal-campaign__race-track__trajectory-sand__santa",style:{left:`${S*100/(C+130)}%`}})}),s.jsx("div",{className:"natal-campaign__race-track__trajectory-snow",children:s.jsx("div",{className:"natal-campaign__race-track__trajectory-snow__santa",style:{left:`${p*100/(C+130)}%`}})})]})]})},pme=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(0),[n,o]=h.useState(0),[l,c]=h.useState([]),[u,d]=h.useState([]),[_,m]=h.useState(0),[f,E]=h.useState(0),[I,p]=h.useState(400),[S,R]=h.useState(5),[O,C]=h.useState(!1),{needsUpdate:A,setNeedsUpdate:b}=$a();return h.useEffect(()=>{O||e&&K(new KF)},[O,e]),J(JL,y=>{const M=y.getParser();p(M.checkpointRatio),R(M.numCheckpoints),R(M.numCheckpoints),m(M.snowImpulses),E(M.sandImpulses),d(M.rankingSand),c(M.rankingSnow),C(!0)}),h.useEffect(()=>{!e||!A||(K(new $C),b(!1))},[e,A]),h.useEffect(()=>{const y={linkReceived:M=>{const U=M.split("/");if(!(U.length<2))switch(U[1]){case"toggle":t(G=>!G);break}},eventUrlPrefix:"natal-campaign/"};return fs(y),()=>ps(y)},[]),s.jsx(s.Fragment,{children:e&&O&&s.jsx(fme,{checkpointRatio:I,numCheckpoints:S,rankingSand:u,rankingSnow:l,setTokensSand:o,setTokensSnow:r,tokensSand:n,tokensSnow:i,totalSand:f,totalSnow:_})})},Eme=()=>{const[a,e]=h.useState(Math.round(vS()));return h.useEffect(()=>{const t=setInterval(()=>{e(Math.round(vS()))},1e3);return()=>clearInterval(t)},[]),s.jsxs("div",{className:"fps-view",children:[s.jsxs(x,{alignItems:"center",justifyContent:"between",className:"mb-1",children:[s.jsx(x,{alignItems:"center",gap:2,children:s.jsx(GV,{style:{color:"#60a5fa"}})}),s.jsx("div",{style:{color:"#60a5fa",fontWeight:"500",fontSize:"0.75rem",lineHeight:"1rem"},children:"FPS"})]}),s.jsx(x,{alignItems:"center",justifyContent:"center",children:s.jsx(T,{className:"text-2xl",bold:!0,variant:"white",style:{fontSize:"1.5rem",lineHeight:"2rem"},children:a})}),s.jsx("div",{className:"fps-line",children:s.jsx("div",{className:"fps-bar",style:{width:`${a}%`}})})]})},Ime=a=>{const{showFps:e}=Ea();return s.jsx("div",{className:"nitro-left-side",children:s.jsx(N,{position:"relative",gap:1,children:e&&s.jsx(Eme,{})})})},Tme=a=>{const{quests:e,visible:t,setVisible:i,acceptQuest:r,cancelQuest:n}=kN();return h.useEffect(()=>{const o={linkReceived:l=>{const c=l.split("/");if(!(c.length<2))switch(c[1]){case"open":i(!0);return;case"close":i(!1);return;case"toggle":i(!t);return}},eventUrlPrefix:"quests/"};return fs(o),()=>ps(o)},[]),t?s.jsxs(ve,{className:"nitro-quests-view no-resize",theme:"primary-slim",children:[s.jsx(je,{headerText:"Tarefas",onCloseClick:()=>i(!1)}),s.jsx(be,{children:e.filter(o=>o&&!o.isCompleted).map((o,l)=>s.jsx(OB,{quest:o,acceptQuest:r,cancelQuest:n,progressColor:o.easy?"blue":"red"},l))})]}):null},Sme=20,Rme=()=>{const[a,e]=h.useState([]),[t,i]=h.useState(!1),[r,n]=h.useState(""),[o,l]=h.useState(""),[c,u]=h.useState(!1),[d,_]=h.useState(""),m=te().clubLevel>=rr.VIP,f=m?5:3;h.useEffect(()=>{const C={linkReceived:A=>{const b=A.split("/");if(!(b.length<2))switch(b[1]){case"show":u(!0);return;case"hide":u(!1);return;case"toggle":u(y=>!y);return}},eventUrlPrefix:"user-tags/"};return fs(C),()=>ps(C)},[]),h.useEffect(()=>{c&&(_(""),e([]),n(""),l(""),i(!1),K(new dN(te().userId)))},[c]);const E=()=>{if(o.trim()){if(t){const C=a.indexOf(r);if(C===-1)return;a[C]=o}else{if(a.length>=f)return;a.push(o)}e([...a]),l(""),i(!1)}},I=C=>{const A=a.indexOf(C);A!==-1&&(a.splice(A,1),e([...a]),C===r&&(l(""),i(!1)))};J(FC,C=>{const A=C.getParser();A&&e(A.tags)});const p=C=>{a.indexOf(C)!==-1&&_(C)},S=C=>{const A=[...a],b=A.indexOf(d),y=A.indexOf(C);if(b===-1||y===-1)return;const M=A[b];if(b>y)for(let U=b;U>y;U--)A[U]=A[U-1];else for(let U=b;U<y;U++)A[U]=A[U+1];A[y]=M,e(A)},R=()=>{_("")},O=()=>{K(new bF(a.length,a))};return c?s.jsxs(ve,{className:"nitro-user-tags",theme:"primary-slim",children:[s.jsx(je,{headerText:"Tags",onCloseClick:()=>u(!1)}),s.jsxs(be,{children:[a.length>=f&&!t&&s.jsxs(s.Fragment,{children:[s.jsxs(T,{bold:!0,className:"tag-max",children:["Você atingiu o máximo de ",f," tags. Clique em uma tag para editá-la ou remova tags para adicionar novas."]}),!m&&s.jsxs(T,{bold:!0,variant:"danger",center:!0,children:["Apenas membros HC podem ter mais de ",f," tags."]})]}),a.length<f&&!t&&s.jsxs(x,{gap:2,children:[s.jsx("input",{type:"text",value:o,onChange:C=>l(C.target.value),placeholder:t?"Editar tag...":"Adicionar uma tag...",maxLength:20,className:"py-2 w-100 form-control form-control-s"}),s.jsx(X,{onClick:E,disabled:!o.trim(),className:"text-white px-3 sm:px-4 py-2 rounded-lg",children:s.jsx(BV,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]}),t&&s.jsxs(x,{gap:2,children:[s.jsx("input",{type:"text",value:o,onChange:C=>l(C.target.value),placeholder:t?"Editar tag...":"Adicionar uma tag...",maxLength:20,className:"py-2 w-100 form-control form-control-s"}),s.jsx(X,{onClick:E,disabled:!o.trim(),className:"text-white px-3 sm:px-4 py-2 rounded-lg",children:s.jsx(VV,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]}),s.jsxs(N,{className:"bg-white p-2 tag-content",children:[s.jsxs(T,{className:"tag-placeholder",variant:"muted",center:!0,children:["Você pode arrastar as tags para reordená-las.",s.jsx("hr",{className:"my-2"})]}),a.length===0&&s.jsx(T,{className:"tag-placeholder",variant:"muted",center:!0,children:"Você ainda não possui tags. Sinta-se livre para adicionar algumas!"}),s.jsx(x,{gap:2,children:a.map((C,A)=>s.jsx(x,{alignItems:"center",gap:2,draggable:!0,onDragStart:()=>p(C),onDragOver:()=>S(C),onDrop:()=>R(),children:s.jsxs(x,{alignItems:"center",gap:1,justifyContent:"center",className:"px-2 py-1 tag",pointer:!0,children:[s.jsx(T,{onClick:()=>{A+1>=f||(i(!0),l(C),n(C))},children:C}),s.jsx(HV,{color:"black",style:{width:"0.8rem"},onClick:()=>I(C)})]})},A))})]}),s.jsxs(x,{alignItems:"center",justifyContent:"between",children:[s.jsxs(T,{className:"tag-placeholder",variant:"muted",children:[a.length,"/",f," tags usadas. Máximo ",Sme," caracteres por tag"]}),s.jsx(X,{disabled:t,onClick:O,children:"Salvar"})]})]})]}):null},xme=a=>{var d;const{setType:e=null,partItem:t=null,isSelected:i=!1,...r}=a,[n,o]=h.useState(""),{selectedColorParts:l=null,getFigureStringWithFace:c=null}=Rm(),u=!xe("hc.disabled",!1)&&(((d=t.partSet)==null?void 0:d.clubLevel)??0)>0;return h.useEffect(()=>{if(!e||!e.length||!t)return;(async()=>{var E;const m=!xe("hc.disabled",!1)&&(((E=t.partSet)==null?void 0:E.clubLevel)??0)>0;let f=null;e===Ee.HEAD?f=await Dc.buildForFace(c(t.id),m):f=await Dc.build(e,t,t.usesColor,l[e]??null,m),f&&f.length&&o(f)})()},[e,t,l,c]),t?s.jsxs(ct,{itemImage:t.isClear?void 0:n,itemActive:i,style:{width:"100%",flex:"1",backgroundPosition:e===Ee.HEAD?"center -35px":"center"},...r,children:[!t.isClear&&u&&s.jsx(gs,{className:"position-absolute end-1 bottom-1",type:"hc"}),t.isClear&&s.jsx(jr,{icon:"clear"}),!t.isClear&&t.partSet.isSellable&&s.jsx(jr,{icon:"sellable",position:"absolute",className:"end-1 bottom-1"})]}):null},Ome=a=>{const{category:e=null}=a,{selectedParts:t=null,selectEditorPart:i}=Rm(),r=n=>!e||!e.setType||!t?!1:t[e.setType]?t[e.setType]===n.id:!!n.isClear;return s.jsx(ch,{rows:e.partItems,columnCount:3,overscan:5,itemRender:n=>n?s.jsx(xme,{setType:e.setType,partItem:n,isSelected:r(n),onClick:o=>{var l;return i(e.setType,((l=n.partSet)==null?void 0:l.id)??-1)}},n.id+""):null})},Cme=a=>{const{setType:e=null,partColor:t=null,isSelected:i=!1,...r}=a;if(!t)return null;const n=!xe("hc.disabled",!1)&&t.clubLevel>0;return s.jsx(ct,{itemHighlight:!0,itemColor:Ri.int2rgb(t.rgb),itemActive:i,className:"clear-bg",...r,children:n&&s.jsx(gs,{className:"position-absolute end-1 bottom-1",type:"hc"})})},wy=a=>{const{category:e=null,paletteIndex:t=-1}=a,{selectedColorParts:i=null,selectEditorColor:r=null}=Rm(),n=o=>!e||!e.setType||!i||!i[e.setType]||!i[e.setType][t]?!1:i[e.setType][t].id===o.id;return s.jsx(ch,{rows:e.colorItems[t],columnCount:5,overscan:5,itemRender:o=>o?s.jsx(Cme,{setType:e.setType,partColor:o,isSelected:n(o),onClick:l=>r(e.setType,t,o.id)},o.id+""):null})},Nme=a=>{const{categories:e=[],name:t=""}=a,[i,r]=h.useState(!1),[n,o]=h.useState(""),{maxPaletteCount:l=1,gender:c=null,setGender:u=null,selectedColorParts:d=null,getFirstSelectableColor:_=null,selectEditorColor:m=null}=Rm(),f=h.useMemo(()=>e.find(I=>I.setType===n)??null,[e,n]),E=h.useCallback(I=>{const p=d[I];(!p||!p.length)&&m(I,0,_(I)),o(I)},[_,m,d]);return h.useEffect(()=>{var I;!e||!e.length||!i||(E((I=e[0])==null?void 0:I.setType),r(!1))},[e,i,E]),h.useEffect(()=>{r(!0)},[e]),f?s.jsxs(Ye,{children:[s.jsxs(N,{size:2,children:[t===ji.GENERIC&&s.jsxs(s.Fragment,{children:[s.jsx(x,{center:!0,pointer:!0,className:"category-item",onClick:I=>u(Ee.MALE),children:s.jsx(jr,{icon:"male",selected:c===Sl.MALE})}),s.jsx(x,{center:!0,pointer:!0,className:"category-item",onClick:I=>u(Ee.FEMALE),children:s.jsx(jr,{icon:"female",selected:c===Sl.FEMALE})})]}),t!==ji.GENERIC&&e.length>0&&e.map(I=>s.jsx(x,{center:!0,pointer:!0,className:"category-item",onClick:p=>E(I.setType),children:s.jsx(jr,{icon:I.setType,selected:n===I.setType})},I.setType))]}),s.jsx(N,{size:5,overflow:"hidden",children:s.jsx(Ome,{category:f})}),s.jsxs(N,{size:5,overflow:"hidden",children:[l>=1&&s.jsx(wy,{category:f,paletteIndex:0}),l===2&&s.jsx(wy,{category:f,paletteIndex:1})]})]}):null},Ame=4,bme=a=>{const[e,t]=h.useState(Ame),{getFigureString:i}=MT(),r=n=>{e<yr.MIN_DIRECTION&&(n=yr.MAX_DIRECTION+(e+1)),e>yr.MAX_DIRECTION&&(n=e-(yr.MAX_DIRECTION+1)),t(n)};return s.jsxs(N,{className:"figure-preview-container",overflow:"hidden",position:"relative",children:[s.jsx(ls,{figure:i,direction:e,scale:2}),s.jsx(jr,{className:"avatar-spotlight",icon:"spotlight"}),s.jsx(q,{className:"avatar-shadow"}),s.jsxs(q,{className:"arrow-container",children:[s.jsx(jr,{pointer:!0,icon:"arrow-left",onClick:n=>r(e+1)}),s.jsx(jr,{pointer:!0,icon:"arrow-right",onClick:n=>r(e-1)})]})]})},vme=a=>{const{save:e,close:t,isEditorVisible:i,setIsEditorVisible:r}=MT(),{setIsVisible:n,avatarModels:o,activeModelKey:l,setActiveModelKey:c,loadAvatarData:u,getFigureStringWithFace:d,gender:_,randomizeCurrentFigure:m=null,getFigureString:f=null}=Rm(),E=I=>{switch(I){case Qi.ACTION_RESET:u(f,_);return;case Qi.ACTION_CLEAR:u(d(0,!1),_);return;case Qi.ACTION_RANDOMIZE:m();return;case Qi.ACTION_SAVE:e(f),r(!1);return}};return h.useEffect(()=>{n(i)},[t,i,c,n]),i?s.jsxs(ve,{uniqueKey:"avatar-editor",className:"nitro-avatar-editor",children:[s.jsx(je,{headerText:g("avatareditor.title"),onCloseClick:I=>{r(!1),t()}}),s.jsx($n,{children:["head","torso","legs"].map(I=>{const p=l===I;return s.jsx(In,{isActive:p,onClick:S=>c(I),children:g(`avatareditor.category.${I}`)},I)})}),s.jsx(be,{children:s.jsxs(Ye,{children:[s.jsx(N,{size:9,overflow:"hidden",children:l.length>0&&s.jsx(Nme,{name:l,categories:o[l]})}),s.jsxs(N,{size:3,overflow:"hidden",children:[s.jsx(bme,{}),s.jsxs(N,{grow:!0,gap:1,children:[s.jsxs(Ya,{children:[s.jsx(X,{variant:"secondary",onClick:I=>E(Qi.ACTION_RESET),children:s.jsx(By,{className:"fa-icon"})}),s.jsx(X,{variant:"secondary",onClick:I=>E(Qi.ACTION_CLEAR),children:s.jsx(eT,{className:"fa-icon"})}),s.jsx(X,{variant:"secondary",onClick:I=>E(Qi.ACTION_RANDOMIZE),children:s.jsx(Vy,{className:"fa-icon"})})]}),s.jsx(X,{className:"w-100",variant:"success",onClick:I=>E(Qi.ACTION_SAVE),children:g("avatareditor.save")})]})]})]})})]}):null},yme=a=>{const{transaction:e,className:t="",...i}=a,[r,n]=h.useState(!1);return s.jsxs(N,{...i,className:`nitro-user-transaction-view ${t} ${r?"expanded":""}`,onClick:()=>n(!r),children:[s.jsxs(x,{fullWidth:!0,justifyContent:"between",className:"transition-colors",children:[s.jsxs(x,{alignItems:"center",children:[s.jsx(q,{className:"transaction-icon",children:e.type==="EARN"?s.jsx(WV,{className:"icon earn"}):s.jsx(YV,{className:"icon spend"})}),s.jsx(T,{bold:!0,children:e.source})]}),s.jsxs(x,{gap:2,className:"transaction-content",children:[s.jsxs(T,{variant:"none",className:`amount ${e.type.toLowerCase()}`,children:[e.type==="EARN"?"+":"-"," ",Math.abs(e.amount)]}),s.jsx(q,{children:r?s.jsx(bS,{className:"lucide-icon muted expanded expand-arrow"}):s.jsx(bS,{className:"lucide-icon muted"})})]})]}),s.jsxs(q,{className:`expanded-details ${r?"visible":""}`,children:[s.jsxs(T,{variant:"muted",children:["Data: ",new Date(Number(e.created_at)*1e3).toLocaleDateString("pt-BR")]}),s.jsxs(T,{variant:"none",style:{color:"#2563eb"},children:["Saldo após: ",e.balance_after," diamantes"]})]})]})},Dme=[{id:"all",label:"user.transactions.tab.all"},{id:"earn",label:"user.transactions.tab.earn"},{id:"spend",label:"user.transactions.tab.spend"}],Mme=()=>{const{transactions:a,showMore:e,visible:t,close:i}=ure(),[r,n]=h.useState(null),[o,l]=h.useState("all"),c=new Date().toLocaleString("pt-BR",{month:"long",year:"numeric"}),[u,d]=h.useState([c]),_=h.useMemo(()=>a.filter(I=>o==="all"?!0:I.type.toLowerCase()===o),[a,o]),m=h.useMemo(()=>_.reduce((I,p)=>{const R=new Date(p.created_at).toLocaleString("pt-BR",{month:"long",year:"numeric"});return I[R]||(I[R]=[]),I[R].push(p),I},{}),[_]),f=h.useCallback((I,p)=>{p.stopPropagation(),n(r===I?null:I)},[r]),E=h.useCallback(I=>{d(p=>p.includes(I)?p.filter(S=>S!==I):[...p,I])},[]);return t?s.jsxs(ve,{className:"nitro-user-transactions",theme:"primary",children:[s.jsx(je,{headerText:g("user.transactions.title"),onCloseClick:i}),s.jsx($n,{children:Dme.map(I=>s.jsx(In,{isActive:o===I.id,onClick:()=>l(I.id),children:g(I.label)},I.id))}),s.jsx(be,{className:"flex-column",children:s.jsxs(q,{style:{maxHeight:"400px"},children:[Object.entries(m).map(([I,p],S)=>s.jsxs(q,{className:"month-group",onClick:()=>E(I),children:[s.jsx(T,{variant:"none",className:"month-title",onClick:R=>f(S,R),children:I}),s.jsx(q,{className:`month-transactions ${u.includes(I)?"expanded":""}`,children:p.map((R,O)=>s.jsx(yme,{transaction:R,className:`transaction ${r===O?"expanded":""}`},O))})]},I)),e&&s.jsx(q,{className:"show-more",onClick:()=>n(r===null?0:null),children:s.jsx(T,{variant:"none",children:g(r===null?"user.transactions.show_more":"user.transactions.show_less")})})]})})]}):null},jme=({onCloseClick:a,groupId:e})=>{const{forumData:t,forumsListData:i}=wN(),[r,n]=h.useState(0),[o,l]=h.useState(0),[c,u]=h.useState(0),[d,_]=h.useState(0),[m,f]=h.useState(0);return h.useEffect(()=>{t&&(n(t.readPermissions),u(t.postMessagePermissions),_(t.postThreadPermissions),f(t.moderatePermissions))},[t]),!t||t.groupId<=0?null:s.jsxs(ve,{className:"nitro-group-forum-settings",theme:"primary",children:[s.jsx(je,{headerText:g("groupforum.settings.window_title"),onCloseClick:a}),s.jsxs(be,{fullHeight:!0,gap:3,className:"nitro-group-forum-settings-content",children:[s.jsxs(x,{className:"group-header",onClick:()=>ST(t.groupId),children:[s.jsx(x,{className:"group-forum-badge",children:s.jsx(as,{badgeCode:t.icon,isGroup:!0})}),s.jsxs(N,{className:"group-info",gap:2,children:[s.jsx(T,{bold:!0,variant:"white",fontSize:3,children:t.name}),s.jsx(T,{variant:"white",children:`${t.description} (ID do Grupo: ${t.groupId})`})]})]}),s.jsxs(N,{className:"content",gap:3,fullWidth:!0,children:[s.jsxs(N,{gap:2,children:[s.jsx(T,{children:g("groupforum.permissions.read_label")}),s.jsx(N,{gap:1,className:"options",children:[0,1,2].map((E,I)=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"readpermission",id:`readPermission${E}`,checked:r===E,onChange:()=>n(E)}),s.jsx(T,{children:g(`groupforum.permissions.option_${["all","group_members","group_admins"][E]}`)})]},I))})]}),s.jsxs(N,{gap:2,children:[s.jsx(T,{children:g("groupforum.permissions.post_message_label")}),s.jsx(N,{gap:1,className:"options",children:[0,1,2].map((E,I)=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"postpermission",id:`postPermission${E}`,checked:o===E,onChange:()=>l(E)}),s.jsx(T,{children:g(`groupforum.permissions.option_${["all","group_members","group_admins","owner"][E]}`)})]},I))})]}),s.jsxs(N,{gap:2,children:[s.jsx(T,{children:g("groupforum.permissions.post_thread_label")}),s.jsx(N,{gap:1,className:"options",children:[0,1,2].map((E,I)=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"startThreadPermission",id:`startThreadPermission${E}`,checked:d===E,onChange:()=>_(E)}),s.jsx(T,{children:g(`groupforum.permissions.option_${["group_members","group_admins","owner"][E]}`)})]},I))})]}),s.jsxs(N,{gap:2,children:[s.jsx(T,{children:g("groupforum.permissions.moderate_label")}),s.jsx(N,{gap:1,className:"options",children:[0,1,2].map((E,I)=>s.jsxs(x,{alignItems:"center",gap:1,children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"moderatePermission",id:`moderatePermission${E}`,checked:m===E,onChange:()=>f(E)}),s.jsx(T,{children:g(`groupforum.permissions.option_${["all","group_members","group_admins","owner"][E]}`)})]},I))})]})]}),s.jsxs(x,{className:"bottom",children:[s.jsx(X,{variant:"muted",className:"button",onClick:a,children:g("groupforum.settings.cancel")}),s.jsx(X,{variant:"primary",className:"button",onClick:()=>{a()},children:g("groupforum.settings.ok")})]})]})]})},Lme=a=>null,Pme=a=>{const{forumData:e,setIsVisible:t}=wN(),[i,r]=h.useState(1),[n,o]=h.useState(!1),[l,c]=h.useState(!1),u=()=>{t(!1)},d=_=>{switch(_){case"open-settings":o(!n);break;case"my-forums":break;case"most-actives":break;case"most-visited":break;case"new-thread":c(!l);break}};return!e||e.groupId<=0?null:s.jsxs(ve,{className:"nitro-group-forum nitro-group-information-standalone",theme:"primary",children:[s.jsx(je,{headerText:g("group.forum.window.title"),onCloseClick:u}),s.jsxs(be,{className:"nitro-group-forum-content",children:[s.jsxs(x,{className:"group-header",children:[s.jsxs(x,{className:"group-header-left",children:[s.jsx(x,{className:"group-forum-badge",children:s.jsx(as,{badgeCode:e.icon,isGroup:!0,className:"mx-auto d-block",onClick:()=>ST(e.groupId)})}),s.jsxs(N,{className:"group-info",gap:2,children:[s.jsx(T,{bold:!0,variant:"white",fontSize:3,children:e.name}),s.jsx(T,{variant:"white",children:`${e.description} (ID do Grupo: ${e.groupId})`})]})]}),e.canChangeSettings&&s.jsx(x,{className:"group-header-right",onClick:()=>d("open-settings"),children:s.jsxs(x,{gap:1,className:"group-forum-settings",children:[s.jsx("div",{className:"cursor-pointer icon-settings"}),s.jsx(T,{variant:"white",children:g("Configurações")})]})})]}),s.jsxs(x,{className:"shortcuts-header",gap:1,children:[s.jsx(T,{bold:!0,children:g("Links rápidos:")}),s.jsxs(x,{gap:2,className:"shortcuts-options",children:[s.jsx(T,{className:"shortcuts-option",onClick:()=>d("my-forums"),children:g("groupforum.view.forums_header.0")},"option1"),s.jsx(T,{className:"shortcuts-option",onClick:()=>d("most-actives"),children:g("groupforum.view.forums_header.1")},"option2"),s.jsx(T,{className:"shortcuts-option",onClick:()=>d("most-visited"),children:g("groupforum.view.forums_header.2")},"option3")]})]}),s.jsx(N,{className:"content-header",gap:1,children:s.jsx(T,{children:g("Todos os tópicos")})}),s.jsx(N,{className:"content-wrap",gap:2,children:s.jsx(x,{className:"content"})}),s.jsxs(x,{className:"bottom",children:[s.jsx(X,{alignItems:"center",justifyContent:"center",className:"back-button",variant:"muted",children:g("groupforum.view.back")}),s.jsxs(x,{gap:1,className:"right-side",children:[s.jsx(x,{alignItems:"center",justifyContent:"center",className:"btn btn-primary btn-sm new-button",onClick:()=>d("new-thread"),children:g("Novo tópico")}),s.jsxs(X,{alignItems:"center",justifyContent:"center",variant:"muted",disabled:i===1,onClick:()=>r(1),children:[s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 320 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"})}),s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 320 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"})})]}),s.jsx(X,{alignItems:"center",justifyContent:"center",variant:"muted",disabled:i===1,onClick:()=>r(i-1),children:s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 320 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"})})}),s.jsxs(T,{children:[i," / ",e.totalThreads||1]}),s.jsx(X,{alignItems:"center",justifyContent:"center",variant:"muted",disabled:i===(e.totalThreads||1),onClick:()=>r(i+1),children:s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 320 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"})})}),s.jsxs(X,{alignItems:"center",justifyContent:"center",variant:"muted",disabled:i===(e.totalThreads||1),onClick:()=>r(e.totalThreads||1),children:[s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 320 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"})}),s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 320 512",className:"fa-icon",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"})})]})]})]})]}),n&&s.jsx(jme,{groupId:e.groupId,onCloseClick:()=>o(!1)}),l&&s.jsx(Lme,{groupId:e.groupId,onCloseClick:()=>c(!1)})]})},Ume=a=>{const{isVisible:e=!1,setIsVisible:t=null,openGroupForum:i,initForum:r}=wN(),[n,o]=h.useState(0);return h.useEffect(()=>{const l={linkReceived:c=>{const u=c.split("/");if(!(u.length<2)){switch(u[1]){case"hide":t(!1);return;case"toggle-new-thread":return;case"close-new-thread":return;case"toggle-new-reply":return;case"close-new-reply":return}if(u[1]==="show"){if(u[2]==="code"){let d=Number(u[3]);o(d),t(!0)}else if(u[2]==="group"&&u.length<=5){const d=parseInt(u[3]);if(d===0||isNaN(d))return;i(d),o(0)}}}},eventUrlPrefix:"group-forum/"};return fs(l),()=>ps(l)},[]),e?s.jsx(Pme,{}):null},wme=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(!0);return ms(Ve.CREATED,n=>r(!1)),ms(Ve.ENDED,n=>r(n.openLandingView)),h.useEffect(()=>{t(!0),Hg().connection.onReady()},[]),h.useEffect(()=>{const n={linkReceived:o=>{const l=o.split("/");if(!(l.length<2))switch(l[1]){case"open":if(l.length>2)switch(l[2]){case"credits":break;default:{const c=l[2];Xa.openHabblet(c)}}return}},eventUrlPrefix:"habblet/"};return fs(n),()=>ps(n)},[]),s.jsxs(q,{fit:!0,children:[s.jsx(Hd,{type:Nr.FADE_IN,inProp:i,timeout:300,children:s.jsx(Yae,{})}),s.jsx(cue,{isInRoom:!i}),s.jsx(Toe,{}),s.jsx(aue,{}),s.jsx(xne,{}),s.jsx(mme,{}),s.jsx(Hge,{}),s.jsx(Nre,{}),s.jsx(vme,{}),s.jsx(Ere,{}),s.jsx(woe,{}),s.jsx(noe,{}),s.jsx(Rne,{}),s.jsx(Yne,{}),s.jsx(Ime,{}),s.jsx(fle,{}),s.jsx(Rme,{}),s.jsx(Mme,{}),s.jsx(Cue,{}),s.jsx(Tue,{}),s.jsx(lae,{}),s.jsx(Ume,{}),s.jsx(pme,{}),s.jsx(jre,{}),s.jsx(Fae,{}),s.jsx(koe,{}),s.jsx(Iae,{}),s.jsx(Tae,{}),s.jsx(Tme,{}),s.jsx(Pre,{}),s.jsx(Xne,{}),s.jsx(dme,{}),s.jsx(Dne,{}),s.jsx(gme,{})]})};class OS{constructor(e){this.interval=e,this.max=e.end,this.left=null,this.right=null}}class Fme{constructor(){this.root=null}insert(e){if(!this.root){this.root=new OS(e);return}let t=this.root;for(;;)if(t.max=Math.max(t.max,e.end),e.start<t.interval.start){if(!t.left){t.left=new OS(e);break}t=t.left}else{if(!t.right){t.right=new OS(e);break}t=t.right}}query(e){let t=this.root;for(;t;){if(e>=t.interval.start&&e<=t.interval.end)return!0;t.left&&e<=t.left.max?t=t.left:t=t.right}return!1}}let ZO;async function kme(){const e=await fetch("https://raw.githubusercontent.com/Divinezx/is-vpn/main/vpn-or-datacenter-ipv4-ranges.txt",{signal:AbortSignal.timeout(2e4)}).then(t=>t.text()).then(t=>t.trim().split(`
`));ZO=new Fme,e.map(Gme).forEach(t=>ZO.insert(t))}function HB(a){return a.split(".").reduce((e,t)=>(e<<8)+parseInt(t,10),0)}function Gme(a){const[e,t]=a.split("/"),i=HB(e),r=i,n=i|(1<<32-t)-1;return{start:r,end:n}}function Bme(a){const e=HB(a);return ZO.query(e)}Bd.UI_VERSION=yk();const Vme=a=>{const[e,t]=h.useState(!1),[i,r]=h.useState(!1),[n,o]=h.useState("Getting Ready"),[l,c]=h.useState(0),[u,d]=h.useState(!0);if(!Oe()){if(!NitroConfig)throw new Error("NitroConfig is not defined!");De.bootstrap()}const _=h.useCallback(async m=>{switch(m.type){case ha.LOADED:Oe().localization.init(),c(f=>f+20);return;case ha.FAILED:r(!0),o("Configuration Failed");return;case De.WEBGL_UNAVAILABLE:r(!0),o("WebGL Required");return;case De.WEBGL_CONTEXT_LOST:r(!0),o("WebGL Context Lost - Reloading"),setTimeout(()=>window.location.reload(),1500);return;case Si.CONNECTION_HANDSHAKING:c(f=>f+20);return;case Si.CONNECTION_HANDSHAKE_FAILED:r(!0),o("Handshake Failed");return;case Si.CONNECTION_AUTHENTICATED:{await kme();const E=await(await fetch("https://api.ipify.org?format=json")).json();if(Bme(E.ip)){r(!0),o("Your IP is listed as using VPN.");return}}c(f=>f+20),Oe().init(),Me.available&&Me.call("legacyTrack","authentication","authok",[]);return;case Si.CONNECTION_ERROR:r(!0),o("Connection Error");return;case Si.CONNECTION_CLOSED:o("Connection Error"),Xa.send(-1,"client.init.handshake.fail");return;case Ot.ENGINE_INITIALIZED:c(f=>f+20),setTimeout(()=>t(!0),300);return;case hc.LOADED:{const f=xe("preload.assets.urls"),E=[];if(f&&f.length)for(const p of f)E.push(st.interpolate(p));await vr().downloadAssets(E)?(Hg().init(),c(p=>p+20)):(r(!0),o("Assets Failed"));return}}},[]);return Vc(De.WEBGL_UNAVAILABLE,_),Vc(De.WEBGL_CONTEXT_LOST,_),Vc(Si.CONNECTION_HANDSHAKING,_),Vc(Si.CONNECTION_HANDSHAKE_FAILED,_),Vc(Si.CONNECTION_AUTHENTICATED,_),Vc(Si.CONNECTION_ERROR,_),Vc(Si.CONNECTION_CLOSED,_),ut(Ot.ENGINE_INITIALIZED,_),Ute(hc.LOADED,_),tv(ha.LOADED,_),tv(ha.FAILED,_),h.useEffect(()=>{Oe().core.configuration.init();const m=E=>d(!(window.devicePixelRatio%1)),f=E=>E.preventDefault();return window.addEventListener("resize",m),document.addEventListener("contextmenu",f),m(),()=>{window.removeEventListener("resize",m),document.removeEventListener("contextmenu",f)}},[]),s.jsxs(q,{fit:!0,overflow:"hidden",className:u&&"image-rendering-pixelated",children:[(!e||i)&&s.jsx(hre,{isError:i,message:n,percent:l}),s.jsx(Hd,{type:Nr.FADE_IN,inProp:e,children:s.jsx(wme,{})}),s.jsx(q,{id:"draggable-windows-container"})]})};zV(document.getElementById("root")).render(s.jsx(Vme,{}));
